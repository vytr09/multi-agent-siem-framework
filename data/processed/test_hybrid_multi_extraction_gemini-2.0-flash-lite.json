{
  "test_timestamp": "2025-11-29T15:37:41.208191",
  "total_reports": 10,
  "total_ttps": 55,
  "total_high_confidence_ttps": 0,
  "total_processing_time_seconds": 56.41896600000001,
  "agent_statistics": {
    "total_reports_processed": 10,
    "total_ttps_extracted": 55,
    "nlp_entities_extracted": 97,
    "nlp_ttp_indicators_found": 61,
    "gemini_ttps_extracted": 0,
    "extraction_errors": 0,
    "gemini_api_calls": 10,
    "avg_confidence_score": 0.5848,
    "high_confidence_ttps": 0,
    "processing_time_ms": 5484.200000000001,
    "nlp_processing_time_ms": 12.16,
    "llm_processing_time_ms": 56187.005000000005,
    "cache_hits": 0,
    "cache_misses": 10,
    "last_extraction_time": "2025-11-29T15:37:41.201196"
  },
  "per_report_results": [
    {
      "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
      "title": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
      "ttps_count": 5,
      "high_confidence_count": 0,
      "processing_time_ms": 5603.568,
      "extraction": {
        "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
        "source_report": {
          "title": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
          "source": "MISP",
          "confidence": 76
        },
        "extracted_ttps": [
          {
            "ttp_id": "c2be847d-71b5-4412-91ff-6e1cb4c23f86",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.83,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.55,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:50.354308",
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "mimikatz",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [
                "mimikatz"
              ],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass",
                "mimikatz"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate...",
              "paragraph_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  schedu",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "2124d416-870f-429b-b3bd-61a63d5a5846",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching. Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate...",
            "description_original": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.83,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.55,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "command_execution": [
                  "PowerShell"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:50.354308",
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "mimikatz",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [
                "mimikatz"
              ],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass",
                "mimikatz"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "PowerShell",
              "immediate_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate...",
              "paragraph_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  schedu",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "44ee323c-924c-439e-a081-f379782908ed",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.613,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.83,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.33,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:50.355303",
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "mimikatz",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [
                "mimikatz"
              ],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass",
                "mimikatz"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "OS Credential Dumping",
              "context": "Detected OS Credential Dumping",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "f1b63119-4762-4032-ad19-6d33384766a0",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.609,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.83,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.33,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:50.355303",
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "mimikatz",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [
                "mimikatz"
              ],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass",
                "mimikatz"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Registry Run Keys",
              "context": "Detected Registry Run Keys",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "288ce5b7-6a0a-481e-b927-d4296aa6b51b",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "description_original": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.609,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.83,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.33,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:50.355303",
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "mimikatz",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [
                "mimikatz"
              ],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass",
                "mimikatz"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Remote Desktop Protocol",
              "context": "Detected Remote Desktop Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group",
              "The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "create",
              "dump",
              "persistence",
              "process",
              "registry",
              "establish",
              "lateral",
              "c2",
              "compress",
              "wmi",
              "malware",
              "task",
              "privilege",
              "exfiltrate",
              "harvest",
              "mimikatz",
              "powershell",
              "inject",
              "evasion",
              "script"
            ]
          },
          "entities": {
            "malware": [
              "Mimikatz",
              "malware",
              "rat"
            ],
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "Lazarus Group"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** credential, create, dump, persistence, process, registry, establish, lateral, c2, compress"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:36:50.355303",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 5,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 2.091,
          "llm_processing_time_ms": 5564.487
        }
      }
    },
    {
      "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
      "title": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan",
      "ttps_count": 10,
      "high_confidence_count": 0,
      "processing_time_ms": 5515.782,
      "extraction": {
        "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
        "source_report": {
          "title": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan",
          "source": "MISP",
          "confidence": 91
        },
        "extracted_ttps": [
          {
            "ttp_id": "db9ea5f0-7654-4e40-bba2-9a464a90a48b",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exf...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.641,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.551,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.874862",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exf...",
              "paragraph_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification ",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "7f4c8688-b3e0-4417-85ed-c409d928aa68",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching. Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exf...",
            "description_original": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.641,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.551,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "command_execution": [
                  "PowerShell"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.874862",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "PowerShell",
              "immediate_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exf...",
              "paragraph_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification ",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "7ad346a7-4267-47a7-aaea-85adef72e372",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.625,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.874862",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "OS Credential Dumping",
              "context": "Detected OS Credential Dumping",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "061fee6a-362d-4291-bb7e-ca72f4b942cc",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.62,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.874862",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Registry Run Keys",
              "context": "Detected Registry Run Keys",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "6efa7a94-53ff-4dd3-bd5d-d350d65c98d9",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "description_original": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.62,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.874862",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Remote Desktop Protocol",
              "context": "Detected Remote Desktop Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "45ef380b-ef47-469d-abe7-cd36add7b6ad",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "description_original": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.51,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.875872",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Process Injection",
              "context": "Detected Process Injection",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9c8a99b5-080f-48af-80bb-778d090595e5",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.508,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.875872",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Application Layer Protocol",
              "context": "Detected Application Layer Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "51227a3b-b0e2-4b8c-9c1f-ee655f607758",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "description_original": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.506,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.875872",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Exfiltration Over C2 Channel",
              "context": "Detected Exfiltration Over C2 Channel",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9103720e-94d1-45b1-beae-7a8bae8a475a",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "description_original": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.502,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.875872",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Windows Management Instrumentation",
              "context": "Detected Windows Management Instrumentation",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "41b734c1-2005-4854-9bc0-d969cbcc1893",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "description_original": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.502,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.905,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.331,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:36:55.875872",
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Archive Collected Data",
              "context": "Detected Archive Collected Data",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers",
              "The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "create",
              "dump",
              "persistence",
              "process",
              "registry",
              "establish",
              "lateral",
              "c2",
              "trojan",
              "compress",
              "wmi",
              "malware",
              "task",
              "privilege",
              "exfiltrate",
              "harvest",
              "powershell",
              "inject",
              "evasion",
              "script"
            ]
          },
          "entities": {
            "malware": [
              "Banking Trojan",
              "Trojan",
              "malware",
              "rat"
            ],
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "Shadow Brokers"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** credential, create, dump, persistence, process, registry, establish, lateral, c2, trojan"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:36:55.875872",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 10,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.019,
          "llm_processing_time_ms": 5481.662
        }
      }
    },
    {
      "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
      "title": "APT28 - Initial Access Campaign Using RAT",
      "ttps_count": 5,
      "high_confidence_count": 0,
      "processing_time_ms": 5664.0160000000005,
      "extraction": {
        "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
        "source_report": {
          "title": "APT28 - Initial Access Campaign Using RAT",
          "source": "MISP",
          "confidence": 71
        },
        "extracted_ttps": [
          {
            "ttp_id": "1a72aa92-bd71-41ea-97de-0e895c7596de",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.625,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.805,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.548,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:01.543493",
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access...",
              "paragraph_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token ",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "7a929a14-8439-4084-a77a-00fb7fed3b63",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching. APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access...",
            "description_original": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.625,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.805,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.548,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "command_execution": [
                  "PowerShell"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:01.544483",
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "PowerShell",
              "immediate_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access...",
              "paragraph_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
              "full_context": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token ",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "3af48b52-f8fa-44ba-b2cb-018c875f3533",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.609,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.805,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.328,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:01.544483",
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "OS Credential Dumping",
              "context": "Detected OS Credential Dumping",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "24747fc1-32fd-491a-9d4e-5ce6a4bfa214",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.605,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.805,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.328,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:01.544483",
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Registry Run Keys",
              "context": "Detected Registry Run Keys",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "eb79ee34-19f0-4879-acfc-b7252f97e11a",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "description_original": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.605,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.805,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.328,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:01.544483",
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "lsass",
              "ping",
              "powershell",
              "sc",
              "wmi"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell",
                "wmi"
              ],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Remote Desktop Protocol",
              "context": "Detected Remote Desktop Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28",
              "The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "create",
              "dump",
              "persistence",
              "process",
              "registry",
              "establish",
              "lateral",
              "c2",
              "compress",
              "wmi",
              "malware",
              "task",
              "privilege",
              "exfiltrate",
              "harvest",
              "powershell",
              "inject",
              "evasion",
              "script"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "RAT",
              "malware"
            ],
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "APT28"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** credential, create, dump, persistence, process, registry, establish, lateral, c2, compress"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:01.544483",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 5,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 2.006,
          "llm_processing_time_ms": 5633.946
        }
      }
    },
    {
      "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
      "title": "APT29 - Supply Chain Attack Using Cobalt Strike",
      "ttps_count": 4,
      "high_confidence_count": 0,
      "processing_time_ms": 5688.835,
      "extraction": {
        "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
        "source_report": {
          "title": "APT29 - Supply Chain Attack Using Cobalt Strike",
          "source": "MISP",
          "confidence": 95
        },
        "extracted_ttps": [
          {
            "ttp_id": "8b7b3565-5f9f-49e1-9759-53af17e8781d",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.609,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.925,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:07.237248",
            "tools": [
              "At",
              "Cobalt Strike",
              "cobalt strike",
              "ntds.dit",
              "pass-the-ticket",
              "rundll32",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "rundll32"
              ],
              "credential_tools": [
                "ntds.dit",
                "pass-the-ticket"
              ],
              "c2_tools": [
                "cobalt strike"
              ],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [
                "NTDS.dit"
              ],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Phishing",
              "context": "Detected Phishing",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "a0ed1d30-3764-4ffc-93ce-77326abbd7e3",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "description_original": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.516,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.925,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:07.237248",
            "tools": [
              "At",
              "Cobalt Strike",
              "cobalt strike",
              "ntds.dit",
              "pass-the-ticket",
              "rundll32",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "rundll32"
              ],
              "credential_tools": [
                "ntds.dit",
                "pass-the-ticket"
              ],
              "c2_tools": [
                "cobalt strike"
              ],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [
                "NTDS.dit"
              ],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Create or Modify System Process",
              "context": "Detected Create or Modify System Process",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "820f7275-e820-4eff-9bb6-dd4daa1e555b",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.509,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.925,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:07.237248",
            "tools": [
              "At",
              "Cobalt Strike",
              "cobalt strike",
              "ntds.dit",
              "pass-the-ticket",
              "rundll32",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "rundll32"
              ],
              "credential_tools": [
                "ntds.dit",
                "pass-the-ticket"
              ],
              "c2_tools": [
                "cobalt strike"
              ],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [
                "NTDS.dit"
              ],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Application Layer Protocol",
              "context": "Detected Application Layer Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "daf4a80f-3de9-40fe-8bd2-139c9e14faa4",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "description_original": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.504,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.925,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:07.237248",
            "tools": [
              "At",
              "Cobalt Strike",
              "cobalt strike",
              "ntds.dit",
              "pass-the-ticket",
              "rundll32",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "rundll32"
              ],
              "credential_tools": [
                "ntds.dit",
                "pass-the-ticket"
              ],
              "c2_tools": [
                "cobalt strike"
              ],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [
                "NTDS.dit"
              ],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Exploit Public-Facing Application",
              "context": "Detected Exploit Public-Facing Application",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT29 - Supply Chain Attack Using Cobalt Strike Details: Threat Intelligence Report: APT29 Campaign Overview: This campaign demonstrates supply chain attack techniques attributed to APT29 (Cozy Bear). The threat actor is leveraging Cobalt Strike to compromise software supply chains and deploy backdoors. TTPs Observed: - Initial Access: Compromise of trusted software vendors - Execution: Malicious DLL loading  rundll32 execution - Persistence: Service creation  bootkit installation - Privilege Escalation: Exploitation of vulnerable drivers - Defense Evasion: Timestomp  indicator removal - Credential Access: DCSync attacks  NTDS.dit extraction - Discovery: Active Directory enumeration  cloud service discovery - Lateral Movement: Pass-the-ticket  SSH hijacking - Collection: Email collection  browser credential theft - Exfiltration: Exfiltration over alternative protocol Indicators of Compromise: - Compromised software update servers - Cobalt Strike beacon configurations - Malicious certificates used for code signing - DNS tunneling traffic patterns",
            "sentences": [
              "APT29 - Supply Chain Attack Using Cobalt Strike Details: Threat Intelligence Report: APT29 Campaign Overview: This campaign demonstrates supply chain attack techniques attributed to APT29 (Cozy Bear)",
              "The threat actor is leveraging Cobalt Strike to compromise software supply chains and deploy backdoors",
              "TTPs Observed: - Initial Access: Compromise of trusted software vendors - Execution: Malicious DLL loading  rundll32 execution - Persistence: Service creation  bootkit installation - Privilege Escalation: Exploitation of vulnerable drivers - Defense Evasion: Timestomp  indicator removal - Credential Access: DCSync attacks  NTDS.dit extraction - Discovery: Active Directory enumeration  cloud service discovery - Lateral Movement: Pass-the-ticket  SSH hijacking - Collection: Email collection  browser credential theft - Exfiltration: Exfiltration over alternative protocol Indicators of Compromise: - Compromised software update servers - Cobalt Strike beacon configurations - Malicious certificates used for code signing - DNS tunneling traffic patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [
              "NTDS.dit"
            ],
            "security_keywords": [
              "credential",
              "cobalt",
              "persistence",
              "exploitation",
              "lateral",
              "extract",
              "installation",
              "backdoor",
              "privilege",
              "service",
              "beacon",
              "evasion",
              "dll"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Cobalt Strike",
              "backdoor",
              "beacon",
              "rat"
            ],
            "tools": [
              "At",
              "Cobalt Strike",
              "rundll32",
              "sc"
            ],
            "threat_actors": [
              "APT29",
              "Cozy Bear"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [
              "NTDS.dit"
            ],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Network Indicators:**\n- NTDS.dit\n\n**Key Security Terms:** credential, cobalt, persistence, exploitation, lateral, extract, installation, backdoor, privilege, service"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:07.237248",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 4,
          "nlp_ttps": 4,
          "gemini_ttps": 0,
          "ttps_after_filtering": 4,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.0050000000000001,
          "llm_processing_time_ms": 5673.935
        }
      }
    },
    {
      "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
      "title": "FIN7 - Point-of-Sale Malware Campaign",
      "ttps_count": 7,
      "high_confidence_count": 0,
      "processing_time_ms": 5771.294,
      "extraction": {
        "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
        "source_report": {
          "title": "FIN7 - Point-of-Sale Malware Campaign",
          "source": "MISP",
          "confidence": 88
        },
        "extracted_ttps": [
          {
            "ttp_id": "54b1783f-208f-4dd4-8f24-e9af3d6a4c11",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching. FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.538,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.011476",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Registry Run Keys",
              "immediate_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
              "paragraph_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
              "full_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process inj",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "0f8a8f7f-5a54-4e67-ba88-39140667fdf6",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.637,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.538,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
              "paragraph_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
              "full_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process inj",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "2cff2d4d-9a64-4daf-9af5-74c857e7b372",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching. FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
            "description_original": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.539,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.538,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Process Injection",
              "immediate_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
              "paragraph_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
              "full_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process inj",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "05c5b417-e3d9-4435-a4e3-7b1a5313b3d1",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Screen Capture",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching. FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
            "description_original": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.528,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.538,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Screen Capture activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Screen Capture",
              "immediate_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: -...",
              "paragraph_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
              "full_context": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process inj",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "d92a7930-62c3-489d-9464-e46571b2b4de",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.504,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.318,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Application Layer Protocol",
              "context": "Detected Application Layer Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "bbcc0f81-d1a6-4ab5-937b-a047caf9f26d",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "description_original": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.501,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.318,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "User Execution: Malicious File",
              "context": "Detected User Execution: Malicious File",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "40ca6261-7d67-4b2f-a2c0-8310ec65e052",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "description_original": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.501,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.89,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.318,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "defense_evasion": [
                  "Obfuscate"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:13.012530",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Obfuscated Files or Information",
              "context": "Detected Obfuscated Files or Information",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
            "sentences": [
              "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak)",
              "The threat actor is targeting retail and hospitality sectors to harvest payment card data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "persistence",
              "process",
              "registry",
              "lateral",
              "c2",
              "malware",
              "privilege",
              "harvest",
              "macro",
              "inject",
              "evasion",
              "script"
            ]
          },
          "entities": {
            "malware": [
              "Malware",
              "apt",
              "rat"
            ],
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "threat_actors": [
              "Carbanak",
              "FIN7"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Screen Capture"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** credential, persistence, process, registry, lateral, c2, malware, privilege, harvest, macro"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:13.012530",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 7,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 0.9940000000000001,
          "llm_processing_time_ms": 5747.264999999999
        }
      }
    },
    {
      "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
      "title": "Emotet - Large Scale Phishing Campaign",
      "ttps_count": 5,
      "high_confidence_count": 0,
      "processing_time_ms": 5755.569,
      "extraction": {
        "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
        "source_report": {
          "title": "Emotet - Large Scale Phishing Campaign",
          "source": "MISP",
          "confidence": 82
        },
        "extracted_ttps": [
          {
            "ttp_id": "e8cd116e-3f55-40b2-9c7e-5e3cb42b329e",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.648,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.86,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.643,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:18.771105",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
              "paragraph_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains",
              "full_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Accoun",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "6cf37c50-e358-4ac3-80c7-e6544892e04f",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching. Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.86,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.543,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:18.771105",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Registry Run Keys",
              "immediate_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
              "paragraph_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains",
              "full_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Accoun",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "50ebec32-19ae-4a13-99b6-0d2c82cc098b",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.617,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.86,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.323,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:18.771105",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "OS Credential Dumping",
              "context": "Detected OS Credential Dumping",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "ff2c5eb5-fb75-4818-b674-cf5fc4d5ceef",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching. Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.533,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.86,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.543,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:18.771105",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Application Layer Protocol",
              "immediate_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: ...",
              "paragraph_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains",
              "full_context": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Accoun",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "2fece50f-8aff-496f-a65d-cad505727e36",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "description_original": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.507,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.86,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.323,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:18.771105",
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Create or Modify System Process",
              "context": "Detected Create or Modify System Process",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains",
            "sentences": [
              "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations",
              "The malware is being distributed through malicious email attachments and links",
              "TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "dump",
              "persistence",
              "registry",
              "lateral",
              "c2",
              "malware",
              "task",
              "privilege",
              "service",
              "loader",
              "macro",
              "evasion",
              "dll"
            ]
          },
          "entities": {
            "malware": [
              "Emotet",
              "loader",
              "malware",
              "rat"
            ],
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Services"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** credential, dump, persistence, registry, lateral, c2, malware, task, privilege, service"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:18.771105",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 9,
          "nlp_ttps": 9,
          "gemini_ttps": 0,
          "ttps_after_filtering": 5,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.0399999999999998,
          "llm_processing_time_ms": 5734.530000000001
        }
      }
    },
    {
      "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
      "title": "REvil/Sodinokibi - Ransomware as a Service Operation",
      "ttps_count": 7,
      "high_confidence_count": 0,
      "processing_time_ms": 5748.981,
      "extraction": {
        "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
        "source_report": {
          "title": "REvil/Sodinokibi - Ransomware as a Service Operation",
          "source": "MISP",
          "confidence": 93
        },
        "extracted_ttps": [
          {
            "ttp_id": "486b0e46-c363-4e30-9e0e-5cc4ff078b3a",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching. REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.658,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "OS Credential Dumping",
              "immediate_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
              "paragraph_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
              "full_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Esc",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "fd9af4b7-8c9a-40cb-a847-f598d046caed",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching. REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
            "description_original": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.641,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "command_execution": [
                  "PowerShell"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "PowerShell",
              "immediate_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
              "paragraph_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
              "full_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Esc",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "b1be846a-f438-4ea4-b5fa-b4c023fe04d4",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "description_original": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.325,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Remote Desktop Protocol",
              "context": "Detected Remote Desktop Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "391b5d28-4b97-42d5-9df1-439a965a5cdd",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching. REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
            "description_original": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.536,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Exploit Public-Facing Application",
              "immediate_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
              "paragraph_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
              "full_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Esc",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "e520435b-1965-4fea-aac8-16d3a6b38286",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching. REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
            "description_original": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.536,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Archive Collected Data",
              "immediate_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TT...",
              "paragraph_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
              "full_context": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Esc",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.12
            },
            "context_confidence_boost": 0.12,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "cb3a6507-85e1-4966-bf4b-2bc87127655b",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "description_original": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.515,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.325,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Create or Modify System Process",
              "context": "Detected Create or Modify System Process",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "7bd22f7f-4c2c-4f8c-8822-29418a71ab23",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.508,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.915,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.325,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:24.524088",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "powershell",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Application Layer Protocol",
              "context": "Detected Application Layer Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
            "sentences": [
              "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group",
              "Targets include enterprise networks with double-extortion tactics",
              "TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "ransomware",
              "executable",
              "create",
              "dump",
              "persistence",
              "lateral",
              "privilege",
              "service",
              "encrypt",
              "powershell",
              "evasion"
            ]
          },
          "entities": {
            "malware": [
              "REvil",
              "Ransomware",
              "Sodinokibi",
              "rat"
            ],
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "sc"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** credential, ransomware, executable, create, dump, persistence, lateral, privilege, service, encrypt"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:24.524088",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 7,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.0,
          "llm_processing_time_ms": 5728.882
        }
      }
    },
    {
      "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
      "title": "APT41 - Dual Espionage and Financial Crime Operation",
      "ttps_count": 3,
      "high_confidence_count": 0,
      "processing_time_ms": 5408.338,
      "extraction": {
        "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
        "source_report": {
          "title": "APT41 - Dual Espionage and Financial Crime Operation",
          "source": "MISP",
          "confidence": 87
        },
        "extracted_ttps": [
          {
            "ttp_id": "37c3b236-a031-4c3e-8469-9ba98a09ce0c",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching. APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunic...",
            "description_original": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.539,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.885,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:29.935327",
            "tools": [
              "at",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "at",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Process Injection",
              "immediate_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunic...",
              "paragraph_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators",
              "full_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modif",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "2835ddae-dd28-407d-87ce-848dc621d012",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching. APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunic...",
            "description_original": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.531,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.885,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.545,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:29.935327",
            "tools": [
              "at",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "at",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Exploit Public-Facing Application",
              "immediate_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunic...",
              "paragraph_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators",
              "full_context": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modif",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "195256c2-662c-4e4b-a038-3291d0679c39",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "description_original": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.502,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.885,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.325,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:29.935327",
            "tools": [
              "at",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "at",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Exfiltration Over C2 Channel",
              "context": "Detected Exfiltration Over C2 Channel",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators",
            "sentences": [
              "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime",
              "The group targets healthcare  telecommunications  and gaming industries",
              "TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "create",
              "persistence",
              "process",
              "lateral",
              "rootkit",
              "malware",
              "privilege",
              "modify",
              "inject",
              "evasion",
              "script"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Rootkit",
              "malware",
              "rat"
            ],
            "tools": [
              "at",
              "sc"
            ],
            "threat_actors": [
              "APT41"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ]
          },
          "context": "\n**Key Security Terms:** credential, create, persistence, process, lateral, rootkit, malware, privilege, modify, inject"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:29.935327",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 3,
          "nlp_ttps": 3,
          "gemini_ttps": 0,
          "ttps_after_filtering": 3,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.002,
          "llm_processing_time_ms": 5394.353
        }
      }
    },
    {
      "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
      "title": "Maze Ransomware - Corporate Network Breach",
      "ttps_count": 4,
      "high_confidence_count": 0,
      "processing_time_ms": 5773.754,
      "extraction": {
        "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
        "source_report": {
          "title": "Maze Ransomware - Corporate Network Breach",
          "source": "MISP",
          "confidence": 79
        },
        "extracted_ttps": [
          {
            "ttp_id": "4bfc021b-70a8-449e-b0eb-9302a529d464",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching. Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Acce...",
            "description_original": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.845,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:35.713089",
            "tools": [
              "Net",
              "at",
              "lsass",
              "ping",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Remote Desktop Protocol",
              "immediate_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Acce...",
              "paragraph_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns",
              "full_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy mo",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.18
            },
            "context_confidence_boost": 0.18,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "b9908d8b-5fd5-4614-8ca7-cf9ec34820b5",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "description_original": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.614,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.845,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.32,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "credential_dump": [
                  "Dump",
                  "Credential"
                ]
              }
            },
            "indicator_score": 0.65,
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:35.713089",
            "tools": [
              "Net",
              "at",
              "lsass",
              "ping",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "OS Credential Dumping",
              "context": "Detected OS Credential Dumping",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "b661167f-7c62-4bcf-bbf1-05be7d1d05d0",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching. Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Acce...",
            "description_original": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.525,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.845,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:35.713089",
            "tools": [
              "Net",
              "at",
              "lsass",
              "ping",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Windows Management Instrumentation",
              "immediate_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Acce...",
              "paragraph_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns",
              "full_context": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy mo",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.18
            },
            "context_confidence_boost": 0.18,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "c83aa8ac-cf09-4bf6-9f11-0f224198b0d3",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "description_original": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.504,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.845,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.32,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:35.713089",
            "tools": [
              "Net",
              "at",
              "lsass",
              "ping",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [],
              "credential_tools": [
                "lsass"
              ],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "Net",
                "at",
                "ping",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Create or Modify System Process",
              "context": "Detected Create or Modify System Process",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns",
            "sentences": [
              "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption",
              "TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "ransomware",
              "dump",
              "persistence",
              "lateral",
              "privilege",
              "modify",
              "service",
              "encrypt",
              "evasion"
            ]
          },
          "entities": {
            "malware": [
              "Maze",
              "Ransomware",
              "rat"
            ],
            "tools": [
              "Net",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "execution": [
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** credential, ransomware, dump, persistence, lateral, privilege, modify, service, encrypt, evasion"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:35.713089",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 4,
          "nlp_ttps": 4,
          "gemini_ttps": 0,
          "ttps_after_filtering": 4,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.0050000000000001,
          "llm_processing_time_ms": 5762.648
        }
      }
    },
    {
      "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
      "title": "OilRig - Middle East Targeted Espionage",
      "ttps_count": 5,
      "high_confidence_count": 0,
      "processing_time_ms": 5484.200000000001,
      "extraction": {
        "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
        "source_report": {
          "title": "OilRig - Middle East Targeted Espionage",
          "source": "MISP",
          "confidence": 84
        },
        "extracted_ttps": [
          {
            "ttp_id": "7df0ab15-3c59-44b3-a8b1-100eff250bc5",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching. OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
            "description_original": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.647,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.87,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.542,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "persistence": [
                  "Registry"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:41.201196",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "powershell",
              "reg",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Registry Run Keys",
              "immediate_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
              "paragraph_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates",
              "full_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web servic",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "249751fb-6b00-42ed-b92a-596dca21f9a5",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching. OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
            "description_original": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.634,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.87,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.542,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:41.201196",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "powershell",
              "reg",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "Phishing",
              "immediate_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
              "paragraph_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates",
              "full_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web servic",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "46ef61f1-f77d-4d01-a646-09ddd6bbf55e",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "attack_id_validated": true,
            "attack_id_confidence": 1.0,
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching. OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
            "description_original": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.634,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.87,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.542,
              "multiple_sources": 0.5
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {
                "command_execution": [
                  "PowerShell"
                ]
              }
            },
            "indicator_score": 0.6000000000000001,
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:41.201196",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "powershell",
              "reg",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": true,
              "technique": "PowerShell",
              "immediate_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with ...",
              "paragraph_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates",
              "full_context": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web servic",
              "context_richness_score": 1.0,
              "confidence_modifier": 0.1
            },
            "context_confidence_boost": 0.1,
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "0adea355-f638-41fc-bc17-504691d022c3",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "description_original": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.508,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.87,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:41.201196",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "powershell",
              "reg",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Create or Modify System Process",
              "context": "Detected Create or Modify System Process",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "4b5e166b-5b91-4504-a84d-5f46e1000e42",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "attack_id_validated": false,
            "attack_id_confidence": 1.0,
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "description_original": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.501,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.87,
              "attack_mapping": 0.4,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.322,
              "multiple_sources": 0.375
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "extracted_indicators": {
              "file_hashes": {},
              "network": {},
              "registry": {},
              "malware": {},
              "techniques": {}
            },
            "indicator_score": 0.5,
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-29T15:37:41.201196",
            "tools": [
              "PowerShell",
              "at",
              "net",
              "powershell",
              "reg",
              "sc"
            ],
            "tools_by_category": {
              "admin_tools": [],
              "living_off_land": [
                "powershell"
              ],
              "credential_tools": [],
              "c2_tools": [],
              "exploitation": [],
              "network_tools": [],
              "obfuscation": [],
              "data_exfiltration": [],
              "mentioned": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ]
            },
            "extracted_iocs": {
              "hashes": {},
              "ips": [],
              "domains": [],
              "emails": [],
              "urls": [],
              "registry": [],
              "files": []
            },
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "extraction_context": {
              "found": false,
              "technique": "Application Layer Protocol",
              "context": "Detected Application Layer Protocol",
              "confidence_modifier": 0.7
            },
            "context_confidence_boost": 0.7,
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates",
            "sentences": [
              "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region",
              "TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "credential",
              "persistence",
              "exploitation",
              "registry",
              "lateral",
              "c2",
              "backdoor",
              "privilege",
              "service",
              "macro",
              "powershell",
              "evasion"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "backdoor",
              "rat"
            ],
            "tools": [
              "PowerShell",
              "at",
              "net",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "APT34"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys",
              "Create or Modify System Process"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** credential, persistence, exploitation, registry, lateral, c2, backdoor, privilege, service, macro"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-29T15:37:41.201196",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 5,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 0.998,
          "llm_processing_time_ms": 5465.297
        }
      }
    }
  ],
  "metadata": {
    "extraction_type": "hybrid_nlp_gemini",
    "model_used": "gemini-2.0-flash-lite",
    "min_confidence_threshold": 0.5,
    "nlp_enabled": true,
    "validators_applied": [
      "AttackIdValidator",
      "IndicatorExtractor",
      "AdvancedTechniqueDiscovery"
    ],
    "validator_integration_point": "_format_ttp_for_handoff()",
    "output_fields_per_ttp": [
      "ttp_id",
      "report_id",
      "technique_name",
      "attack_id",
      "attack_id_validated",
      "attack_id_confidence",
      "tactic",
      "description",
      "confidence_score",
      "extracted_indicators",
      "indicator_score",
      "extraction_method",
      "tools",
      "related_entities",
      "extracted_timestamp"
    ]
  }
}