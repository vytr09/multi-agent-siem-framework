{
  "test_timestamp": "2025-11-07T17:34:23.051001",
  "total_reports": 10,
  "total_ttps": 77,
  "total_processing_time_seconds": 55.509585,
  "agent_statistics": {
    "total_reports_processed": 10,
    "total_ttps_extracted": 77,
    "nlp_entities_extracted": 97,
    "nlp_ttp_indicators_found": 61,
    "gemini_ttps_extracted": 0,
    "extraction_errors": 0,
    "gemini_api_calls": 10,
    "avg_confidence_score": 0.6428571428571429,
    "high_confidence_ttps": 0,
    "processing_time_ms": 5348.967,
    "nlp_processing_time_ms": 28.601000000000003,
    "llm_processing_time_ms": 55462.87899999999,
    "cache_hits": 0,
    "cache_misses": 10,
    "last_extraction_time": "2025-11-07T17:34:23.036393"
  },
  "per_report_results": [
    {
      "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
      "title": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
      "ttps_count": 12,
      "high_confidence_count": 0,
      "processing_time_ms": 5585.886,
      "extraction": {
        "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
        "source_report": {
          "title": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
          "source": "MISP",
          "confidence": 76
        },
        "extracted_ttps": [
          {
            "ttp_id": "9fc34857-5a34-4d1c-90e8-3b5d7536276c",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.074005",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "c87a7baa-abe2-4d2a-b296-0c6ec13c4d46",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.074005",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "ce16e8b9-df3f-412d-b5c3-8cd253724379",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.074005",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "8410c7a2-4eb1-463b-bc7d-b2dafd0580f8",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.074005",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "2a905a2d-30b0-4e59-a901-8a79ef0cda6e",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.074005",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "f595ad3f-4580-416a-ace3-0e0b1c1aa69d",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "2497d583-5891-4957-8f82-00df825225f4",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "1107ac1d-891f-4bb9-8056-51fd0c265480",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "35f8f96d-6112-46de-a8f5-f360309e42aa",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Remote Services",
            "attack_id": "UNMAPPED",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Services activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "4c03fe5a-c620-48ab-b2dc-107b98c26b8d",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "d11e52d1-f244-4d55-addb-ab24ba048e16",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "7451fe3c-8947-477d-804f-a4586490f4a4",
            "report_id": "df089452-018b-4519-9147-8fb4883bf05c",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "lazarus group",
              "malware_used": [
                "mimikatz",
                "Mimikatz"
              ],
              "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:33.075304",
            "tools": [],
            "related_entities": {
              "malware": [
                "Mimikatz",
                "malware",
                "rat"
              ],
              "tools": [
                "Mimikatz",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Lazarus Group"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group. The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "Lazarus Group - Credential Harvesting Campaign Using Mimikatz Details: Threat Intelligence Report: Lazarus Group Campaign Overview: This campaign demonstrates credential harvesting techniques attributed to Lazarus Group",
              "The threat actor is leveraging Mimikatz to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "mimikatz",
              "create",
              "evasion",
              "inject",
              "compress",
              "harvest",
              "script",
              "establish",
              "privilege",
              "lateral",
              "wmi",
              "persistence",
              "exfiltrate",
              "c2",
              "powershell",
              "task",
              "registry",
              "credential",
              "malware",
              "dump",
              "process"
            ]
          },
          "entities": {
            "malware": [
              "Mimikatz",
              "malware",
              "rat"
            ],
            "tools": [
              "Mimikatz",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "Lazarus Group"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** mimikatz, create, evasion, inject, compress, harvest, script, establish, privilege, lateral"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:33:33.075304",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 12,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.001,
          "llm_processing_time_ms": 5582.585
        }
      }
    },
    {
      "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
      "title": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan",
      "ttps_count": 12,
      "high_confidence_count": 0,
      "processing_time_ms": 5605.736,
      "extraction": {
        "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
        "source_report": {
          "title": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan",
          "source": "MISP",
          "confidence": 91
        },
        "extracted_ttps": [
          {
            "ttp_id": "585ad9b3-2059-4a88-871b-c598cf7b2233",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "31e23a2a-8a56-4569-ba34-5ac0c329060b",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "9940ab80-9aed-4e1f-9d1e-cbcbdaa5ece8",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "0fd770f1-f42f-446d-84bc-95f3b975da2c",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "2e805769-0a02-457f-aed9-deb78423faf0",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "42e4276d-c343-4a8b-bc9f-cdea2a917a42",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9b2b4275-3310-4454-993f-14796382a219",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "6565bafa-1e50-4160-9129-1c45124288d2",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "1deb7336-ea23-4732-ab76-10810f54402a",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Remote Services",
            "attack_id": "UNMAPPED",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Services activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9073cf5f-af6c-47d0-8ca1-f22c01a88aeb",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "4ec5720c-2a7f-4cff-aa20-a3af87df8d5a",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "7d9782e1-9f03-429b-b168-62ea9e47a671",
            "report_id": "73a57d51-2d08-4389-9255-79c674c574d9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "shadow brokers",
              "malware_used": [
                "banking trojan",
                "Banking Trojan",
                "Banking"
              ],
              "campaign": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:38.683048",
            "tools": [],
            "related_entities": {
              "malware": [
                "Banking Trojan",
                "Trojan",
                "malware",
                "rat"
              ],
              "tools": [
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "Shadow Brokers"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers. The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "Shadow Brokers - Data Exfiltration Campaign Using Banking Trojan Details: Threat Intelligence Report: Shadow Brokers Campaign Overview: This campaign demonstrates data exfiltration techniques attributed to Shadow Brokers",
              "The threat actor is leveraging Banking Trojan to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "trojan",
              "create",
              "evasion",
              "inject",
              "compress",
              "harvest",
              "script",
              "establish",
              "privilege",
              "lateral",
              "wmi",
              "persistence",
              "exfiltrate",
              "c2",
              "powershell",
              "task",
              "registry",
              "credential",
              "malware",
              "dump",
              "process"
            ]
          },
          "entities": {
            "malware": [
              "Banking Trojan",
              "Trojan",
              "malware",
              "rat"
            ],
            "tools": [
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "Shadow Brokers"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** trojan, create, evasion, inject, compress, harvest, script, establish, privilege, lateral"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:33:38.683048",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 12,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.9989999999999999,
          "llm_processing_time_ms": 5603.737
        }
      }
    },
    {
      "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
      "title": "APT28 - Initial Access Campaign Using RAT",
      "ttps_count": 12,
      "high_confidence_count": 0,
      "processing_time_ms": 5485.407,
      "extraction": {
        "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
        "source_report": {
          "title": "APT28 - Initial Access Campaign Using RAT",
          "source": "MISP",
          "confidence": 71
        },
        "extracted_ttps": [
          {
            "ttp_id": "d29ca726-1f3c-4924-a068-0fd7aef7bae7",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "ebb46b29-edf6-4279-ba1e-e76bc07c06da",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "b0223b90-227e-4c75-801c-a9a038f8f6f2",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "fed20657-e2bf-471e-8b7c-5b2d0e19f0f5",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "9dc91667-5ed7-4fa8-a5d9-54ccbfe69a94",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "4a178323-83be-4b04-a62d-72edb6a0346e",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "39ef0f70-8b5f-44ba-9b71-77278b588a6e",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.170547",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "e9eb1d4b-91a2-4a0f-af7d-e3d9151aa14b",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.171455",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "c308c7c2-e341-42f0-86e3-cc784375b012",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Remote Services",
            "attack_id": "UNMAPPED",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Services activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.171455",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "adeb81c7-45d9-4211-a8bc-dc742cbfc19d",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.171455",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9b9524f2-4a81-4584-82bd-2f5f40c4bb2a",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.171455",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "ff5f9abd-180e-4e0b-9791-35da6cad6f55",
            "report_id": "bdddfeb4-8878-4ec3-9669-bc9e7fe8f8d9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt28",
              "malware_used": [
                "rat",
                "RAT"
              ],
              "campaign": "APT28 - Initial Access Campaign Using RAT"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:44.171455",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "RAT",
                "malware"
              ],
              "tools": [
                "AT",
                "Net",
                "PowerShell",
                "Reg",
                "WMI",
                "ping",
                "sc"
              ],
              "threat_actors": [
                "APT28"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28. The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data. TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern",
            "sentences": [
              "APT28 - Initial Access Campaign Using RAT Details: Threat Intelligence Report: APT28 Campaign Overview: This campaign demonstrates initial access techniques attributed to APT28",
              "The threat actor is leveraging RAT to establish persistence and exfiltrate sensitive data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious attachments - Execution: PowerShell script execution  WMI command execution - Persistence: Registry modification  scheduled task creation - Privilege Escalation: Token manipulation  UAC bypass - Defense Evasion: Process hollowing  code injection - Credential Access: LSASS dumping  credential harvesting - Discovery: Network enumeration  system information gathering - Lateral Movement: Remote desktop  Windows admin shares - Collection: Data staging  file compression - Exfiltration: Data transfer over C2 channel Indicators of Compromise: - Malicious domains used for C2 communication - File hashes of dropped malware samples - Registry keys created for persistence - Network signatures of C2 traffic Contains 8 attributes (8 IOCs) Objects: malware  attack-pattern"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [
              "PowerShell script execution, WMI command execution"
            ],
            "network_artifacts": [],
            "security_keywords": [
              "create",
              "evasion",
              "inject",
              "compress",
              "harvest",
              "script",
              "establish",
              "privilege",
              "lateral",
              "wmi",
              "persistence",
              "exfiltrate",
              "c2",
              "powershell",
              "task",
              "registry",
              "credential",
              "malware",
              "dump",
              "process"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "RAT",
              "malware"
            ],
            "tools": [
              "AT",
              "Net",
              "PowerShell",
              "Reg",
              "WMI",
              "ping",
              "sc"
            ],
            "threat_actors": [
              "APT28"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- PowerShell script execution, WMI command execution\n\n**Key Security Terms:** create, evasion, inject, compress, harvest, script, establish, privilege, lateral, wmi"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:33:44.171455",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 12,
          "nlp_ttps": 12,
          "gemini_ttps": 0,
          "ttps_after_filtering": 12,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 0.9990000000000001,
          "llm_processing_time_ms": 5483.5
        }
      }
    },
    {
      "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
      "title": "APT29 - Supply Chain Attack Using Cobalt Strike",
      "ttps_count": 4,
      "high_confidence_count": 0,
      "processing_time_ms": 5738.450000000001,
      "extraction": {
        "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
        "source_report": {
          "title": "APT29 - Supply Chain Attack Using Cobalt Strike",
          "source": "MISP",
          "confidence": 95
        },
        "extracted_ttps": [
          {
            "ttp_id": "815507f4-00f3-4537-904d-db7928550fd4",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:49.917337",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {
              "network": [
                "NTDS.dit"
              ]
            },
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "640a9b07-3d30-4d02-9b2b-6bff49e99eb6",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:49.917337",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {
              "network": [
                "NTDS.dit"
              ]
            },
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "637c1fc2-ea60-4e57-bb78-f94e0f2d4a80",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:49.917337",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {
              "network": [
                "NTDS.dit"
              ]
            },
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "817fe410-e45d-446b-b8a5-9d559b533f13",
            "report_id": "a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt29",
              "malware_used": [
                "cobalt strike",
                "Cobalt Strike"
              ],
              "campaign": "APT29 - Supply Chain Attack Using Cobalt Strike"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:49.917337",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Cobalt Strike",
                "backdoor",
                "beacon",
                "rat"
              ],
              "tools": [
                "At",
                "Cobalt Strike",
                "rundll32",
                "sc"
              ],
              "threat_actors": [
                "APT29",
                "Cozy Bear"
              ]
            },
            "correlated_iocs": {
              "network": [
                "NTDS.dit"
              ]
            },
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT29 - Supply Chain Attack Using Cobalt Strike Details: Threat Intelligence Report: APT29 Campaign Overview: This campaign demonstrates supply chain attack techniques attributed to APT29 (Cozy Bear). The threat actor is leveraging Cobalt Strike to compromise software supply chains and deploy backdoors. TTPs Observed: - Initial Access: Compromise of trusted software vendors - Execution: Malicious DLL loading  rundll32 execution - Persistence: Service creation  bootkit installation - Privilege Escalation: Exploitation of vulnerable drivers - Defense Evasion: Timestomp  indicator removal - Credential Access: DCSync attacks  NTDS.dit extraction - Discovery: Active Directory enumeration  cloud service discovery - Lateral Movement: Pass-the-ticket  SSH hijacking - Collection: Email collection  browser credential theft - Exfiltration: Exfiltration over alternative protocol Indicators of Compromise: - Compromised software update servers - Cobalt Strike beacon configurations - Malicious certificates used for code signing - DNS tunneling traffic patterns",
            "sentences": [
              "APT29 - Supply Chain Attack Using Cobalt Strike Details: Threat Intelligence Report: APT29 Campaign Overview: This campaign demonstrates supply chain attack techniques attributed to APT29 (Cozy Bear)",
              "The threat actor is leveraging Cobalt Strike to compromise software supply chains and deploy backdoors",
              "TTPs Observed: - Initial Access: Compromise of trusted software vendors - Execution: Malicious DLL loading  rundll32 execution - Persistence: Service creation  bootkit installation - Privilege Escalation: Exploitation of vulnerable drivers - Defense Evasion: Timestomp  indicator removal - Credential Access: DCSync attacks  NTDS.dit extraction - Discovery: Active Directory enumeration  cloud service discovery - Lateral Movement: Pass-the-ticket  SSH hijacking - Collection: Email collection  browser credential theft - Exfiltration: Exfiltration over alternative protocol Indicators of Compromise: - Compromised software update servers - Cobalt Strike beacon configurations - Malicious certificates used for code signing - DNS tunneling traffic patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [
              "NTDS.dit"
            ],
            "security_keywords": [
              "evasion",
              "backdoor",
              "installation",
              "extract",
              "cobalt",
              "privilege",
              "lateral",
              "persistence",
              "exploitation",
              "dll",
              "service",
              "credential",
              "beacon"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Cobalt Strike",
              "backdoor",
              "beacon",
              "rat"
            ],
            "tools": [
              "At",
              "Cobalt Strike",
              "rundll32",
              "sc"
            ],
            "threat_actors": [
              "APT29",
              "Cozy Bear"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [
              "NTDS.dit"
            ],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Network Indicators:**\n- NTDS.dit\n\n**Key Security Terms:** evasion, backdoor, installation, extract, cobalt, privilege, lateral, persistence, exploitation, dll"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:33:49.917337",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 4,
          "nlp_ttps": 4,
          "gemini_ttps": 0,
          "ttps_after_filtering": 4,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 5.54,
          "llm_processing_time_ms": 5730.909
        }
      }
    },
    {
      "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
      "title": "FIN7 - Point-of-Sale Malware Campaign",
      "ttps_count": 7,
      "high_confidence_count": 0,
      "processing_time_ms": 5553.334000000001,
      "extraction": {
        "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
        "source_report": {
          "title": "FIN7 - Point-of-Sale Malware Campaign",
          "source": "MISP",
          "confidence": 88
        },
        "extracted_ttps": [
          {
            "ttp_id": "f68591f6-29d4-49d3-b0ce-dead5d3eb654",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "dfc5acca-d825-40c4-8003-5976048ff677",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "aeae3fe9-f2d1-4b30-abfb-67be2346910f",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9ea87f92-194b-4614-bc61-86b9605cbeb6",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "dafcf96a-c5b2-47a6-b6f9-d5d3921a4a31",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "554610d0-02af-457b-8f69-28cd250ea627",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Screen Capture",
            "attack_id": "UNMAPPED",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Screen Capture activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "85b5fea2-e574-4963-b4e0-24144d200b64",
            "report_id": "f1e2d3c4-b5a6-9786-5432-1098fedcba98",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "fin7",
              "malware_used": [
                "carbanak",
                "pos malware"
              ],
              "campaign": "FIN7 - Point-of-Sale Malware Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:33:55.472672",
            "tools": [],
            "related_entities": {
              "malware": [
                "Malware",
                "apt",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": [
                "Carbanak",
                "FIN7"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak). The threat actor is targeting retail and hospitality sectors to harvest payment card data. TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns",
            "sentences": [
              "FIN7 - Point-of-Sale Malware Campaign Details: Threat Intelligence Report: FIN7 Campaign Overview: This campaign demonstrates point-of-sale compromise techniques attributed to FIN7 (Carbanak)",
              "The threat actor is targeting retail and hospitality sectors to harvest payment card data",
              "TTPs Observed: - Initial Access: Spear phishing with malicious Word documents - Execution: VBA macro execution  JavaScript execution - Persistence: Registry Run keys  COM hijacking - Privilege Escalation: Process injection - Defense Evasion: Obfuscated files  NTFS file attributes - Credential Access: Keylogging  memory scraping - Discovery: System network configuration discovery - Lateral Movement: Windows Remote Management - Collection: Screen capture  data from local system - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Malicious Office documents with embedded macros - Memory scraping malware signatures - POS malware file hashes - C2 domain patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "evasion",
              "inject",
              "harvest",
              "script",
              "privilege",
              "lateral",
              "persistence",
              "c2",
              "registry",
              "credential",
              "macro",
              "malware",
              "process"
            ]
          },
          "entities": {
            "malware": [
              "Malware",
              "apt",
              "rat"
            ],
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "threat_actors": [
              "Carbanak",
              "FIN7"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Screen Capture"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** evasion, inject, harvest, script, privilege, lateral, persistence, c2, registry, credential"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:33:55.472672",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 7,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 1.0939999999999999,
          "llm_processing_time_ms": 5550.324
        }
      }
    },
    {
      "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
      "title": "Emotet - Large Scale Phishing Campaign",
      "ttps_count": 9,
      "high_confidence_count": 0,
      "processing_time_ms": 5683.085,
      "extraction": {
        "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
        "source_report": {
          "title": "Emotet - Large Scale Phishing Campaign",
          "source": "MISP",
          "confidence": 82
        },
        "extracted_ttps": [
          {
            "ttp_id": "21900cca-128f-4936-95f7-8ed5dd347f4b",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "8c587aa0-6f27-4ff0-8bab-9353f32696b6",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "2a03dde7-71a5-4dc2-87c4-ab6c27a25176",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "1cd037c0-bb19-456d-b913-4987cc91098b",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "ec4d5fa9-808d-4ec7-956e-201d3fa0eda8",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "b7cd592d-8c0d-44da-8c6e-4978b7c198a2",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "aae376e5-de63-4e51-916a-f0ca438f44c0",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "e846ac70-a2b5-4431-a674-20b1a8165131",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Remote Services",
            "attack_id": "UNMAPPED",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Services activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "f5e0569a-53da-4888-ad3e-3b23300c49a2",
            "report_id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "emotet",
              "malware_used": [
                "emotet",
                "Emotet"
              ],
              "campaign": "Emotet - Large Scale Phishing Campaign"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:01.162753",
            "tools": [],
            "related_entities": {
              "malware": [
                "Emotet",
                "loader",
                "malware",
                "rat"
              ],
              "tools": [
                "Reg",
                "Sc",
                "at",
                "net",
                "ping"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations. The malware is being distributed through malicious email attachments and links. TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains",
            "sentences": [
              "Emotet - Large Scale Phishing Campaign Details: Threat Intelligence Report: Emotet Campaign Overview: This campaign demonstrates the resurgence of Emotet botnet conducting large-scale phishing operations",
              "The malware is being distributed through malicious email attachments and links",
              "TTPs Observed: - Initial Access: Phishing emails with malicious attachments - Execution: User execution of malicious files - Persistence: Registry Run keys  scheduled tasks - Privilege Escalation: Bypass User Account Control - Defense Evasion: File deletion  obfuscated files - Credential Access: Credential dumping - Discovery: System information discovery - Lateral Movement: SMB/Windows Admin Shares - Collection: Email collection  data from local system - Command and Control: Application layer protocol (HTTP/HTTPS) - Impact: Service stop  inhibit system recovery Indicators of Compromise: - Malicious email subject patterns - Document file hashes with malicious macros - Emotet loader DLL signatures - C2 IP addresses and domains"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "loader",
              "evasion",
              "privilege",
              "lateral",
              "persistence",
              "c2",
              "task",
              "registry",
              "dll",
              "service",
              "credential",
              "macro",
              "malware",
              "dump"
            ]
          },
          "entities": {
            "malware": [
              "Emotet",
              "loader",
              "malware",
              "rat"
            ],
            "tools": [
              "Reg",
              "Sc",
              "at",
              "net",
              "ping"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Services"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** loader, evasion, privilege, lateral, persistence, c2, task, registry, dll, service"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:34:01.162753",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 9,
          "nlp_ttps": 9,
          "gemini_ttps": 0,
          "ttps_after_filtering": 9,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 3.992,
          "llm_processing_time_ms": 5677.179
        }
      }
    },
    {
      "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
      "title": "REvil/Sodinokibi - Ransomware as a Service Operation",
      "ttps_count": 7,
      "high_confidence_count": 0,
      "processing_time_ms": 5681.983,
      "extraction": {
        "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
        "source_report": {
          "title": "REvil/Sodinokibi - Ransomware as a Service Operation",
          "source": "MISP",
          "confidence": 93
        },
        "extracted_ttps": [
          {
            "ttp_id": "f23d8d9e-1b74-4555-bd53-77d62bdfa205",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "86250eac-3523-4f20-8638-d6758850cd53",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "1782cb30-61e8-4dc4-9e83-2b30dc9b84a2",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "99141534-76ab-4d88-b8b4-82311fb53c9e",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "a1cae963-2f75-42d5-acf5-9ea493d820eb",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "988e92f5-5c9f-4626-adce-58ef8d16d6f0",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Archive Collected Data",
            "attack_id": "UNMAPPED",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Archive Collected Data activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "48737de5-17d8-4a0e-9fb6-6e26f1a10883",
            "report_id": "9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "revil",
              "malware_used": [
                "revil",
                "sodinokibi",
                "REvil"
              ],
              "campaign": "REvil/Sodinokibi - Ransomware as a Service Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:06.849824",
            "tools": [],
            "related_entities": {
              "malware": [
                "REvil",
                "Ransomware",
                "Sodinokibi",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group. Targets include enterprise networks with double-extortion tactics. TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure",
            "sentences": [
              "REvil/Sodinokibi - Ransomware as a Service Operation Details: Threat Intelligence Report: REvil/Sodinokibi Campaign Overview: This campaign represents a sophisticated ransomware-as-a-service operation conducted by the REvil group",
              "Targets include enterprise networks with double-extortion tactics",
              "TTPs Observed: - Initial Access: Exploit public-facing applications  RDP compromise - Execution: PowerShell  Windows Command Shell - Persistence: Create account  external remote services - Privilege Escalation: Valid accounts - Defense Evasion: Indicator removal  file deletion - Credential Access: OS credential dumping - Discovery: Network service scanning  file and directory discovery - Lateral Movement: Remote services  taint shared content - Collection: Data from network shared drives  archive collected data - Command and Control: Encrypted channel  web protocols - Impact: Data encrypted for impact  defacement  inhibit system recovery Indicators of Compromise: - REvil ransomware executable hashes - Ransom note templates - Tor-based payment portal domains - Data leak site infrastructure"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "create",
              "ransomware",
              "evasion",
              "privilege",
              "lateral",
              "persistence",
              "powershell",
              "service",
              "credential",
              "encrypt",
              "executable",
              "dump"
            ]
          },
          "entities": {
            "malware": [
              "REvil",
              "Ransomware",
              "Sodinokibi",
              "rat"
            ],
            "tools": [
              "PowerShell",
              "at",
              "net",
              "ping",
              "sc"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** create, ransomware, evasion, privilege, lateral, persistence, powershell, service, credential, encrypt"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:34:06.849824",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 7,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 4.914,
          "llm_processing_time_ms": 5675.07
        }
      }
    },
    {
      "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
      "title": "APT41 - Dual Espionage and Financial Crime Operation",
      "ttps_count": 3,
      "high_confidence_count": 0,
      "processing_time_ms": 5376.242,
      "extraction": {
        "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
        "source_report": {
          "title": "APT41 - Dual Espionage and Financial Crime Operation",
          "source": "MISP",
          "confidence": 87
        },
        "extracted_ttps": [
          {
            "ttp_id": "be0a630b-df2e-4551-a79d-45857c3d79a9",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:12.234082",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "4593f103-d793-40c4-918c-939d7602865f",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Process Injection",
            "attack_id": "UNMAPPED",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Process Injection activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:12.234082",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "7e25e374-287f-4211-92dc-ddfbc301534f",
            "report_id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "UNMAPPED",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "apt41",
              "malware_used": [
                "winnti",
                "crosswalk",
                "spyder loader"
              ],
              "campaign": "APT41 - Dual Espionage and Financial Crime Operation"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:12.234082",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "Rootkit",
                "malware",
                "rat"
              ],
              "tools": [
                "at",
                "sc"
              ],
              "threat_actors": [
                "APT41"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime. The group targets healthcare  telecommunications  and gaming industries. TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators",
            "sentences": [
              "APT41 - Dual Espionage and Financial Crime Operation Details: Threat Intelligence Report: APT41 Campaign Overview: This campaign showcases APT41 s unique dual-purpose operations conducting both state-sponsored espionage and financially motivated cybercrime",
              "The group targets healthcare  telecommunications  and gaming industries",
              "TTPs Observed: - Initial Access: Supply chain compromise  exploit public-facing application - Execution: Command and scripting interpreter - Persistence: Create or modify system process  BITS jobs - Privilege Escalation: Process injection  access token manipulation - Defense Evasion: Rootkit  virtualization/sandbox evasion - Credential Access: Brute force  steal web session cookies - Discovery: Cloud infrastructure discovery  software discovery - Lateral Movement: Use alternate authentication material - Collection: Data from information repositories - Exfiltration: Transfer data to cloud account - Impact: Data manipulation  financial theft Indicators of Compromise: - Custom malware toolset signatures - Cryptocurrency wallet addresses - Gaming platform exploit code - Healthcare data theft indicators"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "modify",
              "create",
              "evasion",
              "inject",
              "script",
              "rootkit",
              "privilege",
              "lateral",
              "persistence",
              "credential",
              "malware",
              "process"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Rootkit",
              "malware",
              "rat"
            ],
            "tools": [
              "at",
              "sc"
            ],
            "threat_actors": [
              "APT41"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ]
          },
          "context": "\n**Key Security Terms:** modify, create, evasion, inject, script, rootkit, privilege, lateral, persistence, credential"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:34:12.234082",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 3,
          "nlp_ttps": 3,
          "gemini_ttps": 0,
          "ttps_after_filtering": 3,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 5.05,
          "llm_processing_time_ms": 5370.189
        }
      }
    },
    {
      "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
      "title": "Maze Ransomware - Corporate Network Breach",
      "ttps_count": 4,
      "high_confidence_count": 0,
      "processing_time_ms": 5444.431,
      "extraction": {
        "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
        "source_report": {
          "title": "Maze Ransomware - Corporate Network Breach",
          "source": "MISP",
          "confidence": 79
        },
        "extracted_ttps": [
          {
            "ttp_id": "10aeadfe-a26b-433c-8823-5bc5d6bb083a",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected OS Credential Dumping activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:17.681511",
            "tools": [],
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "c3fb0375-d84e-4d9d-80d3-a36d224858d5",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:17.681511",
            "tools": [],
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "9bfe5618-71af-4737-a486-474904b87e65",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:17.681511",
            "tools": [],
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "0c12ebf4-d87d-48c5-a55d-c9c2600a67e2",
            "report_id": "5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "maze",
              "malware_used": [
                "maze",
                "Maze"
              ],
              "campaign": "Maze Ransomware - Corporate Network Breach"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:17.681511",
            "tools": [],
            "related_entities": {
              "malware": [
                "Maze",
                "Ransomware",
                "rat"
              ],
              "tools": [
                "Net",
                "at",
                "ping",
                "sc"
              ],
              "threat_actors": []
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption. TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns",
            "sentences": [
              "Maze Ransomware - Corporate Network Breach Details: Threat Intelligence Report: Maze Ransomware Campaign Overview: This campaign demonstrates Maze ransomware operators targeting corporate networks with advanced evasion techniques and data exfiltration before encryption",
              "TTPs Observed: - Initial Access: Valid accounts obtained through credential purchase - Execution: Windows Management Instrumentation - Persistence: Valid accounts  external remote services - Privilege Escalation: Domain policy modification - Defense Evasion: Disable or modify tools  impair defenses - Credential Access: LSASS memory dumping - Discovery: Domain trust discovery  network share discovery - Lateral Movement: Remote Desktop Protocol - Collection: Automated collection  data staged - Exfiltration: Exfiltration over web service - Impact: Data encrypted for impact  data destruction Indicators of Compromise: - Maze ransomware binary signatures - Pre-encryption data staging patterns - Tor-based leak site domains - RDP brute force patterns"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "modify",
              "ransomware",
              "evasion",
              "privilege",
              "lateral",
              "persistence",
              "service",
              "credential",
              "encrypt",
              "dump"
            ]
          },
          "entities": {
            "malware": [
              "Maze",
              "Ransomware",
              "rat"
            ],
            "tools": [
              "Net",
              "at",
              "ping",
              "sc"
            ],
            "threat_actors": [],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "execution": [
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** modify, ransomware, evasion, privilege, lateral, persistence, service, credential, encrypt, dump"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:34:17.681511",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 4,
          "nlp_ttps": 4,
          "gemini_ttps": 0,
          "ttps_after_filtering": 4,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 2.002,
          "llm_processing_time_ms": 5442.429
        }
      }
    },
    {
      "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
      "title": "OilRig - Middle East Targeted Espionage",
      "ttps_count": 7,
      "high_confidence_count": 0,
      "processing_time_ms": 5348.967,
      "extraction": {
        "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
        "source_report": {
          "title": "OilRig - Middle East Targeted Espionage",
          "source": "MISP",
          "confidence": 84
        },
        "extracted_ttps": [
          {
            "ttp_id": "a0a64419-2821-4358-a7aa-0f8a454a56ef",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Phishing",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Phishing activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "a62e0b9f-d123-4579-b684-190dd1be3a1a",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected PowerShell activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "d3f65707-5b46-4a57-944f-2745a88bc927",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.7,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0.1,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Registry Run Keys activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": true,
            "mapping_source": "attack_mapper"
          },
          {
            "ttp_id": "ef5c0520-7a68-4dde-ab1d-45fe6627d627",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "UNMAPPED",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "c7368e3b-9b2d-4da9-a7bd-53e0b7b41ab5",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "UNMAPPED",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "0a785b3b-138b-47d5-a30d-f10557ca687c",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Create or Modify System Process",
            "attack_id": "UNMAPPED",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Create or Modify System Process activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          },
          {
            "ttp_id": "9486cf3e-a0f1-4cea-a64f-d00800a87ebd",
            "report_id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a",
            "technique_name": "Application Layer Protocol",
            "attack_id": "UNMAPPED",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "base": 0.5,
              "method_bonus": 0.05,
              "mapping_bonus": 0,
              "entity_bonus": 0.05
            },
            "evidence_text": "Detected Application Layer Protocol activity via NLP pattern matching",
            "indicators_supporting": [],
            "context": {
              "threat_actor": "oilrig",
              "malware_used": [
                "bondupdater",
                "twoface",
                "powerton"
              ],
              "campaign": "OilRig - Middle East Targeted Espionage"
            },
            "extraction_method": "nlp",
            "extraction_source": "nlp_indicators",
            "mapped_by": "gemini-2.0-flash-lite_nlp_hybrid",
            "extracted_timestamp": "2025-11-07T17:34:23.036393",
            "tools": [],
            "related_entities": {
              "malware": [
                "APT",
                "backdoor",
                "rat"
              ],
              "tools": [
                "PowerShell",
                "at",
                "net",
                "reg",
                "sc"
              ],
              "threat_actors": [
                "APT34"
              ]
            },
            "correlated_iocs": {},
            "subtechnique": false,
            "mapping_source": "none"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region. TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates",
            "sentences": [
              "OilRig - Middle East Targeted Espionage Details: Threat Intelligence Report: OilRig Campaign Overview: This campaign demonstrates targeted espionage operations by OilRig (APT34) focusing on government and energy sectors in the Middle East region",
              "TTPs Observed: - Initial Access: Spear phishing with LinkedIn messages - Execution: PowerShell  VBA macros - Persistence: Web shell deployment  registry run keys - Privilege Escalation: Exploitation for privilege escalation - Defense Evasion: Web service as dead drop resolver - Credential Access: Input capture  credential API hooking - Discovery: Account discovery  permission groups discovery - Lateral Movement: Internal spear phishing - Collection: Email collection  data from network shared drive - Command and Control: Web protocols  DNS tunneling - Exfiltration: Exfiltration over C2 channel Indicators of Compromise: - Custom PowerShell-based backdoors - Web shell file patterns - Tunneling tool signatures - Spear phishing email templates"
            ],
            "technical_terms": [],
            "file_paths": [],
            "registry_keys": [],
            "commands": [],
            "network_artifacts": [],
            "security_keywords": [
              "evasion",
              "backdoor",
              "privilege",
              "lateral",
              "persistence",
              "exploitation",
              "c2",
              "powershell",
              "registry",
              "service",
              "credential",
              "macro"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "backdoor",
              "rat"
            ],
            "tools": [
              "PowerShell",
              "at",
              "net",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "APT34"
            ],
            "attack_techniques": [],
            "ips": [],
            "domains": [],
            "hashes": {},
            "file_names": []
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Registry Run Keys",
              "Create or Modify System Process"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**Key Security Terms:** evasion, backdoor, privilege, lateral, persistence, exploitation, c2, powershell, registry, service"
        },
        "metadata": {
          "extraction_timestamp": "2025-11-07T17:34:23.036393",
          "extraction_method": "Hybrid-NLP+Gemini",
          "llm_model": "gemini-2.0-flash-lite",
          "total_ttps_found": 7,
          "nlp_ttps": 7,
          "gemini_ttps": 0,
          "ttps_after_filtering": 7,
          "min_confidence_threshold": 0.5,
          "nlp_processing_time_ms": 2.0100000000000002,
          "llm_processing_time_ms": 5346.956999999999
        }
      }
    }
  ]
}