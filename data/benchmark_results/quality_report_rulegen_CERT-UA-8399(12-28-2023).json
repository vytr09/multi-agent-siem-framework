{
  "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
  "timestamp": "2025-12-26T07:18:27.649395",
  "config": {
    "llm_judge": {
      "enabled": true,
      "api_key": "<REDACTED>",
      "model": "llama-3.3-70b",
      "temperature": 0.1,
      "max_tokens": "<REDACTED>",
      "timeout": 60,
      "persona": "expert cybersecurity researcher and red team operator with deep knowledge of MITRE ATT&CK framework and detection engineering",
      "detailed_feedback": true,
      "confidence_scores": true,
      "enable_comparison": true,
      "max_requests_per_minute": 60,
      "retry_attempts": 3,
      "retry_delay": 2
    },
    "attackgen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "high_quality_threshold": 0.85,
      "metrics": {
        "technical_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "attack_alignment": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "platform_compatibility": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "operational_realism": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "threat_actor_alignment": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "testing_safety": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "controlled_impact": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "detection_value": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "artifact_generation": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "completeness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "documentation_quality": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        }
      },
      "top_performers_count": 10,
      "bottom_performers_count": 5,
      "enable_comparative_analysis": true,
      "export_format": "json",
      "export_detailed_results": true,
      "export_statistics": true
    },
    "rulegen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "metrics": {
        "sigma_completeness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_logic_correctness": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "platform_syntax_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "field_mapping_accuracy": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_specificity": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_sensitivity": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "metadata_richness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "optimization_level": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "attack_coverage": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "false_positive_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "contextual_awareness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "operational_deployability": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "performance_efficiency": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "analyst_actionability": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "evasion_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "multi_stage_detection": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        }
      }
    },
    "general": {
      "max_concurrent_evaluations": 3,
      "batch_size": 5,
      "enable_caching": true,
      "cache_ttl": 3600,
      "log_level": "INFO",
      "log_file": "logs/benchmark.log",
      "log_format": "json",
      "output_directory": "data/benchmark_results",
      "create_timestamp_subdirs": true,
      "calculate_statistics": true,
      "generate_summary_report": true,
      "export_csv": true,
      "generate_plots": false,
      "plot_format": "png"
    },
    "comparison": {
      "enabled": true,
      "criteria": [
        "overall quality",
        "technical correctness",
        "operational realism",
        "testing safety"
      ],
      "significant_difference_threshold": 0.1
    },
    "regression": {
      "enabled": false,
      "baseline_file": "baselines/attackgen_baseline.json",
      "alert_on_degradation": true,
      "degradation_threshold": 0.05,
      "track_history": true,
      "history_file": "history/benchmark_history.json"
    },
    "alerting": {
      "enabled": false,
      "low_score_threshold": 0.5,
      "alert_channels": [
        "email",
        "slack"
      ],
      "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "from_address": "benchmark@example.com",
        "to_addresses": [
          "team@example.com"
        ]
      },
      "slack": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#siem-benchmarks"
      }
    },
    "advanced": {
      "ensemble_evaluation": {
        "enabled": false,
        "models": [
          "gemini-2.0-flash-lite"
        ],
        "aggregation_method": "weighted_average"
      },
      "ground_truth": {
        "enabled": false,
        "dataset_path": "datasets/ground_truth.json",
        "calculate_accuracy": true
      },
      "custom_metrics": {
        "enabled": false,
        "metrics_file": "config/custom_metrics.yaml"
      },
      "debug": {
        "enabled": false,
        "save_prompts": true,
        "save_responses": true,
        "verbose_logging": true
      }
    }
  },
  "statistics": {
    "total_evaluations": 17,
    "average_score": 0.6177450980392157,
    "category_averages": {
      "correctness": 0.6741176470588236,
      "quality": 0.6532871972318338,
      "effectiveness": 0.591764705882353,
      "realism": 0.673202614379085,
      "detectability": 0.4758169934640524
    },
    "metric_averages": {
      "sigma_completeness": 0.6529411764705881,
      "detection_logic_correctness": 0.688235294117647,
      "detection_specificity": 0.5352941176470588,
      "detection_sensitivity": 0.7352941176470589,
      "metadata_richness": 0.6470588235294117,
      "optimization_level": 0.7588235294117648,
      "attack_coverage": 0.6352941176470589,
      "false_positive_resistance": 0.4764705882352942,
      "contextual_awareness": 0.6705882352941175,
      "operational_deployability": 0.6235294117647059,
      "analyst_actionability": 0.7352941176470589,
      "evasion_resistance": 0.49411764705882355,
      "multi_stage_detection": 0.45294117647058824
    },
    "score_distribution": {
      "excellent (>=0.9)": 0,
      "good (0.8-0.9)": 1,
      "fair (0.7-0.8)": 1,
      "poor (0.6-0.7)": 10,
      "failing (<0.6)": 5
    }
  },
  "results": [
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.8016666666666669,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.8470588235294119,
        "effectiveness": 0.7666666666666667,
        "realism": 0.8555555555555556,
        "detectability": 0.6555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields populated with meaningful content, but some fields like 'references', 'author', and 'date' are missing. The provided fields are well-structured and follow the Sigma format.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Well-structured Sigma fields",
              "Proper logsource and detection sections"
            ],
            "weaknesses": [
              "Missing required fields",
              "Lack of author and date information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies Suspicious PowerShell Execution with Obfuscation and Hidden Window. The selection criteria and condition logic are sound, and the rule uses standard Sigma fields.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate tools"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is specific enough to minimize false positives, using exact matches and filters to exclude benign activity. However, it may still catch some legitimate administrative tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Exact matches and filters",
              "Exclusion of benign activity"
            ],
            "weaknesses": [
              "Potential for false positives from admin tools"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule covers multiple indicators of the attack technique, using wildcards and regex to catch variations. It also considers different tools and techniques, making it sensitive to evasion attempts.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Covers multiple indicators",
              "Uses wildcards and regex"
            ],
            "weaknesses": [
              "May not catch highly customized attacks"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags, references to authoritative sources, and threat actor information, but lacks campaign names, operation names, and tools/malware families associated with the technique. The description is clear and detailed. The rule structure is well-defined, following the Sigma rule format.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Comprehensive MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lack of campaign names",
              "Limited tool/malware information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields, avoids leading wildcards, and applies specific filters. The detection logic is well-structured, and the use of 'contains' and 'endswith' operators is appropriate. The logsource is specific, focusing on Windows Sysmon process creation events.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Efficient field usage",
              "Well-structured detection logic"
            ],
            "weaknesses": [
              "Potential for complex regex in the future"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers the main attack vectors for Suspicious PowerShell Execution with Obfuscation and Hidden Window, including encoded commands and hidden windows. It also considers execution from .lnk files and common parent processes. However, it may not cover all possible sub-techniques or advanced variants.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Covers main attack vectors",
              "Considers common parent processes"
            ],
            "weaknesses": [
              "May not cover all sub-techniques",
              "Limited advanced variant detection"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes some filters to reduce false positives, such as excluding legitimate administrative automation tools. However, it may not be comprehensive enough, and the false positive guidance in the metadata could be more specific.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Some false positive filters",
              "Legitimate tool exclusion"
            ],
            "weaknesses": [
              "Limited false positive guidance",
              "Potential for false positives from legitimate tools"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates awareness of threat actor TTPs by detecting Suspicious PowerShell Execution with Obfuscation and Hidden Window, and considers threat actor preferences by including detection of execution from .lnk files and common parent processes. However, it lacks specific campaign context and APT group references. The rule's detection patterns match real-world attack chains.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Detects obfuscation techniques",
              "Considers threat actor preferences"
            ],
            "weaknesses": [
              "Lacks specific campaign context",
              "Limited APT group references"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule is ready for immediate deployment with no syntax errors, a realistic log source, and tested detection logic. The severity level is appropriate, and the false positive rate is acceptable. However, the rule may require tuning to minimize alert fatigue.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Realistic log source",
              "Tested detection logic"
            ],
            "weaknesses": [
              "May require tuning for alert fatigue"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule provides actionable information with a clear title, sufficient context, and useful fields for investigation. However, it lacks references to guide next steps in investigation and remediation. The severity level helps analysts prioritize their response.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Clear title and context",
              "Useful fields for investigation"
            ],
            "weaknesses": [
              "Lacks references for next steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule detects behavior patterns and considers obfuscation attempts, but may be bypassed by renaming executables or files. It uses multiple detection points, but relies on command-line arguments, which can be hidden or obfuscated.",
          "confidence": 0.7,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Detects behavior patterns",
              "Considers obfuscation attempts"
            ],
            "weaknesses": [
              "May be bypassed by renaming executables",
              "Relies on command-line arguments"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects initial execution of PowerShell with obfuscation and hidden window, which is a key aspect of the attack lifecycle. However, it does not explicitly cover persistence mechanisms, lateral movement, data collection, or exfiltration activities. The rule's logic is primarily focused on single-event detection of suspicious PowerShell execution.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:08:24.725246",
          "metadata": {
            "strengths": [
              "Detects encoded Base64 commands",
              "Identifies hidden window style execution"
            ],
            "weaknesses": [
              "Lacks persistence mechanism detection",
              "Does not account for lateral movement activities"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Suspicious PowerShell Execution with Obfuscation and Hidden Window) scored 0.80/1.0 (Good). Best performance in correctness (0.86). Needs improvement in detectability (0.66).",
      "timestamp": "2025-12-26T07:08:24.725246",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Suspicious PowerShell Execution with Obfuscation and Hidden Window",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6733333333333335,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.7058823529411764,
        "effectiveness": 0.6733333333333335,
        "realism": 0.6888888888888889,
        "detectability": 0.5
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like 'author', 'date', and 'status', which are essential for production readiness and rule governance.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Includes meaningful MITRE ATT&CK tags and proper logsource definition",
              "Has a valid detection section and unique ID"
            ],
            "weaknesses": [
              "Missing mandatory Sigma fields: author, date, status",
              "No references field despite available MITRE link"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately targets PowerShell execution with Base64-encoded commands and shortcut launches, aligning with T1059.001. The use of parent process filtering improves context, and the condition structure is logically sound. However, the regex for Base64 may trigger on long non-malicious strings, and .lnk execution alone is too broad without command-line inspection.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Combines multiple behavioral indicators (cmd, powershell, lnk) effectively",
              "Uses standard Sigma field names and realistic command-line patterns"
            ],
            "weaknesses": [
              "Selection_lnk triggers on any .lnk file execution without filtering malicious use",
              "Regex for Base64 may produce false positives on long benign strings"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes some specificity via parent process filtering and command-line keywords, but remains broad due to unfiltered .lnk execution and lack of exclusions for known good processes. The Base64 regex length threshold helps, but no user, image path, or command-line whitelisting reduces production suitability.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Uses parent process context to narrow suspicious chains",
              "Combines multiple conditions to reduce random triggers"
            ],
            "weaknesses": [
              "No exclusions for trusted parent processes or administrative tools",
              ".lnk detection is overly broad without command-line analysis"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule is highly sensitive, capturing multiple attack vectors: direct PowerShell, cmd-spawned PowerShell, and shortcut-based execution. Case-insensitive matching and regex for long Base64 strings help catch obfuscated payloads. It also covers common evasion techniques like command encoding and indirect invocation.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Covers multiple execution paths (direct, via cmd, via lnk)",
              "Uses case-insensitive matching and robust regex for encoded payloads"
            ],
            "weaknesses": [
              "Could be evaded by segmented Base64 or alternative encodings (e.g., hex)",
              "No detection of PowerShell core (pwsh.exe) or alternate interpreters"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1059.001) and a clear description, but lacks specific references to authoritative sources, threat actors, malware families, or campaigns. The 'ttp_id' is marked as 'unknown' and no external links or research citations are provided beyond the generic MITRE link.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging (T1059.001)",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing specific references to threat intelligence or research",
              "No attribution to known threat actors, tools, or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field operators like 'endswith' and 'contains' on indexed fields (Image, CommandLine) and avoids leading wildcards. However, the regex for Base64 detection is broad and may be computationally expensive at scale, especially without length constraints in some environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Uses indexed fields and efficient string operators",
              "Logsource is specific to Sysmon process creation"
            ],
            "weaknesses": [
              "Regex pattern may be overly broad and slow in high-volume environments",
              "No prioritization of most selective conditions first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule effectively covers multiple attack vectors: direct PowerShell with encoded commands, cmd.exe launching PowerShell, and .lnk file execution. It includes detection of common obfuscation techniques (Base64, IEX, DownloadString) and suspicious parent processes used by adversaries. However, it does not explicitly cover other interpreters (e.g., mshta, cscript) or advanced evasion techniques like AMSI bypasses.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Covers multiple execution chains (PowerShell, cmd, .lnk)",
              "Detects common offensive tooling patterns (Base64, IEX, DownloadString)"
            ],
            "weaknesses": [
              "Lacks coverage of related sub-techniques (e.g., T1059.005, T1204.002)",
              "No detection of memory-only or reflection-based execution"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes a parent-process filter to reduce noise, but lacks granular exclusions for known legitimate administrative tools, scheduled tasks, or trusted paths. The false positives list is generic and does not guide analysts on how to tune or suppress expected noise, increasing operational burden.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Includes parent-image filtering to limit context",
              "Acknowledges common false positive sources in metadata"
            ],
            "weaknesses": [
              "No whitelisting of trusted processes or paths",
              "Lacks frequency or threshold-based logic to reduce single-event alerts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns well with known T1059.001 TTPs, particularly the use of Base64-encoded PowerShell and shortcut execution. It reflects real-world attack chains where adversaries abuse PowerShell via cmd or .lnk files. However, it lacks references to specific APT groups or campaigns that commonly use these techniques, limiting contextual depth.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Matches common adversary behavior like Base64-encoded payloads and LOL execution chains",
              "Covers multi-stage execution patterns (cmd \u2192 PowerShell, .lnk \u2192 execution)"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Lacks timing or targeting context (e.g., off-hours execution)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sigma syntax and targets Sysmon process creation, which is common in mature environments. However, the regex for long Base64 strings may generate false positives from legitimate encoded data, and the inclusion of .lnk execution without additional constraints increases alert volume. The 'high' severity is justified but may lead to alert fatigue without tuning.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Uses standard logsource (Sysmon process creation) widely deployed",
              "Clear detection logic with realistic field usage"
            ],
            "weaknesses": [
              "High potential for false positives from encoded legitimate scripts",
              "Broad .lnk detection without command-line scrutiny"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly communicate the detection intent, and the included fields (Image, CommandLine, ParentImage) are highly useful for pivoting. False positive guidance is practical, helping analysts triage alerts. The rule enables immediate investigation paths such as inspecting parent-child relationships and decoding command lines.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable description",
              "Key forensic fields (CommandLine, ParentImage) included"
            ],
            "weaknesses": [
              "Missing user context or host-based enrichment suggestions",
              "No direct pivot to network or file indicators"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects common obfuscation via Base64 regex and focuses on behavioral patterns like suspicious parent processes, which adds resilience. However, it relies heavily on command-line arguments that can be split, obfuscated, or passed via variables\u2014common evasion tactics. It does not account for PowerShell v2 invocation, alternate encodings, or direct .NET in-memory execution.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Detects encoded command patterns and indirect execution chains",
              "Includes parent process context to identify suspicious launches"
            ],
            "weaknesses": [
              "Vulnerable to command-line obfuscation (e.g., string splitting)",
              "No coverage of non-command-line PowerShell execution methods"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects initial execution via PowerShell, cmd.exe, or .lnk files with suspicious command-line patterns, particularly Base64-encoded payloads, which aligns with early-stage execution (T1059.001). However, it lacks logic to correlate follow-on behaviors such as persistence, lateral movement, or exfiltration, limiting detection to single-event triggers without multi-stage correlation.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:05.963822",
          "metadata": {
            "strengths": [
              "Covers multiple initial access vectors (PowerShell, cmd, .lnk)",
              "Includes regex to detect long Base64 strings typical in malicious payloads"
            ],
            "weaknesses": [
              "No correlation across events or stages (e.g., post-exploitation activity)",
              "Limited to process creation without context from network or file events"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Suspicious PowerShell Execution with Base64 Payloads and Shortcut Launches) scored 0.67/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.50). Issues found in: false_positive_resistance, evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-26T07:09:05.963822",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Suspicious PowerShell Execution with Base64 Payloads and Shortcut Launches",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.2866666666666667,
      "category_scores": {
        "correctness": 0.38,
        "quality": 0.27058823529411763,
        "effectiveness": 0.29333333333333333,
        "realism": 0.2888888888888889,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and falsepositives, but lacks mandatory fields like 'status', 'author', 'date', and 'references'. The 'id' is present but 'status' is missing, which is required for production-ready rules.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Includes core Sigma components: title, logsource, detection, and tags",
              "Properly references MITRE ATT&CK ID in tags"
            ],
            "weaknesses": [
              "Missing required fields: status, author, date, references",
              "No indication of rule maturity or ownership"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic is fundamentally flawed: it uses a generic string 'suspicious' in the command line, which will not match actual SMB/WebDAV attack commands like 'net use \\\\host\\admin$' or WebDAV paths. This renders the rule ineffective for detecting T1021.002. The condition is simple but based on incorrect indicators.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Correctly targets process_creation via Sysmon",
              "Aligned with lateral movement via command-line access"
            ],
            "weaknesses": [
              "Selection based on non-specific string 'suspicious' instead of real IOCs",
              "Fails to match actual attack syntax (e.g., net.exe, cmd.exe with UNC paths)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is extremely broad due to the vague 'suspicious' keyword, which could appear in any command line for benign reasons. It lacks filters for specific tools (e.g., net.exe), paths (e.g., admin$, ipc$, dav:), or parent processes. No exclusion logic is implemented despite listing false positives.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Acknowledges common false positives in documentation",
              "Targets high-risk admin shares in description"
            ],
            "weaknesses": [
              "No use of exact command patterns or process names",
              "No context filtering (e.g., by user, parent process, or image path)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks sensitivity because it depends on a literal string 'suspicious' that attackers will never use. It does not account for command obfuscation, alternative tools (e.g., PowerShell, wmic), or encoded execution. No case-insensitive matching or regex patterns are used to capture variations of SMB/WebDAV access.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Conceptually aims to detect lateral movement via command line",
              "Covers both SMB and WebDAV in scope"
            ],
            "weaknesses": [
              "No support for encoded commands or alternative tooling",
              "Vulnerable to trivial evasion (e.g., misspelling or obfuscation)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description is functional but generic and does not elaborate on the specific malicious behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique and tactic tags included",
              "Clear rule title and basic description provided"
            ],
            "weaknesses": [
              "Missing MITRE reference link or CVEs/tools associated with the technique",
              "No attribution to known threat actors or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is highly inefficient and non-specific. It uses a non-indexed substring search with no anchoring, leading to poor performance and broad matching. The logsource is correctly specified for Sysmon process creation.",
          "confidence": 0.98,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Logsource correctly specifies Sysmon process creation events",
              "Uses a simple condition structure for clarity"
            ],
            "weaknesses": [
              "Relies on unoptimized 'contains' with a vague term 'suspicious'",
              "No use of indexed fields like Image or ParentImage for early filtering"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule fails to cover actual attack patterns for SMB/WebDAV lateral movement, such as 'net use \\\\host\\admin$', 'net use \\\\host\\ipc$', or WebDAV client tools. The use of 'suspicious' as a keyword does not reflect real adversary command lines and misses all known tools and techniques.",
          "confidence": 0.99,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Targets the correct high-level TTP (T1021.002)",
              "General intent to detect command-line SMB/WebDAV access is valid"
            ],
            "weaknesses": [
              "Does not detect actual command-line syntax used in attacks",
              "Ignores common tools like net.exe, sc.exe, psexec, or Cobalt Strike WebDAV loaders"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists common false positives like administrative use of net.exe and IT scripts, which is helpful for analysts. However, the detection logic itself has no filtering to exclude these scenarios, making the FP guidance theoretical rather than operational.",
          "confidence": 0.97,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Comprehensive and accurate false positive examples listed",
              "Acknowledges legitimate admin and automation use cases"
            ],
            "weaknesses": [
              "No actual exclusions (e.g., by user, path, or process) in detection logic",
              "No parent-child context or frequency-based thresholds to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule references T1021.002 and lateral movement, but the detection logic is overly generic with 'CommandLine|contains: suspicious', which does not reflect real-world attacker command patterns. It lacks specificity around actual tools (e.g., net use, sc, psexec) or parameters used in campaigns.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Correctly tags MITRE T1021.002 and lateral movement context",
              "Acknowledges use of admin$ and ipc$ in malicious context"
            ],
            "weaknesses": [
              "Detection pattern is abstract and not tied to real TTPs",
              "No reference to known adversary tools or campaign behaviors"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains a critical flaw: it searches for 'suspicious' in the command line, which will never match real events and will produce zero detections. The logsource is valid (Sysmon process creation), but the logic is broken and untested despite 'verification success' claim.",
          "confidence": 0.98,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon process creation logging, widely available",
              "Includes reasonable false positive notes for admin activity"
            ],
            "weaknesses": [
              "Detection logic is syntactically flawed and non-functional",
              "Verification shows 0 events found, indicating ineffective detection"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title and description suggest relevant context, but the detection does not extract actionable fields like user, host, or remote endpoint. Analysts would lack critical pivot points from an alert generated by this rule.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Title clearly indicates intent to detect SMB/WebDAV abuse",
              "False positives are well-documented for triage context"
            ],
            "weaknesses": [
              "No field references for user, IP, or process path to aid investigation",
              "Alert output would not support effective response without enrichment"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule relies solely on a static string 'suspicious' in the command line, making it trivial to evade via obfuscation, LOLBins, or alternate syntax. It does not detect behavioral patterns or multi-stage activity associated with real SMB/WebDAV lateral movement.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Targets command-line execution, a common attack vector",
              "Focus on process creation could capture some living-off-the-land activity"
            ],
            "weaknesses": [
              "Highly vulnerable to obfuscation and renaming",
              "No behavioral or multi-event correlation to resist evasion"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule detects only a single event\u2014command-line execution containing the term 'suspicious'\u2014without logic to identify subsequent stages like lateral movement, data access, or persistence. It lacks correlation across events or behavioral chains that would indicate progression of the TTP.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:09:43.034156",
          "metadata": {
            "strengths": [
              "Targets process creation via Sysmon, which is appropriate for command-line-based lateral movement",
              "Aligned with detection of T1021.002, which involves SMB/WebDAV misuse"
            ],
            "weaknesses": [
              "Detection based on 'suspicious' string is overly vague and non-specific",
              "No multi-event correlation or stage progression logic (e.g., connection + file access + execution)"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1021.002 (Suspicious SMB and WebDAV Access via Command Line Tools) scored 0.29/1.0 (Poor). Best performance in correctness (0.38). Needs improvement in detectability (0.20). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-26T07:09:43.034156",
      "metadata": {
        "attack_id": "attack.t1021.002",
        "technique_name": "Suspicious SMB and WebDAV Access via Command Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6983333333333335,
      "category_scores": {
        "correctness": 0.68,
        "quality": 0.7235294117647059,
        "effectiveness": 0.7400000000000001,
        "realism": 0.7444444444444445,
        "detectability": 0.5555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes essential fields like title, description, logsource, detection, condition, and falsepositives, but is missing required Sigma fields such as id, status, author, date, references, and MITRE ATT&CK tags. These omissions prevent it from being production-ready or properly tracked in detection engineering workflows.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Includes meaningful title, description, and detection logic",
              "Properly defines logsource and detection components"
            ],
            "weaknesses": [
              "Missing mandatory Sigma fields: id, status, author, date, references",
              "Lacks MITRE ATT&CK tags and proper references"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately models the TTP by identifying PowerShell with Base64-encoded commands launched from user-driven contexts like Office apps, .lnk files, and common launchers. The use of parent process chaining and regex for -EncodedCommand is valid and aligns with real-world attack patterns.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Correctly uses parent-child process relationships to model user execution",
              "Employs accurate regex to detect Base64-encoded PowerShell commands"
            ],
            "weaknesses": [
              "selection_ps_generic is overly broad and lacks context",
              "No exclusion of known benign parent processes (e.g., automation tools)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses specific parent processes (winword.exe, excel.exe, etc.) which improves context, but the generic selection_ps_generic condition introduces high false positive risk by catching any PowerShell with -EncodedCommand regardless of origin. More filtering on user context or command content would improve precision.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Specific parent-image conditions for Office and .lnk execution paths",
              "Uses regex length threshold ({100}) to reduce noise"
            ],
            "weaknesses": [
              "Generic fallback condition lacks constraints",
              "No exclusion of administrative or trusted execution environments"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule covers multiple attack vectors (Office, .lnk, cmd, rundll32) and uses flexible regex to catch Base64 payloads of sufficient length, making it resilient to path and casing variations. It effectively detects common and advanced delivery methods used in phishing campaigns.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Covers diverse initial access vectors (Office, shortcuts, command line)",
              "Regex pattern accounts for encoding variations and obfuscation"
            ],
            "weaknesses": [
              "Does not account for PowerShell Core (pwsh.exe) as alternative",
              "No case-insensitive flag explicitly set in regex (though often default)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes a clear title, description, and correct logsource, with a reference to MITRE ATT&CK. However, it lacks specific MITRE technique IDs (e.g., T1204.002, T1059.001), references to known threat actors, malware families, or campaigns, and the description is generic without contextualizing real-world usage.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tactic and technique name",
              "Provides a clear, descriptive rule title and summary"
            ],
            "weaknesses": [
              "Missing specific MITRE technique IDs (e.g., T1204.002, T1059.001)",
              "No references to threat actors, malware families, or real-world campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like 'endswith' on Image and ParentImage, avoids leading wildcards, and places specific conditions in separate selections. The regex for Base64 is reasonably constrained by length, though it could be further optimized by anchoring or limiting excessive backtracking.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, ParentImage, CommandLine)",
              "Employs efficient string operators (endswith) and avoids leading wildcards"
            ],
            "weaknesses": [
              "Regex pattern for Base64 could be improved with stricter formatting (e.g., padding, character grouping)",
              "Multiple similar selections could be grouped to reduce redundancy"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule comprehensively covers major user execution vectors: LNK files, Office apps (Word, Excel, PowerPoint), cmd.exe, and rundll32.exe launching PowerShell with encoded commands. It also includes a generic fallback for any process spawning encoded PowerShell, increasing detection breadth across tools like Cobalt Strike or Empire.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Covers multiple common initial access vectors (Office, LNK, cmd, rundll32)",
              "Includes detection for both application-specific and generic execution chains"
            ],
            "weaknesses": [
              "Does not explicitly cover other Office child processes (e.g., wscript, mshta)",
              "Lacks coverage for newer techniques like 'detection_evasion' via PowerShell downgrades or AMSI bypasses"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks built-in exclusions for legitimate administrative use of -EncodedCommand and does not incorporate user context, signing, or path-based whitelisting. While the 100+ character threshold reduces noise, it may still trigger on valid automation scripts without additional filtering.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Uses command line length threshold (100+ chars) to reduce trivial FPs",
              "Leverages parent-child process context (e.g., Office spawning PowerShell)"
            ],
            "weaknesses": [
              "No exclusions for trusted users, paths, or signed scripts",
              "Missing frequency or threshold logic to distinguish malicious bulk execution"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule accurately models real-world TTPs where adversaries use malicious shortcuts or Office documents to trigger Base64-encoded PowerShell payloads. It aligns with MITRE ATT&CK's User Execution pattern and reflects common phishing-driven attack chains involving Office apps spawning PowerShell.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Covers multiple common initial access vectors (Office, .lnk, cmd, rundll32)",
              "Matches known adversary behavior using -EncodedCommand for payload delivery"
            ],
            "weaknesses": [
              "Lacks specificity to high-profile APT groups or campaigns",
              "Does not reference timing or execution sequencing seen in real attacks"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid and leverages Sysmon process creation events, which are standard in mature environments. However, the generic selection_ps_generic may generate excessive false positives from legitimate automation, increasing alert fatigue.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Uses widely available Sysmon log source",
              "Well-structured detection logic with clear conditions"
            ],
            "weaknesses": [
              "Incomplete false positives section cuts off mid-sentence",
              "Generic PowerShell detection increases risk of high false positive rate"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detected behavior, enabling analysts to understand the potential compromise. Detected fields (Image, ParentImage, CommandLine) allow effective pivoting in investigations.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection logic",
              "Includes key forensic fields for investigation (parent process, command line)"
            ],
            "weaknesses": [
              "Missing severity classification for SOC prioritization",
              "Incomplete false positive guidance limits response clarity"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects Base64-encoded PowerShell commands, a common obfuscation method, but relies heavily on command-line arguments that can be bypassed via alternative encoding or direct memory injection. Attackers can evade by using shorter payloads or decoding in stages.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Detects encoded command patterns resistant to simple string matching",
              "Leverages parent-child process relationships to identify suspicious chains"
            ],
            "weaknesses": [
              "Relies heavily on CommandLine logging, which can be evaded",
              "No coverage for PowerShell Core (pwsh.exe) or AMSI bypass techniques"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects initial execution via user-initiated actions like Office documents or LNK files launching PowerShell with Base64 commands, which covers early-stage compromise. However, it lacks logic to detect persistence, lateral movement, or follow-on activities, and does not correlate across multiple event types or stages in the attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:20.433211",
          "metadata": {
            "strengths": [
              "Detects initial execution from common phishing vectors (Office, LNK).",
              "Covers multiple parent processes indicative of user-driven execution."
            ],
            "weaknesses": [
              "No detection of persistence or lateral movement tied to this TTP.",
              "Lacks event correlation across stages (e.g., post-exploitation activity)."
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (User Execution \u2013 Malicious Shortcut or Office Document Triggered PowerShell with Base64 Payload) scored 0.70/1.0 (Below Average). Best performance in realism (0.74). Needs improvement in detectability (0.56). Issues found in: sigma_completeness, false_positive_resistance, multi_stage_detection",
      "timestamp": "2025-12-26T07:10:20.433211",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "User Execution \u2013 Malicious Shortcut or Office Document Triggered PowerShell with Base64 Payload",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.525,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.5764705882352942,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5888888888888889,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like 'id', 'status', 'author', 'date', and 'references', which are essential for production-ready detection rules and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Includes meaningful description and proper MITRE ATT&CK tagging",
              "Well-structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing critical Sigma fields: id, author, date, status, references",
              "Incomplete TTP metadata (e.g., technique_name cut off)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection logic captures relevant behaviors like Base64-encoded PowerShell, .lnk execution, and known proxy IP, but combines disparate indicators under a single OR condition, increasing false positives. The logic conflates initial execution methods (e.g., .lnk, encoded PowerShell) with C2-specific indicators (proxy IP), weakening its precision for attack.t1090.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Uses valid field names and standard Sigma syntax",
              "Captures known malicious patterns like -EncodedCommand"
            ],
            "weaknesses": [
              "Overly broad OR condition links unrelated behaviors",
              "Does not clearly distinguish between execution and C2 stages"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is highly prone to false positives due to broad conditions\u2014e.g., any process launched by cmd.exe or powershell.exe triggers an alert. It lacks contextual filters (e.g., user, image path, command line patterns) to differentiate malicious from legitimate use of common Windows binaries.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Specific regex for Base64-encoded PowerShell commands",
              "Exact match on known malicious IP and email"
            ],
            "weaknesses": [
              "No exclusion of system or admin-trusted processes",
              "Too broad: alerts on any child process of cmd/rundll32/powershell"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule demonstrates good sensitivity by covering multiple attack vectors: shortcut execution, encoded PowerShell, and proxy communication. Case-insensitive regex and Base64 length filtering help catch obfuscated commands, and inclusion of multiple parent processes increases coverage across execution techniques.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Covers multiple TTPs associated with C2 establishment",
              "Uses regex to detect obfuscated PowerShell commands"
            ],
            "weaknesses": [
              "Reliance on a single hardcoded IP limits adaptability",
              "No fallback for domain-based or dynamic proxy indicators"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tagging (T1090) and a descriptive title, but lacks specific sub-technique mapping (e.g., T1090.001 for internal proxy), threat actor attribution, malware families, or campaign references. The description is clear but could include more technical context about how the proxy is used in C2.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1090) included",
              "Clear and descriptive rule title and detection logic summary"
            ],
            "weaknesses": [
              "Missing sub-technique mapping (e.g., T1090.001, T1059.001)",
              "No references to threat actors, malware families, or external research"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field filters like 'endswith' on Image and ParentImage, avoids leading wildcards, and leverages indexed Sysmon process creation fields. However, the detection condition combines seven OR clauses without prioritizing the most specific (e.g., proxy IP or Base64 PowerShell), which may reduce performance in high-volume environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Uses efficient 'endswith' and regex only where necessary",
              "Relies on indexed fields (Image, ParentImage, CommandLine)"
            ],
            "weaknesses": [
              "OR-heavy condition without prioritization of high-fidelity indicators",
              "Regex for Base64 could be optimized with length bounds or entropy checks"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common initial access vectors like .lnk execution and Base64 PowerShell, and includes known proxy IP, but fails to model multi-stage C2 proxy chains or advanced tooling like Cobalt Strike's user-agent or sleep obfuscation. It lacks coverage of alternate proxy methods (e.g., plink, netsh, SSH tunneling) and does not detect encoded payloads beyond PowerShell.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Covers common execution methods (PowerShell, cmd, .lnk)",
              "Includes known malicious IP and email indicator"
            ],
            "weaknesses": [
              "Limited to single-event detection; no behavioral chaining",
              "No detection of common C2 frameworks or proxy tools beyond IP"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists common false positives in metadata but lacks actual filtering logic to suppress them\u2014no exclusions for trusted paths, users, or signed binaries. It triggers on any .lnk execution or parent process relationship without context, increasing alert fatigue in enterprise environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Comprehensive false positive documentation in metadata",
              "Specific indicators like known IP and email reduce baseline noise"
            ],
            "weaknesses": [
              "No exclusion logic for system processes or admin tools",
              "No use of process ancestry or frequency-based thresholds"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs involving proxy C2 via PowerShell and shortcut execution, and includes known IOCs like a specific IP and email. However, it lacks campaign-specific context or references to APT groups, and the technique is mapped incorrectly\u2014T1090 is 'Proxy' for network redirection, not C2 communication, which weakens MITRE alignment.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Covers common attacker techniques like Base64-encoded PowerShell and .lnk execution",
              "Includes specific IOCs that may tie to observed malicious activity"
            ],
            "weaknesses": [
              "Incorrect MITRE ATT&CK mapping (T1090 is not C2-specific)",
              "No linkage to known threat actors or campaigns"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma rule syntax appears valid and uses common Sysmon event fields, making it deployable in most Windows environments. However, the detection logic combines low-fidelity indicators with a broad OR condition, leading to high false positive rates from normal system behavior, which limits production readiness.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon process creation logging, widely available",
              "Clear severity level (critical) aids prioritization"
            ],
            "weaknesses": [
              "High false positive risk due to overly broad OR-based condition",
              "Relies on a single hardcoded IP/email without contextual correlation"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly communicate what is detected, and false positive guidance is thorough. Analysts can pivot on process, command line, and IP, but the lack of enriched fields (e.g., user, hash) and correlation context limits investigative depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detailed false positive list",
              "Detection fields support basic pivoting (IP, command line, image)"
            ],
            "weaknesses": [
              "Missing user context and image hashes for deeper investigation",
              "No references to enrichment or follow-up procedures"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on easily evaded static indicators (specific IP, email, command-line patterns) and does not enforce behavioral chains or process ancestry context. Attackers can bypass detection by using alternate encodings, different proxy IPs, or indirect execution methods.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Detects multiple stages (execution, encoding, network)",
              "Includes Base64 PowerShell detection, a common C2 enabler"
            ],
            "weaknesses": [
              "Highly evadable via IP rotation or obfuscation of command lines",
              "No logic requiring process lineage or multi-step behavior"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects individual components of a multi-stage attack (e.g., shortcut execution, encoded PowerShell, proxy IP connection), but lacks logic to correlate these events across stages or enforce sequence, reducing its ability to confirm Proxy C2 activity. It focuses on isolated indicators rather than behavioral chains, making it prone to alert on disjointed, non-malicious events.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:10:57.156021",
          "metadata": {
            "strengths": [
              "Covers multiple potential entry points (lnk, PowerShell, parent processes).",
              "Includes network indicator (proxy IP) that could signal C2 communication."
            ],
            "weaknesses": [
              "No event correlation or temporal logic to link stages (e.g., lnk \u2192 cmd \u2192 PowerShell \u2192 proxy).",
              "Treats all conditions as OR, increasing noise and reducing stage progression visibility."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1090 (Proxy C2 Communication via PowerShell, Shortcut Execution, and Known Proxy IP) scored 0.53/1.0 (Poor). Best performance in realism (0.59). Needs improvement in detectability (0.40). Issues found in: detection_logic_correctness, detection_specificity, attack_coverage",
      "timestamp": "2025-12-26T07:10:57.156021",
      "metadata": {
        "attack_id": "attack.t1090",
        "technique_name": "Proxy C2 Communication via PowerShell, Shortcut Execution, and Known Proxy IP",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.6058823529411765,
        "effectiveness": 0.52,
        "realism": 0.6888888888888889,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and falsepositives. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing required Sigma fields: author, date, status, references",
              "No citation to MITRE ATT&CK beyond tag"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The logic correctly identifies SSH tunneling via ssh.exe using -N (no command execution) and ServerAliveInterval (persistence), which aligns with T1021. The condition is simple and valid, using standard Sysmon process creation fields. However, it assumes exact match on '30' for ServerAliveInterval, which may miss variations.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Accurate use of command-line indicators tied to tunneling behavior",
              "Leverages standard Sigma field names (Image, CommandLine)"
            ],
            "weaknesses": [
              "Hardcoded '30' in ServerAliveInterval may miss other values (e.g., 60)",
              "No case-insensitive matching specified despite Windows case insensitivity"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is moderately specific by combining two command-line arguments, but lacks context like parent process, user context, or network connection correlation. It risks false positives from DevOps tools and admins, despite listing them in falsepositives, without excluding them in logic.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Combines multiple indicators (-N and ServerAliveInterval) for precision",
              "Targets ssh.exe, reducing noise from other tools"
            ],
            "weaknesses": [
              "No exclusion of known benign tools or users",
              "Lacks parent process or session context (e.g., from wsl.exe, CI/CD agents)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is brittle to evasion: attackers can change ServerAliveInterval value, use different keep-alive settings, or obfuscate command lines. It does not account for alternative SSH clients (e.g., plink.exe) or encoded commands. Lacks wildcard or regex support for robust pattern matching.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Detects common tunneling pattern via standard SSH options",
              "Focuses on behavioral indicators (no shell, keep-alive)"
            ],
            "weaknesses": [
              "Vulnerable to simple parameter changes or obfuscation",
              "Ignores alternative tools (e.g., OpenSSH via WSL, plink)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1021, lateral movement) and a clear description, but lacks references to authoritative sources, threat actors, or malware families. The technique name is misaligned with MITRE, which reduces contextual accuracy.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique and tactic tags included",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing MITRE reference link in metadata",
              "No attribution to threat actors, campaigns, or tools using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) on indexed Sysmon fields and avoids leading wildcards. Detection logic is simple and performs well, though 'contains' on multiple command-line arguments could be slightly refined.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains array may trigger on partial matches unnecessarily",
              "Could prioritize more specific command-line patterns first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic SSH tunneling via -N and keep-alive settings but misses key variants like dynamic port forwarding (-D), local/remotes forwarding (-L/-R), or alternative tools (plink.exe, sshd). Coverage is limited to one specific command-line pattern.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Covers common tunneling flag (-N) and persistence mechanism (ServerAliveInterval)",
              "Targets ssh.exe, a legitimate tool abused in attacks"
            ],
            "weaknesses": [
              "Fails to detect other SSH tunneling methods (e.g., -L, -R, -D)",
              "Ignores alternative tools like plink.exe or custom implants with SSH capabilities"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process exclusions, parent-child context, or user-based filtering, making it prone to false positives from legitimate admin use. While false positives are documented, no detection-time mitigations (e.g., exclude domain\\admin) are implemented.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive sources in metadata",
              "Focuses on suspicious options (-N, keep-alive) not typical in interactive SSH"
            ],
            "weaknesses": [
              "No exclusion of known admin users, hosts, or CI/CD pipelines in detection logic",
              "Single-event trigger without frequency or behavioral context"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs where attackers use SSH tunneling with -N and keep-alive options for stealthy C2 or lateral movement. It correctly maps to T1021 (Remote Services), though it lacks specific references to known APT groups or campaigns that leverage this technique.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Detection logic reflects actual attacker behavior (e.g., persistent tunnels via ServerAliveInterval)",
              "Maps accurately to MITRE ATT&CK T1021 and lateral movement context"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or real-world campaigns",
              "Lacks broader attack chain context (e.g., initial access vector or follow-on actions)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sigma syntax and targets Sysmon process creation logs, which are common in enterprise environments. However, the hardcoded 'ServerAliveInterval=30' may miss variants and increase false negatives, reducing reliability in production.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Valid logsource (Sysmon process creation) widely deployed",
              "Clear detection logic with realistic field usage"
            ],
            "weaknesses": [
              "Hardcoded interval value limits detection scope",
              "No testing evidence provided despite 'siem_verification' claim (0 events found)"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly communicate the suspicious activity, and the detected fields (Image, CommandLine) allow for effective pivoting. False positive guidance is practical and helps analysts triage legitimate use cases.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable description",
              "Good false positive context aiding analyst decision-making"
            ],
            "weaknesses": [
              "Lacks inclusion of user, source IP, or destination host fields for richer context",
              "No direct remediation or investigation next steps referenced"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on specific command-line arguments, which attackers can easily modify (e.g., different intervals, obfuscation, or alternative tools like plink.exe). It does not incorporate behavioral or multi-stage indicators to resist evasion.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Uses -N flag, which is semantically meaningful for tunneling",
              "Detects a non-interactive SSH pattern common in C2"
            ],
            "weaknesses": [
              "Highly vulnerable to simple argument changes or obfuscation",
              "No defense-in-depth via related telemetry (e.g., network connections)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of ssh.exe with tunneling indicators (-N and ServerAliveInterval), which aligns with early-stage lateral movement or remote access. However, it lacks logic to correlate follow-on activities such as persistence, data exfiltration, or session reuse, limiting it to a single-event detection. There is no mechanism to track multi-event behavioral chains or session longevity.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:11:32.629091",
          "metadata": {
            "strengths": [
              "Detects known command-line flags associated with SSH tunneling and keep-alive behavior",
              "Targets process creation via Sysmon, enabling visibility into execution"
            ],
            "weaknesses": [
              "No correlation across multiple stages (e.g., post-access activity or persistence)",
              "Limited to single-event match without temporal or session-based context"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1021 (Suspicious SSH Tunneling via ssh.exe with Keep-Alive Options) scored 0.60/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.46). Issues found in: detection_sensitivity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-26T07:11:32.629091",
      "metadata": {
        "attack_id": "attack.t1021",
        "technique_name": "Suspicious SSH Tunneling via ssh.exe with Keep-Alive Options",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6000000000000001,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6764705882352942,
        "effectiveness": 0.5933333333333333,
        "realism": 0.5444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE mappings. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE ATT&CK tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing required Sigma fields: status, author, date, references",
              "Incomplete metadata reduces rule maintainability and trust"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly identifies PowerShell process creation with cmdlets associated with user/domain discovery and combines them with encoded command or .lnk file execution\u2014common in malicious contexts. However, 'Get-User' is not a native PowerShell cmdlet and may refer to third-party modules (e.g., PowerView), which could lead to gaps if not present. Also, the regex for encoded commands may not fully validate base64 padding.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Sound condition structure combining discovery activity with obfuscation techniques",
              "Uses standard Sysmon process creation fields correctly"
            ],
            "weaknesses": [
              "Relies on non-native 'Get-User' without clarifying required module (e.g., PowerView)",
              "Regex for encoded commands may produce false negatives due to variable padding"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule improves specificity by requiring both discovery cmdlets and obfuscation (encoded command or .lnk), reducing false positives from legitimate admin use. However, it lacks context such as parent process, user context (e.g., SYSTEM vs admin), or command line length filtering, which could help distinguish malicious from benign script execution.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Combines multiple behavioral indicators (cmdlet + obfuscation) for precision",
              "Excludes simple interactive use by requiring encoded/.lnk execution"
            ],
            "weaknesses": [
              "No exclusion of trusted parent processes (e.g., taskhost, explorer)",
              "Lacks user or session context to filter authorized administrative activity"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by detecting multiple evasion vectors (encoded commands, .lnk files) and using regex to catch long base64 strings. It also captures variations via case-insensitive path matching and command line contains checks. However, it could improve by accounting for alternative execution methods (e.g., powershell.exe vs pwsh.exe, WMI spawning PowerShell).",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Covers common obfuscation techniques used in real-world attacks",
              "Uses regex to detect long base64-encoded payloads effectively"
            ],
            "weaknesses": [
              "Does not account for alternative PowerShell implementations (e.g., pwsh.exe)",
              "No detection of command-line splitting or other encoding bypasses"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1033, T1027) and maps to 'System Owner/User Discovery' with relevant custom tags. The description is clear and explains the detection logic, but lacks references to authoritative sources, threat actors, or malware families that commonly use this technique.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Accurate MITRE ATT&CK technique tagging (T1033, T1027)",
              "Clear and informative description of detection intent"
            ],
            "weaknesses": [
              "Missing MITRE URL or external references",
              "No attribution to known threat actors or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like 'Image|endswith' and avoids leading wildcards. Conditions are logically structured with specific command-line checks, and regex for encoded commands is reasonably scoped. However, the regex pattern could be optimized to reduce false matches on long base64 strings that aren't malicious.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, CommandLine)",
              "Logical condition grouping with specific operators"
            ],
            "weaknesses": [
              "Regex for base64 could be more precise to avoid noise",
              "No short-circuiting logic to prioritize faster-evaluated conditions"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects key aspects of user discovery via PowerShell using Get-ADDomainController and Get-User, especially when combined with obfuscation (encoded commands) or .lnk execution. However, it misses other common discovery cmdlets (e.g., Get-NetUser, Get-LocalUser) and does not cover alternative execution methods like reflective loading or PowerShell Core (pwsh.exe).",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Covers encoded command and .lnk file execution vectors",
              "Focuses on high-risk combinations of discovery + obfuscation"
            ],
            "weaknesses": [
              "Limited to only two cmdlets; misses broader discovery toolkit",
              "Does not account for non-powershell.exe execution (e.g., pwsh.exe, rundll32)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule acknowledges false positives from admin use and scripts but lacks concrete exclusions in the detection logic. It does not filter by parent process, user context, or execution path, increasing risk of alerting on legitimate administrative activity. More granular filtering would improve precision.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive scenarios in metadata",
              "Combines multiple conditions to reduce trivial triggers"
            ],
            "weaknesses": [
              "No exclusion logic for trusted parent processes (e.g., explorer.exe vs. office apps)",
              "Lacks user- or path-based whitelisting to suppress known-good activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs where adversaries use PowerShell with encoded commands or .lnk files for discovery, particularly in post-compromise scenarios. It correctly associates the technique with MITRE ATT&CK T1033 and T1027, reflecting common adversarial behavior involving living-off-the-land binaries and obfuscation.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Links detection to known adversary tactics (T1033, T1027) involving user discovery and command encoding",
              "Captures context of encoded commands and .lnk execution commonly seen in malware and phishing campaigns"
            ],
            "weaknesses": [
              "Lacks references to specific APT groups or campaigns that use this pattern",
              "Does not account for alternative discovery cmdlets like Get-NetUser or Get-WMIObject"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule has a critical flaw: the SIEM verification failed due to 'Unbalanced quotes' in the generated SPL, indicating untested, non-deployable syntax. While the logsource (Sysmon process creation on Windows) is common and realistic, the rule cannot be deployed without fixing syntax errors and validating the detection logic.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon event data widely available in enterprise environments",
              "Severity level 'medium' is appropriate for this type of discovery activity"
            ],
            "weaknesses": [
              "SPL translation contains syntax errors, making it non-functional in Splunk",
              "No evidence of testing or field validation; marked as generated by langchain"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule title and description clearly indicate what is being detected, and the inclusion of encoded command and .lnk execution provides investigative context. However, it lacks key fields like user context, parent process, or command-line length that would aid in pivoting during triage.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Clear title and description help analysts understand the alert quickly",
              "False positive guidance includes legitimate admin use and scripting"
            ],
            "weaknesses": [
              "Missing critical pivot fields (e.g., User, ParentImage, ProcessId)",
              "No references to enrichment steps or follow-up investigative queries"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects encoded commands and .lnk execution, which are relevant obfuscation techniques, but it relies heavily on command-line content that can be easily altered or split to evade detection. Attackers can bypass this by using alternative PowerShell invocation methods, argument splitting, or direct API calls.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Detects two common obfuscation vectors: encoded commands and .lnk files",
              "Combines multiple conditions to reduce trivial bypasses"
            ],
            "weaknesses": [
              "Relies solely on command-line arguments, which are easily obfuscated",
              "Vulnerable to simple evasion via cmdlet aliasing, variable substitution, or PowerShell core (pwsh.exe)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule primarily detects a single-stage execution event involving PowerShell with encoded commands or .lnk file usage, but does not extend to persistence, lateral movement, or data exfiltration stages. While it captures initial malicious activity, it lacks logic to correlate across multiple events or phases of an attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:12:09.249507",
          "metadata": {
            "strengths": [
              "Detects initial execution via suspicious PowerShell command-line patterns",
              "Includes contextual flags like encoded commands and .lnk file execution"
            ],
            "weaknesses": [
              "Limited to process creation event without follow-on detection logic",
              "No correlation with downstream discovery or lateral movement activities"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (System Owner/User Discovery via PowerShell with Encoded or .lnk Execution) scored 0.60/1.0 (Below Average). Best performance in quality (0.68). Needs improvement in detectability (0.46). Issues found in: detection_specificity, false_positive_resistance, operational_deployability",
      "timestamp": "2025-12-26T07:12:09.249507",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "System Owner/User Discovery via PowerShell with Encoded or .lnk Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5966666666666668,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6588235294117648,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like 'author', 'date', and 'status', which are essential for production rule management and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Includes core Sigma structure with proper logsource and detection sections",
              "Tags include MITRE ATT&CK ID (attack.t1010) and technique context"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status",
              "References field is absent despite MITRE link being available"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The detection logic captures known indicators of Application Window Discovery via PowerShell, including relevant cmdlets and .NET API calls. However, some CommandLine keywords like 'Get-Process' are overly broad and commonly used in legitimate administration, increasing false positives without additional context.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Covers multiple TTP indicators (Get-Window, EnumWindows, Screen enumeration)",
              "Uses correct field names (Image, CommandLine) compatible with Sysmon"
            ],
            "weaknesses": [
              "Get-Process is too generic and not specific to window discovery",
              "No parent process or user context to distinguish malicious use"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity due to broad CommandLine contains matches without contextual filters. It does not exclude common administrative tools or scripts, and uses no AND logic to require multiple indicators, increasing false positive risk in production environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Includes suspicious flags like '-WindowStyle Hidden'",
              "Targets PowerShell execution context, reducing noise from other sources"
            ],
            "weaknesses": [
              "Relies on 'contains' matches that may trigger on partial overlaps",
              "No exclusion of known benign parent processes (e.g., taskhost, explorer)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by including multiple variants: different PowerShell executables (powershell.exe, pwsh.exe), .NET API calls, and native cmdlets. It also captures obfuscation attempts via inclusion of common hidden window patterns and screen enumeration syntax.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Covers both Windows PowerShell and PowerShell Core (pwsh.exe)",
              "Includes .NET reflection and Win32 API patterns used in evasion"
            ],
            "weaknesses": [
              "Lacks regex or wildcard support for base64-encoded or split command obfuscation",
              "No case-insensitive matching explicitly defined despite Windows case insensitivity"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (attack.t1010) and a clear description, but lacks specific sub-technique mapping (e.g., T1010 is deprecated; should map to T1059.001 or T1614) and authoritative references. No threat actor, campaign, or malware family information is provided, reducing investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Correct high-level MITRE tagging and technique name",
              "Clear rule description and false positive notes"
            ],
            "weaknesses": [
              "Missing sub-technique precision and updated MITRE mapping",
              "No references to threat actors, campaigns, or tools"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith on Image, contains on CommandLine) and leverages indexed fields like Image and CommandLine. The logsource is specific to Sysmon process creation, and no leading wildcards or complex regex are used, ensuring good performance.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Uses indexed fields and efficient string operators",
              "Specific logsource with Sysmon context"
            ],
            "weaknesses": [
              "CommandLine|contains with 'Get-Process' may trigger on benign scripts",
              "Could prioritize more unique indicators first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic PowerShell-based window enumeration via common cmdlets and .NET APIs but misses advanced variants like reflective DLL loading, indirect process injection, or use via .NET through other loaders (e.g., rundll32). Coverage of frameworks like Cobalt Strike's PowerShell injection is incomplete without parent process or script block logging context.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Covers core PowerShell cmdlets and .NET screen APIs",
              "Includes both Get-Process and GUI-specific calls"
            ],
            "weaknesses": [
              "Lacks detection of obfuscated or encodedcommand variants",
              "No coverage of post-exploitation frameworks or indirect execution"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process lineage (parent process), user context, or execution path filtering, increasing FP risk. While false positives are documented, no detection-time exclusions (e.g., exclude SYSTEM, exclude Windows directory) are implemented. Single-event trigger without frequency or behavioral context limits precision.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Acknowledges common administrative use cases in FP notes",
              "Includes legitimate monitoring scripts as known FP"
            ],
            "weaknesses": [
              "No parent-child process filtering (e.g., w32tm.exe spawning powershell)",
              "Missing path or user-based exclusions to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures known PowerShell-based discovery techniques used in real attacks, including screen enumeration and window inspection via .NET APIs. However, it lacks specific references to APT groups or campaigns that leverage this behavior, and some command-line strings like 'Get-Process' are overly generic and not uniquely tied to malicious window discovery.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Includes relevant TTPs like [System.Windows.Forms.Screen]::AllScreens and EnumWindows",
              "Aligns with MITRE ATT&CK technique T1010 (Application Window Discovery)"
            ],
            "weaknesses": [
              "No linkage to real-world threat actors or campaigns",
              "Overreliance on generic cmdlets like Get-Process that are common in benign scripts"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses standard Sysmon process creation logging, which is widely deployed, and the syntax is valid and tested per siem_verification data showing 16 events detected. The medium severity level is appropriate, though false positives from administrative scripts may require tuning in some environments.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Validated detection with successful SIEM verification",
              "Uses common logsource (Sysmon process creation) available in most enterprises"
            ],
            "weaknesses": [
              "Potential for false positives from monitoring scripts using Get-Process",
              "No exclusion logic for known good tools or signed scripts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly communicate the detection intent, and the CommandLine and Image fields allow analysts to pivot effectively. False positive guidance helps triage, and the MITRE tag enables mapping to adversary behavior.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Clear title and descriptive context for investigation",
              "Detection fields support pivoting (process, command line)"
            ],
            "weaknesses": [
              "Lacks user context or host-based enrichment suggestions",
              "No recommended follow-up investigative steps in description"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line arguments, which attackers can easily obfuscate via encoding, string splitting, or variable substitution. While it includes some specific API calls, it does not account for common PowerShell obfuscation or reflection-based invocation of screen enumeration APIs.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Detects specific .NET API usage like [System.Windows.Forms.Screen]::AllScreens",
              "Includes -WindowStyle Hidden, a common stealth indicator"
            ],
            "weaknesses": [
              "Vulnerable to basic PowerShell obfuscation techniques",
              "No behavioral correlation (e.g., process ancestry, network callbacks) to strengthen detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of PowerShell with command-line indicators of window discovery but is limited to single-event process creation. It does not correlate across stages such as persistence, lateral movement, or follow-on data exfiltration, nor does it chain related events over time to confirm malicious intent.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:12:46.270259",
          "metadata": {
            "strengths": [
              "Detects initial use of PowerShell for window/process enumeration",
              "Includes relevant .NET and GUI-specific API indicators"
            ],
            "weaknesses": [
              "Single-event detection without temporal correlation",
              "No coverage of downstream attack stages or behavioral chaining"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (Application Window Discovery via PowerShell) scored 0.60/1.0 (Poor). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-26T07:12:46.270259",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "Application Window Discovery via PowerShell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6411764705882353,
        "effectiveness": 0.52,
        "realism": 0.6888888888888889,
        "detectability": 0.5
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Includes core detection components and meaningful metadata like MITRE tags and logsource.",
              "Properly structured with a unique ID and descriptive title."
            ],
            "weaknesses": [
              "Missing critical Sigma fields: author, date, status, and references.",
              "Incomplete due to truncated 'siem_verification' and 'generation_method' without validation context."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic captures key indicators of T1082: PowerShell use, encoded commands, and .lnk execution. However, the condition logic is flawed\u2014'selection_lnk' stands alone in an OR clause without requiring PowerShell context, increasing false positives. Also, 'ParentImage' filter is under-constrained when used in broad OR logic.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Accurately selects PowerShell-based discovery commands and encoded payloads.",
              "Includes relevant parent process context for common launchers."
            ],
            "weaknesses": [
              "Condition logic incorrectly allows .lnk execution to trigger independently of PowerShell activity.",
              "No case-insensitive matching specified, risking evasion via casing variation."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity due to overly broad OR logic\u2014execution via .lnk shortcut alone can trigger the rule regardless of command content. It also fails to exclude high-frequency benign scenarios like admin scripts or automation tools using -EncodedCommand. Parent process filtering is helpful but insufficient when combined with weak overall logic.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Uses specific command-line indicators like 'Get-WinEvent' and regex for encoded commands.",
              "Includes common malicious parent processes as filters."
            ],
            "weaknesses": [
              "Triggers on any .lnk file execution, even benign ones, due to OR condition.",
              "No exclusion of known good tools or signed scripts, increasing false positives."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple attack vectors: direct discovery commands, Base64-encoded payloads, and shortcut execution. The regex for encoded commands is robust and accounts for variations. However, it could improve by detecting alternative discovery cmdlets (e.g., Get-ComputerInfo, systeminfo.exe) and obfuscated command patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Covers both clear-text and encoded PowerShell execution methods.",
              "Detects common lateral movement enablers via Get-ADDomainController."
            ],
            "weaknesses": [
              "Limited to two specific cmdlets; misses other system discovery commands.",
              "No detection of PowerShell core (pwsh.exe) or alternate encodings (e.g., compressed scripts)."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tagging (T1082) and a clear description, but lacks specific references to authoritative sources, threat actors, or malware families. The generation method is noted as 'langchain', suggesting it may lack real-world validation or threat intelligence context.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique and tactic tags included",
              "Clear, descriptive title and explanation of detection logic"
            ],
            "weaknesses": [
              "Missing references to MITRE page or security research",
              "No attribution to known threat actors, campaigns, or tools"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field filters like 'endswith' on Image and ParentImage, avoids leading wildcards, and leverages indexed Sysmon process creation fields. However, the regex for Base64 could be optimized to reduce complexity and improve performance in large environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Uses efficient 'endswith' and 'contains' operators on indexed fields",
              "Logsource is specific to Sysmon process creation"
            ],
            "weaknesses": [
              "Base64 regex is broad and may slow query performance",
              "Condition logic could be reordered for faster evaluation"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects key aspects of PowerShell-based discovery via encoded commands and .lnk files, but misses broader sub-techniques like WMI or CIM usage, and does not cover other scripting interpreters (e.g., python, cscript). Coverage of advanced frameworks like Cobalt Strike or Empire is implied but not explicitly addressed.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Covers encoded PowerShell and shortcut execution vectors",
              "Includes common discovery cmdlets (Get-WinEvent, Get-ADDomainController)"
            ],
            "weaknesses": [
              "Limited to PowerShell; omits other scripting languages",
              "Does not detect alternative discovery methods (e.g., wmic, systeminfo)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes a parent process filter and acknowledges common false positives in metadata, but lacks actual exclusions (e.g., by user, path, or frequency). The detection logic triggers on single events without thresholding, increasing FP risk in admin-heavy environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Includes parent process context to narrow scope",
              "Comprehensive false positive guidance in metadata"
            ],
            "weaknesses": [
              "No actual whitelisting or exclusion logic in detection",
              "Single-event trigger without frequency or behavioral context"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs by targeting encoded PowerShell and shortcut execution, commonly used in post-compromise discovery. It includes relevant commands like Get-WinEvent and Get-ADDomainController, which are frequently abused by attackers for reconnaissance.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Covers known adversary behaviors such as Base64-encoded payloads and .lnk file execution",
              "Targets specific PowerShell cmdlets used in real attack chains"
            ],
            "weaknesses": [
              "Lacks references to specific APT groups or campaigns that use these techniques",
              "Does not account for timing or sequence of actions in a broader kill chain"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sysmon process creation fields and is syntactically sound, making it deployable in most Windows environments. However, the condition logic may generate excessive false positives due to broad parent process inclusion and overlapping OR conditions.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon logsource with widely available fields",
              "Includes realistic command-line patterns for encoded PowerShell"
            ],
            "weaknesses": [
              "Condition logic is overly permissive (e.g., 'selection_lnk' alone can trigger alert regardless of PowerShell context)",
              "High potential for false positives from legitimate admin scripts and shortcut usage"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the included fields (Image, ParentImage, CommandLine) support effective pivoting during investigation. False positive guidance is comprehensive and helps analysts triage alerts.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detailed false positive list",
              "Detection fields support process lineage and command-line analysis"
            ],
            "weaknesses": [
              "Lacks user context or host-based enrichment suggestions",
              "No direct MITRE ATT&CK mapping in the rule metadata beyond tags"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects common obfuscation like Base64 encoding and indirect execution via .lnk files, but remains vulnerable to simple evasion such as using alternate PowerShell interpreters (pwsh.exe), argumentless execution, or command obfuscation. Reliance on exact command-line strings reduces robustness.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Detects encoded command use and shortcut launch methods",
              "Includes parent process anomalies often seen in lateral movement"
            ],
            "weaknesses": [
              "Easily bypassed by obfuscating cmdlet names (e.g., 'Get-WinEvent' -> 'Get-Win*')",
              "No detection of PowerShell execution without command-line arguments (e.g., script blocks)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects initial execution via encoded PowerShell and shortcut file launches, and includes parent process context, which adds visibility into initial access or execution chains. However, it lacks logic to correlate follow-on activities like data exfiltration or lateral movement that may stem from system information discovery. The condition structure limits multi-event correlation, focusing on single-process indicators.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:13:25.424787",
          "metadata": {
            "strengths": [
              "Detects initial execution vectors (encoded commands, .lnk files)",
              "Includes parent process context to identify suspicious launch chains"
            ],
            "weaknesses": [
              "No support for detecting follow-on actions like data staging or exfiltration",
              "Condition logic is overly broad and does not require sequential or temporal correlation"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1082 (System Information Discovery via PowerShell (Encoded & Shortcut Execution)) scored 0.60/1.0 (Below Average). Best performance in realism (0.69). Needs improvement in detectability (0.50). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-26T07:13:25.424787",
      "metadata": {
        "attack_id": "attack.t1082",
        "technique_name": "System Information Discovery via PowerShell (Encoded & Shortcut Execution)",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5466666666666666,
      "category_scores": {
        "correctness": 0.6799999999999999,
        "quality": 0.5588235294117647,
        "effectiveness": 0.49333333333333335,
        "realism": 0.6111111111111112,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, falsepositives, level, and id. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Includes core detection components and meaningful tags with MITRE ATT&CK mapping",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete metadata reduces auditability and operational clarity"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic detects PowerShell using Get-Content and Compress-Archive, which aligns with data staging behavior under T1005. However, requiring both cmdlets in the same command line is overly restrictive\u2014attackers may use them separately or across different sessions. The condition may miss realistic attack chains.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Uses standard Sigma field names (Image, CommandLine)",
              "Targets relevant PowerShell cmdlets associated with data collection and compression"
            ],
            "weaknesses": [
              "AND logic between cmdlets increases risk of missing real attacks",
              "Does not account for multi-process or multi-stage data staging"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately specific but risks false positives due to common administrative use of these cmdlets. It lacks filters like parent process, user context, or command-line patterns that distinguish malicious from legitimate use, such as excluding SYSTEM or known backup tools.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Targets high-risk cmdlets not commonly used in routine operations",
              "Acknowledges false positives in documentation"
            ],
            "weaknesses": [
              "No exclusion logic for trusted processes or users",
              "Single-condition match increases alert noise"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is brittle to evasion: attackers can obfuscate cmdlet names (e.g., 'Get-Con*' or base64-encoded commands), use alternative tools (e.g., 7zip, robocopy), or split operations across commands. It lacks case-insensitive matching and regex patterns to catch variations, reducing real-world effectiveness.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Identifies two key data staging indicators in one rule",
              "Could trigger on unobfuscated, naive attacker scripts"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation and command splitting",
              "No support for encodedcommand or alternative syntax"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tagging (T1005), relevant CAR and custom tags, and a clear description. However, it lacks references to authoritative sources like MITRE pages, threat actors, malware families, or campaign names that would enhance investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK and CAR tags included",
              "Clear description linking PowerShell cmdlets to data staging"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to threat actors, malware, or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image endsWith, CommandLine contains) on indexed Sysmon process creation fields. It avoids leading wildcards and places specific conditions first. However, 'CommandLine|contains' with multiple terms could benefit from ordering by specificity and considering case sensitivity in some SIEMs.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids leading wildcards and uses endswith for process path"
            ],
            "weaknesses": [
              "Multiple 'contains' on CommandLine may increase noise without ordering or regex refinement",
              "Could use 'startswith' or 'endswith' for more precision where possible"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic use of Get-Content and Compress-Archive but misses broader PowerShell data staging techniques like Add-Type, .NET compression, or alternative cmdlets (e.g., Archive-File). It does not cover obfuscated commands, encoded commands, or multi-stage behaviors such as exfiltration preparation via multiple steps.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Covers core cmdlets associated with local data collection and compression",
              "Aligned with T1005 (Data from Local System)"
            ],
            "weaknesses": [
              "Narrow scope\u2014only two cmdlets, no obfuscation handling",
              "No detection of follow-on behaviors or alternative tooling (e.g., .NET, custom binaries)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process exclusions, parent-child context, or path-based filtering, making it prone to false positives from legitimate admin scripts. While false positives are documented, no detection-time filters (e.g., exclude system paths, known tools) are implemented to mitigate them.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive sources in metadata",
              "Focuses on two specific cmdlets reducing some noise"
            ],
            "weaknesses": [
              "No exclusion of system, admin, or backup tool paths",
              "No use of parent process context (e.g., w32time, schtasks)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs where adversaries use PowerShell cmdlets like Get-Content and Compress-Archive for data staging, which is consistent with MITRE T1005. However, it lacks specificity around known adversary usage patterns, such as common file targets, execution timing, or integration with broader attack chains like exfiltration over C2 channels.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Maps to MITRE T1005 (Data from Local System), a relevant and documented technique",
              "Targets PowerShell-based data collection and compression, common in real-world attacks"
            ],
            "weaknesses": [
              "No reference to specific APT groups or campaigns using this pattern",
              "Lacks context on how this fits into broader exfiltration workflows"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation logging (common in enterprises), and has been verified with detected events. The 'high' severity is appropriate, though false positives from administrative scripts may generate alert fatigue without additional filtering.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection of real events",
              "Uses widely available logsource (Sysmon process creation on Windows)"
            ],
            "weaknesses": [
              "High false positive potential due to legitimate PowerShell automation",
              "No additional constraints (e.g., parent process, user context) to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description clearly state what is detected, and the false positive guidance helps analysts triage. However, the detection lacks key pivot fields (e.g., file paths, user context, hashes) that would enable deeper investigation beyond the command line.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Clear title and description aid initial understanding",
              "False positive examples assist in triage decisions"
            ],
            "weaknesses": [
              "Limited investigative context in detection (missing file paths, user, host info)",
              "No references to follow-up queries or detection enrichment"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies solely on command-line arguments containing 'Get-Content' and 'Compress-Archive', which attackers can easily evade via obfuscation, aliasing, or alternative methods (e.g., .NET assemblies). It does not detect behavioral patterns or file system artifacts, making it vulnerable to LOLBin-style evasions.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Detects two-stage behavior (read + compress) in a single condition",
              "Targets native PowerShell cmdlets commonly used in data staging"
            ],
            "weaknesses": [
              "Easily bypassed by command obfuscation or alternative compression techniques",
              "No behavioral correlation with file creation or network exfiltration"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects a single stage\u2014data staging via PowerShell cmdlets\u2014but does not correlate across multiple attack phases such as initial access, lateral movement, or exfiltration. It lacks logic to chain related events over time or detect follow-on behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:03.364507",
          "metadata": {
            "strengths": [
              "Detects use of specific PowerShell cmdlets associated with data collection and compression",
              "Aligned with data staging phase of T1005"
            ],
            "weaknesses": [
              "No correlation across multiple stages (e.g., initial execution to exfiltration)",
              "Single-event detection without temporal or behavioral context"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1005 (Data from Local System via PowerShell Cmdlets) scored 0.55/1.0 (Poor). Best performance in correctness (0.68). Needs improvement in detectability (0.40). Issues found in: detection_specificity, detection_sensitivity, attack_coverage",
      "timestamp": "2025-12-26T07:14:03.364507",
      "metadata": {
        "attack_id": "attack.t1005",
        "technique_name": "Data from Local System via PowerShell Cmdlets",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5850000000000001,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6176470588235294,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces governance and maintainability"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly identifies PowerShell-based network scanning via cmdlets like Test-NetConnection and Get-NetTCPConnection. However, it may miss obfuscated or encoded commands and includes less relevant cmdlets like Get-NetAdapter, which are not directly tied to port scanning, increasing false positives.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Accurate selection of key PowerShell scanning cmdlets",
              "Sound AND condition linking process and command-line"
            ],
            "weaknesses": [
              "Includes non-scanning cmdlets (e.g., Get-NetAdapter)",
              "No handling of command obfuscation or encoding"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately broad due to use of 'contains' on generic cmdlet names without filtering on context like parent process, user, or command structure. This increases false positives from admin tools and automation scripts, despite listing them in falsepositives.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Uses specific cmdlet names rather than broad wildcards",
              "Combines process and command-line conditions"
            ],
            "weaknesses": [
              "Lacks exclusions for known benign parent processes (e.g., SCCM, Ansible)",
              "No user or session context filtering (e.g., non-interactive)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures multiple legitimate scanning indicators but does not account for common evasion techniques like command encoding, base64 payloads, or alternative tools (e.g., netcat, nmap). Case-insensitive matching is implied but not enforced, risking bypass via casing variation.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Covers multiple PowerShell cmdlets for service discovery",
              "Includes '-PortScan' flag as a strong indicator"
            ],
            "weaknesses": [
              "No regex or wildcard support for obfuscated commands",
              "Ignores non-PowerShell scanning tools and lateral movement vectors"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1046, discovery), references CAR and DFIR tags, and has a clear description. However, it lacks specific threat actor attribution, campaign names, or malware families, and the technique reference 'attack.discovery' is not a valid MITRE ID (should be T1046).",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Correctly tags MITRE T1046 and CAR analytics",
              "Clear description and relevant dfir.windows tagging"
            ],
            "weaknesses": [
              "Invalid MITRE technique ID format ('attack.discovery')",
              "Missing threat actor, campaign, or malware family context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith, contains) on indexed fields like Image and CommandLine, avoids leading wildcards, and applies specific filters. The condition logic is simple and leverages Sysmon process creation data effectively.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) with efficient operators",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains on multiple values may trigger on benign scripts",
              "Could benefit from ordering more specific terms first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic PowerShell cmdlets used for network scanning but misses advanced tools (e.g., Nmap, custom payloads via .NET), Cobalt Strike, or multi-stage scanning behaviors. It also omits other scripting engines like PowerShell Core (pwsh.exe) or WMI execution.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Covers common PowerShell cmdlets like Test-NetConnection and Get-NetTCPConnection",
              "Includes port scan keyword '-PortScan' which is highly indicative"
            ],
            "weaknesses": [
              "Lacks coverage for non-PowerShell tools (e.g., nmap, netcat)",
              "Does not detect scanning via .NET or WMI, or from memory-only payloads"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks behavioral context such as frequency, parent process, or user context to suppress false positives. While false positives are documented, no exclusion logic (e.g., excluding domain admins or known tool paths) is implemented in the detection logic.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Accurate identification of common false positive sources in metadata",
              "Focus on specific cmdlets reduces noise compared to generic PowerShell monitoring"
            ],
            "weaknesses": [
              "No thresholding or frequency-based logic to detect scanning patterns",
              "No parent-child process filtering (e.g., blocking cmd.exe -> powershell.exe chains)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs involving PowerShell-based network discovery, particularly around cmdlets like Test-NetConnection and Get-NetTCPConnection commonly abused by attackers. However, it lacks specificity around known adversary usage patterns, such as targeting specific ports, timing of scans, or correlation with post-compromise behavior. The absence of campaign or APT group references limits its contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Targets legitimate PowerShell cmdlets used in network reconnaissance",
              "Aligned with MITRE ATT&CK technique T1046 (Network Service Scanning)"
            ],
            "weaknesses": [
              "Lacks behavioral context (e.g., multiple failed connections, port ranges)",
              "No linkage to known adversary tools or campaigns"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation logging, and has been verified in a SIEM (Splunk), indicating production readiness. The false positives are acknowledged and reasonable for admin activity, but the medium severity helps manage alert fatigue. However, reliance solely on command-line content may yield noise in environments with automated PowerShell tooling.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Validated detection with real event matches in SIEM",
              "Realistic logsource (Sysmon process creation on Windows)"
            ],
            "weaknesses": [
              "High potential for false positives from legitimate admin scripts",
              "No filtering on user context or execution chain"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the tags provide MITRE ATT&CK alignment for analyst triage. The CommandLine field enables pivoting to related activity, and false positive guidance helps analysts quickly assess legitimacy. However, it could include more investigative fields like ParentImage or User for better context.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Clear title and description for rapid understanding",
              "Good false positive guidance aiding triage"
            ],
            "weaknesses": [
              "Missing key process lineage fields (e.g., ParentProcess, User)",
              "No suggested follow-up queries or investigation steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to common evasion techniques such as command obfuscation (e.g., encoded commands, variable substitution), alternative PowerShell hosts (pwsh.exe), or use of .NET classes instead of cmdlets. It relies entirely on plaintext command-line matching, making it easy to bypass via simple obfuscation. No detection logic accounts for LOLBin alternatives or indirect execution methods.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Covers multiple relevant cmdlets increasing coverage",
              "Includes '-PortScan' flag which is high-fidelity when present"
            ],
            "weaknesses": [
              "Easily evaded via command obfuscation or encoding",
              "No detection of equivalent .NET or WMI-based scanning techniques"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of PowerShell with network discovery cmdlets, which aligns with early-stage reconnaissance activity. However, it lacks logic to correlate across multiple stages such as persistence, lateral movement, or follow-on actions like data exfiltration. Detection is limited to single-event command-line matching without behavioral context or session-level analysis.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:14:40.004191",
          "metadata": {
            "strengths": [
              "Detects initial use of PowerShell for network scanning via known cmdlets",
              "Covers multiple relevant PowerShell commands in selection criteria"
            ],
            "weaknesses": [
              "No correlation across process trees or subsequent malicious activity",
              "Limited to command-line presence without thresholds or behavioral anomalies"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (Network Service Scanning via PowerShell and Common Tools) scored 0.59/1.0 (Poor). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-26T07:14:40.004191",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "Network Service Scanning via PowerShell and Common Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6283333333333334,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6764705882352942,
        "effectiveness": 0.5933333333333333,
        "realism": 0.6888888888888889,
        "detectability": 0.5
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE mappings. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Contains core detection components: title, ID, description, detection logic, and false positives.",
              "Tags include relevant MITRE ATT&CK techniques (e.g., attack.t1543, attack.t1059.001)."
            ],
            "weaknesses": [
              "Missing required Sigma fields: author, date, status, references.",
              "Incomplete siem_verification object and truncated detection block in input."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly targets suspicious execution of system processes via encoded PowerShell or common script hosts. However, the condition combines system process creation with suspicious command lines or parent processes, which may not accurately reflect T1543 (which involves creating/modifying Windows services), and instead leans toward execution and persistence via abuse of living off the land binaries.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Accurately identifies high-risk behaviors like Base64-encoded PowerShell in system process launches.",
              "Leverages known suspicious parent processes (rundll32, wscript) associated with LOLBINs."
            ],
            "weaknesses": [
              "Misalignment with T1543: creating/modifying system services, not just launching system executables.",
              "Condition could trigger on benign service restarts if initiated by cmd/powershell."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses specific image paths and regex for encoded commands, improving precision. However, it lacks filters on user context, command-line depth, or known good signatures, increasing risk of false positives from admin scripts or scheduled tasks spawning svchost/lsass via legitimate tooling.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Uses exact path endings for critical system binaries.",
              "Combines multiple conditions (cmd, parent, lnk) with OR logic under a shared AND condition for balance."
            ],
            "weaknesses": [
              "No exclusion of SYSTEM or LocalService contexts where these processes are normally spawned.",
              "No filtering on command-line length or entropy to distinguish malicious from benign encoded commands."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple attack vectors: encoded PowerShell, common script host parents, and .lnk execution. Case-insensitive regex and Base64 pattern matching help catch obfuscated commands, and multiple pathways increase coverage across adversarial tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Covers multiple TTPs: PowerShell abuse, LOLBINs, and shortcut execution.",
              "Regex for -EncodedCommand is case-insensitive and matches variable-length Base64."
            ],
            "weaknesses": [
              "Does not account for PowerShell Core (pwsh.exe) or alternate encodings (e.g., compressed + encoded).",
              "No detection of process hollowing or direct system process injection, which are more stealthy variants."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1543, T1059.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description is informative but could include more context on adversary behavior.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Accurate and relevant MITRE ATT&CK tagging",
              "Clear rule title and description explaining detection logic"
            ],
            "weaknesses": [
              "Missing MITRE references or links to threat intelligence",
              "No attribution to known threat actors or malware using this technique"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators like 'endswith' on indexed fields (Image, ParentImage) and avoids leading wildcards. The regex for Base64-encoded commands is reasonably scoped, though it could be optimized further by anchoring or limiting length.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Uses performant operators (endswith) on high-cardinality fields",
              "Logsource is specific to Sysmon process creation events"
            ],
            "weaknesses": [
              "Regex for Base64 command could benefit from length constraints to reduce overhead",
              "No short-circuiting logic to prioritize most selective conditions first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects key vectors like encoded PowerShell and suspicious parents spawning system processes, but misses advanced variants such as reflective DLL injection into svchost or use of alternate interpreters (e.g., mshta, regsvr32). Coverage of shortcut execution is good but limited to .lnk file launch, not creation.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Covers common attack paths: encoded PowerShell, suspicious parents, .lnk execution",
              "Includes relevant system processes often targeted for persistence"
            ],
            "weaknesses": [
              "Does not detect process injection into system processes",
              "Limited coverage of LOLBins beyond basic parent processes"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks active filtering logic to suppress them\u2014no exclusions for system accounts, trusted paths, or scheduled tasks. Relies solely on detection conditions without thresholding or context enrichment to reduce noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Comprehensive false positive documentation in metadata",
              "Logical grouping of suspicious parent processes"
            ],
            "weaknesses": [
              "No exclusion logic for legitimate administrative use cases",
              "Lacks time-based or frequency-based correlation to distinguish anomalies"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with known TTPs where adversaries abuse PowerShell and shortcut files to create or modify system processes for persistence. It reflects real-world techniques like Base64-encoded commands and suspicious parent processes commonly seen in malware and APT activity.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Matches documented adversary behavior involving encoded PowerShell and .lnk files",
              "Targets high-value system processes frequently abused for persistence"
            ],
            "weaknesses": [
              "Lacks specific references to APT groups or campaigns that use this pattern",
              "Does not incorporate timing or sequence-based logic to reflect multi-stage attack chains"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sysmon process creation logging, which is common in enterprise environments, and has a realistic detection logic structure. However, the false positive list suggests potentially high noise, especially from legitimate administrative scripts and system services.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon event data widely available in production",
              "Condition logic is syntactically sound and deployable"
            ],
            "weaknesses": [
              "High risk of false positives from encoded PowerShell in legitimate automation",
              "Missing thresholds or additional filters to reduce alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the fields used (Image, ParentImage, CommandLine) are highly useful for investigation. False positive guidance helps analysts triage alerts more efficiently.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable description",
              "Includes relevant process lineage and command-line data for pivoting"
            ],
            "weaknesses": [
              "Lacks inclusion of user context or image hashes for better attribution",
              "No direct MITRE ATT&CK mapping in the rule metadata despite tags"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While the rule detects encoded PowerShell and suspicious parent processes, it relies heavily on command-line arguments, which attackers can obfuscate or bypass using alternative encoding or reflection techniques. It does not incorporate file creation or network callbacks that could strengthen behavioral detection.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Detects Base64-encoded PowerShell, a common obfuscation method",
              "Includes multiple parent process indicators to catch LOLBin abuse"
            ],
            "weaknesses": [
              "Relies heavily on command-line content, which can be hidden or split",
              "No detection logic for alternative evasion methods like PowerShell Core or direct syscalls"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects initial execution through suspicious parent processes or encoded PowerShell, and may catch persistence via shortcut (.lnk) abuse. However, it lacks logic to correlate across multiple stages like lateral movement or data exfiltration, limiting detection to single-event triggers without temporal or behavioral context.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:16.953601",
          "metadata": {
            "strengths": [
              "Detects initial access via encoded PowerShell and suspicious launchers",
              "Covers persistence through .lnk file execution"
            ],
            "weaknesses": [
              "No correlation across multiple events or time-based behavior",
              "Does not detect lateral movement or exfiltration stages tied to this TTP"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1543 (Create or Modify System Process via Suspicious PowerShell or Shortcut Execution) scored 0.63/1.0 (Below Average). Best performance in realism (0.69). Needs improvement in detectability (0.50). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-26T07:15:16.953601",
      "metadata": {
        "attack_id": "attack.t1543",
        "technique_name": "Create or Modify System Process via Suspicious PowerShell or Shortcut Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7283333333333334,
      "category_scores": {
        "correctness": 0.7200000000000001,
        "quality": 0.776470588235294,
        "effectiveness": 0.7733333333333334,
        "realism": 0.7444444444444445,
        "detectability": 0.5555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE references. However, it lacks mandatory fields like 'id', 'status', 'author', 'date', and some tags are cut off, indicating incomplete structure.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE ATT&CK tags",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing required Sigma fields: id, author, date, status",
              "Truncated tags and incomplete JSON structure"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately captures known behaviors of command and scripting interpreter abuse, including Base64-encoded PowerShell, WScript execution flags, and Office-launched shells. Field names follow standard Sigma conventions and align with Sysmon process creation logging.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Accurate use of Image and CommandLine fields for behavioral patterns",
              "Condition combines multiple relevant selections logically"
            ],
            "weaknesses": [
              "No exclusion of known benign parent processes (e.g., software installers)",
              "Regex for Base64 could be evaded with shorter payloads"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses specific command-line arguments and image paths to reduce noise, and includes context like ParentImage for Office-originated executions. However, it lacks filters for user context or known safe command-line patterns, increasing false positive risk in environments with administrative automation.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Uses precise command-line indicators (e.g., -enc, //B)",
              "Leverages parent-child process relationships for Office abuse"
            ],
            "weaknesses": [
              "No exclusions for trusted administrators or scripts",
              "'.lnk' file detection is overly broad without path or content context"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule demonstrates strong sensitivity by covering multiple vectors (PowerShell, cmd, WScript, LNK, Office), using case-insensitive regex for encoded commands, and detecting common obfuscation techniques. It effectively balances breadth across interpreter types while targeting high-risk indicators.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Covers diverse execution interpreters and attack variants",
              "Employs regex to detect long Base64 strings typical in malware"
            ],
            "weaknesses": [
              "Could miss PowerShell core (pwsh.exe) or alternate encodings",
              "No detection of obfuscated IEX/DownloadString via variable assignment"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1059, sub-techniques), a clear description, and references MITRE via URL. However, it lacks threat actor names, malware families, or campaign context that would enhance investigative value.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Accurate and specific MITRE ATT&CK tagging including sub-techniques",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing threat actor or malware family associations",
              "No references to real-world campaigns or detailed external sources beyond MITRE"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like 'endswith' on Image and ParentImage, avoids leading wildcards, and structures conditions using high-cardinality fields first. The regex for Base64 is well-scoped but could be optimized to reduce overhead on long command lines.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) with efficient operators (endswith, contains)",
              "Logical grouping of conditions with specific early filters"
            ],
            "weaknesses": [
              "Regex for Base64 payload may trigger expensive pattern matching on large strings",
              "Could benefit from ordering selections by likelihood to improve evaluation speed"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule effectively covers major interpreter-based execution vectors: cmd, PowerShell (including encoded commands), WScript, LNK files, and Office-spawned shells. It captures both basic and advanced tactics like Base64-encoded payloads and script interpreters via Office macros.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Comprehensive coverage across multiple interpreter types and execution methods",
              "Includes detection of sophisticated techniques like -EncodedCommand and IEX"
            ],
            "weaknesses": [
              "Lacks coverage for other scripting interpreters (e.g., cscript, mshta, scriptrunner)",
              "No detection of obfuscated or compressed payloads beyond Base64"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule lists common false positives in metadata but lacks active filtering logic (e.g., excluding trusted parent processes, system paths, or user contexts). Relies on detection of suspicious flags without behavioral thresholds or context-aware suppression.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Acknowledges key false positive scenarios in metadata",
              "Uses specific command-line indicators that reduce noise compared to broad matches"
            ],
            "weaknesses": [
              "No exclusion logic for known good tools or administrative scripts",
              "Lacks frequency-based or parent-process whitelisting to suppress benign activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule aligns well with real-world TTPs, particularly in detecting Base64-encoded PowerShell commands and Office applications spawning shells\u2014common in malware and APT activity. It reflects attacker preferences for living-off-the-land binaries and obfuscation techniques observed in campaigns.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Covers known attacker techniques like -EncodedCommand and script interpreters",
              "Includes behavioral patterns seen in real-world attacks (e.g., Office launching cmd)"
            ],
            "weaknesses": [
              "Lacks references to specific APT groups or campaigns that use these methods",
              "Does not incorporate timing or sequence-based logic (e.g., rapid process spawning)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax appears valid and uses common Sysmon event fields available in most enterprise environments. However, the false positive list suggests moderate FP risk, especially around scheduled tasks and legitimate macros, which could lead to alert fatigue without tuning.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon process creation logging, widely deployed",
              "Clear severity level (high) appropriate for suspicious execution chains"
            ],
            "weaknesses": [
              "No mention of testing or tuning in real environments",
              "High potential for FPs from automated admin scripts using -EncodedCommand"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate what is detected, and the detection fields (Image, CommandLine, ParentImage) are highly useful for investigation. False positive guidance helps analysts triage common benign cases.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection logic for quick triage",
              "Provides actionable fields like CommandLine and ParentImage for pivoting"
            ],
            "weaknesses": [
              "Missing MITRE ATT&CK context in description (e.g., T1059 sub-techniques)",
              "No suggested next steps or enrichment guidance (e.g., check for network connections)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects some obfuscation (long Base64 strings) and indirect execution paths (Office spawning shells), but attackers can bypass it by using alternative LOLBins, argumentless PowerShell, or direct system API calls. Reliance on command-line arguments remains a vulnerability.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Detects Base64-encoded payloads via regex pattern matching",
              "Covers lateral movement vectors like .lnk files and script interpreters"
            ],
            "weaknesses": [
              "Vulnerable to PowerShell evasion via command-line suppression (e.g., -WindowStyle Hidden)",
              "No detection of renamed executables or alternative interpreters (e.g., mshta, cscript)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects initial execution of command and scripting interpreters, particularly through suspicious command-line arguments and parent-child process relationships, which covers early-stage activity. However, it lacks logic to detect persistence, lateral movement, or follow-on actions such as data exfiltration, limiting its multi-stage coverage. Correlation is minimal, focusing on single-event triggers rather than behavioral chains.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:15:52.710579",
          "metadata": {
            "strengths": [
              "Detects initial execution via high-fidelity indicators like Base64-encoded PowerShell commands",
              "Covers multiple interpreter types (cmd, PowerShell, WScript, Office) in one rule"
            ],
            "weaknesses": [
              "No detection of persistence mechanisms using these interpreters",
              "Lacks correlation across events to identify progression beyond initial execution"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Command and Scripting Interpreter Activity Detected via Enhanced Behavioral Patterns) scored 0.73/1.0 (Fair). Best performance in quality (0.78). Needs improvement in detectability (0.56). Issues found in: multi_stage_detection",
      "timestamp": "2025-12-26T07:15:52.710579",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Command and Scripting Interpreter Activity Detected via Enhanced Behavioral Patterns",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6616666666666667,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.7235294117647059,
        "effectiveness": 0.6333333333333333,
        "realism": 0.6888888888888889,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Includes essential fields: title, id, description, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with meaningful content"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete tags with no author or operational status indication"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately targets known obfuscation techniques: Base64-encoded PowerShell, common obfuscated cmdlets (IEX), and .lnk execution. The condition requiring a script host parent process adds context and reduces noise. Field names are standard Sigma syntax and compatible with Sysmon.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Accurate selection of TTP indicators (e.g., -enc, IEX, .lnk execution)",
              "Sound condition logic combining malicious indicators with suspicious parent processes"
            ],
            "weaknesses": [
              "Redundant '/enc' entry in CommandLine|contains list",
              "No case-insensitive flag on regex or contains, risking evasion via casing"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule combines multiple conditions to improve precision, especially by requiring a script host parent. However, it may still trigger on legitimate admin scripts using Base64 or IEX, and '.lnk' in Image could be too broad without path filtering. More context (e.g., user, image path) would improve specificity.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "AND condition with script host parent increases precision",
              "Regex enforces minimum encoded string length to reduce noise"
            ],
            "weaknesses": [
              "'.lnk' in Image field may catch user-launched shortcuts from trusted paths",
              "No exclusion for known good tools or signed scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule covers multiple vectors: encoded PowerShell, obfuscated commands, and shortcut execution. Regex for Base64 detects long encoded strings, and inclusion of common obfuscation keywords increases coverage. It is resilient to path variations and minor obfuscation changes.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Covers multiple attack variants (Base64, IEX, .lnk)",
              "Regex pattern captures variable-length encoded payloads effectively"
            ],
            "weaknesses": [
              "Lacks case-insensitive matching, allowing simple evasion",
              "No detection of alternative encodings (e.g., hex, gzip) or PowerShell core (pwsh.exe)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1027) and maps to defense evasion, but lacks sub-technique specificity and authoritative references like MITRE URLs or threat actor examples. The description is clear but could include more context on tooling or campaigns.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1027)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing MITRE sub-technique (e.g., T1027.002 for command-line packing)",
              "No references to MITRE page or real-world threat actors"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like Image|endswith and avoids leading wildcards. The regex for Base64 is reasonably constrained by length, and conditions are logically grouped using indexed fields like Image and CommandLine.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Uses endswith and contains efficiently on indexed fields",
              "Regex pattern includes length threshold to reduce noise"
            ],
            "weaknesses": [
              "Regex '[a-zA-Z0-9\\+\\/]{50}={0,2}' may still trigger on long benign strings",
              "No field precedence optimization in condition grouping"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers key obfuscation vectors: Base64-encoded PowerShell, obfuscated cmdlets (IEX), and .lnk execution. However, it misses other common obfuscation methods like XOR, compression, or JavaScript/WScript-based encoding, and lacks coverage for other interpreters like Python or .NET.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Detects Base64-encoded PowerShell via -enc and long encoded strings",
              "Includes .lnk file execution and script host parents"
            ],
            "weaknesses": [
              "No detection for non-PowerShell obfuscation (e.g., JScript, HTA, Python)",
              "Misses advanced packing techniques (e.g., reflective loading, string splitting)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes basic parent-process context via selection_script_host_parent, which helps reduce noise, but lacks path-based exclusions, user context, or frequency thresholds. The false positives list is generic and lacks actionable mitigation or tuning guidance.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Uses parent process filtering (wscript, cmd, etc.) to add context",
              "Combines multiple conditions to reduce single-event triggers"
            ],
            "weaknesses": [
              "No exclusions for trusted paths (e.g., C:\\Windows\\System32)",
              "False positive guidance is vague and not operational"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs such as Base64-encoded PowerShell and .lnk file execution commonly used in defense evasion. It reflects known attacker behaviors, particularly in initial access and execution stages, though lacks specific references to APT groups or campaigns that would enhance contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Covers common obfuscation techniques used by real threat actors",
              "Matches known attack chains involving script hosts and encoded commands"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Limited coverage of advanced obfuscation methods like AST-based PowerShell attacks"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sysmon process creation logging, which is common in enterprise environments, and has been verified in a SIEM. However, the false positive list suggests potentially high noise, especially from legitimate administrative scripts and user-launched .lnk files, which may require tuning before broad deployment.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Based on widely available Sysmon data",
              "Includes verified detection with real event matches"
            ],
            "weaknesses": [
              "High risk of false positives from Base64-encoded PowerShell and .lnk usage",
              "Lacks thresholding or additional filtering to reduce alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the fields used (Image, ParentImage, CommandLine) are highly useful for investigation. False positive guidance helps analysts triage, and the severity level supports prioritization.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Clear title and descriptive context for analysts",
              "Detection fields enable effective pivoting (e.g., parent process, command line)"
            ],
            "weaknesses": [
              "Missing hash or file path indicators for deeper forensic analysis",
              "No direct MITRE ATT&CK mapping in tags (e.g., T1027.002)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects common obfuscation patterns but is vulnerable to simple bypasses like using alternative encoding, direct memory execution, or renamed PowerShell instances. Reliance on command-line arguments and lack of behavioral correlation reduce resilience against sophisticated attackers using LOLBins or API-based execution.",
          "confidence": 0.8,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Detects Base64 patterns and common obfuscated PowerShell cmdlets",
              "Includes parent process context via script host detection"
            ],
            "weaknesses": [
              "Easily evaded by attackers using non-standard encodings or direct .NET execution",
              "No secondary detection vectors (e.g., network callbacks or file writes)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule primarily detects initial execution via obfuscated PowerShell, .lnk files, and script host parents, but lacks logic to correlate across later stages like persistence, lateral movement, or exfiltration. It is largely a single-event detection without stateful correlation or session tracking.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:16:31.215333",
          "metadata": {
            "strengths": [
              "Detects initial execution vectors commonly used in obfuscation (e.g., Base64 PowerShell, .lnk files)",
              "Includes parent process context to increase relevance of alerts"
            ],
            "weaknesses": [
              "No detection logic for persistence or lateral movement stages",
              "Lacks event correlation across time or process trees for multi-stage attack visibility"
            ]
          }
        }
      ],
      "summary": "Rule for attack.defense_evasion (Obfuscated Files or Information Detection) scored 0.66/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.46). Issues found in: false_positive_resistance, evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-26T07:16:31.215333",
      "metadata": {
        "attack_id": "attack.defense_evasion",
        "technique_name": "Obfuscated Files or Information Detection",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6649999999999999,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6764705882352942,
        "effectiveness": 0.7133333333333333,
        "realism": 0.6888888888888889,
        "detectability": 0.5444444444444445
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mappings. However, it lacks mandatory fields like 'id', 'status', 'author', 'date', and 'references', which are essential for production rule management and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Contains comprehensive description and proper logsource definition",
              "Includes MITRE ATT&CK tags and false positives"
            ],
            "weaknesses": [
              "Missing critical Sigma fields: id, author, date, status, references",
              "Incomplete structure limits operational use in SIEM/SOAR workflows"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic accurately captures known exfiltration behaviors using command-line tools like PowerShell, certutil, and bitsadmin. Conditions are logically structured and map to real adversary techniques, though some selections (e.g., cmd.exe redirection) are overly broad without contextual constraints.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Correctly identifies encoded PowerShell and C2-enabling tools",
              "Leverages regex to validate base64-encoded payloads of significant length"
            ],
            "weaknesses": [
              "Cmd.exe redirection detection is too generic and prone to false positives",
              "No exclusion of common benign parent processes or system contexts"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While the rule uses specific indicators like '-enc' with regex length filtering, several selections (especially cmd.exe and PowerShell web cmdlets) are too broad without additional context such as parent process, user context, or network connection correlation, increasing false positive risk in production.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Regex pattern for encoded commands improves specificity",
              "Multiple tool-based selections reduce reliance on single indicator"
            ],
            "weaknesses": [
              "Lacks constraints on user, parent process, or destination domains",
              "Cmd.exe redirection detection matches nearly all batch scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates strong sensitivity by covering multiple exfiltration vectors (PowerShell, certutil, bitsadmin) and encoding methods. It uses flexible regex and case-insensitive matching implicitly, capturing common obfuscation tactics while maintaining detection across tool variants.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Covers multiple TTP implementations (PowerShell, certutil, bitsadmin)",
              "Regex for encoded commands detects obfuscated payloads over 100 chars"
            ],
            "weaknesses": [
              "Does not account for PowerShell core (pwsh.exe) or renamed binaries",
              "No detection of compressed or chunked exfiltration methods"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1071.001, T1027) and maps to Exfiltration, though tactic is incorrectly implied as 'execution' in context instead of 'exfiltration'. Description is clear but lacks references to threat actors, malware families, or external sources like MITRE pages or research blogs.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Accurate MITRE technique IDs included in tags",
              "Clear rule title and description of detection logic"
            ],
            "weaknesses": [
              "Missing MITRE ATT&CK reference URL in metadata",
              "No attribution to threat actors, malware, or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses indexed fields like Image and CommandLine effectively, applies endswith for process paths, and avoids leading wildcards. Regex is constrained by length and pattern, and conditions are logically grouped. Logsource is specific to Sysmon process creation on Windows.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Uses efficient operators (endswith, contains) on high-cardinality fields",
              "Regex is bounded and targeted to long encoded strings"
            ],
            "weaknesses": [
              "Could reorder conditions to place most selective (e.g., regex) later for performance",
              "No use of parent process context which could reduce noise"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule comprehensively covers major command-line exfiltration tools (PowerShell, certutil, bitsadmin, cmd.exe) and techniques including encoded payloads and web transfers. It captures both basic and moderately advanced methods used by red teams and malware. Only minor gaps in alternative tools (e.g., curl, ftp) or obfuscation layers remain.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Covers multiple exfiltration vectors across common Windows tools",
              "Detects both encoding and direct web exfiltration in PowerShell"
            ],
            "weaknesses": [
              "Lacks coverage for newer tools like 'curl' or 'aria2c'",
              "No detection of compressed or segmented exfiltration"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks active filtering logic (e.g., excluding trusted parent processes, paths, or user contexts). It triggers on single events without frequency or behavioral thresholds, increasing alert fatigue risk in environments with routine administrative scripting.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Comprehensive false positive documentation in metadata",
              "Logical separation of detection conditions per tool"
            ],
            "weaknesses": [
              "No parent-child process constraints (e.g., w32time spawning powershell)",
              "Lacks thresholds or time-window correlation to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns well with known adversary TTPs involving command-line tools for exfiltration, particularly PowerShell, certutil, and bitsadmin, which are commonly abused in real-world attacks. It reflects actual tool usage patterns, such as encoded PowerShell and certutil for data encoding, though it lacks specific references to APT groups or campaigns that use these techniques.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Covers multiple real-world LOLBins commonly used in exfiltration",
              "Detection logic reflects actual attacker behavior (e.g., -enc with long base64)"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Missing context on timing or multi-stage attack chains"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sigma syntax and targets Sysmon process creation events, which are widely deployed, but the broad cmd.exe and PowerShell conditions may generate high false positives. The 'high' severity is justified, but without additional filtering (e.g., network connections, child processes), alert volume could overwhelm SOC teams.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Valid logsource and field mappings for Windows/Sysmon environments",
              "Clear detection conditions based on observable process activity"
            ],
            "weaknesses": [
              "High potential for false positives (e.g., legitimate scripts using PowerShell web cmdlets)",
              "Lacks correlation with network or file activity to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the fields captured (Image, CommandLine) provide essential context for investigation. False positive guidance is practical and helps analysts triage alerts from administrative scripts or installers.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Clear title and description aid analyst understanding",
              "False positive list supports efficient triage"
            ],
            "weaknesses": [
              "Lacks inclusion of user context or destination IP for immediate pivoting",
              "No references to MITRE ATT&CK or response playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects common encoding and tool usage patterns, offering some resistance to basic obfuscation, but attackers can bypass it by using alternative encoding methods, direct API calls, or renamed tools. It relies heavily on command-line arguments, which can be split, obfuscated, or avoided entirely in advanced attacks.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Regex pattern for -enc with long base64 adds resilience against trivial use",
              "Covers multiple tools (certutil, bitsadmin) reducing single-point reliance"
            ],
            "weaknesses": [
              "Relies heavily on command-line content, which is easily obfuscated",
              "No detection of child processes or network connections enabling exfiltration"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects multiple exfiltration-related activities such as encoded PowerShell, certutil usage, and BITS transfers, which cover initial execution and data exfiltration stages. However, it lacks correlation logic across events or time, limiting detection of multi-stage attack chains. It does not address persistence or lateral movement uses of these tools.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:07.060022",
          "metadata": {
            "strengths": [
              "Covers multiple command-line tools commonly abused for exfiltration",
              "Includes detection of encoded payloads and web transfers"
            ],
            "weaknesses": [
              "No temporal or event correlation for multi-stage behavior",
              "Does not detect persistence or lateral movement via these tools"
            ]
          }
        }
      ],
      "summary": "Rule for attack.exfiltration (Exfiltration Over C2 Channel via Command Line Tools) scored 0.66/1.0 (Below Average). Best performance in effectiveness (0.71). Needs improvement in detectability (0.54). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-26T07:17:07.060022",
      "metadata": {
        "attack_id": "attack.exfiltration",
        "technique_name": "Exfiltration Over C2 Channel via Command Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.66,
      "category_scores": {
        "correctness": 0.74,
        "quality": 0.7294117647058823,
        "effectiveness": 0.5933333333333333,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes most required Sigma fields with meaningful content, such as title, id, description, tags, logsource, detection, falsepositives, and level. Missing fields include 'author', 'date', and 'status', which are required in production-grade Sigma rules. The 'references' field is also absent despite having MITRE ATT&CK links available.",
          "confidence": 1.0,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Well-structured with essential fields like detection logic, tags, and logsource properly defined",
              "Includes relevant metadata such as MITRE ATT&CK tags and a clear description"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, and references",
              "Generation method listed as 'langchain' instead of human-reviewed origin"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic accurately captures known archiving utilities and their common command-line arguments for compression (e.g., 7z 'a', tar '-c'). However, some command-line fragments like '.zip' or '.tar' in isolation may not be sufficient to confirm malicious intent, and PowerShell detection relies on string matching that could miss obfuscated commands. The condition logic is sound but could benefit from more precise argument parsing.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Correctly maps command-line patterns to archiving behaviors associated with T1560",
              "Covers multiple tools (7z, zip, tar, PowerShell) used in data compression attacks"
            ],
            "weaknesses": [
              "Relies on partial string matches that may not distinguish between creation and extraction",
              "PowerShell detection lacks depth (e.g., no consideration of encoded commands or module logging)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule lacks specificity due to broad command-line contains checks (e.g., '-r', '.zip') that are common in legitimate administrative and DevOps workflows. It does not filter by user context, parent process, or target paths (e.g., user directories vs. temp folders), increasing false positive risk. While false positives are acknowledged, no mitigation is built into the detection logic.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Differentiates between tools with separate selection criteria",
              "Acknowledges common false positive sources in documentation"
            ],
            "weaknesses": [
              "No exclusion of system or admin-initiated processes",
              "Lacks contextual constraints like file path, size, or destination"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple archiving tools and command variants, including native Windows utilities and PowerShell wrappers. It uses pattern matching that can catch common syntax across environments. However, it may miss obfuscated PowerShell (e.g., base64-encoded Compress-Archive calls) or alternative tools like WinRAR or custom binaries not explicitly covered.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Covers multiple vectors (native binaries and PowerShell) for the same TTP",
              "Includes common command flags across different tools for robust coverage"
            ],
            "weaknesses": [
              "Does not account for renamed or sideloaded binaries (e.g., 7z renamed to backup.exe)",
              "Limited detection of encoded or obfuscated PowerShell commands"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1560) and a clear description, but lacks references to authoritative sources, threat actors, or malware families. The description is functional but could provide more operational context for investigators.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging (attack.t1560, CAR mapping)",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing MITRE ATT&CK tactic (should be 'Collection', not 'Execution')",
              "No references to MITRE page, threat actors, or real-world usage examples"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) on indexed Sysmon fields with no leading wildcards. Conditions are logically grouped and use fast string operations; logsource is appropriately specific to Windows process creation via Sysmon.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Uses high-performance operators (endswith, contains) on indexed fields",
              "No leading wildcards or expensive regex patterns"
            ],
            "weaknesses": [
              "Could prioritize more specific command-line flags first to short-circuit evaluation",
              "CommandLine|contains arrays may trigger on partial matches in wrong context"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers common archiving tools (7z, zip, tar, PowerShell) and basic command-line arguments, but misses advanced variants like WSL tar usage, .NET compression libraries, or Cobalt Strike's execute-assembly. It does not detect alternative execution methods or obfuscated commands.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Covers major native and third-party archiving utilities",
              "Includes PowerShell-based compression methods"
            ],
            "weaknesses": [
              "Lacks detection of .NET/System.IO.Compression or JScript-based archiving",
              "No coverage of WSL, Docker, or cloud CLI tools (e.g., aws zip)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks inline filtering for trusted paths, users, or parent processes. It triggers on single events without frequency or context thresholds, increasing alert fatigue in environments with routine backup scripts.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate software packaging and DevOps use cases",
              "Lists realistic false positive scenarios in metadata"
            ],
            "weaknesses": [
              "No exclusion logic for system paths (e.g., C:\\Program Files\\7-Zip)",
              "Lacks parent-process constraints (e.g., blocking powershell from explorer.exe)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs under T1560, capturing common archiving tools and parameters used by adversaries. However, it lacks specific references to known APT groups or campaigns that leverage archiving for exfiltration, limiting contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Covers key archiving tools (7z, zip, tar, PowerShell) commonly abused by attackers",
              "Matches MITRE T1560 technique with relevant command-line arguments"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or real-world incidents",
              "Limited context on timing, target scope, or data staging behaviors"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses standard Sysmon process creation events with clear field mappings, making it deployable in most Windows environments. SIEM verification shows successful detection with 16 events, indicating practical viability and low syntax risk.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Validated via SIEM query with successful detection results",
              "Uses common log source (Sysmon process creation) widely deployed"
            ],
            "weaknesses": [
              "Medium severity may not prioritize high-risk archiving activities",
              "No suppression logic for known benign processes or paths"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule provides clear detection logic and false positive guidance, aiding analyst triage. However, it lacks enrichment fields like user context, parent process, or file paths that would enhance investigation pivoting.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Clear title and description explaining the detection intent",
              "False positives well-documented for common operational scenarios"
            ],
            "weaknesses": [
              "Missing key investigative fields (e.g., User, ParentImage)",
              "No direct links to response playbooks or MITRE mitigation guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line arguments and exact executable names, making it vulnerable to simple evasion like binary renaming, LOLBins, or obfuscated PowerShell. It does not incorporate behavioral patterns or file creation follow-up to detect obfuscation.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Covers multiple archiving tools reducing single-point reliance",
              "Includes PowerShell-based compression methods commonly used in attacks"
            ],
            "weaknesses": [
              "Easily bypassed by renamed binaries or compressed scripts",
              "No detection logic for alternative compression methods (e.g., .NET libraries)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects process creation events associated with archiving tools, which aligns with initial execution and data collection stages of T1560. However, it lacks logic to correlate across multiple stages such as persistence, lateral movement, or exfiltration, and operates primarily as a single-event detection. While it identifies potential data packaging, it does not chain related behaviors over time or contextually enrich with other TTPs.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:17:43.603948",
          "metadata": {
            "strengths": [
              "Detects initial use of common archiving utilities during data collection",
              "Covers multiple tools (7z, zip, tar, PowerShell) in one rule"
            ],
            "weaknesses": [
              "No correlation across attack lifecycle stages (e.g., follow-on exfiltration)",
              "Relies solely on command-line indicators without behavioral context"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1560 (Archive Collected Data via Archiving Tools) scored 0.66/1.0 (Below Average). Best performance in realism (0.76). Needs improvement in detectability (0.46). Issues found in: false_positive_resistance, evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-26T07:17:43.603948",
      "metadata": {
        "attack_id": "attack.t1560",
        "technique_name": "Archive Collected Data via Archiving Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "858ce5f9-09ce-4a58-a608-af469856931f",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.645,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6411764705882353,
        "effectiveness": 0.6733333333333335,
        "realism": 0.6888888888888889,
        "detectability": 0.5444444444444445
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like 'status', 'author', 'date', and 'references', which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Includes meaningful MITRE ATT&CK tags (attack.t1547.001)",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing critical fields: status, author, date, references",
              "Incomplete siem_verification object (truncated)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic captures key aspects of the TTP: registry Run key modifications via reg.exe/powershell, .lnk execution, and Base64-encoded PowerShell. However, the condition combines registry modification with parent process filtering only for that path, while .lnk and PowerShell conditions lack context, increasing false positive risk.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Accurate use of standard Sigma field names (Image, CommandLine, ParentImage)",
              "Correctly identifies Base64-encoded PowerShell via regex"
            ],
            "weaknesses": [
              "selection_lnk_execution uses 'Image|endswith: .lnk' \u2014 invalid syntax and logic; should be CommandLine or TargetFilename",
              "Parent process filter only applies to registry modification, not other paths"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity in critical areas: '.lnk' in Image field is incorrect and will miss or misfire; no filtering on user context or command-line patterns to exclude administrative scripts. While parent process filtering helps, it's not applied consistently across all detection paths.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Includes parent process constraints for registry modification",
              "Lists realistic false positives"
            ],
            "weaknesses": [
              "Overly broad .lnk detection logic (syntactically flawed)",
              "No exclusion of known benign tools or paths (e.g., SCCM, Intune)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple vectors (registry, shortcuts, encoded PowerShell) and using regex to catch variable-length Base64 payloads. It accounts for different execution methods (cmd, wscript, etc.) via parent process, increasing coverage across attack variations.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Covers multiple persistence mechanisms in one rule",
              "Regex for Base64 detection handles variable encoding lengths"
            ],
            "weaknesses": [
              "No case-insensitive flag in regex (could miss obfuscated commands)",
              "Does not account for PowerShell Core (pwsh.exe) or alternate encodings"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1547.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The technique name and tactic are partially accurate, though 'attack.persistence' is not a valid MITRE ID.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Includes correct MITRE technique tag (T1547.001)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing MITRE ATT&CK reference link or CVE examples",
              "No attribution to threat actors or malware using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient operators like 'endswith' and 'contains' on indexed fields (Image, CommandLine) and avoids leading wildcards. However, the regex for Base64 detection could be optimized to reduce complexity and improve performance, especially with long command lines.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Uses 'endswith' for Image filtering (indexed field)",
              "Logsource is specific to Sysmon process creation"
            ],
            "weaknesses": [
              "Base64 regex may trigger expensive pattern matching",
              "No prioritization of most selective conditions first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule effectively covers multiple persistence vectors: Registry Run keys via reg/powershell, .lnk execution, and encoded PowerShell. It captures common attacker tools and techniques including Base64-encoded payloads used by frameworks like Cobalt Strike. However, it misses some sub-techniques like WMI or Scheduled Tasks that often accompany this behavior.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Covers three major persistence mechanisms in one rule",
              "Detects encoded PowerShell, a hallmark of post-exploitation tooling"
            ],
            "weaknesses": [
              "Does not cover alternate registry modification tools (e.g., wmic.exe)",
              "Lacks detection of persistence via other scripting engines (e.g., mshta, cscript)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks actual filtering logic to suppress them. No exclusions for trusted parent processes, system paths, or administrative contexts are implemented. Reliance on single-event triggers increases noise, especially for reg.exe and PowerShell -enc usage in automation.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Includes relevant false positive scenarios in metadata",
              "Uses parent process context in one condition branch"
            ],
            "weaknesses": [
              "No whitelisting of legitimate admin tools or paths",
              "No frequency or threshold-based logic to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs such as abuse of Registry Run keys, shortcut execution, and Base64-encoded PowerShell\u2014all commonly used by adversaries for persistence. It reflects known attack chains involving LOLBins and encoded command execution, though lacks specific references to APT groups or campaigns.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Covers multiple persistence techniques used in real attacks (T1547.001, T1204.002)",
              "Includes behavioral patterns like encoded PowerShell common in malware"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Does not account for timing or execution context (e.g., user vs. system context)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sysmon process creation fields and common tools, making it deployable in most Windows environments. However, the broad command-line contains logic for 'run', 'runonce', 'runas' may generate excessive false positives from administrative scripts, increasing alert fatigue.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon log source widely deployed in enterprises",
              "Detection logic is syntactically sound and executable"
            ],
            "weaknesses": [
              "High potential for false positives due to unscoped command-line keywords",
              "No thresholding or frequency-based logic to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the included fields (Image, CommandLine, ParentImage) allow for effective pivoting during investigation. False positive guidance helps analysts triage alerts from automation or admin tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Clear title and description aid analyst understanding",
              "Provides useful process lineage and command-line data for investigation"
            ],
            "weaknesses": [
              "Lacks inclusion of user context or image hash for better attribution",
              "No direct MITRE ATT&CK mapping in tags (e.g., T1547.001 missing)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects Base64-encoded PowerShell and common persistence mechanisms but is vulnerable to simple obfuscations like case variation, spacing, or alternative encodings. Reliance on exact string matches in command line and lack of behavioral correlation reduce resilience against sophisticated attackers using LOLBins creatively.",
          "confidence": 0.85,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Detects encoded PowerShell, a common evasion method itself",
              "Includes multiple detection paths (registry, lnk, PowerShell)"
            ],
            "weaknesses": [
              "Easily bypassed by obfuscating command-line arguments (e.g., 'rUn' or 'run ')",
              "No detection logic for alternative persistence vectors or indirect execution methods"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects initial execution via Registry Run Keys, .lnk execution, and encoded PowerShell, which covers early-stage persistence activity. It does not correlate across multiple stages like lateral movement or exfiltration, limiting its multi-stage visibility. While it combines several related selections, it lacks temporal or session-based correlation to link precursor and follow-on actions.",
          "confidence": 0.95,
          "timestamp": "2025-12-26T07:18:27.647807",
          "metadata": {
            "strengths": [
              "Covers multiple initial access and persistence mechanisms in one rule",
              "Includes detection of Base64-encoded PowerShell, a common obfuscation technique"
            ],
            "weaknesses": [
              "No correlation across time or processes to detect chained attack stages",
              "Lacks conditions for detecting follow-on behaviors like lateral movement or data exfiltration"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Persistence via Registry Run Keys and Shortcut Execution with Encoded PowerShell) scored 0.65/1.0 (Below Average). Best performance in realism (0.69). Needs improvement in detectability (0.54). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-26T07:18:27.647807",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Persistence via Registry Run Keys and Shortcut Execution with Encoded PowerShell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    }
  ]
}