{
  "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
  "timestamp": "2025-12-20T16:13:19.703387",
  "config": {
    "llm_judge": {
      "enabled": true,
      "api_key": "csk-r8teckw2m2h5rhcfx59m3hnje5x8cfr2vxpm4tr2x44ye5v5",
      "model": "llama-3.3-70b",
      "temperature": 0.1,
      "max_tokens": 4096,
      "timeout": 60,
      "persona": "expert cybersecurity researcher and red team operator with deep knowledge of MITRE ATT&CK framework and detection engineering",
      "detailed_feedback": true,
      "confidence_scores": true,
      "enable_comparison": true,
      "max_requests_per_minute": 60,
      "retry_attempts": 3,
      "retry_delay": 2
    },
    "attackgen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "high_quality_threshold": 0.85,
      "metrics": {
        "technical_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "attack_alignment": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "platform_compatibility": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "operational_realism": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "threat_actor_alignment": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "testing_safety": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "controlled_impact": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "detection_value": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "artifact_generation": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "completeness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "documentation_quality": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        }
      },
      "top_performers_count": 10,
      "bottom_performers_count": 5,
      "enable_comparative_analysis": true,
      "export_format": "json",
      "export_detailed_results": true,
      "export_statistics": true
    },
    "rulegen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "metrics": {
        "sigma_completeness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_logic_correctness": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "platform_syntax_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "field_mapping_accuracy": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_specificity": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_sensitivity": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "metadata_richness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "optimization_level": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "attack_coverage": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "false_positive_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "contextual_awareness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "operational_deployability": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "performance_efficiency": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "analyst_actionability": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "evasion_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "multi_stage_detection": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        }
      }
    },
    "general": {
      "max_concurrent_evaluations": 3,
      "batch_size": 5,
      "enable_caching": true,
      "cache_ttl": 3600,
      "log_level": "INFO",
      "log_file": "logs/benchmark.log",
      "log_format": "json",
      "output_directory": "data/benchmark_results",
      "create_timestamp_subdirs": true,
      "calculate_statistics": true,
      "generate_summary_report": true,
      "export_csv": true,
      "generate_plots": false,
      "plot_format": "png"
    },
    "comparison": {
      "enabled": true,
      "criteria": [
        "overall quality",
        "technical correctness",
        "operational realism",
        "testing safety"
      ],
      "significant_difference_threshold": 0.1
    },
    "regression": {
      "enabled": false,
      "baseline_file": "baselines/attackgen_baseline.json",
      "alert_on_degradation": true,
      "degradation_threshold": 0.05,
      "track_history": true,
      "history_file": "history/benchmark_history.json"
    },
    "alerting": {
      "enabled": false,
      "low_score_threshold": 0.5,
      "alert_channels": [
        "email",
        "slack"
      ],
      "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "from_address": "benchmark@example.com",
        "to_addresses": [
          "team@example.com"
        ]
      },
      "slack": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#siem-benchmarks"
      }
    },
    "advanced": {
      "ensemble_evaluation": {
        "enabled": false,
        "models": [
          "gemini-2.0-flash-lite"
        ],
        "aggregation_method": "weighted_average"
      },
      "ground_truth": {
        "enabled": false,
        "dataset_path": "datasets/ground_truth.json",
        "calculate_accuracy": true
      },
      "custom_metrics": {
        "enabled": false,
        "metrics_file": "config/custom_metrics.yaml"
      },
      "debug": {
        "enabled": false,
        "save_prompts": true,
        "save_responses": true,
        "verbose_logging": true
      }
    }
  },
  "statistics": {
    "total_evaluations": 27,
    "average_score": 0.425216049382716,
    "category_averages": {
      "correctness": 0.41703703703703704,
      "quality": 0.4516339869281047,
      "effectiveness": 0.4207407407407407,
      "realism": 0.5133744855967078,
      "detectability": 0.3037037037037036
    },
    "metric_averages": {
      "sigma_completeness": 0.3259259259259259,
      "detection_logic_correctness": 0.4777777777777778,
      "detection_specificity": 0.3777777777777779,
      "detection_sensitivity": 0.4555555555555555,
      "metadata_richness": 0.4296296296296298,
      "optimization_level": 0.6148148148148146,
      "attack_coverage": 0.4296296296296297,
      "false_positive_resistance": 0.37037037037037046,
      "contextual_awareness": 0.4703703703703703,
      "operational_deployability": 0.5092592592592593,
      "analyst_actionability": 0.5185185185185185,
      "evasion_resistance": 0.3185185185185185,
      "multi_stage_detection": 0.2851851851851851
    },
    "score_distribution": {
      "excellent (>=0.9)": 0,
      "good (0.8-0.9)": 0,
      "fair (0.7-0.8)": 0,
      "poor (0.6-0.7)": 1,
      "failing (<0.6)": 26
    }
  },
  "results": [
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.335,
      "category_scores": {
        "correctness": 0.38,
        "quality": 0.3764705882352941,
        "effectiveness": 0.26666666666666666,
        "realism": 0.4555555555555555,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks several mandatory Sigma fields such as id, status, description, references, author, and date. Only the core fields are present, making the rule incomplete for production use.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Includes essential detection fields (title, logsource, detection, falsepositives, level, tags).",
              "Provides MITRE ATT&CK tagging."
            ],
            "weaknesses": [
              "Missing required metadata (id, description, author, date, references).",
              "No versioning or status information for rule lifecycle."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic correctly looks for the strings \"grantpt\" and \"posix_openpt\" in command lines, which aligns with the technique, but it may not capture the actual system\u2011call usage and lacks contextual filters.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Simple, clear condition using OR to cover both indicators.",
              "Uses standard Sigma field names (CommandLine|contains)."
            ],
            "weaknesses": [
              "Relies on command\u2011line visibility of library calls that are often hidden.",
              "No additional context (parent process, user) to reduce noise."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is overly broad; many legitimate tools (screen, tmux, expect) invoke these calls, leading to high false\u2011positive rates. No exclusions or contextual constraints are provided.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Identifies a concrete indicator (specific function names).",
              "Lists plausible false\u2011positive sources in documentation."
            ],
            "weaknesses": [
              "No whitelist or process\u2011name exclusions for known benign utilities.",
              "Lacks additional qualifiers (e.g., user, parent process) to narrow scope."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "Covers two primary indicators, improving coverage, but will miss variants where the calls are invoked indirectly or obfuscated (e.g., via compiled binaries without visible command\u2011line arguments).",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Covers both grantpt and posix_openpt, increasing coverage.",
              "Simple string match works across different shells and scripts."
            ],
            "weaknesses": [
              "Fails to detect indirect or renamed invocations of the same system calls.",
              "No case\u2011insensitive or regex handling for potential variations."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule includes minimal metadata: generic MITRE tags that are inaccurate for the technique and no authoritative references, threat actor, or campaign information. The description is brief and does not provide detailed context.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Includes MITRE tag fields",
              "Provides a concise description of the detection"
            ],
            "weaknesses": [
              "Incorrect MITRE technique/sub\u2011technique identifiers",
              "Lacks references, threat actor, and tool context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses simple 'contains' filters without leading wildcards, which is efficient, but it relies solely on the CommandLine field that may not be indexed and omits more selective fields like process name or user.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses simple string matching",
              "Logical OR condition keeps query straightforward"
            ],
            "weaknesses": [
              "No use of indexed fields (e.g., Image, User) to narrow scope",
              "Lacks additional restrictive filters that could improve performance"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Only the two specific system calls (grantpt, posix_openpt) are covered, missing many other PTY creation methods and tools commonly used by adversaries (e.g., openpty, forkpty, screen, tmux, expect, Metasploit modules).",
          "confidence": 0.7,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Detects two concrete system\u2011call indicators",
              "Targets a technique relevant to defense evasion"
            ],
            "weaknesses": [
              "Does not include broader PTY creation techniques or related sub\u2011techniques",
              "Ignores common adversary tools that perform PTY setup"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lists potential false positives but provides no concrete exclusions, whitelisting, or contextual logic (parent\u2011child, user, path) to mitigate them, leading to a high likelihood of noise.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate uses in the false\u2011positive section",
              "Assigns a high severity level to encourage review"
            ],
            "weaknesses": [
              "No implemented filters or exclusions to reduce noise",
              "Missing contextual constraints (e.g., known admin users, trusted paths)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule references the ATT&CK technique but provides no specific threat\u2011actor, campaign, or operational details, making it a generic textbook example rather than a context\u2011rich detection.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Maps to a known ATT&CK defense\u2011evasion technique",
              "Includes relevant ATT&CK tags"
            ],
            "weaknesses": [
              "Lacks attribution to real\u2011world adversaries or campaigns",
              "No indication of typical parameters, timing, or target environments"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is correct and the logsource is realistic for Linux environments, but the rule is likely to generate many false positives and has not been validated in production.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Simple, syntactically valid rule that can be deployed quickly",
              "Uses a common log source (process_creation) available in most SIEMs"
            ],
            "weaknesses": [
              "High false\u2011positive potential from legitimate tools (screen, tmux, etc.)",
              "No evidence of testing or tuning for alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the title and description are clear, the alert provides minimal investigative data (only command\u2011line text) and no guidance on triage or remediation.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Includes ATT&CK tags for quick reference"
            ],
            "weaknesses": [
              "Limited contextual fields (no user, parent process, PID, etc.)",
              "No remediation steps or false\u2011positive handling advice"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection relies solely on the presence of specific strings in the command line, which can be easily avoided by using wrappers, compiled binaries, or alternative APIs.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Catches obvious usage of grantpt/posix_openpt in command lines",
              "Simple to understand and implement"
            ],
            "weaknesses": [
              "Easily bypassed by renaming binaries or invoking syscalls directly",
              "Does not incorporate multi\u2011vector or behavioral indicators"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only inspects a single process creation event for the presence of \"grantpt\" or \"posix_openpt\" and does not link this to later persistence, lateral movement, or impact activities. It lacks any correlation logic across multiple stages of an attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T15:58:17.481365",
          "metadata": {
            "strengths": [
              "Simple, low\u2011overhead detection of a specific system call usage",
              "Clear indicator that can be quickly deployed in Linux environments"
            ],
            "weaknesses": [
              "Detects only the initial execution, missing persistence or post\u2011compromise actions",
              "High potential for false positives from legitimate tools (screen, tmux, expect) without contextual enrichment"
            ]
          }
        }
      ],
      "summary": "Rule for attack.defense_evasion (Pseudo-Terminal Setup via grantpt or posix_openpt) scored 0.34/1.0 (Poor). Best performance in realism (0.46). Needs improvement in detectability (0.20). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T15:58:17.484416",
      "metadata": {
        "attack_id": "attack.defense_evasion",
        "technique_name": "Pseudo-Terminal Setup via grantpt or posix_openpt",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.2466666666666667,
      "category_scores": {
        "correctness": 0.14,
        "quality": 0.25882352941176473,
        "effectiveness": 0.2733333333333333,
        "realism": 0.34444444444444444,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule includes title, logsource, detection, falsepositives, level, and tags, but omits required fields such as id, status, description, references, author, and date, making it incomplete for production use.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Provides basic required sections (title, logsource, detection)",
              "Includes MITRE ATT&CK tag for the technique"
            ],
            "weaknesses": [
              "Missing mandatory Sigma metadata (id, description, author, date, references)",
              "No explicit status or versioning information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The detection relies on literal command\u2011line strings \"socket_recv\" and \"socket_send\", which are rarely present in real malware, and the exclusion condition is ineffective because it requires all four strings simultaneously.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Attempts to filter known benign tools via an exclusion block",
              "Uses a clear logical condition (AND NOT) structure"
            ],
            "weaknesses": [
              "Selection criteria do not reflect actual T1071.004 behavior",
              "Exclusion logic is overly strict and unlikely to fire, reducing usefulness"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is overly broad, matching any process whose command line contains the two strings, without additional context such as parent process, user, or network endpoint, leading to potential false positives.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Attempts to limit noise by adding an exclusion list",
              "Targets a specific technique tag"
            ],
            "weaknesses": [
              "Lacks contextual filters (parent process, user, IP/port) to narrow scope",
              "Relies on generic string matches that can appear in benign scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "Sensitivity is poor because only exact literal strings trigger the rule; attackers can easily rename functions, use compiled binaries, or employ other APIs, causing the rule to miss most real\u2011world variants.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Covers both send and receive indicators in a single rule",
              "Uses case\u2011insensitive \"contains\" which catches simple variations"
            ],
            "weaknesses": [
              "No wildcard or regex to capture alternative socket\u2011related commands",
              "Fails to account for encoded or obfuscated command lines"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic metadata such as title, description, MITRE tag and false\u2011positive guidance, but lacks authoritative references, explicit tactic/sub\u2011technique fields, threat\u2011actor or campaign context, and associated tool/malware information.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag for the technique",
              "Provides a concise description and false\u2011positive notes"
            ],
            "weaknesses": [
              "Missing references to MITRE or other sources",
              "No threat\u2011actor, campaign, or tool attribution"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection uses simple `contains` operators without leading wildcards or complex regex, which is good for performance, but it does not filter on indexed fields like EventID or Image, leading to unnecessary scanning of all Sysmon process events.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and complex regex",
              "Uses straightforward `contains` logic"
            ],
            "weaknesses": [
              "No EventID or Image filter to leverage indexing",
              "Lacks additional restrictive criteria (e.g., path, user) to limit scope"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only matches literal strings `socket_recv` and `socket_send` in command lines, which covers a very narrow slice of the T1071.004 technique and misses most real\u2011world implementations (e.g., generic `recv`, PowerShell web requests, Cobalt Strike beacons).",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Targets a specific indicator of socket activity"
            ],
            "weaknesses": [
              "Fails to cover common variants and sub\u2011techniques",
              "Does not consider other tools/frameworks that use sockets"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes a single exclusion list that is too generic; it lacks contextual filters such as parent\u2011child relationships, user or path whitelisting, and frequency\u2011based logic, resulting in a high likelihood of benign matches.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Provides an exclusion clause for known benign scripts"
            ],
            "weaknesses": [
              "No parent\u2011child or process\u2011context checks",
              "No time\u2011based or frequency thresholds to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only looks for literal strings \"socket_recv\" and \"socket_send\" in command lines, which is not how most real\u2011world malware performs C2. It provides no reference to specific threat actors, campaigns, or realistic usage patterns.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Attempts to focus on socket\u2011related activity",
              "Includes an exclusion for known benign tools"
            ],
            "weaknesses": [
              "No linkage to actual adversary TTPs or campaigns",
              "Relies on unlikely command\u2011line artifacts"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While Sysmon process_creation is a common log source, the Sigma rule contains a truncated condition (\"selection_socket_ops and not exclusion_known\") and thus will not parse. The detection is also overly generic, likely producing many false positives.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Uses a widely deployed log source (Sysmon)",
              "Provides a false\u2011positive description"
            ],
            "weaknesses": [
              "Syntax error/incomplete condition prevents deployment",
              "High expected false\u2011positive rate due to vague indicator"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title and description are clear, but the rule only surfaces the command line text, offering no process ID, parent\u2011process, user, or network context needed for rapid investigation.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Clear, concise title",
              "Description mentions suspicious parent\u2011child relationships"
            ],
            "weaknesses": [
              "Lacks actionable fields (PID, user, IP, hash) for triage",
              "No guidance on next\u2011step investigation or remediation"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "Detection depends solely on visible command\u2011line strings, which attackers can easily rename, encode, or move to compiled binaries, making the rule trivially evadable.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Excludes known benign tools to reduce noise"
            ],
            "weaknesses": [
              "Single\u2011indicator approach; easy to bypass by renaming or hiding arguments",
              "No coverage of LOLBin or multi\u2011vector behavior"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only inspects a single process creation event for specific command\u2011line strings, without linking to later persistence, lateral movement, or exfiltration activities. It lacks any correlation logic across multiple stages of the attack lifecycle.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:58:51.445860",
          "metadata": {
            "strengths": [
              "Simple, low\u2011overhead detection of suspicious socket\u2011related command lines",
              "Includes an exclusion clause to reduce obvious false positives"
            ],
            "weaknesses": [
              "Detects only one stage (initial execution) and ignores persistence or lateral movement",
              "Relies on literal string matches that may be absent in real malware, limiting coverage"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1071.004 (Malicious Network Communication via Suspicious Socket Activity) scored 0.25/1.0 (Poor). Best performance in realism (0.34). Needs improvement in correctness (0.14). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T15:58:51.445860",
      "metadata": {
        "attack_id": "attack.t1071.004",
        "technique_name": "Malicious Network Communication via Suspicious Socket Activity",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4266666666666667,
      "category_scores": {
        "correctness": 0.48,
        "quality": 0.5588235294117647,
        "effectiveness": 0.36000000000000004,
        "realism": 0.4555555555555555,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes some mandatory fields (title, logsource, detection, falsepositives, level, tags) but omits several required Sigma metadata such as id, description, author, date, references, and status. Content that exists is minimal and not detailed.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Core detection sections (logsource, detection, level) are present",
              "Tags include ATT&CK identifiers"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, description, author, date, references, status)",
              "Existing fields lack substantive information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly ties the presence of /bin/sh with a suspicious path, which aligns with the described technique. However, the condition is overly simplistic and does not incorporate additional context (e.g., parent process) that would improve reliability.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Clear AND condition directly reflects the intended indicator",
              "Uses standard Sigma field names (Image, CommandLine)"
            ],
            "weaknesses": [
              "No additional filters (parent process, user) to reduce noise",
              "Relies on a single static string, limiting coverage of variant attacks"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule is highly specific, targeting a unique path combined with /bin/sh, which should keep false positives low. Yet, it lacks broader context that could further tighten precision, such as excluding known benign scripts.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Exact string match on a rare malicious directory",
              "Combines two indicators, reducing accidental matches"
            ],
            "weaknesses": [
              "No exclusion of known benign parent processes or users",
              "May still fire on legitimate admin scripts that reference the same path"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Sensitivity is limited; only one exact path is monitored, so variants (different directories, encoded commands, renamed binaries) will evade detection. No use of wildcards, regex, or case\u2011insensitive matching to capture broader activity.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Detects the exact known malicious indicator when present",
              "Low chance of missing that specific instance"
            ],
            "weaknesses": [
              "Fails to detect alternative malicious paths or obfuscated command lines",
              "No coverage for other shells or execution methods that achieve the same technique"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides basic MITRE tags and a brief description, but lacks sub\u2011technique IDs, authoritative references, threat\u2011actor or campaign context, and associated malware details.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "Clear short description of detection intent"
            ],
            "weaknesses": [
              "Missing sub\u2011technique identifier (e.g., T1059.001)",
              "No external references or threat\u2011actor information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection uses simple, indexed\u2011friendly operators (endswith, contains) without leading wildcards and keeps the logic flat, which is efficient for most SIEMs.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and complex regex",
              "Uses concise field filters (Image, CommandLine)"
            ],
            "weaknesses": [
              "Does not explicitly prioritize highly indexed fields like EventID",
              "Lacks additional narrowing filters such as parent\u2011process checks"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "Coverage is extremely narrow, targeting only /bin/sh executions that reference a single hard\u2011coded malicious path, missing the broader spectrum of T1059 variants and common tooling.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Directly maps to the Command and Scripting Interpreter technique",
              "Detects a known malicious artifact (SpectralBlur/.macshare)"
            ],
            "weaknesses": [
              "No coverage of other shells, sub\u2011techniques, or common frameworks (e.g., PowerShell, Python)",
              "Fails to detect generic or obfuscated command\u2011line abuse"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The specific path filter greatly reduces noise, but the rule lacks broader exclusion logic (parent process, user, frequency) that would further harden it against legitimate use cases.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Highly specific path reduces incidental alerts",
              "Marked as high severity to prioritize investigation"
            ],
            "weaknesses": [
              "No parent\u2011process or user whitelisting",
              "No temporal or frequency\u2011based correlation to filter benign runs"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule targets a very specific path (SpectralBlur/.macshare) and the /bin/sh binary, but provides no concrete linkage to known threat actors, campaigns, or typical attacker behavior beyond generic shell usage.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "References a concrete malicious directory that could be tied to a specific malware family",
              "Focuses on a legitimate LOLBin (/bin/sh) commonly abused in attacks"
            ],
            "weaknesses": [
              "Lacks attribution to any real-world campaign or APT group",
              "Does not capture broader tactics, techniques, or procedures used in shell\u2011based execution"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is correct and the logsource (process_creation on Linux) is widely available, but the detection is overly narrow, which may limit its usefulness in production without further tuning.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Valid Sigma syntax with clear fields (Image|endswith, CommandLine|contains)",
              "Uses a high severity level to surface alerts promptly"
            ],
            "weaknesses": [
              "Very specific path condition may result in missed detections in real environments",
              "No evidence of prior testing or tuning to assess false\u2011positive rates"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title and description are concise, yet the alert provides limited investigative data (only image and command line) and no guidance on next steps or enrichment fields for deeper analysis.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Clear title describing the malicious shell execution",
              "Description mentions exclusion of benign parent processes to aid triage"
            ],
            "weaknesses": [
              "Missing key context such as user, PID, parent process, or host identifiers",
              "No remediation or investigation playbook references included"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule can be easily evaded by renaming the malicious directory, using a different shell, or obfuscating the command line; it relies solely on static string matching.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Detects a known LOLBin which is a common attack vector",
              "Combines two conditions, reducing some trivial false positives"
            ],
            "weaknesses": [
              "Purely signature\u2011based; does not consider behavioral patterns or multiple data sources",
              "Vulnerable to simple evasion techniques such as path aliasing or command\u2011line encoding"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only matches a single event (process creation of /bin/sh with a specific malicious path) and does not address persistence, lateral movement, or post\u2011execution activities. It lacks any correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:25.001906",
          "metadata": {
            "strengths": [
              "Highly specific condition reduces false positives",
              "Targets a known malicious directory indicator"
            ],
            "weaknesses": [
              "Detects only the initial execution stage",
              "Overly narrow path signature may miss variants",
              "No correlation or multi\u2011event logic for later stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Malicious Shell Execution via Command and Scripting Interpreter) scored 0.43/1.0 (Poor). Best performance in quality (0.56). Needs improvement in detectability (0.20). Issues found in: sigma_completeness, detection_sensitivity, metadata_richness",
      "timestamp": "2025-12-20T15:59:25.001906",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Malicious Shell Execution via Command and Scripting Interpreter",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4033333333333333,
      "category_scores": {
        "correctness": 0.43999999999999995,
        "quality": 0.48235294117647054,
        "effectiveness": 0.35333333333333333,
        "realism": 0.4444444444444444,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks several mandatory Sigma fields such as id, status, description, references, author, and date. Existing fields are present but many are empty or placeholder values, reducing overall completeness.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Core fields like title, logsource, detection, falsepositives, and level are present",
              "MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing required metadata (id, status, description, references, author, date)",
              "No explicit versioning or documentation fields"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly ties permission\u2011changing binaries (chmod/chown) to suspicious target paths, matching the intended TTP. However, the use of generic flag matches and lack of context (e.g., parent process) may cause both missed detections and false alerts.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Uses appropriate Sigma fields (Image, CommandLine, TargetFilename)",
              "Combines path and behavior selections with an AND condition"
            ],
            "weaknesses": [
              "Flag matching is overly broad (e.g., any \"777\"), leading to potential noise",
              "No exclusion of legitimate admin processes or user context"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule targets a specific malicious file location, the permission\u2011change criteria are generic and will fire on many legitimate administrative actions, reducing precision. No additional filters (e.g., user, parent process) are provided to narrow scope.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Targets a known malicious share path (/Users/Shared/.macshare, macshare.d)",
              "Limits detection to known permission\u2011changing binaries"
            ],
            "weaknesses": [
              "Broad flag matching creates high false\u2011positive risk",
              "Lacks contextual exclusions (e.g., root user, known management tools)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several variants of chmod/chown usage and includes backup binaries, improving coverage of simple evasion attempts. Nevertheless, it is confined to a single file path and does not account for alternative malicious locations or renamed tools, limiting overall sensitivity.",
          "confidence": 0.87,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Covers both chmod and chown, including .bak variants",
              "Detects recursive and permissive flag patterns"
            ],
            "weaknesses": [
              "Restricts detection to a fixed set of target filenames",
              "Does not handle renamed or custom permission\u2011modifying utilities"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic tags and a short description, but lacks detailed MITRE sub\u2011technique identifiers, authoritative references, threat actor or campaign context, and associated malware/tool information.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique tag (attack.T1222)",
              "Provides a concise description of the detection goal"
            ],
            "weaknesses": [
              "Missing sub\u2011technique ID and deeper ATT&CK mapping",
              "No external references, threat actor, or malware family details"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule avoids leading wildcards and uses indexed fields (Image, CommandLine). The detection logic is simple, but using 'contains' on file paths may be less efficient than more specific operators.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "No leading wildcards; uses endswith for binaries",
              "Simple AND condition keeps query lightweight"
            ],
            "weaknesses": [
              "TargetFilename uses 'contains' which can be less selective",
              "Could prioritize more restrictive filters first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only watches chmod/chown on two specific filenames, missing many other legitimate ways attackers modify permissions (e.g., via sudo, launchd, custom scripts, other tools). Coverage of variants and platforms is narrow.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Detects classic chmod/chown usage",
              "Targets a known malicious share location"
            ],
            "weaknesses": [
              "Limited to specific file names, ignoring broader permission changes",
              "Does not account for other tools or sub\u2011techniques"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While false positive scenarios are listed, the rule lacks concrete exclusions (e.g., trusted admin scripts, system accounts) and does not employ temporal or frequency thresholds to filter benign activity.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Provides a brief false\u2011positive guidance section",
              "Acknowledges legitimate admin tools"
            ],
            "weaknesses": [
              "No explicit whitelist or process\u2011parent filters",
              "Absence of time\u2011based or count\u2011based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets a known macOS malware artifact (.macshare) and uses typical LOLBin tools (chmod/chown), showing some alignment with real\u2011world TTPs. However, it lacks explicit references to campaigns, threat actors, or broader context beyond the file names.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Focuses on a concrete malicious file path observed in the wild",
              "Uses realistic privilege\u2011escalation binaries (chmod, chown)"
            ],
            "weaknesses": [
              "No citation of specific threat groups or campaigns",
              "Limited to static indicators; does not capture broader attack chain stages"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma syntax is mostly correct, but the logsource (file_event) may not capture the required process creation data, and the rule could generate many false positives from legitimate admin scripts. It has not been validated in production.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Clear field definitions and no obvious syntax errors",
              "Severity level set to high, matching the risk"
            ],
            "weaknesses": [
              "Potentially high false\u2011positive rate from normal chmod/chown usage",
              "Logsource may be unavailable or incomplete in many SIEM deployments"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description convey the core intent, and the rule surfaces the affected file path and the invoked binary. However, it lacks additional context such as user, PID, or host information that would aid rapid triage.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Descriptive title and concise description",
              "Provides the malicious file path and the privileged command used"
            ],
            "weaknesses": [
              "Missing enrichment fields (e.g., user, process ID, hostname)",
              "Limited guidance on remediation steps or investigation playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection hinges on specific executable names and command\u2011line flags, which attackers can easily evade by renaming binaries, using alternative tools, or encoding arguments. It does not incorporate multi\u2011vector correlation or behavioral baselines.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Combines file path and command\u2011line criteria for a tighter match",
              "Covers both chmod and chown variants"
            ],
            "weaknesses": [
              "Easily bypassed by using alternative privilege\u2011escalation methods",
              "Relies heavily on static command\u2011line strings, which can be obfuscated"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only triggers on a single file\u2011permission change event for very specific paths and does not cover earlier execution, persistence setup, lateral movement, or impact phases. It lacks any correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T15:59:58.694648",
          "metadata": {
            "strengths": [
              "Combines file\u2011path and chmod/chown behavior to reduce noise",
              "Targets known malicious artifacts (.macshare, macshare.d) for focused detection"
            ],
            "weaknesses": [
              "Detects only one stage (permission modification) and misses other phases",
              "Very narrow scope; does not correlate multiple events or broader privilege\u2011escalation activity"
            ]
          }
        }
      ],
      "summary": "Rule for attack.privilege_escalation (File and Directory Permissions Modification via Malicious File Access) scored 0.40/1.0 (Poor). Best performance in quality (0.48). Needs improvement in detectability (0.26). Issues found in: sigma_completeness, detection_specificity, detection_sensitivity",
      "timestamp": "2025-12-20T15:59:58.694648",
      "metadata": {
        "attack_id": "attack.privilege_escalation",
        "technique_name": "File and Directory Permissions Modification via Malicious File Access",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.28500000000000003,
      "category_scores": {
        "correctness": 0.25999999999999995,
        "quality": 0.29411764705882354,
        "effectiveness": 0.23999999999999996,
        "realism": 0.4555555555555555,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks several mandatory Sigma fields such as id, status, description, references, author, and date, leaving the metadata incomplete and unsuitable for production deployment.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Core detection fields (title, logsource, detection, falsepositives, level) are present",
              "MITRE ATT&CK tags are included"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, description, references, author, date)",
              "Fields are not populated with meaningful content"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The logic simply looks for the strings \"xcrypt\" or \"custom stream cipher\" in command lines, which may catch the intended malicious activity but also many benign tools, and it lacks any contextual filtering.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Simple OR condition is easy to understand",
              "Targets observable command\u2011line artifacts"
            ],
            "weaknesses": [
              "Overly broad string matching leads to many false positives",
              "No additional context (parent process, user, path) to validate malicious intent"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is too generic; any process that includes the word \"xcrypt\" will trigger, making it unsuitable for high\u2011volume environments without further refinement.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Uses explicit keyword matching rather than wildcards",
              "Provides a false\u2011positive list for known legitimate uses"
            ],
            "weaknesses": [
              "Lacks exclusion filters for known legitimate tools",
              "Does not incorporate additional attributes (e.g., process name, user) to narrow scope"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule captures two possible indicators, it does not account for variations such as case differences, obfuscation, or alternative encryption utilities, limiting its ability to detect evasive implementations.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Covers two distinct indicators of the technique",
              "Detects presence of encryption\u2011related terminology in command lines"
            ],
            "weaknesses": [
              "Case\u2011sensitive matching may miss variants",
              "No regex or wildcard handling for renamed or encoded arguments"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains only basic tags and a short description; it lacks proper MITRE ATT&CK tactic/sub\u2011technique identifiers, authoritative references, threat\u2011actor or campaign context, and associated tool information.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Includes a description of what is being detected",
              "Provides a list of false\u2011positive scenarios"
            ],
            "weaknesses": [
              "Incorrect or overly generic ATT&CK tags (uses T1560 which does not map to data encryption)",
              "Missing references, threat\u2011actor, campaign, and tool metadata"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection uses simple 'contains' checks on CommandLine, which avoids leading wildcards, but it does not filter on indexed fields such as EventID or Image, leading to unnecessary scanning of all process creation events.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421592",
          "metadata": {
            "strengths": [
              "Simple, low\u2011complexity condition (OR of two contains statements)",
              "Logsource is correctly scoped to Sysmon process_creation"
            ],
            "weaknesses": [
              "No EventID or Image filter to leverage indexing",
              "Relies solely on CommandLine which can be noisy and impact performance"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only looks for the literal strings \"xcrypt\" or \"custom stream cipher\" and does not address other encryption utilities, sub\u2011techniques, or common adversary frameworks that may perform data encryption.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Targets a specific indicator that could be associated with a known malicious function",
              "Covers two possible string variants"
            ],
            "weaknesses": [
              "Fails to include broader technique coverage (e.g., other encryption tools, T1022/T1041 variants)",
              "No consideration of multi\u2011stage or indirect encryption activity"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "While the rule lists generic false\u2011positive sources, it provides no concrete exclusions, whitelists, parent\u2011process context, or frequency logic to limit alerts from legitimate use of the strings.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate software that may use the same strings",
              "Specifies a high severity level to draw attention"
            ],
            "weaknesses": [
              "Lacks explicit exclusion filters (e.g., known good paths, signed binaries)",
              "No contextual enrichment (parent process, user, time\u2011based thresholds) to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only looks for generic strings \"xcrypt\" or \"custom stream cipher\" and does not reference any specific threat actor, campaign, or observed usage patterns, limiting its relevance to real\u2011world incidents.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Uses MITRE ATT&CK tag for technique T1560",
              "Attempts to capture a known encryption function name"
            ],
            "weaknesses": [
              "No linkage to actual threat intel or observed malware families",
              "Lacks contextual details such as typical command\u2011line arguments or victim profiles"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is correct and targets Sysmon process creation, which is commonly available, but the rule is overly broad and likely to generate many false positives, and there is no evidence of testing or tuning.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Valid Sigma structure with proper logsource definition",
              "Applicable to standard Windows Sysmon deployments"
            ],
            "weaknesses": [
              "High false\u2011positive potential due to generic string match",
              "No validation or tuning data provided"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The alert title and description are clear, yet the rule only surfaces the command line string without additional context (user, parent process, hashes), limiting the analyst\u2019s ability to triage and investigate efficiently.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Includes MITRE tags to guide investigation"
            ],
            "weaknesses": [
              "Provides minimal enrichment fields for further pivoting",
              "Sparse guidance on remediation or next\u2011step actions"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "Reliance on exact command\u2011line substrings makes the rule easy to evade by renaming the tool, using encoded arguments, or employing alternative encryption utilities; no multi\u2011vector or behavioral checks are present.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Detects explicit usage of the named function when present",
              "Simple rule that can catch obvious cases"
            ],
            "weaknesses": [
              "Easily bypassed by simple obfuscation or argument changes",
              "Does not incorporate additional indicators (file writes, network traffic) to strengthen detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only inspects a single process creation event for specific strings in the command line, covering the execution phase. It does not address persistence, lateral movement, data collection, or exfiltration, nor does it correlate multiple events.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:00:32.421954",
          "metadata": {
            "strengths": [
              "Simple, low\u2011overhead detection of suspicious command\u2011line usage",
              "Targets a concrete indicator (\"xcrypt\") that may be rare in legitimate activity"
            ],
            "weaknesses": [
              "Limited to a single-stage (execution) detection",
              "No coverage of persistence, lateral movement, or exfiltration phases",
              "Lacks event correlation to build a broader attack narrative"
            ]
          }
        }
      ],
      "summary": "Rule for attack.exfiltration (Malware Using xcrypt Function for Data Encryption) scored 0.29/1.0 (Poor). Best performance in realism (0.46). Needs improvement in detectability (0.20). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:00:32.421954",
      "metadata": {
        "attack_id": "attack.exfiltration",
        "technique_name": "Malware Using xcrypt Function for Data Encryption",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.39666666666666667,
      "category_scores": {
        "correctness": 0.25999999999999995,
        "quality": 0.3,
        "effectiveness": 0.3466666666666666,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule includes only a subset of required Sigma fields (title, logsource, detection, falsepositives, level, tags). Critical metadata such as id, status, description, references, author, and date are missing, making the rule incomplete for production use.",
          "confidence": 0.93,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Provides basic detection fields (title, logsource, detection, level).",
              "Includes MITRE ATT&CK tags for technique mapping."
            ],
            "weaknesses": [
              "Missing mandatory Sigma metadata (id, description, author, date, references).",
              "No versioning or status information to track rule lifecycle."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The logic looks for the literal strings \"fork\" and \"posix_openpt\" in the command line, which does not reliably represent the underlying system\u2011call behavior of process hollowing and will miss many real\u2011world implementations.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Simple AND condition is easy to understand.",
              "Targets two relevant indicators (fork and pseudo\u2011terminal allocation)."
            ],
            "weaknesses": [
              "Command\u2011line containment is an inaccurate proxy for system\u2011call activity.",
              "No contextual filters (parent process, user, executable) to reduce noise."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is overly broad; many legitimate tools (debuggers, IDEs, ssh, screen) invoke fork and posix_openpt, leading to high false\u2011positive rates without additional constraints.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Attempts to narrow focus by requiring both indicators.",
              "Lists plausible false\u2011positive scenarios in documentation."
            ],
            "weaknesses": [
              "Lacks exclusion criteria (e.g., known benign binaries, user IDs).",
              "No use of exact matches, regex, or process hierarchy to improve precision."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While the rule captures a specific combination of indicators, it fails to account for variations such as different command\u2011line arguments, indirect invocation of posix_openpt, or alternative techniques for process hollowing, reducing its ability to detect evasive attacks.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Covers two core actions associated with the technique.",
              "Uses case\u2011insensitive containment which catches simple variations."
            ],
            "weaknesses": [
              "No wildcard or regex to handle different spellings or paths.",
              "Does not consider other system\u2011call sequences (e.g., execve after fork)."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes basic MITRE tags and a short description, but lacks authoritative references, threat actor or campaign context, and detailed tool/malware associations.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Correct MITRE technique and sub\u2011technique tags",
              "Provides a concise description of the detection intent"
            ],
            "weaknesses": [
              "No external references (MITRE URL, vendor blogs, CVEs)",
              "Missing threat actor, campaign, and tool information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection uses simple 'contains' operators without leading wildcards, which is efficient, but it does not prioritize indexed fields or apply more restrictive filters first, potentially increasing query load.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses straightforward string matching",
              "Logsource is correctly scoped to Linux process creation"
            ],
            "weaknesses": [
              "Relies solely on CommandLine which may not be indexed in all SIEMs",
              "No ordering of filters or additional narrowing criteria"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only captures a narrow slice of process hollowing (fork + posix_openpt) and does not address other common implementations, sub\u2011techniques, or tool\u2011specific behaviors.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Targets a specific, observable technique combination",
              "Maps to the correct ATT&CK sub\u2011technique (T1055.012)"
            ],
            "weaknesses": [
              "Does not cover alternative process\u2011hollowing methods (e.g., ptrace, /proc/self/mem)",
              "Lacks coverage of known malicious frameworks (Cobalt Strike, Metasploit, etc.)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "While the rule lists potential false\u2011positive sources, it provides no concrete exclusions, parent\u2011child relationship checks, or frequency logic to mitigate noisy alerts.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate use cases in the false\u2011positive section",
              "Assigns a high severity level to encourage investigation"
            ],
            "weaknesses": [
              "No explicit whitelisting or process\u2011parent filters",
              "Lacks temporal or count\u2011based conditions to reduce spurious matches"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule demonstrates awareness of Process Hollowing via fork and posix_openpt, but lacks specific references to campaigns, APT groups, or operations. It aligns with general threat actor TTPs, but could be improved with more operational intelligence. The detection logic is straightforward and considers basic threat actor preferences.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Aligns with general threat actor TTPs",
              "Considers basic threat actor preferences"
            ],
            "weaknesses": [
              "Lacks specific references to campaigns or APT groups",
              "Limited operational intelligence"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is well-structured and free of syntax errors, with a realistic log source and tested detection logic. The severity level is appropriate, and the false positive rate is acceptable. However, the rule could be improved with more validation and testing in various environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Well-structured and free of syntax errors",
              "Realistic log source"
            ],
            "weaknesses": [
              "Limited validation and testing",
              "Potential for excessive alerts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule provides clear and concise information, with a useful title and description. The fields in detection are somewhat useful for pivoting and investigation, but could be improved with more context and references. The severity level helps analysts prioritize their response, but false positive guidance is limited.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Clear and concise title and description",
              "Useful fields in detection"
            ],
            "weaknesses": [
              "Limited context and references",
              "Insufficient false positive guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to common attacker evasion techniques, such as renaming executables or files, and relies heavily on command-line arguments. It detects behavior patterns, but could be improved with more robust detection points and consideration of obfuscation attempts.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Detects behavior patterns",
              "Considers basic threat actor TTPs"
            ],
            "weaknesses": [
              "Vulnerable to evasion techniques",
              "Relies heavily on command-line arguments"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects Process Hollowing via fork and posix_openpt by identifying the presence of 'fork' and 'posix_openpt' in the command line, which indicates initial execution. However, it lacks detection capabilities for persistence, lateral movement, data collection, and exfiltration stages. The rule's logic is limited to single-event detection.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:08.073327",
          "metadata": {
            "strengths": [
              "Detects initial execution",
              "Specific to Linux environment"
            ],
            "weaknesses": [
              "Lacks multi-stage detection",
              "No correlation across events"
            ]
          }
        }
      ],
      "summary": "Rule for attack.defense_evasion (Process Hollowing via fork and posix_openpt) scored 0.40/1.0 (Poor). Best performance in realism (0.76). Needs improvement in correctness (0.26). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:01:08.073327",
      "metadata": {
        "attack_id": "attack.defense_evasion",
        "technique_name": "Process Hollowing via fork and posix_openpt",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6616666666666667,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.6882352941176471,
        "effectiveness": 0.5666666666666667,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields populated, but some fields like 'id', 'status', 'author', and 'date' are missing. The provided fields are meaningful and well-populated.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Well-populated fields",
              "Meaningful content"
            ],
            "weaknesses": [
              "Missing required fields",
              "Incomplete metadata"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic correctly identifies the attack technique by combining selection criteria for 'proc_testconn' and specific tools like 'wmic', 'schtasks', and 'bitsadmin'. The condition logic is sound and not overly complex.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited consideration of evasion techniques"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses exact matches and includes filters to exclude benign activity, but may still catch legitimate system administration scripts. The rule could be more specific by considering additional context like parent process or user.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Exact matches used",
              "Filters for benign activity"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited context consideration"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers a specific indicator of the attack technique, but may not catch variations or evasion attempts. The rule could be more sensitive by using wildcards or regex to catch encoded commands or different paths.",
          "confidence": 0.6,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Covers specific indicator",
              "Easy to implement"
            ],
            "weaknesses": [
              "Limited coverage of variations",
              "Vulnerable to evasion techniques"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Comprehensive MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lack of threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses specific filters and avoids leading wildcards, but the use of 'contains' operators may lead to slower query execution. The logsource is specific enough, but the detection logic could be optimized further.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Specific filters",
              "Avoids leading wildcards"
            ],
            "weaknesses": [
              "Potential slow query execution",
              "Room for optimization"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers the main attack vector, but may not detect advanced or sophisticated variants. It considers different tools, but not multi-stage attacks or custom tools.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Covers main attack vector",
              "Considers different tools"
            ],
            "weaknesses": [
              "May not detect advanced variants",
              "Limited consideration of multi-stage attacks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes some filters, but may not effectively exclude legitimate processes or users. The false positive guidance in metadata is limited.",
          "confidence": 0.6,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Some filters included",
              "Acknowledges potential false positives"
            ],
            "weaknesses": [
              "May not effectively exclude legitimate processes",
              "Limited false positive guidance"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule demonstrates some awareness of threat actor TTPs by targeting the 'proc_testconn' function, but lacks specific campaign context and references to APT groups or operations. The detection logic aligns with common malware techniques, but may not fully capture the complexity of real-world attacks. The rule's metadata does not provide sufficient information about specific campaigns or threat actors.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Targets specific malware technique",
              "Aligns with common malware TTPs"
            ],
            "weaknesses": [
              "Lacks specific campaign context",
              "Limited references to APT groups or operations"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is well-structured and free of syntax errors, with a realistic log source and tested detection logic. The severity level is appropriate for SOC triage and prioritization, and the false positive rate is acceptable for production. However, the rule may benefit from additional testing and validation to minimize alert fatigue.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Well-structured and free of syntax errors",
              "Realistic log source"
            ],
            "weaknesses": [
              "Limited testing and validation",
              "Potential for alert fatigue"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule provides some actionable information for security analysts, including a clear title and description, and useful fields for pivoting and investigation. However, the rule could benefit from additional context and guidance for next steps in investigation and remediation, as well as more detailed false positive guidance.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Clear title and description",
              "Useful fields for pivoting and investigation"
            ],
            "weaknesses": [
              "Limited context and guidance for next steps",
              "Insufficient false positive guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to common attacker evasion techniques, such as renaming executables or files, and relies heavily on command-line arguments that can be hidden or obfuscated. The rule does not detect behavior patterns and relationships, and does not consider obfuscation attempts or living-off-the-land (LOLBin) evasions.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Detects specific malware technique"
            ],
            "weaknesses": [
              "Vulnerable to evasion techniques",
              "Relies on command-line arguments"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects the initial execution of the 'proc_testconn' function and its combination with tools like 'wmic', 'schtasks', or 'bitsadmin', but it does not explicitly cover persistence mechanisms, lateral movement, data collection, or impact activities. The detection logic is primarily focused on a single event. However, it does correlate the use of 'proc_testconn' with specific tools, indicating some level of multi-stage awareness.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:01:41.983293",
          "metadata": {
            "strengths": [
              "Detects initial execution of 'proc_testconn' function",
              "Correlates with specific tools"
            ],
            "weaknesses": [
              "Limited to single-event detection",
              "Does not cover persistence or lateral movement"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1053 (Malware Create or Modify System Process via proc_testconn Function) scored 0.66/1.0 (Below Average). Best performance in correctness (0.86). Needs improvement in detectability (0.46). Issues found in: false_positive_resistance, evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-20T16:01:41.983293",
      "metadata": {
        "attack_id": "attack.t1053",
        "technique_name": "Malware Create or Modify System Process via proc_testconn Function",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5516666666666666,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.6764705882352942,
        "effectiveness": 0.39333333333333337,
        "realism": 0.48888888888888893,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields, but some fields like 'id', 'status', 'author', and 'date' are missing. The provided fields are properly populated with meaningful content.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Properly populated fields",
              "Includes MITRE ATT&CK tags"
            ],
            "weaknesses": [
              "Missing required fields",
              "Lack of author and date information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic correctly identifies process creation with suspicious system calls and command-line tools. The selection criteria and condition logic are sound and not overly complex.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited consideration of evasion techniques"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses exact matches and includes filters to exclude benign activity, but may still catch legitimate system administration scripts. The condition logic is not overly broad, but could be improved with additional context.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Exact matches used",
              "Filters to exclude benign activity"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited context"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers multiple indicators of the same attack technique and uses wildcards appropriately. However, it may not catch all variations of the attack, and simple evasions could potentially bypass it.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Covers multiple indicators",
              "Uses wildcards appropriately"
            ],
            "weaknesses": [
              "May not catch all variations",
              "Vulnerable to simple evasions"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1059, attack.execution) and a clear description, but lacks specific sub-technique references (e.g., T1059.004 for Unix shell) and authoritative references like MITRE technique URLs. No threat actor, campaign, or malware family information is provided, limiting investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Correct high-level MITRE ATT&CK tactic and technique tags included",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing specific MITRE sub-technique IDs (e.g., T1059.004)",
              "No references to MITRE technique page or real-world threat reports"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses 'contains' on CommandLine which is not optimal and may lead to false positives or performance issues, especially with non-indexed fields. It lacks use of more efficient operators like 'startswith' and does not prioritize high-cardinality fields. The logsource is correctly scoped to Linux process creation, but detection logic is simplistic.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Logsource correctly specifies Linux process creation",
              "Simple condition logic improves readability"
            ],
            "weaknesses": [
              "Uses 'contains' on full command line without anchoring, risking false matches",
              "No use of indexed fields like Image or ParentImage for faster filtering"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects basic indicators like 'execve', 'fork', and Windows-centric tools (wmic, schtasks, bitsadmin) on Linux, which is inconsistent. These tools are not native to Linux, reducing relevance. It fails to cover common Linux living-off-the-land binaries (e.g., awk, find, perl) or advanced execution methods like dynamic linker hijacking or SUID abuse.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Attempts to detect suspicious system call usage in command line",
              "Includes commonly abused tools (though misaligned with Linux)"
            ],
            "weaknesses": [
              "Includes Windows tools (wmic, schtasks, bitsadmin) in a Linux detection rule",
              "Misses key Linux execution techniques and LOLBAS equivalents"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lists common false positives in metadata but lacks actual filtering logic to suppress them. There are no exclusions for legitimate parent processes, paths, or users. The detection is single-event based with no frequency or behavioral context, increasing alert fatigue risk.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate use cases in falsepositives list",
              "Clear documentation of expected benign scenarios"
            ],
            "weaknesses": [
              "No exclusion logic in detection (e.g., exclude /usr/bin/fork)",
              "No use of parent-child process context or execution frequency thresholds"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures general execution techniques but misaligns with Linux threat actor behavior\u2014wmic, schtasks, and bitsadmin are Windows-specific tools rarely present on Linux systems. Detection of 'execve' and 'fork' via command-line strings does not reflect actual system call invocation in practice.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "References common LOLBAS-like tools conceptually",
              "Targets execution phase with relevant MITRE tags"
            ],
            "weaknesses": [
              "Uses Windows-centric tools (wmic, schtasks, bitsadmin) in Linux context",
              "Assumes system calls appear in command line, which is technically inaccurate"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule contains fundamental logic flaws that prevent effective deployment\u2014detecting 'execve' in CommandLine will not catch real system call usage. High false positive risk from development/debugging tools and legitimate automation using similar keywords.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Clear logsource definition for Linux process creation",
              "Condition logic is syntactically valid"
            ],
            "weaknesses": [
              "Detection logic based on invalid assumption (system calls in command line)",
              "High false positive rate expected due to generic keyword matching"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "Title and description provide basic context, and false positives are reasonably documented. However, detection lacks key investigative fields (e.g., parent process, user, hashes), limiting pivot capabilities.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Clear rule title and description",
              "Useful false positive guidance included"
            ],
            "weaknesses": [
              "Missing critical context fields for investigation",
              "No references to MITRE or threat intel for response guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Rule is highly evadable\u2014attackers can easily obfuscate or avoid exact keyword matches. Relies solely on command-line content, which can be encoded or split, and fails to model behavioral patterns or process lineage.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Attempts to detect multiple suspicious elements",
              "Uses OR condition to increase coverage"
            ],
            "weaknesses": [
              "Relies entirely on easily modified command-line strings",
              "No behavioral correlation or process ancestry detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only initial execution via command-line indicators and lacks logic to identify persistence, lateral movement, or exfiltration stages. It is a single-event detection with no correlation across multiple events or attack phases.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:19.576234",
          "metadata": {
            "strengths": [
              "Identifies initial execution attempts using suspicious system calls",
              "Covers some known LOLBAS tools in command-line monitoring"
            ],
            "weaknesses": [
              "No multi-event correlation or stage progression detection",
              "Fails to distinguish between benign and malicious use across attack lifecycle phases"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Process Creation with Suspicious System Calls and Command-Line Tools) scored 0.55/1.0 (Poor). Best performance in correctness (0.86). Needs improvement in detectability (0.30). Issues found in: optimization_level, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-20T16:02:19.576234",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Process Creation with Suspicious System Calls and Command-Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.46166666666666667,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.4764705882352942,
        "effectiveness": 0.44,
        "realism": 0.5444444444444445,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK references. However, it lacks mandatory fields like 'id', 'author', 'status', and 'date', which are essential for production rule management and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Includes core detection components and meaningful tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing required fields: id, author, status, date",
              "Incomplete MITRE mapping (attack.T1566 is phishing, not exfiltration)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic detects command lines containing 'proc_upload' or 'proc_download', which may align with malware behavior, but lacks specificity to confirm actual data staging. The field 'CommandLine|contains' is valid, but the condition is overly simplistic and could miss obfuscated or encoded variants while triggering on benign scripts.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Uses standard Sigma field 'CommandLine|contains'",
              "Simple and interpretable condition logic"
            ],
            "weaknesses": [
              "No validation that these functions are actually malicious indicators",
              "Relies solely on string match without behavioral context"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is too broad, relying only on substring matches in command lines without filtering by parent process, user context, or image path. This increases false positives from legitimate scripts or admin tools using similar naming conventions, despite acknowledging them in falsepositives.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Acknowledges potential false positives in documentation",
              "Targets specific function-like keywords in command line"
            ],
            "weaknesses": [
              "No exclusion of system or trusted processes",
              "Lacks contextual constraints (e.g., parent process, path)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is highly susceptible to evasion via simple obfuscation (e.g., 'proc_uplo' + 'ad'), encoding, or renaming. It does not use case-insensitive matching or regex patterns to catch variations, and only targets one narrow indicator without covering alternative data staging methods or tool implementations.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Catches clear-text use of suspicious function names",
              "Boolean OR condition allows detection of either variant"
            ],
            "weaknesses": [
              "No support for obfuscation or encoding variants",
              "Single-point detection easily bypassed by attackers"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but lacks specific references to malware families, threat actors, or campaign names. The technique mapping is partially accurate but T1566 (Phishing) is misaligned with data staging.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tags and technique name",
              "Provides clear rule description and false positive considerations"
            ],
            "weaknesses": [
              "Incorrect mapping to T1566 (Phishing) instead of proper exfiltration sub-technique like T1074",
              "No references to malware families, threat actors, or external research"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses the CommandLine field effectively with 'contains', which is acceptable for Sysmon process creation logs. It avoids leading wildcards and uses simple OR logic, making it efficient for most SIEMs.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Uses indexed fields (CommandLine) and simple condition logic",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "'contains' on generic strings may trigger on benign scripts with similar naming",
              "Could benefit from additional field constraints (e.g., Image path)"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule narrowly focuses on two function names without covering broader data staging behaviors or tools. It does not account for obfuscation, alternative function names, or common frameworks like Cobalt Strike that may use different staging mechanisms.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Targets specific function names associated with malicious behavior",
              "Covers basic detection of upload/download staging patterns"
            ],
            "weaknesses": [
              "Limited to literal string matches; no coverage of encoded, obfuscated, or alternate implementations",
              "Fails to include parent-child process context or multi-stage exfiltration logic"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks built-in filters to exclude legitimate administrative scripts or development tools using similar function names. While false positives are acknowledged in metadata, no exclusion logic is implemented in the detection.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Acknowledges potential false positives in metadata",
              "Simple logic reduces noise from complex patterns"
            ],
            "weaknesses": [
              "No whitelisting of known good paths, users, or processes",
              "No use of process ancestry (e.g., parent process) to increase fidelity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule targets function names associated with malware, but lacks specific TTP alignment with known threat actors or campaigns. There is no evidence that 'proc_upload' and 'proc_download' are consistently used by real-world malware in command lines, making the detection potentially theoretical rather than operationally grounded.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Targets function-like naming patterns common in malicious tooling",
              "Aligned with data staging behavior in exfiltration phase"
            ],
            "weaknesses": [
              "No linkage to specific APT groups, malware families, or real-world campaigns",
              "Assumes command-line exposure of internal function names, which is uncommon"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma rule syntax is valid and uses common Sysmon process creation logging, which is widely deployed. However, the detection logic may generate false positives due to generic naming, and the verification result shows zero events detected, raising concerns about efficacy in real environments.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Uses standard logsource (Sysmon process creation) available in most enterprises",
              "Rule syntax is correct and verification completed successfully"
            ],
            "weaknesses": [
              "High risk of false positives from benign scripts using similar function names",
              "No detection in historical data suggests low sensitivity or poor coverage"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule title and description clearly indicate potential data staging activity, aiding initial triage. However, it lacks enriched context such as expected parent processes, network connections, or file paths that would support deeper investigation.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Clear title and description help analysts understand the alert purpose",
              "False positive guidance includes relevant scenarios"
            ],
            "weaknesses": [
              "Limited investigative pivot points (only command line match)",
              "Missing references to malware samples or IOCs for validation"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is highly susceptible to evasion through simple renaming, obfuscation, or use of indirect execution methods. It relies solely on command-line string matching, which attackers can easily bypass using encoding, in-memory execution, or alternative function names.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Focus on function-like behavior hints at intent",
              "Covers both upload and download directions"
            ],
            "weaknesses": [
              "Relies entirely on easily modified command-line strings",
              "No behavioral correlation (e.g., file creation, network connection) to detect obfuscation or LOLBin usage"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only a single stage\u2014execution of commands containing 'proc_upload' or 'proc_download'\u2014which may indicate data staging or exfiltration activity, but it lacks logic to correlate across multiple stages such as initial access, persistence, lateral movement, or follow-on exfiltration. It does not chain related events or establish behavioral context beyond keyword matching in command lines.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:02:55.604640",
          "metadata": {
            "strengths": [
              "Targets specific command-line artifacts associated with malicious data transfer functions",
              "Aligned with known malware naming patterns used in exfiltration tools"
            ],
            "weaknesses": [
              "Single-event detection with no correlation across attack lifecycle phases",
              "No mechanism to detect persistence, lateral movement, or initial compromise linked to this behavior"
            ]
          }
        }
      ],
      "summary": "Rule for attack.exfiltration (Malware Data Staging via proc_upload and proc_download Functions) scored 0.46/1.0 (Poor). Best performance in realism (0.54). Needs improvement in detectability (0.30). Issues found in: detection_logic_correctness, detection_specificity, detection_sensitivity",
      "timestamp": "2025-12-20T16:02:55.604640",
      "metadata": {
        "attack_id": "attack.exfiltration",
        "technique_name": "Malware Data Staging via proc_upload and proc_download Functions",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.3283333333333333,
      "category_scores": {
        "correctness": 0.25999999999999995,
        "quality": 0.2882352941176471,
        "effectiveness": 0.3333333333333333,
        "realism": 0.5555555555555556,
        "detectability": 0.24444444444444446
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule includes only a subset of required Sigma fields (title, logsource, detection, falsepositives, level, tags). Critical fields such as id, status, description, references, author, and date are missing, reducing its completeness.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Provides essential detection fields (title, logsource, detection, falsepositives).",
              "Includes MITRE ATT&CK tags for technique mapping."
            ],
            "weaknesses": [
              "Missing mandatory metadata (id, description, author, date, references).",
              "No explicit status or versioning information."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The logic looks for the literal string \"proc_rmfile\" in the command line, which may not be a realistic indicator of the technique. Exclusion filters are limited and may not prevent benign matches, while the condition syntax is correct but simplistic.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Uses a clear condition combining selection and exclusions.",
              "Excludes known legitimate tools (wmic, schtasks, bitsadmin)."
            ],
            "weaknesses": [
              "Relies on a single, possibly non\u2011existent command\u2011line token.",
              "Exclusion list is narrow and may miss other legitimate uses."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is overly broad; any process with \"proc_rmfile\" in its command line will trigger, leading to potential false positives. Limited contextual filters (parent process, image) do not sufficiently narrow the scope.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Attempts to filter out common system utilities.",
              "Applies a NOT clause to reduce obvious benign cases."
            ],
            "weaknesses": [
              "Lacks precise matching (e.g., exact file paths, hashes).",
              "Does not incorporate additional context such as user or process lineage."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule captures only one specific indicator and does not account for variations (e.g., encoded commands, renamed binaries). Consequently, many legitimate implementations of the technique could evade detection.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Detects the exact keyword when present.",
              "Case\u2011insensitive containment matches typical Windows command lines."
            ],
            "weaknesses": [
              "No alternative indicators (e.g., file deletions via PowerShell, native APIs).",
              "Absence of regex or wildcard patterns to cover obfuscation."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes basic MITRE tags and a brief description, but lacks detailed references, threat actor or campaign context, and does not enumerate associated tools or sub\u2011techniques.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK technique and sub\u2011technique identifiers",
              "Provides a concise description of the detection purpose"
            ],
            "weaknesses": [
              "Missing authoritative references (e.g., MITRE technique URL, vendor blogs)",
              "No threat actor, campaign, or malware family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection uses simple 'contains' and 'endswith' operators without leading wildcards, which is efficient, but it does not filter on indexed fields like EventID and places exclusions after the main selection, reducing query performance.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses specific string operators",
              "Exclusions are defined with concrete file name endings"
            ],
            "weaknesses": [
              "Does not filter on Sysmon EventID (e.g., EventID=1) to leverage indexing",
              "Exclusion logic is placed after the primary selection, which may increase processing overhead"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only detects the literal string \"proc_rmfile\" and therefore misses the many other ways attackers delete or hide artifacts, limiting its coverage of the broader T1070.004 technique.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Targets a specific function that can be used for file deletion",
              "Maps to the correct ATT&CK sub\u2011technique identifier"
            ],
            "weaknesses": [
              "Fails to detect alternative deletion methods (e.g., del, PowerShell Remove\u2011Item, VSS)",
              "Does not consider variations used by common adversary frameworks (Cobalt Strike, Empire, etc.)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule adds some exclusions for known legitimate utilities, yet it lacks broader context such as user, path, or frequency filters, which may still generate false alerts when legitimate scripts invoke proc_rmfile.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Excludes common system utilities that might legitimately contain the string",
              "Provides a false\u2011positive note in the metadata"
            ],
            "weaknesses": [
              "No time\u2011based or frequency thresholds to suppress isolated benign events",
              "Limited parent\u2011child relationship analysis beyond simple exclusions"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule focuses on a very specific string \"proc_rmfile\" that is not widely documented in real\u2011world ATT&CK activity, and it lacks references to actual campaigns or threat\u2011actor tooling.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Attempts to map a known function name to the ATT&CK technique T1070.004",
              "Includes exclusions for common legitimate utilities"
            ],
            "weaknesses": [
              "No evidence of usage by known adversaries or APT groups",
              "Missing contextual details such as typical timing, targets, or associated tactics"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is generally correct and targets Sysmon process creation, which is widely deployed, but the rule relies on a single keyword and lacks validation data, raising concerns about coverage and alert volume.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Uses Sysmon, a common data source in enterprise environments",
              "Provides a clear condition with exclusions to limit obvious false positives"
            ],
            "weaknesses": [
              "Limited to one command\u2011line indicator, risking missed detections",
              "No documented testing or performance metrics to confirm low false\u2011positive rate"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are concise, but the rule surfaces only the command line, offering little context for investigation such as user, parent process, or file hashes.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and brief description",
              "Severity set to high, helping triage"
            ],
            "weaknesses": [
              "Insufficient enrichment (e.g., user, PID, hash) for effective pivoting",
              "No guidance on remediation steps or investigation playbook"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection can be trivially evaded by renaming the executable, using alternative APIs, or encoding the keyword, as it depends solely on a literal string in the command line.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Excludes known legitimate tools to reduce noise"
            ],
            "weaknesses": [
              "Single\u2011indicator approach; no behavioral or multi\u2011event correlation",
              "Fails against common living\u2011off\u2011the\u2011land techniques and command\u2011line obfuscation"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only flags a single process creation event containing the literal \"proc_rmfile\" and does not link it to subsequent actions such as persistence setup, lateral movement, or impact. While it can catch the initial execution, it lacks correlation logic to track the technique across multiple stages of an attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:03:32.250805",
          "metadata": {
            "strengths": [
              "Simple, low\u2011overhead detection of a specific indicator removal command",
              "Excludes common legitimate tools to reduce false positives"
            ],
            "weaknesses": [
              "Only detects a single event; no coverage of persistence, lateral movement, or post\u2011removal activities",
              "Relies on a hard\u2011coded string, making it easy for adversaries to evade by using alternative APIs or obfuscation"
            ]
          }
        }
      ],
      "summary": "Rule for attack.defense-evasion (Indicator Removal on Host via proc_rmfile Function) scored 0.33/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.24). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:03:32.251312",
      "metadata": {
        "attack_id": "attack.defense-evasion",
        "technique_name": "Indicator Removal on Host via proc_rmfile Function",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4533333333333333,
      "category_scores": {
        "correctness": 0.42000000000000004,
        "quality": 0.4647058823529412,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule contains most core fields (title, description, logsource, detection, falsepositives, level, tags) but omits mandatory Sigma metadata such as id, status, references, author, and date. Consequently the rule is not production\u2011ready from a documentation standpoint.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "All required structural sections (logsource, detection, falsepositives) are present",
              "Tags include the relevant ATT&CK technique"
            ],
            "weaknesses": [
              "Missing mandatory fields (id, status, author, date, references)",
              "No explicit description field for the rule's purpose"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic captures execution of proc_dir.exe and three common CLI utilities, but the condition is overly simplistic and may fire on benign admin activity. The exclusion of only cmd.exe and services.exe as parents is insufficient, and the command\u2011line contains checks duplicate the Image filter.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Combines multiple relevant executables under a single rule",
              "Uses a clear OR condition to cover alternative tools"
            ],
            "weaknesses": [
              "Redundant CommandLine contains checks (e.g., \"wmic\" when Image is wmic.exe)",
              "Exclusion list is narrow, leading to many false positives"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is broad; any invocation of wmic, schtasks, or bitsadmin will trigger regardless of intent. Limited parent\u2011process exclusions do not sufficiently filter legitimate administrative scripts, resulting in a high false\u2011positive rate.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Attempts to reduce noise by excluding cmd.exe and services.exe as parents",
              "Targets known discovery utilities"
            ],
            "weaknesses": [
              "No context such as user account, command arguments, or execution environment",
              "Fails to differentiate between benign and malicious usage of the utilities"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several common tools used for file\u2011system discovery, but it misses many legitimate variants (PowerShell, native dir commands, renamed binaries) and does not handle obfuscation or encoded arguments, limiting its ability to detect evasive attacks.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Covers three widely abused Windows utilities plus a custom proc_dir binary",
              "Case\u2011insensitive matching via \"contains\" works for typical command lines"
            ],
            "weaknesses": [
              "Does not account for renamed or moved executables",
              "Lacks regex or wildcard patterns to capture encoded or indirect calls"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic tags, a description, and false\u2011positive notes, but lacks explicit tactic/sub\u2011technique fields, authoritative references, and contextual threat\u2011actor or campaign information.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag and technique name",
              "Provides a clear description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing explicit tactic/sub\u2011technique metadata",
              "No references to external sources, threat actors, or related malware"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The detection uses indexed fields with endswith and contains operators and avoids leading wildcards, but it does not filter on Sysmon EventID and relies on relatively broad CommandLine contains clauses.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and complex regex",
              "Simple parent\u2011process exclusions improve efficiency"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) filter to limit scope",
              "CommandLine contains may generate unnecessary scans"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a few common CLI utilities and a custom proc_dir binary, yet it omits many other legitimate discovery commands (e.g., PowerShell, cmd /c dir) and does not address sub\u2011techniques or advanced frameworks.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Covers wmic, schtasks, and bitsadmin which are frequently abused",
              "Includes detection of a custom proc_dir executable"
            ],
            "weaknesses": [
              "Limited to a narrow set of tools, missing broader discovery methods",
              "No coverage of sub\u2011techniques or alternative attacker frameworks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Parent\u2011process exclusions reduce some noise, but the rule still triggers on many legitimate administrative activities and lacks user, path, or frequency\u2011based whitelisting.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Excludes execution from cmd.exe and services.exe parents",
              "Provides a false\u2011positive description for legitimate use cases"
            ],
            "weaknesses": [
              "No user or role\u2011based whitelisting",
              "Absence of time/frequency correlation to filter benign activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures known LOLBins (wmic, schtasks, bitsadmin) that threat actors use for discovery, but it adds an obscure \"proc_dir\" tool and lacks references to specific campaigns or attacker behavior patterns.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Includes commonly abused Windows utilities",
              "Attempts to filter out benign parent processes"
            ],
            "weaknesses": [
              "No explicit linkage to real-world threat actor TTPs or campaigns",
              "The \"proc_dir\" reference is not a recognized adversary tool"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is generally correct and targets Sysmon process creation, which is widely available, but the rule may generate many alerts from legitimate admin activity and lacks evidence of prior testing.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Uses a common log source (Sysmon process_creation)",
              "Excludes parent shells to reduce obvious noise"
            ],
            "weaknesses": [
              "Potentially high false\u2011positive rate from routine admin scripts",
              "No documented validation or tuning data"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title is clear and the rule provides basic process information, yet it omits richer context (user, hash, timestamps) and does not give guidance on next investigative steps.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Parent\u2011process exclusion helps narrow focus"
            ],
            "weaknesses": [
              "Limited fields for pivoting (no user, hash, etc.)",
              "No embedded remediation or investigation guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Detection relies on static executable names and command\u2011line strings, which attackers can evade by renaming binaries, using PowerShell wrappers, or employing alternative LOLBins.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Covers multiple known binaries",
              "Matches on command\u2011line keywords"
            ],
            "weaknesses": [
              "Easy to bypass via renaming or alternative tools",
              "Lacks behavior\u2011based or multi\u2011vector correlation"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only monitors process creation of specific discovery utilities, covering the initial execution stage. It does not detect persistence, lateral movement, data collection, or exfiltration, nor does it correlate events across stages, limiting its multi\u2011stage coverage.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:04:06.043316",
          "metadata": {
            "strengths": [
              "Detects execution of known discovery binaries and CLI tools",
              "Excludes common parent processes to reduce obvious false positives"
            ],
            "weaknesses": [
              "Only a single\u2011event detection; no coverage of persistence or lateral movement",
              "Lacks correlation logic to link related discovery activities across time"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1083 (File and Directory Discovery via proc_dir and Common CLI Tools) scored 0.45/1.0 (Poor). Best performance in realism (0.50). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:04:06.043316",
      "metadata": {
        "attack_id": "attack.t1083",
        "technique_name": "File and Directory Discovery via proc_dir and Common CLI Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.47916666666666663,
      "category_scores": {
        "correctness": 0.48,
        "quality": 0.5470588235294118,
        "effectiveness": 0.42000000000000004,
        "realism": 0.5722222222222223,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes core fields like title, description, logsource, detection, falsepositives, level, and tags, but omits mandatory Sigma metadata such as id, status, author, date, and references, which are required for a production\u2011ready rule.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "All essential detection components (selection, condition) are present",
              "Relevant MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references)",
              "No unique rule identifier makes tracking difficult"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly targets known network\u2011discovery binaries and a PowerShell cmdlet, but the parent\u2011process exclusion (cmd.exe) is overly broad and may suppress legitimate malicious activity. The socket_connect selector is vague and unrelated to the technique.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Uses explicit executable names to match common discovery tools",
              "Combines multiple selectors with an OR, covering several vectors"
            ],
            "weaknesses": [
              "Parent\u2011process filter may cause false negatives for malicious commands launched from cmd.exe",
              "The socket_connect selector lacks clear relevance to T1049"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While the rule limits matches to specific binaries, it does not differentiate benign usage (e.g., netstat run by admins) beyond the crude cmd.exe exclusion, leading to potential false positives or missed detections.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Restricts matches to exact executable names, avoiding generic wildcard matches",
              "Excludes a common parent process to reduce noise"
            ],
            "weaknesses": [
              "Exclusion of cmd.exe may filter out legitimate malicious activity",
              "No additional context (user, command arguments) to distinguish benign from malicious runs"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several typical discovery tools and a specific PowerShell cmdlet, but it does not account for renamed binaries, alternative PowerShell cmdlets (e.g., Get-NetStat), or encoded commands, limiting its ability to detect evasive variants.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Covers multiple native Windows utilities used for network discovery",
              "Includes a PowerShell\u2011specific detection for Get\u2011NetTCPConnection"
            ],
            "weaknesses": [
              "Fails to detect renamed or moved executables",
              "Limited to one PowerShell cmdlet; other network\u2011discovery cmdlets are omitted"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic metadata (title, description, MITRE tag, technique name) but lacks depth such as tactic/sub\u2011technique tags, authoritative references, threat\u2011actor or campaign context, and detailed tool/malware associations.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK technique identifier",
              "Provides a concise description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing tactic/sub\u2011technique tags and external references",
              "No threat\u2011actor, campaign, or associated malware information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The detection uses efficient operators (endswith, contains) and avoids leading wildcards, but it does not filter on indexed fields like EventID, nor does it prioritize the most selective conditions, which could impact SIEM performance.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses specific string matches",
              "Logical exclusion of parent cmd.exe to reduce noise"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) filter to leverage indexing",
              "Detection order and lack of additional restrictive filters may cause unnecessary scans"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures several common utilities (netstat, wmic, schtasks, bitsadmin, PowerShell Get\u2011NetTCPConnection) but omits many other legitimate discovery commands and does not address sub\u2011techniques or adversary\u2011specific tooling.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Covers a core set of native Windows utilities used for network discovery",
              "Includes a PowerShell specific cmdlet detection"
            ],
            "weaknesses": [
              "Missing other discovery tools (e.g., netsh, ipconfig, Get\u2011NetIPConfiguration)",
              "Does not map to sub\u2011techniques or advanced frameworks like Cobalt Strike or Empire"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Only a single parent\u2011process exclusion (cmd.exe) is provided; there are no user, path, or frequency\u2011based filters, leading to a high likelihood of legitimate admin activity triggering alerts.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Explicit false\u2011positive examples in documentation",
              "Parent\u2011process exclusion attempts to reduce noise"
            ],
            "weaknesses": [
              "Lacks whitelisting of known admin accounts or scheduled tasks",
              "No temporal or count\u2011based logic to differentiate benign from malicious usage"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common LOLBin tools (netstat, wmic, schtasks, bitsadmin, PowerShell) that threat actors use for network discovery, reflecting realistic TTPs. However, it lacks campaign\u2011specific context, timing cues, or nuanced parameter checks that would demonstrate deeper awareness.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Covers a broad set of legitimate discovery utilities used by adversaries",
              "Maps directly to ATT&CK technique T1049 (System Network Connections Discovery)"
            ],
            "weaknesses": [
              "No reference to specific threat groups, campaigns, or observed attacker behavior patterns",
              "Treats all invocations equally, missing contextual factors such as frequency or anomalous timing"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5.5,
          "normalized_score": 0.55,
          "explanation": "The Sigma syntax is generally correct and targets Sysmon process_creation, which is widely deployed. Nonetheless, the rule may generate high false\u2011positive volume (netstat and schtasks are frequently used) and lacks tuning mechanisms like thresholds or baselines.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Uses a realistic log source (Sysmon) available in most enterprise environments",
              "Provides a clear false\u2011positive guidance list"
            ],
            "weaknesses": [
              "Potential alert fatigue due to common legitimate usage of the listed binaries",
              "No built\u2011in suppression or rate\u2011limiting to mitigate noisy alerts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The title and description succinctly convey the detection purpose, and the captured fields (Image, CommandLine, ParentImage) give analysts a starting point for investigation. However, the rule does not suggest concrete response steps or enrich alerts with additional context (e.g., user, host, hash).",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and concise description",
              "Provides process\u2011level details useful for pivoting (executable name, command line, parent process)"
            ],
            "weaknesses": [
              "Lacks guidance on next investigative actions or remediation",
              "Does not enrich alerts with identity or asset metadata that would speed triage"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on static executable names and simple command\u2011line string matches, which can be evaded by renaming binaries, using alternative utilities, or obfuscating arguments. It does not incorporate behavioral correlation (e.g., network sockets) beyond a single vague \"socket_connect\" selector.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Includes multiple LOLBin checks, increasing coverage over a single indicator",
              "Excludes parent cmd.exe to reduce trivial noise"
            ],
            "weaknesses": [
              "Easily bypassed by renaming or using other native tools (e.g., Get-NetTCPConnection via PowerShell Core)",
              "Limited to static indicators; lacks deeper behavioral or correlation logic"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only captures the execution of specific network\u2011discovery utilities at the point of process creation. It does not address persistence, lateral movement, data collection, or impact phases, nor does it correlate multiple related events across the attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:04:40.366289",
          "metadata": {
            "strengths": [
              "Targets well\u2011known discovery binaries (netstat, wmic, schtasks, bitsadmin, PowerShell).",
              "Uses Sysmon process creation data, which is reliable and low\u2011noise."
            ],
            "weaknesses": [
              "Limited to a single stage (initial discovery) and misses later stages such as credential use or lateral movement.",
              "No correlation logic to link repeated discovery attempts or subsequent malicious activity."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1049 (Detection of System Network Connections Discovery via Command-line Tools) scored 0.48/1.0 (Poor). Best performance in realism (0.57). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_specificity, metadata_richness",
      "timestamp": "2025-12-20T16:04:40.366289",
      "metadata": {
        "attack_id": "attack.t1049",
        "technique_name": "Detection of System Network Connections Discovery via Command-line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4433333333333333,
      "category_scores": {
        "correctness": 0.5599999999999999,
        "quality": 0.4882352941176471,
        "effectiveness": 0.36666666666666664,
        "realism": 0.5,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes core fields like title, logsource, detection, falsepositives, level, and tags, but omits mandatory Sigma metadata such as id, status, references, author, and date, reducing its completeness for sharing and versioning.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Contains essential detection sections (logsource, detection, condition).",
              "Provides falsepositive guidance and MITRE ATT&CK tagging."
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references).",
              "No explicit description field separate from the narrative."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly targets wmic, schtasks, and bitsadmin binaries and excludes common parent processes, but using CommandLine contains for gethostbyname/getlogin is unreliable because those API calls are not visible in command lines, and the parent exclusion may suppress legitimate malicious activity launched from PowerShell or cmd.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Clear OR condition across multiple relevant utilities.",
              "Uses Image endswith for precise binary identification."
            ],
            "weaknesses": [
              "API function names are unlikely to appear in command lines, causing missed detections.",
              "Excluding PowerShell and cmd as parents may filter out real attacks."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is fairly specific for the three binaries, but the broad exclusion of parent processes and lack of additional context (user, command arguments) can still generate false positives from legitimate automation scripts that invoke these tools.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Exact filename matching reduces noise from similarly named files.",
              "Parent process filter attempts to limit benign activity."
            ],
            "weaknesses": [
              "Parent filter may be too aggressive, missing malicious use cases.",
              "No argument-level filtering (e.g., only discovery\u2011related flags)."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Coverage is limited to a small set of utilities and two API strings; it does not account for renamed binaries, alternative discovery tools, or case\u2011insensitive variations, making it easy for adversaries to evade.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Covers multiple common Windows discovery utilities.",
              "Combines several indicators to increase chance of detection."
            ],
            "weaknesses": [
              "Lacks regex or case\u2011insensitive matching for broader coverage.",
              "Does not include other typical discovery commands (systeminfo, whoami, etc.)."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic MITRE tags and a short description, but lacks deeper context such as sub\u2011technique IDs, references to research, threat\u2011actor or campaign information, and associated tool/malware families.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique ID and tactic hint",
              "Provides clear description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing authoritative references and sub\u2011technique details",
              "No threat\u2011actor, campaign, or tool attribution information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The detection uses indexed fields (Image, ParentImage) and avoids leading wildcards, but relies on CommandLine|contains for function names which can be less efficient and may generate noise.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Uses Image|endswith and ParentImage|endswith for fast matching",
              "No leading wildcards or complex regex"
            ],
            "weaknesses": [
              "CommandLine|contains may be costly and imprecise",
              "No ordering of most restrictive filters first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Covers a handful of utilities (wmic, schtasks, bitsadmin) and two API calls, yet omits many common system\u2011information commands (systeminfo, hostname, ipconfig, PowerShell cmdlets) and advanced frameworks.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Detects several legitimate discovery binaries",
              "Includes low\u2011level API calls that can indicate custom tooling"
            ],
            "weaknesses": [
              "Limited to a narrow set of utilities, missing broader coverage",
              "No inclusion of sub\u2011techniques or modern attacker frameworks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Excluding parent processes like explorer, cmd, and PowerShell may suppress many legitimate administrative runs but also reduces detection of malicious activity that uses those common parents, and there is no user, path, or frequency filtering.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Attempts to filter out common interactive shells",
              "Provides a false\u2011positive description list"
            ],
            "weaknesses": [
              "Exclusion of typical parent processes can miss real threats",
              "Lacks granular whitelisting, time\u2011based or frequency logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures generic system discovery techniques used by many actors but lacks linkage to specific threat groups, campaigns, or nuanced attacker behavior such as particular flags or timing. It therefore shows limited contextual depth.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Covers common LOLBin utilities (wmic, schtasks, bitsadmin) used in real attacks",
              "Includes API calls (gethostbyname, getlogin) that map to ATT&CK T1082"
            ],
            "weaknesses": [
              "No reference to specific adversary tactics, techniques, or procedures",
              "Missing campaign or APT group context that would improve relevance"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is mostly correct and targets Sysmon process creation events, which are widely available. However, the rule may generate many false positives and the exclusion of common parent processes could miss legitimate admin activity, reducing its readiness for production.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon fields (Image, CommandLine, ParentImage) that are present in most deployments",
              "Provides a clear severity level (medium) and false\u2011positive guidance"
            ],
            "weaknesses": [
              "High likelihood of alerts from routine admin scripts using the same utilities",
              "Exclusion of typical parents may cause missed detections or over\u2011filtering"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are concise, and the rule surfaces process\u2011level data useful for initial triage. Yet it lacks richer context (e.g., user, hash, network endpoints) that would aid deeper investigation.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and brief description",
              "Provides parent\u2011process information to help assess legitimacy"
            ],
            "weaknesses": [
              "Limited fields for pivoting (no user, command line arguments beyond simple contains)",
              "No built\u2011in guidance on remediation steps or enrichment"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies on static indicators such as executable names and simple command\u2011line strings, which can be evaded by renaming binaries, using alternative LOLBins, or encoding arguments. It does not incorporate behavioral correlation or multi\u2011vector checks.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Covers multiple utilities, increasing coverage breadth",
              "Filters out common legitimate parents to reduce noise"
            ],
            "weaknesses": [
              "Easily bypassed by renaming or using alternative tools",
              "No detection of indirect or obfuscated usage (e.g., PowerShell invoking wmic via Invoke\u2011Expression)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only identifies the initial execution of discovery utilities or API calls and does not address later stages such as persistence, lateral movement, or data exfiltration. It also lacks any event correlation logic to link related activities across the attack lifecycle.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:14.469927",
          "metadata": {
            "strengths": [
              "Detects execution of common discovery tools (wmic, schtasks, bitsadmin).",
              "Filters out typical parent processes to reduce false positives."
            ],
            "weaknesses": [
              "No coverage of persistence or lateral movement techniques that may reuse the same utilities.",
              "Lacks correlation across multiple events, limiting multi\u2011stage visibility."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1082 (Detection of System Information Discovery via gethostbyname, getlogin, and common discovery utilities) scored 0.44/1.0 (Poor). Best performance in correctness (0.56). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_specificity, detection_sensitivity",
      "timestamp": "2025-12-20T16:05:14.469927",
      "metadata": {
        "attack_id": "attack.t1082",
        "technique_name": "Detection of System Information Discovery via gethostbyname, getlogin, and common discovery utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4649999999999999,
      "category_scores": {
        "correctness": 0.45999999999999996,
        "quality": 0.41764705882352937,
        "effectiveness": 0.5,
        "realism": 0.6111111111111112,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule contains core elements such as title, logsource, detection, falsepositives, level, and tags, but it lacks several mandatory Sigma metadata fields (id, status, author, date, references). This makes the rule incomplete for formal sharing and versioning.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Includes essential detection sections (title, logsource, detection, falsepositives, level, tags)",
              "Provides a clear description of the intended behavior"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references)",
              "No unique rule identifier or provenance information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic attempts to capture network\u2011discovery activity via specific tools and a getsockopt string, but the getsockopt condition is unrealistic for process\u2011creation logs, and the tool list is overly broad without argument filtering. The parent\u2011process exclusion may also suppress legitimate detections.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Uses explicit image matching for known admin utilities",
              "Applies a parent\u2011process filter to reduce obvious noise"
            ],
            "weaknesses": [
              "Getsockopt detection is unlikely to appear in command\u2011line fields",
              "Broad inclusion of wmic, schtasks, bitsadmin without argument checks leads to false positives"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is prone to high false\u2011positive rates because common administrative tools are matched without context (e.g., specific arguments indicating discovery). The parent\u2011process exclusion does not sufficiently narrow the scope.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Exact image matching reduces accidental matches on similarly named files",
              "Excludes processes launched directly from cmd.exe or powershell.exe"
            ],
            "weaknesses": [
              "No filtering on command\u2011line arguments that would indicate discovery intent",
              "Broad tool selection captures routine system management activity"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule covers a few relevant utilities, it omits many legitimate network\u2011discovery commands (ipconfig, netsh, PowerShell networking cmdlets) and can be evaded by renaming or using alternative tools. The getsockopt clause adds little practical coverage.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Covers multiple utilities that attackers may use for discovery",
              "Attempts to catch low\u2011level API usage via getsockopt"
            ],
            "weaknesses": [
              "Limited coverage of common discovery commands and techniques",
              "Easily bypassed by renaming tools or using alternative utilities"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic tags and a brief description, but lacks specific MITRE technique IDs, sub\u2011technique references, authoritative sources, and threat\u2011actor or campaign context.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag for the technique",
              "Provides a concise description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing precise technique/sub\u2011technique identifiers (e.g., T1016.001)",
              "No references to external research, actor, or campaign information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection uses efficient endswith operators and avoids leading wildcards, but it does not filter on Sysmon EventID and relies on a generic contains match for getsockopt, which can be less performant.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and complex regex",
              "Uses simple endswith filters on indexed Image fields"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) restriction to limit scope",
              "CommandLine contains may generate unnecessary scanning overhead"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a few common admin tools and a low\u2011level getsockopt call, yet it omits many other legitimate discovery utilities (ipconfig, netsh, PowerShell cmdlets) and does not address sub\u2011techniques or adversary\u2011specific tooling.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Detects usage of wmic, schtasks, and bitsadmin",
              "Includes a low\u2011level API call (getsockopt) that attackers may use"
            ],
            "weaknesses": [
              "Limited to a narrow set of tools, missing broader discovery commands",
              "No coverage of sub\u2011techniques or advanced frameworks (e.g., PowerShell, Cobalt Strike)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "Parent\u2011process exclusions help reduce noise, but the rule still risks high false positives from legitimate admin scripts and lacks whitelisting, user/context filters, or frequency\u2011based logic.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Excludes processes launched from cmd.exe and powershell.exe",
              "Provides a false\u2011positive description for analysts"
            ],
            "weaknesses": [
              "No whitelisting of known admin accounts or paths",
              "Absence of temporal or frequency thresholds to differentiate benign from malicious activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets legitimate ATT&CK techniques (T1016) and includes common LOLBin tools, showing basic alignment with attacker behavior. However, it lacks references to specific threat actors, campaigns, or nuanced usage patterns, limiting its contextual depth.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Maps to a well\u2011known ATT&CK technique (Network Configuration Discovery).",
              "Includes multiple LOLBin tools that adversaries frequently abuse."
            ],
            "weaknesses": [
              "No attribution to real\u2011world campaigns or APT groups.",
              "Does not capture richer context such as timing, target scope, or typical command arguments."
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma syntax is generally correct, uses Sysmon process_creation which is widely deployed, and includes a parent\u2011process exclusion to curb noise. Nonetheless, the rule may still generate false positives from legitimate admin scripts and lacks validation data beyond a single test run.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Clear logsource definition compatible with most Windows environments.",
              "Parent\u2011process exclusion helps reduce obvious noise."
            ],
            "weaknesses": [
              "Potential for false positives from routine admin tasks.",
              "Limited evidence of production\u2011level testing or tuning."
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are concise, but the rule only surfaces basic fields (Image, CommandLine, ParentImage) without user, hash, or network context, making deeper investigation harder. Guidance for triage or remediation is absent.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Title clearly states the detection focus.",
              "Description mentions typical false\u2011positive scenarios."
            ],
            "weaknesses": [
              "Lacks enriched fields (e.g., SubjectUserName, SHA256) for pivoting.",
              "No recommended response steps or enrichment links."
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on static indicators (executable name, presence of \"getsockopt\" in command line). Adversaries can rename binaries, use alternative utilities (netsh, ipconfig), or invoke the API via custom code, easily bypassing the rule.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Covers several LOLBin tools, increasing coverage breadth.",
              "Combines function\u2011call hint (getsockopt) with process names."
            ],
            "weaknesses": [
              "Easy to evade by renaming or using other native tools.",
              "Does not incorporate behavioral correlation (e.g., network queries after process launch)."
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only monitors a single point in the attack lifecycle \u2013 the execution of specific discovery utilities or a getsockopt call. It does not address persistence, lateral movement, data collection, or impact stages, nor does it correlate events across stages.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:05:49.021261",
          "metadata": {
            "strengths": [
              "Targets concrete, observable artifacts (wmic, schtasks, bitsadmin, getsockopt).",
              "Implements a simple parent\u2011process exclusion to reduce obvious false positives."
            ],
            "weaknesses": [
              "Limited to initial discovery; no coverage of later stages such as persistence or lateral movement.",
              "Excludes legitimate parent shells, potentially missing malicious activity launched from those environments."
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (Detection of System Network Configuration Discovery via getsockopt and Common Admin Tools) scored 0.46/1.0 (Poor). Best performance in realism (0.61). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:05:49.022270",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "Detection of System Network Configuration Discovery via getsockopt and Common Admin Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.3783333333333333,
      "category_scores": {
        "correctness": 0.36000000000000004,
        "quality": 0.38235294117647056,
        "effectiveness": 0.39333333333333337,
        "realism": 0.4444444444444444,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides title, logsource, detection, falsepositives, level, and tags, but omits mandatory Sigma fields such as id, status, description (as a Sigma field), references, author, and date. The existing description is outside the Sigma structure, reducing completeness.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Core detection sections (logsource, detection, condition) are present",
              "Relevant MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references)",
              "Description not embedded in the Sigma schema"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The logic mixes Linux and Windows artifacts under a Linux sysmon logsource, causing platform mismatch. Selections are simplistic and the parent\u2011process exclusions only cover cmd.exe and powershell.exe, ignoring common Linux shells, which reduces correctness.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Attempts to filter out common interactive shells",
              "Uses explicit file name matching for known utilities"
            ],
            "weaknesses": [
              "Platform inconsistency (Windows executables in a Linux logsource)",
              "Parent process filters do not cover Linux shells like bash or sh"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies on broad \"endswith\" matches and a generic \"contains getpwuid\" clause, which will fire on many legitimate administrative scripts and Python utilities, leading to high false\u2011positive rates.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Excludes executions launched from cmd.exe and powershell.exe",
              "Targets specific utility names rather than generic commands"
            ],
            "weaknesses": [
              "No contextual filters (e.g., user, parent process for Linux, command arguments)",
              "Broad matching on Python scripts without additional constraints"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule covers a few common tools, it misses many alternative methods for user discovery (e.g., PowerShell Get-LocalUser, Linux \"id\" command, or renamed binaries). The strict \"endswith\" checks also allow easy evasion by renaming the executable.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Covers multiple utilities across Windows and Linux",
              "Detects explicit use of the getpwuid function in Python"
            ],
            "weaknesses": [
              "Fails to capture renamed or path\u2011obfuscated versions of the utilities",
              "Does not include other legitimate discovery commands (e.g., id, whoami)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic MITRE tags and a short description, but lacks authoritative references, threat actor or campaign context, and detailed sub\u2011technique identifiers.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "Provides a concise description of the detection"
            ],
            "weaknesses": [
              "No references to MITRE pages, vendor blogs, or research",
              "Missing threat actor, campaign, or tool family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The query avoids leading wildcards and uses specific endswith/contains operators, but the logsource is limited to Linux while Windows utilities are also queried, and there is no EventID filter to leverage indexing.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "No leading wildcards; operators are specific",
              "Simple Boolean logic without heavy regex"
            ],
            "weaknesses": [
              "Mismatched logsource (Linux only) for Windows selections",
              "Missing EventID/other indexed fields to improve performance"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures a few common utilities (getpwuid, wmic, schtasks, bitsadmin) but omits many other legitimate user\u2011discovery commands and does not map to sub\u2011techniques or advanced frameworks.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Cross\u2011platform coverage (Linux and Windows)",
              "Targets known discovery utilities"
            ],
            "weaknesses": [
              "Limited set of techniques; missing common commands like whoami, net user, PowerShell Get\u2011LocalUser",
              "No coverage of sub\u2011techniques or custom/adversary\u2011specific tools"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The only exclusion is based on parent process (cmd.exe/powershell.exe), which is too broad and does not address legitimate usage paths, user accounts, or frequency patterns, leading to potential high false\u2011positive rates.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Attempts to filter out common shell parents"
            ],
            "weaknesses": [
              "No path, user, or frequency based whitelisting",
              "Guidance on false positives is generic and not actionable"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures known techniques (getpwuid, wmic, schtasks, bitsadmin) that adversaries use for user discovery, but it lacks concrete references to specific threat actors, campaigns, or nuanced usage patterns that would demonstrate deeper contextual insight.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Identifies legitimate LOLBins commonly abused for discovery",
              "Maps to ATT&CK technique T1033 (System Owner/User Discovery)"
            ],
            "weaknesses": [
              "No attribution to real\u2011world adversary groups or campaigns",
              "Missing details on typical parameters, timing, or target environments"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma syntax appears incomplete (truncated sections, mismatched logsource product vs. Windows utilities) which would cause deployment failures, and the rule may generate many false positives without additional filtering.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Uses simple field matches that are supported by most SIEMs",
              "Provides a clear severity level (medium) for triage"
            ],
            "weaknesses": [
              "Inconsistent logsource (Linux only) while detecting Windows binaries",
              "Potential syntax errors and lack of tested validation"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are concise, but the rule does not surface enriched context (e.g., user, host, hash) that would help analysts pivot quickly, and it lacks remediation guidance.",
          "confidence": 0.77,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Clear, descriptive title indicating the discovery activity",
              "Includes a false\u2011positive guidance section"
            ],
            "weaknesses": [
              "Limited observable fields; no additional indicators for investigation",
              "No recommended response steps or links to ATT&CK documentation"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on static indicators (executable name, command\u2011line string). Renaming the binaries or invoking the same functionality via alternative scripts would bypass the rule, and there is no behavioral correlation to mitigate such evasion.",
          "confidence": 0.74,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBins, increasing coverage breadth",
              "Excludes common shells to reduce noise"
            ],
            "weaknesses": [
              "Easily evaded by renaming or using alternative utilities",
              "No multi\u2011vector or behavior\u2011based detection components"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only monitors a single event type (process creation) and flags immediate execution of discovery utilities. It does not address persistence, lateral movement, or downstream data collection/exfiltration, nor does it correlate events across stages of an attack.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:06:23.530378",
          "metadata": {
            "strengths": [
              "Covers both Linux (getpwuid) and Windows discovery utilities in one rule",
              "Excludes common shell parents to reduce false positives"
            ],
            "weaknesses": [
              "Limited to initial execution; no detection of persistence mechanisms using these utilities",
              "No correlation or sequencing of events to identify multi\u2011stage activity"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (System Owner/User Discovery via getpwuid and System Utilities) scored 0.38/1.0 (Poor). Best performance in realism (0.44). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:06:23.530891",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "System Owner/User Discovery via getpwuid and System Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4516666666666666,
      "category_scores": {
        "correctness": 0.36000000000000004,
        "quality": 0.4647058823529412,
        "effectiveness": 0.4666666666666667,
        "realism": 0.6000000000000001,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides title, logsource, detection, tags, falsepositives and level, but omits required fields such as id, description, references, author, date and status, which are essential for a complete Sigma rule.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Includes core sections (title, logsource, detection, tags)",
              "Provides falsepositive guidance"
            ],
            "weaknesses": [
              "Missing mandatory metadata (id, description, author, date, status, references)",
              "Fields appear as placeholders or are absent"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The logic attempts to catch proc_none and generic enumeration tools, but the technique (Application Window Discovery) is not accurately represented, leading to potential mismatches and over\u2011broad alerts.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Combines multiple tool detections in a single rule",
              "Adds parent\u2011process exclusions to reduce obvious noise"
            ],
            "weaknesses": [
              "Technique mapping is inaccurate \u2013 wmic/schtasks/bitsadmin are not typical for window enumeration",
              "Insufficient contextual filters; many legitimate uses will fire"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies on exact executable names without deeper context, resulting in a high likelihood of false positives from normal administrative activity.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Uses exact image name matching to avoid generic wildcards",
              "Excludes two common parent processes"
            ],
            "weaknesses": [
              "Broad inclusion of wmic, schtasks, bitsadmin captures routine admin tasks",
              "Lacks additional context (user, command line arguments, specific flags) to narrow scope"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While the rule covers several utilities, it does not handle renamed binaries, varied command\u2011line arguments, or case\u2011insensitive matching, limiting its ability to detect evasive variants.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Covers multiple common utilities and a custom proc_none binary",
              "Detects both proc_none via image and command line"
            ],
            "weaknesses": [
              "No regex or case\u2011insensitive matching for variations",
              "Fails to detect renamed or moved executables that perform the same function"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a brief description, but lacks detailed references, tactic/sub\u2011technique identifiers, threat actor or campaign context, and associated tool/malware information.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK technique tag",
              "Provides a concise description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing authoritative references and detailed tactic/sub\u2011technique metadata",
              "No threat actor, campaign, or associated tool information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection uses specific `endswith` and `contains` operators without leading wildcards and avoids complex regex, making it efficient, but it omits an EventID filter that would further improve SIEM indexing.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses simple operators",
              "Logical condition is straightforward and low\u2011cost"
            ],
            "weaknesses": [
              "No EventID (Sysmon 1) filter to limit scope",
              "Parent exclusions are minimal, potentially increasing query load"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a few common enumeration utilities and a custom `proc_none` binary, yet it misses many other legitimate vectors (e.g., PowerShell, tasklist, UI automation tools) and does not address sub\u2011techniques or advanced frameworks.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Covers several widely\u2011used Windows enumeration tools",
              "Includes a custom binary that may be used by adversaries"
            ],
            "weaknesses": [
              "Limited to a narrow set of tools, omitting many relevant techniques",
              "No coverage of sub\u2011techniques or advanced adversary frameworks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Parent\u2011process exclusions reduce some noise, and false\u2011positive notes are provided, but the rule still flags routine administrative use of wmic, schtasks, and bitsadmin without additional context such as user, path, or frequency filters.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Implements parent\u2011process exclusions",
              "Provides explicit false\u2011positive guidance"
            ],
            "weaknesses": [
              "Lacks user/account, path, or time\u2011based whitelisting",
              "No frequency or correlation logic to suppress benign activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a set of known enumeration tools but does not reference specific threat actor campaigns or detailed usage patterns for Application Window Discovery, making it only moderately aligned with real\u2011world TTPs.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBins commonly abused for discovery",
              "Includes parent\u2011process exclusions to add some context"
            ],
            "weaknesses": [
              "Lacks concrete threat\u2011actor or campaign references",
              "Treats the technique generically without detailing typical parameters or timing"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is largely correct and targets Sysmon process_creation events that are widely available, but the rule may generate a noticeable false\u2011positive volume and the snippet appears partially truncated, indicating possible implementation gaps.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Uses realistic logsource (Sysmon) and common fields",
              "Provides a medium severity level and FP guidance"
            ],
            "weaknesses": [
              "Potentially high alert noise from legitimate admin scripts",
              "Rule excerpt is incomplete, suggesting deployment testing may be needed"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "Alert titles and descriptions are clear and include FP mitigation notes, yet the rule surfaces limited investigative data (no user, hash, or network context) and offers no concrete response steps.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Includes false\u2011positive guidance for analysts"
            ],
            "weaknesses": [
              "Missing richer fields (e.g., user, file hash) for deeper triage",
              "No remediation or next\u2011step recommendations in the rule"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Detection relies heavily on static executable names and simple command\u2011line strings, which can be evaded by renaming binaries or using alternative LOLBins; there is no behavioral correlation or multi\u2011vector coverage.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Covers several LOLBins rather than a single tool",
              "Filters out common parent processes to reduce noise"
            ],
            "weaknesses": [
              "Easy to bypass by renaming or using other native utilities",
              "Lacks behavior\u2011based indicators or additional telemetry (network, file writes)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only captures the initial execution of enumeration utilities and does not address later stages such as persistence, lateral movement, or data exfiltration. It lacks correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:06:58.417963",
          "metadata": {
            "strengths": [
              "Detects multiple common enumeration tools in a single rule",
              "Includes parent process exclusions to reduce obvious false positives"
            ],
            "weaknesses": [
              "Limited to a single event type (process creation) and does not cover persistence or lateral movement",
              "No mechanism to correlate sequential events or track the technique across stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1010 (Application Window Discovery via proc_none and Common Enumeration Tools) scored 0.45/1.0 (Poor). Best performance in realism (0.60). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:06:58.417963",
      "metadata": {
        "attack_id": "attack.t1010",
        "technique_name": "Application Window Discovery via proc_none and Common Enumeration Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.38833333333333336,
      "category_scores": {
        "correctness": 0.32,
        "quality": 0.4294117647058823,
        "effectiveness": 0.43333333333333335,
        "realism": 0.4,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule omits several mandatory Sigma fields such as id, status, description, references, author, and date. Existing fields are present but many are placeholders or missing, reducing its readiness for production.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Includes core fields like title, logsource, detection, falsepositives, and level",
              "Provides MITRE ATT&CK tags and technique name"
            ],
            "weaknesses": [
              "Missing required metadata (id, status, description, author, date, references)",
              "Fields that exist are not fully populated or lack detail"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The selections loosely map to the System Time Discovery technique but rely on generic command strings (e.g., \"time\" or \"/query\") that trigger on many benign activities. The exclusion only checks for a cmd.exe parent, which is insufficient to reduce noise.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Covers multiple legitimate tools (cmd, PowerShell, wmic, schtasks, bitsadmin)",
              "Uses explicit Image|endswith filters to limit to known executables"
            ],
            "weaknesses": [
              "CommandLine|contains patterns are overly broad and generate false positives",
              "Exclusion logic is minimal and does not address common legitimate scenarios"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule\u2019s broad string matches and lack of contextual filters (user, parent process beyond cmd.exe, or command arguments) make it prone to alert on routine administration tasks. Specificity is therefore low for a production environment.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Attempts to filter out parent cmd.exe processes",
              "Separates detections per tool, allowing future fine\u2011tuning"
            ],
            "weaknesses": [
              "No granular filters for legitimate scheduled\u2011task queries or time\u2011sync utilities",
              "Relies on generic keywords that appear in many normal commands"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several common utilities that attackers might use for time discovery, providing reasonable coverage. However, it misses variations such as encoded PowerShell commands, renamed binaries, or alternative flags, limiting its ability to detect evasive techniques.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Includes multiple command\u2011line tools to broaden coverage",
              "Uses case\u2011insensitive contains matching suitable for Windows"
            ],
            "weaknesses": [
              "Does not account for renamed or moved executables",
              "Fails to detect obfuscated or encoded command lines (e.g., PowerShell -EncodedCommand)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic tags and a short description, but lacks detailed MITRE ATT&CK references, tactic/sub\u2011technique identifiers, threat\u2011actor or campaign context, and supporting external sources.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Includes ATT&CK technique tag (attack.t1124)",
              "Provides a concise description of the detection goal"
            ],
            "weaknesses": [
              "Missing explicit tactic/sub\u2011technique metadata and authoritative references",
              "No threat\u2011actor, campaign, or tool attribution information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses indexed fields with endswith/contains operators and avoids leading wildcards, but it does not filter on EventID and the parent\u2011process exclusion is overly broad, which could affect performance and accuracy.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Uses specific Image|endswith and CommandLine|contains filters without leading wildcards",
              "Logical grouping of detection clauses keeps the query readable"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) filter to limit scope",
              "ParentImage exclusion is generic and may miss legitimate cases"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several common utilities (cmd, PowerShell, wmic, schtasks, bitsadmin) for time discovery, yet it omits other frequent methods (date, net time, w32tm, systeminfo) and does not address custom or framework\u2011specific tools.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Covers multiple native Windows binaries that can reveal system time",
              "Includes both cmd.exe and PowerShell execution paths"
            ],
            "weaknesses": [
              "Fails to detect alternative commands (e.g., date, w32tm) and sub\u2011technique variations",
              "Does not consider adversary frameworks (Cobalt Strike, Empire) that may use scripted time queries"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only excludes processes whose parent is cmd.exe, which is insufficient; many legitimate administrative scripts will trigger alerts, and there is no user, path, or frequency\u2011based filtering to curb noise.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Provides a list of expected false\u2011positive scenarios in the metadata",
              "Attempts a simple parent\u2011process exclusion"
            ],
            "weaknesses": [
              "Lacks granular whitelisting (e.g., known admin accounts, system directories)",
              "No temporal or frequency thresholds to differentiate benign from malicious activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common legitimate commands used for system time discovery, reflecting the ATT&CK technique. However, it lacks references to specific threat actor behaviors, campaigns, or nuanced usage patterns beyond textbook examples.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBin utilities (cmd, PowerShell, wmic, schtasks, bitsadmin).",
              "Aligns with the ATT&CK T1124 technique description."
            ],
            "weaknesses": [
              "No attribution to real-world adversary tooling or campaigns.",
              "Missing contextual details such as typical timing or target environments."
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma syntax is mostly correct and uses Sysmon process creation, which is widely available, but the rule is incomplete (truncated schtasks clause) and likely to generate high false positives due to generic \"time\" searches. Validation evidence is minimal.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Uses a common log source (Sysmon) that is present in many enterprises.",
              "Provides a clear severity level (medium)."
            ],
            "weaknesses": [
              "Potential syntax/definition errors (incomplete detection block).",
              "Broad command\u2011line matching may cause excessive alerts."
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The alert title and description are concise, but the rule does not surface enriched fields (user, host, PID) that aid investigation, nor does it give guidance on response steps. This limits immediate triage effectiveness.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Title clearly states the observed behavior.",
              "False\u2011positive guidance is provided."
            ],
            "weaknesses": [
              "Limited contextual fields for pivoting (e.g., no user or parent process details beyond exclusion).",
              "No recommended investigative or remediation actions."
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on exact command\u2011line strings, making it easy for adversaries to evade by using alternative flags, encoded commands, or different utilities. Renaming LOLBins or using PowerShell obfuscation would bypass the rule.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Covers several LOLBin executables, increasing coverage breadth.",
              "Includes an exclusion to reduce noise from parent cmd processes."
            ],
            "weaknesses": [
              "Static string matching is vulnerable to simple obfuscation or alternative syntax.",
              "No behavioral correlation (e.g., timing of multiple queries) to strengthen detection."
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only flags the moment a process runs a time\u2011query command. It does not track persistence mechanisms, lateral movement, or downstream actions that might follow the discovery, nor does it correlate multiple related events.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:07:33.196687",
          "metadata": {
            "strengths": [
              "Covers several common command\u2011line utilities (cmd, PowerShell, wmic, schtasks, bitsadmin).",
              "Includes a parent\u2011process exclusion to reduce obvious false positives."
            ],
            "weaknesses": [
              "Limited to single\u2011event detection; no linkage across attack stages.",
              "Does not address persistence or lateral movement vectors that could reuse the same technique."
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (System Time Discovery via Command-Line Tools) scored 0.39/1.0 (Poor). Best performance in effectiveness (0.43). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:07:33.196687",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "System Time Discovery via Command-Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.3516666666666666,
      "category_scores": {
        "correctness": 0.36000000000000004,
        "quality": 0.388235294117647,
        "effectiveness": 0.34,
        "realism": 0.4444444444444444,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule contains the core fields (title, logsource, detection, falsepositives, level, tags) but omits required metadata such as id, status, description, references, author, and date, making it incomplete for production use.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Provides essential detection sections (logsource, detection, falsepositives).",
              "Includes MITRE ATT&CK tag for the technique."
            ],
            "weaknesses": [
              "Missing mandatory Sigma metadata (id, status, description, references, author, date).",
              "Tags are limited; no reference URLs or versioning information."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The logic attempts to capture unlink/proc_rmfile usage but relies on Windows cmd.exe containing the literal string \"unlink\", which is uncommon. The condition mixes several unrelated tools (wmic, schtasks, bitsadmin) with a simple delete keyword, reducing relevance to the specific technique.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Uses a clear OR condition to combine multiple selections.",
              "Excludes processes launched from explorer.exe to cut obvious benign cases."
            ],
            "weaknesses": [
              "Selection criteria do not accurately reflect typical Windows file\u2011deletion commands (e.g., \"del\", PowerShell Remove\u2011Item).",
              "The parent\u2011process exclusion is too narrow and may miss legitimate admin contexts."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies on broad \"contains\" matches for command lines and only a single parent\u2011process filter, leading to many potential false positives from routine administrative scripts.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Limits image matches to known executables (cmd.exe, powershell.exe, etc.).",
              "Applies a simple exclusion to reduce obvious noise."
            ],
            "weaknesses": [
              "\"contains\" on generic terms like \"delete\" captures normal maintenance operations.",
              "No additional context (user, integrity level, file path) to narrow alerts."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule covers only a narrow set of strings and does not account for variations such as encoded commands, alternative deletion utilities, or PowerShell aliases, making it easy for attackers to evade.",
          "confidence": 0.87,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Covers multiple utilities (wmic, schtasks, bitsadmin) that can perform deletions.",
              "Detects both cmd.exe and PowerShell invocations."
            ],
            "weaknesses": [
              "Lacks regex or case\u2011insensitive matching for command\u2011line variations.",
              "Does not include Sysmon FileDelete events, which are more reliable for file\u2011deletion detection."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes basic MITRE ATT&CK tags and a clear description, but lacks deeper context such as threat actor references, campaign names, or additional authoritative sources.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Correct ATT&CK technique and tactic tags",
              "Concise description of what is being detected"
            ],
            "weaknesses": [
              "No references to vendor blogs, CVEs, or detailed research",
              "Missing threat actor, campaign, or malware family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses indexed fields and avoids leading wildcards, but it omits an EventID filter and relies on generic 'contains' which can increase noise and processing load.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Uses endswith and contains without leading wildcards",
              "Simple, flat detection logic without heavy regex"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) filter to limit scope",
              "Broad 'contains' on CommandLine may cause unnecessary scans"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures a few common deletion utilities but misses many legitimate and malicious file\u2011deletion vectors (PowerShell Remove\u2011Item, del.exe, native API calls, custom tools).",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Covers unlink via cmd.exe and proc_rmfile via PowerShell",
              "Includes WMIC, schtasks, and bitsadmin delete commands"
            ],
            "weaknesses": [
              "Does not address other native deletion commands (del, Remove\u2011Item)",
              "Lacks coverage of API\u2011level deletions captured by Sysmon FileDelete events"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Only a single parent\u2011process exclusion (explorer.exe) is used; there are no user, path, or frequency filters, leading to a high likelihood of benign alerts.",
          "confidence": 0.79,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Implements a basic parent\u2011process exclusion",
              "Specifies common legitimate scenarios in the false\u2011positive notes"
            ],
            "weaknesses": [
              "No user, service account, or path whitelisting",
              "Lacks temporal or count\u2011based logic to suppress isolated benign deletions"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule tries to capture file\u2011deletion activity but focuses on unlikely command\u2011line patterns (e.g., \"unlink\" in cmd.exe) and a non\u2011standard PowerShell function, which do not reflect how adversaries typically invoke the Unlink API or Proc_Rmfile. It does list some common LOLBins, yet it lacks references to real campaigns or attacker preferences.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Includes multiple LOLBin utilities (wmic, schtasks, bitsadmin).",
              "Attempts to filter out benign parent processes."
            ],
            "weaknesses": [
              "Detection logic does not match realistic attacker behavior.",
              "No campaign or threat\u2011actor context is provided."
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma syntax is valid and uses Sysmon process_creation, which is widely available, but the rule is likely to generate many false positives and miss real deletions because the command\u2011line strings are uncommon. The exclusion of only explorer.exe is insufficient for production environments.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Uses a common log source (Sysmon).",
              "Provides a simple exclusion to reduce some noise."
            ],
            "weaknesses": [
              "High false\u2011positive potential from legitimate delete scripts.",
              "Unrealistic command\u2011line conditions limit detection coverage."
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description are clear, and MITRE tags are included, giving analysts a quick view of the technique. However, the alert lacks enriched fields (user, hash, file path) and concrete response guidance, limiting immediate investigative value.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Clear, concise title and description.",
              "MITRE ATT&CK tagging for easy mapping."
            ],
            "weaknesses": [
              "Limited contextual data for triage.",
              "No remediation or investigation playbook references."
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule depends almost entirely on static command\u2011line strings, making it easy for adversaries to evade by renaming executables, using encoded PowerShell, or invoking native API calls directly. It does not incorporate behavioral or multi\u2011event correlation.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Covers several LOLBin utilities.",
              "Attempts a simple parent\u2011process exclusion."
            ],
            "weaknesses": [
              "Easily bypassed via renaming or obfuscation.",
              "Lacks detection of underlying API calls or file\u2011system events."
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only flags single process creation events that invoke specific delete commands, lacking coverage of persistence, lateral movement, or impact phases. It does not correlate multiple related events, so it cannot track the technique across an attack lifecycle.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:08:07.382481",
          "metadata": {
            "strengths": [
              "Targets several common deletion utilities (cmd, PowerShell, wmic, schtasks, bitsadmin).",
              "Includes a simple benign-parent exclusion to reduce obvious false positives."
            ],
            "weaknesses": [
              "Limited to one-stage detection; no monitoring of file deletion events or subsequent impact actions.",
              "Fails to correlate with persistence or lateral movement activities that may use the same technique."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1070.004 (File Deletion via Unlink API or Proc_Rmfile Function) scored 0.35/1.0 (Poor). Best performance in realism (0.44). Needs improvement in detectability (0.20). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:08:07.382481",
      "metadata": {
        "attack_id": "attack.t1070.004",
        "technique_name": "File Deletion via Unlink API or Proc_Rmfile Function",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.455,
      "category_scores": {
        "correctness": 0.48,
        "quality": 0.4647058823529412,
        "effectiveness": 0.46,
        "realism": 0.5555555555555556,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes core fields like title, description, logsource, detection, falsepositives, level, and tags, but omits required Sigma metadata such as id, status, references, author, and date, which are essential for a production\u2011ready rule.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Provides essential detection fields (title, logsource, detection, falsepositives).",
              "Includes MITRE ATT&CK tagging and level indication."
            ],
            "weaknesses": [
              "Missing mandatory Sigma metadata (id, status, author, date, references).",
              "No explicit versioning or documentation fields."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly combines selections for proc_getcfg and three common utilities with a NOT parent filter, but the parent exclusion is simplistic and may miss malicious use cases or generate false positives from other benign parents.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Clear OR condition for multiple relevant tools.",
              "Uses a NOT clause to reduce obvious benign launches."
            ],
            "weaknesses": [
              "Parent exclusion only covers a few processes, leaving many legitimate launches unfiltered.",
              "No additional context (e.g., command line arguments) to verify malicious intent."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule uses exact filename matches, it lacks finer granularity such as argument patterns, user context, or path restrictions, leading to potential alerts from routine administrative tasks.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Exact filename matching reduces broad wildcard matches.",
              "Targets a narrow set of utilities associated with input capture."
            ],
            "weaknesses": [
              "No filtering based on command\u2011line arguments or execution context.",
              "Parent filter is insufficient to eliminate common legitimate usage."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several relevant tools and the proc_getcfg indicator, improving coverage, but it does not address evasion techniques like renamed binaries, PowerShell wrappers, or encoded commands, limiting its ability to detect variant attacks.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Covers multiple utilities that attackers may use for input capture.",
              "Includes a generic proc_getcfg string search."
            ],
            "weaknesses": [
              "Lacks regex or wildcard handling for renamed or obfuscated binaries.",
              "Does not consider indirect execution paths (e.g., PowerShell invoking bitsadmin)."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic metadata (title, description, tags) but lacks specific MITRE ATT&CK identifiers, authoritative references, threat actor or campaign context, and associated malware/tool details. The description is brief and does not fully explain the proc_getcfg function.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Includes basic ATT&CK tag and technique name",
              "Provides false\u2011positive guidance and SIEM verification details"
            ],
            "weaknesses": [
              "Missing precise ATT&CK technique/sub\u2011technique IDs (e.g., T1056.001)",
              "No external references, threat actor or campaign information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The detection uses indexed fields (Image, CommandLine) with efficient endswith operators and avoids leading wildcards. However, it omits an EventID filter (Sysmon EventID\u202f1) and relies on a generic 'contains' which can be less performant.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Uses specific endswith filters for executable names",
              "Avoids leading wildcards and complex regex"
            ],
            "weaknesses": [
              "No EventID restriction to limit scope to process creation events",
              "'contains' on CommandLine may increase scan overhead"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule targets a narrow slice of Input Capture (proc_getcfg and three command\u2011line utilities) and does not address broader sub\u2011techniques (e.g., keylogging, clipboard capture) or other commonly abused tools.",
          "confidence": 0.79,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Covers specific utilities known to be abused for input capture",
              "Includes detection of a less\u2011common function (proc_getcfg)"
            ],
            "weaknesses": [
              "Limited to a few tools, missing many legitimate Input Capture vectors",
              "No coverage of sub\u2011techniques or advanced frameworks (e.g., Cobalt Strike, Empire)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "Excluding common parent processes reduces some noise, but legitimate use of wmic, schtasks, and bitsadmin often originates from those same parents, potentially causing both false positives and false negatives. No time\u2011based or frequency logic is applied.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Implements parent\u2011process exclusion to cut obvious benign activity",
              "Provides a list of typical false\u2011positive scenarios"
            ],
            "weaknesses": [
              "Exclusion may also suppress legitimate admin activity, reducing detection efficacy",
              "Lacks additional context (user, path, frequency) to further filter noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets known LOLBins (wmic, schtasks, bitsadmin) and a specific function (proc_getcfg) linked to input capture, which aligns with ATT&CK T1056. However, it lacks references to specific threat actors, campaigns, or nuanced usage patterns, limiting its contextual depth.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Maps to a legitimate ATT&CK technique (Input Capture).",
              "Includes a rare function (proc_getcfg) that may indicate specialized malware."
            ],
            "weaknesses": [
              "No attribution to real\u2011world adversary groups or campaigns.",
              "Broad tool selection without detailing typical malicious parameters or timing."
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is valid and uses common Sysmon fields, making deployment feasible. Nevertheless, the rule may generate many alerts from legitimate admin activity and the high severity could increase alert fatigue.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Correct logsource definition for Sysmon process creation.",
              "Simple, low\u2011overhead detection logic suitable for most Windows environments."
            ],
            "weaknesses": [
              "Potentially high false\u2011positive rate due to everyday use of the listed binaries.",
              "Excludes only a few benign parents, missing many legitimate contexts."
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description convey the intent, and the rule surfaces key fields (Image, CommandLine, ParentImage) useful for investigation. However, it provides limited guidance on triage steps or remediation, and the false\u2011positive notes are generic.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Provides clear observable fields for immediate pivoting.",
              "Highlights the technique (Input Capture) to aid prioritization."
            ],
            "weaknesses": [
              "Lacks concrete response playbook or enrichment suggestions.",
              "False\u2011positive guidance does not include mitigation tactics."
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on static indicators (executable name and a specific string in the command line). Renaming the binaries or wrapping the functionality in another process would bypass the rule, and there is no multi\u2011vector correlation (e.g., network or file activity).",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBins, increasing coverage breadth.",
              "Includes a rare function (proc_getcfg) that is harder to spoof."
            ],
            "weaknesses": [
              "Easily evaded by binary renaming or using alternative tools.",
              "No behavioral or contextual enrichment to counter obfuscation."
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only flags a single process creation event (proc_getcfg or specific utilities) and does not cover later stages such as persistence, lateral movement, or data exfiltration. It lacks correlation across related events, limiting its ability to track the technique throughout an attack lifecycle.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:08:41.472115",
          "metadata": {
            "strengths": [
              "Targets known command\u2011line tools used for input capture",
              "Excludes common benign parent processes to reduce false positives"
            ],
            "weaknesses": [
              "Detects only the initial execution, missing persistence or lateral movement indicators",
              "No correlation logic to link multiple stages or related artifacts"
            ]
          }
        }
      ],
      "summary": "Rule for attack.collection (Detection of Input Capture via proc_getcfg and Common Command-line Tools) scored 0.46/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_specificity, detection_sensitivity",
      "timestamp": "2025-12-20T16:08:41.472115",
      "metadata": {
        "attack_id": "attack.collection",
        "technique_name": "Detection of Input Capture via proc_getcfg and Common Command-line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4633333333333333,
      "category_scores": {
        "correctness": 0.42000000000000004,
        "quality": 0.4764705882352942,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes title, logsource, detection, falsepositives, level, and some tags, but omits required fields such as id, status, description, references, author, and date. Tags are incomplete and lack explicit MITRE ATT&CK identifiers.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Core sections (title, logsource, detection, falsepositives) are present",
              "Relevant tags and MITRE tactic are included"
            ],
            "weaknesses": [
              "Missing mandatory Sigma metadata (id, status, description, author, date)",
              "Tags are not exhaustive; no explicit ATT&CK technique ID"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection logic captures several command\u2011line utilities and filters out obvious benign parents, but the condition mixes generic and specific selections inconsistently and may miss legitimate C2 variants or generate false negatives due to the parent filter.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Covers multiple utilities (PowerShell, WMIC, schtasks, bitsadmin)",
              "Uses an explicit NOT clause to reduce obvious benign launches"
            ],
            "weaknesses": [
              "Parent filter excludes cmd.exe, which is also a legitimate generic selector, causing potential gaps",
              "Specific strings (e.g., \"Invoke-WebRequest\") are too narrow and can be evaded"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on broad \"contains\" checks (http://, -enc, etc.) that are common in legitimate administration scripts, leading to a high false\u2011positive risk. Contextual exclusions are limited.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Attempts to filter out common benign parents",
              "Includes generic network\u2011protocol indicators"
            ],
            "weaknesses": [
              "Broad string matches generate noise (e.g., any PowerShell script with \"-enc\")",
              "Insufficient exclusion of legitimate automation tools and scheduled\u2011task contexts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several typical C2 usage patterns and encoded commands, improving coverage, but it may miss variants that use alternative PowerShell networking cmdlets or renamed utilities.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Covers multiple command\u2011line tools and encoded command flags",
              "Detects both HTTP/HTTPS and FTP transfer patterns"
            ],
            "weaknesses": [
              "Limited to specific substrings (e.g., \"Invoke-WebRequest\"), missing other legitimate C2 techniques",
              "Does not account for renamed or moved binaries, reducing resilience to simple evasion"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides basic metadata (title, description, tags) but the ATT&CK tagging is incomplete and there are no references, actor or campaign information, nor detailed tool/malware associations.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Includes a brief description and false\u2011positive guidance",
              "Provides at least one MITRE ATT&CK tag"
            ],
            "weaknesses": [
              "Missing precise ATT&CK technique/sub\u2011technique IDs and tactic",
              "No external references, threat\u2011actor or campaign context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule avoids leading wildcards and uses endswith/contains efficiently, but it lacks an EventID filter and the generic selection is broad, which can impact SIEM performance.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "No leading wildcards; uses specific endswith for Image",
              "Parent\u2011process exclusion reduces some noise"
            ],
            "weaknesses": [
              "Missing Sysmon EventID filter (e.g., EventID 1) for indexing",
              "Generic selection with URL strings may generate many matches"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several common command\u2011line utilities used for application\u2011layer C2, yet it omits many sub\u2011techniques, alternative tools (curl, certutil, etc.) and advanced frameworks like Cobalt Strike or Empire.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Covers PowerShell, WMIC, schtasks, and BITS \u2013 frequent abuse vectors",
              "Generic URL/encoded\u2011command detection adds breadth"
            ],
            "weaknesses": [
              "Limited to a small set of utilities; many legitimate C2 tools are not covered",
              "No explicit mapping to ATT&CK sub\u2011techniques (e.g., T1059.001, T1105)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While a parent\u2011process exclusion and false\u2011positive notes are present, the rule still relies on broad string matches and lacks user, path, or frequency\u2011based filters, leading to potential high noise.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Parent\u2011process exclusion for explorer.exe and cmd.exe",
              "Provides a list of typical legitimate scenarios in false\u2011positives"
            ],
            "weaknesses": [
              "Generic URL/encoded\u2011command detection can trigger on normal admin scripts",
              "No time\u2011based or frequency logic, and limited whitelisting of legitimate accounts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common abuse patterns (PowerShell Invoke-WebRequest, WMIC remote queries, BITS transfers) that map to real-world C2 techniques, but it lacks explicit references to specific campaigns or attacker preferences that would deepen contextual relevance.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Includes multiple LOLBins known to be leveraged for application\u2011layer C2",
              "Covers both explicit URL usage and encoded command indicators"
            ],
            "weaknesses": [
              "No citation of threat\u2011actor groups or historic incidents",
              "Missing nuance such as timing, target hosts, or typical payload sizes"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is largely correct and uses Sysmon process creation events that are widely available, yet the rule may generate many alerts due to broad generic matches and a high severity level, and the parent\u2011process exclusion is limited.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon fields that are present in most enterprise deployments",
              "Provides a clear exclusion for common benign parents (explorer, cmd)"
            ],
            "weaknesses": [
              "Broad generic selection (e.g., any command line containing \"http://\") can cause high false\u2011positive rates",
              "Severity set to high may lead to alert fatigue without further tuning"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are concise, but the rule does not surface key investigative fields such as user, source IP, or file hash, limiting the analyst\u2019s ability to pivot quickly.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Title clearly states the abuse of command\u2011line tools for C2",
              "Provides a list of typical false\u2011positive scenarios to aid triage"
            ],
            "weaknesses": [
              "Lacks enrichment data (e.g., network endpoints, hashes) for deeper investigation",
              "No guidance or references for remediation steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on static command\u2011line strings and executable names, which can be evaded by renaming binaries, using alternative LOLBins, or hiding arguments via scripts, reducing its robustness against skilled adversaries.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Covers encoded PowerShell flags (\u2011enc, \u2011EncodedCommand)",
              "Matches multiple tools, increasing coverage beyond a single binary"
            ],
            "weaknesses": [
              "Executable name checks (endswith) are bypassable by renaming or using symlinks",
              "No correlation with network or file\u2011write events to confirm actual C2 traffic"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures the initial execution of suspicious command\u2011line utilities and includes a generic pattern for network URLs, which helps detect early C2 activity. However, it does not explicitly link to persistence mechanisms, lateral movement, or exfiltration stages, nor does it correlate multiple events across the attack lifecycle.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:15.625932",
          "metadata": {
            "strengths": [
              "Covers several commonly abused utilities (PowerShell, WMIC, schtasks, bitsadmin).",
              "Adds a generic URL/encoded\u2011command check and excludes obvious benign parents to lower false positives."
            ],
            "weaknesses": [
              "Limited to single\u2011event detection; no correlation of related stages (e.g., scheduled task creation followed by execution).",
              "Does not explicitly address persistence, lateral movement, or data exfiltration aspects of the technique."
            ]
          }
        }
      ],
      "summary": "Rule for attack.command_and_control (Abuse of Command-Line Tools for Application Layer C2) scored 0.46/1.0 (Poor). Best performance in realism (0.50). Needs improvement in detectability (0.40). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:09:15.626436",
      "metadata": {
        "attack_id": "attack.command_and_control",
        "technique_name": "Abuse of Command-Line Tools for Application Layer C2",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.43499999999999994,
      "category_scores": {
        "correctness": 0.45999999999999996,
        "quality": 0.44705882352941173,
        "effectiveness": 0.42000000000000004,
        "realism": 0.5444444444444445,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes core fields like title, logsource, detection, falsepositives, level, and tags, but omits several mandatory Sigma metadata such as id, status, description (in the Sigma block), references, author, and date. This makes the rule incomplete for sharing and versioning.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:49.643241",
          "metadata": {
            "strengths": [
              "Contains essential detection sections (logsource, detection, condition).",
              "Provides falsepositive guidance and MITRE ATT&CK tagging."
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references).",
              "Description is present only outside the Sigma block, not as a formal Sigma field."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic captures known injection\u2011related command\u2011line utilities and excludes common shells, which aligns with the technique. However, the use of simple \"contains\" matches and a limited parent\u2011process whitelist can cause both missed detections and false alerts.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Targets multiple legitimate injection tools (wmic, schtasks, bitsadmin).",
              "Combines selections with an explicit NOT on typical shell parents."
            ],
            "weaknesses": [
              "Relies on case\u2011sensitive \"contains\" which may miss variations.",
              "Parent\u2011process exclusion is too narrow, allowing many benign cases."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is overly broad; any command line containing the listed strings will fire, even when run by legitimate automation or admin scripts. The parent\u2011process filter excludes only three shells, leaving many legitimate contexts unchecked, leading to high false\u2011positive risk.",
          "confidence": 0.65,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Uses an explicit NOT filter to reduce obvious noise from shells.",
              "Lists specific command\u2011line keywords rather than generic patterns."
            ],
            "weaknesses": [
              "\"contains\" matches generate many benign hits (e.g., scheduled tasks).",
              "Insufficient contextual filters (user, integrity level, command line arguments)."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule covers several common utilities used for injection, providing decent coverage of typical attacker tooling. Yet it lacks mechanisms to catch obfuscated, renamed, or encoded variants, limiting its ability to detect more sophisticated evasion.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Covers multiple utilities that attackers frequently abuse for injection.",
              "Aggregates several selections with an OR, increasing coverage."
            ],
            "weaknesses": [
              "No regex or case\u2011insensitive matching to capture variations.",
              "Does not account for renamed binaries or PowerShell\u2011encoded commands."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic metadata such as title, description, tags, and a technique name, but lacks deeper context like sub\u2011technique IDs, authoritative references, threat\u2011actor or campaign information, and detailed tool/malware associations.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag and technique name",
              "Provides a clear description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing sub\u2011technique identifiers and external references",
              "No threat\u2011actor, campaign, or malware family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule avoids leading wildcards and uses simple 'contains' and 'endswith' operators, but it does not filter on indexed fields like EventID (e.g., Sysmon EventID 1) and relies on potentially expensive string searches across the entire CommandLine field.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "No leading wildcards; operators are simple",
              "ParentImage exclusion is indexed and efficient"
            ],
            "weaknesses": [
              "Lacks EventID or other indexed field filters",
              "Using 'contains' on CommandLine can be performance\u2011heavy"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection focuses on a narrow set of command\u2011line utilities and a single internal function, missing many common process\u2011injection vectors (e.g., PowerShell, rundll32, reflective DLL loading) and sub\u2011techniques, limiting its overall coverage.",
          "confidence": 0.79,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Targets known injection\u2011related utilities (wmic, schtasks, bitsadmin)",
              "Covers a low\u2011level function (_pthread_create) used in some custom tools"
            ],
            "weaknesses": [
              "Does not address broader injection techniques or sub\u2011techniques",
              "Excludes popular adversary frameworks (Cobalt Strike, Metasploit, etc.)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While the rule excludes typical shell parents, legitimate administrative scripts and system maintenance tools frequently invoke the listed utilities, leading to a high false\u2011positive rate; there are no user, path, or frequency\u2011based mitigations.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Adds a parent\u2011process exclusion for common shells",
              "Provides a false\u2011positive note in the metadata"
            ],
            "weaknesses": [
              "Insufficient whitelisting of legitimate usage scenarios",
              "No additional context (user, path, frequency) to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several known injection\u2011related utilities and maps to ATT&CK T1055, showing basic awareness of the technique. However, it lacks references to specific threat actors, campaigns, or nuanced usage patterns that would demonstrate deeper contextual insight.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Covers multiple legitimate LOLBin tools used for injection",
              "Explicit ATT&CK technique mapping"
            ],
            "weaknesses": [
              "No attribution to real\u2011world campaigns or APT groups",
              "Generic description without operational nuance"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is largely correct and targets Sysmon data available in most environments, but the parent\u2011process exclusion is simplistic and may generate many false positives from legitimate admin scripts. The rule has not been shown as validated in production.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Uses Sysmon process_creation, a common data source",
              "Provides a clear false\u2011positive guidance section"
            ],
            "weaknesses": [
              "High potential for noisy alerts due to legitimate use of wmic/schtasks/bitsadmin",
              "ParentImage filter may miss legitimate contexts and increase alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "Alert titles and descriptions are concise and map to a known technique, giving analysts a starting point. Nonetheless, the rule only surfaces command\u2011line and parent\u2011process fields, limiting immediate investigative pivots.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and ATT&CK linkage",
              "Includes false\u2011positive mitigation notes"
            ],
            "weaknesses": [
              "Lacks additional enrichment fields (user, hash, PID) for deeper triage",
              "No explicit response playbook or next\u2011step guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Detection relies heavily on literal command\u2011line strings and a static parent\u2011process list, which attackers can evade by renaming binaries, using encoded commands, or launching from alternative legitimate parents. No behavioral or multi\u2011vector correlation is employed.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Covers several different LOLBin utilities",
              "Implements a parent\u2011process exclusion to reduce obvious noise"
            ],
            "weaknesses": [
              "Easily bypassed via renaming or command\u2011line obfuscation",
              "No supplemental indicators (e.g., DLL injection events) to reinforce detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only inspects a single process creation event for specific command-line strings and a simple parent\u2011process filter. It does not capture persistence mechanisms, lateral movement, or downstream impact activities, nor does it correlate multiple related events across the attack lifecycle.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:09:49.644248",
          "metadata": {
            "strengths": [
              "Targets known injection\u2011related utilities that are often abused.",
              "Includes a basic parent\u2011process exclusion to reduce obvious benign cases."
            ],
            "weaknesses": [
              "Limited to one stage (initial execution) and cannot detect persistence or lateral movement.",
              "Static keyword list may miss other injection techniques and generates false positives."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1055 (Process Injection via Suspicious Command-Line Tools) scored 0.43/1.0 (Poor). Best performance in realism (0.54). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:09:49.644248",
      "metadata": {
        "attack_id": "attack.t1055",
        "technique_name": "Process Injection via Suspicious Command-Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4433333333333333,
      "category_scores": {
        "correctness": 0.32,
        "quality": 0.46470588235294114,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5444444444444445,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule omits several mandatory Sigma fields such as id, status, description, references, author, and date. Only the core sections are present, and many are incomplete or truncated.",
          "confidence": 0.95,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Includes essential sections like title, logsource, detection, falsepositives, level, and tags.",
              "Tags contain the relevant MITRE ATT&CK identifier."
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, description, author, date, references).",
              "The rule definition is truncated, indicating incomplete syntax."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The selections target relevant utilities but rely on generic string contains, which can fire on benign activity. The parent\u2011process exclusion is limited and may not prevent many false positives, while some selections (wmic, bitsadmin) do not specifically indicate obfuscation.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Correctly uses standard Sigma field names (Image, CommandLine, ParentImage).",
              "Combines multiple tool detections under a single condition."
            ],
            "weaknesses": [
              "Broad \"contains\" matches lead to low precision.",
              "Exclusion logic is simplistic and may miss legitimate parent processes used by attackers."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is overly broad; any PowerShell call with \"-EncodedCommand\" or any cmd.exe invoking PowerShell will trigger, even for legitimate automation. No additional context (user, command length, base64 pattern) is used to narrow alerts.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Attempts to filter out common parent processes.",
              "Covers several command\u2011line tools in one rule."
            ],
            "weaknesses": [
              "Lacks precise pattern matching (e.g., regex for base64 strings).",
              "Does not differentiate between administrative and malicious usage beyond parent process."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures multiple entry points for the technique, improving coverage, but misses many variants (e.g., PowerShell -e, encoded scripts via mshta, or renamed binaries). Sensitivity is moderate but could be enhanced with regex and case\u2011insensitive matching.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Detects encoded PowerShell commands, a common obfuscation method.",
              "Includes several native Windows utilities that attackers may abuse."
            ],
            "weaknesses": [
              "Does not account for alternative encodings or renamed executables.",
              "Case\u2011sensitivity and lack of regex reduce ability to catch subtle variations."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a brief description, but lacks sub\u2011technique identifiers, external references, threat\u2011actor or campaign context, and detailed tooling information.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique tag",
              "Provides false\u2011positive guidance and logsource details"
            ],
            "weaknesses": [
              "Missing sub\u2011technique IDs and authoritative references",
              "No actor, campaign, or malware family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection uses simple endswith/contains operators without leading wildcards and avoids regex, which is efficient, but it omits an EventID filter and relies on relatively broad contains clauses that could increase query load.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and complex regex",
              "Includes parent\u2011process exclusion to limit scope"
            ],
            "weaknesses": [
              "No EventID (e.g., 1 for Sysmon process creation) to narrow data",
              "Contains operators may match many benign commands"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several native Windows utilities used for command\u2011line obfuscation, yet it does not address many sub\u2011techniques, alternative flags, or third\u2011party tools commonly employed for T1027.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Covers PowerShell encoded commands and several Windows binaries",
              "Addresses both direct and indirect (cmd \u2192 PowerShell) execution"
            ],
            "weaknesses": [
              "Limited to specific flags; misses other obfuscation methods (e.g., certutil, rundll32)",
              "No coverage of broader T1027 sub\u2011techniques or custom tooling"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Parent\u2011process exclusion and listed false\u2011positive scenarios help, but the rule still generates alerts on legitimate administrative use of encoded PowerShell and lacks user, path, or frequency\u2011based whitelisting.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Provides explicit false\u2011positive examples",
              "Excludes common parent processes to reduce noise"
            ],
            "weaknesses": [
              "No account or path whitelisting for known admin activities",
              "Absence of temporal or frequency thresholds to filter one\u2011off benign events"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common attacker use of encoded PowerShell and other LOLBins, reflecting the T1027 technique, but it lacks campaign\u2011specific references, timing or target context, making it a generic rather than nuanced detection.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Detects widely\u2011used obfuscation flags (e.g., -EncodedCommand)",
              "Covers multiple legitimate LOLBins used by threat actors"
            ],
            "weaknesses": [
              "No attribution to specific APT groups or campaigns",
              "Limited contextual detail beyond the presence of an obfuscation flag"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is mostly correct and targets Sysmon process creation, which is common, but the rule is incomplete in the provided snippet and may generate a high false\u2011positive volume without further tuning.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Uses Sysmon process_creation, a widely available data source",
              "Includes parent process exclusion to reduce obvious noise"
            ],
            "weaknesses": [
              "Potential syntax gaps and missing validation evidence",
              "False\u2011positive risk remains high for legitimate admin scripts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "Alert titles and command\u2011line fields give analysts a clear starting point, yet the rule lacks detailed remediation guidance and may overwhelm analysts with alerts from benign activity.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Provides command\u2011line details useful for pivoting"
            ],
            "weaknesses": [
              "No explicit response playbook or investigation steps",
              "Limited contextual enrichment (e.g., user, host, hash) for deeper analysis"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies on static string matches and executable names, which attackers can evade by renaming binaries, using PowerShell Core (pwsh.exe), or alternative encoding flags, offering modest resistance.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Covers several LOLBins rather than a single tool",
              "Targets known obfuscation parameters"
            ],
            "weaknesses": [
              "Easy to bypass with renamed executables or different flags",
              "Lacks behavioral correlation or multi\u2011vector detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only inspects individual process creation events for obfuscation indicators and does not correlate them across the attack lifecycle. It can flag initial execution and some persistence tools (schtasks, bitsadmin) but lacks logic to link these events to later lateral movement, data exfiltration, or impact stages.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:24.392676",
          "metadata": {
            "strengths": [
              "Detects encoded PowerShell commands, a common obfuscation technique",
              "Covers multiple command-line utilities (cmd, wmic, schtasks, bitsadmin) to broaden coverage"
            ],
            "weaknesses": [
              "Operates as a single\u2011event detector; no multi\u2011stage correlation or enrichment",
              "Does not explicitly capture persistence, lateral movement, or exfiltration activities related to the technique"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1027 (Obfuscated Files or Information via Command-Line Tools) scored 0.44/1.0 (Poor). Best performance in realism (0.54). Needs improvement in correctness (0.32). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:10:24.392676",
      "metadata": {
        "attack_id": "attack.t1027",
        "technique_name": "Obfuscated Files or Information via Command-Line Tools",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.47333333333333333,
      "category_scores": {
        "correctness": 0.42000000000000004,
        "quality": 0.5294117647058824,
        "effectiveness": 0.5666666666666667,
        "realism": 0.4444444444444444,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes core fields like title, logsource, detection, falsepositives, level, and tags, but it lacks mandatory Sigma metadata such as id, status, description, references, author, and date. The tags are present but not in the canonical MITRE ATT&CK format, reducing completeness.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Provides essential detection sections (logsource, detection, condition).",
              "Includes a list of false positives and a severity level."
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, description, author, date, references).",
              "Tags are not fully aligned with standard MITRE ATT&CK identifiers."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic captures common exfiltration utilities and excludes runs from cmd.exe, which is a reasonable baseline. However, the condition is simplistic and may miss attacks launched from other legitimate parents or produce false alerts from benign use of the same utilities.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Covers multiple relevant binaries (powershell, wmic, schtasks, bitsadmin).",
              "Uses a clear OR/AND structure to combine selections."
            ],
            "weaknesses": [
              "Excludes only cmd.exe as parent, leaving many legitimate contexts unfiltered.",
              "Broad string contains checks can trigger on normal administrative activity."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule targets specific command\u2011line arguments, the use of generic \"contains\" patterns (e.g., \"-download\", \"-url\") and limited parent\u2011process filtering leads to a high likelihood of false positives in typical admin workflows.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Filters out executions directly launched from cmd.exe, reducing a common false\u2011positive source.",
              "Targets known exfiltration\u2011related switches for each utility."
            ],
            "weaknesses": [
              "No additional context (user, session, or known benign process exclusions) to narrow alerts.",
              "String matches are overly broad, catching legitimate PowerShell or BITS usage."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is reasonably sensitive, covering several tools and key exfiltration flags, and it uses case\u2011insensitive matching by default. Nevertheless, it may miss variants that rename binaries, use alternative utilities (e.g., certutil, curl), or employ less common flags.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Includes multiple utilities, increasing coverage of the technique.",
              "Detects encoded PowerShell commands, a common evasion method."
            ],
            "weaknesses": [
              "Does not account for renamed or moved binaries, limiting evasion resistance.",
              "Excludes only one parent process, missing other benign launch contexts."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic metadata such as title, description, tags, and technique name, but lacks authoritative references, threat\u2011actor or campaign context, and detailed sub\u2011technique identifiers. The description is adequate yet not exhaustive.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag and technique name",
              "Provides clear description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing references to MITRE IDs, sub\u2011technique codes, and external sources",
              "No threat\u2011actor, campaign, or malware family information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses indexed fields (Image, CommandLine) with endswith/contains operators and avoids leading wildcards, which is efficient. However, it omits a Sysmon EventID filter (e.g., EventID 1) that would further narrow the dataset.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "No leading wildcards; uses specific endswith/contains filters",
              "Simple logical condition without heavy regex"
            ],
            "weaknesses": [
              "Lacks EventID restriction to limit to process\u2011creation events",
              "Multiple separate selections could be consolidated for performance"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several common utilities (PowerShell, WMIC, schtasks, bitsadmin) used for exfiltration, but it does not address other prevalent tools (certutil, curl, PowerShell IEX, custom binaries) or sub\u2011technique variations. Coverage is decent but not comprehensive.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Covers four widely abused command\u2011line utilities",
              "Detects encoded PowerShell commands and BITS transfers"
            ],
            "weaknesses": [
              "Missing other typical exfiltration utilities and frameworks (e.g., certutil, curl, Cobalt Strike)",
              "Does not include sub\u2011technique identifiers or advanced evasion variants"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule excludes executions launched from cmd.exe, which helps reduce noise, but it lacks more granular whitelisting (users, paths) and does not employ time\u2011based or frequency heuristics. The false\u2011positive notes are present but not enforced in the logic.",
          "confidence": 0.84,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Uses parent\u2011process exclusion to filter legitimate cmd\u2011based activity",
              "Provides a list of common legitimate scenarios in the false\u2011positive section"
            ],
            "weaknesses": [
              "No explicit whitelisting of known admin accounts or signed system binaries",
              "Absence of pattern\u2011based or temporal correlation to further suppress benign events"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common LOLBin utilities (PowerShell, WMIC, schtasks, bitsadmin) that threat actors abuse for exfiltration, and it adds a parent\u2011process filter to reduce noise. However, it lacks references to specific campaigns, APT groups, or nuanced attacker behavior such as timing or target selection.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Identifies real\u2011world abused utilities",
              "Uses parent\u2011process context to focus on suspicious launches"
            ],
            "weaknesses": [
              "No explicit linkage to known threat actor TTPs or campaigns",
              "Limited granularity on parameters that differentiate benign from malicious use"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma definition is syntactically incomplete (truncated fields, missing closing braces) and would likely fail validation in a SIEM. While the log source (Sysmon process creation) is common, the rule\u2019s false\u2011positive guidance is minimal and the alert volume could be high in typical environments.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Targets a log source that is widely deployed (Sysmon)",
              "Attempts to limit noise by excluding cmd.exe as parent"
            ],
            "weaknesses": [
              "Rule contains syntax errors and unfinished sections",
              "Potentially high false\u2011positive rate without richer context"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description are clear, and the detection provides process\u2011level fields useful for initial triage. However, the rule does not surface additional indicators (e.g., network connections, file hashes) nor does it give concrete investigation steps, limiting its practical usefulness.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the behavior",
              "Provides process name and command\u2011line details for investigation"
            ],
            "weaknesses": [
              "Lacks guidance on next investigative actions or remediation",
              "Does not include correlated data (network, file) to enrich alerts"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on specific command\u2011line arguments and executable names, which attackers can easily evade by renaming binaries, using alternative flags, or employing script\u2011based wrappers. It does not incorporate behavioral or network\u2011level checks that would increase resilience against obfuscation.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Considers parent\u2011process relationship to catch atypical launches",
              "Covers multiple LOLBins rather than a single tool"
            ],
            "weaknesses": [
              "Static string matching can be bypassed with obfuscation or alternate syntax",
              "No multi\u2011vector correlation (e.g., network traffic) to strengthen detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule captures the initial execution of suspicious command-line utilities but does not extend to later stages such as persistence, lateral movement, or actual data exfiltration. It operates on single process events without correlating related activities across time, limiting its multi\u2011stage visibility.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:10:58.740242",
          "metadata": {
            "strengths": [
              "Targets a set of commonly abused utilities (PowerShell, WMIC, schtasks, bitsadmin).",
              "Excludes launches from cmd.exe to reduce obvious false positives."
            ],
            "weaknesses": [
              "Only detects a single event; lacks correlation across stages of an attack.",
              "Does not explicitly cover persistence mechanisms or lateral movement related to the technique."
            ]
          }
        }
      ],
      "summary": "Rule for attack.exfiltration (Exfiltration Over C2 Channel via Command-Line Utilities) scored 0.47/1.0 (Poor). Best performance in effectiveness (0.57). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:10:58.740242",
      "metadata": {
        "attack_id": "attack.exfiltration",
        "technique_name": "Exfiltration Over C2 Channel via Command-Line Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4683333333333333,
      "category_scores": {
        "correctness": 0.42000000000000004,
        "quality": 0.5117647058823529,
        "effectiveness": 0.5666666666666667,
        "realism": 0.4444444444444444,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes title, logsource, detection, falsepositives, level, and tags, but lacks required fields such as id, status, description, references, author, and date. The existing fields are present but not fully populated, reducing overall completeness.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Core detection sections (logsource, detection, falsepositives) are present",
              "Relevant MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing mandatory metadata fields (id, status, description, author, date)",
              "Place\u2011holder values (e.g., \"unknown\" for ttp_id) reduce usefulness"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The selections correctly target common utilities used for obfuscated execution, but the condition \"and not parent_process\" is overly simplistic and may suppress legitimate detections. The generic \"base64\" filter is too broad, risking both false positives and missed attacks.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Covers multiple execution vectors (PowerShell, WMIC, schtasks, bitsadmin)",
              "Uses explicit flags like \"-enc\" and \"-EncodedCommand\" for PowerShell"
            ],
            "weaknesses": [
              "Excluding all processes with cmd.exe as parent may miss real attacks launched from cmd",
              "Generic base64 string detection lacks context and creates noise"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule targets specific command\u2011line arguments, the inclusion of a blanket \"base64\" search and the lack of additional context (user, path, hash) make it prone to false positives in typical enterprise environments.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Specific flag checks for PowerShell encoding",
              "Filters out parent cmd.exe processes to reduce some noise"
            ],
            "weaknesses": [
              "Broad base64 match captures benign data processing",
              "No exclusion for known legitimate scheduled\u2011task or bitsadmin usage patterns"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is reasonably sensitive, covering several utilities and both short and long PowerShell encoding switches. However, reliance on exact substrings and lack of regex for variations (e.g., different encodings, renamed binaries) may allow simple evasion.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Multiple utility coverage increases chance of catching varied attacks",
              "Includes both \"-enc\" and \"-EncodedCommand\" for PowerShell"
            ],
            "weaknesses": [
              "Does not account for renamed or moved executables (e.g., PowerShell in non\u2011standard paths)",
              "Absence of case\u2011insensitive or regex patterns may miss obfuscation tricks"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a brief description, but lacks sub\u2011technique IDs, authoritative references, threat\u2011actor or campaign context, and detailed tool/malware associations.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique tag (T1027)",
              "Provides a false\u2011positive guidance section"
            ],
            "weaknesses": [
              "Missing sub\u2011technique identifiers and external references",
              "No actor, campaign, or malware context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection uses efficient operators (endswith, contains) and avoids leading wildcards, but it omits an EventID filter and includes a very broad base64 clause that could degrade performance.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses specific process name filters",
              "Logical parent\u2011process exclusion reduces unnecessary matches"
            ],
            "weaknesses": [
              "No EventID (e.g., 1) constraint for Sysmon process creation",
              "Generic \"base64\" contains clause may generate high volume"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several common utilities used for obfuscated execution, yet it does not address many other relevant sub\u2011techniques or tools (e.g., certutil, mshta, rundll32, Cobalt\u202fStrike payloads).",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Covers PowerShell encoded commands and several Windows utilities",
              "Detects generic base64 strings as a catch\u2011all"
            ],
            "weaknesses": [
              "Lacks coverage of additional obfuscation vectors and sub\u2011techniques",
              "Broad base64 detection may miss nuanced variants"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While a parent\u2011process exclusion and false\u2011positive notes are present, the rule still relies on a very permissive base64 filter and does not whitelist known admin tools or incorporate frequency\u2011based logic, leading to potential noise.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Parent\u2011process exclusion helps reduce obvious benign cases",
              "Provides explicit false\u2011positive scenarios for analysts"
            ],
            "weaknesses": [
              "Generic base64 detection creates many false alerts",
              "No whitelisting of legitimate administrative accounts or paths"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common LOLBin usage (PowerShell -enc, WMIC, schtasks, bitsadmin) that threat actors employ for obfuscated execution, showing reasonable alignment with real\u2011world TTPs. However, it lacks references to specific campaigns, threat actor preferences, or timing/contextual cues that would deepen its situational awareness.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Covers multiple legitimate LOLBins used for obfuscation",
              "Includes parent\u2011process filter to reduce obvious false positives"
            ],
            "weaknesses": [
              "No explicit linkage to known threat actor groups or campaigns",
              "Missing contextual details such as target systems or typical execution windows"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma snippet is syntactically incomplete (truncated detection block, unfinished siem_verification field) which would cause parsing errors. The generic \"base64\" filter is overly broad and likely to generate noise, and the rule does not reference fields like UserName or ProcessId that are commonly needed for enrichment.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Uses Sysmon process_creation which is widely deployed",
              "Specifies a high severity level appropriate for alert triage"
            ],
            "weaknesses": [
              "Syntax errors prevent immediate deployment",
              "Broad base64 detection may cause excessive false positives"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description are clear, and the false\u2011positive guidance helps analysts prioritize. Yet the alert payload is limited to image and command line, lacking additional context (user, host, hashes) that would aid rapid investigation and response.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Clear title and concise description",
              "Provides a list of common legitimate uses to aid triage"
            ],
            "weaknesses": [
              "Limited observable fields restrict investigative pivots",
              "No remediation or investigation playbook references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on static command\u2011line strings, which attackers can evade by using alternative flags, renaming executables (e.g., pwsh.exe), or passing encoded payloads via files or environment variables. The rule does not incorporate behavioral correlation (process trees, network activity) that would improve resilience against evasion.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Covers several LOLBins in a single rule",
              "Attempts to filter out obvious parent\u2011process noise"
            ],
            "weaknesses": [
              "Easily bypassed by renaming or alternative invocation methods",
              "Static string matching is insufficient against sophisticated obfuscation"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule focuses on single process creation events that contain obfuscation indicators, covering initial execution but not persistence, lateral movement, or exfiltration stages. It lacks correlation across related events (e.g., task creation followed by execution) and does not address later-stage activities of the technique.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:11:33.093433",
          "metadata": {
            "strengths": [
              "Detects multiple common utilities (PowerShell, WMIC, schtasks, bitsadmin) in one rule",
              "Parent\u2011process filter reduces obvious false positives from cmd.exe"
            ],
            "weaknesses": [
              "Only single\u2011event detection; no linkage to persistence or later\u2011stage actions",
              "Generic \"base64\" match can generate noise and misses encoded payloads without the literal string"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1027 (Obfuscated Strings Execution via Common Windows Utilities) scored 0.47/1.0 (Poor). Best performance in effectiveness (0.57). Needs improvement in detectability (0.30). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:11:33.093433",
      "metadata": {
        "attack_id": "attack.t1027",
        "technique_name": "Obfuscated Strings Execution via Common Windows Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.37,
      "category_scores": {
        "correctness": 0.25999999999999995,
        "quality": 0.46470588235294114,
        "effectiveness": 0.39333333333333337,
        "realism": 0.3888888888888889,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks several mandatory Sigma fields such as id, status, description, references, author, and date. Existing fields are present but many contain placeholder or incomplete values, reducing overall completeness.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Core fields like title, logsource, detection, falsepositives, and level are present",
              "MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing required metadata (id, status, description, references, author, date)",
              "Fields are not fully populated or are truncated"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The logic attempts to catch suspicious utilities but the condition \"not legit_parent\" only excludes explorer.exe, causing many benign processes to trigger. Selections are also overly simplistic (e.g., only PowerShell with -enc) and miss broader malicious patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Combines multiple utility detections into a single rule",
              "Uses explicit file name matching to avoid path variability"
            ],
            "weaknesses": [
              "Excludes only explorer.exe, leading to high false\u2011positive risk",
              "PowerShell detection limited to \"-enc\" and ignores other malicious flags"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is broad; any execution of the listed utilities from any non\u2011explorer parent will fire, which is common in legitimate admin scripts and system processes. No additional context (user, network, command content) is used to narrow scope.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Targets high\u2011risk utilities often abused by attackers",
              "Attempts to filter out obvious legitimate parent (explorer.exe)"
            ],
            "weaknesses": [
              "Lacks granular filters (e.g., specific command arguments, user context)",
              "Parent\u2011process exclusion is insufficient and opposite of typical malicious behavior"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule covers several common command\u2011line tools, improving coverage of the technique, but it misses many variants (e.g., PowerShell without -enc, renamed binaries, use of wscript/cscript). Sensitivity is moderate but could be bypassed easily.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Includes multiple utilities (PowerShell, cmd, wmic, schtasks, bitsadmin)",
              "Uses case\u2011insensitive \"endswith\" matching for executable names"
            ],
            "weaknesses": [
              "Restrictive PowerShell filter (-enc) omits many malicious invocations",
              "No handling for renamed or moved binaries, limiting evasion resistance"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a brief description, but lacks sub\u2011technique identifiers, authoritative references, threat\u2011actor or campaign context, and detailed tool/malware associations.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique tag and description",
              "Provides false\u2011positive guidance and SIEM verification details"
            ],
            "weaknesses": [
              "Missing sub\u2011technique tags and deeper ATT&CK context",
              "No external references, actor or campaign information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection uses efficient endswith/contains operators without leading wildcards and avoids complex regex, but it omits an EventID filter and relies on a very narrow parent\u2011process exclusion, which could affect query performance and relevance.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses simple string operators",
              "Logsource is specific to Sysmon process creation"
            ],
            "weaknesses": [
              "No EventID (e.g., Sysmon EventID 1) filter to limit scope",
              "Parent\u2011process exclusion is overly narrow, potentially increasing noise"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures several common command\u2011line utilities used in exploitation, yet it misses many other execution vectors (e.g., certutil, regsvr32), sub\u2011technique granularity, and tool\u2011specific indicators from frameworks like Cobalt Strike or Empire.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Detects encoded PowerShell and several widely abused utilities",
              "Covers both command\u2011shell and task\u2011scheduling tools"
            ],
            "weaknesses": [
              "Limited to a small set of binaries, omitting other relevant techniques",
              "No explicit sub\u2011technique mapping (e.g., T1059.001, T1059.003)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While the rule excludes executions launched from explorer.exe, legitimate administrative activity often originates from many other parent processes, and there are no user, path, or frequency\u2011based filters to curb false alerts.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Includes a parent\u2011process exclusion and false\u2011positive documentation",
              "Attempts to filter out common explorer\u2011spawned benign activity"
            ],
            "weaknesses": [
              "Exclusion is too narrow, leading to high false\u2011positive potential",
              "Lacks whitelisting of known admin accounts, paths, or temporal logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common LOLBin usage that attackers exploit after compromising a public-facing app, but it lacks specific campaign references, target context, and does not consider typical web\u2011server parent processes.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Detects widely abused utilities (PowerShell, cmd, wmic, schtasks, bitsadmin)",
              "Includes encoded PowerShell detection, matching common obfuscation"
            ],
            "weaknesses": [
              "No linkage to known threat actor campaigns or APT groups",
              "Parent\u2011process check is limited to excluding explorer only"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The Sigma rule contains syntax errors (truncated schtasks selection) and relies on a single process\u2011creation filter, which will generate many false positives and lacks validation evidence.",
          "confidence": 0.7,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Uses Sysmon process_creation, a common data source",
              "Logsource definition is clear and realistic"
            ],
            "weaknesses": [
              "Incomplete/invalid rule syntax prevents deployment",
              "Limited false\u2011positive mitigation (only excludes explorer)"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description are clear, but the alert provides minimal investigative data (no user, host, or PID) and offers only generic false\u2011positive guidance, reducing immediate usefulness.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the detection",
              "Description mentions the suspicious utilities"
            ],
            "weaknesses": [
              "Missing key fields for triage (e.g., user, host, process ID)",
              "No concrete response or remediation steps provided"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection is based on static executable names and specific command\u2011line arguments, which attackers can easily evade by renaming binaries or using alternative LOLBins.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBins rather than a single tool",
              "Filters out expected parent (explorer) to reduce noise"
            ],
            "weaknesses": [
              "Easily bypassed by renaming or using other legitimate binaries",
              "Relies solely on command\u2011line content, which can be hidden or obfuscated"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only flags the initial execution of suspicious utilities and does not cover persistence, lateral movement, or impact stages. It lacks any correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:12:07.950305",
          "metadata": {
            "strengths": [
              "Detects known malicious command\u2011line patterns (e.g., PowerShell -enc, cmd /c).",
              "Excludes obvious benign parent (explorer.exe) to reduce simple false positives."
            ],
            "weaknesses": [
              "No coverage of persistence mechanisms (e.g., scheduled tasks, services).",
              "Fails to detect lateral movement or post\u2011execution activities such as data exfiltration."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1190 (Exploitation of Public-Facing Application via Suspicious Command Execution) scored 0.37/1.0 (Poor). Best performance in quality (0.46). Needs improvement in detectability (0.26). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:12:07.950305",
      "metadata": {
        "attack_id": "attack.t1190",
        "technique_name": "Exploitation of Public-Facing Application via Suspicious Command Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.485,
      "category_scores": {
        "correctness": 0.42000000000000004,
        "quality": 0.45294117647058824,
        "effectiveness": 0.5399999999999999,
        "realism": 0.6555555555555556,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes core fields like title, description, logsource, detection, falsepositives, level, and tags, but omits required Sigma metadata such as id, status, references, author, and date, which are essential for production use.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "All mandatory detection sections (logsource, detection, condition) are present",
              "Relevant MITRE ATT&CK tag is included"
            ],
            "weaknesses": [
              "Missing required metadata fields (id, status, author, date, references)",
              "No explicit versioning or documentation fields"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The selections correctly target common compression utilities, but the parent\u2011process exclusion logic is overly aggressive and may miss legitimate malicious activity; also the rule lacks coverage for other prevalent archivers.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Targets specific command\u2011line patterns for PowerShell Compress-Archive and zip",
              "Uses explicit image name matching to reduce ambiguity"
            ],
            "weaknesses": [
              "Excluding any parent of cmd.exe or explorer.exe can suppress true positives",
              "Limited to four utilities; does not account for others like winrar, compact, or custom scripts"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule employs exact image matches and a simple parent\u2011process filter, which helps reduce noise, yet the broad \"zip \" string and the blanket parent exclusion generate both false positives and false negatives.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Ends\u2011with image matching limits scope to known executables",
              "Parent\u2011process filter attempts to remove common benign launches"
            ],
            "weaknesses": [
              "\"zip \" substring may match benign usage (e.g., user\u2011initiated compression)",
              "Parent exclusion may inadvertently block malicious compression launched from legitimate shells"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule captures several typical compression tools, it lacks wildcard/regex handling for renamed binaries, alternate command\u2011line syntaxes, and does not consider encoded or obfuscated invocations, reducing its ability to detect evasive attacks.",
          "confidence": 0.81,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Covers both PowerShell and native command\u2011line utilities",
              "Detects multiple tools (7z, tar) increasing coverage"
            ],
            "weaknesses": [
              "No regex or case\u2011insensitive handling for varied command\u2011line arguments",
              "Fails to detect renamed or custom archiving utilities"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a short description, but it lacks sub\u2011technique identification, authoritative references, threat\u2011actor or campaign context, and associated tool/malware information.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Includes MITRE technique ID (T1560)",
              "Provides a concise description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing sub\u2011technique tag and tactic alignment",
              "No external references, threat\u2011actor or tool context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection uses simple field matches without regex, but it omits an EventID filter and relies on leading\u2011wildcard operators (endswith/contains) that can degrade SIEM performance.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Avoids complex regex and uses straightforward operators",
              "Filters on specific executable names"
            ],
            "weaknesses": [
              "No EventID (Sysmon 1) constraint, leading to broader data scans",
              "Endswith/contains translate to leading wildcards, impacting efficiency"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures several common compression utilities (PowerShell, zip, 7z, tar) but misses other prevalent tools (WinRAR, rar.exe) and advanced methods such as .NET API archiving or custom scripts used by threat groups.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Covers multiple mainstream compression utilities",
              "Includes PowerShell's native Compress-Archive"
            ],
            "weaknesses": [
              "Excludes other widely used archivers (e.g., WinRAR, rar.exe)",
              "Does not detect archive creation via programmatic APIs or custom tools"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "Parent\u2011process exclusions reduce obvious legit cases, yet many legitimate compression jobs run under other parents (e.g., taskeng.exe) and the rule lacks path, user, or frequency\u2011based whitelisting, leading to potential noise.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Excludes common legit parents (cmd.exe, explorer.exe)",
              "Provides explicit false\u2011positive notes"
            ],
            "weaknesses": [
              "Limited exclusion scope; many benign scenarios remain unfiltered",
              "No contextual whitelisting (paths, users) or rate\u2011based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a generic technique (compression utilities) but lacks specific threat\u2011actor, campaign or timing context. It does not reference known adversary tooling or patterns beyond the generic command names.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Covers the core ATT&CK technique (T1560) with relevant utilities",
              "Includes a simple parent\u2011process filter to reduce noise"
            ],
            "weaknesses": [
              "No linkage to real\u2011world adversary behavior or specific APT groups",
              "Missing contextual cues such as file paths, timestamps, or target directories"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma syntax is largely correct and uses a common Sysmon process\u2011creation source, making it deployable. However, the rule may still generate alerts in environments with legitimate compression scripts, and the parent\u2011process exclusion logic could suppress true positives.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Valid Sigma fields and no obvious syntax errors",
              "Uses Sysmon data that is widely collected in enterprise environments"
            ],
            "weaknesses": [
              "Potential for missed detections when malicious compression runs under allowed parents",
              "Limited severity guidance and no built\u2011in tuning parameters"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The alert title and description are clear, but the payload provides only executable and command\u2011line data, lacking user, hash, or file\u2011creation context that would aid rapid investigation.",
          "confidence": 0.78,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the observed behavior",
              "Description mentions typical false\u2011positive scenarios for analyst triage"
            ],
            "weaknesses": [
              "Missing enrichment fields (e.g., process hash, user, file paths) for deeper investigation",
              "No guidance on next\u2011step actions or remediation steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on static executable names and command\u2011line strings, which attackers can easily evade by renaming binaries, using alternative archivers, or obfuscating arguments (e.g., PowerShell encoded commands).",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Covers multiple common utilities (PowerShell, 7z, tar, zip)",
              "Includes a parent\u2011process filter to avoid trivial noise"
            ],
            "weaknesses": [
              "No behavioral correlation (e.g., file writes, network exfil) to catch renamed tools",
              "Fails against LOLBin evasion where compression is performed via native APIs or scripts without visible command\u2011line flags"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only detects the execution of compression utilities, covering the data collection stage of the technique. It does not address persistence, lateral movement, or exfiltration, nor does it correlate multiple related events across the attack lifecycle.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:12:44.958741",
          "metadata": {
            "strengths": [
              "Targets specific command\u2011line patterns that are indicative of archiving activity.",
              "Includes parent\u2011process exclusions to reduce obvious false positives."
            ],
            "weaknesses": [
              "Limited to a single event; no correlation of related processes (e.g., staging, transfer).",
              "Does not detect the technique when used for persistence or lateral movement."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1560 (Archive Collected Data via Compression Utilities) scored 0.48/1.0 (Poor). Best performance in realism (0.66). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:12:44.959118",
      "metadata": {
        "attack_id": "attack.t1560",
        "technique_name": "Archive Collected Data via Compression Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "bc9980af-838f-4672-9496-0382276d8b67",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.38,
      "category_scores": {
        "correctness": 0.25999999999999995,
        "quality": 0.39999999999999997,
        "effectiveness": 0.44,
        "realism": 0.4555555555555555,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains only a subset of required Sigma fields (title, logsource, detection, falsepositives). Critical metadata such as id, status, description, references, author, date, tags, and level are missing, making it incomplete for sharing or publishing.",
          "confidence": 0.92,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Provides a clear title and logsource definition",
              "Includes a false\u2011positive description"
            ],
            "weaknesses": [
              "Missing mandatory metadata fields (id, status, description, references, author, date, tags, level)",
              "No MITRE ATT&CK tags or other taxonomy information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The selections attempt to capture screen\u2011capture utilities but many are mis\u2011aligned (e.g., WMIC and SCHTASKS are not typical screen\u2011capture vectors). The condition logic is syntactically valid but the rule would fire on benign activity and miss many real\u2011world abuses.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Uses explicit file\u2011name matching for known utilities (snippingtool.exe, mspaint.exe)",
              "Applies parent\u2011process exclusions to reduce obvious false positives"
            ],
            "weaknesses": [
              "Incorrect association of tools (e.g., WMIC, SCHTASKS, BITSADMIN) with screen capture",
              "Overly simplistic parent\u2011process filters that do not cover legitimate launch contexts"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies on broad command\u2011line contains checks and does not sufficiently narrow the scope, leading to high false\u2011positive potential (e.g., any PowerShell script with \"CopyFromScreen\" or any use of Paint with \"PrintScreen\"). Contextual filters are limited to two parent processes.",
          "confidence": 0.9,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Attempts to exclude generic shells (cmd.exe) and services.exe as parents",
              "Targets specific executable names rather than generic wildcards"
            ],
            "weaknesses": [
              "Lacks additional context such as user account, session ID, or execution time",
              "Does not differentiate legitimate administrative use of WMIC/SCHTASKS/BITSADMIN"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule covers several common utilities but misses many legitimate screen\u2011capture techniques (e.g., nircmd.exe executed directly, PowerShell Add\u2011Type, third\u2011party tools). It also does not handle variations like renamed binaries or encoded command lines.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Covers multiple entry points (Snipping Tool, Paint, PowerShell, cmd.exe wrapper)",
              "Uses case\u2011insensitive \"endswith\" matching for executable names"
            ],
            "weaknesses": [
              "Fails to detect renamed or moved screen\u2011capture binaries",
              "Relies on exact command\u2011line substrings, missing obfuscated or encoded variants"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides basic MITRE identifiers and a description, but lacks sub\u2011technique tags, external references, threat\u2011actor or campaign context, and detailed tool/malware associations.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique ID and tactic",
              "Provides a concise description of what is being detected"
            ],
            "weaknesses": [
              "Missing sub\u2011technique tags and broader ATT&CK context",
              "No external references, threat\u2011actor or campaign information"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule avoids leading wildcards and uses indexed fields (Image, CommandLine), but it does not filter on EventID, mixes many OR clauses, and some selections are overly broad, which could impact SIEM performance.",
          "confidence": 0.88,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Uses endswith/contains operators without leading wildcards",
              "Applies parent\u2011process exclusions to narrow scope"
            ],
            "weaknesses": [
              "No EventID filter (e.g., Sysmon EventID 1) for early pruning",
              "Broad contains checks may generate unnecessary matches"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures several common Windows screenshot utilities, yet it omits many adversary\u2011used tools (e.g., custom PowerShell scripts, Cobalt Strike, Metasploit modules) and does not address sub\u2011techniques or advanced evasion tactics.",
          "confidence": 0.82,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Covers native Windows utilities like SnippingTool and Paint",
              "Includes some command\u2011line helpers (nircmd, bitsadmin)"
            ],
            "weaknesses": [
              "Limited to a narrow set of tools, missing broader adversary payloads",
              "No coverage of sub\u2011techniques or post\u2011execution behaviors"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Parent\u2011process exclusions help, but legitimate user activity (e.g., launching Snipping Tool from Explorer) will still trigger alerts; there is no user, path, or frequency logic to further reduce noise.",
          "confidence": 0.86,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Excludes execution when parent is cmd.exe or services.exe",
              "Lists common false\u2011positive scenarios in the metadata"
            ],
            "weaknesses": [
              "Lacks whitelisting of known good users or directories",
              "No temporal or frequency thresholds to filter benign single events"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists several common Windows utilities but does not reference specific threat actor campaigns, preferred tools, or realistic usage patterns for screen capture. It mixes unrelated binaries (e.g., bitsadmin) and lacks operational context.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Covers a range of native Windows executables that could be abused",
              "Attempts to filter out generic parent processes"
            ],
            "weaknesses": [
              "No linkage to known adversary techniques or campaigns",
              "Includes irrelevant tools, reducing focus on actual screen\u2011capture abuse"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is mostly correct, but the rule is incomplete (truncated JSON, missing closing braces) and includes loosely related conditions (e.g., bitsadmin download). It also lacks a severity field and clear validation evidence.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Uses Sysmon process\u2011creation events, which are widely deployed",
              "Implements simple parent\u2011process exclusions to cut noise"
            ],
            "weaknesses": [
              "Rule fragment is syntactically incomplete, preventing direct deployment",
              "Potentially high false\u2011positive rate due to broad command\u2011line matches"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The alert title is clear, but the rule provides limited investigative data (no user, hash, or network context) and lacks severity or remediation guidance, making triage harder.",
          "confidence": 0.8,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Title succinctly describes the detection intent",
              "Parent\u2011process exclusion helps narrow the investigation scope"
            ],
            "weaknesses": [
              "Missing key fields (e.g., SubjectUserName, ImageHash) for deeper analysis",
              "No severity rating or response playbook references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on static file names and command\u2011line strings, which can be evaded by renaming binaries, using PowerShell without the specific argument, or employing alternative LOLBins. No behavioral correlation is used.",
          "confidence": 0.75,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Covers several LOLBins that attackers might use",
              "Excludes generic shells to reduce simple bypasses"
            ],
            "weaknesses": [
              "Easy to bypass by renaming executables or using obfuscated command lines",
              "Lacks multi\u2011vector detection (e.g., file\u2011write, registry, or API monitoring)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only flags the moment a screen\u2011capture executable is launched, without linking it to later persistence, lateral movement, or data\u2011exfiltration steps. It lacks correlation across events, so it cannot track the technique through multiple attack phases.",
          "confidence": 0.85,
          "timestamp": "2025-12-20T16:13:19.686653",
          "metadata": {
            "strengths": [
              "Covers a variety of legitimate screenshot tools and common abuse vectors.",
              "Uses parent\u2011process exclusions to lower false\u2011positive rates."
            ],
            "weaknesses": [
              "Detects only a single execution event; no coverage of persistence or post\u2011capture activity.",
              "No correlation logic to tie multiple related events (e.g., scheduled task creation \u2192 screenshot utility execution)."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1113 (Screen Capture Tool Execution Detection) scored 0.38/1.0 (Poor). Best performance in realism (0.46). Needs improvement in correctness (0.26). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-20T16:13:19.687160",
      "metadata": {
        "attack_id": "attack.t1113",
        "technique_name": "Screen Capture Tool Execution Detection",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    }
  ]
}