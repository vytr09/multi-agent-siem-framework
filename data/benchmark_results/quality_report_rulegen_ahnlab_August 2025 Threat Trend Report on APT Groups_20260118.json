{
  "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
  "timestamp": "2026-01-20T17:39:16.180766",
  "config": {
    "llm_judge": {
      "enabled": true,
      "api_key": "<REDACTED>",
      "model": "llama-3.3-70b",
      "temperature": 0.1,
      "max_tokens": "<REDACTED>",
      "timeout": 60,
      "persona": "expert cybersecurity researcher and red team operator with deep knowledge of MITRE ATT&CK framework and detection engineering",
      "detailed_feedback": true,
      "confidence_scores": true,
      "enable_comparison": true,
      "max_requests_per_minute": 60,
      "retry_attempts": 3,
      "retry_delay": 2
    },
    "attackgen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "high_quality_threshold": 0.85,
      "metrics": {
        "technical_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "attack_alignment": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "platform_compatibility": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "operational_realism": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "threat_actor_alignment": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "testing_safety": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "controlled_impact": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "detection_value": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "artifact_generation": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "completeness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "documentation_quality": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        }
      },
      "top_performers_count": 10,
      "bottom_performers_count": 5,
      "enable_comparative_analysis": true,
      "export_format": "json",
      "export_detailed_results": true,
      "export_statistics": true
    },
    "rulegen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "metrics": {
        "sigma_completeness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_logic_correctness": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "platform_syntax_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "field_mapping_accuracy": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_specificity": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_sensitivity": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "metadata_richness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "optimization_level": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "attack_coverage": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "false_positive_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "contextual_awareness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "operational_deployability": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "performance_efficiency": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "analyst_actionability": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "evasion_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "multi_stage_detection": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        }
      }
    },
    "general": {
      "max_concurrent_evaluations": 3,
      "batch_size": 5,
      "enable_caching": true,
      "cache_ttl": 3600,
      "log_level": "INFO",
      "log_file": "logs/benchmark.log",
      "log_format": "json",
      "output_directory": "data/benchmark_results",
      "create_timestamp_subdirs": true,
      "calculate_statistics": true,
      "generate_summary_report": true,
      "export_csv": true,
      "generate_plots": false,
      "plot_format": "png"
    },
    "comparison": {
      "enabled": true,
      "criteria": [
        "overall quality",
        "technical correctness",
        "operational realism",
        "testing safety"
      ],
      "significant_difference_threshold": 0.1
    },
    "regression": {
      "enabled": false,
      "baseline_file": "baselines/attackgen_baseline.json",
      "alert_on_degradation": true,
      "degradation_threshold": 0.05,
      "track_history": true,
      "history_file": "history/benchmark_history.json"
    },
    "alerting": {
      "enabled": false,
      "low_score_threshold": 0.5,
      "alert_channels": [
        "email",
        "slack"
      ],
      "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "from_address": "benchmark@example.com",
        "to_addresses": [
          "team@example.com"
        ]
      },
      "slack": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#siem-benchmarks"
      }
    },
    "advanced": {
      "ensemble_evaluation": {
        "enabled": false,
        "models": [
          "gemini-2.0-flash-lite"
        ],
        "aggregation_method": "weighted_average"
      },
      "ground_truth": {
        "enabled": false,
        "dataset_path": "datasets/ground_truth.json",
        "calculate_accuracy": true
      },
      "custom_metrics": {
        "enabled": false,
        "metrics_file": "config/custom_metrics.yaml"
      },
      "debug": {
        "enabled": false,
        "save_prompts": true,
        "save_responses": true,
        "verbose_logging": true
      }
    }
  },
  "statistics": {
    "total_evaluations": 8,
    "average_score": 0.4441666666666666,
    "category_averages": {
      "correctness": 0.485,
      "quality": 0.4632352941176471,
      "effectiveness": 0.4150000000000001,
      "realism": 0.5444444444444444,
      "detectability": 0.3111111111111111
    },
    "metric_averages": {
      "sigma_completeness": 0.4625,
      "detection_logic_correctness": 0.5,
      "detection_specificity": 0.42500000000000004,
      "detection_sensitivity": 0.48749999999999993,
      "metadata_richness": 0.38749999999999996,
      "optimization_level": 0.575,
      "attack_coverage": 0.3875,
      "false_positive_resistance": 0.4,
      "contextual_awareness": 0.475,
      "operational_deployability": 0.5499999999999999,
      "analyst_actionability": 0.5375000000000001,
      "evasion_resistance": 0.35,
      "multi_stage_detection": 0.2625
    },
    "score_distribution": {
      "excellent (>=0.9)": 0,
      "good (0.8-0.9)": 0,
      "fair (0.7-0.8)": 1,
      "poor (0.6-0.7)": 0,
      "failing (<0.6)": 7
    }
  },
  "results": [
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7133333333333334,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.8,
        "effectiveness": 0.62,
        "realism": 0.7888888888888889,
        "detectability": 0.4666666666666667
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields populated with meaningful content, but some fields like 'status', 'author', and 'date' are missing. The provided fields are well-structured and follow the Sigma format.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Well-structured Sigma fields",
              "Meaningful content in required fields"
            ],
            "weaknesses": [
              "Missing some required fields",
              "Lack of author and date information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies the Phishing: Office Document Launches Encoded PowerShell technique, with sound condition logic and standard Sigma field names. The selection criteria and condition logic are well-defined and effective.",
          "confidence": 0.95,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate Office macros"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is specific enough to minimize false positives, using exact matches and filters to exclude benign activity. However, it may still catch some legitimate Office macros or system management tools.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Exact matches and filters",
              "Exclusion of benign activity"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate tools",
              "Limited consideration of legitimate use cases"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers multiple indicators of the attack technique and uses wildcards and regex to catch variations. However, it may not detect all possible evasion attempts, such as heavily obfuscated commands.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Coverage of multiple indicators",
              "Use of wildcards and regex"
            ],
            "weaknesses": [
              "Potential vulnerability to evasion attempts",
              "Limited consideration of advanced threats"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1566), a clear description, and relevant custom tags. However, it lacks references to authoritative sources, threat actors, malware families, or campaign names that would enhance investigative context.",
          "confidence": 1.0,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging (attack.t1566, initial_access, phishing)",
              "Clear description explaining detection logic and intent"
            ],
            "weaknesses": [
              "Missing MITRE sub-technique (e.g., T1059.001 for PowerShell)",
              "No references to external sources (MITRE page not embedded), threat actors, or malware families"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses efficient field filters (endswith, contains) on indexed fields like Image and ParentImage, avoids leading wildcards, and places specific conditions early. The regex is targeted and limited to long base64 strings, minimizing performance impact.",
          "confidence": 1.0,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Uses efficient 'endswith' and 'contains' on high-cardinality indexed fields",
              "Specific parent process conditions placed logically for fast evaluation"
            ],
            "weaknesses": [
              "Regex '[A-Za-z0-9+/]{100}={0,2}' could be pre-filtered more aggressively",
              "Slight redundancy in having both selection_suspicious and selection_wrapper without prioritization"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects core phishing behavior\u2014Office apps spawning encoded PowerShell\u2014but misses key variations like VBA launching PowerShell, DDE execution, or macroless attacks. It also lacks coverage of follow-on execution chains or obfuscated command lines beyond base64.",
          "confidence": 1.0,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Covers primary vector: Office documents launching PowerShell with encoded commands",
              "Includes both powershell.exe and pwsh.exe (PowerShell Core)"
            ],
            "weaknesses": [
              "Does not detect non-encoded obfuscation (e.g., string splitting, variable misuse)",
              "Misses related sub-techniques like T1059.001 (Command and Scripting Interpreter)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes basic exclusions for ccmexec.exe and AzureADConnect.exe, and leverages parent-child context, but lacks broader FP mitigation such as user context, frequency thresholds, or path-based whitelisting. The false positives list is informative but not operationalized in logic.",
          "confidence": 1.0,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Uses parent process context (WINWORD/EXCEL/OUTLOOK) to reduce noise",
              "Includes exclusions for known system tools (SCCM, Azure AD Connect)"
            ],
            "weaknesses": [
              "Exclusions are minimal and may not cover all enterprise tooling",
              "No thresholding or behavioral enrichment (e.g., multiple attempts, user context)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule aligns well with real-world TTPs where phishing documents spawn encoded PowerShell to execute payloads. It correctly focuses on process ancestry and encoded command usage, common in malicious Office macros. However, it lacks references to specific APT groups or campaigns that commonly use this technique.",
          "confidence": 0.95,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Accurately models attacker behavior using encoded PowerShell from Office apps",
              "Matches known phishing execution chains in MITRE ATT&CK"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Does not account for timing or document interaction patterns"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses valid Sysmon process creation fields and has realistic logsource requirements common in enterprise environments. The exclusion list helps reduce false positives, but the regex may still trigger on long benign base64 strings. Verification status shows it works in Splunk, increasing deployability confidence.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Validated detection with real event matches in SIEM",
              "Includes practical exclusions for known benign tools"
            ],
            "weaknesses": [
              "Regex pattern may generate false positives on non-malicious base64",
              "Relies solely on command-line content which can be fragmented"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule title and description clearly communicate the suspicious activity. Analysts can pivot on parent process, command line, and image paths. False positive guidance is specific and helps triage decisions. All key fields needed for investigation are captured in the detection logic.",
          "confidence": 0.95,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection rationale",
              "Provides actionable false positive examples"
            ],
            "weaknesses": [
              "Could include user context or host field for better pivoting",
              "No suggested follow-up queries or enrichment steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects a common phishing pattern but is vulnerable to simple evasions like splitting encoded commands, using alternative LOLBins (e.g., mshta, wmic), or compressing payloads. While it checks process ancestry, attackers can use VBA to spawn processes indirectly or use PowerShell Core with obfuscated arguments.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Detects behavior (child process creation) not just IOCs",
              "Includes both powershell.exe and pwsh.exe"
            ],
            "weaknesses": [
              "Relies heavily on '-EncodedCommand' in command line",
              "No coverage of alternative execution methods or obfuscation layers"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule reliably flags the initial execution of encoded PowerShell launched from Office applications, but it does not cover persistence, lateral movement, or post\u2011execution activities. Correlation is limited to a single parent\u2011child relationship and does not span multiple stages of an attack chain.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:00.790404",
          "metadata": {
            "strengths": [
              "Detects the initial execution of a known malicious pattern (encoded PowerShell from Office apps).",
              "Uses parent\u2011process context to reduce false positives."
            ],
            "weaknesses": [
              "No coverage of persistence mechanisms or later lateral movement steps related to the technique.",
              "Lacks multi\u2011event correlation to link execution with subsequent data collection or exfiltration actions."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1566 (Phishing: Office Document Launches Encoded PowerShell) scored 0.71/1.0 (Fair). Best performance in correctness (0.86). Needs improvement in detectability (0.47). Issues found in: false_positive_resistance, multi_stage_detection",
      "timestamp": "2026-01-20T17:33:00.791413",
      "metadata": {
        "attack_id": "attack.t1566",
        "technique_name": "Phishing: Office Document Launches Encoded PowerShell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5166666666666667,
      "category_scores": {
        "correctness": 0.6199999999999999,
        "quality": 0.5588235294117647,
        "effectiveness": 0.5,
        "realism": 0.5555555555555556,
        "detectability": 0.3111111111111111
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes many required fields (title, id, description, tags, logsource, detection, falsepositives, level) but omits mandatory metadata such as author, date, status, and references, which are essential for a production\u2011ready Sigma rule.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Core detection sections (title, logsource, detection, falsepositives) are present and populated.",
              "Relevant MITRE ATT&CK tag and technique name are included."
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, and reference URLs.",
              "Placeholder values (e.g., \"ttp_id\": \"unknown\") reduce usefulness."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly targets PowerShell executions with encoded commands and adds a broad base64 regex, while excluding two known benign parents. However, the filter list is limited and the regex may match benign base64 strings, leading to potential noise.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Covers multiple flag variations (-enc, -ec, -EncodedCommand).",
              "Combines flag\u2011based and regex\u2011based detection for broader coverage."
            ],
            "weaknesses": [
              "Filter only excludes two parent processes, missing many legitimate tools.",
              "Regex is overly generic and can trigger on unrelated base64 data."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "While the rule aims to limit noise with a parent\u2011process filter, the regex `[A-Za-z0-9+/=]{20}` is too permissive and will flag any long base64 string, increasing false positives. Specificity could be improved by tying the regex to the encoded\u2011command flag.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Uses explicit flag checks to narrow focus on PowerShell.",
              "Excludes known benign parent processes."
            ],
            "weaknesses": [
              "Broad base64 pattern captures many legitimate command\u2011line arguments.",
              "Limited exclusion list does not cover common admin tools."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule captures several common encodings and also any base64 string, providing good coverage for varied attacker techniques. Sensitivity is reduced for cases using alternative executables (pwsh.exe) or short encoded payloads.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Detects multiple encoded\u2011command syntaxes and generic base64 payloads.",
              "Case\u2011insensitive matching (default Sigma behavior) helps catch variations."
            ],
            "weaknesses": [
              "Does not account for PowerShell Core (`pwsh.exe`).",
              "Base64 strings shorter than 20 characters are ignored, possibly missing small payloads."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides basic tags and a short description, but it lacks detailed MITRE ATT&CK mapping (tactic, sub\u2011technique), authoritative references, threat\u2011actor or campaign context, and associated tool/malware information.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tag for T1059.001",
              "Provides a concise description of what is detected",
              "Lists false\u2011positive scenarios"
            ],
            "weaknesses": [
              "Missing explicit tactic and sub\u2011technique fields",
              "No references to MITRE docs, vendor blogs, or research",
              "No threat\u2011actor, campaign, or malware family context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses indexed fields (Image, CommandLine) with endswith/contains operators and avoids leading wildcards, which is SIEM\u2011friendly. However, it omits an EventID filter and the base64 regex could be costly on high\u2011volume data.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Endswith on Image avoids leading wildcards",
              "Uses simple contains for known PowerShell flags",
              "ParentImage filter is applied before regex evaluation"
            ],
            "weaknesses": [
              "No EventID (e.g., 1 for Sysmon process creation) to limit scope",
              "Regex \"[A-Za-z0-9+/=]{20}\" may generate many matches",
              "Lacks time\u2011 or frequency\u2011based constraints"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection captures common encoded PowerShell usage (flags and generic base64 strings) and maps to T1059.001, but it does not address other PowerShell sub\u2011techniques, tool\u2011specific payload patterns, or advanced obfuscation methods.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Covers the primary encoded\u2011command flag set",
              "Detects generic long base64 strings that may indicate payloads"
            ],
            "weaknesses": [
              "No coverage of other PowerShell sub\u2011techniques (e.g., T1059.003)",
              "Does not include signatures for known frameworks (Cobalt Strike, Empire)",
              "Lacks detection of alternative encoding/obfuscation methods"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule excludes a couple of known benign parent processes, which helps reduce noise, but it still risks many false positives from legitimate admin scripts and lacks broader whitelisting or rate\u2011based logic.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Excludes specific benign parents (ccmexec.exe, AzureADConnect.exe)",
              "Provides false\u2011positive guidance in the metadata"
            ],
            "weaknesses": [
              "Limited exclusion list; many legitimate PowerShell invocations remain",
              "No user, path, or service account whitelisting",
              "Absence of frequency or correlation logic to filter one\u2011off benign events"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures a well\u2011known attacker technique (PowerShell encoded commands) but does not reference specific threat actors, campaigns, or operational nuances, limiting its contextual depth.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Targets a common malicious PowerShell usage pattern",
              "Combines flag\u2011based and regex detection for broader coverage"
            ],
            "weaknesses": [
              "No linkage to known APT groups or campaigns",
              "Lacks contextual modifiers such as timing, target, or victim profile"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is largely correct and uses Sysmon data that most enterprises collect, but the rule may generate a high false\u2011positive rate and the severity level may be overly aggressive for production.",
          "confidence": 0.78,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Valid Sigma fields and condition syntax",
              "Relies on widely available Sysmon process_creation logs"
            ],
            "weaknesses": [
              "Limited exclusion list leads to potential alert fatigue",
              "Severity set to \"high\" without justification of risk"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title and description are clear, and false\u2011positive guidance is provided, yet the payload lacks enriched fields (user, hash, command hash) that would aid rapid triage.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Clear, concise title and description",
              "Includes basic false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing key investigative fields (e.g., ProcessId, ParentProcessId, User, SHA256)",
              "No recommended response steps or reference playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule looks for both explicit flags and generic base64 strings, attackers can bypass it by using alternative LOLBins (pwsh.exe), shorter base64 payloads, or obfuscating the command line, and it relies solely on a single data source.",
          "confidence": 0.75,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Dual detection paths (flags and regex) increase coverage",
              "Excludes two known benign parent processes"
            ],
            "weaknesses": [
              "Does not cover other PowerShell executables (e.g., pwsh.exe)",
              "Purely command\u2011line based; can be evaded with argument hiding or short payloads"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only inspects a single process creation event for encoded PowerShell commands and does not address persistence, lateral movement, or post\u2011execution activities. It lacks correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:33:43.715822",
          "metadata": {
            "strengths": [
              "Effectively identifies initial PowerShell execution with encoded payloads",
              "Uses both flag detection and regex to catch obfuscated commands"
            ],
            "weaknesses": [
              "No coverage of persistence mechanisms (e.g., scheduled tasks, WMI events)",
              "Cannot detect lateral movement or data exfiltration stages",
              "Lacks event correlation to tie multiple stages together"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Suspicious PowerShell Encoded Command Execution) scored 0.52/1.0 (Poor). Best performance in correctness (0.62). Needs improvement in detectability (0.31). Issues found in: sigma_completeness, detection_specificity, metadata_richness",
      "timestamp": "2026-01-20T17:33:43.715822",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Suspicious PowerShell Encoded Command Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4783333333333333,
      "category_scores": {
        "correctness": 0.48,
        "quality": 0.49411764705882355,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5444444444444445,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes many required fields (title, id, logsource, detection, falsepositives, level, tags) but omits several mandatory Sigma metadata such as description, status, references, author, and date. The missing fields reduce its usability and traceability.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "All core detection sections (logsource, detection, condition) are present and syntactically correct.",
              "MITRE ATT&CK tag is included, linking the rule to the technique."
            ],
            "weaknesses": [
              "No description, author, date, or reference fields; these are required for a complete Sigma rule.",
              "Missing status field (e.g., 'stable') and explicit rule ID format compliance."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures PowerShell executions with encoded payloads and adds a base64 length filter, which aligns with the T1543.003 behavior. However, the condition may miss short encoded commands and the benign\u2011parent exclusions are limited to two specific executables.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Covers both Windows PowerShell (powershell.exe) and PowerShell Core (pwsh.exe).",
              "Combines encoded\u2011command detection with a regex that looks for sufficiently long Base64 strings."
            ],
            "weaknesses": [
              "Relies on a fixed minimum Base64 length (100 chars), potentially missing legitimate malicious short payloads.",
              "Excludes only two parent processes, leaving many benign scenarios unfiltered."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule tries to limit noise with a long Base64 regex and two parent exclusions, the use of generic \"contains\" matches for \"-EncodedCommand\" and \"-enc\" can still fire on many legitimate admin scripts, leading to false positives.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Base64 length filter reduces matches on trivial or accidental strings.",
              "Explicit exclusion of known SCCM and Azure AD Connect parent processes."
            ],
            "weaknesses": [
              "Broad \"contains\" matching on command\u2011line flags captures many legitimate automation scripts.",
              "Limited contextual filters (no user, command name, or additional parent/child relationships)."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is reasonably sensitive to variations of encoded PowerShell usage, covering both -EncodedCommand and the short -enc flag, and it works for both PowerShell binaries. Nonetheless, the strict Base64 length requirement may cause evasion by using shorter payloads or alternative encoding schemes.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Detects both full and short flag variants (-EncodedCommand, -enc).",
              "Applies to both legacy and modern PowerShell executables."
            ],
            "weaknesses": [
              "May miss attacks that use shorter Base64 strings or custom encoding.",
              "Does not account for case\u2011insensitive matching or alternative encodings (e.g., hex)."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule provides the MITRE technique ID and a brief description, but lacks tactic tagging, authoritative references, threat\u2011actor or campaign context, and associated tool/malware information. Metadata is therefore only partially useful for investigations.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Includes MITRE technique identifier (T1543.003)",
              "Provides a concise description of what is being detected",
              "Lists false\u2011positive scenarios in the metadata"
            ],
            "weaknesses": [
              "Missing explicit tactic tag and sub\u2011technique IDs",
              "No references to MITRE docs, vendor blogs, or research",
              "No threat\u2011actor, campaign, or tool associations"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses indexed fields (Image, CommandLine) with endswith/contains operators and avoids leading wildcards, which is good for performance. However, it omits the Sysmon EventID filter and employs a relatively heavy base64 regex, which could be optimized further.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Uses Image|endswith and CommandLine|contains (indexed fields)",
              "Avoids leading wildcards in string matches",
              "Logical condition groups are simple"
            ],
            "weaknesses": [
              "No EventID filter (e.g., EventID 1 for process creation)",
              "Base64 regex may be costly on large logs",
              "Condition order could prioritize the most selective filters first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection captures the primary encoded\u2011PowerShell launch vectors (-EncodedCommand / -enc) and both powershell.exe and pwsh.exe, covering common attacker behavior. It does not address shorter base64 payloads, alternative launch methods, or related sub\u2011techniques such as T1059.001/003, limiting its breadth.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:34:25.415126",
          "metadata": {
            "strengths": [
              "Detects both PowerShell and PowerShell Core binaries",
              "Covers the two main encoded flags used by attackers"
            ],
            "weaknesses": [
              "Ignores short base64 strings that may still be malicious",
              "No coverage of other execution wrappers (e.g., wscript, rundll32)",
              "Does not reference common frameworks (Cobalt Strike, Empire, etc.)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule adds exclusions for two known legitimate parents and a length filter on the base64 string, which helps reduce noise. Nonetheless, many legitimate admin scripts use encoded PowerShell, and the rule lacks broader whitelisting, user/account filters, or temporal correlation to further curb false alerts.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Excludes known benign parents (ccmexec.exe, AzureADConnect.exe)",
              "Base64 length threshold reduces trivial cases"
            ],
            "weaknesses": [
              "Limited set of exclusions; many legitimate tools are not covered",
              "No user, path, or time\u2011based heuristics",
              "Potential for high alert volume in managed environments"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures a well\u2011known attacker technique\u2014using PowerShell\u202f\u2011EncodedCommand to launch malicious payloads\u2014but it does not reference specific threat groups, campaigns, or nuanced usage patterns that would demonstrate deeper contextual insight.",
          "confidence": 0.86,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Targets a high\u2011impact LOLBin (PowerShell) used by many actors",
              "Includes both Windows PowerShell and PowerShell\u202fCore binaries"
            ],
            "weaknesses": [
              "Lacks attribution to known APT groups or campaigns",
              "No timing, target, or environment cues that reflect real\u2011world operations"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is mostly correct and uses Sysmon, which is widely deployed, but the rule may generate a high volume of alerts because any long base64 string triggers it and the benign exclusions are limited.",
          "confidence": 0.81,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Uses realistic logsource (Sysmon process creation)",
              "Provides explicit false\u2011positive guidance"
            ],
            "weaknesses": [
              "Potentially noisy due to generic base64 length filter",
              "Limited allow\u2011list handling; many legitimate admin scripts may fire"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The alert title and description are clear, and the captured fields (Image, CommandLine, ParentImage) give analysts a starting point, but additional context such as user, hash, or related network activity would improve triage.",
          "confidence": 0.84,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Clear, concise title describing the technique",
              "Includes parent\u2011process exclusions to aid initial triage"
            ],
            "weaknesses": [
              "Missing enrichment fields (e.g., process hash, user SID)",
              "No built\u2011in guidance on remediation steps or investigative queries"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on command\u2011line arguments; attackers can evade by using alternative LOLBins, hiding the encoded payload in scripts, or disabling PowerShell logging, making the rule relatively easy to bypass.",
          "confidence": 0.78,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Detects both short \"-enc\" and full \"-EncodedCommand\" switches",
              "Filters out known benign parent processes"
            ],
            "weaknesses": [
              "Purely signature\u2011based on command line; renaming the executable or using other launch methods evades it",
              "No correlation with other telemetry (e.g., file writes, network connections) to strengthen confidence"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule reliably flags the initial execution of encoded PowerShell commands but does not address later stages such as persistence creation, lateral movement, or impact activities. It operates on a single process creation event and lacks correlation logic to link related events across the attack lifecycle.",
          "confidence": 0.86,
          "timestamp": "2026-01-20T17:34:25.415489",
          "metadata": {
            "strengths": [
              "Accurately identifies encoded PowerShell usage via -EncodedCommand/-enc flags and base64 patterns.",
              "Excludes known benign parent processes to reduce false positives."
            ],
            "weaknesses": [
              "Limited to single-event detection; no linkage to persistence mechanisms (e.g., scheduled tasks, services).",
              "Does not capture lateral movement or post\u2011execution activities, reducing coverage of later attack phases."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1543.003 (Encoded PowerShell Execution for System Process Creation) scored 0.48/1.0 (Poor). Best performance in realism (0.54). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_specificity, metadata_richness",
      "timestamp": "2026-01-20T17:34:25.415489",
      "metadata": {
        "attack_id": "attack.t1543.003",
        "technique_name": "Encoded PowerShell Execution for System Process Creation",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.325,
      "category_scores": {
        "correctness": 0.33999999999999997,
        "quality": 0.28235294117647064,
        "effectiveness": 0.26666666666666666,
        "realism": 0.5555555555555556,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule contains core fields (title, logsource, detection, falsepositives, level, tags, id) but lacks required metadata such as description, references, author, date, and status. The existing fields are populated with generic values rather than detailed documentation.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "All mandatory structural sections (logsource, detection, falsepositives, level) are present",
              "Tags include a MITRE ATT&CK identifier"
            ],
            "weaknesses": [
              "Missing description, references, author, date, and status fields",
              "Metadata is minimal and does not provide context or provenance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The selection matches processes named powershell, curl, or wget with command\u2011line strings that hint at HTTP traffic, but the ATT&CK mapping (T1566 \u2013 Phishing) is incorrect for an Application Layer Protocol technique. The logic is simple but may fire on many legitimate admin actions.",
          "confidence": 0.75,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Uses explicit image name matching to limit scope to known network tools",
              "Combines image and command\u2011line criteria, avoiding overly broad OR logic"
            ],
            "weaknesses": [
              "Incorrect ATT&CK technique ID (T1566 is Phishing, not Application Layer Protocol)",
              "No exclusion of benign usage (e.g., software updates) within the detection logic"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is likely to generate many false positives because powershell, curl, and wget are frequently used for legitimate tasks, and the command\u2011line contains generic strings like \"http://\". No contextual filters (parent process, user, network destination) are applied.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Limits matching to three specific executables",
              "Requires both an executable and a URL\u2011related token"
            ],
            "weaknesses": [
              "No additional context (parent process, privileged user) to narrow alerts",
              "Broad command\u2011line contains checks capture routine admin or update activity"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule captures basic usage of PowerShell, curl, and wget for HTTP requests, but it misses many other tools (bitsadmin, certutil, Invoke\u2011Expression, encoded commands) and evasion techniques (renamed binaries, base64\u2011encoded URLs). Sensitivity is limited to a narrow subset of possible behaviors.",
          "confidence": 0.6,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Covers three common network\u2011capable binaries",
              "Detects both PowerShell\u2019s Invoke\u2011WebRequest and generic HTTP flags"
            ],
            "weaknesses": [
              "Does not account for renamed or moved binaries, nor for encoded/obfuscated command lines",
              "Excludes other legitimate application\u2011layer protocols (e.g., DNS tunneling, SMB) used by attackers"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule provides only basic fields (title, description, tags) and uses an incorrect MITRE tag (T1566 instead of the Application Layer Protocol technique). It lacks references, threat\u2011actor or campaign context, sub\u2011technique identifiers, and a detailed description of the detection logic.",
          "confidence": 0.92,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Includes a description field",
              "Provides MITRE tag (though incorrect) and technique name"
            ],
            "weaknesses": [
              "Incorrect MITRE ATT&CK mapping and missing tactic/sub\u2011technique",
              "No external references, threat actor or campaign information",
              "Description is brief and does not explain detection nuances"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses indexed fields (Image, CommandLine) with endswith/contains operators and avoids leading wildcards, which is good for performance. However, it omits a Sysmon EventID filter and relies on broad contains strings (http://, https://) that can generate large result sets.",
          "confidence": 0.88,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Uses Image|endswith and avoids leading wildcards",
              "Operates on a specific logsource (Sysmon process creation)"
            ],
            "weaknesses": [
              "Missing EventID filter (e.g., EventID 1) to narrow scope",
              "Broad CommandLine contains values increase query cost and noise"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Coverage is limited to three native tools and a few generic command\u2011line strings. It does not address sub\u2011techniques, other common utilities (certutil, bitsadmin, PowerShell -EncodedCommand), or C2 frameworks such as Cobalt Strike or Empire.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Detects PowerShell, curl, and wget usage",
              "Covers basic HTTP/S request patterns"
            ],
            "weaknesses": [
              "No sub\u2011technique identifiers (e.g., T1071.001)",
              "Excludes many legitimate and malicious tools used for application\u2011layer C2",
              "Does not consider multi\u2011stage or encoded payload variants"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only lists generic false\u2011positive scenarios without implementing any concrete exclusions, whitelists, or contextual logic (parent\u2011child, user, frequency). Broad command\u2011line matches will trigger on routine admin activity.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Provides a false\u2011positive note for admin usage",
              "Specifies level as medium"
            ],
            "weaknesses": [
              "No explicit exclusions for known legitimate paths or users",
              "Lacks parent\u2011process or time\u2011based correlation to filter noise",
              "Broad contains strings cause high false\u2011positive rate"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule captures generic use of PowerShell, curl, and wget with web\u2011related arguments, but it does not reference specific threat actor techniques, campaigns, or observed malicious patterns. It reflects a textbook example rather than operational intelligence.",
          "confidence": 0.92,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Identifies common LOLBin tools used for web traffic",
              "Includes both PowerShell and third\u2011party utilities"
            ],
            "weaknesses": [
              "No linkage to known APT groups, malware families, or real\u2011world incidents",
              "Lacks contextual details such as typical payload URLs or timing"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is valid and matches Sysmon process\u2011creation events available in most Windows environments. However, the rule is likely to generate many false positives and has not been demonstrated as tested beyond a small verification set.",
          "confidence": 0.88,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Correct Sigma fields and no syntax errors",
              "Uses Sysmon, which is commonly deployed for process monitoring"
            ],
            "weaknesses": [
              "Broad command\u2011line matching will trigger on legitimate admin activity",
              "No tuning guidance or threshold to limit alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The alert title is clear, but the rule provides limited context (no user, parent process, hash, or network indicators) and no guidance for investigation steps, making triage effort higher.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Title directly states the detection focus",
              "Includes a false\u2011positive note for admins"
            ],
            "weaknesses": [
              "Missing key fields (e.g., ProcessId, ParentImage, DestinationIP) for pivoting",
              "No remediation or investigation playbook references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies solely on executable name and clear\u2011text command\u2011line strings, which attackers can bypass by renaming binaries, using encoded PowerShell, or employing alternative tools. No multi\u2011vector correlation is present.",
          "confidence": 0.91,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Covers three popular LOLBins in one rule",
              "Detects explicit HTTP/HTTPS strings"
            ],
            "weaknesses": [
              "Easily evaded by renaming or using other download utilities",
              "Does not consider encoded/obfuscated command lines or network\u2011level indicators"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only looks at a single process creation event and cannot identify later stages such as persistence, lateral movement, or data exfiltration. It lacks any correlation logic across multiple logs, so it functions as a point\u2011in\u2011time detector rather than a multi\u2011stage detector.",
          "confidence": 0.86,
          "timestamp": "2026-01-20T17:35:17.980840",
          "metadata": {
            "strengths": [
              "Detects common tooling (powershell, curl, wget) used for application\u2011layer communications",
              "Simple command\u2011line pattern matching makes it easy to deploy"
            ],
            "weaknesses": [
              "No coverage of persistence mechanisms (e.g., scheduled tasks, services, registry run keys)",
              "Cannot correlate with network or lateral\u2011movement events to track the full attack chain"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1566 (Application Layer Protocol Detection) scored 0.33/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.26). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2026-01-20T17:35:17.980840",
      "metadata": {
        "attack_id": "attack.t1566",
        "technique_name": "Application Layer Protocol Detection",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4816666666666666,
      "category_scores": {
        "correctness": 0.48,
        "quality": 0.5058823529411766,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5444444444444445,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule includes title, id, logsource, detection, falsepositives, level, and tags, but it lacks required fields such as description, status, references, author, and date. The tags are present but not fully aligned with Sigma conventions (e.g., missing \"attack.t1027\" in proper format).",
          "confidence": 0.92,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Core fields (title, logsource, detection, level) are present",
              "MITRE ATT&CK technique identifier is included in tags"
            ],
            "weaknesses": [
              "Missing mandatory metadata (description, author, date, status, references)",
              "Tags are not exhaustive and lack proper formatting"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures common PowerShell obfuscation patterns (\u2011EncodedCommand, \u2011enc, long Base64 strings) for both Windows PowerShell and PowerShell Core, and excludes two known benign parents. However, the regex is overly generic and the exclusion list is limited, which could cause missed detections or false alerts.",
          "confidence": 0.88,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Covers both powershell.exe and pwsh.exe binaries",
              "Detects multiple encoding indicators (\u2011EncodedCommand, \u2011enc, long Base64 strings)"
            ],
            "weaknesses": [
              "Regex for Base64 strings may match legitimate long arguments",
              "Exclusion criteria are narrow, missing other common benign sources"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "While the rule tries to reduce noise by excluding SCCM and Azure AD Connect, the use of broad regex and simple string contains checks (\u2011enc) will likely generate many false positives in environments that use encoded PowerShell for automation.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Adds explicit exclusions for known benign processes",
              "Limits detection to PowerShell executables only"
            ],
            "weaknesses": [
              "Long Base64 regex captures non\u2011malicious payloads",
              "\u2011enc flag is common in legitimate admin scripts, leading to noise"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule is reasonably sensitive: it detects both short and long encoded commands, supports both legacy and modern PowerShell, and uses case\u2011insensitive matching implicitly via Sigma. It may miss more stealthy variants that split the Base64 payload across multiple arguments or use alternate encodings.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Covers multiple encoding syntaxes and both PowerShell versions",
              "Regex allows detection of large Base64 payloads regardless of exact length"
            ],
            "weaknesses": [
              "Does not handle split or concatenated Base64 arguments",
              "No case\u2011insensitivity enforcement for regex, which could miss mixed\u2011case payloads"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule provides basic MITRE ATT&CK tagging and a concise description, but lacks sub\u2011technique IDs, external references, threat\u2011actor or campaign context, and associated tool/malware information.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Includes primary ATT&CK technique tag (T1027)",
              "Provides a clear short description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing sub\u2011technique identifiers and authoritative source links",
              "No threat\u2011actor, campaign, or tool context to aid investigation"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection uses indexed fields like Image but omits the Sysmon EventID filter and relies on contains and a heavy regex, which can degrade SIEM performance.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses specific file name checks",
              "Simple logical condition without deep nesting"
            ],
            "weaknesses": [
              "No EventID (e.g., 1) filter to limit scope to process creation events",
              "Regex for long Base64 strings and generic contains may be costly"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common PowerShell encoded\u2011command patterns for both powershell.exe and pwsh.exe, yet it does not address other obfuscation vectors, sub\u2011techniques, or tool\u2011specific signatures.",
          "confidence": 0.75,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Detects both full \"-EncodedCommand\" and short \"-enc\" flags",
              "Covers legacy PowerShell and newer PowerShell Core binaries"
            ],
            "weaknesses": [
              "No coverage for other obfuscation methods (e.g., scriptblock, Invoke\u2011Expression)",
              "Lacks mapping to sub\u2011techniques (T1059.001) and tool\u2011specific indicators"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "Exclusions for SCCM (ccmexec.exe) and Azure AD Connect reduce some noise, but many legitimate admin scripts still trigger the rule and there is no user, path, or frequency\u2011based filtering.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Explicit exclusion of known benign parent processes",
              "Provides a false\u2011positive description for administrators"
            ],
            "weaknesses": [
              "Limited exclusion set; does not consider privileged accounts or approved script locations",
              "No temporal or count\u2011based logic to suppress isolated benign events"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures a well\u2011known attacker technique\u2014PowerShell encoded commands\u2014but it does not reference specific threat groups, campaigns, or operational nuances beyond the generic MITRE technique.",
          "confidence": 0.78,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Targets a high\u2011impact TTP used by many APTs and ransomware groups",
              "Covers both Windows PowerShell and PowerShell Core binaries"
            ],
            "weaknesses": [
              "Lacks attribution to particular actors or campaigns",
              "No timing, target, or environment\u2011specific refinements"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma syntax is mostly correct and uses Sysmon, which is common, but the rule is prone to false positives from legitimate admin scripts and the exclusion list is minimal.",
          "confidence": 0.73,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon fields that are widely collected",
              "Provides a clear severity level (high) for SOC triage"
            ],
            "weaknesses": [
              "High likelihood of noisy alerts in environments that use encoded PowerShell for automation",
              "Rule snippet appears truncated; missing closing braces could cause deployment errors"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The alert title and description are concise, and the fields (Image, CommandLine, ParentImage) give a starting point for investigation, but additional context (user, hash, timestamps) is absent.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Clear indication of the technique (obfuscated PowerShell)",
              "Provides a basic false\u2011positive guidance list"
            ],
            "weaknesses": [
              "Limited investigative data; no user, process ID, or parent\u2011process chain beyond a single exclusion",
              "No remediation or enrichment references (e.g., PowerShell script block logging) "
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection relies heavily on command\u2011line strings and exact executable names, which attackers can evade by renaming the binary, using short base64 payloads, or invoking PowerShell via other LOLBins.",
          "confidence": 0.75,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Covers both short (-enc) and long base64 patterns",
              "Attempts to filter known benign parents"
            ],
            "weaknesses": [
              "Executable name checks (endswith) can be bypassed with copies or renamed binaries",
              "No correlation with other telemetry (e.g., PowerShell module logging, network activity) to catch hidden payloads"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only inspects a single process_creation event for encoded PowerShell usage. It does not link to persistence mechanisms, lateral movement, or post\u2011execution activity, nor does it aggregate related events across the attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2026-01-20T17:36:14.613236",
          "metadata": {
            "strengths": [
              "Detects both full and short -EncodedCommand flags for PowerShell and pwsh.exe.",
              "Uses a regex to catch large Base64 payloads that are typical of obfuscation."
            ],
            "weaknesses": [
              "Limited to initial execution; no coverage of persistence (e.g., scheduled tasks, services).",
              "No correlation logic to tie the PowerShell launch to later actions such as file writes, network connections, or credential dumping."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1027 (Obfuscated PowerShell Commands with Encoded Payloads) scored 0.48/1.0 (Poor). Best performance in realism (0.54). Needs improvement in detectability (0.36). Issues found in: sigma_completeness, detection_specificity, metadata_richness",
      "timestamp": "2026-01-20T17:36:14.613236",
      "metadata": {
        "attack_id": "attack.t1027",
        "technique_name": "Obfuscated PowerShell Commands with Encoded Payloads",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.18833333333333332,
      "category_scores": {
        "correctness": 0.14,
        "quality": 0.1823529411764706,
        "effectiveness": 0.16000000000000003,
        "realism": 0.25555555555555554,
        "detectability": 0.23333333333333334
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains a few required fields (title, logsource, detection, level, tags, id) but omits many mandatory elements such as status, references, author, date, and a proper MITRE ATT&CK tag. The populated fields are also generic placeholders.",
          "confidence": 0.94,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Uses core Sigma sections (title, logsource, detection)",
              "Includes an identifier (id) and a tag"
            ],
            "weaknesses": [
              "Missing required metadata (status, author, date, references)",
              "MITRE tag is \"attack.unknown\" which provides no actionable mapping"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The detection logic only checks for the literal string \"suspicious\" in any command line, which does not correspond to the behavior of Exfiltration Over C2 Channel and would not reliably trigger on real attacks.",
          "confidence": 0.96,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Uses a valid Sigma field (CommandLine|contains)",
              "Simple condition syntax"
            ],
            "weaknesses": [
              "Selection criteria are unrelated to the technique",
              "No contextual filters (parent process, user, network indicators) to reduce noise"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule is overly broad; any process with \"suspicious\" in its command line will fire, leading to a high false\u2011positive rate and making it unsuitable for production.",
          "confidence": 0.93,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Clear single\u2011condition logic is easy to understand"
            ],
            "weaknesses": [
              "Lacks precise indicators (e.g., known exfil tools, encoded PowerShell)",
              "No exclusion of legitimate administrative commands"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "While the rule could catch any occurrence of the word \"suspicious,\" it misses the majority of realistic exfiltration techniques and can be easily evaded by renaming or encoding commands.",
          "confidence": 0.92,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Wildcard\u2011style matching could catch some unknown variants"
            ],
            "weaknesses": [
              "Relies on a single static string, ignoring common evasion tactics",
              "Does not account for alternative tools or command\u2011line obfuscation"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule provides only a generic title, vague description, and an undefined ATT&CK tag (attack.unknown). It lacks proper technique/tactic IDs, authoritative references, threat\u2011actor or campaign context, and detailed detection rationale.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Includes a title and brief description",
              "Specifies a false\u2011positive note and severity level"
            ],
            "weaknesses": [
              "Missing correct MITRE ATT&CK technique and tactic identifiers",
              "No references to research, tools, or threat actors"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection uses a simple `contains` on the CommandLine field, which avoids leading wildcards, but it does not leverage indexed fields (e.g., EventID) or additional restrictive filters, leading to high query volume and poor SIEM performance.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Avoids leading wildcards and uses a simple operator",
              "Logsource is correctly scoped to Windows process creation"
            ],
            "weaknesses": [
              "No use of indexed fields or event identifiers",
              "Overly broad \"suspicious\" string creates many matches"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule does not capture any concrete behaviors associated with Exfiltration Over C2 Channel (e.g., use of PowerShell, certutil, custom C2 binaries, or known frameworks). It therefore fails to cover the technique or its variants.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Attempts to address the intended technique in its title"
            ],
            "weaknesses": [
              "No specific indicators for C2\u2011based exfiltration",
              "Ignores sub\u2011techniques, tools, and multi\u2011stage aspects"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "Only a generic false\u2011positive comment is provided; there are no explicit whitelists, parent\u2011child relationships, time\u2011based thresholds, or other filters to limit noise from legitimate administrative activity.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate admin activity as a possible false positive"
            ],
            "weaknesses": [
              "Lacks concrete exclusion criteria or contextual enrichment",
              "No frequency or correlation logic to reduce spurious alerts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule does not reference any real-world threat actor, campaign, or specific tool usage; it only uses a generic \"suspicious\" string and an unknown ATT&CK ID. Consequently it shows minimal awareness of actual TTPs.",
          "confidence": 0.85,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Includes an ATT&CK tag (though undefined)",
              "Attempts to map to a technique name"
            ],
            "weaknesses": [
              "No concrete threat intel or campaign context",
              "Generic keyword does not reflect real exfiltration behavior"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The Sigma syntax is valid and uses a common Windows process_creation logsource, but the detection logic is overly broad, likely generating many false positives and has no evidence of testing or validation.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Correct Sigma structure with no syntax errors",
              "Logsource is available in typical enterprise environments"
            ],
            "weaknesses": [
              "High false\u2011positive risk due to vague \"suspicious\" match",
              "No validation or tuning information provided"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "Alert titles and descriptions are vague, and the rule only surfaces a command\u2011line string without additional context (user, process hash, network endpoints) that analysts could use for investigation.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Title mentions the intended technique",
              "Provides a severity level"
            ],
            "weaknesses": [
              "Lacks actionable fields for triage",
              "Description offers no guidance for response"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The detection relies solely on a static command\u2011line substring, which can be easily avoided by renaming, encoding, or using LOLBins. No multi\u2011vector or behavioral correlation is present.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Monitors process creation events"
            ],
            "weaknesses": [
              "Single static indicator is trivially bypassed",
              "No coverage of network or file activity"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection rule focuses on identifying Exfiltration Over C2 Channel activity via NLP pattern matching, specifically targeting process creation events on Windows systems. It detects data exfiltration activities but lacks comprehensive coverage across multiple stages of the attack lifecycle. The rule's logic is primarily based on single-event detection, lacking correlation across multiple related events or stages.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:37:07.862420",
          "metadata": {
            "strengths": [
              "Targets specific exfiltration technique",
              "Utilizes NLP pattern matching for detection"
            ],
            "weaknesses": [
              "Limited to single-event detection",
              "Lacks correlation across multiple stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Exfiltration Over C2 Channel) scored 0.19/1.0 (Poor). Best performance in realism (0.26). Needs improvement in correctness (0.14). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2026-01-20T17:37:07.862420",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Exfiltration Over C2 Channel",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.42500000000000004,
      "category_scores": {
        "correctness": 0.4800000000000001,
        "quality": 0.4411764705882353,
        "effectiveness": 0.39333333333333337,
        "realism": 0.5555555555555556,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma rule provided has most of the required fields populated, such as title, id, description, logsource, detection, and level. However, some fields like references, author, and date are missing, which reduces its completeness.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Properly populated logsource and detection fields",
              "Includes a description and level"
            ],
            "weaknesses": [
              "Missing references, author, and date fields",
              "Lack of comprehensive tags"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection logic relies on a simple 'contains' condition for 'suspicious' in the CommandLine, which may not accurately capture the Exploit Public-Facing Application technique. The logic is straightforward but might be too simplistic and prone to false positives.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Simple and easy to understand logic",
              "Attempts to filter based on command line input"
            ],
            "weaknesses": [
              "Overly simplistic and potentially prone to false positives",
              "Does not account for various evasion techniques"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule attempts to minimize false positives by specifying a condition for 'suspicious' activity. However, the use of a broad term like 'suspicious' without further context or filtering may still lead to false positives, especially in environments with diverse and complex administrative activities.",
          "confidence": 0.75,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Attempts to filter out benign activity with the 'suspicious' condition",
              "Specifies a log source category"
            ],
            "weaknesses": [
              "Lack of precise filtering or exclusion of legitimate tools",
              "May not adequately consider diverse administrative activities"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection rule is quite narrow and may not catch variations of the Exploit Public-Facing Application technique. It does not account for different tools, techniques, or evasion methods that attackers might use, making it less sensitive to real-world threats.",
          "confidence": 0.6,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Covers a basic scenario of the technique"
            ],
            "weaknesses": [
              "Too narrow and may miss attack variations",
              "Does not consider evasion techniques or different tools"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes some metadata, such as the technique name and MITRE reference, but lacks comprehensive information like threat actor details, campaign names, and tools associated with the technique. The description is brief and does not fully explain what the rule detects. However, it does include a log source and detection logic.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Includes MITRE reference",
              "Log source specified"
            ],
            "weaknesses": [
              "Lacks threat actor information",
              "Description is too brief"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses a simple detection logic with a 'contains' operator, which is efficient. However, it does not utilize indexed fields first and lacks specific filters to reduce query execution time. The log source is specific to Windows process creation, which is a good practice.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Simple detection logic",
              "Specific log source"
            ],
            "weaknesses": [
              "Does not use indexed fields first",
              "Lacks specific filters"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only detects a basic variant of the Exploit Public-Facing Application technique and does not consider sub-techniques, advanced variants, or different tools and frameworks. It also does not account for multi-stage attacks.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Detects basic variant of the technique"
            ],
            "weaknesses": [
              "Does not consider sub-techniques or advanced variants",
              "Lacks coverage of different tools and frameworks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes a basic filter to exclude legitimate administrative activity, but it lacks specific exclusions for known legitimate processes, users, or paths. It also does not consider time-based or frequency-based logic.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Includes basic filter for legitimate activity"
            ],
            "weaknesses": [
              "Lacks specific exclusions for legitimate processes or users",
              "Does not consider time-based or frequency-based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection logic aligns with the general concept of exploiting public-facing applications but lacks specific references to real-world threat actor TTPs, campaigns, or APT groups. The rule does not demonstrate a deep understanding of threat actor preferences or operational intelligence. However, it does attempt to match a pattern that could be indicative of such exploitation.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Attempts to detect exploitation patterns",
              "References a specific technique"
            ],
            "weaknesses": [
              "Lacks specific TTP references",
              "Does not consider threat actor preferences"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma rule structure appears to be syntactically correct and references a realistic log source. However, the detection logic is relatively simple and relies on a generic 'suspicious' keyword, which might lead to false positives. The rule has not been explicitly validated or tested, which could impact its effectiveness in a production environment.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Syntactically correct Sigma rule",
              "Realistic log source"
            ],
            "weaknesses": [
              "Simple detection logic",
              "Potential for false positives"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule title clearly describes the detection, but the description lacks sufficient context for immediate investigation and response. The fields in detection are somewhat useful but could be more comprehensive. The severity level is set to medium, which might not always reflect the actual risk, and false positive guidance is limited.",
          "confidence": 0.6,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Clear rule title",
              "Some useful detection fields"
            ],
            "weaknesses": [
              "Lacks detailed description",
              "Limited false positive guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is vulnerable to evasion techniques as it relies on a simple string match ('suspicious') in the command line, which can be easily obfuscated or renamed. It does not detect behavior patterns or use multiple detection points, making it less robust against common evasion techniques.",
          "confidence": 0.5,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Attempts to detect command line anomalies"
            ],
            "weaknesses": [
              "Easily evaded by obfuscation or renaming",
              "Lacks behavioral detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection rule focuses on a single event of process creation with a suspicious command line, lacking the ability to detect the technique at multiple stages of the attack lifecycle. It does not account for persistence, lateral movement, or data collection activities. The rule's logic is limited to a single-event detection.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:38:07.097179",
          "metadata": {
            "strengths": [
              "Simple and straightforward detection logic",
              "Easy to implement and understand"
            ],
            "weaknesses": [
              "Lacks multi-stage detection capabilities",
              "May not detect advanced or evasive attacks"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Exploit Public-Facing Application) scored 0.43/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.26). Issues found in: detection_logic_correctness, detection_specificity, detection_sensitivity",
      "timestamp": "2026-01-20T17:38:07.097179",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Exploit Public-Facing Application",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "4bacc330-2969-46dd-b6bc-1a7bc5b30d30",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.42500000000000004,
      "category_scores": {
        "correctness": 0.4800000000000001,
        "quality": 0.4411764705882353,
        "effectiveness": 0.39333333333333337,
        "realism": 0.5555555555555556,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule has most required Sigma fields, but some fields like 'status', 'author', and 'date' are missing or not properly populated. The 'references' field is also not provided, which could be useful for further context.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Has a clear title and description",
              "Includes logsource and detection fields"
            ],
            "weaknesses": [
              "Missing some required fields",
              "Lack of references"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection logic is simplistic and relies on a single 'contains' condition, which may not accurately identify the 'Archive Collected Data' technique. The condition logic is not overly complex but may not be sound for real-world threat hunting.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Uses standard Sigma fields",
              "Has a clear condition logic"
            ],
            "weaknesses": [
              "Simplistic detection logic",
              "May not accurately identify the technique"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses a 'contains' condition, which may lead to false positives. However, it does include a 'falsepositives' field, which acknowledges potential benign activity. The rule could be more specific with additional filters or conditions.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Acknowledges potential false positives",
              "Uses a clear condition logic"
            ],
            "weaknesses": [
              "May lead to false positives",
              "Lack of additional filters"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is not sensitive enough to catch attack variations and evasion attempts. It relies on a single 'contains' condition, which can be easily evaded by renaming or obfuscating the command.",
          "confidence": 0.6,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Uses a clear condition logic"
            ],
            "weaknesses": [
              "Not sensitive to attack variations",
              "Can be easily evaded"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes some metadata, such as MITRE ATT&CK tags and a reference to the technique name, but lacks comprehensive information for context and investigation. It does not include references to authoritative sources, threat actor information, or clear descriptions of what the rule detects. The provided metadata is limited and does not fully support investigation.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "References technique name"
            ],
            "weaknesses": [
              "Lacks comprehensive metadata",
              "No references to authoritative sources"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses a simple detection logic with a 'contains' operator, which is efficient. However, it does not prioritize indexed fields, and the use of 'contains' with 'suspicious' might lead to performance issues if not properly optimized. The log source is specific to Windows process creation, which is a good practice.",
          "confidence": 0.9,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Simple detection logic",
              "Specific log source"
            ],
            "weaknesses": [
              "Does not prioritize indexed fields",
              "Potential performance issue with 'contains' operator"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects Archive Collected Data activity via NLP pattern matching but does not cover various attack techniques and variations. It lacks consideration of sub-techniques, different tools, and frameworks, as well as multi-stage attacks. The rule seems to focus on a basic detection method without accounting for sophisticated variants.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Detects Archive Collected Data activity"
            ],
            "weaknesses": [
              "Lacks coverage of sub-techniques and variations",
              "Does not consider multi-stage attacks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes a basic filter with a 'contains' operator but lacks effective filters and exclusions to reduce false positives. It mentions legitimate administrative activity as a potential false positive but does not implement specific logic to exclude such activity. The rule could benefit from more detailed filtering and whitelisting.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Mentions potential false positives",
              "Basic filter in place"
            ],
            "weaknesses": [
              "Lacks effective filters and exclusions",
              "No whitelisting of admin tools"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The detection rule lacks specific references to real-world campaigns, APT groups, or operations, and its logic is based on a generic 'suspicious' command-line argument. However, it does attempt to detect a specific technique. The rule could be improved with more context about threat actor TTPs and preferences.",
          "confidence": 0.7,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Detects specific technique",
              "Simple logic"
            ],
            "weaknesses": [
              "Lacks real-world context",
              "Generic detection logic"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma rule is syntactically correct and has a realistic log source, but its detection logic is relatively simple and may not be robust against evasion techniques. The severity level is set to 'medium', which may be appropriate, but the false positive rate is not well-evaluated.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Syntactically correct",
              "Realistic log source"
            ],
            "weaknesses": [
              "Simple detection logic",
              "Unclear false positive rate"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule title and description provide some context, but the detection fields are limited, and there is no clear guidance for next steps in investigation and remediation. The severity level is set, but the rule could be improved with more actionable information.",
          "confidence": 0.6,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Clear rule title",
              "Some context provided"
            ],
            "weaknesses": [
              "Limited detection fields",
              "No clear next steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies on a simple command-line argument check, which can be easily evaded by renaming executables or files, or by hiding command-line arguments. The rule does not detect behavior patterns or relationships, and it does not consider obfuscation attempts.",
          "confidence": 0.5,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Simple to implement"
            ],
            "weaknesses": [
              "Easily evaded",
              "No behavior pattern detection"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection rule only identifies the 'Archive Collected Data' activity via NLP pattern matching on the command line, lacking the ability to detect multiple stages of the attack lifecycle. It focuses on a single event without correlating across related events or stages. The rule's logic does not encompass the broader attack sequence.",
          "confidence": 0.8,
          "timestamp": "2026-01-20T17:39:16.161437",
          "metadata": {
            "strengths": [
              "Specific detection of 'Archive Collected Data' activity",
              "Utilizes NLP pattern matching for detection"
            ],
            "weaknesses": [
              "Limited to single-event detection",
              "Lacks correlation across multiple related events or stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Archive Collected Data) scored 0.43/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.26). Issues found in: detection_logic_correctness, detection_specificity, detection_sensitivity",
      "timestamp": "2026-01-20T17:39:16.162457",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Archive Collected Data",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    }
  ]
}