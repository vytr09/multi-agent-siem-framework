{
  "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
  "timestamp": "2025-12-28T15:17:23.218481",
  "config": {
    "llm_judge": {
      "enabled": true,
      "api_key": "<REDACTED>",
      "model": "llama-3.3-70b",
      "temperature": 0.1,
      "max_tokens": "<REDACTED>",
      "timeout": 60,
      "persona": "expert cybersecurity researcher and red team operator with deep knowledge of MITRE ATT&CK framework and detection engineering",
      "detailed_feedback": true,
      "confidence_scores": true,
      "enable_comparison": true,
      "max_requests_per_minute": 60,
      "retry_attempts": 3,
      "retry_delay": 2
    },
    "attackgen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "high_quality_threshold": 0.85,
      "metrics": {
        "technical_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "attack_alignment": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "platform_compatibility": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "operational_realism": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "threat_actor_alignment": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "testing_safety": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "controlled_impact": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "detection_value": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "artifact_generation": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "completeness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "documentation_quality": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        }
      },
      "top_performers_count": 10,
      "bottom_performers_count": 5,
      "enable_comparative_analysis": true,
      "export_format": "json",
      "export_detailed_results": true,
      "export_statistics": true
    },
    "rulegen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "metrics": {
        "sigma_completeness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_logic_correctness": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "platform_syntax_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "field_mapping_accuracy": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_specificity": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_sensitivity": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "metadata_richness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "optimization_level": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "attack_coverage": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "false_positive_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "contextual_awareness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "operational_deployability": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "performance_efficiency": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "analyst_actionability": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "evasion_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "multi_stage_detection": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        }
      }
    },
    "general": {
      "max_concurrent_evaluations": 3,
      "batch_size": 5,
      "enable_caching": true,
      "cache_ttl": 3600,
      "log_level": "INFO",
      "log_file": "logs/benchmark.log",
      "log_format": "json",
      "output_directory": "data/benchmark_results",
      "create_timestamp_subdirs": true,
      "calculate_statistics": true,
      "generate_summary_report": true,
      "export_csv": true,
      "generate_plots": false,
      "plot_format": "png"
    },
    "comparison": {
      "enabled": true,
      "criteria": [
        "overall quality",
        "technical correctness",
        "operational realism",
        "testing safety"
      ],
      "significant_difference_threshold": 0.1
    },
    "regression": {
      "enabled": false,
      "baseline_file": "baselines/attackgen_baseline.json",
      "alert_on_degradation": true,
      "degradation_threshold": 0.05,
      "track_history": true,
      "history_file": "history/benchmark_history.json"
    },
    "alerting": {
      "enabled": false,
      "low_score_threshold": 0.5,
      "alert_channels": [
        "email",
        "slack"
      ],
      "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "from_address": "benchmark@example.com",
        "to_addresses": [
          "team@example.com"
        ]
      },
      "slack": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#siem-benchmarks"
      }
    },
    "advanced": {
      "ensemble_evaluation": {
        "enabled": false,
        "models": [
          "gemini-2.0-flash-lite"
        ],
        "aggregation_method": "weighted_average"
      },
      "ground_truth": {
        "enabled": false,
        "dataset_path": "datasets/ground_truth.json",
        "calculate_accuracy": true
      },
      "custom_metrics": {
        "enabled": false,
        "metrics_file": "config/custom_metrics.yaml"
      },
      "debug": {
        "enabled": false,
        "save_prompts": true,
        "save_responses": true,
        "verbose_logging": true
      }
    }
  },
  "statistics": {
    "total_evaluations": 17,
    "average_score": 0.5083333333333334,
    "category_averages": {
      "correctness": 0.5894117647058822,
      "quality": 0.5439446366782007,
      "effectiveness": 0.4635294117647058,
      "realism": 0.5640522875816993,
      "detectability": 0.36993464052287583
    },
    "metric_averages": {
      "sigma_completeness": 0.6000000000000001,
      "detection_logic_correctness": 0.5823529411764706,
      "detection_specificity": 0.48235294117647054,
      "detection_sensitivity": 0.5470588235294117,
      "metadata_richness": 0.5529411764705882,
      "optimization_level": 0.6529411764705884,
      "attack_coverage": 0.48235294117647065,
      "false_positive_resistance": 0.388235294117647,
      "contextual_awareness": 0.5294117647058824,
      "operational_deployability": 0.5352941176470588,
      "analyst_actionability": 0.6000000000000001,
      "evasion_resistance": 0.388235294117647,
      "multi_stage_detection": 0.3470588235294117
    },
    "score_distribution": {
      "excellent (>=0.9)": 0,
      "good (0.8-0.9)": 0,
      "fair (0.7-0.8)": 4,
      "poor (0.6-0.7)": 0,
      "failing (<0.6)": 13
    }
  },
  "results": [
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.23166666666666666,
      "category_scores": {
        "correctness": 0.33999999999999997,
        "quality": 0.18823529411764706,
        "effectiveness": 0.19333333333333336,
        "realism": 0.2888888888888889,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks several required Sigma fields such as author, date, status, and references. While core fields like title, id, logsource, detection, and level are present, tags include a non-standard 'attack.unknown' and missing proper MITRE ATT&CK mapping. The description is generic and does not reference Tunna-specific behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Contains basic structure: title, id, logsource, detection, level",
              "Includes falsepositives and tags"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, references",
              "Uses placeholder-like 'attack.unknown' tag without valid MITRE mapping"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is nonsensical and will never match real Tunna usage. It fails to include actual indicators like 'tunna', 'plink', or tunneling syntax. The condition is overly simplistic and does not reflect the behavior of HTTP tunneling tools.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Correctly targets process creation events on Windows",
              "Uses standard field name 'CommandLine'"
            ],
            "weaknesses": [
              "Selection term 'suspicious' is meaningless and non-functional",
              "No alignment with actual Tunna command-line patterns or proxy behaviors"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is extremely broad and would generate massive false positives due to the generic 'suspicious' string match. It lacks filters for parent processes, users, or known Tunna command structures. No attempt to differentiate malicious tunneling from legitimate admin tools like PowerShell remoting or SSH.",
          "confidence": 0.97,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Targets process creation, which is appropriate for execution-phase detection"
            ],
            "weaknesses": [
              "Wildcard-free but uses a non-discriminative term",
              "No context such as parent process, image path, or user to reduce noise"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule is not sensitive to any real variation of Tunna or proxy tools. Using 'suspicious' as a literal string makes it trivial to evade. It does not account for obfuscation, encoding, or alternative tools like reGeorg or Chisel. Case-insensitive matching is implied but irrelevant given the flawed logic.",
          "confidence": 0.96,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Conceptually aims to detect tunneling behavior"
            ],
            "weaknesses": [
              "No support for encoded commands or common tool variations",
              "Fails to detect even basic Tunna command-line syntax"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks accurate MITRE ATT&CK mapping, using 'attack.unknown' instead of a valid technique ID like T1090 (Proxy) or T1572 (Protocol Tunneling). The description mentions Tunna but provides no references to research, threat actors, or malware families, limiting investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Includes basic description of Tunna usage",
              "Tags field is present though incorrect"
            ],
            "weaknesses": [
              "Invalid MITRE ATT&CK ID and tactic mapping",
              "No references to authoritative sources or threat intelligence"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection relies solely on 'CommandLine|contains' with the generic term 'suspicious', which is unindexed, non-specific, and will trigger full-text scans. It lacks field specificity, proper operator use, and efficient filtering, leading to poor performance in large environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Uses process_creation category, which is commonly indexed",
              "Condition logic is simple and parseable"
            ],
            "weaknesses": [
              "Uses non-selective 'contains' with vague keyword",
              "No use of startswith/endswith or field equality for optimization"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule fails to cover known variants of proxy/tunneling tools beyond a single mention of Tunna. It does not detect common tools like plink, nc, or chisel, nor does it map to MITRE techniques such as T1572 (Protocol Tunneling) or T1090 (Proxy). Coverage is minimal and not representative of real-world usage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Identifies concept of HTTP tunneling in description",
              "Targets process creation on Windows"
            ],
            "weaknesses": [
              "No detection logic for actual tunneling tools or patterns",
              "Ignores sub-techniques and multi-stage attack behaviors"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule has no built-in filters to exclude legitimate administrative tools or trusted execution paths. The falsepositive list is vague ('Legitimate administrative activity') and offers no actionable guidance, making it highly prone to noise in production environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Acknowledges potential for false positives",
              "Includes falsepositives array"
            ],
            "weaknesses": [
              "No exclusion logic in detection (e.g., Image path, user context)",
              "Generic false positive note without mitigation strategies"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks alignment with real-world TTPs, as it uses a generic 'suspicious' keyword without reflecting actual Tunna command-line patterns observed in attacks. There is no reference to specific APT groups, campaigns, or documented attack chains involving Tunna.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Mentions Tunna web shell in description",
              "Targets execution phase"
            ],
            "weaknesses": [
              "Generic detection pattern not tied to real-world usage",
              "No MITRE ATT&CK mapping to known technique (e.g., T1090)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains a vague 'CommandLine|contains' condition that will generate excessive false positives in production. SIEM verification failed with HTTP 503, indicating it hasn't been validated in a real environment.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Uses common logsource (process_creation on Windows)",
              "Defined false positives"
            ],
            "weaknesses": [
              "Unrealistic detection logic with high noise",
              "Verification failed \u2013 not tested successfully"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title and description provide minimal context for investigation, and the detection does not extract actionable fields like IP addresses, ports, or process hashes. False positive guidance is too generic.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Title clearly states detection goal",
              "Includes basic false positive note"
            ],
            "weaknesses": [
              "Lacks key telemetry for pivoting",
              "No references to MITRE or threat reports"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule relies solely on a weak string match in the command line, which attackers can easily bypass via obfuscation, encoding, or living-off-the-land binaries. It lacks behavioral or multi-stage detection logic.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Focuses on process creation, a visible artifact",
              "Potential to catch unobfuscated samples"
            ],
            "weaknesses": [
              "Easily evaded by simple obfuscation",
              "No defense-in-depth detection strategy"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule relies solely on a single process creation event with a generic 'suspicious' command-line indicator, offering no capability to detect multiple stages of the attack lifecycle. It lacks logic to identify initial access, persistence, lateral movement, or exfiltration related to Tunna or proxy usage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:04.930483",
          "metadata": {
            "strengths": [
              "Clearly defines process creation as the detection point, which is relevant to execution.",
              "Targets command-line arguments, a common location for malicious indicators."
            ],
            "weaknesses": [
              "Detection based on 'suspicious' is overly vague and non-specific to Tunna or proxy behavior.",
              "No correlation across events or stages; purely single-event, atomic detection."
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Proxy) scored 0.23/1.0 (Poor). Best performance in correctness (0.34). Needs improvement in quality (0.19). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-28T15:05:04.930483",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Proxy",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4716666666666667,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.5176470588235295,
        "effectiveness": 0.4666666666666667,
        "realism": 0.48888888888888893,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces traceability and governance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic captures basic indicators of user execution via common tools but is overly simplistic. Matching 'CommandLine|contains' '.dll' for rundll32.exe is too broad and will miss obfuscated or encoded payloads while triggering on legitimate use. Conditions lack precision and do not reflect actual attack patterns reliably.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Covers multiple execution vectors (rundll32, PowerShell, sc, cscript)",
              "Maps to relevant system binaries used in execution"
            ],
            "weaknesses": [
              "Overly broad detection (e.g., any .dll in command line)",
              "No validation of malicious intent or context"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks specificity due to broad string matches without contextual filtering (e.g., parent process, command structure). For example, 'webshell' in PowerShell command line could appear in comments or benign scripts. No exclusion of known safe patterns reduces operational viability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Identifies high-risk binaries commonly abused",
              "Acknowledges false positives in documentation"
            ],
            "weaknesses": [
              "No use of regex or structured command-line parsing",
              "Lacks filters for parent process, user context, or path"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic forms of the TTP but is vulnerable to simple evasion like obfuscation, case variation, or alternative syntax. It does not use case-insensitive matching or regex to catch encoded commands. While it covers multiple tools, sensitivity is limited by rigid string containment checks.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Covers multiple execution methods (DLL, script, driver)",
              "Detects use of uncommon file types like .wsf and .sys in context"
            ],
            "weaknesses": [
              "No case-insensitive or regex-based pattern matching",
              "Easily bypassed by command obfuscation or encoding"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (attack.execution, T1204) and a clear description, but lacks specific technique IDs (e.g., T1059.001, T1218.011), references to authoritative sources like MITRE sub-techniques, and attribution to known threat actors or malware families. The description is functional but could better explain context and detection rationale.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Includes correct MITRE tactic and technique tags",
              "Provides a clear rule description and false positive list"
            ],
            "weaknesses": [
              "Missing specific MITRE sub-technique IDs (e.g., T1218.011 for rundll32)",
              "No references to threat actors, malware families, or external research"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field filters (Image endsWith, CommandLine contains) on indexed fields and avoids leading wildcards. However, 'CommandLine|contains' with '.dll' or '.sys' is broad and may trigger on benign usage; more specificity would improve performance. Detection logic is flat and simple, aiding execution speed.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Uses indexed fields and efficient endswith operators",
              "Avoids complex regex and leading wildcards"
            ],
            "weaknesses": [
              "Overuse of 'contains' with generic strings increases noise",
              "Lacks ordering of most restrictive conditions first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule covers basic vectors like rundll32, PowerShell, sc.exe, and cscript but misses advanced variants such as reflective DLL loading, signed malicious drivers, or use of other execution tools (e.g., mshta, regsvr32). It does not account for obfuscation, encoding, or multi-stage delivery common in real-world attacks.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Covers common execution binaries (rundll32, sc.exe, etc.)",
              "Includes multiple attack paths (DLL, script, driver)"
            ],
            "weaknesses": [
              "Lacks coverage of obfuscated command lines or encoded payloads",
              "Misses detection of alternative execution methods (e.g., mshta, regsvr32, wmic)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists common false positives but lacks built-in filters to exclude them\u2014no parent process checks, path whitelisting, or user context. For example, legitimate 'rundll32.exe' usage with system32 DLLs is not excluded. Reliance on single-event triggers increases FP risk without behavioral context.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Acknowledges key false positive scenarios in metadata",
              "Focuses on user-initiated execution context"
            ],
            "weaknesses": [
              "No exclusion logic for system paths or trusted parents",
              "No use of frequency or pattern-based detection to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common execution methods used in real attacks, such as rundll32.exe loading DLLs and sc.exe installing drivers, which align with known TTPs. However, it lacks specificity to actual adversary behavior patterns, such as known malicious command-line templates or associations with specific APT groups or campaigns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Aligns with basic User Execution TTPs in MITRE ATT&CK",
              "Covers multiple execution vectors (DLL, script, driver)"
            ],
            "weaknesses": [
              "No reference to real-world adversary usage or campaign context",
              "Detection patterns are generic and textbook-like"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule has structural issues: the detection logic is overly broad and will generate high false positives (e.g., any PowerShell command with 'webshell' in comment). Additionally, the SIEM verification failed (HTTP 503), indicating untested or broken deployment status.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Uses common Sysmon process creation logging",
              "Targets widely available Windows binaries"
            ],
            "weaknesses": [
              "High false positive risk due to weak string matching",
              "Untested in SIEM with verification failure"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule title and description clearly state what is being detected, and false positives are well-documented, aiding analyst triage. However, it lacks enrichment fields (e.g., hashes, parent process) that would support deeper investigation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Clear title and description for analyst understanding",
              "Comprehensive false positive guidance"
            ],
            "weaknesses": [
              "Missing key forensic fields for pivoting",
              "No references to MITRE IDs or response playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies heavily on easily evaded command-line string matches and does not account for obfuscation, encoding, or alternative execution paths. Attackers can bypass detection by renaming files, using base64-encoded commands, or leveraging other LOLBins not covered.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Covers multiple execution vectors, increasing coverage",
              "Uses process creation monitoring, a reliable data source"
            ],
            "weaknesses": [
              "Highly susceptible to command-line obfuscation",
              "No behavioral or multi-stage detection logic"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects initial execution events via process creation but does not correlate across multiple stages or subsequent malicious behaviors. It focuses solely on single-event command-line patterns without chaining related activities or establishing behavioral context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:05:39.985815",
          "metadata": {
            "strengths": [
              "Covers initial execution vectors for multiple implant types (DLL, web shell, driver)",
              "Includes detection logic for several common execution tools (rundll32, PowerShell, sc, cscript)"
            ],
            "weaknesses": [
              "No correlation across events or attack stages (e.g., post-installation persistence or C2 activity)",
              "Relies on simplistic string matches without behavioral or contextual analysis"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (User Execution of Custom Web Shells, DLL Backdoors, or Driver Implants) scored 0.47/1.0 (Poor). Best performance in correctness (0.54). Needs improvement in detectability (0.30). Issues found in: detection_logic_correctness, detection_specificity, detection_sensitivity",
      "timestamp": "2025-12-28T15:05:39.985815",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "User Execution of Custom Web Shells, DLL Backdoors, or Driver Implants",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5283333333333332,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.5411764705882353,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5888888888888889,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and level. However, it lacks mandatory fields like 'id' in standard Sigma format (despite having a UUID, it's not under 'id' key in proper structure), 'status', 'author', 'date', and 'references'. The 'generation_method' and 'siem_verification' are non-standard additions.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, detection logic, logsource, tags, and falsepositives",
              "Properly tags MITRE ATT&CK technique (attack.t1190)"
            ],
            "weaknesses": [
              "Missing required Sigma fields: status, author, date, references",
              "Uses non-standard keys like 'generation_method' and 'siem_verification'"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly targets msxsl.exe executing commands with 'FOXSHELL' or '1.aspx', which aligns with known post-exploitation behavior using XSL transformation for code execution. The use of CommandLine|contains is appropriate for identifying malicious payloads, though it assumes clear-text indicators. The condition is simple and valid.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Accurately models known TTP using msxsl.exe as a living-off-the-land binary",
              "Targets high-fidelity indicators (FOXSHELL, 1.aspx) tied to real web shell deployments"
            ],
            "weaknesses": [
              "Relies solely on command line strings that may be obfuscated or encoded",
              "Does not validate that this is truly post-exploitation of a public-facing app"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses specific string matches which help reduce noise, but lacks contextual filters such as parent process, user context (e.g., IIS apppool), or command-line structure that would distinguish malicious from rare legitimate use. It could trigger on benign scripts containing '1.aspx' or 'FOXSHELL' as text.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Uses targeted string matches in command line for high-signal artifacts",
              "Acknowledges low likelihood of benign matches in falsepositives"
            ],
            "weaknesses": [
              "No exclusion of legitimate msxsl.exe usage by administrators or scripts",
              "Missing parent process context (e.g., w3wp.exe) to tie to web server exploitation"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is brittle to evasion: attackers can easily obfuscate 'FOXSHELL' or '1.aspx' via encoding, case variation, or string splitting. It lacks regex or case-insensitive matching and does not account for alternative file names or paths. It focuses on one specific variant without covering broader XSL-based execution patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Covers two distinct IOCs (FOXSHELL, 1.aspx) increasing coverage slightly",
              "Targets a known web shell (FOXSHELL) with documented usage"
            ],
            "weaknesses": [
              "No case-insensitive or regex-based pattern matching",
              "Vulnerable to simple obfuscation and renaming tactics"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tagging (T1190) and a clear description, but lacks references to authoritative sources, threat actors, or malware families. The technique name and tactic are partially accurate, though T1190 is under Initial Access, not Execution.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1190)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing MITRE reference link and CVEs",
              "No attribution to threat actors or campaigns"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) on indexed fields with no leading wildcards. The logsource is specific to Sysmon process creation, and the detection logic is flat and fast-executing.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Uses indexed fields efficiently",
              "No leading wildcards or complex regex"
            ],
            "weaknesses": [
              "CommandLine|contains with multiple strings could be optimized with order of specificity",
              "Could use 'icontains' if case-insensitive search is needed"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic indicators of msxsl.exe abuse with FOXSHELL or 1.aspx, but misses broader attack chains, alternate command lines, or secondary stages. It does not cover related sub-techniques (e.g., T1204.002) or other XSL execution methods.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Covers known IOC-based indicators of FOXSHELL",
              "Targets misuse of msxsl.exe for code execution"
            ],
            "weaknesses": [
              "Limited to two command-line strings; easily bypassed",
              "No coverage of follow-on execution or lateral movement"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks parent-process context, user context, or frequency-based logic, increasing false positive risk. The falsepositive field acknowledges risk but offers no actionable exclusions or mitigation strategies.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Acknowledges uncommon legitimate use of keywords",
              "Targets a rare binary (msxsl.exe) in suspicious context"
            ],
            "weaknesses": [
              "No parent-child process filtering (e.g., w3wp.exe spawning msxsl)",
              "No exclusions for authorized admin tools or paths"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with known use of msxsl.exe as a LOLBin in public-facing application exploits and references FOXSHELL, a documented web shell. However, it lacks specific campaign or APT group references and does not incorporate broader attack chain context such as initial access vectors or follow-on activities.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Targets msxsl.exe abuse, a legitimate tool used in real-world exploitation chains",
              "Includes indicators tied to known FOXSHELL web shell activity"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns using this technique",
              "Lacks context on how this fits into broader exploitation sequences"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma rule syntax is valid and uses common Sysmon Event ID 1 (process creation), but the siem_verification failed with HTTP 503, indicating untested deployment. The false positive guidance is minimal, and the detection relies solely on command-line strings that may vary in real environments.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Uses standard logsource (Sysmon process creation) widely available in enterprises",
              "Clear detection condition with realistic field usage"
            ],
            "weaknesses": [
              "Untested in SIEM (verification failed), raising concerns about real-world performance",
              "Potential for false positives from benign scripts containing '1.aspx' or 'FOXSHELL'"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The title and description clearly indicate what is being detected\u2014malicious msxsl.exe execution linked to a known web shell. Analysts can pivot on process command line and image path, though additional fields like user context or parent process would improve investigation depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection rationale",
              "Provides actionable strings for triage (FOXSHELL, 1.aspx)"
            ],
            "weaknesses": [
              "Lacks inclusion of user, parent process, or network-related fields for pivoting",
              "No remediation or investigative next steps in description"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is highly vulnerable to evasion: attackers can easily obfuscate 'FOXSHELL' or '1.aspx' via encoding, rename web shells, or use alternative payloads. It relies solely on command-line content, which can be hidden or split, and does not correlate with file creation or network connections.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Detects use of msxsl.exe, which itself is a suspicious context when used on servers",
              "Focuses on a known malicious pattern rather than generic tool use"
            ],
            "weaknesses": [
              "Relies entirely on easily modified command-line strings",
              "No behavioral or multi-stage detection logic to resist obfuscation or LOLBin abuse"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only the initial execution stage via msxsl.exe command-line invocation with indicators tied to FOXSHELL or '1.aspx', but does not account for persistence, lateral movement, or exfiltration stages. There is no logic to correlate across multiple events or phases of post-exploitation activity.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:18.343725",
          "metadata": {
            "strengths": [
              "Detects initial execution using a known malicious command-line pattern.",
              "Focuses on a legitimate but rarely used Windows binary (msxsl.exe) in a suspicious context."
            ],
            "weaknesses": [
              "Limited to single-event detection without multi-stage correlation.",
              "No coverage of follow-on activities such as persistence or data exfiltration."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1190 (Exploit Public-Facing Application via Xsl Exec Shell and FOXSHELL Web Shell) scored 0.53/1.0 (Poor). Best performance in correctness (0.66). Needs improvement in detectability (0.36). Issues found in: detection_specificity, detection_sensitivity, attack_coverage",
      "timestamp": "2025-12-28T15:06:18.343725",
      "metadata": {
        "attack_id": "attack.t1190",
        "technique_name": "Exploit Public-Facing Application via Xsl Exec Shell and FOXSHELL Web Shell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.24000000000000002,
      "category_scores": {
        "correctness": 0.33999999999999997,
        "quality": 0.21764705882352942,
        "effectiveness": 0.19333333333333336,
        "realism": 0.2888888888888889,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks several required Sigma fields such as status, author, date, and references. While core fields like title, id, logsource, detection, and level are present, tags use a non-standard 'attack.unknown' and MITRE mapping is invalid. The description is generic and does not reference real-world obfuscation patterns.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Contains basic structure: title, id, logsource, detection, level",
              "Includes falsepositives and tags"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, references",
              "Uses invalid MITRE tag 'attack.unknown'"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is arbitrary and does not reflect actual obfuscation indicators like XOR patterns, encoded strings, or known obfuscators. This would fail to detect real obfuscated malware and likely trigger on benign strings containing 'suspicious'.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Uses standard field name 'CommandLine'",
              "Simple condition logic is easy to parse"
            ],
            "weaknesses": [
              "Selection term 'suspicious' is not indicative of obfuscation",
              "No alignment with actual TTP behaviors or IoCs"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is extremely broad, using a single substring match without context like parent process, user, or command structure. It will generate high false positives from any command line containing the word 'suspicious', including test scripts or logging tools. No exclusion logic is present.",
          "confidence": 0.97,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Focuses on process creation, relevant to execution phase",
              "Acknowledges false positives in description"
            ],
            "weaknesses": [
              "Overly broad detection based on a common English word",
              "Lacks contextual filters (e.g., parent process, image path)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is not sensitive to real obfuscation techniques such as Base64 encoding, XOR, or packed payloads. It would miss all variants unless they literally included the word 'suspicious'. No regex, case-insensitive matching, or multiple indicators are used to capture obfuscation diversity.",
          "confidence": 0.96,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Conceptually targets command-line arguments, a valid data source for obfuscation"
            ],
            "weaknesses": [
              "No support for encoded/obfuscated string patterns",
              "Fails to detect common obfuscation tools or methods"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks accurate MITRE ATT&CK mapping, using 'attack.unknown' instead of a valid technique ID like T1027. There are no references to authoritative sources, threat actors, malware families, or campaigns. The description is generic and does not explain how obfuscation manifests in logs.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Rule title aligns with MITRE technique name",
              "Includes basic description of obfuscation methods"
            ],
            "weaknesses": [
              "Invalid MITRE ATT&CK ID (attack.unknown)",
              "No references, threat context, or detailed technical explanation"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection uses a vague 'contains' operator on 'suspicious' in the command line, which is unindexed and inefficient. It lacks specificity, uses no field normalization, and has no optimization for performance. Leading wildcards are implied, and logsource is minimally specific.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Uses process_creation category, which is commonly indexed",
              "Simple condition improves parse speed"
            ],
            "weaknesses": [
              "Non-specific 'contains' on unstructured data",
              "No use of startswith/endswith or field-specific optimizations"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule fails to cover actual obfuscation techniques like XOR patterns, base64-encoded strings, or common obfuscators. It does not detect known tools (e.g., .NET obfuscators, PowerShell IEX) or sub-techniques under T1027. The detection logic is entirely generic and misses real-world indicators.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Targets process creation, a relevant log source",
              "Conceptually aligned with execution-phase obfuscation"
            ],
            "weaknesses": [
              "No detection of actual obfuscation patterns",
              "Ignores common tools, payloads, and encoding methods"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule has minimal FP resistance, relying only on a vague 'suspicious' string match with no exclusions for legitimate tools or administrative activity. No parent-child logic, frequency thresholds, or path-based whitelisting is implemented. The falsepositive field is too generic to be actionable.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Acknowledges potential for legitimate admin activity as FP"
            ],
            "weaknesses": [
              "No active filtering or exclusion logic",
              "Generic detection term 'suspicious' ensures high FP rate"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule references obfuscation techniques like XOR and method obfuscation, but the detection logic does not reflect real-world TTPs tied to specific adversaries or campaigns. The use of a generic 'suspicious' string lacks alignment with actual malware behaviors or known tooling.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Mentions specific obfuscation techniques (XOR, string encryption)",
              "Aligned with MITRE TTP 'Obfuscated Files or Information'"
            ],
            "weaknesses": [
              "No linkage to known threat actors or campaigns",
              "Detection pattern is generic and not based on real-world samples"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains a syntactically valid Sigma structure but relies on an unrealistic 'suspicious' command-line match, which will yield high false positives. The SIEM verification failed (HTTP 503), indicating lack of testing or validation in production.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Correct Sigma syntax and defined logsource",
              "Targets common Windows process creation logs"
            ],
            "weaknesses": [
              "Untested and failed SIEM verification",
              "Overly broad detection condition causes deployability issues"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title and description provide basic context about obfuscation, but the detection lacks key investigative fields (e.g., process path, user, hashes). False positive guidance is minimal, limiting analyst response efficiency.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Clear rule title indicating obfuscation detection",
              "Includes basic false positive note (administrative activity)"
            ],
            "weaknesses": [
              "No actionable telemetry fields in detection",
              "Lacks investigation pivots or enrichment guidance"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule relies solely on a static command-line string match, making it trivial to evade via simple obfuscation or alternative execution methods. It does not incorporate behavioral patterns or multi-stage detection logic to resist evasion.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Targets process creation, a common obfuscation vector",
              "Conceptually aware of obfuscation as a technique"
            ],
            "weaknesses": [
              "Easily bypassed by changing or encoding 'suspicious'",
              "No defense-in-depth or behavioral correlation"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is limited to detecting a single event\u2014process creation with a command line containing 'suspicious'\u2014and lacks logic to identify multiple stages of the attack lifecycle. It does not correlate across execution, persistence, lateral movement, or exfiltration phases, nor does it account for the broader behavioral patterns of obfuscation techniques.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:06:54.762237",
          "metadata": {
            "strengths": [
              "Focuses on process creation, a relevant entry point for detecting execution of obfuscated code",
              "Uses command-line monitoring, which can expose signs of obfuscation if properly tuned"
            ],
            "weaknesses": [
              "Relies on a generic string 'suspicious', which is not representative of actual obfuscation artifacts",
              "No multi-event correlation or stage progression detection"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Obfuscated Files or Information) scored 0.24/1.0 (Poor). Best performance in correctness (0.34). Needs improvement in effectiveness (0.19). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-28T15:06:54.762237",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Obfuscated Files or Information",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5466666666666666,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.6529411764705882,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5888888888888889,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, id, description, detection logic",
              "Properly tags MITRE ATT&CK technique (T1083)"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete structure for production deployment"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic partially aligns with T1083 (File and Directory Discovery) but incorrectly associates it with 'attack.discovery' instead of T1083 directly. The inclusion of '~/1.aspx' in command line checks is anomalous and appears to be a specific web shell artifact rather than a discovery command, introducing confusion. Parent process and user filters are relevant for web server context.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Uses appropriate parent process (w3wp.exe, inetinfo.exe) and user context (IIS APPPOOL, SYSTEM)",
              "Leverages standard Sigma field names"
            ],
            "weaknesses": [
              "Mixes generic discovery commands with a specific web shell path ('~/1.aspx')",
              "Incorrect or unclear TTP mapping (attack.discovery vs T1083)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule combines command-line indicators with parent process and user context, reducing false positives by focusing on non-interactive system accounts running discovery commands. However, 'csc.exe' as a parent image is questionable\u2014unusual for web server processes\u2014and could lead to missed detections or misattribution.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Multi-condition AND logic increases precision",
              "Filters on high-privilege, non-interactive users typical in compromised web apps"
            ],
            "weaknesses": [
              "Inclusion of 'csc.exe' as a web server parent process is technically inaccurate",
              "No exclusion of known benign tools or deployment scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common discovery commands (dir, ls, Get-ChildItem, find) with case-sensitive substring matching, but lacks case-insensitive modifiers or regex patterns that would catch obfuscated variants. It misses alternative discovery methods (e.g., wmic, powershell one-liners) and does not account for encoded commands often used in post-exploitation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Covers multiple OS-style discovery commands (Windows and Unix-like)",
              "Includes both native and PowerShell commands"
            ],
            "weaknesses": [
              "No case-insensitive matching or regex for obfuscation",
              "Limited coverage of advanced or encoded command variants"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1083) and a clear description, but lacks references to authoritative sources, threat actors, campaigns, or malware families. The description is functional but could provide more investigative context.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1083)",
              "Clear rule title and functional description"
            ],
            "weaknesses": [
              "Missing MITRE reference URL or CVE examples",
              "No attribution to threat actors or malware using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field filters like 'endswith' and 'startswith' on indexed fields (ParentImage, User), but 'CommandLine|contains' with generic terms like 'dir' and 'ls' may cause broad matching. The logsource is appropriately specific to Sysmon process creation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Uses efficient operators (endswith, startswith) on high-cardinality fields",
              "Logsource correctly scoped to Sysmon process creation"
            ],
            "weaknesses": [
              "CommandLine contains generic commands without argument context",
              "No ordering of conditions by selectivity in detection logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic file discovery commands from web contexts but misses advanced tools (e.g., certutil, bitsadmin, PowerShell one-liners) and alternative command-line syntax. It also incorrectly includes '\\csc.exe' as a parent, which is atypical for web server compromise.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Covers common discovery commands (dir, ls, Get-ChildItem)",
              "Targets web server processes (w3wp, inetinfo)"
            ],
            "weaknesses": [
              "Includes irrelevant parent '\\csc.exe' (C# compiler, not web server)",
              "Lacks coverage of encoded commands, obfuscated execution, or living-off-the-land binaries"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule includes some user and parent process filtering, but 'CommandLine|contains' on generic terms like 'dir' will trigger on legitimate scripts. The false positive list is vague and lacks specific exclusions for admin tools or deployment paths.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Filters on service accounts (IIS APPPOOL, SYSTEM)",
              "Acknowledges legitimate admin and deployment scripts as potential FPs"
            ],
            "weaknesses": [
              "No path or command argument restrictions to reduce noise",
              "Lacks frequency or threshold-based logic to distinguish normal ops"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs where attackers abuse web server processes for discovery, particularly via compromised IIS applications. However, inclusion of 'csc.exe' as a parent image is misleading\u2014it's a compiler, not a typical web server process\u2014and weakens contextual accuracy. The detection of '~/1.aspx' suggests awareness of web shell artifacts, which adds operational relevance.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Targets known web server processes (w3wp.exe, inetinfo.exe) commonly abused in attacks",
              "Includes command-line indicators tied to post-exploitation discovery"
            ],
            "weaknesses": [
              "Incorrect inclusion of csc.exe as a web server parent process",
              "Lacks specificity to advanced adversary behaviors or campaign context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The Sigma rule syntax appears valid and uses standard Sysmon event fields, making it deployable in most Windows environments. However, the siem_verification shows a failed Splunk test (HTTP 503), indicating unvalidated deployment readiness. The false positive list is reasonable but may still trigger alerts on legitimate admin scripts, increasing alert fatigue.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Uses common Sysmon logsource with realistic field mappings",
              "Includes relevant false positive guidance"
            ],
            "weaknesses": [
              "SIEM verification failed\u2014rule not tested in production-like environment",
              "Potential for false positives due to broad command-line contains logic"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly convey that a web server process performed file discovery, aiding quick triage. Detection includes user, command line, and parent process\u2014key fields for investigation. However, missing network context or file paths limits pivot options, and MITRE ID T1083 is referenced but not fully leveraged in guidance.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection logic for analyst understanding",
              "Provides useful process and user context for follow-up"
            ],
            "weaknesses": [
              "Lacks enrichment fields like source IP or file hash for deeper investigation",
              "No direct remediation or escalation steps in description"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on command-line string matching (e.g., 'dir', 'ls'), which attackers can easily evade via obfuscation, alternative tools, or encoded commands. It does not account for LOLBins like 'forfiles' or PowerShell aliases, nor does it incorporate behavioral patterns beyond simple command presence. Detection logic is too static and easily bypassed.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Uses parent process and user context to narrow scope",
              "Includes both Unix and Windows discovery commands, showing cross-platform awareness"
            ],
            "weaknesses": [
              "Highly vulnerable to command obfuscation and alternative tool use",
              "No detection logic for encoded or compressed payloads"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects a single stage\u2014initial file discovery\u2014executed by a web server process, but does not extend to later stages like data exfiltration or lateral movement. It lacks logic to correlate across multiple events or phases of an attack lifecycle, limiting it to atomic detection.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:07:32.552134",
          "metadata": {
            "strengths": [
              "Detects initial malicious activity in high-visibility location (web server process)",
              "Includes relevant command-line indicators for discovery"
            ],
            "weaknesses": [
              "No correlation across attack stages (e.g., follow-on actions after discovery)",
              "Single-event focus with no behavioral chaining or temporal logic"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (Web Server Process Performing File Discovery) scored 0.55/1.0 (Poor). Best performance in quality (0.65). Needs improvement in detectability (0.40). Issues found in: detection_logic_correctness, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T15:07:32.552134",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "Web Server Process Performing File Discovery",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.24000000000000002,
      "category_scores": {
        "correctness": 0.33999999999999997,
        "quality": 0.21764705882352942,
        "effectiveness": 0.19333333333333336,
        "realism": 0.2888888888888889,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks several required Sigma fields such as author, date, status, and references. While core fields like title, id, logsource, detection, and level are present, tags reference 'attack.unknown' and the MITRE TTP is invalid, reducing credibility and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Contains essential fields: title, id, logsource, detection, level",
              "Includes falsepositives and tags"
            ],
            "weaknesses": [
              "Missing author, date, status, references",
              "Uses invalid MITRE ID 'attack.unknown'"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is vague and does not reflect actual behavior of Application Window Discovery (e.g., use of 'wmic window', 'Get-Process', or GUI scraping tools). The term 'suspicious' is not an indicator of compromise and will fail to map to real attack patterns.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Uses standard Sigma field 'CommandLine'",
              "Simple condition logic avoids complexity"
            ],
            "weaknesses": [
              "Selection term 'suspicious' is meaningless and non-specific",
              "Does not reflect actual TTP behavior or known LIONTAIL activity"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is extremely broad, using a generic substring 'suspicious' without context like parent process, user context, or command-line structure. It will likely trigger on any logged command containing the word, including benign debug or test scripts, leading to high false positive rates.",
          "confidence": 0.97,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Defines a single clear selection criterion",
              "Acknowledges false positives in description"
            ],
            "weaknesses": [
              "No filtering on parent process, user, or image path",
              "Wildcard-free but overly simplistic and context-free"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is not sensitive to attack variations; it depends on a literal substring that attackers can easily avoid. It does not use regex, case insensitivity, or alternative indicators (e.g., window enumeration tools), making it trivial to evade. No coverage of common tools like PowerShell, wmic, or UI automation frameworks.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Condition is simple and fast to execute"
            ],
            "weaknesses": [
              "No support for obfuscation or encoding variants",
              "Ignores known command-line patterns for window discovery"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks accurate MITRE ATT&CK mapping, using 'attack.unknown' instead of a valid technique ID like T1010 (Application Window Discovery). The description vaguely references 'LIONTAIL framework' without evidence or sourcing, and no authoritative references, threat actors, or malware families are provided. The rule title and tags do not align with standard naming conventions.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Includes basic rule title and description",
              "Tags field is present (though incorrectly used)"
            ],
            "weaknesses": [
              "Invalid MITRE ATT&CK ID and tactic mapping",
              "No references to MITRE, threat actors, or malware frameworks"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is unindexed, overly broad, and uses a non-specific substring match. It lacks use of efficient operators like 'startswith' or field-specific constraints, and the logsource, while correct for Windows process creation, does not narrow scope via Image or ParentImage. This will result in full-text scans and poor performance.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Uses process_creation category, which is commonly indexed",
              "Condition logic is simple and parseable"
            ],
            "weaknesses": [
              "Uses unoptimized 'contains' on vague term 'suspicious'",
              "No prioritization of indexed fields like Image or EventID"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule fails to cover actual methods of Application Window Discovery (e.g., EnumWindows API, PowerShell Get-Process, WMIC). It incorrectly ties detection to HTTP payload extraction via 'LIONTAIL', which is unrelated to window enumeration. No sub-techniques (T1010), tools (Cobalt Strike, Empire), or multi-stage behaviors are included, rendering the detection irrelevant to the stated TTP.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Attempts to map to a known MITRE technique (though incorrectly)",
              "General intent aligns with detecting malicious process activity"
            ],
            "weaknesses": [
              "Misunderstands the TTP: window discovery \u2260 HTTP payload extraction",
              "No coverage of real-world tools or techniques for T1010"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule has no built-in FP mitigation\u2014no exclusions for legitimate tools, no parent-child logic, and no frequency-based thresholds. The 'suspicious' keyword will trigger on any matching string, including benign scripts or admin tools. The falsepositives list only generically mentions 'legitimate administrative activity' without actionable exclusions.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Acknowledges potential for false positives in metadata"
            ],
            "weaknesses": [
              "No specific exclusions or filtering logic in detection",
              "Relies on a high-noise, low-precision keyword match"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule references 'LIONTAIL framework' but lacks specific TTPs or campaign context tied to real-world actors using Application Window Discovery. The technique 'attack.unknown' and fallback generation method indicate minimal threat intelligence integration.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Mentions a specific framework (LIONTAIL) potentially linked to real threats",
              "Aligns with execution tactic per MITRE ATT&CK"
            ],
            "weaknesses": [
              "Uses undefined 'attack.unknown' ID with no MITRE mapping",
              "No linkage to known APT groups, campaigns, or behavioral patterns"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule contains a generic 'CommandLine|contains: suspicious' pattern that will likely fail in production due to low specificity and high false positives. SIEM verification failed with HTTP 503, indicating untested or broken deployment logic.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Uses common logsource (process_creation) available in most Windows environments",
              "Assigned medium severity, which is triage-appropriate"
            ],
            "weaknesses": [
              "Detection logic is overly broad and untested",
              "SIEM verification failed; rule may have syntax or query issues"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The title clearly states the detection goal, but the description lacks investigative context like relevant process names, user contexts, or pivot fields. False positive guidance is minimal, mentioning only 'legitimate administrative activity'.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Clear rule title aiding alert comprehension",
              "Includes basic false positive consideration"
            ],
            "weaknesses": [
              "No actionable telemetry fields (e.g., Image, User, ParentProcess) in detection",
              "Insufficient investigation guidance or MITRE references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule relies solely on a weak command-line string match, easily bypassed via obfuscation, encoding, or LOLBin misuse. It lacks behavioral correlation or multi-stage detection logic to resist evasion.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Detects at process creation, a common visibility point",
              "Pattern could catch naive attackers using 'suspicious' in commands"
            ],
            "weaknesses": [
              "Highly vulnerable to simple obfuscation and renaming",
              "No use of behavioral chains or indirect indicators"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is limited to detecting a single event\u2014process creation with a command line containing 'suspicious'\u2014and lacks logic to identify subsequent stages of the attack lifecycle. It does not correlate across events or detect persistence, lateral movement, or exfiltration related to Application Window Discovery.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:07.475006",
          "metadata": {
            "strengths": [
              "Targets process creation, a relevant initial execution vector",
              "Simple condition allows for fast deployment in basic monitoring"
            ],
            "weaknesses": [
              "No multi-event correlation or stage progression detection",
              "Overly generic selection criteria fails to capture technique-specific behaviors"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Application Window Discovery) scored 0.24/1.0 (Poor). Best performance in correctness (0.34). Needs improvement in effectiveness (0.19). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-28T15:09:07.475006",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Application Window Discovery",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.25000000000000006,
      "category_scores": {
        "correctness": 0.33999999999999997,
        "quality": 0.24705882352941178,
        "effectiveness": 0.16666666666666666,
        "realism": 0.34444444444444444,
        "detectability": 0.2
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks several required Sigma fields such as status, author, date, and references. While core fields like title, id, logsource, detection, and level are present, tags and MITRE mapping use invalid values like 'attack.unknown', reducing standardization and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.093651",
          "metadata": {
            "strengths": [
              "Contains essential fields: title, id, logsource, detection, level",
              "Includes falsepositives and tags"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, references",
              "Uses invalid MITRE tag 'attack.unknown'"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection logic relies solely on 'CommandLine|contains: suspicious', which is vague and does not reflect actual adversary behavior. It uses a non-specific string that may not appear in real attacks and could miss legitimate indicators of command-line exploitation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.093651",
          "metadata": {
            "strengths": [
              "Uses standard Sigma field 'CommandLine'",
              "Condition logic is simple and valid"
            ],
            "weaknesses": [
              "Selection term 'suspicious' is arbitrary and not TTP-based",
              "Does not reflect known LIONTAIL or scripting interpreter behaviors"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is overly broad, using a single generic substring match without context like parent process, user, or command-line patterns. This would generate high false positives from normal administrative activity, especially since 'suspicious' could appear in benign logs.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.093651",
          "metadata": {
            "strengths": [
              "Acknowledges false positives in documentation",
              "Targets process creation on Windows"
            ],
            "weaknesses": [
              "No contextual filtering (e.g., parent process, user)",
              "Relies entirely on a non-specific keyword"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks sensitivity to evasion techniques, using a case-sensitive substring that can be easily bypassed by obfuscation. It does not account for encoded commands, alternative scripting interpreters, or common attack patterns associated with command-line misuse.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.093651",
          "metadata": {
            "strengths": [
              "Uses 'contains' which can catch some variations",
              "Applies to process creation events, a relevant data source"
            ],
            "weaknesses": [
              "No case-insensitive matching or regex for obfuscation",
              "Ignores known interpreter paths (e.g., cmd.exe, powershell.exe)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks accurate MITRE ATT&CK mapping, using 'attack.unknown' instead of a valid technique ID like T1059. The description is vague and fails to reference known threat actors, malware families, or authoritative sources. Minimal context is provided for investigation.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Includes basic rule title and description",
              "Tags are present, though incorrect"
            ],
            "weaknesses": [
              "Invalid MITRE ATT&CK ID and tactic mapping",
              "No references to research, tools, or threat actors"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The detection uses a non-indexed 'CommandLine|contains' with a generic term 'suspicious', which is inefficient and may not leverage SIEM indexing. The condition lacks specificity and uses a leading substring match without anchoring to known malicious patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Uses process_creation category, which is commonly indexed",
              "Simple condition structure aids readability"
            ],
            "weaknesses": [
              "Uses unoptimized 'contains' with vague term",
              "No use of startswith/endswith or field-specific optimizations"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule fails to cover any actual variants of command and scripting interpreter abuse. It references a non-existent 'LIONTAIL' framework and does not detect known tools like PowerShell, WMI, or scripting engines. No sub-techniques (e.g., T1059.001, T1059.003) are addressed.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "General intent aligns with execution via command interpreters",
              "Broad category (process creation) is relevant"
            ],
            "weaknesses": [
              "No coverage of real-world scripting interpreter techniques",
              "Fictional or unknown framework (LIONTAIL) undermines validity"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 1,
          "normalized_score": 0.1,
          "explanation": "The rule has no built-in filters to exclude legitimate administrative tools or common system processes. The falsepositive field only generically mentions 'legitimate administrative activity' without specific exclusions or logic to suppress noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Acknowledges potential for false positives in metadata"
            ],
            "weaknesses": [
              "No exclusion logic in detection",
              "No parent-child or path-based filtering to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule lacks alignment with real-world TTPs, referencing a vague 'LIONTAIL framework' without evidence or specificity. It does not incorporate known adversary behaviors, tools, or campaign context related to command-line usage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Mentions a framework (LIONTAIL) for potential context",
              "Correctly associates technique with execution tactic"
            ],
            "weaknesses": [
              "No MITRE ATT&CK mapping to real technique (uses 'attack.unknown')",
              "Generic detection logic not tied to actual threat intelligence"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule has valid Sigma syntax but relies on an unrealistic 'suspicious' keyword match, leading to high false positives. SIEM verification failed (HTTP 503), indicating lack of testing in production environment.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Uses standard process_creation logsource on Windows",
              "Defined false positives and medium severity"
            ],
            "weaknesses": [
              "Detection based on 'suspicious' is overly broad and untested",
              "Verification failed \u2013 not validated in target SIEM"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule title and description are generic, offering little investigative context. While it triggers on command line, it lacks key fields like parent process, user, or image path needed for effective triage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Includes basic false positive guidance",
              "Severity level aids prioritization"
            ],
            "weaknesses": [
              "No actionable telemetry in detection logic",
              "No references to MITRE or threat groups for follow-up"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule is highly evadable by simple obfuscation, such as encoding or using alternative spellings. It relies solely on a weak string match in command line, ignoring behavioral patterns or LOLBin mitigations.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Focuses on command-line interface, a common attack vector"
            ],
            "weaknesses": [
              "Single-point detection easily bypassed",
              "No consideration of encoding, indirect execution, or script interpreters like PowerShell/WMI"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only detects a single event based on a generic 'suspicious' command line string, with no logic to identify multiple stages of the attack lifecycle. It lacks correlation across initial access, persistence, lateral movement, or exfiltration phases, making it purely a single-event, initial-execution-level detection.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:09:43.094402",
          "metadata": {
            "strengths": [
              "Clearly scoped to process creation events on Windows, which is relevant for command interpreter activity",
              "Uses a detection condition that could theoretically catch known malicious patterns if 'suspicious' were more specific"
            ],
            "weaknesses": [
              "No multi-stage logic or event correlation; limited to one crude string match",
              "Fails to model attacker behavior beyond a single keyword, offering no visibility into persistence, lateral movement, or follow-on actions"
            ]
          }
        }
      ],
      "summary": "Rule for attack.unknown (Detection: Command and Scripting Interpreter) scored 0.25/1.0 (Poor). Best performance in realism (0.34). Needs improvement in effectiveness (0.17). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-28T15:09:43.094402",
      "metadata": {
        "attack_id": "attack.unknown",
        "technique_name": "Detection: Command and Scripting Interpreter",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5916666666666667,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6941176470588236,
        "effectiveness": 0.56,
        "realism": 0.5888888888888889,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Includes essential detection components: title, id, logsource, detection logic, and false positives",
              "Properly tags MITRE ATT&CK technique (attack.t1041) and custom identifiers"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete metadata reduces traceability and operational readiness"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures known Liontail indicators like 'liontail.exe' and command-line references, but incorrectly maps Exfiltration (T1041) to Execution tactic without clear behavioral justification. The condition combines process, command line, and obfuscation patterns reasonably, but assumes liontail.exe is a standard binary, which may not reflect real-world usage.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Uses realistic indicators: filename, parent processes, and encoded command patterns",
              "Condition logic combines multiple detection paths effectively"
            ],
            "weaknesses": [
              "Misaligns TTP: T1041 is exfiltration, but detection focuses on execution via parent shells",
              "Assumes existence of 'liontail.exe' without evidence it's a common artifact"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses specific filename and parent process filters, improving precision. However, 'CommandLine|contains \"liontail\"' is overly broad and likely to trigger on benign scripts or security tools. Lack of user context, image hash, or network correlation reduces specificity in enterprise environments.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Includes parent process filtering (powershell, cmd, wscript) to narrow context",
              "Uses endswith for precise image path matching"
            ],
            "weaknesses": [
              "High-risk 'contains' match on command line increases false positives",
              "No exclusion of administrative or testing environments"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple attack variants: direct execution, command-line references, and obfuscated PowerShell (-enc, -EncodedCommand). Case-insensitive regex helps catch evasion attempts, and multiple entry points increase coverage across different delivery methods.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Covers obfuscation via encoded PowerShell commands",
              "Uses case-insensitive regex to detect variations"
            ],
            "weaknesses": [
              "Does not account for file renaming or living-off-the-land binaries",
              "Limited coverage of alternative C2 protocols or data staging"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1041), a clear description, and references the Liontail framework. However, it lacks specific threat actor attribution, campaign names, or links to authoritative sources like MITRE pages or research reports.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging",
              "Clear rule title and description explaining detection goal"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to known threat actors or campaigns using Liontail"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses efficient field filters (Image, ParentImage, CommandLine) with endswith and contains operators appropriately. It avoids leading wildcards and uses indexed Sysmon fields. Regex is limited and case-insensitive but not overly complex.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Uses high-performance operators on indexed fields (endswith, contains)",
              "Logsource is specific to Sysmon process creation on Windows"
            ],
            "weaknesses": [
              "Regex could be further optimized with anchors to reduce false matches",
              "No short-circuit logic ordering (most specific condition first)"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic Liontail execution via common shells and command-line artifacts, including obfuscated PowerShell. However, it lacks coverage of alternative C2 frameworks, multi-stage exfiltration behaviors, or data staging indicators, limiting broader T1041 detection.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Covers direct execution and command-line mentions of 'liontail'",
              "Includes detection of encoded command obfuscation"
            ],
            "weaknesses": [
              "Overly focused on a single tool (liontail.exe) without broader behavioral patterns",
              "Misses data compression, encryption, or beaconing patterns typical in exfiltration"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes reasonable parent process filtering (cmd, PowerShell, wscript), which reduces noise. However, it lacks time-based frequency thresholds, user context, or path-based exclusions, and the false positive list is generic rather than actionable.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Leverages parent-child process chain to increase suspicion",
              "Includes obfuscation detection as higher-fidelity signal"
            ],
            "weaknesses": [
              "No exclusion of trusted administrative paths or users",
              "False positive guidance is vague and not operational"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs by targeting Liontail execution via common parent processes and obfuscated command lines, which reflects known adversary behavior. However, it lacks specific references to APT groups, campaigns, or documented attack chains using Liontail, reducing contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Detection logic mirrors common execution patterns (e.g., PowerShell spawning malicious binaries)",
              "Includes regex for encoded command detection, indicating awareness of obfuscation"
            ],
            "weaknesses": [
              "No linkage to known threat actors or campaigns using Liontail",
              "Assumes Liontail is a fixed binary name without behavioral context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses valid Sigma syntax and realistic Sysmon log sources, but the failed SIEM verification (HTTP 503) indicates untested deployment readiness. The medium severity is appropriate, but unverified detection logic and lack of field testing reduce confidence in production stability.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Logsource is standard in enterprise environments (Sysmon process creation)",
              "Clear false positive guidance provided"
            ],
            "weaknesses": [
              "SIEM verification failed \u2014 rule may have syntax or query translation issues",
              "No evidence of tuning or performance testing in large-scale environments"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The title and description clearly communicate what is detected, and the false positive list aids triage. Analysts can pivot on process, parent image, and command line, though critical fields like user or network connections are not explicitly highlighted.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Clear detection title and descriptive context",
              "Useful command-line and parent-process fields for investigation"
            ],
            "weaknesses": [
              "Lacks inclusion of user context or network indicators for pivoting",
              "No MITRE ATT&CK ID mapping in detection fields for automated enrichment"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects obfuscation via encoded commands and includes command-line patterns, but remains vulnerable to simple binary renaming or use of LOLBins. It relies heavily on process name and command-line artifacts, which attackers can easily alter or hide.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Detects obfuscated invocations using regex on -enc/-EncodedCommand",
              "Multiple detection paths (image, command line, obfuscation)"
            ],
            "weaknesses": [
              "Easily bypassed by renaming liontail.exe or using memory-only execution",
              "No behavioral correlation (e.g., network connections post-execution)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule primarily detects initial execution of Liontail via process creation and command-line artifacts, but does not extend to later stages such as data staging, exfiltration, or persistence. It lacks logic to correlate multiple events across the attack lifecycle, limiting detection to single-point observations.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:10:23.335460",
          "metadata": {
            "strengths": [
              "Detects initial execution through common parent processes like PowerShell and cmd",
              "Includes regex pattern to catch obfuscated command lines with -enc or -EncodedCommand"
            ],
            "weaknesses": [
              "No detection of data collection or exfiltration-stage behaviors",
              "Lacks correlation logic across multiple events or processes"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1041 (Exfiltration Over Command and Control Channel \u2013 Liontail Execution) scored 0.59/1.0 (Poor). Best performance in quality (0.69). Needs improvement in detectability (0.40). Issues found in: detection_specificity, attack_coverage, operational_deployability",
      "timestamp": "2025-12-28T15:10:23.335460",
      "metadata": {
        "attack_id": "attack.t1041",
        "technique_name": "Exfiltration Over Command and Control Channel \u2013 Liontail Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4733333333333334,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.5764705882352942,
        "effectiveness": 0.36666666666666664,
        "realism": 0.5555555555555556,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces rule accountability"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic detects PowerShell executing 'SystemInfo' or 'Get-WmiObject', which aligns with discovery techniques, but does not specifically tie to the LIONTAIL framework. The detection is generic and could apply to any PowerShell-based discovery, not uniquely LIONTAIL. Field names are standard and condition logic is sound but overly broad.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Uses standard Sigma field names (EventID, Image, CommandLine)",
              "Condition logic is simple and valid"
            ],
            "weaknesses": [
              "No specific indicators linking to LIONTAIL framework",
              "Generic command-line keywords increase false positives"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks specificity by relying solely on CommandLine contains with broad terms like 'Get-WmiObject' and 'SystemInfo', which are common in administrative scripts. It does not filter by parent process, user context, or command structure, increasing false positives from legitimate automation and admin tasks.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Identifies high-risk commands in PowerShell",
              "Focuses on process creation via Sysmon"
            ],
            "weaknesses": [
              "No exclusion of known benign parent processes (e.g., explorer.exe, scheduled tasks)",
              "Overly broad CommandLine matching without argument context"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule captures multiple discovery methods (WMI and system info) and uses substring matching that can detect minor command variations. However, it lacks case-insensitive matching and regex patterns to catch obfuscated commands (e.g., base64-encoded, variable substitution), limiting evasion resistance.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Covers multiple discovery techniques (WMI, system commands)",
              "Uses contains operator for partial command matching"
            ],
            "weaknesses": [
              "No case-insensitive or regex-based detection for obfuscation",
              "Does not account for alternative PowerShell execution paths or aliases"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1057) and a clear description, but lacks specific threat actor references, campaign names, or tooling details beyond 'LIONTAIL Framework', which is not publicly documented. No authoritative references or CVEs are provided, limiting investigative context.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1057)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing threat actor or campaign attribution",
              "No external references or source links"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses indexed fields (EventID, Image, CommandLine) efficiently and avoids leading wildcards. The detection logic is simple and leverages 'contains' appropriately for command-line arguments, with specific Image path and EventID filtering applied first for performance.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Uses high-cardinality indexed fields first",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "'contains' on multiple values could be optimized with additional conditions",
              "Could use 'endswith' for Image to improve portability"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule only detects basic PowerShell-based system info commands (SystemInfo, Get-WmiObject) and narrowly focuses on one binary. It fails to cover other LIONTAIL-associated behaviors, alternative tools (e.g., wmic.exe, cmd.exe), or sub-techniques like T1082. No multi-stage or framework-specific indicators are included.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Covers common PowerShell discovery commands",
              "Targets process creation via Sysmon for visibility"
            ],
            "weaknesses": [
              "Narrow scope limited to PowerShell only",
              "Ignores other execution methods and LIONTAIL tooling variants"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule triggers on any PowerShell execution with common discovery commands, which are widely used in legitimate admin scripts. While false positives are acknowledged in metadata, no actual filtering (e.g., parent process, user context, frequency) is implemented to reduce noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive sources in metadata",
              "Focuses on specific command-line artifacts"
            ],
            "weaknesses": [
              "No parent-child process constraints",
              "Lacks thresholds or behavioral context to suppress benign usage"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule references 'LIONTAIL Framework' in the title and tags but lacks specific TTPs or campaign context tied to known actors using this framework. Detection logic focuses on generic PowerShell usage of SystemInfo and Get-WmiObject, which are common in both malicious and administrative activities, without distinguishing LIONTAIL-specific behaviors.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "References a specific framework (LIONTAIL) in naming, suggesting targeted intent",
              "Aligns with MITRE T1057 (System Information Discovery)"
            ],
            "weaknesses": [
              "No evidence of LIONTAIL-specific command-line patterns or operational context",
              "Relies on generic indicators not unique to any APT group or campaign"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma rule syntax is valid and uses standard Sysmon Event ID 1 with common fields, making it deployable in most Windows environments. However, the detection logic may generate high false positives due to reliance on broad CommandLine keywords used in legitimate administration, increasing alert fatigue.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Uses widely available log source (Sysmon process creation)",
              "Validated detection with reported 304 events found"
            ],
            "weaknesses": [
              "High potential for false positives due to unspecific CommandLine contains logic",
              "No thresholding or additional filtering to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule title and description mention the LIONTAIL framework, providing some context, but lack details like user, host, or process lineage that would aid investigation. False positive guidance is present but generic, limiting its utility during triage.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Clear mapping to MITRE ATT&CK technique (T1057)",
              "Includes false positive considerations"
            ],
            "weaknesses": [
              "Lacks key investigative fields (e.g., User, ParentProcess)",
              "No links to threat intelligence or response playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule is highly vulnerable to evasion: attackers can obfuscate 'Get-WmiObject' or 'SystemInfo' via string encoding, use alternative cmdlets (e.g., Get-CimInstance), or invoke PowerShell through LOLBins like 'wmic.exe'. Detection relies solely on clear-text command-line content, a weak signal against skilled adversaries.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Detects two common discovery methods in one rule",
              "Focuses on process creation, a reliable logging point"
            ],
            "weaknesses": [
              "Easily bypassed by command obfuscation or alternative tools",
              "No behavioral or multi-stage logic to increase resilience"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only the initial execution stage of System Information Discovery via PowerShell command-line activity, focusing on single-event process creation. It lacks logic to correlate follow-on behaviors such as data aggregation, lateral movement, or exfiltration that would indicate malicious use of discovered system information.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:01.447376",
          "metadata": {
            "strengths": [
              "Clearly identifies initial use of PowerShell for system information gathering",
              "Leverages Sysmon Event ID 1 for high-granularity process monitoring"
            ],
            "weaknesses": [
              "No correlation across multiple stages (e.g., post-discovery exfiltration)",
              "Single-event detection without behavioral context or chaining"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (System Information Discovery via LIONTAIL Framework) scored 0.47/1.0 (Poor). Best performance in quality (0.58). Needs improvement in detectability (0.30). Issues found in: detection_logic_correctness, detection_specificity, metadata_richness",
      "timestamp": "2025-12-28T15:11:01.447376",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "System Information Discovery via LIONTAIL Framework",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5516666666666666,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6,
        "effectiveness": 0.49333333333333335,
        "realism": 0.6111111111111112,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and falsepositives, with meaningful content. Missing fields include 'status', 'author', 'date', and 'references', which are required for production-ready Sigma rules. The 'id' field is present but appears auto-generated without clear traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Includes essential fields like title, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status, references",
              "No clear provenance or ownership metadata"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures basic indicators of schtasks.exe creating tasks with HTTP payloads, aligning with T1053.005 and T1105. However, 'CommandLine|contains': 'http' is overly broad and may miss encoded or obfuscated URLs while catching benign scripts. The use of '/tn' and '/tr' is correct for task creation but doesn't validate malicious intent.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Correctly identifies schtasks.exe usage with task creation parameters",
              "Links to relevant MITRE techniques (T1053.005, T1105)"
            ],
            "weaknesses": [
              "Over-reliance on plain 'http' string increases false positives",
              "No validation of suspicious destinations or payloads"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity by relying solely on 'http' in the command line, which is common in legitimate administration and software updates. It does not filter by user context, parent process, or known malicious patterns. This increases noise in production environments without additional context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Uses specific schtasks.exe image path and required switches",
              "Acknowledges common false positives in documentation"
            ],
            "weaknesses": [
              "No exclusion of system accounts or trusted parent processes",
              "Broad 'contains' on 'http' catches too much benign traffic"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects basic HTTP-based task creation but is vulnerable to simple evasion like URL encoding, HTTPS usage, or domain fronting. It lacks case-insensitive matching and regex patterns to catch obfuscated commands. While it covers a common TTP vector, it misses advanced variations used in real-world attacks.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Catches unencoded HTTP task deployment via schtasks",
              "Applies to common adversary tooling like Tunna"
            ],
            "weaknesses": [
              "No support for encoded/encrypted (HTTPS) or DNS-tunneled C2",
              "Vulnerable to path spoofing or command-line obfuscation"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1053.005, T1105) and a clear description linking to Tunna web shell, but lacks references to authoritative sources like MITRE pages or threat reports, and omits threat actor names, malware families, or campaign context. The technique name is generic and does not fully align with the detection logic.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tags included",
              "Clear description linking HTTP usage with schtasks for web shell deployment"
            ],
            "weaknesses": [
              "Missing MITRE or research references despite available context",
              "No attribution to known threat actors or malware families (e.g., APT groups using Tunna)"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses indexed fields (Image, CommandLine) and efficient operators (endswith, contains), avoids leading wildcards, and places specific filters first. The logsource is appropriately scoped to Sysmon process creation events, ensuring fast execution in most SIEMs.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Uses high-cardinality indexed fields efficiently",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "Could use 'startswith' on Image for better performance than 'endswith'",
              "No field normalization noted (e.g., case sensitivity handling)"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic schtasks.exe usage with HTTP in command line, relevant to Tunna, but misses alternative tools (e.g., wmic, PowerShell), encoded commands, or HTTPS usage. It does not cover lateral movement stages or multi-stage execution patterns common in real attacks.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Covers core T1053.005 via schtasks with HTTP indicators",
              "Includes key command-line parameters (/tn, /tr)"
            ],
            "weaknesses": [
              "Narrow focus on schtasks.exe only, excluding other task creation methods",
              "Ignores obfuscation, encoding, or use of HTTPS which advanced threats employ"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process exclusions, parent-child context, or frequency-based logic, making it prone to false positives from legitimate admin scripts. While false positives are documented, no mitigation filters (e.g., exclude System, trusted paths) are implemented in the detection logic.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive scenarios in metadata",
              "Requires both /tn and /tr, reducing noise slightly"
            ],
            "weaknesses": [
              "No exclusion of system accounts or trusted parent processes (e.g., cmd.exe from Windows directory)",
              "No thresholding or behavioral context to distinguish malicious from legitimate HTTP use"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs involving schtasks.exe for execution and persistence via HTTP, commonly seen in tools like Tunna. However, it lacks specificity to known APT groups or campaigns and relies on generic indicators rather than observed adversary behaviors such as specific command templates or timing patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Maps to MITRE T1053.005 and T1105, reflecting valid execution and transfer techniques",
              "Targets HTTP usage in scheduled task creation, a known red team and malware pattern"
            ],
            "weaknesses": [
              "No reference to specific threat actors or campaigns using this method",
              "Generic 'http' match misses context like C2 domains or encoded URIs"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses valid Sigma syntax and realistic Sysmon log sources common in enterprise environments. It has been verified in a SIEM (Splunk) with detection success, though the high event count (280) suggests potential alert fatigue without additional filtering.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Validated in production-like environment with successful detection",
              "Uses standard Sysmon Event ID 1 (process creation), widely deployed"
            ],
            "weaknesses": [
              "High false positive risk due to broad 'http' match in command line",
              "No time-based or frequency thresholding to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description provide basic context, but the rule lacks enrichment fields (e.g., user, parent process, IP address) critical for effective triage. False positive guidance is present but minimal, limiting analyst efficiency.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Clear rule title indicating suspicious behavior",
              "Includes common false positive scenarios in documentation"
            ],
            "weaknesses": [
              "Does not extract or highlight key forensic fields like User, ParentImage, or DestinationIp",
              "No links to runbooks, IOCs, or investigation playbooks"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is vulnerable to simple evasion such as using HTTPS instead of HTTP, obfuscating strings, or leveraging other LOLBins like wmic.exe. It relies heavily on command-line content, which attackers can hide or split across multiple commands.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Detects schtasks.exe usage with task creation parameters (/tn, /tr), which are harder to omit",
              "Combines process and protocol indicators for broader coverage"
            ],
            "weaknesses": [
              "Easily bypassed by using HTTPS, IP addresses, or domainless C2",
              "No detection logic for encoded commands or indirect execution methods"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of schtasks.exe with HTTP command-line indicators, which aligns with initial access or execution stages. However, it lacks logic to correlate follow-on activities such as persistence verification, lateral movement via remote task deployment, or data exfiltration. The detection is largely single-event and does not chain related behaviors across time or hosts.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:11:37.569713",
          "metadata": {
            "strengths": [
              "Detects known malicious use of schtasks.exe with HTTP payloads, relevant to initial execution",
              "Covers command-line patterns associated with Tunna web shell deployment"
            ],
            "weaknesses": [
              "No correlation across multiple stages (e.g., post-execution beaconing or file writes)",
              "Limited to process creation event without context enrichment or behavioral chaining"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1053.005 (Suspicious Scheduled Task Creation with HTTP Communication) scored 0.55/1.0 (Poor). Best performance in correctness (0.64). Needs improvement in detectability (0.40). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T15:11:37.569713",
      "metadata": {
        "attack_id": "attack.t1053.005",
        "technique_name": "Suspicious Scheduled Task Creation with HTTP Communication",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.47,
      "category_scores": {
        "correctness": 0.54,
        "quality": 0.5764705882352941,
        "effectiveness": 0.39333333333333337,
        "realism": 0.48888888888888893,
        "detectability": 0.30000000000000004
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE references. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Includes core structural elements: title, id, detection logic, and MITRE tags",
              "Properly formatted logsource and detection sections"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete tags with potentially incorrect MITRE mapping (attack.t1562 vs T1053.005)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic targets PowerShell/cmd execution of 'New-ScheduledTask' with specific parameters, aligning with scheduled task creation for persistence. However, the condition requires all CommandLine terms ('/create', '-Action', '-Trigger', 'New-ScheduledTask'), which may not co-occur in real attacks, reducing effectiveness.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Targets relevant process creation events via Sysmon",
              "Focuses on command-line indicators tied to task creation"
            ],
            "weaknesses": [
              "Overly strict 'all' condition may miss real-world variations",
              "Incorrect assumption that '/create' is used with PowerShell New-ScheduledTask cmdlet"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses specific command-line artifacts and process names, reducing broad matching. However, it lacks context like parent process or user filtering, and does not exclude known administrative tools or scripts, increasing false positive risk in environments with routine automation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Uses exact string matches on critical indicators",
              "Narrows to high-risk executables (cmd.exe, powershell.exe)"
            ],
            "weaknesses": [
              "No exclusion of system or admin-initiated processes",
              "Lacks parent process or user context to refine detection"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is brittle to evasion: attackers can obfuscate command lines, use alternative tools (schtasks.exe), or split commands across pipelines. It fails to account for case variation, encoding, or legitimate aliases, making it easy to bypass with basic obfuscation techniques.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Catches clear-text invocation of New-ScheduledTask with key parameters",
              "Matches common command-line syntax patterns"
            ],
            "weaknesses": [
              "No support for case-insensitive matching or regex variants",
              "Ignores alternative execution methods like schtasks or WMI"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes basic MITRE ATT&CK tags and a correct technique name, but lacks specificity in sub-technique identification and omits authoritative references or threat actor context. The description is generic and does not clarify the detection logic or intent beyond NLP pattern matching, which is vague.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tags (attack.persistence, attack.t1562)",
              "Clear rule title and basic technique mapping"
            ],
            "weaknesses": [
              "Missing MITRE sub-technique ID (e.g., T1053.005 for Scheduled Task/Job)",
              "No references to MITRE page or real-world usage by threat actors"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field operators like 'endswith' on Image and 'contains' on CommandLine with indexed fields. However, the 'contains|all' condition on multiple substrings may trigger unnecessary scans and lacks ordering by specificity, slightly reducing efficiency.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:12.997354",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Employs endswith for precise binary matching"
            ],
            "weaknesses": [
              "Relies on multiple 'contains' checks without prioritizing most selective terms first",
              "No use of startswith or exact match where applicable"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule narrowly focuses on PowerShell/cmd.exe usage of New-ScheduledTask with specific parameters, missing broader attack vectors like WMI, schtasks.exe, or other scheduling mechanisms. It fails to cover common adversary tools (e.g., Cobalt Strike) or alternative command-line syntax and obfuscation techniques.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Detects use of New-ScheduledTask via PowerShell, a known persistence method",
              "Captures key indicators like /create, -Action, -Trigger"
            ],
            "weaknesses": [
              "Ignores alternative tools like schtasks.exe or wmic.exe",
              "No coverage of encoded commands, obfuscation, or indirect execution methods"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule lacks specific exclusions for legitimate administrative activity and relies solely on generic false positive notes without implementing filtering logic. It triggers on any process matching the command line pattern, including benign admin scripts or automated tooling.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Acknowledges administrative tasks as potential false positives",
              "Focuses on a specific combination of arguments"
            ],
            "weaknesses": [
              "No parent process filtering (e.g., excluding explorer.exe or legitimate schedulers)",
              "Missing exclusions for known good paths or signed scripts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets scheduled task creation via PowerShell or cmd, which aligns with real-world persistence tactics. However, it lacks specificity to known adversary behavior, such as common obfuscation patterns or specific APT group tradecraft. The detection logic is generic and does not reference actual campaigns or nuanced TTP variations.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Aligns with MITRE T1053.005 (Scheduled Task/Job) for persistence",
              "Focuses on high-risk binaries (cmd/powershell) in process creation"
            ],
            "weaknesses": [
              "No reference to real-world adversary usage or campaign context",
              "Ignores common obfuscated command-line patterns used by attackers"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The Sigma rule syntax is valid and uses common Sysmon event sources, but the siem_verification shows a failed Splunk test (HTTP 503), indicating unvalidated deployment. The false positive list is generic, and the detection may trigger on benign admin activity without sufficient filtering. Medium severity is appropriate, but lack of testing reduces deployability confidence.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Uses standard logsource (Sysmon process creation) widely deployed",
              "Clear condition logic with basic filtering"
            ],
            "weaknesses": [
              "SIEM verification failed \u2014 untested in real environment",
              "High risk of false positives due to broad command-line matching"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule title and description clearly indicate detection of scheduled task creation, aiding analyst understanding. Relevant fields like Image and CommandLine support pivoting, and false positive guidance is present. However, missing contextual details like user context, parent process, or hash collection limits investigation depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Clear title and description aid alert comprehension",
              "CommandLine inclusion enables command reconstruction"
            ],
            "weaknesses": [
              "Lacks guidance on key investigative follow-up steps",
              "Does not specify critical telemetry fields (e.g., User, ParentImage)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule relies heavily on exact command-line string matching, making it vulnerable to simple obfuscation (e.g., variable substitution, encoding). Attackers can bypass detection using PowerShell aliases, encoded commands, or alternative binaries like wmic.exe. It fails to detect equivalent behaviors across LOLBins or through API-based task creation.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Detects use of New-ScheduledTask cmdlet, a legitimate but monitorable action",
              "Combines multiple command-line keywords to reduce trivial bypass"
            ],
            "weaknesses": [
              "Highly susceptible to command-line obfuscation and encoding",
              "Ignores alternative execution methods (e.g., schtasks.exe, wmic)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only a single stage\u2014initial execution via command-line invocation of scheduled task creation\u2014and lacks logic to correlate across multiple stages such as persistence validation, lateral movement, or follow-on actions. It does not chain related events or detect subsequent behaviors that confirm malicious intent.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:12.998416",
          "metadata": {
            "strengths": [
              "Detects initial use of common adversary tools (PowerShell/cmd) for task creation",
              "Focuses on high-risk command-line patterns associated with system modification"
            ],
            "weaknesses": [
              "Limited to one-time process creation event without temporal correlation",
              "No detection of persistence verification or downstream execution of created tasks"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Create or Modify System Process Detection) scored 0.47/1.0 (Poor). Best performance in quality (0.58). Needs improvement in detectability (0.30). Issues found in: detection_logic_correctness, detection_sensitivity, metadata_richness",
      "timestamp": "2025-12-28T15:12:12.998416",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Create or Modify System Process Detection",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.59,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6588235294117648,
        "effectiveness": 0.6066666666666667,
        "realism": 0.5888888888888889,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Contains core detection components: title, id, detection logic, and MITRE tags",
              "Includes meaningful false positives and proper logsource definition"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete metadata reduces traceability and operational readiness"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic correctly identifies scheduled task creation via schtasks, PowerShell, and WMIC\u2014key methods for T1053.005. However, the PowerShell selection uses 'Register-ScheduledTask' which is a legitimate cmdlet but may miss other task creation methods like 'schtasks /create' in PowerShell. The condition logic is sound and uses standard Sigma field names.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Accurate mapping to T1053.005 via multiple tool-based selections",
              "Uses standard Sigma syntax and correct field names (Image, CommandLine)"
            ],
            "weaknesses": [
              "PowerShell detection may miss alternative cmdlets or .NET-based task creation",
              "WMIC 'create' is overly broad and could match non-scheduled task activity"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity due to broad CommandLine filters without additional context like parent process, user, or command structure. For example, 'wmic.exe' with 'create' could trigger on non-malicious WMI object creation. No exclusion of known administrative tools or system accounts increases false positive risk in production.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Separates detection into distinct tool-based selections for clarity",
              "Includes documented false positives"
            ],
            "weaknesses": [
              "No filtering on user context or parent process (e.g., from Office apps or scripts)",
              "Relies on substring matches without command structure validation"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple vectors (schtasks, PowerShell, WMIC) used in scheduled task creation, increasing coverage against evasion. It would catch common offensive tools and scripts. However, it does not account for obfuscated commands or alternative APIs (e.g., via COM objects), limiting detection depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Covers three primary command-line methods used in real-world attacks",
              "Broad enough to detect various tooling (e.g., Cobalt Strike, Empire)"
            ],
            "weaknesses": [
              "No case-insensitive matching or regex to catch obfuscated commands",
              "Misses non-command-line methods (e.g., via Task Scheduler GUI or API calls)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but incorrectly labels the technique as 'Process Injection' instead of 'Scheduled Task'. It lacks references to authoritative sources, threat actors, malware families, or campaign names that would enhance context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK sub-technique tag (T1053.005)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Incorrect technique_name: 'Process Injection' instead of 'Scheduled Task Creation'",
              "Missing MITRE reference link and threat actor/tooling context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like 'Image|endswith' and 'CommandLine|contains' on indexed fields, avoids leading wildcards, and structures conditions logically. However, 'CommandLine|contains' without additional constraints could lead to broader matching.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Uses endswith for precise image path matching",
              "Leverages simple, indexed fields for fast evaluation"
            ],
            "weaknesses": [
              "Relies on 'CommandLine|contains' which may match unrelated commands with 'create'",
              "Could benefit from more specific command-line token checks"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers three primary methods (schtasks, PowerShell, WMI) used in T1053.005, which represents core attack vectors. However, it misses detection of alternative tools like 'at.exe', 'tasklist /create' via COM interfaces, or .NET-based task creation via PowerShell.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Covers major scheduled task creation tools (schtasks, PowerShell, WMI)",
              "Aligned with common adversary tooling"
            ],
            "weaknesses": [
              "Does not cover .NET or COM-based task creation in PowerShell",
              "Excludes legacy 'at.exe' usage common in older malware"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks in-rule filtering (e.g., parent process, user context, or path exclusions). It triggers on any 'Register-ScheduledTask' or '/create' usage, including legitimate admin scripts without behavioral context.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Comprehensive falsepositive list in metadata",
              "Identifies software deployment and system updates as expected noise"
            ],
            "weaknesses": [
              "No parent-child process constraints (e.g., powershell spawned by Office)",
              "Lacks user or session context filtering (e.g., SYSTEM vs user)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world T1053.005 usage by detecting multiple common methods (schtasks, PowerShell, WMI), which reflects attacker tool diversity. However, it lacks specificity around known adversary behaviors, such as common command-line flags, persistence timing, or integration with other TTPs like privilege escalation or lateral movement.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Covers multiple legitimate execution methods used by adversaries",
              "Aligned with MITRE T1053.005 sub-technique scope"
            ],
            "weaknesses": [
              "No reference to specific APT groups or campaigns using these methods",
              "Lacks context on malicious parameter patterns or obfuscation techniques"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule has valid Sigma syntax and uses common process creation logging, which is widely available. However, the siem_verification shows a failed Splunk query (HTTP 503), indicating untested deployment, and the high severity may generate excessive false positives without additional filtering.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Uses standard Windows process creation events",
              "Clear detection logic with basic filtering"
            ],
            "weaknesses": [
              "Untested in SIEM (verification failed), raising deployment concerns",
              "High false positive risk due to common administrative use of these tools"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly indicate what is detected, and the false positive list helps analysts triage alerts. However, it lacks enrichment fields (e.g., user context, parent process) that would support deeper investigation and pivoting.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Clear title and description for quick understanding",
              "Useful false positive guidance for common benign scenarios"
            ],
            "weaknesses": [
              "Missing key investigative fields like User, ParentImage, or Commandline length",
              "No references to MITRE or response playbooks in description"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on command-line arguments and exact process names, making it vulnerable to obfuscation, LOLBin misuse, or alternative execution via .NET or COM interfaces. It does not account for encoded commands, indirect execution, or fileless techniques commonly used by advanced adversaries.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Covers multiple execution vectors (schtasks, PowerShell, WMI)",
              "Uses behavioral keywords like '/create' and 'Register-ScheduledTask'"
            ],
            "weaknesses": [
              "Easily bypassed by command-line obfuscation or alternative APIs",
              "No detection logic for indirect or script-based task creation (e.g., via JS/VBS)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule only captures the creation of a scheduled task via three command\u2011line utilities. It does not monitor subsequent execution, persistence usage, lateral movement, or impact phases, nor does it correlate events across the attack lifecycle.",
          "confidence": 0.92,
          "timestamp": "2025-12-28T15:12:58.470489",
          "metadata": {
            "strengths": [
              "Covers multiple legitimate creation vectors (schtasks, PowerShell, WMIC).",
              "Leverages process_creation logs which are commonly available."
            ],
            "weaknesses": [
              "Detects a single event type; no visibility into later task execution or abuse.",
              "Lacks correlation logic (e.g., linking task name to later process launches).",
              "High false\u2011positive potential from legitimate admin scripts."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1053.005 (Scheduled Task Creation via Multiple Methods) scored 0.59/1.0 (Poor). Best performance in correctness (0.66). Needs improvement in detectability (0.36). Issues found in: detection_specificity, false_positive_resistance, operational_deployability",
      "timestamp": "2025-12-28T15:12:58.470489",
      "metadata": {
        "attack_id": "attack.t1053.005",
        "technique_name": "Scheduled Task Creation via Multiple Methods",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.4166666666666667,
      "category_scores": {
        "correctness": 0.45999999999999996,
        "quality": 0.4235294117647058,
        "effectiveness": 0.39333333333333337,
        "realism": 0.5555555555555556,
        "detectability": 0.25555555555555554
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule contains core fields (title, id, description, logsource, detection, falsepositives, level, tags) but lacks required metadata such as status, references, author, and date. Tags include a generic ATT&CK tag but miss the specific technique ID format.",
          "confidence": 0.88,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "All mandatory Sigma sections (logsource, detection, falsepositives, level) are present",
              "Technique is referenced via ATT&CK tag"
            ],
            "weaknesses": [
              "Missing metadata fields (status, references, author, date)",
              "Tags are not fully aligned with MITRE ATT&CK taxonomy (e.g., missing t1560.001)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The logic captures archive\u2011related command lines launched from script hosts, which aligns with the T1560.001 behavior, but the condition is overly simplistic and may fire on legitimate admin tasks.",
          "confidence": 0.81,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Uses both command\u2011line indicators and parent\u2011process context",
              "Covers a range of common archiving tools (zip, 7z, tar, etc.)"
            ],
            "weaknesses": [
              "ParentImage list includes ubiquitous processes like svchost.exe, increasing noise",
              "No additional filters (e.g., user, command\u2011line patterns) to narrow scope"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "Broad \"contains\" matches on generic terms and inclusion of common system processes make the rule prone to false positives in typical administrative or backup activities.",
          "confidence": 0.79,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Attempts to limit detection to script\u2011host parents",
              "Lists multiple archive extensions to catch varied tools"
            ],
            "weaknesses": [
              "Contains matches on generic words like \"compress\" capture many benign commands",
              "Including svchost.exe as a parent process dramatically reduces specificity"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is reasonably sensitive to many archiving utilities and common script hosts, but it may miss less common tools or renamed binaries and does not account for PowerShell\u2019s native Compress\u2011Archive cmdlet.",
          "confidence": 0.84,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Covers a wide set of archive file extensions and tool names",
              "Matches both command\u2011line arguments and parent processes"
            ],
            "weaknesses": [
              "Does not detect PowerShell\u2019s built\u2011in compression commands",
              "Relies on exact substrings; renamed or obfuscated binaries could evade detection"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule provides a basic description, a MITRE sub\u2011technique tag and a technique name, but it lacks a tactic tag, authoritative references, threat\u2011actor or campaign context, and associated tool/malware information. The metadata is therefore sparse and limits investigative value.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Includes a MITRE sub\u2011technique tag (attack.t1560.001)",
              "Provides a concise description and false\u2011positive guidance"
            ],
            "weaknesses": [
              "Missing tactic tag and broader ATT&CK context",
              "No references to research, tools, or threat\u2011actor usage"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection avoids leading wildcards and uses endswith for parent images, which is good for performance. However it does not filter on the Sysmon EventID, relies on broad \"contains\" checks that can generate high volume, and lacks ordering of the most selective filters first.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "No leading wildcards; uses endswith for parent image",
              "Logsource is specific to Sysmon process creation"
            ],
            "weaknesses": [
              "Missing EventID filter (e.g., EventID 1) to limit scope",
              "Broad CommandLine contains values increase noise and query cost"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule captures common script hosts and generic archive extensions, covering the core of T1560.001. It omits many execution vectors (cmd.exe, rundll32, scheduled tasks), does not reference popular adversary tools (7\u2011Zip, PowerShell\u2011based archivers), and lacks coverage of sub\u2011techniques or multi\u2011stage contexts.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Targets typical script hosts used by attackers",
              "Covers a range of archive file extensions"
            ],
            "weaknesses": [
              "Limited to a narrow set of parent processes",
              "No detection of tool\u2011specific binaries or advanced archiving techniques"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "While the parent\u2011child relationship helps reduce some noise, the rule still matches many legitimate administrative scripts that use PowerShell or WScript to compress logs. There are no explicit whitelists, user/account filters, or frequency\u2011based logic to further curb false positives.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Uses parent\u2011image filtering to add context",
              "Provides a false\u2011positive note for legitimate admin scripts"
            ],
            "weaknesses": [
              "Broad CommandLine contains patterns generate many benign hits",
              "Lacks whitelisting, user/account exclusions, or temporal correlation"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets a known ATT&CK technique (T1560.001) and includes typical LOLBin parents, but it lacks any reference to specific threat actor tooling, campaigns, or nuanced behavior such as timing or target directories.",
          "confidence": 0.82,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Maps to a legitimate ATT&CK technique",
              "Includes common script hosts used by adversaries"
            ],
            "weaknesses": [
              "No campaign or APT group context",
              "Overly generic keyword list without operational nuance"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma syntax is mostly correct and uses a widely available log source (Sysmon process creation). However, the rule is likely to generate many false positives and has not been validated in a production environment.",
          "confidence": 0.78,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Valid logsource for most Windows enterprises",
              "Clear severity labeling"
            ],
            "weaknesses": [
              "High potential false\u2011positive volume",
              "No evidence of testing or tuning"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description are concise, but the alert provides limited investigative data (only command line and parent image) and offers no guidance on next steps or enrichment fields.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Descriptive title",
              "Brief description of the behavior"
            ],
            "weaknesses": [
              "Missing key fields for triage (user, hashes, file paths)",
              "No remediation or investigation playbook references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The detection relies heavily on visible command\u2011line strings and specific parent executables, which can be easily evaded by renaming tools, using encoded PowerShell commands, or leveraging native .NET compression APIs.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Combines two indicators (command line + parent process)",
              "Covers several common compression utilities"
            ],
            "weaknesses": [
              "Easily bypassed with renamed binaries or encoded commands",
              "No multi\u2011vector correlation (e.g., file creation, network exfil)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 2,
          "normalized_score": 0.2,
          "explanation": "The rule only looks at a single process creation event that combines archive\u2011related command\u2011line strings with a limited set of parent processes. It does not cover persistence, lateral movement, or downstream exfiltration steps, nor does it correlate multiple events across the attack lifecycle.",
          "confidence": 0.86,
          "timestamp": "2025-12-28T15:13:42.236169",
          "metadata": {
            "strengths": [
              "Uses parent\u2011process context to reduce noise compared to pure command\u2011line matching",
              "Covers a range of common archiving utilities and file extensions"
            ],
            "weaknesses": [
              "Detects only the execution stage; no coverage of data staging, exfiltration, or persistence",
              "Lacks correlation logic to link archive creation with prior credential dumping or lateral movement events"
            ]
          }
        }
      ],
      "summary": "Rule for attack.collection (Suspicious Data Archiving via Script Hosts) scored 0.42/1.0 (Poor). Best performance in realism (0.56). Needs improvement in detectability (0.26). Issues found in: sigma_completeness, detection_logic_correctness, detection_specificity",
      "timestamp": "2025-12-28T15:13:42.236169",
      "metadata": {
        "attack_id": "attack.collection",
        "technique_name": "Suspicious Data Archiving via Script Hosts",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7066666666666667,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.7823529411764706,
        "effectiveness": 0.64,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields populated, but some fields like 'status', 'author', and 'date' are missing. The provided fields have meaningful content.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Meaningful content in required fields",
              "Proper logsource and detection structure"
            ],
            "weaknesses": [
              "Missing some required fields",
              "Lack of author and date information"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies Windows Account Discovery via Command Utilities with sound condition logic and standard Sigma fields. It correctly triggers on actual attacks without overly complex or redundant conditions.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate admin activities"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses exact matches and includes filters to exclude benign activity but could be more specific to minimize false positives. It considers legitimate use cases but may still catch normal business operations.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Exact matches used where possible",
              "Filters to exclude benign activity"
            ],
            "weaknesses": [
              "May catch normal business operations",
              "Not highly specific"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers multiple indicators of the attack technique and uses appropriate matching to catch variations. However, it may not detect highly evasive techniques or all possible tool variations.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Covers multiple indicators",
              "Appropriate use of matching"
            ],
            "weaknesses": [
              "May not detect highly evasive techniques",
              "Limited tool variations considered"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lacks threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields first, avoids leading wildcards, and uses specific filters. The logsource is specific enough, and the detection logic is efficient.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Efficient detection logic",
              "Specific filters"
            ],
            "weaknesses": [
              "No notable weaknesses"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers common attack vectors and methods for Windows Account Discovery via Command Utilities, but may not detect advanced or sophisticated variants. It considers different tools, but not multi-stage attacks.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Covers common attack vectors",
              "Considers different tools"
            ],
            "weaknesses": [
              "May not detect advanced variants",
              "No multi-stage attack consideration"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes some filters to reduce false positives, but may not be effective in all cases. It lacks time-based or frequency-based logic and parent-child process relationships consideration.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Includes some filters",
              "Considers legitimate processes"
            ],
            "weaknesses": [
              "May not be effective in all cases",
              "Lacks time-based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule demonstrates awareness of threat actor TTPs by detecting common command-line utilities used for account discovery. However, it lacks specific references to campaigns, APT groups, or operations. The detection logic aligns with real-world attack chains, but could be improved with more operational intelligence.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Detects common command-line utilities",
              "Aligns with real-world attack chains"
            ],
            "weaknesses": [
              "Lacks specific references to campaigns or APT groups",
              "Limited operational intelligence"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is ready for immediate deployment, with no syntax errors and a realistic log source. The detection logic has been defined, but testing or validation is not explicitly mentioned. The severity level is appropriate, and false positive guidance is provided.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "No syntax errors",
              "Realistic log source"
            ],
            "weaknesses": [
              "Lacks explicit testing or validation",
              "Potential for excessive alerts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule provides actionable information, with a clear title and description. However, the fields in detection could be more useful for pivoting and investigation. The severity level helps analysts prioritize their response, and false positive guidance is provided.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Clear title and description",
              "Severity level helps prioritize response"
            ],
            "weaknesses": [
              "Fields in detection could be more useful",
              "Limited guidance for next steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to common attacker evasion techniques, such as renaming executables or hiding command-line arguments. It relies solely on command-line arguments and does not consider obfuscation attempts or living-off-the-land evasions.",
          "confidence": 0.6,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Detects behavior patterns",
              "Uses multiple detection points"
            ],
            "weaknesses": [
              "Vulnerable to evasion techniques",
              "Relies solely on command-line arguments"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of Windows Account Discovery via Command Utilities but lacks detection of persistence mechanisms, lateral movement, data collection, or impact activities. It focuses on single-event detection without correlating across multiple stages. The rule's logic is limited to detecting specific command-line utilities.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:14:37.585621",
          "metadata": {
            "strengths": [
              "Detects common command-line utilities",
              "Covers both cmd.exe and powershell.exe"
            ],
            "weaknesses": [
              "Lacks detection of persistence mechanisms",
              "Does not correlate across multiple stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1087 (Windows Account Discovery via Command Utilities) scored 0.71/1.0 (Fair). Best performance in correctness (0.86). Needs improvement in detectability (0.46). Issues found in: evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T15:14:37.585621",
      "metadata": {
        "attack_id": "attack.t1087",
        "technique_name": "Windows Account Discovery via Command Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7833333333333334,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.7823529411764706,
        "effectiveness": 0.7666666666666667,
        "realism": 0.8555555555555556,
        "detectability": 0.6555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields, but some fields like 'status', 'author', and 'date' are missing or not properly populated. The provided fields are meaningful and well-structured.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Well-structured logsource and detection fields",
              "Properly populated tags including MITRE ATT&CK"
            ],
            "weaknesses": [
              "Missing 'status', 'author', and 'date' fields",
              "Not all fields are properly populated"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies Scheduled Task Creation via schtasks, PowerShell, or WMIC, with sound condition logic and standard Sigma fields. It would realistically trigger on actual attacks.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Accurate selection criteria for TTP behavior",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate administrative scripts"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses exact matches and includes filters to exclude benign activity, but could be more specific to minimize false positives. It considers legitimate use cases but may not exclude all benign activity.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Uses exact matches for command line parameters",
              "Includes filters to exclude some benign activity"
            ],
            "weaknesses": [
              "May not exclude all legitimate administrative scripts",
              "Could be more specific to reduce false positives"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers multiple indicators of the same attack technique and uses appropriate logic to catch variations, but may not detect all evasion attempts. It considers different tools and techniques.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Covers multiple indicators of the same attack technique",
              "Considers different tools and techniques"
            ],
            "weaknesses": [
              "May not detect all evasion attempts",
              "Could be more robust to catch variations"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Comprehensive MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lack of threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields first, avoids leading wildcards, and applies specific filters. The detection logic is well-structured, and the logsource is specific enough.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Efficient use of indexed fields",
              "Well-structured detection logic"
            ],
            "weaknesses": [
              "No notable weaknesses"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers the main attack vectors and methods for Scheduled Task Creation, including schtasks, PowerShell, and WMIC. However, it may not detect advanced or custom variants.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Covers main attack vectors",
              "Includes multiple tools"
            ],
            "weaknesses": [
              "May not detect advanced variants",
              "Limited sub-technique coverage"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes some filters to reduce false positives, but may not be comprehensive enough. Legitimate administrative scripts and endpoint management tools may still trigger false positives.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Some filters to reduce false positives",
              "Acknowledges potential false positives"
            ],
            "weaknesses": [
              "May not be comprehensive enough",
              "Limited whitelisting"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates awareness of threat actor TTPs by detecting Scheduled Task Creation via schtasks, PowerShell, or WMIC, which is a common technique used for persistence. However, it lacks specific references to campaigns, APT groups, or operations. The detection logic aligns with real-world attack chains, but could be improved with more context.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Detects common persistence technique",
              "Aligns with real-world attack chains"
            ],
            "weaknesses": [
              "Lacks specific campaign references",
              "Limited context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule is ready for immediate deployment, with no syntax errors and a realistic log source. The detection logic has been defined, but testing or validation is not explicitly mentioned. The severity level is appropriate, and false positive guidance is provided.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Realistic log source",
              "Appropriate severity level"
            ],
            "weaknesses": [
              "Lacks explicit testing or validation",
              "Potential for false positives"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule provides actionable information, with a clear title and description. The fields in detection are useful for pivoting and investigation, but could be improved with more context. The severity level helps analysts prioritize their response, and false positive guidance is provided.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Clear title and description",
              "Useful fields for investigation"
            ],
            "weaknesses": [
              "Limited context",
              "Potential for false positives"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule is somewhat robust against common attacker evasion techniques, detecting behavior patterns and relationships. However, it relies heavily on command-line arguments, which can be hidden or obfuscated. The rule does not consider obfuscation attempts or living-off-the-land evasions.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Detects behavior patterns",
              "Not easily bypassed by renaming executables"
            ],
            "weaknesses": [
              "Relies on command-line arguments",
              "Vulnerable to obfuscation attempts"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects Scheduled Task Creation via schtasks, PowerShell, or WMIC, which is a technique used for persistence. It detects initial execution but lacks correlation across multiple related events or stages. The rule focuses on a single stage of the attack lifecycle.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:15:31.642207",
          "metadata": {
            "strengths": [
              "Detects initial execution of the technique",
              "Covers multiple tools (schtasks, PowerShell, WMIC)"
            ],
            "weaknesses": [
              "Lacks correlation across multiple stages",
              "Does not detect lateral movement or data collection activities"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1053.005 (Scheduled Task Creation via schtasks, PowerShell, or WMIC) scored 0.78/1.0 (Fair). Best performance in correctness (0.86). Needs improvement in detectability (0.66).",
      "timestamp": "2025-12-28T15:15:31.642207",
      "metadata": {
        "attack_id": "attack.t1053.005",
        "technique_name": "Scheduled Task Creation via schtasks, PowerShell, or WMIC",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7850000000000001,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.7882352941176471,
        "effectiveness": 0.7666666666666667,
        "realism": 0.8555555555555556,
        "detectability": 0.6555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields, but some fields like 'status', 'author', and 'date' are missing or not properly populated. The provided fields are meaningful and well-structured.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Well-structured logsource and detection fields",
              "Properly populated tags including MITRE ATT&CK"
            ],
            "weaknesses": [
              "Missing 'status', 'author', and 'date' fields",
              "Some fields might be placeholders"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies Scheduled Task Creation via schtasks.exe, at.exe, or PowerShell, with sound condition logic and standard Sigma fields. It correctly filters out system-initiated tasks and legitimate use cases.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Accurate selection criteria for TTP behavior",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for overly complex logic if additional conditions are added"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule is specific enough to minimize false positives, using exact matches and appropriate filters to exclude benign activity. However, it might not cover all legitimate use cases or system processes.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Uses exact matches and filters for precision",
              "Excludes system-initiated tasks"
            ],
            "weaknesses": [
              "Might not cover all legitimate use cases or system processes"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers the main indicators of Scheduled Task Creation but might not catch all attack variations or evasion attempts, such as encoded commands or different paths.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Covers main indicators of the attack technique",
              "Uses wildcards for some indicators"
            ],
            "weaknesses": [
              "Might not catch all attack variations or evasion attempts"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Comprehensive metadata",
              "Clear description"
            ],
            "weaknesses": [
              "Lack of threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields first, avoids leading wildcards, and applies specific filters. The detection logic is efficient, and the logsource is specific enough.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Efficient detection logic",
              "Specific logsource"
            ],
            "weaknesses": [
              "No apparent optimization issues"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers the main attack vectors and methods for Scheduled Task Creation, including sub-techniques. However, it may not detect all advanced or sophisticated variants.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Covers main attack vectors",
              "Includes sub-techniques"
            ],
            "weaknesses": [
              "May not detect all advanced variants"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes filters to exclude known legitimate processes and users, but may not be comprehensive enough to reduce all false positives.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Filters legitimate processes",
              "Excludes system accounts"
            ],
            "weaknesses": [
              "May not reduce all false positives"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates awareness of threat actor TTPs by detecting Scheduled Task Creation via schtasks.exe, at.exe, or PowerShell, aligning with ATT&CK technique T1053.005. However, it lacks specific references to campaigns, APT groups, or operations. The detection logic is sound and considers real-world attack chains.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Aligns with ATT&CK technique",
              "Considers real-world attack chains"
            ],
            "weaknesses": [
              "Lacks specific campaign references",
              "Does not account for evolving TTPs"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule is ready for immediate deployment, with no syntax errors, a realistic log source, and tested detection logic. The severity level is appropriate, and the false positive rate is acceptable. However, the SIEM verification status shows an error, which may indicate issues with the rule's performance in production.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Realistic log source",
              "Tested detection logic"
            ],
            "weaknesses": [
              "SIEM verification error",
              "Potential for excessive alerts"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule provides actionable information, with a clear title, sufficient context, and useful fields for investigation. However, the description could be more detailed, and the references could guide next steps in investigation and remediation more explicitly.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Clear title",
              "Useful fields for investigation"
            ],
            "weaknesses": [
              "Description could be more detailed",
              "Lacks explicit guidance for next steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule is robust against some evasion techniques, detecting behavior patterns and relationships. However, it relies heavily on command-line arguments and does not consider obfuscation attempts or living-off-the-land evasions explicitly.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Detects behavior patterns",
              "Not easily bypassed by renaming executables"
            ],
            "weaknesses": [
              "Relies on command-line arguments",
              "Does not consider obfuscation attempts"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects Scheduled Task Creation via schtasks.exe, at.exe, or PowerShell, which is a single stage of the attack lifecycle. It does not explicitly detect persistence, lateral movement, data collection, or impact activities. However, it can be used as a starting point for further correlation and analysis.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:16:26.147363",
          "metadata": {
            "strengths": [
              "Detects initial execution of the technique",
              "Excludes legitimate system-initiated tasks"
            ],
            "weaknesses": [
              "Limited to single-event detection",
              "Does not detect persistence or lateral movement"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1053.005 (Scheduled Task Creation via schtasks.exe, at.exe or PowerShell) scored 0.79/1.0 (Fair). Best performance in correctness (0.86). Needs improvement in detectability (0.66).",
      "timestamp": "2025-12-28T15:16:26.148457",
      "metadata": {
        "attack_id": "attack.t1053.005",
        "technique_name": "Scheduled Task Creation via schtasks.exe, at.exe or PowerShell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "094f219d-694e-4714-b8d8-e650069c164d",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.7650000000000001,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.7823529411764706,
        "effectiveness": 0.6933333333333332,
        "realism": 0.8555555555555556,
        "detectability": 0.6555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields, but some fields like 'status', 'author', and 'date' are missing. The provided fields are properly populated with meaningful content.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.214695",
          "metadata": {
            "strengths": [
              "Properly populated fields",
              "Meaningful content"
            ],
            "weaknesses": [
              "Missing fields",
              "Incomplete metadata"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately matches the TTP behavior and indicators. The selection criteria and condition logic are sound and not overly complex.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:17:23.214695",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited exclusion filters"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses exact matches and includes some filters to exclude benign activity, but may still catch legitimate tools or system processes. More specific filters and conditions could improve specificity.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:17:23.214695",
          "metadata": {
            "strengths": [
              "Exact matches used",
              "Some exclusion filters"
            ],
            "weaknesses": [
              "Potential for false positives",
              "Limited context consideration"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule covers multiple indicators and uses wildcards to catch variations, but may not account for all evasion attempts or advanced techniques.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Multiple indicators covered",
              "Wildcard usage"
            ],
            "weaknesses": [
              "Potential evasion gaps",
              "Limited advanced technique consideration"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lacks threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields first, avoids leading wildcards, and uses specific and restrictive filters. The logsource is specific enough, and the use of 'contains' and 'endswith' operators is appropriate.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Uses indexed fields first",
              "Specific filters"
            ],
            "weaknesses": [
              "No notable weaknesses"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers the main attack vectors and methods for Office Application Spawning Command Shell with Suspicious Parameters, but may not detect advanced or sophisticated variants. It considers different tools and frameworks, but not multi-stage attacks.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Covers main attack vectors",
              "Considers different tools"
            ],
            "weaknesses": [
              "May not detect advanced variants",
              "Does not consider multi-stage attacks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes some filters to reduce false positives, but may not be effective in all cases. It lacks time-based or frequency-based logic and does not consider parent-child process relationships.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Includes some filters",
              "Considers legitimate processes"
            ],
            "weaknesses": [
              "May not be effective in all cases",
              "Lacks time-based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates awareness of threat actor TTPs by detecting Office Application Spawning Command Shell with Suspicious Parameters, aligning with real-world attack patterns. However, it lacks specific references to campaigns, APT groups, or operations. The detection logic is sound and considers threat actor preferences.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Aligns with real-world attack patterns",
              "Considers threat actor preferences"
            ],
            "weaknesses": [
              "Lacks specific campaign references",
              "Limited metadata"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule is ready for immediate deployment, with no syntax errors, a realistic log source, and tested detection logic. The severity level is appropriate, and the false positive rate is acceptable. The rule has been validated through SIEM verification.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Validated through SIEM verification",
              "Realistic log source"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate Office macros"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule provides actionable information, with a clear title, sufficient context, and useful fields for investigation. However, it could benefit from additional references to guide next steps in investigation and remediation.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Clear title and description",
              "Useful fields for investigation"
            ],
            "weaknesses": [
              "Limited guidance for next steps",
              "No explicit remediation steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule detects behavior patterns and relationships, making it more robust against evasion techniques. However, it relies on command-line arguments, which can be hidden or obfuscated, and does not consider obfuscation attempts or LOLBin evasions.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Detects behavior patterns and relationships",
              "Not easily bypassed by renaming executables"
            ],
            "weaknesses": [
              "Relies on command-line arguments",
              "Limited consideration of obfuscation attempts"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects initial execution of Office Application Spawning Command Shell with Suspicious Parameters by identifying process creation events with specific parent and child processes. However, it does not explicitly detect persistence, lateral movement, or data collection activities. The rule's logic is primarily focused on single-event detection.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T15:17:23.215284",
          "metadata": {
            "strengths": [
              "Detects initial execution of the technique",
              "Specific parent and child process identification"
            ],
            "weaknesses": [
              "Limited to single-event detection",
              "Lacks correlation across multiple related events or stages"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1566 (Office Application Spawning Command Shell with Suspicious Parameters) scored 0.77/1.0 (Fair). Best performance in correctness (0.86). Needs improvement in detectability (0.66).",
      "timestamp": "2025-12-28T15:17:23.215284",
      "metadata": {
        "attack_id": "attack.t1566",
        "technique_name": "Office Application Spawning Command Shell with Suspicious Parameters",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    }
  ]
}