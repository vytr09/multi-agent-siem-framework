{
  "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
  "timestamp": "2025-12-28T14:38:46.609593",
  "config": {
    "llm_judge": {
      "enabled": true,
      "api_key": "<REDACTED>",
      "model": "llama-3.3-70b",
      "temperature": 0.1,
      "max_tokens": "<REDACTED>",
      "timeout": 60,
      "persona": "expert cybersecurity researcher and red team operator with deep knowledge of MITRE ATT&CK framework and detection engineering",
      "detailed_feedback": true,
      "confidence_scores": true,
      "enable_comparison": true,
      "max_requests_per_minute": 60,
      "retry_attempts": 3,
      "retry_delay": 2
    },
    "attackgen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "high_quality_threshold": 0.85,
      "metrics": {
        "technical_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "attack_alignment": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "platform_compatibility": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "operational_realism": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "threat_actor_alignment": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "testing_safety": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "controlled_impact": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "detection_value": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "artifact_generation": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "completeness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        },
        "documentation_quality": {
          "weight": 1.0,
          "min_score": 0.0,
          "max_score": 10.0,
          "enabled": true
        }
      },
      "top_performers_count": 10,
      "bottom_performers_count": 5,
      "enable_comparative_analysis": true,
      "export_format": "json",
      "export_detailed_results": true,
      "export_statistics": true
    },
    "rulegen_benchmark": {
      "enabled": true,
      "use_llm_evaluation": true,
      "use_rule_based_evaluation": true,
      "min_passing_score": 0.6,
      "metrics": {
        "sigma_completeness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_logic_correctness": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "platform_syntax_correctness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "field_mapping_accuracy": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_specificity": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "detection_sensitivity": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "metadata_richness": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "optimization_level": {
          "weight": 1.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "attack_coverage": {
          "weight": 3.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "false_positive_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "contextual_awareness": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "operational_deployability": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "performance_efficiency": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "analyst_actionability": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "evasion_resistance": {
          "weight": 2.5,
          "min_score": 0.0,
          "max_score": 10.0
        },
        "multi_stage_detection": {
          "weight": 2.0,
          "min_score": 0.0,
          "max_score": 10.0
        }
      }
    },
    "general": {
      "max_concurrent_evaluations": 3,
      "batch_size": 5,
      "enable_caching": true,
      "cache_ttl": 3600,
      "log_level": "INFO",
      "log_file": "logs/benchmark.log",
      "log_format": "json",
      "output_directory": "data/benchmark_results",
      "create_timestamp_subdirs": true,
      "calculate_statistics": true,
      "generate_summary_report": true,
      "export_csv": true,
      "generate_plots": false,
      "plot_format": "png"
    },
    "comparison": {
      "enabled": true,
      "criteria": [
        "overall quality",
        "technical correctness",
        "operational realism",
        "testing safety"
      ],
      "significant_difference_threshold": 0.1
    },
    "regression": {
      "enabled": false,
      "baseline_file": "baselines/attackgen_baseline.json",
      "alert_on_degradation": true,
      "degradation_threshold": 0.05,
      "track_history": true,
      "history_file": "history/benchmark_history.json"
    },
    "alerting": {
      "enabled": false,
      "low_score_threshold": 0.5,
      "alert_channels": [
        "email",
        "slack"
      ],
      "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "from_address": "benchmark@example.com",
        "to_addresses": [
          "team@example.com"
        ]
      },
      "slack": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#siem-benchmarks"
      }
    },
    "advanced": {
      "ensemble_evaluation": {
        "enabled": false,
        "models": [
          "gemini-2.0-flash-lite"
        ],
        "aggregation_method": "weighted_average"
      },
      "ground_truth": {
        "enabled": false,
        "dataset_path": "datasets/ground_truth.json",
        "calculate_accuracy": true
      },
      "custom_metrics": {
        "enabled": false,
        "metrics_file": "config/custom_metrics.yaml"
      },
      "debug": {
        "enabled": false,
        "save_prompts": true,
        "save_responses": true,
        "verbose_logging": true
      }
    }
  },
  "statistics": {
    "total_evaluations": 21,
    "average_score": 0.6058730158730159,
    "category_averages": {
      "correctness": 0.7057142857142858,
      "quality": 0.626330532212885,
      "effectiveness": 0.5498412698412698,
      "realism": 0.7105820105820106,
      "detectability": 0.444973544973545
    },
    "metric_averages": {
      "sigma_completeness": 0.6857142857142856,
      "detection_logic_correctness": 0.719047619047619,
      "detection_specificity": 0.5333333333333332,
      "detection_sensitivity": 0.6238095238095238,
      "metadata_richness": 0.6333333333333331,
      "optimization_level": 0.8095238095238096,
      "attack_coverage": 0.5714285714285714,
      "false_positive_resistance": 0.4571428571428572,
      "contextual_awareness": 0.6333333333333331,
      "operational_deployability": 0.7,
      "analyst_actionability": 0.7238095238095238,
      "evasion_resistance": 0.4809523809523809,
      "multi_stage_detection": 0.4000000000000001
    },
    "score_distribution": {
      "excellent (>=0.9)": 0,
      "good (0.8-0.9)": 0,
      "fair (0.7-0.8)": 0,
      "poor (0.6-0.7)": 12,
      "failing (<0.6)": 9
    }
  },
  "results": [
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.69,
      "category_scores": {
        "correctness": 0.8600000000000001,
        "quality": 0.723529411764706,
        "effectiveness": 0.64,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule has most required Sigma fields populated with meaningful content, but some fields like 'author' and 'date' are missing. The 'references' field is also not explicitly mentioned. The provided fields are well-populated, indicating a good structure.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Well-structured logsource",
              "Properly populated detection fields"
            ],
            "weaknesses": [
              "Missing 'author' and 'date' fields",
              "Lack of explicit 'references' field"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately identifies the attack technique by focusing on specific system information discovery commands executed from command shells. The condition logic is sound, and the use of standard Sigma fields is appropriate. The rule would likely trigger on actual attacks without overly targeting benign activity.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Accurate selection criteria",
              "Sound condition logic"
            ],
            "weaknesses": [
              "Potential for false positives from legitimate admin activities"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule attempts to minimize false positives by including filters for parent processes and specific command-line arguments. However, it might still catch some legitimate activities, especially from system administration scripts or monitoring tools. The specificity could be improved with more detailed filters or conditions.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Filters for parent processes",
              "Specific command-line arguments"
            ],
            "weaknesses": [
              "Potential for catching legitimate admin activities",
              "Could be more specific"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers specific indicators of the attack technique but might not catch variations or evasion attempts effectively. It relies on exact matches for command names and does not account for potential obfuscation or renaming of commands. Adding wildcards or regex for command paths and considering case-insensitive matching could improve sensitivity.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Covers specific attack indicators"
            ],
            "weaknesses": [
              "Limited coverage of attack variations",
              "Vulnerable to simple evasions"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes MITRE ATT&CK tags and references to authoritative sources, but lacks specific threat actor information and campaign names. The description is clear and detailed, explaining what the rule detects.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Includes MITRE ATT&CK tags",
              "Clear description"
            ],
            "weaknesses": [
              "Lacks threat actor information",
              "No campaign names"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields first, avoids leading wildcards, and applies specific filters. The detection logic is well-structured, and the logsource is specific enough.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Uses indexed fields first",
              "Well-structured detection logic"
            ],
            "weaknesses": [
              "No notable weaknesses"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers common system information discovery commands, but may not detect more advanced or sophisticated variants. It considers different tools, but not multi-stage attacks.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Covers common attack vectors",
              "Considers different tools"
            ],
            "weaknesses": [
              "May not detect advanced variants",
              "Does not consider multi-stage attacks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes some filters, such as excluding legitimate parent processes, but may still generate false positives from legitimate system administration scripts or monitoring tools.",
          "confidence": 0.7,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Excludes legitimate parent processes"
            ],
            "weaknesses": [
              "May still generate false positives",
              "Lacks time-based or frequency-based logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common system discovery commands used by adversaries, aligning with T1010. However, it mislabels the technique as 'Application Window Discovery' instead of 'System Information Discovery', indicating a misunderstanding of MITRE ATT&CK taxonomy. While the selected tools (systeminfo, ipconfig /all, getmac, whoami) are frequently used in real attacks, the rule lacks context from known adversary playbooks or campaign-specific behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Covers frequently abused native Windows utilities in post-compromise discovery",
              "Includes command-line arguments like '/all' that increase malicious likelihood"
            ],
            "weaknesses": [
              "Incorrectly maps to T1010 and mislabels technique name",
              "Lacks integration of adversary timing, targeting patterns, or campaign references"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation events, and has been verified in a Splunk environment with 52 events detected\u2014indicating real-world viability. The 'high' severity is appropriate for discovery activity from shells, and false positives are reasonably documented. However, the lack of user context or network session correlation could lead to alert fatigue in large environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Validated detection with successful SIEM verification and field extraction check",
              "Realistic logsource (Sysmon process creation) widely deployed in enterprises"
            ],
            "weaknesses": [
              "No filtering on user context (e.g., SYSTEM vs. user) which may increase noise",
              "No rate-limiting or thresholding to reduce repetitive administrative activity"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly indicate what is being detected, and the fields used (Image, CommandLine, ParentImage) allow for effective pivoting in investigations. The false positive guidance helps analysts triage legitimate admin use. However, missing fields like User, Host, or Hash limit enrichment potential, and the incorrect MITRE tag could misdirect investigation efforts.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Clear title and description enable quick understanding",
              "False positive examples aid analyst triage"
            ],
            "weaknesses": [
              "Incorrect MITRE technique tag may mislead response",
              "Lacks key forensic fields (e.g., user, command-line full context)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on exact executable names and specific command-line arguments, making it vulnerable to simple evasion like using alternative tools (e.g., wmic, powershell equivalents), obfuscation, or LOLBins. While it checks parent process (cmd/powershell), attackers often launch these tools via scripts or encoded commands that may not trigger this rule. It does not account for command-line argument variation or indirect execution methods.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Includes parent process filtering to focus on interactive shell use",
              "Detects multiple related tools, increasing coverage across variants"
            ],
            "weaknesses": [
              "Easily bypassed by using PowerShell cmdlets instead of binaries",
              "Relies on static paths and clear-text arguments, both easily evaded"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of system information discovery commands but is limited to single-event process creation. It does not correlate across multiple stages such as persistence, lateral movement, or follow-on data exfiltration, nor does it track sequences of related activities that would indicate progression in the attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:26:32.202111",
          "metadata": {
            "strengths": [
              "Detects initial reconnaissance activity via common discovery commands",
              "Includes parent process context to focus on interactive shell usage"
            ],
            "weaknesses": [
              "No correlation across multiple events or stages",
              "Limited to initial access detection without tracking downstream TTPs"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1010 (Discovery of System Information via Shell Utilities) scored 0.69/1.0 (Below Average). Best performance in correctness (0.86). Needs improvement in detectability (0.46). Issues found in: evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T14:26:32.202111",
      "metadata": {
        "attack_id": "attack.t1010",
        "technique_name": "Discovery of System Information via Shell Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6633333333333333,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.6647058823529411,
        "effectiveness": 0.6333333333333333,
        "realism": 0.7555555555555555,
        "detectability": 0.5111111111111111
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Includes essential detection components and MITRE tags",
              "Properly structured with unique ID and clear title"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata limits traceability and governance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The logic accurately models T1566 by detecting Office processes spawning command-line interpreters with suspicious command-line arguments (-enc, /c). The use of ParentImage and Image fields aligns with standard Sigma practices and reflects real-world macro-based execution behavior.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Correctly uses ParentImage to trace process lineage",
              "Targets known malicious indicators like '-enc' in PowerShell"
            ],
            "weaknesses": [
              "Does not validate if the Office document is from a user-initiated action",
              "Relies on command-line artifacts that may be obfuscated"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses specific parent processes and command-line keywords, improving precision. However, it may still trigger on legitimate automation scripts or admin tools, especially without filtering on user context or command-line content beyond '/c' or '-enc'.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Narrows detection to specific child processes (cmd, powershell, mshta)",
              "Uses context via ParentImage to reduce noise"
            ],
            "weaknesses": [
              "Lacks exclusion of known benign tools or trusted users",
              "CommandLine|contains '/c' is broad and common in legitimate scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers multiple execution vectors (PowerShell, cmd, mshta) and includes encoded command detection via '-enc', which is common in phishing payloads. However, it could miss obfuscated commands or alternative execution methods like WMI or rundll32 launched from macros.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Detects multiple command interpreters used in phishing attacks",
              "Includes '-enc' as a strong indicator of base64-encoded payloads"
            ],
            "weaknesses": [
              "No case-insensitive matching for command-line arguments",
              "Does not account for command-line splitting or obfuscation techniques"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1566, phishing, initial access) and a clear description, but lacks deeper context such as associated malware families, APT groups, or campaign names. The description explains the detection logic well, but references are missing beyond implied MITRE alignment.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging",
              "Clear, actionable description of detection logic"
            ],
            "weaknesses": [
              "No references to MITRE sub-techniques or execution-specific tactics",
              "Missing threat actor, malware, or campaign context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image, ParentImage, CommandLine) with endswith and contains operators appropriate for Sysmon process creation data. It avoids leading wildcards and structures conditions using indexed fields, though 'CommandLine|contains' could be more specific to reduce noise.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, ParentImage)",
              "Avoids costly regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains '-enc' and '/c' may generate noise without additional constraints",
              "Could benefit from ordering more selective conditions first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule detects common malicious Office macro behaviors by identifying PowerShell, cmd, and mshta spawned from Office apps, including encoded command use. However, it misses coverage of newer techniques like DLL sideloading, DDE execution, or child processes from macro-launched scripts (e.g., wmic, certutil).",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Covers key execution vectors: PowerShell, cmd, mshta",
              "Includes detection of encoded commands via '-enc'"
            ],
            "weaknesses": [
              "Lacks coverage of DDE, WMI, or script-based follow-on stages",
              "Does not map to execution sub-techniques like T1059.001 or T1059.003"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule acknowledges common false positives in metadata but lacks active filtering for trusted paths, signed macros, or administrative contexts. Reliance on single-event detection without thresholding or user context increases FP risk in environments with legitimate Office automation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Clear false positive documentation in metadata",
              "Uses parent-child process logic appropriately"
            ],
            "weaknesses": [
              "No exclusions for trusted users, paths, or signed Office processes",
              "No frequency or behavioral baselining to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world T1566 phishing campaigns where malicious Office documents spawn command-line tools via macros. It captures common execution patterns like PowerShell -enc and cmd /c, which are frequently used in phishing payloads. However, it lacks references to specific APT groups, campaigns, or nuanced timing/contextual behaviors seen in advanced operations.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Matches known phishing TTPs involving Office-spawned shells",
              "Targets encoded PowerShell and cmd execution, common in real attacks"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Lacks context on lure types or delivery mechanisms beyond generic 'government-themed'"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The Sigma rule uses valid Sysmon process creation fields that are widely available in enterprise environments and has been verified in a SIEM (Splunk) with 96 events detected. The 'medium' severity level is appropriate, and false positives are reasonably documented. However, reliance on CommandLine content may vary based on logging policies and command obfuscation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection results",
              "Realistic logsource (Sysmon process creation) commonly deployed"
            ],
            "weaknesses": [
              "Command-line logging must be enabled, which isn't universal",
              "Potential for high volume if macros are used legitimately"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The title and description clearly indicate suspicious behavior: Office apps launching shells, a red flag for macro-based phishing. Analysts can pivot on parent-child process relationships and command-line arguments. However, the rule could include more investigative fields (e.g., user, host, hash) and lacks direct MITRE ATT&CK mapping in the metadata for response guidance.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Clear title and description for quick triage",
              "Detection logic enables process lineage investigation"
            ],
            "weaknesses": [
              "Missing user/session context in detection fields",
              "No direct remediation or enrichment guidance in tags"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects common obfuscation like '-enc' in PowerShell and '/c' in cmd, showing some resistance to basic encoding. However, it relies heavily on command-line arguments, which attackers can bypass using alternative LOLBins, API calls, or obfuscated scripts. It does not incorporate network connections, file writes, or child processes that would strengthen behavioral detection.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Detects encoded PowerShell (-enc), a common malicious pattern",
              "Covers multiple interpreter types (PowerShell, cmd, mshta)"
            ],
            "weaknesses": [
              "Relies on command-line content, easily evaded via obfuscation",
              "No additional behavioral indicators (e.g., network, file drops)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution via Office spawning command-line tools, which aligns with initial access or execution stages. However, it lacks logic to correlate follow-on activities like persistence, lateral movement, or exfiltration, making it primarily a single-event detection. There is no chaining or temporal correlation across attack phases.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:10.605285",
          "metadata": {
            "strengths": [
              "Detects initial malicious execution from Office documents, a common phishing vector",
              "Covers multiple interpreter types (PowerShell, cmd, mshta) used in post-exploitation"
            ],
            "weaknesses": [
              "Limited to process creation event without multi-stage correlation",
              "No detection of subsequent adversary activities beyond initial shell launch"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1566 (Office Document Launches Command Shells (Phishing)) scored 0.66/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.51). Issues found in: false_positive_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T14:27:10.605285",
      "metadata": {
        "attack_id": "attack.t1566",
        "technique_name": "Office Document Launches Command Shells (Phishing)",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5933333333333334,
      "category_scores": {
        "correctness": 0.7200000000000001,
        "quality": 0.6,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and falsepositives, but lacks mandatory fields like 'status', 'author', 'date', and 'references'. The 'id' is present but 'status' is missing, which is required for production-ready rules.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Includes core structural elements: title, detection logic, logsource, and tags",
              "Properly references MITRE ATT&CK via tags"
            ],
            "weaknesses": [
              "Missing required fields: status, author, date, references",
              "Incomplete metadata reduces rule traceability and governance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The logic correctly identifies reg.exe querying key system registry paths associated with system information discovery. The use of Image and CommandLine filters aligns with known adversary behavior for T1082. However, relying solely on reg.exe may miss other tools like PowerShell or WMI.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Accurate selection of registry paths tied to system info discovery",
              "Uses standard Sigma field names (Image, CommandLine)"
            ],
            "weaknesses": [
              "Exclusively targets reg.exe, missing alternative tools",
              "No parent process or user context to strengthen validity"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately specific by targeting exact registry paths, but lacks filters to exclude administrative or monitoring tools listed in false positives. It could trigger on routine system checks without additional context like parent process or command-line arguments.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Uses precise registry path matches to reduce noise",
              "Acknowledges common false positives in documentation"
            ],
            "weaknesses": [
              "No exclusion logic for known benign tools",
              "Lacks multi-condition filtering (e.g., parent process, user context)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects basic reg.exe usage for system info queries but is vulnerable to evasion via tool replacement (PowerShell, wmic) or command obfuscation. Case-insensitive matching is implied but not enforced, and no alternative vectors are covered.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Covers multiple registry keys relevant to system discovery",
              "CommandLine contains list allows for multiple indicators"
            ],
            "weaknesses": [
              "Does not account for obfuscated commands or encoded payloads",
              "Ignores non-reg.exe methods for same TTP"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1082) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The technique name is slightly misaligned with MITRE (T1082 is 'System Information Discovery', not 'Data from Local System').",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique ID (T1082) and discovery tag",
              "Clear rule title and description of detection logic"
            ],
            "weaknesses": [
              "Missing MITRE reference URL or external citations",
              "No attribution to known threat actors or tools using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith on Image, contains on CommandLine) and leverages indexed fields like Image and CommandLine. The logsource is specific to Sysmon process creation, improving performance. However, 'contains' on long command lines could be slightly optimized with more precise patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Specific logsource (Sysmon process_creation) reduces noise"
            ],
            "weaknesses": [
              "Relies on 'contains' which may be broader than 'matches' with regex for registry paths",
              "No ordering of conditions by specificity in detection logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects reg.exe querying two key system information registry paths, which is a valid method, but fails to cover other common tools (e.g., wmic, powershell, certutil) or native API calls. It also does not account for alternative registry keys used in system enumeration or tool-specific behaviors (e.g., Cobalt Strike's getuid + info commands).",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Covers core registry keys for version and timezone info",
              "Targets a legitimate attack vector (reg.exe for discovery)"
            ],
            "weaknesses": [
              "Narrow tool focus (only reg.exe, not PowerShell or WMI)",
              "Misses broader system information discovery methods and sub-techniques"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process exclusions, parent-child context, or frequency-based thresholds, making it prone to false positives from admin tools and monitoring software. While false positives are documented in metadata, no detection-time filters are implemented to suppress them.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive sources in metadata",
              "Focus on specific registry paths reduces some noise"
            ],
            "weaknesses": [
              "No whitelisting of known legitimate tools or paths",
              "Single-event trigger without behavioral context or thresholds"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world T1082 (System Information Discovery) by targeting registry queries to well-known system information keys. However, it lacks specificity to advanced threat actor behaviors, such as use of alternative tools (e.g., wmic, powershell) or correlation with follow-on actions in attack chains.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Targets legitimate registry paths used for system enumeration",
              "Aligned with MITRE ATT&CK technique T1082"
            ],
            "weaknesses": [
              "No linkage to specific APT groups or campaigns",
              "Ignores alternative LOLBin usage beyond reg.exe"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses valid Sigma syntax, realistic Sysmon logsource, and has been verified in a Splunk environment with 278 events detected. The 'high' severity is justified, though false positives from admin tools may require tuning in some environments.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Validated detection with real log data (278 events found)",
              "Uses standard Sysmon process creation logging"
            ],
            "weaknesses": [
              "Potential for false positives from monitoring tools",
              "Relies solely on command-line content which can vary"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly communicate the detection intent, and the fields (Image, CommandLine) allow for effective pivoting. False positive guidance helps analysts triage, and the MITRE tags support response planning.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and detection logic",
              "Useful false positive guidance included"
            ],
            "weaknesses": [
              "Lacks additional context like user or host fields in detection",
              "No direct remediation or investigation steps referenced"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to basic evasion such as using PowerShell or wmic instead of reg.exe, or obfuscating command lines. It relies heavily on command-line arguments, which attackers can easily modify or hide.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Detects specific high-value registry paths",
              "Focuses on behavior (registry query via command line)"
            ],
            "weaknesses": [
              "Easily bypassed using alternative tools (e.g., PowerShell Get-Item)",
              "No defense against command-line obfuscation or LOLBin misuse"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of reg.exe querying specific system information keys, which aligns with early-stage discovery activity. However, it lacks logic to detect follow-on behaviors such as data aggregation, exfiltration, or lateral movement using the same method. It is a single-event detection without correlation across stages.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:27:45.955077",
          "metadata": {
            "strengths": [
              "Detects initial use of reg.exe for sensitive registry queries",
              "Targets known high-value registry paths used in system enumeration"
            ],
            "weaknesses": [
              "No correlation with later attack stages like data staging or exfiltration",
              "Limited to one tool (reg.exe), missing other vectors like PowerShell or WMI"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (System Information Discovery via Registry Queries) scored 0.59/1.0 (Poor). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:27:45.955077",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "System Information Discovery via Registry Queries",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6116666666666667,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.6352941176470589,
        "effectiveness": 0.52,
        "realism": 0.7555555555555555,
        "detectability": 0.41111111111111115
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mappings. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', reducing its completeness for production use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Includes essential fields: title, id, description, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with clear conditions"
            ],
            "weaknesses": [
              "Missing required Sigma fields: author, date, status, references",
              "Incomplete MITRE tag list (truncated in input)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The logic correctly identifies 'net user' execution via cmd.exe or powershell.exe, aligning with T1059.x for credential discovery via command-line interpreters. The use of Image and CommandLine fields with appropriate conditions ensures accurate detection of the intended behavior.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Accurate selection criteria targeting known adversary command patterns",
              "Sound condition logic using OR between two distinct execution paths"
            ],
            "weaknesses": [
              "Relies solely on 'CommandLine|contains' which may miss obfuscated variants",
              "Does not validate parent process or execution context to strengthen legitimacy"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately specific but risks false positives due to broad 'contains' matching on 'net user' without additional context like parent process, user context, or command structure. Legitimate administrative use is acknowledged but not filtered out by logic.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Separates cmd and PowerShell paths for clearer detection",
              "Acknowledges common false positives in documentation"
            ],
            "weaknesses": [
              "No exclusion of system processes or trusted parent processes (e.g., explorer.exe, scheduled tasks)",
              "Lacks constraints on command arguments or usage patterns to distinguish malicious vs. benign"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects basic 'net user' usage but lacks resilience against evasion techniques like command obfuscation, alternative binaries (e.g., wmic, dsquery), or encoded PowerShell. Case-insensitive matching is implied but not enforced, and no regex or wildcard variation handling is present.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Covers both cmd and PowerShell, increasing coverage across interpreters",
              "Detects a common and widely used credential enumeration technique"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation (e.g., 'net user', base64-encoded commands)",
              "Does not account for alternative tools that invoke NetUserGetInfo (e.g., wmic useraccount)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1059, T1059.001, T1059.003) and a clear description linking 'net user' to credential discovery via NetUserGetInfo. However, it lacks references to authoritative sources like MITRE pages, known threat actors, malware families, or campaign names that would enhance investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Correct and specific MITRE ATT&CK tagging",
              "Clear description linking command to API and tactic"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to threat actors or malware using this technique"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields (Image, CommandLine) with efficient 'endswith' and 'contains' operators, avoids leading wildcards, and structures conditions logically. The logsource is specific to Sysmon process creation, ensuring fast execution in production SIEM environments.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Uses high-performance field operators correctly",
              "Logsource is specific and indexed"
            ],
            "weaknesses": [
              "CommandLine|contains 'net user' could match benign variations",
              "Could benefit from case-insensitive flag annotation for robustness"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic 'net user' usage via cmd and PowerShell but misses advanced variants like WMI, WinRM, or .NET API calls that also invoke NetUserGetInfo. It does not cover lateral movement tools (e.g., PsExec, WMI) or obfuscated PowerShell, limiting detection breadth for sophisticated adversaries.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:28:22.473256",
          "metadata": {
            "strengths": [
              "Covers two primary command-line interpreters (cmd, PowerShell)",
              "Correctly associates net user with credential discovery"
            ],
            "weaknesses": [
              "Ignores alternative execution vectors (WMI, WinRM, etc.)",
              "No detection of API-based enumeration or tool abuse (e.g., Cobalt Strike's 'getuid')"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks behavioral context such as parent process, user context, or frequency thresholds, making it prone to false positives from admin scripts and inventory tools. While false positives are documented, no exclusion logic (e.g., exclude SYSTEM, exclude known admin tools) is implemented in the detection.",
          "confidence": 0.92,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "False positives are acknowledged in metadata",
              "Focus on process creation allows for enrichment"
            ],
            "weaknesses": [
              "No exclusion of system accounts or trusted parents (e.g., explorer.exe)",
              "No thresholding or anomaly-based logic to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs where adversaries use 'net user' via cmd or PowerShell for local account enumeration, mapping correctly to T1059 and sub-techniques. It reflects common post-compromise behavior in execution and discovery phases, though it lacks specificity to advanced actor groups or campaigns.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "Maps accurately to MITRE ATT&CK techniques T1059, T1059.001, and T1059.003",
              "Reflects common living-off-the-land behavior observed in real attacks"
            ],
            "weaknesses": [
              "No linkage to specific APT groups or campaigns using this method",
              "Does not account for variations in command syntax or targeted execution context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The Sigma rule is syntactically valid, uses standard Sysmon process creation events, and has been verified with detected events, indicating real-world viability. The medium severity and documented false positives support SOC triage, though some tuning may be needed in large environments.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "Validated detection with actual events found (4 hits)",
              "Uses common and widely deployed logsource (Sysmon process creation)"
            ],
            "weaknesses": [
              "False positives from admin scripts may require suppression logic",
              "Lacks exclusion of known-good system tools that invoke 'net user'"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly convey the detection intent, and the CommandLine and Image fields allow for basic pivoting. However, it lacks enrichment such as user context, parent process, or host scope, which limits investigative depth.",
          "confidence": 0.93,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "Clear title and description aiding analyst understanding",
              "False positive guidance helps reduce investigation time"
            ],
            "weaknesses": [
              "Missing key fields like User, ParentProcess, or Host for pivoting",
              "No references to MITRE or internal runbooks for response"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line string matching, making it vulnerable to obfuscation (e.g., 'net u*s*r', PowerShell aliases, or encoded commands). It does not detect alternative execution methods like WMI or remote PS sessions, reducing resilience against evasion.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "Covers both cmd and PowerShell, increasing coverage",
              "Detects use of native binaries, relevant for LOLBin scenarios"
            ],
            "weaknesses": [
              "Easily bypassed via command obfuscation or alternative execution",
              "No behavioral correlation (e.g., network connection post-enumeration)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only the initial execution phase of the TTP\u2014specifically command-line invocation of 'net user' via cmd.exe or PowerShell\u2014and does not extend to later stages such as persistence, lateral movement, or data exfiltration. It lacks logic to correlate this activity with follow-on actions like credential dumping, access to sensitive shares, or execution on multiple systems.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:22.474315",
          "metadata": {
            "strengths": [
              "Clearly identifies initial use of command-line tools for user enumeration",
              "Covers both cmd and PowerShell execution vectors"
            ],
            "weaknesses": [
              "Single-event detection with no correlation across attack stages",
              "No integration with downstream behaviors like lateral movement or privilege escalation"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1059 (Detect NetUserGetInfo Enumeration via Command Shell or PowerShell) scored 0.61/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.41). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:28:22.474315",
      "metadata": {
        "attack_id": "attack.t1059",
        "technique_name": "Detect NetUserGetInfo Enumeration via Command Shell or PowerShell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.625,
      "category_scores": {
        "correctness": 0.74,
        "quality": 0.6352941176470589,
        "effectiveness": 0.5666666666666667,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes most required Sigma fields with meaningful content, such as title, id, description, logsource, detection, falsepositives, level, and tags including MITRE ATT&CK. Missing fields include 'author', 'date', and 'status', which are required in production-grade Sigma rules.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Includes essential fields like MITRE tags, logsource, and detection logic",
              "Properly structured with unique ID and descriptive metadata"
            ],
            "weaknesses": [
              "Missing required fields: author, date, status",
              "No references field despite available MITRE link"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic correctly identifies known tools querying whatismyip.com, aligning with T1567.001. However, it relies solely on command-line content and image paths without validating context like parent process or network connection, increasing false positive risk.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Accurate mapping to TTP using relevant tools (nslookup, PowerShell, curl)",
              "Clear condition logic using '1 of selection_*' for multi-tool coverage"
            ],
            "weaknesses": [
              "No exclusion of common administrative or script-based legitimate use cases in logic",
              "Relies on exact domain string; vulnerable to evasion via IP or domain variants"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately specific but lacks filters to reduce false positives from admin tools or scripts. It uses exact domain matching but doesn't exclude known benign parent processes (e.g., taskhost.exe for scheduled tasks) or trusted users.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Uses specific Image and CommandLine conditions to narrow scope",
              "Targets a narrow set of tools commonly abused for discovery"
            ],
            "weaknesses": [
              "No parent process or user context filtering",
              "Fails to distinguish between interactive and automated/scripted execution"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers multiple tools (nslookup, PowerShell, curl, bitsadmin), increasing sensitivity to common attack vectors. However, it lacks case-insensitive matching, regex for obfuscation, or support for domain/IP alternatives (e.g., ipinfo.io, 1.1.1.1/cdn-cgi/trace).",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Covers multiple command-line utilities used in post-compromise discovery",
              "Detects across different toolsets achieving same objective"
            ],
            "weaknesses": [
              "No support for encoded/obfuscated commands (e.g., base64 PowerShell)",
              "Limited to one domain; adversaries may use alternatives"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1567.001) and a clear description, but lacks references to authoritative sources like MITRE pages or threat reports. No threat actor, campaign, or malware family information is provided, limiting investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Correct and specific MITRE ATT&CK sub-technique tagging (T1567.001)",
              "Clear rule title and description explaining detection logic"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to known threat actors or malware using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) on indexed Sysmon fields. It avoids leading wildcards and uses specific image paths. The condition '1 of selection_*' is performant and structured logically.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains could be broad; case sensitivity not addressed",
              "Could prioritize more specific conditions first for faster evaluation"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects common tools (nslookup, PowerShell, curl, bitsadmin) querying whatismyip.com, but misses other public IP services (e.g., ipinfo.io, ifconfig.me) and modern tools like wget, Invoke-WebRequest, or .NET HTTP clients in PowerShell. Coverage of advanced or obfuscated variants is limited.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Covers multiple common command-line tools for IP discovery",
              "Detects both DNS and HTTP-based queries via different utilities"
            ],
            "weaknesses": [
              "Overly specific to one domain (whatismyip.com), easily bypassed",
              "Misses other common public IP services and scripting methods"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule acknowledges common false positives in metadata but lacks technical mitigations like parent process restrictions, frequency thresholds, or user context filtering. A single execution triggers the alert, increasing noise in environments with legitimate admin use.",
          "confidence": 0.92,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Clear false positive documentation for network admins and scripts",
              "Lists realistic operational scenarios causing FP"
            ],
            "weaknesses": [
              "No behavioral thresholds (e.g., multiple queries, unusual timing)",
              "Lacks parent-child process constraints (e.g., PowerShell spawned from Office)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs where adversaries query public IP services to determine external IP addresses during reconnaissance. However, it lacks specificity to known APT groups or campaigns and relies on a single domain (whatismyip.com), which may not reflect attacker tooling diversity or domain rotation. Detection logic is behaviorally sound but lacks contextual depth from observed adversary tradecraft.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Matches known behavior in T1567.001: querying public IP via common utilities",
              "Covers multiple LOLBins commonly abused in real attacks"
            ],
            "weaknesses": [
              "No reference to specific threat actors or campaigns using this technique",
              "Over-reliance on a single domain limits generalizability"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid and leverages Sysmon process creation logs, which are standard in mature Windows environments. The detection has been verified in a SIEM (Splunk) with 18 events found, indicating real-world signal. However, false positives from admin scripts and scheduled tasks may generate alert fatigue without proper tuning.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection events",
              "Uses standard logsource (Sysmon process creation) widely deployed"
            ],
            "weaknesses": [
              "Medium severity may not reflect urgency of discovery-phase activity",
              "FP list is acknowledged but not mitigated in logic (e.g., excluding known scripts)"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly convey the detected behavior, enabling rapid triage. Command-line and image fields allow analysts to pivot on process, user, and host context. False positive guidance helps analysts quickly assess legitimacy, and MITRE tagging supports response playbooks.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Clear title and description aid analyst understanding",
              "FP guidance and MITRE tags support investigation workflows"
            ],
            "weaknesses": [
              "Lacks inclusion of additional telemetry (e.g., network connection, parent process)",
              "No suggested follow-up queries or enrichment steps provided"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to simple evasion such as domain variation (e.g., icanhazip.com), IP resolution, or obfuscation in PowerShell. It relies heavily on command-line content, which attackers can encode or split. While it covers multiple tools, it does not detect behavioral patterns or indirect execution methods like DLL sideloading or script interpreters.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Covers multiple execution vectors (nslookup, curl, PowerShell, bitsadmin)",
              "Detects direct command-line usage of known utilities"
            ],
            "weaknesses": [
              "Easily bypassed by domain/IP substitution or encoding",
              "No detection logic for obfuscated or indirect execution"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of tools querying whatismyip.com, which aligns with early-stage discovery activity, but does not extend to persistence, lateral movement, or follow-on actions. It is a single-event detection with no correlation logic across stages or processes.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:28:59.676413",
          "metadata": {
            "strengths": [
              "Detects initial use of common utilities for public IP discovery",
              "Covers multiple tool types (DNS, PowerShell, curl, bitsadmin)"
            ],
            "weaknesses": [
              "No capability to detect persistence or lateral movement using this TTP",
              "Lacks multi-event correlation or session-based analysis"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1567.001 (Remote System Discovery via Public IP Service Query) scored 0.62/1.0 (Below Average). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-28T14:28:59.676413",
      "metadata": {
        "attack_id": "attack.t1567.001",
        "technique_name": "Remote System Discovery via Public IP Service Query",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.53,
      "category_scores": {
        "correctness": 0.58,
        "quality": 0.5647058823529413,
        "effectiveness": 0.4666666666666667,
        "realism": 0.6444444444444444,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, id, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with meaningful content"
            ],
            "weaknesses": [
              "Missing mandatory Sigma fields: author, date, status, references",
              "No indication of rule maturity or ownership"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection logic targets known registry manipulation tools writing to the CTF\\SVIF key, aligning with T1567.001. However, the technique name 'New Service' is incorrect\u2014T1567.001 is 'Drive-by Compromise: Exploit Public-Facing Application', not service creation. The logic conflates registry writes with service persistence without validating actual service creation behavior.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Matches legitimate Sysmon registry event sources",
              "Uses correct field names (Image, CommandLine, TargetObject)"
            ],
            "weaknesses": [
              "Incorrect mapping between detection logic and MITRE technique name",
              "Generic_write condition lacks process context, increasing false positives"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is overly broad due to the generic_write condition that triggers on any process writing to the key, including legitimate Text Input Framework activity. It lacks filters for parent processes, user context, or command-line patterns that distinguish malicious from benign use, increasing false positives in production.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Specific targeting of HKCU\\SOFTWARE\\Microsoft\\CTF\\SVIF path",
              "Separate conditions for common tool use (reg.exe, PowerShell)"
            ],
            "weaknesses": [
              "No exclusion of trusted parent processes (e.g., explorer.exe, winlogon.exe)",
              "Generic write condition lacks process or user context"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers multiple tools (reg, PowerShell, cmd) and includes a generic catch-all, providing moderate sensitivity. However, it lacks case-insensitive matching, regex for obfuscated commands, or detection of alternative registry access methods (e.g., WMI, .NET), limiting its ability to catch evasions.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Covers multiple common execution vectors (cmd, PowerShell, reg)",
              "Generic fallback condition increases coverage"
            ],
            "weaknesses": [
              "No case-insensitive or regex-based pattern matching",
              "Does not account for encoded or obfuscated command lines"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but lacks references to authoritative sources, threat actors, or malware families. The technique name is misaligned with T1567.001 (which is 'Exfiltration to Cloud Account'), making the tagging inaccurate.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tags and clear rule title",
              "Provides descriptive false positive guidance"
            ],
            "weaknesses": [
              "Incorrect MITRE ATT&CK technique mapping (T1567.001 is exfiltration, not persistence)",
              "No references to research, threat actors, or malware using this method"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters like 'endswith' on Image and 'contains' on CommandLine/TargetObject, all on indexed fields. Detection logic is flat and avoids complex regex, though 'contains' on long strings like full registry paths could be slightly optimized.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, CommandLine, TargetObject)",
              "Avoids leading wildcards and complex regex"
            ],
            "weaknesses": [
              "Uses 'contains' on full registry path which may match unintended substrings",
              "Could prioritize more specific conditions first in the OR chain"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic registry writes via cmd, PowerShell, and reg.exe, but misses advanced tools like WMI, .NET, or custom binaries. It also fails to cover lateral movement tools or post-exploitation frameworks like Cobalt Strike that may write to this key indirectly.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Covers common command-line utilities (cmd, PowerShell, reg.exe)",
              "Includes generic write detection as fallback"
            ],
            "weaknesses": [
              "No detection for WMI, PsExec, or .NET-based registry modifications",
              "Ignores indirect writes via API calls or remote registry edits"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule acknowledges legitimate use by text input frameworks and admin scripts but lacks technical filters to suppress these. No parent-child context, user context, or frequency-based logic is applied to reduce noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Documents known false positive sources in metadata",
              "Generic detection is balanced with specific process-based conditions"
            ],
            "weaknesses": [
              "No exclusion of system processes or trusted parents (e.g., explorer.exe)",
              "Lacks thresholding or behavioral context to distinguish malicious from benign"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule targets a lesser-known persistence location tied to the CTF (Collaborative Translation Framework) component in Windows, which has been abused by adversaries for stealthy persistence. However, it lacks specific references to known threat actors, campaigns, or detailed TTPs beyond generic registry writes, reducing its contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Focuses on HKCU\\SOFTWARE\\Microsoft\\CTF\\SVIF, a legitimate but rarely used key that can be abused for stealth",
              "Aligns with execution/persistence behavior observed in some living-off-the-land techniques"
            ],
            "weaknesses": [
              "No linkage to specific APT groups or real-world attack chains using this key",
              "Detection logic is generic and not tied to known malicious command-line patterns or payloads"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The Sigma rule syntax appears valid and leverages Sysmon registry events, which are common in mature environments. However, the high potential for false positives from legitimate text input framework activity and lack of process command-line normalization may lead to alert fatigue.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon registry event logging, widely deployed in enterprise settings",
              "Includes multiple detection paths for common tools (reg.exe, PowerShell, cmd.exe)"
            ],
            "weaknesses": [
              "Generic write condition on TargetObject alone may trigger on benign system or user activity",
              "False positive guidance is acknowledged but not mitigated in logic (e.g., no exclusions for known good processes)"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly state what is being detected, and the inclusion of Image and CommandLine fields enables basic investigation pivoting. False positive examples help analysts triage, though more context on expected malicious patterns would improve response clarity.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Clear title and description that communicate detection intent effectively",
              "Includes useful process and command-line fields for initial triage"
            ],
            "weaknesses": [
              "Lacks enrichment fields like user context or parent process for deeper investigation",
              "No references to MITRE ATT&CK or remediation steps in description"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on command-line arguments and specific tool names (reg.exe, powershell.exe), which attackers can easily evade via obfuscation, alternative tools, or direct API calls. The generic write condition adds some resilience, but overall the detection is fragile against common LOLBin and evasion tactics.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Includes a generic registry write condition that could catch non-standard tool usage",
              "Covers multiple common execution vectors (cmd, PowerShell, reg.exe)"
            ],
            "weaknesses": [
              "Highly dependent on command-line content, which can be obfuscated or suppressed",
              "No detection logic for indirect writes (e.g., via rundll32, wmic, or .NET)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects registry writes to a specific key associated with persistence via the CTF SVIF mechanism, which aligns with initial access and persistence stages. However, it lacks logic to correlate across multiple stages such as execution, lateral movement, or exfiltration, and primarily functions as a single-event detection. While it covers persistence through registry modification, it does not extend visibility into\u540e\u7eed malicious behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:29:34.776334",
          "metadata": {
            "strengths": [
              "Detects known registry manipulation tools (reg.exe, PowerShell, cmd.exe) writing to a suspicious key.",
              "Includes generic write detection for non-standard tool use."
            ],
            "weaknesses": [
              "Limited to single-event detection without correlation across attack lifecycle phases.",
              "No integration with follow-on behaviors like service creation or C2 communication."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1567.001 (Detect Registry Write to CTF SVIF Key for New Service Persistence) scored 0.53/1.0 (Poor). Best performance in realism (0.64). Needs improvement in detectability (0.40). Issues found in: detection_logic_correctness, detection_specificity, attack_coverage",
      "timestamp": "2025-12-28T14:29:34.776839",
      "metadata": {
        "attack_id": "attack.t1567.001",
        "technique_name": "Detect Registry Write to CTF SVIF Key for New Service Persistence",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5666666666666665,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.5411764705882353,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, id, description, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with meaningful content"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete tags list (missing attack.execution from MITRE mapping)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly identifies suspicious HTTP GET requests via PowerShell or cmd.exe with a specific C2 pattern. The use of CommandLine|contains matches known adversary behavior, and the condition is simple and effective. However, it assumes the exact string 'GET /index.php?CDD;' appears in the command line, which may not reflect actual tool usage (e.g., Invoke-WebRequest doesn't emit 'GET' in CLI).",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Targets relevant processes (powershell.exe, cmd.exe) used in remote service execution",
              "Focuses on a specific C2 pattern indicative of malicious activity"
            ],
            "weaknesses": [
              "Relies on 'GET' appearing in command line, which is not how PowerShell HTTP clients typically work",
              "May miss attacks using other tools (e.g., certutil, bitsadmin) or obfuscated commands"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses a specific string match which helps reduce false positives, but lacks contextual filters like parent process, user context, or network connection correlation. It could trigger on legitimate scripts using similar URL patterns or encoded commands containing the substring.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Specific C2 URL pattern match reduces generic noise",
              "Separate selections for PowerShell and cmd provide clarity"
            ],
            "weaknesses": [
              "No exclusion of common administrative tools or scheduled tasks",
              "Lacks additional context (e.g., ParentImage, User) to improve precision"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is highly sensitive to the exact string 'GET /index.php?CDD;', but fails to account for common evasion techniques like URL encoding, case variation, or alternative tools. It does not use regex or case-insensitive matching, making it easy to bypass with minor obfuscation.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Targets two common execution vectors: PowerShell and cmd",
              "Matches a known malicious pattern associated with backdoors"
            ],
            "weaknesses": [
              "No case-insensitive matching or regex support for variations",
              "Does not cover encoded commands or alternative C2 paths"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tagging (T1021) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description explains the detection logic but misses contextual depth for investigation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1021) included",
              "Clear rule title and description of detection intent"
            ],
            "weaknesses": [
              "No references to MITRE page or threat research",
              "Missing threat actor, malware, or campaign context"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) with indexed fields and avoids leading wildcards. The condition structure is simple and leverages fast string operations, though 'contains' on long command lines could be slightly optimized.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains may match non-GET contexts in long commands",
              "Could prioritize more specific patterns before broad contains"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic C2 HTTP GET patterns via PowerShell and CMD but narrowly focuses on a single URL pattern (/index.php?CDD;), missing broader tooling (e.g., curl, certutil) and alternate C2 frameworks. It does not cover encoded commands, obfuscation, or multi-stage behaviors.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Covers two common execution vectors (PowerShell, CMD)",
              "Targets a known C2-like HTTP pattern"
            ],
            "weaknesses": [
              "Overly specific to one URL pattern, easily evaded",
              "Excludes other tools (curl, bitsadmin, certutil) and techniques"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists general false positives (legitimate downloads, scripts) but lacks built-in filters to suppress them. No parent process context, frequency thresholds, or path/user whitelisting is applied, increasing alert noise in production.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive scenarios in metadata",
              "Focus on C2-like URL pattern reduces generic noise"
            ],
            "weaknesses": [
              "No parent-child process constraints (e.g., w32time spawning cmd)",
              "Lacks frequency or behavioral thresholds to reduce FP"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule targets a specific C2 pattern (GET /index.php?CDD;) which suggests some campaign-specific knowledge, and aligns with T1021 (Remote Services) for lateral movement. However, it lacks references to known threat actors, malware families, or real-world campaigns that use this pattern, reducing its contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Specific C2 URL pattern indicates real observed behavior",
              "Aligned with MITRE T1021 for lateral movement via remote services"
            ],
            "weaknesses": [
              "No attribution to APT groups or malware (e.g., PoweStats, BitterRAT)",
              "Lacks integration with broader attack chain context (e.g., initial access vector)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation events, and has been verified in a SIEM (Splunk) with detection success. The false positive list is reasonable, but the detection relies solely on command-line content which may vary in logging completeness across environments.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Validated in SIEM with real event matches (188 events)",
              "Uses common log source (Sysmon process creation) widely deployed"
            ],
            "weaknesses": [
              "Relies on CommandLine logging, which may be truncated or disabled",
              "No normalization for case sensitivity or spacing variations in HTTP GET"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly state what is detected\u2014PowerShell/CMD issuing a suspicious HTTP GET. Analysts can pivot on Image, CommandLine, and potentially source IP (if enriched). False positive guidance helps triage, though network-level details are missing from the detection itself.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Clear title and description enable quick understanding",
              "False positive scenarios documented for analyst filtering"
            ],
            "weaknesses": [
              "Does not extract or highlight C2 server IP/domain for immediate blocking",
              "Lacks suggested follow-up queries (e.g., parent process, network connections)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is vulnerable to simple obfuscation such as changing spacing, case, or encoding in the command line (e.g., 'get /index.php?cdd;' or base64-encoded strings). It also ignores alternative LOLBins like certutil or mshta that could deliver similar C2 traffic, reducing detection coverage.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Detects at process creation level, which is harder to fully hide",
              "Focuses on behavioral pattern (HTTP GET via shell tools)"
            ],
            "weaknesses": [
              "Easily bypassed by case variation, encoding, or alternate tools",
              "No defense-in-depth via related telemetry (e.g., network logs, child processes)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects a single-stage activity\u2014initial command and control via HTTP GET in PowerShell or CMD\u2014and does not correlate across multiple attack phases. It lacks logic to identify persistence, lateral movement, or exfiltration stages tied to Remote Services. While it identifies a suspicious C2 pattern, it is limited to process creation events without multi-event correlation.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:10.019454",
          "metadata": {
            "strengths": [
              "Clearly targets initial C2 communication indicative of execution stage",
              "Covers two common execution vectors (PowerShell and cmd.exe)"
            ],
            "weaknesses": [
              "No capability to detect follow-on stages like lateral movement or data exfiltration",
              "Relies solely on single-event pattern matching without behavioral chaining"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1021 (Detect Remote Service C2 HTTP GET Pattern via PowerShell or CMD) scored 0.57/1.0 (Poor). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, detection_sensitivity, attack_coverage",
      "timestamp": "2025-12-28T14:30:10.019454",
      "metadata": {
        "attack_id": "attack.t1021",
        "technique_name": "Detect Remote Service C2 HTTP GET Pattern via PowerShell or CMD",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5483333333333333,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.5411764705882353,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7444444444444445,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, and status, which are essential for production rule management and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Includes core structural elements: title, id, description, detection logic, and MITRE tags.",
              "Properly maps to MITRE ATT&CK technique T1567.001 in tags."
            ],
            "weaknesses": [
              "Missing author, date, and status fields required for Sigma rule completeness.",
              "References field is absent despite having external context available."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic correctly identifies process creation of powershell.exe or cmd.exe with a command line containing the suspicious IP prefix. However, it relies solely on a plaintext IP string match, which may miss obfuscated or encoded variants commonly used in real attacks. Field names are standard Sigma syntax and appropriate for Sysmon data.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Accurate use of standard Sigma field names (Image, CommandLine).",
              "Condition logic (OR between two processes) is simple and sound."
            ],
            "weaknesses": [
              "Relies on unencoded plaintext IP, easily bypassed via encoding or domain usage.",
              "Does not validate whether the IP is used in network context (e.g., curl, wget, Invoke-WebRequest)."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately specific due to the exact IP prefix match, but lacks contextual filters like parent process, user context, or command-line arguments that could reduce false positives. It may trigger on legitimate scripts using the same IP range if not properly scoped to known malicious activity.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Exact IP prefix match increases precision over generic command-line patterns.",
              "Separate conditions for PowerShell and cmd allow for future differentiation."
            ],
            "weaknesses": [
              "No exclusion of system or admin processes that might legitimately use such IPs.",
              "Lacks additional context (e.g., network-related child processes, command patterns)."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is not sufficiently sensitive to evasion techniques; attackers commonly obfuscate IPs using hex, base64, or string splitting. It does not account for case variations or alternative command-line tools (e.g., wmic, certutil) that could deliver similar payloads. No regex or wildcard coverage for encoded forms of '103.159.132.'.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Covers both cmd.exe and powershell.exe, common execution vectors.",
              "Detects direct use of the known malicious IP in command lines."
            ],
            "weaknesses": [
              "No support for obfuscated or encoded IP addresses (e.g., 0x679F84XX, base64).",
              "Case-sensitive matching may miss variations; no regex or wildcards used."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description explains the detection logic but misses contextual enrichment that would aid investigation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging (T1567.001, resource-development)",
              "Clear rule title and description explaining detection intent"
            ],
            "weaknesses": [
              "Missing MITRE reference URL or external sources",
              "No attribution to known threat actors, malware, or campaigns using this IP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) on indexed fields with no leading wildcards. Detection logic is simple and ordered well, though 'contains' on IP prefix could be slightly improved with regex for word boundaries to avoid partial matches.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) with efficient operators",
              "No leading wildcards or complex regex, ensuring fast execution"
            ],
            "weaknesses": [
              "'CommandLine|contains' may match substrings within larger IPs (e.g., 192.168.103.159.132)",
              "Could use 'matches' with regex for precise IP prefix matching"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic command-line execution with a known C2 IP prefix but fails to cover broader execution techniques (e.g., encoded commands, obfuscated payloads, WMI, scheduled tasks). It narrowly focuses on direct cmdline use and does not account for advanced evasion or alternative delivery vectors.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Covers core execution via cmd.exe and powershell.exe",
              "Targets known malicious infrastructure pattern"
            ],
            "weaknesses": [
              "No coverage of encodedcommand, -enc, or base64 payloads in PowerShell",
              "Ignores indirect execution methods (e.g., WMI, rundll32, mshta)"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists plausible false positives but lacks active filtering (e.g., excluding system paths, admin users, or parent processes). It triggers on any cmdline containing the IP, increasing noise from legitimate tools or internal systems using the same prefix.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate use cases in falsepositives list",
              "Focuses on specific IP prefix, reducing broad alerting"
            ],
            "weaknesses": [
              "No exclusion logic for trusted parent processes (e.g., explorer.exe vs svchost.exe)",
              "No path or user-based whitelisting to suppress known-good activity"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with T1567.001 by detecting command-line use of known C2 IP prefixes, which reflects real-world infrastructure acquisition patterns. However, it lacks specific campaign or APT group context, and the detection logic is generic, relying solely on an IP prefix without behavioral context.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Maps to MITRE ATT&CK T1567.001 with relevant use of IP indicator",
              "Focuses on process creation with command-line artifacts common in C2 setup"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Lacks behavioral depth beyond static IP matching"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation fields, and targets common Windows executables, making it deployable in most environments. The 'medium' severity and documented false positives support SOC triage, though the IP prefix match may generate noise in networks with legitimate external use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Valid logsource with widespread Sysmon support",
              "Includes realistic false positive scenarios and verification data"
            ],
            "weaknesses": [
              "Risk of false positives if 103.159.132.0/24 is used by legitimate services",
              "No thresholding or frequency-based logic to reduce alert volume"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly state what is detected, and the use of Image and CommandLine fields enables immediate pivoting in investigations. False positive guidance helps analysts triage, and the MITRE tags support response planning.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable detection fields",
              "False positives well-documented for analyst filtering"
            ],
            "weaknesses": [
              "Lacks enrichment fields like user, parent process, or IP geolocation",
              "No direct remediation or investigation playbook references"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is highly evadable via IP obfuscation (e.g., hex, base64), domain usage instead of IP, or use of proxies. It relies solely on clear-text command-line matching, making it vulnerable to common LOLBin and obfuscation techniques.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Detects two common execution vectors (cmd and PowerShell)",
              "Uses process creation events, which are harder to fully suppress"
            ],
            "weaknesses": [
              "Easily bypassed by encoding or DNS tunneling",
              "No behavioral correlation (e.g., network connection post-execution)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only the initial execution stage involving PowerShell or cmd.exe with a specific C2 IP prefix, but does not account for persistence, lateral movement, or exfiltration stages. It is a single-event detection with no correlation logic across multiple attack phases.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:30:46.171629",
          "metadata": {
            "strengths": [
              "Detects initial execution attempts using common command-line tools.",
              "Focuses on a known malicious indicator tied to a specific threat pattern."
            ],
            "weaknesses": [
              "Limited to initial access; no coverage of later attack stages.",
              "No event correlation or multi-stage logic implemented."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1567.001 (Detect PowerShell or Cmd Execution with Known C2 IP Prefix) scored 0.55/1.0 (Poor). Best performance in realism (0.74). Needs improvement in detectability (0.36). Issues found in: detection_specificity, detection_sensitivity, attack_coverage",
      "timestamp": "2025-12-28T14:30:46.171629",
      "metadata": {
        "attack_id": "attack.t1567.001",
        "technique_name": "Detect PowerShell or Cmd Execution with Known C2 IP Prefix",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5683333333333334,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6588235294117648,
        "effectiveness": 0.49333333333333335,
        "realism": 0.6111111111111112,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces operational utility"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures known exfiltration-enabling utilities (powershell, certutil, bitsadmin) and flags related to encoding/compression, aligning with T1567.001. However, the CommandLine keywords like 'compress', 'encrypt', 'encode' are overly generic and may match benign scripts, reducing precision. Also, no parent-child process context or network activity correlation weakens TTP fidelity.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Targets correct tools commonly abused for exfiltration",
              "Uses relevant command-line indicators"
            ],
            "weaknesses": [
              "Generic keywords increase false positives",
              "Lacks behavioral context (e.g., network connection post-execution)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is too broad due to unbounded CommandLine contains checks without anchoring to suspicious patterns or excluding administrative contexts. It lacks filters like user privilege level, parent process (e.g., w32time spawning powershell), or command structure, leading to high false positives from legitimate admin use or obfuscated but benign scripts.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Narrows to high-risk binaries",
              "Combines multiple suspicious indicators"
            ],
            "weaknesses": [
              "No exclusion logic for trusted processes/users",
              "Over-reliance on substring matches in command lines"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple tools (powershell, certutil, bitsadmin) and various command-line artifacts including encoded commands and encryption flags. It uses substring matching effectively to catch obfuscated variants and different syntax (e.g., -enc vs -EncodedCommand), making simple evasion harder without full tool replacement.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Covers multiple exfiltration-capable tools",
              "Includes case variation and common encoding flags"
            ],
            "weaknesses": [
              "Does not use regex for more robust pattern matching",
              "Misses alternative tools like ftp, curl, or netsh"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1567.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description is functional but could better explain the behavioral context of the detection.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique and sub-technique tags included",
              "Clear rule title and functional description provided"
            ],
            "weaknesses": [
              "Missing references to MITRE or security research",
              "No threat actor, malware, or campaign context included"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith, contains) on indexed fields like Image and CommandLine, with specific image paths and targeted keyword matching. It avoids leading wildcards and uses a simple condition, making it fast to execute in most SIEMs.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids leading wildcards and complex regex"
            ],
            "weaknesses": [
              "CommandLine|contains with 'compress', 'encode' may trigger broadly",
              "Could prioritize more specific terms first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic use of encoded/compressed exfiltration via common tools like PowerShell and CertUtil, but misses key tools (e.g., netsh, scp, ftp), advanced C2 frameworks (Cobalt Strike, Sliver), and multi-stage behaviors. Coverage is limited to command-line flags rather than behavioral patterns.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Covers common utilities used in exfiltration (powershell, certutil)",
              "Includes relevant encoding/encryption keywords"
            ],
            "weaknesses": [
              "Narrow toolset coverage; misses common exfiltration tools",
              "No detection of staged or multi-process exfiltration behaviors"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process lineage, parent-child context, or frequency-based thresholds, making it prone to false positives from legitimate admin scripts. While false positives are acknowledged in metadata, no technical mitigations (e.g., excluding trusted paths/users) are implemented.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive scenarios in metadata",
              "Focus on specific tools reduces some noise"
            ],
            "weaknesses": [
              "No parent process filtering (e.g., blocking non-user initiators)",
              "No exclusions for known good paths or signed binaries"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with known TTPs where adversaries use built-in tools like PowerShell and certutil for exfiltration with encoding or compression. However, it lacks specificity to real-world campaigns, APT groups, or detailed behavioral patterns beyond basic command-line flags.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Targets legitimate LOLBins commonly abused in exfiltration (PowerShell, certutil, bitsadmin)",
              "Matches real attacker behaviors like use of -EncodedCommand and compression keywords"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Relies on generic keywords not tied to actual observed attack chains"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses valid Sigma syntax, realistic Sysmon process creation logging, and has been verified in a SIEM with events found. The high severity is justified, though false positives from administrative scripting may generate alert fatigue without additional filtering.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Validated in SIEM with detection output and low query time",
              "Uses standard log source (Sysmon process creation) common in enterprises"
            ],
            "weaknesses": [
              "No exclusion logic to reduce false positives from legitimate encoded commands",
              "Lacks user or host context to prioritize critical assets"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The title and description provide basic context, but the rule does not extract or highlight key investigative fields like IP addresses, file paths, or user accounts. False positive guidance is present but minimal.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Clear rule title indicating suspicious exfiltration activity",
              "Lists common false positives to aid triage"
            ],
            "weaknesses": [
              "Does not specify which fields are available for pivoting (e.g., CommandLine, ParentImage)",
              "No references to MITRE or response playbooks for next steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on command-line arguments, which attackers can easily obfuscate via string splitting, encoding, or alternative syntax. It does not correlate with network connections or file writes, making it vulnerable to LOLBin evasions and simple argument manipulation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Covers multiple LOLBins used in exfiltration",
              "Includes detection of encoding and compression terms that may survive light obfuscation"
            ],
            "weaknesses": [
              "Easily bypassed by obfuscating command-line arguments (e.g., $var='enc'; powershell $var)",
              "No behavioral correlation (e.g., process + network + file activity) to detect evasion"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects command-line indicators of data exfiltration tools and encoding/compression, which aligns with execution and potential exfiltration stages. However, it lacks logic to correlate across multiple stages such as initial access, persistence, or lateral movement, and operates as a single-event detection. It does not track follow-on behaviors or session context that would indicate a multi-stage attack flow.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:31:21.877943",
          "metadata": {
            "strengths": [
              "Covers relevant tools commonly abused in exfiltration (powershell, certutil, bitsadmin)",
              "Identifies suspicious command-line arguments tied to encoding/compression"
            ],
            "weaknesses": [
              "No correlation across events or attack phases",
              "Limited to execution-time detection without context of data staging or network exfiltration"
            ]
          }
        }
      ],
      "summary": "Rule for attack.exfiltration (Suspicious Data Exfiltration via C2 Channel) scored 0.57/1.0 (Poor). Best performance in quality (0.66). Needs improvement in detectability (0.40). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:31:21.877943",
      "metadata": {
        "attack_id": "attack.exfiltration",
        "technique_name": "Suspicious Data Exfiltration via C2 Channel",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6283333333333333,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6588235294117648,
        "effectiveness": 0.6066666666666667,
        "realism": 0.7444444444444445,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE mappings. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, id, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with meaningful content"
            ],
            "weaknesses": [
              "Missing critical metadata: status, author, date, references",
              "Incomplete due to absence of standard Sigma header fields"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly models the TTP by detecting Office processes spawning command-line interpreters, which aligns with malicious document execution. The inclusion of 'RoyalRoad' in the command line adds a specific IOA. However, some selections are redundant (e.g., multiple Office apps spawning same children), and condition could be simplified.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Accurate parent-child process relationships reflecting real attack chains",
              "Incorporates known IOA (RoyalRoad string) for high-fidelity detection"
            ],
            "weaknesses": [
              "Redundant selection blocks increase complexity without added value",
              "No filtering on command-line arguments or child process behavior"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule has moderate specificity but risks false positives due to broad parent-image matching without command-line context. Legitimate macros or admin scripts spawning cmd/powershell from Office apps may trigger alerts. More precise filtering on command-line content or child process ancestry would improve precision.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Narrows detection to specific Office parent processes (WINWORD, EXCEL, etc.)",
              "Includes known malicious indicator (RoyalRoad) as high-signal condition"
            ],
            "weaknesses": [
              "Lacks command-line filtering to distinguish malicious vs. benign script launches",
              "No exclusion logic for trusted users, paths, or signed scripts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple Office applications and execution vectors (cmd, PowerShell, wscript). It also detects via the 'RoyalRoad' string, which captures known kit usage. Case-insensitive matching is implied but not enforced, and obfuscation (e.g., encoded commands) could bypass the literal string match.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Covers multiple attack paths across Office suite",
              "Detects both behavioral pattern and specific IOA (RoyalRoad)"
            ],
            "weaknesses": [
              "Literal string match on 'RoyalRoad' is vulnerable to simple obfuscation",
              "No regex or case-insensitive handling explicitly defined"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1204, T1566.001) and a clear description linking to the RoyalRoad RTF kit, but lacks references to authoritative sources, threat actors, or campaign names. The description is informative but could include more context on tooling and real-world usage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Correct and specific MITRE ATT&CK technique tagging",
              "Clear rule title and description linking to known malware kit"
            ],
            "weaknesses": [
              "Missing references to MITRE pages or security research on RoyalRoad",
              "No attribution to threat actors or campaigns using this TTP"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient 'endswith' and 'contains' operators on indexed fields like ParentImage, Image, and CommandLine, with no leading wildcards. The structure is flat and avoids complex regex, making it performant in most SIEMs. However, 'CommandLine|contains \"RoyalRoad\"' could benefit from case-insensitive matching or additional normalization.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Uses efficient endswith and contains operators on high-cardinality fields",
              "Logsource is specific to Sysmon process creation events"
            ],
            "weaknesses": [
              "CommandLine contains check lacks case insensitivity or normalization",
              "Could prioritize more restrictive conditions first for faster evaluation"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers common Office-based execution chains (Word/Excel/PPT spawning cmd, PowerShell, wscript) and includes detection of the RoyalRoad string, which is relevant to known RTF exploit kits. However, it misses other potential child processes (e.g., mshta.exe, rundll32.exe, cscript.exe) and does not account for obfuscated command lines or indirect execution methods.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Covers multiple Office applications and common scripting interpreters",
              "Includes signature-based detection for RoyalRoad artifact"
            ],
            "weaknesses": [
              "Incomplete coverage of common LOLBins spawned by Office documents",
              "No detection logic for obfuscated or encoded command lines"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but does not implement any active filtering or exclusion logic (e.g., excluding trusted users, paths, or signed Microsoft binaries). Reliance on single-event parent-child spawning without additional context increases FP risk in environments with legitimate macro automation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate macro and admin script use in falsepositives list",
              "Focuses on suspicious parent-child relationships (Office \u2192 shell)"
            ],
            "weaknesses": [
              "No built-in exclusions for known good processes or paths",
              "Lacks thresholding or frequency-based logic to reduce noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with known TTPs where malicious Office documents spawn command-line interpreters, and the inclusion of 'RoyalRoad' as a keyword reflects real-world phishing kits. However, it lacks specific references to APT groups, campaigns, or detailed behavioral patterns beyond basic process spawning, limiting its contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Detection logic mirrors common malicious document behaviors (e.g., Office spawning cmd/powershell)",
              "Includes 'RoyalRoad' as a known artifact from real phishing toolkits"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns using RoyalRoad",
              "Lacks broader attack chain context (e.g., initial access vector, follow-on actions)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation events, and targets common parent-child process relationships seen in attacks. The medium severity level is appropriate, though false positives from legitimate macros may require tuning in environments with heavy macro use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Uses widely available Sysmon log source with realistic field mappings",
              "Condition logic is clear and deployable in most SIEMs with Sigma support"
            ],
            "weaknesses": [
              "False positives from authorized automation scripts could increase alert volume",
              "Missing field validation for CommandLine in all selections may reduce consistency"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the included process relationships provide strong pivoting points for investigation. False positive guidance helps analysts triage, and the MITRE tags support response planning.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Clear title and description enable quick understanding of the alert",
              "ParentImage and Image fields allow immediate process lineage analysis"
            ],
            "weaknesses": [
              "Lacks inclusion of user context or file hash fields for deeper investigation",
              "No direct links to MITRE ATT&CK or internal runbooks in metadata"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line content and specific parent-child process paths, which attackers can bypass via LOLBins, obfuscation, or alternative scripting hosts like mshta.exe or rundll32.exe. The 'RoyalRoad' string match is easily modified or encoded, reducing reliability.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Covers multiple Office applications and child processes, increasing coverage",
              "Behavioral focus on process spawning improves resilience over pure IOCs"
            ],
            "weaknesses": [
              "Highly vulnerable to simple obfuscation or use of alternate execution methods",
              "Relies on unencoded 'RoyalRoad' string, which can be encrypted or split"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution via Office applications spawning command-line tools or containing 'RoyalRoad' in the command line, which aligns with early-stage malicious activity. However, it lacks logic to correlate across later stages such as persistence, lateral movement, or exfiltration, making it primarily a single-event detection. There is no chaining or temporal correlation to identify multi-stage attack behaviors.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:03.404004",
          "metadata": {
            "strengths": [
              "Detects initial execution from common Office apps (Word, Excel, PowerPoint)",
              "Includes indicator-based detection for 'RoyalRoad', a known RTF exploit kit"
            ],
            "weaknesses": [
              "No detection logic for post-execution stages (persistence, exfiltration, etc.)",
              "Lacks event correlation or behavioral chaining across processes"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (User Execution via Malicious Office Document (RoyalRoad RTF Kit)) scored 0.63/1.0 (Below Average). Best performance in realism (0.74). Needs improvement in detectability (0.46). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-28T14:32:03.404004",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "User Execution via Malicious Office Document (RoyalRoad RTF Kit)",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5233333333333333,
      "category_scores": {
        "correctness": 0.58,
        "quality": 0.5470588235294118,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5888888888888889,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Includes core detection components: title, ID, description, detection logic, and false positives.",
              "Properly tags MITRE ATT&CK technique and includes logsource with Sysmon context."
            ],
            "weaknesses": [
              "Missing mandatory Sigma fields: author, date, status, and references.",
              "Incomplete metadata reduces auditability and operational trust."
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The detection logic combines script execution indicators (PowerShell -EncodedCommand, cmd /c) with specific C2 ports, but the OR-based condition allows matches on any single criterion, leading to over-detection. This could trigger on benign script use or unrelated traffic to common C2 ports without correlation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Uses valid field names from Sysmon (Image, CommandLine, DestinationPort).",
              "Targets known suspicious indicators associated with C2 activity."
            ],
            "weaknesses": [
              "Condition uses OR logic across disparate selections, increasing false positives.",
              "No correlation between process execution and network connection events."
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is overly broad due to uncorrelated conditions and lack of contextual filtering (e.g., parent process, user context, or destination IP reputation). Matching on 'DestinationPort|contains' instead of exact match increases noise, and no exclusions for administrative tools are implemented.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Identifies high-risk indicators like -EncodedCommand and well-known C2 ports.",
              "Lists relevant false positives, showing awareness of operational impact."
            ],
            "weaknesses": [
              "No AND logic to correlate process creation with network connections.",
              "Uses 'contains' on ports (e.g., '4444' matches 14444, 44440), causing false alarms."
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common C2 patterns like encoded PowerShell and known malicious ports (4444, 31337), which are frequently used in red team tools. However, it lacks case-insensitive matching, regex for obfuscation variants, and alternative command-line flags, making it vulnerable to simple evasion.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Covers multiple vectors: PowerShell, cmd.exe, and custom ports.",
              "Includes several high-risk C2 ports commonly used in tooling."
            ],
            "weaknesses": [
              "No case-insensitive or regex-based pattern matching for obfuscated commands.",
              "Does not account for alternative encodings or living-off-the-land binaries."
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags and a clear description, but lacks specific references to authoritative sources, threat actors, or malware families. The technique name 'Protocol Impersonation' does not map accurately to the MITRE reference provided, creating confusion.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tags and sub-technique ID (T1567.001)",
              "Provides a clear rule description and false positive context"
            ],
            "weaknesses": [
              "Incorrect or imprecise technique name mapping (T1567.001 is 'Exfiltration to Cloud Storage', not C2)",
              "Missing references to MITRE technique page, tools (e.g., Cobalt Strike), or known APT groups"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field operators like 'endswith' and 'contains' on indexed fields (Image, CommandLine, DestinationPort), but the condition logic is overly broad and combines unrelated selections with OR, reducing efficiency. Logsource is appropriately specific to Sysmon network events.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Uses efficient string operators (endswith, contains) on high-cardinality fields",
              "Logsource is specific to Windows Sysmon network_connection events"
            ],
            "weaknesses": [
              "OR condition combines process and network criteria without correlation, increasing noise",
              "Uses 'contains' on DestinationPort (e.g., '4444') which may match 14444, 44440, etc."
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic script execution with encoded commands and common C2 ports, but fails to correlate process creation with network connections, missing the core behavior of custom C2. It does not cover advanced tools like Cobalt Strike or DNS tunneling, nor does it detect multi-stage execution patterns.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Covers common C2 ports (4444, 31337, 5555) used by Metasploit and other frameworks",
              "Includes detection of PowerShell -EncodedCommand and cmd /c usage"
            ],
            "weaknesses": [
              "No correlation between process execution and network connection (critical gap)",
              "Ignores other scripting engines (e.g., wmic, cscript, mshta) and modern C2 frameworks"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists plausible false positives but lacks in-rule filtering to suppress them. There is no use of frequency thresholds, parent-child process logic, or path-based whitelisting, making it prone to alerting on legitimate admin activity and testing tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Acknowledges key false positive sources (pen testing tools, admin scripts)",
              "Targets specific command-line flags often associated with malicious use"
            ],
            "weaknesses": [
              "No exclusion of known administrative contexts (e.g., domain admins, approved tools)",
              "No requirement for process-network event correlation, leading to single-event alerts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with real-world TTPs involving custom C2 over non-standard ports and encoded PowerShell usage, commonly seen in post-exploitation tooling like Metasploit or Cobalt Strike. However, it lacks specificity to known APT groups or campaigns and relies on generic indicators rather than observed behavioral patterns from threat intelligence.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Matches common C2 port usage (e.g., 4444, 31337) associated with offensive tools.",
              "Captures encoded command execution, a frequent technique in real attacks."
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns.",
              "Detection logic is generic and not tied to advanced protocol impersonation behaviors."
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses valid Sysmon network connection data and common process images, making it deployable in most Windows environments. However, the condition logic combines disparate selections with OR operators without correlation, likely resulting in high false positives and alert fatigue.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Uses standard Sysmon event data widely available in enterprise environments.",
              "Includes realistic C2 port list used by common red team tools."
            ],
            "weaknesses": [
              "OR-based condition creates unspecific detection (e.g., any /c in cmd.exe triggers alert).",
              "No validation that network connection is tied to the suspicious process."
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly indicate potential C2 activity, and the detected fields (Image, CommandLine, DestinationPort) allow for basic pivoting. False positive guidance helps analysts triage, but missing process GUID or IP context limits deeper investigation.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Clear title and description aid analyst understanding.",
              "False positives are well-documented, supporting triage decisions."
            ],
            "weaknesses": [
              "Lacks critical pivot fields like SourceIP, ProcessId, or User.",
              "No MITRE ATT&CK technique ID mapping despite tag."
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is vulnerable to simple evasion such as using alternative LOLBins, port hopping, or obfuscating command lines. It relies heavily on command-line arguments, which can be easily encoded or split, and fails to correlate process creation with network connections, enabling bypass via indirect execution.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Detects -EncodedCommand, a common encoded payload delivery method.",
              "Monitors non-standard ports often used in C2."
            ],
            "weaknesses": [
              "No behavioral correlation between process and network events.",
              "Easily bypassed by changing port or using other interpreters (e.g., wmic, mshta)."
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule primarily detects initial execution via script-based command-line activity and associated network connections, but lacks logic to correlate across multiple stages such as persistence, lateral movement, or exfiltration. It focuses on a single event type (network connection) with process context, limiting its ability to track the full attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:32:39.273850",
          "metadata": {
            "strengths": [
              "Detects initial execution through suspicious PowerShell or cmd.exe command-line patterns.",
              "Includes network indicators (uncommon C2 ports) that may signal active C2 communication."
            ],
            "weaknesses": [
              "No correlation across multiple event types (e.g., process creation + network connection).",
              "Fails to detect later stages like data exfiltration or lateral movement using the same C2 channel."
            ]
          }
        }
      ],
      "summary": "Rule for attack.command_and_control (Detect Potential Custom C2 Protocol Usage via Unusual Ports and Script Execution) scored 0.52/1.0 (Poor). Best performance in realism (0.59). Needs improvement in detectability (0.40). Issues found in: detection_logic_correctness, detection_specificity, attack_coverage",
      "timestamp": "2025-12-28T14:32:39.273850",
      "metadata": {
        "attack_id": "attack.command_and_control",
        "technique_name": "Detect Potential Custom C2 Protocol Usage via Unusual Ports and Script Execution",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6133333333333333,
      "category_scores": {
        "correctness": 0.82,
        "quality": 0.6058823529411765,
        "effectiveness": 0.49333333333333335,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, tags, and falsepositives, with meaningful content. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Contains core detection components: title, detection logic, logsource, and tags",
              "Includes MITRE ATT&CK mapping and false positives"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Incomplete metadata reduces auditability and operational utility"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The detection logic accurately targets modifications to the specific registry key used by the SoulSearcher loader, aligning with known TTPs. The use of 'SetValue' event and correct field names (TargetObject, EventType) ensures compatibility with Sysmon and Sigma standards.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Precise alignment with documented malicious behavior",
              "Uses standard Sigma field names and correct condition logic"
            ],
            "weaknesses": [
              "Does not validate the data being written, potentially missing context",
              "Relies solely on path containment, which could be slightly brittle"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule is reasonably specific due to the unique registry path, reducing false positives. However, it lacks additional context filters like parent process, user context, or image path, which could help distinguish malicious from legitimate modifications.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Targets a rare and suspicious registry path not commonly used by legitimate software",
              "Clearly identifies a high-risk operation (SetValue)"
            ],
            "weaknesses": [
              "No filtering on process or user context increases false positive risk",
              "Relies on string containment rather than exact path match"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is narrowly focused on a single registry path and does not account for variations such as obfuscation, alternative registry locations, or different persistence mechanisms used by similar loaders. Case sensitivity and lack of regex/wildcard use limit evasion coverage.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Detects a known indicator associated with SoulSearcher",
              "Could catch basic implementations without obfuscation"
            ],
            "weaknesses": [
              "Vulnerable to simple evasion via path modification or encoding",
              "No support for case-insensitive matching or alternative spellings"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1112, attack.persistence) and a clear description tied to a specific malware loader (SoulSearcher). However, it lacks references to authoritative sources, threat actor groups, or detailed malware context beyond the name, reducing investigative utility.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging",
              "Clear rule title and description focused on a specific TTP"
            ],
            "weaknesses": [
              "Missing references to MITRE sub-techniques or public research on SoulSearcher",
              "No attribution to threat actors or campaigns using this method"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses a specific registry path with 'contains' and filters on EventType, which are efficiently indexed in Sysmon. While 'contains' is acceptable here due to registry path matching, 'startswith' would be more precise. Logsource is well-defined with Sysmon registry events.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Uses indexed fields (EventType, TargetObject) effectively",
              "Specific logsource targeting Sysmon registry events"
            ],
            "weaknesses": [
              "Uses 'contains' instead of 'startswith' for registry path, potentially less efficient",
              "No EventID filter (e.g., Sysmon EventID 13) which is more performant"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects modifications to a single registry key associated with SoulSearcher, but does not cover alternative persistence mechanisms or variations in key placement. It lacks detection of related behaviors such as reflective loading or process injection that often accompany this loader.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Targets a known malicious registry persistence path used by SoulSearcher",
              "Detects SetValue events, relevant for configuration changes"
            ],
            "weaknesses": [
              "Narrow scope\u2014only one registry key, no variants or fallbacks",
              "No coverage of multi-stage behaviors or associated tooling"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lacks process-level context (e.g., Image, ParentImage) to distinguish malicious from legitimate modifications. While false positives are acknowledged in metadata, no actual filtering or exclusion logic is implemented to reduce noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Acknowledges potential false positives in metadata",
              "Focuses on user hive (HKCU), reducing system-wide noise"
            ],
            "weaknesses": [
              "No exclusion of legitimate processes (e.g., ctfmon.exe, trusted Microsoft binaries)",
              "Single-event trigger without frequency or behavioral context"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule targets a specific registry path associated with the SoulSearcher loader, indicating some campaign-specific knowledge. However, it lacks references to specific threat actors, malware families, or real-world campaigns that use this technique, reducing its contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Targets a known malicious registry path used by SoulSearcher loader",
              "Aligned with execution and persistence behaviors in attack chains"
            ],
            "weaknesses": [
              "No attribution to specific APT groups or malware variants",
              "Lacks behavioral context beyond registry modification"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon Event ID 12/13 (registry set value), and targets a precise registry path. The false positive considerations are noted, and the detection has been verified in a Splunk environment with real log data, indicating production readiness.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful event detection (254 events)",
              "Uses common and available Windows Sysmon logging"
            ],
            "weaknesses": [
              "High volume of events (254) may indicate potential alert fatigue",
              "Relies on registry path alone without additional filtering"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The title and description clearly state what was detected, and the registry path provides a pivot point. However, the rule does not include additional contextual fields (e.g., process, user, image path) that would aid in investigation, limiting immediate actionability.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Clear title and description for quick understanding",
              "Specific registry path enables direct investigation"
            ],
            "weaknesses": [
              "Missing process or user context in detection fields",
              "No MITRE ATT&CK sub-technique ID (T1112 is too broad)"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects a specific registry path modification, which is easily bypassed by attackers using alternative paths or LOLBins. It relies solely on a static registry key and does not incorporate behavioral patterns or process lineage, making it vulnerable to simple obfuscation or path modification.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Detects SetValue events, which are harder to hide than command lines",
              "Focuses on a non-standard registry location often abused by malware"
            ],
            "weaknesses": [
              "Single-point detection easily evaded by changing registry path",
              "No correlation with process or parent-child relationships"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects a single event\u2014registry modification to a specific persistence path\u2014but does not incorporate logic for earlier execution stages, lateral movement, or exfiltration. While it effectively identifies a persistence attempt, it lacks correlation with other stages of the attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:14.525982",
          "metadata": {
            "strengths": [
              "Detects a known malicious registry modification associated with SoulSearcher loader",
              "Targets a specific, high-risk registry path unlikely to be modified by normal user activity"
            ],
            "weaknesses": [
              "Single-event detection with no multi-stage correlation",
              "No logic to detect initial access or follow-on activities like command execution or data exfiltration"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Registry Modification to SoulSearcher Loader Configuration Path) scored 0.61/1.0 (Below Average). Best performance in correctness (0.82). Needs improvement in detectability (0.46). Issues found in: detection_sensitivity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:33:14.525982",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Registry Modification to SoulSearcher Loader Configuration Path",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.62,
      "category_scores": {
        "correctness": 0.7200000000000001,
        "quality": 0.6411764705882353,
        "effectiveness": 0.52,
        "realism": 0.7555555555555555,
        "detectability": 0.5
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection blocks"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete tags (truncated in input)"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The logic correctly identifies suspicious service creation via sc.exe with binPath pointing to user-writable locations, aligning with T1543.001. Field names are standard Sigma syntax, and the condition is simple and effective. However, it assumes sc.exe is the only tool used, which may miss other service manipulation tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Accurate use of CommandLine and Image fields to detect malicious service creation",
              "Correctly targets known persistence indicators (e.g., %APPDATA%, %TEMP%)"
            ],
            "weaknesses": [
              "Does not account for alternative tools like PowerShell or WMI",
              "Relies solely on sc.exe, which attackers may avoid"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses specific indicators like 'create' and 'binPath=' with user directory paths, reducing false positives. However, it lacks filters on parent process or user context (e.g., SYSTEM vs. user), which could help distinguish malicious from legitimate administrative activity.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Combines multiple conditions (create, binPath=, user paths) for precision",
              "Excludes system-wide paths, focusing on high-risk locations"
            ],
            "weaknesses": [
              "No parent process or user context filtering",
              "May trigger on legitimate software installers in user contexts"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately sensitive but limited by its reliance on sc.exe and exact string matches. It does not use regex or case-insensitive matching, leaving it vulnerable to obfuscation (e.g., 'CREATE', encoded commands). It also misses alternative binaries like 'net.exe' or PowerShell-based service creation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Covers common user directory paths used in attacks",
              "Detects clear indicators like binPath= with environment variables"
            ],
            "weaknesses": [
              "No support for command obfuscation or case variation",
              "Narrow tool focus (sc.exe only) enables evasion"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1543.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The technique name is generic and does not fully align with MITRE's naming convention.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tag (T1543.001)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing MITRE reference URL or CVE examples",
              "No attribution to threat actors or malware using this technique"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image|endswith, CommandLine|contains) with specific keywords and avoids leading wildcards. The logsource is well-defined for Sysmon process creation events, and conditions are ordered for early filtering.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, CommandLine)",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "Could prioritize 'create' and 'binPath=' earlier in logic for faster evaluation",
              "No use of 'startswith' where more precise"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic service creation via sc.exe with suspicious paths but misses alternative tools (e.g., PowerShell, WMI, .NET), remote service creation, or signed malicious binaries. It does not cover advanced or fileless variants using other execution methods.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Covers common sc.exe-based persistence with user directory paths",
              "Detects use of environment variables like %APPDATA% and %TEMP%"
            ],
            "weaknesses": [
              "Ignores other service manipulation tools (PowerShell, psexec)",
              "No detection of remote service creation or living-off-the-land binaries"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists general false positives but lacks inline filtering for known legitimate software or administrative tools. It relies on a single-event condition without parent process context or frequency thresholds, increasing FP risk.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate admin tasks and software installs as FPs",
              "Uses suspicious path indicators (%APPDATA%, %TEMP%)"
            ],
            "weaknesses": [
              "No exclusion of trusted parent processes (e.g., installer processes)",
              "No thresholding or behavioral context to reduce single-event alerts"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs where adversaries create services with suspicious binary paths for persistence, particularly using sc.exe with paths in user-writable directories. It reflects common behavior seen in malware and post-compromise activity, though it lacks specific references to known APT groups or campaigns that leverage this technique.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Detection logic mirrors actual adversary behavior in service-based persistence",
              "Focus on user directory paths (%APPDATA%, %TEMP%, \\Users\\) reflects real-world LOLBin abuse"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Lacks context on timing or execution chains (e.g., follow-on execution)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The Sigma rule is syntactically valid, leverages Sysmon process creation logs which are common in mature environments, and targets a high-severity, actionable behavior. The false positive list is realistic, and the detection has been verified in a SIEM with actual events found, indicating production readiness.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Uses widely available Sysmon log source",
              "Verified detection with real events and low query time"
            ],
            "weaknesses": [
              "May generate FPs during software deployments or admin tasks without additional filtering",
              "Relies on command-line logging, which must be enabled"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly indicate what is detected, and the fields used (Image, CommandLine) allow for pivoting. Analysts can extract service binary paths and investigate further, though the rule could include more investigative context like expected parent processes or user context.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Clear title and description aid triage",
              "CommandLine and Image fields support investigation"
            ],
            "weaknesses": [
              "Lacks guidance on key follow-up steps or MITRE response recommendations",
              "No mention of critical pivot fields like User, ParentImage, or Hash"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line arguments and specific strings, which attackers can easily obfuscate or bypass using encoding, alternative tools (e.g., PowerShell, WMI), or renamed binaries. While sc.exe usage is common, adversaries increasingly avoid it in favor of living-off-the-land techniques that this rule does not cover.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Detects use of environment variables common in malicious service paths",
              "Combines multiple command-line indicators (create, binPath=)"
            ],
            "weaknesses": [
              "Vulnerable to simple command-line obfuscation or alternative execution methods",
              "Does not account for use of PowerShell, WMI, or other service creation mechanisms"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects the creation of services with suspicious binary paths, which aligns with initial execution and persistence stages of the attack lifecycle, particularly for T1543.001 (Create or Modify System Process). However, it is limited to a single-event detection focused solely on sc.exe usage and does not correlate across multiple stages such as lateral movement, data exfiltration, or follow-on activity after service creation.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:33:50.608571",
          "metadata": {
            "strengths": [
              "Detects initial execution and potential persistence via service creation",
              "Targets known malicious patterns in binary paths using environment variables and user directories"
            ],
            "weaknesses": [
              "No correlation across multiple events or attack stages",
              "Limited to sc.exe, missing other service manipulation tools like PowerShell or WMI"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Suspicious System Process Creation via Service Configuration) scored 0.62/1.0 (Below Average). Best performance in realism (0.76). Needs improvement in detectability (0.50). Issues found in: detection_sensitivity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:33:50.608571",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Suspicious System Process Creation via Service Configuration",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6733333333333333,
      "category_scores": {
        "correctness": 0.74,
        "quality": 0.723529411764706,
        "effectiveness": 0.5933333333333333,
        "realism": 0.8,
        "detectability": 0.5111111111111111
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, and status, which are essential for production rule management and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Includes critical fields: title, id, description, detection logic, and MITRE tags",
              "Properly structured logsource and detection sections with meaningful content"
            ],
            "weaknesses": [
              "Missing author, date, and status fields required for Sigma compliance",
              "No references field despite having MITRE link in context"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The detection logic accurately captures known tools and flags associated with T1027, including PowerShell encoding, certutil decoding, and scripting hosts. However, the base64 catch-all is overly broad and may trigger on benign strings, while mshta/wscript/cscript lack command-line constraints, increasing false positives.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Correctly identifies key T1027 indicators like -enc and -EncodedCommand in PowerShell",
              "Includes relevant utilities (certutil, mshta, wscript) commonly abused for obfuscation"
            ],
            "weaknesses": [
              "Generic 'base64' string match in command line leads to high false positive risk",
              "No filtering on command-line arguments for scripting hosts reduces precision"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is too broad in several areas, especially with the 'base64' keyword match and unconditional mshta/wscript/cscript triggers. It lacks context such as parent process, user context, or command-line patterns that distinguish malicious from legitimate use, increasing false alerts in production.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Uses specific Image path endings to reduce noise",
              "Separates detection conditions per tool for better clarity"
            ],
            "weaknesses": [
              "No exclusion of trusted parent processes (e.g., explorer.exe vs svchost.exe)",
              "Lacks command-line validation (e.g., base64 payload structure) to filter benign usage"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule demonstrates strong sensitivity by covering multiple vectors (PowerShell, certutil, HTA, WSH) and both -enc and -EncodedCommand variants. It also uses partial string matching appropriately for case-insensitive command-line flags, making it resilient to minor obfuscation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Covers diverse tools and methods used in T1027 obfuscation",
              "Detects multiple encoding/decoding utilities and flags, increasing coverage"
            ],
            "weaknesses": [
              "Does not include case-insensitive modifiers explicitly (relies on backend)",
              "Misses alternative encodings (e.g., ROT13, custom scripts) beyond common tools"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1027) and a clear description, with a direct link to the technique in context. However, it lacks references to threat actors, malware families, or specific campaigns known to use this technique, reducing its investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Correct and relevant MITRE ATT&CK tagging",
              "Clear rule description and inclusion of false positives"
            ],
            "weaknesses": [
              "Missing threat actor or malware family associations",
              "No external references beyond MITRE URL"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule uses indexed fields like Image and CommandLine with efficient operators (endswith, contains). The structure avoids leading wildcards and places specific conditions first. Logsource is appropriately scoped to Sysmon process creation on Windows.",
          "confidence": 0.98,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Uses efficient field operators (endswith, contains)",
              "Leverages indexed fields and avoids costly regex"
            ],
            "weaknesses": [
              "Some 'contains' on CommandLine without additional constraints could be optimized",
              "No ordering of conditions by selectivity in the '1 of selection_*' condition"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers common obfuscation tools like PowerShell, certutil, mshta, and base64, which are frequently abused. However, it misses detection of other encoding utilities (e.g., bitsadmin, debug, findstr), advanced obfuscation layers, or encoded payloads in non-command-line artifacts (e.g., registry, WMI).",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Covers key tools: PowerShell, certutil, mshta, wscript",
              "Detects both -enc and -EncodedCommand flags"
            ],
            "weaknesses": [
              "Lacks coverage of alternative encoding methods and tools",
              "No detection of multi-stage or nested obfuscation patterns"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lists common false positives in metadata but lacks in-rule filtering (e.g., parent process checks, path whitelisting, or frequency thresholds). This increases alert fatigue without behavioral context to distinguish malicious from legitimate use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Comprehensive false positive documentation in metadata",
              "Clear identification of administrative use cases"
            ],
            "weaknesses": [
              "No parent-child process logic to filter benign executions",
              "Absence of path or user-based exclusions in detection logic"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule captures common TTPs associated with T1027, such as PowerShell encoding and certutil misuse, which are frequently used in real-world attacks. However, it lacks specific references to known adversary groups or campaigns that leverage these techniques, reducing contextual depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Covers widely observed obfuscation tools (PowerShell, certutil, mshta)",
              "Aligns with execution-phase behaviors in the kill chain"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Misses nuanced command-line patterns (e.g., nested encodings, hybrid obfuscation)"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses standard Sysmon process creation logging, which is common in enterprise environments, and has been verified with detection events. The medium severity and documented false positives support SOC triage, though some conditions may generate noise.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection events",
              "Realistic logsource (Sysmon process creation on Windows)"
            ],
            "weaknesses": [
              "Broad 'base64' command-line match increases false positives",
              "No exclusion logic for known benign processes"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly indicate detection of obfuscation attempts, and the fields used (Image, CommandLine) allow for effective pivoting. False positive guidance helps analysts triage, though more investigative context could be added.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Clear title and description for rapid understanding",
              "CommandLine inclusion enables decoding and analysis"
            ],
            "weaknesses": [
              "Lacks suggested follow-up queries or enrichment steps",
              "No user or host context explicitly highlighted"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule relies heavily on command-line arguments, which attackers can easily obfuscate or avoid using alternate encoding methods. While it covers multiple LOLBins, it does not incorporate behavioral chains or indirect indicators that would make evasion harder.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Detects multiple common LOLBins (certutil, mshta, wscript)",
              "Includes both '-enc' and '-EncodedCommand' variants"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation (e.g., space insertion, case variation)",
              "No detection logic for indirect execution or script block logging"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of obfuscation utilities like PowerShell, certutil, and scripting hosts, which aligns with early-stage malicious activity. However, it lacks logic to correlate across multiple stages such as persistence, lateral movement, or exfiltration that may involve encoded payloads. Detection is largely single-event and does not chain related behaviors over time.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:34:29.821875",
          "metadata": {
            "strengths": [
              "Covers initial execution vectors commonly used in obfuscation (PowerShell, certutil, mshta)",
              "Includes multiple selection paths for diverse encoding tools"
            ],
            "weaknesses": [
              "No correlation across attack lifecycle stages",
              "Limited to process creation without follow-on behavioral context"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1027 (Obfuscated Files or Information via Common Encoding Utilities) scored 0.67/1.0 (Below Average). Best performance in realism (0.80). Needs improvement in detectability (0.51). Issues found in: detection_specificity, false_positive_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T14:34:29.821875",
      "metadata": {
        "attack_id": "attack.t1027",
        "technique_name": "Obfuscated Files or Information via Common Encoding Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6266666666666667,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.6588235294117648,
        "effectiveness": 0.6333333333333333,
        "realism": 0.6888888888888889,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like 'status', 'author', 'date', and 'references', reducing its completeness for production use.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Includes essential fields: title, id, description, detection logic, and MITRE tags",
              "Properly maps to MITRE ATT&CK technique T1190 under initial access"
            ],
            "weaknesses": [
              "Missing required Sigma fields: status, author, date, references",
              "No indication of rule maturity or ownership"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly focuses on w3wp.exe spawning shells like cmd.exe or powershell.exe with suspicious command lines, aligning with post-exploitation behavior after exploiting a public-facing app. However, it assumes the exploit leads directly to shell spawning, which may not always be the case, and some command-line indicators could stem from benign scripts.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Accurate parent-child process logic targeting IIS worker processes",
              "Includes relevant command-line artifacts tied to malicious payloads"
            ],
            "weaknesses": [
              "Does not distinguish between SYSTEM and low-privilege user contexts, increasing false positives",
              "Relies on command-line content that may be obfuscated or absent in fileless attacks"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses specific parent and child process paths, improving precision, but the CommandLine filters are broad and may trigger on legitimate admin scripts or deployment tools. It acknowledges false positives but does not implement additional constraints like user context, command-line length, or argument structure to reduce noise.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Uses endswith for precise image and parent image matching",
              "Combines multiple conditions (parent, child, command line) for context"
            ],
            "weaknesses": [
              "Command-line keywords like 'DownloadFile' or 'Invoke-WebRequest' are common in legitimate automation",
              "Lacks exclusion logic for known-good tools or deployment windows"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule captures multiple IOCs including encoded commands, common download methods, and tools like netcat, increasing sensitivity to varied post-exploitation behaviors. It uses contains|any which helps catch obfuscated or path-varied executions, though it could benefit from regex for base64-encoded payloads or case-insensitive matching.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Covers multiple attack tools and techniques (PowerShell, netcat, encoded commands)",
              "Uses 'contains|any' to detect variations in command-line arguments"
            ],
            "weaknesses": [
              "No case-insensitive matching for command-line artifacts (e.g., 'invoke-webrequest' in lowercase)",
              "Does not account for alternative tools like certutil or bitsadmin for downloads"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1190, initial access) and a clear description, but lacks specific sub-technique mapping (e.g., T1059 command-line interface) and references to authoritative sources like MITRE sub-techniques or known threat actors. No malware families, tools, or campaign names are referenced, limiting investigative context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Correct high-level MITRE ATT&CK mapping (T1190, initial access)",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing sub-technique coverage (e.g., T1059.001, T1059.003)",
              "No references to threat actors, malware, or external sources"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field filters (Image, ParentImage, CommandLine) with endswith and contains operators appropriate for indexed fields. The detection logic starts with specific parent process (w3wp.exe), improving performance. However, 'CommandLine|contains|any' with unanchored strings like 'DownloadFile' may increase noise and lacks regex optimization for precision.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Uses specific ParentImage filter early in logic",
              "Avoids leading wildcards and uses efficient field matching"
            ],
            "weaknesses": [
              "Unanchored 'contains' on generic terms may reduce precision",
              "No use of 'startswith' or regex boundaries to improve efficiency"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule detects common post-exploitation behaviors like shell spawning and use of tools (netcat, PowerShell downloaders), covering basic exploitation outcomes. However, it misses coverage of advanced variants (e.g., reflective DLL loading, obfuscated one-liners) and does not account for alternative shells (e.g., python, bash via WSL) or encoded command techniques beyond '-enc'.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Covers common exploitation artifacts (powershell, cmd, netcat)",
              "Includes indicators for file download and encoded commands"
            ],
            "weaknesses": [
              "Limited coverage of obfuscation and advanced execution methods",
              "No detection of non-PowerShell/CMD shells or in-memory techniques"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule identifies plausible false positives (admin tasks, deployment scripts) in metadata but lacks inline filtering to suppress them. It does not exclude known administrative users, signed Microsoft binaries, or legitimate deployment tools. A single-event condition increases FP risk without frequency or behavioral context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Acknowledges realistic false positive scenarios in metadata",
              "Uses parent-child process context (w3wp spawning shell)"
            ],
            "weaknesses": [
              "No exclusion filters for trusted tools or paths",
              "Single-event trigger without thresholding or behavioral chaining"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs where attackers exploit public-facing applications and spawn shells via compromised web processes like w3wp.exe. It includes relevant command-line artifacts commonly seen in post-exploitation, such as PowerShell encoding and download utilities.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Targets w3wp.exe as parent, reflecting IIS-based exploitation scenarios",
              "Includes high-fidelity command-line indicators like '-enc' and 'DownloadFile'"
            ],
            "weaknesses": [
              "Lacks specificity to known APT groups or campaigns",
              "Does not reference MITRE ATT&CK sub-technique T1190 explicitly in context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sigma syntax and realistic Windows process creation logging, which is common in enterprise environments. However, the high false positive risk from admin scripts and deployments may lead to alert fatigue without additional filtering.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Validated detection with SIEM verification showing events found",
              "Uses standard Windows process creation fields available in most EDR/SIEM"
            ],
            "weaknesses": [
              "No exclusion logic for known deployment tools or maintenance windows",
              "High severity may not be justified without behavioral context"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The title and description clearly communicate the detection intent, and the fields used (ParentImage, Image, CommandLine) are highly useful for investigation. False positive guidance helps analysts triage legitimate activity.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Clear title and description enabling quick understanding",
              "Detection fields support pivoting to parent process and command-line"
            ],
            "weaknesses": [
              "Missing user context or network connection data in detection",
              "No reference to MITRE ID T1190 in tags for enrichment"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line arguments, which attackers can easily obfuscate or bypass using encoded commands, alternative tools, or LOLBins. While it detects common patterns, it lacks depth in behavioral correlation or indirect indicators.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Detects multiple suspicious command-line patterns in combination",
              "Focuses on child process of w3wp.exe, a key behavioral indicator"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation (e.g., encoded commands)",
              "No network or file activity correlation to detect stealthier payloads"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution via command shell spawning from w3wp.exe, which aligns with initial access or execution stages. However, it lacks logic to detect persistence, lateral movement, or exfiltration stages tied to the same TTP. The detection is limited to a single-event trigger without correlation across attack lifecycle phases.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:12.105936",
          "metadata": {
            "strengths": [
              "Detects initial compromise vector through web server child processes",
              "Focuses on high-risk command-line indicators associated with post-exploitation"
            ],
            "weaknesses": [
              "No multi-event correlation or stage progression tracking",
              "Limited to execution phase; misses downstream attack activities"
            ]
          }
        }
      ],
      "summary": "Rule for attack.initial_access (Exploit Public-Facing Application via Web Server Process Spawning Shell) scored 0.63/1.0 (Below Average). Best performance in realism (0.69). Needs improvement in detectability (0.46). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-28T14:35:12.105936",
      "metadata": {
        "attack_id": "attack.initial_access",
        "technique_name": "Exploit Public-Facing Application via Web Server Process Spawning Shell",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5666666666666667,
      "category_scores": {
        "correctness": 0.6399999999999999,
        "quality": 0.6411764705882353,
        "effectiveness": 0.49333333333333335,
        "realism": 0.5888888888888889,
        "detectability": 0.4444444444444444
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured with unique ID and meaningful title"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces auditability and governance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The logic captures common archiving tools and command-line indicators of data packaging, aligning with T1560.001. However, selection3 includes generic paths like \\AppData\\ and \\Temp\\, which are overly broad and not specific to exfiltration preparation. The condition 'selection1 and (selection2 or selection3)' may trigger on benign use of archive tools in temp directories.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Covers key archiving tools and password-protected archive indicators",
              "Uses standard Sigma field names (Image, CommandLine)"
            ],
            "weaknesses": [
              "selection3 introduces high false-positive risk with generic paths",
              "Condition logic could be refined to reduce noise"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity due to broad patterns like 'http', 'ftp', and local path references that are common in legitimate workflows. It does not filter by parent process, user context, or network activity, increasing false positives. While it lists false positives, it doesn't exclude them in logic.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Combines multiple conditions using AND/OR for some precision",
              "Targets known archive utilities"
            ],
            "weaknesses": [
              "No exclusion of system or admin processes",
              "Uses overly broad indicators (e.g., 'http' in command line)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule demonstrates good sensitivity by covering multiple archiving tools (7z, WinRAR, PowerShell) and command-line variants (e.g., 'a', 'add', 'Compress-Archive'). It includes case-sensitive common flags and supports different archive methods, making it resilient to tool substitution. However, it could improve with case-insensitive matching and regex for obfuscated commands.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Covers multiple tools and command-line syntaxes",
              "Includes both native and third-party archiving indicators"
            ],
            "weaknesses": [
              "Lacks case-insensitive matching for robustness",
              "No handling of encoded or obfuscated command lines"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1560.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The generation method 'langchain' raises concerns about provenance and reliability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique tagging",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to threat actors or malware families"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses efficient field operators (endswith, contains) on indexed fields like Image and CommandLine, with specific image paths. However, 'contains' on broad substrings like 'add' or 'a' may cause unnecessary expansion and slow evaluation in large environments.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine)",
              "Specific Image path filtering with endswith"
            ],
            "weaknesses": [
              "Overuse of 'contains' with short, ambiguous substrings (e.g., 'a')",
              "No prioritization of most selective condition first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule captures common archiving tools and basic command-line flags but misses advanced variants like custom packers, encrypted archives via scripting languages (Python, JavaScript), or use of lesser-known tools (e.g., PeaZip, 7z.dll via rundll32). Coverage of PowerShell and cmd is good, but lacks depth in detecting living-off-the-land binaries beyond core examples.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Covers major archiving tools (7z, WinRAR)",
              "Includes PowerShell Compress-Archive and tar"
            ],
            "weaknesses": [
              "Limited coverage of LOLBins and script-based compression",
              "No detection of archive encryption via non-standard tools"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists common false positives but lacks technical mitigations such as parent process constraints, user context filtering, or path whitelisting. Conditions like 'CommandLine contains a' will trigger on benign usage, and no frequency or threshold logic is applied to reduce noise.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Acknowledges legitimate backup and dev use cases",
              "Includes common temp paths as context"
            ],
            "weaknesses": [
              "No parent-child process validation (e.g., explorer spawning 7z)",
              "Lacks thresholds or behavioral context to suppress noise"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule captures common archiving utilities and command-line patterns associated with data staging, aligning with T1560.001. However, it lacks specificity to known adversary behaviors, such as those used by APT groups like FIN12 or Lazarus, and does not reference real-world campaign tactics beyond generic tool usage. The detection logic is based on textbook examples rather than observed attack chains involving specific timing, target paths, or multi-stage exfiltration prep.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Aligns with MITRE T1560.001 for data archiving",
              "Includes relevant tools and parameters used in exfiltration prep"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Generic patterns not grounded in observed adversary TTPs"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule uses valid Sigma syntax and realistic Sysmon log sources, making it deployable in most Windows environments. However, the detection condition combines broad selections that may generate high false positives\u2014especially from legitimate PowerShell and cmd usage\u2014leading to alert fatigue. The 'high' severity is justified but not sufficiently tempered by specificity or environmental context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Valid logsource and syntax for enterprise deployment",
              "Includes tested verification with event count and query performance"
            ],
            "weaknesses": [
              "High potential for false positives due to broad command-line matches",
              "Lacks exclusions for common benign activity (e.g., user context, known paths)"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule title and description clearly indicate suspicious archiving behavior with exfiltration context, aiding analyst triage. Key fields like Image and CommandLine are captured, enabling pivoting to process trees and user activity. However, it lacks enrichment suggestions (e.g., file size, destination IP, parent process) that would improve investigative depth.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and MITRE tagging",
              "Provides useful false positive guidance for common scenarios"
            ],
            "weaknesses": [
              "Missing key investigative fields (e.g., network connections, file paths)",
              "No references to response playbooks or enrichment steps"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule relies heavily on command-line arguments and specific executable names, both of which are easily evaded via LOLBins, renamed tools, or obfuscation (e.g., encoded commands). It does not incorporate behavioral chains like file creation after compression or network transmission, making it vulnerable to simple bypasses. Detection of PowerShell's Compress-Archive is useful but insufficient alone.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Detects multiple archive tools and methods (7z, WinRAR, tar, PowerShell)",
              "Includes password-protected archive indicators (-p, --password)"
            ],
            "weaknesses": [
              "Easily bypassed by renamed binaries or encoded commands",
              "No integration with network or file creation events for corroboration"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects process creation events associated with archiving tools and command-line indicators of data packaging, which aligns with the data collection stage of T1560.001. However, it lacks logic to correlate across multiple stages such as initial access, persistence, or actual exfiltration, limiting detection to a single event. While it includes some context for potential exfiltration (e.g., 'http', 'ftp'), these are shallow indicators without behavioral correlation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:35:48.019366",
          "metadata": {
            "strengths": [
              "Covers initial data archiving activity using common tools and CLI patterns",
              "Includes indicators suggestive of exfiltration preparation (e.g., passwords, temp paths)"
            ],
            "weaknesses": [
              "No multi-event correlation or session-based analysis to link archiving with later exfiltration",
              "Does not detect lateral movement or persistence related to this TTP"
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1560.001 (Suspicious Data Archiving with Potential Exfiltration Patterns) scored 0.57/1.0 (Poor). Best performance in quality (0.64). Needs improvement in detectability (0.44). Issues found in: detection_specificity, attack_coverage, false_positive_resistance",
      "timestamp": "2025-12-28T14:35:48.020373",
      "metadata": {
        "attack_id": "attack.t1560.001",
        "technique_name": "Suspicious Data Archiving with Potential Exfiltration Patterns",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.64,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.6823529411764706,
        "effectiveness": 0.5933333333333333,
        "realism": 0.6888888888888889,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks required metadata fields like author, date, status, and references, which are essential for production readiness and traceability.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured with meaningful content in key fields"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces governance and maintainability"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The selection logic accurately targets schtasks.exe and PowerShell usage with parameters tied to scheduled task creation, aligning with T1053.005. The parent process filtering adds context, and the exclusion of known benign paths via filter improves validity. However, 'CommandLine|contains' on '/tn' may be too generic and could miss obfuscated variants.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Uses relevant process and command-line indicators",
              "Includes parent process context and excludes known benign paths"
            ],
            "weaknesses": [
              "Relies on exact string matches that may miss obfuscation",
              "Some conditions like '/tn' are common and not uniquely malicious"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule combines multiple conditions (process, command line, parent) to improve precision, and filters out some enterprise management paths. However, it may still trigger on legitimate admin scripts due to broad use of 'contains' and lack of user context or command-line depth analysis.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Combines process, command-line, and parent process for context",
              "Includes filters for known benign paths like \\CCM\\"
            ],
            "weaknesses": [
              "Over-reliance on substring matching increases false positives",
              "Lacks user context or session type (e.g., interactive vs script)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers multiple tools (schtasks, PowerShell) and command patterns (Register-ScheduledJob, -Trigger), increasing coverage across attack variants. However, it lacks case-insensitive matching and regex support for obfuscated commands, making it vulnerable to simple evasion like case variation or encoding.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Covers both native binaries and PowerShell-based task creation",
              "Includes multiple command-line indicators for same TTP"
            ],
            "weaknesses": [
              "No case-insensitive or regex patterns to catch obfuscation",
              "Vulnerable to command-line encoding or parameter reordering"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1053.005) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The description is functional but could provide more operational context for investigators.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Correct and specific MITRE ATT&CK technique tagging (T1053.005)",
              "Clear rule title and functional description"
            ],
            "weaknesses": [
              "Missing MITRE references or links to detailed technique pages",
              "No attribution to threat actors, malware, or real-world usage examples"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith, contains) on indexed fields like Image and CommandLine, with specific values. The logsource is appropriately scoped to Sysmon process creation, and the condition structure prioritizes high-specificity filters first.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Uses indexed fields effectively (Image, CommandLine, ParentImage)",
              "Avoids leading wildcards and uses efficient string operators"
            ],
            "weaknesses": [
              "CommandLine|contains with '/create' and '/tn' may trigger on benign scripts",
              "Could improve performance by reordering conditions to put rarer terms first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects common scheduled task creation via schtasks.exe and PowerShell, covering basic and some advanced execution methods. However, it misses key variations like WMI, COM interfaces, or .NET-based task creation, and does not account for obfuscated PowerShell or encoded commands used by advanced adversaries.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Covers dual-use tools (schtasks.exe, PowerShell) commonly abused for persistence",
              "Includes both command-line and script-based creation methods"
            ],
            "weaknesses": [
              "Lacks coverage of WMI, .NET, or API-based task creation",
              "No detection of obfuscation or encodedcommand usage in PowerShell"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule includes basic filters for known system paths (\\CCM\\, \\SCOMREDIR\\), but lacks user-based, time-based, or frequency-based logic to suppress noise. The false positive list is generic and does not guide analysts on tuning or contextual triage.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Includes path-based exclusions for enterprise management tools",
              "Leverages parent process context (cmd, wscript) to increase suspicion"
            ],
            "weaknesses": [
              "No user or session context filtering (e.g., SYSTEM vs user)",
              "False positive guidance is vague and not actionable for tuning"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world TTPs involving scheduled task creation via schtasks.exe and PowerShell, commonly used by adversaries for persistence. It captures key command-line artifacts like '/create' and 'Register-ScheduledJob', which reflect actual attack patterns, though it lacks specific references to known APT groups or campaigns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Detection logic reflects common adversary use of schtasks and PowerShell for persistence",
              "Includes relevant command-line parameters observed in real attacks"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Missing context on timing, target directories, or malicious payloads"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule uses valid Sigma syntax and realistic Sysmon log sources, making it deployable in most Windows environments. However, the detection logic may generate excessive false positives due to broad command-line contains checks and lack of constraints on user context or execution path.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Valid logsource and syntax compatible with common SIEMs",
              "Includes verified detection with real event matches"
            ],
            "weaknesses": [
              "High potential for false positives from admin scripts and management tools",
              "Lacks user or host context to reduce noise"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule title and description clearly communicate the detection intent, and the included fields (Image, CommandLine, ParentImage) are highly useful for investigation. False positive guidance helps analysts triage alerts from enterprise tools.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable description",
              "Relevant process lineage fields support pivoting and investigation"
            ],
            "weaknesses": [
              "Missing hash or user identity fields for stronger attribution",
              "No direct MITRE ATT&CK link in tags despite correct technique"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line arguments, which attackers can easily obfuscate or encode, reducing effectiveness. While it includes multiple tools (schtasks, PowerShell), it lacks behavioral depth such as child process monitoring or file creation correlation.",
          "confidence": 0.8,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Covers both schtasks.exe and PowerShell-based task creation",
              "Includes parent process context to detect script-based launches"
            ],
            "weaknesses": [
              "Vulnerable to command-line obfuscation and LOLBin abuse",
              "No detection logic for indirect task creation (e.g., via WMI or COM)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of scheduled task creation via schtasks.exe or PowerShell, which aligns with early-stage persistence activity. However, it lacks logic to correlate follow-on actions such as lateral movement, execution of the created task, or data exfiltration, making it primarily a single-event detection. There is no multi-event correlation or phase-aware logic to track the full attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:22.839924",
          "metadata": {
            "strengths": [
              "Detects known command-line indicators for scheduled task creation",
              "Includes parent process context to filter potentially suspicious launches"
            ],
            "weaknesses": [
              "No correlation across multiple stages (e.g., task creation followed by execution)",
              "Limited to initial access/persistence without visibility into later TTPs"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Suspicious Scheduled Task Creation for Persistence) scored 0.64/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.46). Issues found in: false_positive_resistance, evasion_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T14:36:22.840429",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Suspicious Scheduled Task Creation for Persistence",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5833333333333334,
      "category_scores": {
        "correctness": 0.74,
        "quality": 0.6176470588235294,
        "effectiveness": 0.5333333333333333,
        "realism": 0.6555555555555556,
        "detectability": 0.35555555555555557
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule includes most required Sigma fields with meaningful content, such as title, id, description, tags, logsource, detection, falsepositives, and level. Missing fields include 'author', 'date', and 'status', which are required for full Sigma compliance and operational tracking.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Includes essential fields like id, description, tags, and logsource with accurate values",
              "Properly structured detection and condition logic"
            ],
            "weaknesses": [
              "Missing required Sigma fields: author, date, status",
              "References field is absent despite MITRE link being available"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic correctly identifies rundll32 loading keylog-named DLLs and executables with 'keylog' in the name, aligning with T1056. However, relying solely on 'CommandLine|contains' for DLL loading is imprecise\u2014Sysmon does not always reliably capture full command-line context for DLL loading, and 'Image|contains' for executables may miss obfuscated names.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Accurate use of Image and CommandLine fields for process creation monitoring",
              "Condition logic is simple and logically sound (OR between two distinct behaviors)"
            ],
            "weaknesses": [
              "CommandLine|contains 'keylog' may not reliably detect DLL loading via rundll32 (e.g., via alternate syntax)",
              "No validation of actual malicious behavior\u2014only filename hints"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks specificity due to broad use of substring matching without contextual constraints like parent process, user context, or command-line structure. For example, any executable with 'keylog' in the path (e.g., 'backup_keylogger_tool.exe') triggers it, increasing false positives in environments with security tools.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Separates DLL and EXE cases for clearer logic",
              "Includes documented false positives"
            ],
            "weaknesses": [
              "No exclusion of known benign tools or paths (e.g., C:\\Tools\\)",
              "Lacks parent process or user context filtering (e.g., explorer.exe vs. svchost.exe)"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects basic keylogger naming patterns but is vulnerable to simple evasion like obfuscation (e.g., 'k3yl0g', 'keylog.txt.exe') or use of legitimate-sounding names. It does not use case-insensitive matching or regex, reducing sensitivity to real-world variations.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Covers two vectors: rundll32 DLL loading and direct EXE execution",
              "Uses 'contains' which allows partial matching in filenames"
            ],
            "weaknesses": [
              "No case-insensitive matching (Windows is case-insensitive but Sigma may not assume this)",
              "No support for encoded commands or obfuscated strings"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1056), a clear description, and relevant custom tags. However, it lacks references to authoritative sources, threat actors, malware families, or campaign names that would enhance context.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Accurate MITRE ATT&CK tagging including technique and tactic",
              "Clear description linking behavior to keylogging via rundll32 and executable names"
            ],
            "weaknesses": [
              "Missing MITRE reference URL in metadata",
              "No attribution to known threat actors, malware, or campaigns using this method"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses indexed fields like Image and CommandLine with efficient operators (endswith, contains). The logic avoids leading wildcards and places specific conditions first, though 'CommandLine|contains' could be optimized with additional constraints.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Uses high-cardinality indexed fields (Image, CommandLine)",
              "Employs efficient string operators (endswith, contains) without leading wildcards"
            ],
            "weaknesses": [
              "Relies on 'CommandLine|contains' without anchoring to reduce noise",
              "Could benefit from ordering more restrictive conditions first in selection blocks"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic keylogger execution via filename or DLL loading with 'keylog' in the name, but misses advanced variants like memory-resident keyloggers, obfuscated names, or legitimate tools abused for input capture (e.g., PowerShell, AutoHotKey).",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Covers rundll32.exe abuse for DLL sideloading with suspicious names",
              "Detects direct execution of files named with 'keylog'"
            ],
            "weaknesses": [
              "Narrow focus on literal 'keylog' strings; easily bypassed by obfuscation",
              "Does not cover common tools (e.g., PowerShell, Python) used for keylogging"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule acknowledges false positives in admin scripts and security tools, but lacks built-in filtering via parent processes, user context, or path whitelisting, increasing alert fatigue risk in production environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Includes documented false positive scenarios in metadata",
              "Uses specific image and command line conditions to reduce noise"
            ],
            "weaknesses": [
              "No exclusion logic for trusted paths or administrative tools",
              "Lacks parent-child process validation (e.g., rundll32 spawned by explorer vs. script host)"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule aligns with MITRE T1056 and captures basic keylogging behaviors involving rundll32 and 'keylog' in filenames, which are seen in some malware. However, it lacks specificity to known threat actors, campaigns, or advanced TTPs such as memory injection or API hooking commonly used in real-world keyloggers.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Maps to MITRE ATT&CK technique T1056 (Input Capture)",
              "Covers common LOLBin usage via rundll32.exe"
            ],
            "weaknesses": [
              "No reference to specific APT groups or real-world malware using this method",
              "Relies on simplistic string matching not reflective of sophisticated actor tradecraft"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The Sigma rule syntax is valid, uses standard Sysmon process creation events, and includes realistic logsource. The medium severity and documented false positives support SOC triage, though the high event count (274) suggests potential alert fatigue without tuning.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection events",
              "Uses widely available Sysmon data (process creation)"
            ],
            "weaknesses": [
              "High volume of events may lead to alert fatigue",
              "No mention of environment-specific tuning or baselining"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The title and description clearly state what is detected, and the fields used (Image, CommandLine) allow for basic investigation. However, missing contextual fields like user, parent process, or hash limits pivot capabilities and response actions.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Clear rule title and description for quick understanding",
              "Includes false positive guidance for common exceptions"
            ],
            "weaknesses": [
              "Lacks key forensic fields (e.g., User, ParentImage, Hash)",
              "No remediation or investigation next steps provided"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is highly evadable by renaming files, obfuscating command lines, or using alternative loaders. It relies heavily on 'keylog' string matches and command-line arguments, which attackers can easily modify or encrypt, making it weak against obfuscation and LOLBin misuse.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Detects rundll32 misuse, a common LOLBin technique",
              "Combines two detection conditions (DLL and EXE)"
            ],
            "weaknesses": [
              "Easily bypassed by renaming malicious binaries",
              "Relies on unobfuscated command-line content"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 3,
          "normalized_score": 0.3,
          "explanation": "The rule detects only the initial execution stage of input capture via process creation involving 'keylog' indicators, but does not extend to persistence, lateral movement, or exfiltration stages. It relies on single-event matching without correlation across multiple events or behavioral chains.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:36:59.877566",
          "metadata": {
            "strengths": [
              "Detects initial execution attempts using rundll32.exe with suspicious DLLs.",
              "Covers both direct executable naming and command-line loading of keylog-related components."
            ],
            "weaknesses": [
              "No detection logic for follow-on activities like data staging or exfiltration.",
              "Lacks multi-event correlation to distinguish malicious use from benign matches."
            ]
          }
        }
      ],
      "summary": "Rule for attack.t1056 (Detect Potential Input Capture (Keylogging) via Rundll32 or Keylog Executables) scored 0.58/1.0 (Poor). Best performance in correctness (0.74). Needs improvement in detectability (0.36). Issues found in: detection_specificity, attack_coverage, contextual_awareness",
      "timestamp": "2025-12-28T14:36:59.877566",
      "metadata": {
        "attack_id": "attack.t1056",
        "technique_name": "Detect Potential Input Capture (Keylogging) via Rundll32 or Keylog Executables",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6366666666666667,
      "category_scores": {
        "correctness": 0.76,
        "quality": 0.6,
        "effectiveness": 0.6333333333333333,
        "realism": 0.7555555555555555,
        "detectability": 0.4555555555555555
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like author, date, status, and references, reducing its completeness for production use.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Includes core detection components and MITRE tags",
              "Properly structured logsource and detection sections"
            ],
            "weaknesses": [
              "Missing author, date, status, and references",
              "Incomplete metadata reduces traceability and governance"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately captures known command-line utilities and commands associated with Account Discovery (T1087), including net user, Get-LocalUser, and qwinsta. Field names are standard Sigma syntax and the condition is simple and effective for identifying suspicious process creation events.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Correct use of standard Sigma field names",
              "Selection aligns well with T1087.001 behaviors"
            ],
            "weaknesses": [
              "No exclusion of known benign parent processes (e.g., taskhost.exe)",
              "No user context filtering (e.g., excluding Domain Admins)"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule is moderately broad, triggering on any cmd.exe or powershell.exe executing account enumeration commands, which are common in both malicious and administrative contexts. It lacks filters for parent process, user privilege level, or execution frequency, increasing false positive risk in enterprise environments.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Specific command-line indicators reduce noise compared to generic process monitoring",
              "Lists distinct account discovery tools"
            ],
            "weaknesses": [
              "No context-aware filtering (e.g., parent process, user role)",
              "High likelihood of false positives from legitimate admins"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers multiple tools (net, PowerShell, quser) and both local and domain enumeration methods, increasing coverage. However, it lacks support for obfuscation (e.g., encoded commands, variable usage) and alternative tool paths, making it vulnerable to simple evasion techniques.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Covers multiple command-line tools for account discovery",
              "Includes both local and domain-level enumeration commands"
            ],
            "weaknesses": [
              "No case-insensitive or regex-based matching for obfuscation",
              "Does not account for alternative execution paths or renamed binaries"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1087, discovery) and a clear description, but lacks specific sub-technique IDs, authoritative references beyond a generic tag, and attribution to threat actors or malware families. The generation method is noted, but no external links or campaign context are provided.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique and tactic tags included",
              "Clear rule title and description"
            ],
            "weaknesses": [
              "Missing specific MITRE technique ID (e.g., T1087.001, T1087.002)",
              "No external references (e.g., MITRE page, blog, research)"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators (endswith on Image, contains on CommandLine) with indexed fields in Sysmon. It avoids leading wildcards and places specific conditions in a flat, fast-evaluating structure. Logsource is appropriately scoped to Windows process creation via Sysmon.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Uses indexed fields (Image, CommandLine) effectively",
              "Avoids expensive regex and leading wildcards"
            ],
            "weaknesses": [
              "CommandLine|contains could benefit from case-insensitive matching in some SIEMs",
              "Could prioritize more specific command-line patterns first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule detects common account enumeration commands via cmd and PowerShell, including net, Get-LocalUser, and session tools. However, it misses advanced variants like WMI (wmic useraccount), .NET API calls, or remote execution via psexec, and does not cover all sub-techniques like domain enumeration (Get-ADGroupMember).",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Covers core command-line utilities for local and domain user enumeration",
              "Includes both native Windows commands and PowerShell cmdlets"
            ],
            "weaknesses": [
              "Lacks coverage of WMI and DCOM-based enumeration",
              "Does not detect obfuscated or encoded command lines"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule lacks process ancestry, user context, or frequency-based thresholds, making it prone to alert on legitimate admin activity. While false positives are acknowledged in metadata, no detection-time filters exclude known admin tools or trusted execution paths.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Acknowledges common false positive sources in metadata",
              "Focuses on interactive shells (cmd/powershell) which adds some context"
            ],
            "weaknesses": [
              "No parent process filtering (e.g., blocking if spawned from taskhost)",
              "No exclusions for authorized users or administrative workstations"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule aligns with real-world T1087 usage, as adversaries commonly use 'net user', 'Get-LocalUser', and similar commands during reconnaissance. It captures known command-line patterns used by threat actors, though it lacks specificity to advanced campaigns or APT groups.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Covers common T1087 techniques used by real attackers",
              "Includes both native Windows commands and PowerShell cmdlets"
            ],
            "weaknesses": [
              "No linkage to specific threat actors or campaigns",
              "Misses context like target scope (e.g., domain vs local) or timing patterns"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses standard Sysmon process creation events with widely supported field names and has been verified in a Splunk environment. The false positive guidance is practical, and the medium severity level is appropriate for triage.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Validated in SIEM with successful detection results",
              "Uses common log source (Sysmon process creation) available in most enterprises"
            ],
            "weaknesses": [
              "No mention of normalization or field extraction assumptions beyond fallback",
              "Potential high volume from admin scripts without thresholding"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The title and description clearly indicate account discovery activity, and the detected fields (Image, CommandLine) allow for basic pivoting. However, it lacks enrichment such as user context or host role, which would aid investigation.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Clear title and description for quick understanding",
              "CommandLine and Image fields support initial investigation"
            ],
            "weaknesses": [
              "Missing user context (e.g., User field in detection)",
              "No guidance on follow-up queries or MITRE response recommendations"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule relies heavily on command-line string matching, which can be easily evaded via obfuscation, alternative tools (e.g., WMI), or LOLBins. It does not account for encoded commands or indirect execution methods commonly used in evasion.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Covers multiple command-line utilities (cmd and PowerShell)",
              "Includes both native and PowerShell-based discovery tools"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation (e.g., 'net.u*s*r')",
              "No detection logic for encodedcommand or indirect execution (e.g., via WMI or scheduled tasks)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution of account discovery commands but does not correlate across multiple stages or sessions, limiting visibility into persistence, lateral movement, or follow-on actions. It is a single-event detection focused solely on command-line invocation, lacking logic for session chaining or behavioral context.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:37:35.005686",
          "metadata": {
            "strengths": [
              "Detects initial use of common account enumeration commands",
              "Covers both PowerShell and cmd.exe execution contexts"
            ],
            "weaknesses": [
              "No correlation across events or processes to detect multi-stage activity",
              "Does not distinguish between initial access and later stages like lateral movement"
            ]
          }
        }
      ],
      "summary": "Rule for attack.discovery (Account Discovery via Command Line Utilities) scored 0.64/1.0 (Below Average). Best performance in correctness (0.76). Needs improvement in detectability (0.46). Issues found in: detection_specificity, false_positive_resistance, evasion_resistance",
      "timestamp": "2025-12-28T14:37:35.005686",
      "metadata": {
        "attack_id": "attack.discovery",
        "technique_name": "Account Discovery via Command Line Utilities",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.6766666666666666,
      "category_scores": {
        "correctness": 0.7200000000000001,
        "quality": 0.6705882352941177,
        "effectiveness": 0.6599999999999999,
        "realism": 0.7888888888888889,
        "detectability": 0.5555555555555556
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, description, logsource, detection, falsepositives, level, and tags with MITRE ATT&CK mapping. However, it lacks mandatory fields like 'id', 'status', 'author', 'date', and 'references', which are essential for production-ready detection content and rule management.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Includes meaningful description and proper MITRE tags (attack.t1547.001)",
              "Well-structured logsource and detection sections with clear selections"
            ],
            "weaknesses": [
              "Missing critical Sigma fields: id, author, date, status, references",
              "Incomplete metadata reduces traceability and operational readiness"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The detection logic accurately targets Registry Run/RunOnce modifications via Sysmon Event ID 13 and filters for high-risk parent processes like cmd, PowerShell, and scripting hosts. Exclusion of SYSTEM user reduces false positives, and the condition correctly combines relevant selections. Field names are standard Sigma syntax and align with Sysmon schema.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Correct use of EventID 13 and TargetObject for registry value set detection",
              "Logical exclusion of SYSTEM and inclusion of suspicious parent processes"
            ],
            "weaknesses": [
              "No handling of case insensitivity for paths (Windows is case-insensitive)",
              "ParentImage matching uses endswith but could be bypassed by path spoofing"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule demonstrates good specificity by combining user context (non-SYSTEM), target registry paths, and suspicious parent processes. This multi-condition approach reduces noise. However, it may still trigger on legitimate admin scripts or installers, especially if they use cmd/powershell to set Run keys, despite listed false positives.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Combines user, target, and parent process context for precision",
              "Excludes SYSTEM which covers many benign system writes"
            ],
            "weaknesses": [
              "Relies on exact string endings for parent processes\u2014could miss renamed tools",
              "No additional filtering on command-line arguments or image paths"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule covers multiple Run key locations including Wow6432Node and common scripting parents, increasing coverage. However, it lacks support for obfuscated or encoded command lines, alternate parent processes (e.g., msbuild.exe, cscript.exe), and case-insensitive matching. Simple evasion via path variation or process masquerading could bypass detection.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Covers both Run and RunOnce, including 32-bit registry view (Wow6432Node)",
              "Includes multiple high-risk parent process types"
            ],
            "weaknesses": [
              "No case-insensitive matching on paths or processes",
              "Limited to only five parent executables; misses other common TTPs (e.g., msbuild, cscript)"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes correct MITRE ATT&CK tags (T1547.001) and a clear description, but lacks references to authoritative sources, threat actors, malware families, or campaign names. The technique name and tags are accurate, but additional context would improve investigative utility.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Correct MITRE ATT&CK technique ID and tactic tagging",
              "Clear rule title and description explaining detection goal"
            ],
            "weaknesses": [
              "Missing MITRE reference URL or external sources",
              "No attribution to known threat actors or malware using this method"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses indexed fields like EventID and efficient string operators (endswith, contains). Detection logic starts with specific conditions (EventID 13), and avoids expensive regex or leading wildcards. Minor improvement could be reordering conditions for faster evaluation.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Uses EventID early as high-cardinality filter",
              "Employs efficient 'endswith' for parent process images"
            ],
            "weaknesses": [
              "Uses 'contains' on TargetObject which may trigger on substrings unnecessarily",
              "Could reorder conditions to place most selective filters first"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule covers key Run/RunOnce registry locations including Wow6432Node and focuses on suspicious parent processes commonly abused in post-compromise scenarios. However, it misses detection of other potential launch vectors like Office macros, scheduled tasks, or WMI, and does not account for remote registry modifications or lateral movement setups.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Covers both Run and RunOnce keys across 32/64-bit registry views",
              "Focuses on high-risk parent processes (powershell, cmd, rundll32, etc.)"
            ],
            "weaknesses": [
              "Limited to local persistence setup; no coverage of remote registry writes",
              "Does not include detection of obfuscated or encoded command lines"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule excludes SYSTEM user activity and focuses on suspicious parent processes, which helps reduce false positives. However, it lacks frequency-based thresholds or time-window correlation, and the 'contains' operator on registry paths may trigger on benign installer activity without additional context filtering.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Excludes SYSTEM account modifications",
              "Leverages parent process context to increase suspicion level"
            ],
            "weaknesses": [
              "No thresholding or event counting to distinguish admin scripts from malicious use",
              "False positive guidance is generic and lacks specific exclusion examples"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule aligns well with real-world TTPs, as adversaries frequently abuse Run/RunOnce keys for persistence via LOLBins like powershell.exe or rundll32.exe. It reflects actual attack chains where non-SYSTEM users write to these keys under suspicious parent processes.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Targets known persistence mechanism (T1547.001) used by multiple APT groups",
              "Focuses on suspicious parent processes commonly abused in living-off-the-land attacks"
            ],
            "weaknesses": [
              "Lacks specificity to known adversary tools or campaigns (e.g., no reference to APT41, Lazarus, etc.)",
              "Does not account for timing patterns (e.g., RunOnce after reboot) that increase malicious context"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses standard Sysmon Event ID 13 with common field mappings, making it deployable in most Windows environments. However, false positives from installers and GPO updates may generate alert fatigue without proper tuning.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Uses widely available Sysmon data (EventID 13, TargetObject, ParentImage)",
              "Clear exclusion of SYSTEM user reduces noise"
            ],
            "weaknesses": [
              "High potential for false positives from legitimate software installers and scripts",
              "No thresholding or frequency-based logic to suppress bursts of benign activity"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 9,
          "normalized_score": 0.9,
          "explanation": "The rule title and description clearly communicate the detected behavior, and the included fields (User, ParentImage, TargetObject) enable effective pivoting. False positive guidance helps analysts triage quickly.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Clear, descriptive title and actionable description",
              "Provides key investigation fields: user, target registry path, and parent process"
            ],
            "weaknesses": [
              "Missing example malicious command lines or hash lookups for deeper context",
              "No direct MITRE ATT&CK link in tags despite correct technique ID"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule detects behavior via parent process lineage, which is moderately resistant to evasion, but attackers can bypass it using alternate methods like WMI, scheduled tasks, or direct API calls. Reliance on ParentImage endings allows simple path spoofing or LOLBin chaining through signed binaries.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Detects use of common LOLBins (powershell, wscript, mshta) as parent processes",
              "Focuses on registry value setting behavior rather than static command lines"
            ],
            "weaknesses": [
              "Vulnerable to evasion via renamed executables or use of other trusted hosts (e.g., msbuild.exe)",
              "No detection logic for indirect modifications (e.g., via WMI or remote registry edits)"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects persistence setup via Run/RunOnce keys during initial modification, aligning with early-stage persistence activity, but does not correlate across execution, lateral movement, or exfiltration stages. It is limited to a single-event detection (EventID 13) without temporal or behavioral correlation to other stages of the attack lifecycle.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:10.114553",
          "metadata": {
            "strengths": [
              "Detects persistence mechanism at time of registry modification",
              "Covers multiple Run key locations including Wow6432Node for 32-bit emulation"
            ],
            "weaknesses": [
              "Single-event detection without multi-stage correlation",
              "No tracking of subsequent execution or follow-on activities from the persistence"
            ]
          }
        }
      ],
      "summary": "Rule for attack.persistence (Detect Registry Run/RunOnce Persistence via Sysmon RegistryValueSet) scored 0.68/1.0 (Below Average). Best performance in realism (0.79). Needs improvement in detectability (0.56). Issues found in: false_positive_resistance, multi_stage_detection",
      "timestamp": "2025-12-28T14:38:10.114553",
      "metadata": {
        "attack_id": "attack.persistence",
        "technique_name": "Detect Registry Run/RunOnce Persistence via Sysmon RegistryValueSet",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    },
    {
      "benchmark_id": "dfa9e529-d215-493d-8aa4-d21768215bc8",
      "item_id": "unknown",
      "item_type": "detection_rule",
      "overall_score": 0.5383333333333333,
      "category_scores": {
        "correctness": 0.6599999999999999,
        "quality": 0.5411764705882353,
        "effectiveness": 0.49333333333333335,
        "realism": 0.6111111111111112,
        "detectability": 0.4
      },
      "metric_results": [
        {
          "metric_name": "sigma_completeness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes most required Sigma fields such as title, id, description, logsource, detection, falsepositives, level, and tags. However, it lacks mandatory fields like author, date, status, and references, which are essential for production readiness and traceability. The tags include partial MITRE mapping but use non-standard syntax like 'custom.technique_id'.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Includes core Sigma structure with meaningful detection logic",
              "Properly formatted logsource and detection sections"
            ],
            "weaknesses": [
              "Missing author, date, status, and references fields",
              "Non-standard tag formatting (e.g., 'custom.technique_id')"
            ]
          }
        },
        {
          "metric_name": "detection_logic_correctness",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The logic aligns with T1566/T1567.001, detecting Office apps spawning command-line tools with suspicious commands like Invoke-WebRequest and temp paths. Field names are standard Sigma fields and condition is simple and sound. However, 'CommandLine|contains' on 'Invoke-WebRequest' may miss obfuscated variants, and '\\\\temp\\\\' path matching is too rigid.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Accurate use of parent-child process relationships (Office \u2192 cmd/powershell)",
              "Relevant command-line indicators tied to malicious file execution"
            ],
            "weaknesses": [
              "Relies on exact string matches vulnerable to obfuscation",
              "Does not account for alternative scripting engines or encoded commands"
            ]
          }
        },
        {
          "metric_name": "detection_specificity",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule combines multiple conditions (parent process, image, command line) which improves precision. However, it lacks exclusions for known benign scenarios (e.g., trusted users, approved scripts) and uses broad contains matches that could trigger on legitimate admin activity. The 'temp' path and 'Invoke-WebRequest' are common in both malicious and legitimate workflows.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Multi-condition AND logic reduces random FP triggers",
              "Focus on Office spawning shells adds contextual specificity"
            ],
            "weaknesses": [
              "No exclusions for administrative or software deployment contexts",
              "High-risk keywords without normalization or context enrichment"
            ]
          }
        },
        {
          "metric_name": "detection_sensitivity",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects a narrow variant of the technique using specific command-line artifacts but fails to account for common evasion tactics like base64 encoding, PowerShell abbreviations (-c, -enc), or alternative download methods (certutil, bitsadmin). It also doesn't cover other Office siblings (e.g., Outlook) or lateral movement vectors. Case-insensitive matching is assumed but not enforced.",
          "confidence": 1.0,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Covers common initial access pattern: Office \u2192 shell \u2192 web download",
              "Includes multiple IOCs in command line and parent process"
            ],
            "weaknesses": [
              "Vulnerable to simple obfuscation (e.g., iex(IWR), encodedcommand)",
              "Lacks coverage of alternative tools and execution methods"
            ]
          }
        },
        {
          "metric_name": "metadata_richness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule includes basic MITRE ATT&CK tagging with technique IDs and tactic, and a clear title and description. However, it lacks references to authoritative sources, threat actors, campaigns, or malware families, reducing investigative context. The generation method is noted, but no external validation or research citations are provided.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Includes relevant MITRE ATT&CK tags (T1566, T1567.001)",
              "Clear rule title and functional description"
            ],
            "weaknesses": [
              "Missing MITRE ATT&CK tactic mapping (e.g., 'execution')",
              "No references to MITRE pages, threat reports, or malware families"
            ]
          }
        },
        {
          "metric_name": "optimization_level",
          "score": 8,
          "normalized_score": 0.8,
          "explanation": "The rule uses efficient field operators like 'endswith' and 'contains' on indexed fields (Image, CommandLine, ParentImage) and avoids leading wildcards. The logsource is specific to Sysmon process creation, improving performance. However, 'contains' on 'Invoke-WebRequest' and '\\\\temp\\\\' could benefit from more precise regex or 'startswith' where possible.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Uses indexed fields and efficient string operators",
              "Specific logsource (Sysmon process_creation on Windows)"
            ],
            "weaknesses": [
              "Use of 'contains' on command line increases noise and processing cost",
              "No prioritization of most selective condition first in logic"
            ]
          }
        },
        {
          "metric_name": "attack_coverage",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule detects basic user execution via Office documents spawning PowerShell/cmd with suspicious commands, but misses key variants like WMI, MSHTA, or script interpreters. It only covers one sub-technique (T1567.001) and lacks coverage of other delivery methods (e.g., PDF, browsers). No detection of encoded commands or obfuscated payloads reduces efficacy against advanced threats.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Covers common Office-to-shell execution path",
              "Includes network retrieval via Invoke-WebRequest"
            ],
            "weaknesses": [
              "Narrow scope; misses other interpreters (e.g., cscript, wscript)",
              "No detection of obfuscation or encoded payloads"
            ]
          }
        },
        {
          "metric_name": "false_positive_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule lists common false positives in metadata but lacks inline exclusions or logic to suppress them. No user, path, or command-line whitelisting is implemented. Parent-child logic is used but not refined (e.g., no exclusion for trusted Office child processes). A single-event condition increases FP risk without frequency or behavioral context.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Acknowledges key false positive scenarios in metadata",
              "Uses parent process context (Office spawning shell)"
            ],
            "weaknesses": [
              "No exclusion logic for legitimate administrative use",
              "Single-event trigger without thresholding or behavioral chaining"
            ]
          }
        },
        {
          "metric_name": "contextual_awareness",
          "score": 6,
          "normalized_score": 0.6,
          "explanation": "The rule aligns with common TTPs where Office applications spawn command-line tools to execute malicious payloads, particularly in phishing campaigns. However, it lacks specificity to known APT groups or campaigns and relies on generic command-line artifacts rather than advanced behavioral patterns.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Captures common initial execution chain: Office docs spawning PowerShell/cmd",
              "Includes relevant command-line indicators like Invoke-WebRequest and temp paths"
            ],
            "weaknesses": [
              "No reference to real-world threat actors or campaigns",
              "Relies on basic command-line strings that may not reflect obfuscated real-world usage"
            ]
          }
        },
        {
          "metric_name": "operational_deployability",
          "score": 7,
          "normalized_score": 0.7,
          "explanation": "The rule uses standard Sysmon process creation events with common field names, making it deployable in most Windows environments. The documented false positives are realistic, and the medium severity level supports triage without overwhelming analysts.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Uses widely available Sysmon log source with standard fields",
              "Includes reasonable false positive guidance for common scenarios"
            ],
            "weaknesses": [
              "No mention of testing across diverse enterprise environments",
              "Potential for high false positives due to broad command-line conditions"
            ]
          }
        },
        {
          "metric_name": "analyst_actionability",
          "score": 5,
          "normalized_score": 0.5,
          "explanation": "The rule title and description are clear, but the detection lacks key investigative fields like user context, image hashes, or network indicators. Analysts would need follow-up queries to pivot effectively.",
          "confidence": 0.85,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Title clearly indicates malicious user execution via Office documents",
              "Description notes NLP and process creation context"
            ],
            "weaknesses": [
              "Missing critical pivot fields (e.g., User, Hash, ParentCommandLine)",
              "No MITRE ATT&CK context in description to guide response"
            ]
          }
        },
        {
          "metric_name": "evasion_resistance",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule is vulnerable to simple evasion such as renaming executables, using alternative LOLBins, or obfuscating command lines. It relies heavily on unencoded command-line arguments, which attackers commonly evade via encoding or alternative execution methods.",
          "confidence": 0.9,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Detects process relationships (parent-child) which are harder to spoof",
              "Combines multiple conditions (image, command line, parent)"
            ],
            "weaknesses": [
              "Easily bypassed by command-line obfuscation or alternative download methods",
              "No detection logic for encoded commands or alternate LOLBins like mshta/wmic"
            ]
          }
        },
        {
          "metric_name": "multi_stage_detection",
          "score": 4,
          "normalized_score": 0.4,
          "explanation": "The rule detects initial execution via process creation from Office applications spawning command-line tools, which aligns with early-stage malicious file execution. However, it lacks logic to detect persistence, lateral movement, or exfiltration stages tied to the same TTP. The detection is limited to a single-event condition without correlation across attack phases.",
          "confidence": 0.95,
          "timestamp": "2025-12-28T14:38:46.607551",
          "metadata": {
            "strengths": [
              "Captures initial execution vector via Office-spawned command-line processes",
              "Includes relevant command-line indicators like 'Invoke-WebRequest' and temp path usage"
            ],
            "weaknesses": [
              "No multi-event or cross-stage correlation logic",
              "Fails to detect follow-on activities such as persistence or data exfiltration"
            ]
          }
        }
      ],
      "summary": "Rule for attack.execution (Detection of User Execution: Malicious File via Process Creation) scored 0.54/1.0 (Poor). Best performance in correctness (0.66). Needs improvement in detectability (0.40). Issues found in: detection_specificity, detection_sensitivity, attack_coverage",
      "timestamp": "2025-12-28T14:38:46.607551",
      "metadata": {
        "attack_id": "attack.execution",
        "technique_name": "Detection of User Execution: Malicious File via Process Creation",
        "tactic": "execution",
        "platforms_evaluated": [],
        "llm_generated": false
      }
    }
  ]
}